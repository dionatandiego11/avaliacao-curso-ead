/*! For license information please see stimulus.c1e10c0d.js.LICENSE.txt */
(self.webpackChunkstudentcrowd=self.webpackChunkstudentcrowd||[]).push([[523],{8430:(t,e,r)=>{var i={"./account-bookmark_controller.js":5986,"./alevel-chart_controller.js":3622,"./bookmark_controller.js":5464,"./checkbox_controller.js":9239,"./clipboard_controller.js":7374,"./course-category-filters_controller.js":7674,"./course-category-institution_controller.js":6389,"./course-category-search_controller.js":4841,"./course-on-change_controller.js":9296,"./faq_controller.js":9200,"./filter-features_controller.js":9094,"./filter-modal_controller.js":414,"./fix-on-scroll_controller.js":5078,"./fixed-button_controller.js":9259,"./form-select_controller.js":3211,"./gallery_controller.js":9382,"./hall-card_controller.js":9940,"./header-search_controller.js":8520,"./jump-to-top_controller.js":5240,"./league-table-carousel_controller.js":9767,"./league-table-search_controller.js":1241,"./login-google_controller.js":7445,"./login-modal_controller.js":9255,"./mapbox_controller.js":2457,"./mobile-nav_controller.js":9278,"./more-features_controller.js":3785,"./preferences_controller.js":3050,"./profile-gallery_controller.js":9530,"./profile-history-state_controller.js":9688,"./profile-hotjar-fix_controller.js":638,"./profile-mobile-gallery_controller.js":7435,"./profile-nav_controller.js":7663,"./profile-paginator_controller.js":2937,"./profile-question-answer_controller.js":9811,"./profile-question_controller.js":1412,"./profile-reviews-read-more_controller.js":1950,"./profile-summary_controller.js":8552,"./profile_controller.js":2431,"./quiz_controller.js":1767,"./read-more_controller.js":8058,"./register-modal_controller.js":347,"./reservation-room-details_controller.js":5363,"./reservation-user-details-validation_controller.js":9665,"./reservation-user-details_controller.js":255,"./review-aspects-impression_controller.js":2594,"./review-aspects_controller.js":4316,"./review-complete-profile_controller.js":2412,"./review-sticky-controller.js":4098,"./review-validation_controller.js":3308,"./review_controller.js":4280,"./review_signin_controller.js":8673,"./reviews-paginator_controller.js":2397,"./room-type-profiler-filter_controller.js":9655,"./search_controller.js":912,"./select-box_controller.js":5664,"./sign-up_controller.js":2843,"./slider_controller.js":8367,"./subject-search_controller.js":969,"./submit-loading_controller.js":807,"./toast_controller.js":1641,"./toggle_controller.js":2728,"./tooltip_controller.js":3046,"./top-tip_controller.js":3121,"./ucas-chart_controller.js":3343};function n(t){var e=o(t);return r(e)}function o(t){if(!r.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}n.keys=function(){return Object.keys(i)},n.resolve=o,t.exports=n,n.id=8430},2891:(t,e,r)=>{"use strict";r.d(e,{lg:()=>J,xI:()=>lt});class i{constructor(t,e,r){this.eventTarget=t,this.eventName=e,this.eventOptions=r,this.unorderedBindings=new Set}connect(){this.eventTarget.addEventListener(this.eventName,this,this.eventOptions)}disconnect(){this.eventTarget.removeEventListener(this.eventName,this,this.eventOptions)}bindingConnected(t){this.unorderedBindings.add(t)}bindingDisconnected(t){this.unorderedBindings.delete(t)}handleEvent(t){const e=function(t){if("immediatePropagationStopped"in t)return t;{const{stopImmediatePropagation:e}=t;return Object.assign(t,{immediatePropagationStopped:!1,stopImmediatePropagation(){this.immediatePropagationStopped=!0,e.call(this)}})}}(t);for(const t of this.bindings){if(e.immediatePropagationStopped)break;t.handleEvent(e)}}hasBindings(){return this.unorderedBindings.size>0}get bindings(){return Array.from(this.unorderedBindings).sort(((t,e)=>{const r=t.index,i=e.index;return r<i?-1:r>i?1:0}))}}class n{constructor(t){this.application=t,this.eventListenerMaps=new Map,this.started=!1}start(){this.started||(this.started=!0,this.eventListeners.forEach((t=>t.connect())))}stop(){this.started&&(this.started=!1,this.eventListeners.forEach((t=>t.disconnect())))}get eventListeners(){return Array.from(this.eventListenerMaps.values()).reduce(((t,e)=>t.concat(Array.from(e.values()))),[])}bindingConnected(t){this.fetchEventListenerForBinding(t).bindingConnected(t)}bindingDisconnected(t,e=!1){this.fetchEventListenerForBinding(t).bindingDisconnected(t),e&&this.clearEventListenersForBinding(t)}handleError(t,e,r={}){this.application.handleError(t,`Error ${e}`,r)}clearEventListenersForBinding(t){const e=this.fetchEventListenerForBinding(t);e.hasBindings()||(e.disconnect(),this.removeMappedEventListenerFor(t))}removeMappedEventListenerFor(t){const{eventTarget:e,eventName:r,eventOptions:i}=t,n=this.fetchEventListenerMapForEventTarget(e),o=this.cacheKey(r,i);n.delete(o),0==n.size&&this.eventListenerMaps.delete(e)}fetchEventListenerForBinding(t){const{eventTarget:e,eventName:r,eventOptions:i}=t;return this.fetchEventListener(e,r,i)}fetchEventListener(t,e,r){const i=this.fetchEventListenerMapForEventTarget(t),n=this.cacheKey(e,r);let o=i.get(n);return o||(o=this.createEventListener(t,e,r),i.set(n,o)),o}createEventListener(t,e,r){const n=new i(t,e,r);return this.started&&n.connect(),n}fetchEventListenerMapForEventTarget(t){let e=this.eventListenerMaps.get(t);return e||(e=new Map,this.eventListenerMaps.set(t,e)),e}cacheKey(t,e){const r=[t];return Object.keys(e).sort().forEach((t=>{r.push(`${e[t]?"":"!"}${t}`)})),r.join(":")}}const o={stop:({event:t,value:e})=>(e&&t.stopPropagation(),!0),prevent:({event:t,value:e})=>(e&&t.preventDefault(),!0),self:({event:t,value:e,element:r})=>!e||r===t.target},s=/^(?:(?:([^.]+?)\+)?(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;function a(t){return"window"==t?window:"document"==t?document:void 0}function l(t){return t.replace(/(?:[_-])([a-z0-9])/g,((t,e)=>e.toUpperCase()))}function c(t){return l(t.replace(/--/g,"-").replace(/__/g,"_"))}function u(t){return t.charAt(0).toUpperCase()+t.slice(1)}function h(t){return t.replace(/([A-Z])/g,((t,e)=>`-${e.toLowerCase()}`))}function d(t){return null!=t}function p(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const f=["meta","ctrl","alt","shift"];const m={a:()=>"click",button:()=>"click",form:()=>"submit",details:()=>"toggle",input:t=>"submit"==t.getAttribute("type")?"click":"input",select:()=>"change",textarea:()=>"input"};function g(t){throw new Error(t)}function y(t){try{return JSON.parse(t)}catch(e){return t}}class v{constructor(t,e){this.context=t,this.action=e}get index(){return this.action.index}get eventTarget(){return this.action.eventTarget}get eventOptions(){return this.action.eventOptions}get identifier(){return this.context.identifier}handleEvent(t){const e=this.prepareActionEvent(t);this.willBeInvokedByEvent(t)&&this.applyEventModifiers(e)&&this.invokeWithEvent(e)}get eventName(){return this.action.eventName}get method(){const t=this.controller[this.methodName];if("function"==typeof t)return t;throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`)}applyEventModifiers(t){const{element:e}=this.action,{actionDescriptorFilters:r}=this.context.application,{controller:i}=this.context;let n=!0;for(const[o,s]of Object.entries(this.eventOptions))if(o in r){const a=r[o];n=n&&a({name:o,value:s,event:t,element:e,controller:i})}return n}prepareActionEvent(t){return Object.assign(t,{params:this.action.params})}invokeWithEvent(t){const{target:e,currentTarget:r}=t;try{this.method.call(this.controller,t),this.context.logDebugActivity(this.methodName,{event:t,target:e,currentTarget:r,action:this.methodName})}catch(e){const{identifier:r,controller:i,element:n,index:o}=this,s={identifier:r,controller:i,element:n,index:o,event:t};this.context.handleError(e,`invoking action "${this.action}"`,s)}}willBeInvokedByEvent(t){const e=t.target;return!(t instanceof KeyboardEvent&&this.action.shouldIgnoreKeyboardEvent(t))&&(!(t instanceof MouseEvent&&this.action.shouldIgnoreMouseEvent(t))&&(this.element===e||(e instanceof Element&&this.element.contains(e)?this.scope.containsElement(e):this.scope.containsElement(this.action.element))))}get controller(){return this.context.controller}get methodName(){return this.action.methodName}get element(){return this.scope.element}get scope(){return this.context.scope}}class _{constructor(t,e){this.mutationObserverInit={attributes:!0,childList:!0,subtree:!0},this.element=t,this.started=!1,this.delegate=e,this.elements=new Set,this.mutationObserver=new MutationObserver((t=>this.processMutations(t)))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,this.mutationObserverInit),this.refresh())}pause(t){this.started&&(this.mutationObserver.disconnect(),this.started=!1),t(),this.started||(this.mutationObserver.observe(this.element,this.mutationObserverInit),this.started=!0)}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started){const t=new Set(this.matchElementsInTree());for(const e of Array.from(this.elements))t.has(e)||this.removeElement(e);for(const e of Array.from(t))this.addElement(e)}}processMutations(t){if(this.started)for(const e of t)this.processMutation(e)}processMutation(t){"attributes"==t.type?this.processAttributeChange(t.target,t.attributeName):"childList"==t.type&&(this.processRemovedNodes(t.removedNodes),this.processAddedNodes(t.addedNodes))}processAttributeChange(t,e){this.elements.has(t)?this.delegate.elementAttributeChanged&&this.matchElement(t)?this.delegate.elementAttributeChanged(t,e):this.removeElement(t):this.matchElement(t)&&this.addElement(t)}processRemovedNodes(t){for(const e of Array.from(t)){const t=this.elementFromNode(e);t&&this.processTree(t,this.removeElement)}}processAddedNodes(t){for(const e of Array.from(t)){const t=this.elementFromNode(e);t&&this.elementIsActive(t)&&this.processTree(t,this.addElement)}}matchElement(t){return this.delegate.matchElement(t)}matchElementsInTree(t=this.element){return this.delegate.matchElementsInTree(t)}processTree(t,e){for(const r of this.matchElementsInTree(t))e.call(this,r)}elementFromNode(t){if(t.nodeType==Node.ELEMENT_NODE)return t}elementIsActive(t){return t.isConnected==this.element.isConnected&&this.element.contains(t)}addElement(t){this.elements.has(t)||this.elementIsActive(t)&&(this.elements.add(t),this.delegate.elementMatched&&this.delegate.elementMatched(t))}removeElement(t){this.elements.has(t)&&(this.elements.delete(t),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(t))}}class b{constructor(t,e,r){this.attributeName=e,this.delegate=r,this.elementObserver=new _(t,this)}get element(){return this.elementObserver.element}get selector(){return`[${this.attributeName}]`}start(){this.elementObserver.start()}pause(t){this.elementObserver.pause(t)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get started(){return this.elementObserver.started}matchElement(t){return t.hasAttribute(this.attributeName)}matchElementsInTree(t){const e=this.matchElement(t)?[t]:[],r=Array.from(t.querySelectorAll(this.selector));return e.concat(r)}elementMatched(t){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(t,this.attributeName)}elementUnmatched(t){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(t,this.attributeName)}elementAttributeChanged(t,e){this.delegate.elementAttributeValueChanged&&this.attributeName==e&&this.delegate.elementAttributeValueChanged(t,e)}}function x(t,e,r){T(t,e).add(r)}function w(t,e,r){T(t,e).delete(r),function(t,e){const r=t.get(e);null!=r&&0==r.size&&t.delete(e)}(t,e)}function T(t,e){let r=t.get(e);return r||(r=new Set,t.set(e,r)),r}class E{constructor(){this.valuesByKey=new Map}get keys(){return Array.from(this.valuesByKey.keys())}get values(){return Array.from(this.valuesByKey.values()).reduce(((t,e)=>t.concat(Array.from(e))),[])}get size(){return Array.from(this.valuesByKey.values()).reduce(((t,e)=>t+e.size),0)}add(t,e){x(this.valuesByKey,t,e)}delete(t,e){w(this.valuesByKey,t,e)}has(t,e){const r=this.valuesByKey.get(t);return null!=r&&r.has(e)}hasKey(t){return this.valuesByKey.has(t)}hasValue(t){return Array.from(this.valuesByKey.values()).some((e=>e.has(t)))}getValuesForKey(t){const e=this.valuesByKey.get(t);return e?Array.from(e):[]}getKeysForValue(t){return Array.from(this.valuesByKey).filter((([e,r])=>r.has(t))).map((([t,e])=>t))}}class S{constructor(t,e,r,i){this._selector=e,this.details=i,this.elementObserver=new _(t,this),this.delegate=r,this.matchesByElement=new E}get started(){return this.elementObserver.started}get selector(){return this._selector}set selector(t){this._selector=t,this.refresh()}start(){this.elementObserver.start()}pause(t){this.elementObserver.pause(t)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get element(){return this.elementObserver.element}matchElement(t){const{selector:e}=this;if(e){const r=t.matches(e);return this.delegate.selectorMatchElement?r&&this.delegate.selectorMatchElement(t,this.details):r}return!1}matchElementsInTree(t){const{selector:e}=this;if(e){const r=this.matchElement(t)?[t]:[],i=Array.from(t.querySelectorAll(e)).filter((t=>this.matchElement(t)));return r.concat(i)}return[]}elementMatched(t){const{selector:e}=this;e&&this.selectorMatched(t,e)}elementUnmatched(t){const e=this.matchesByElement.getKeysForValue(t);for(const r of e)this.selectorUnmatched(t,r)}elementAttributeChanged(t,e){const{selector:r}=this;if(r){const e=this.matchElement(t),i=this.matchesByElement.has(r,t);e&&!i?this.selectorMatched(t,r):!e&&i&&this.selectorUnmatched(t,r)}}selectorMatched(t,e){this.delegate.selectorMatched(t,e,this.details),this.matchesByElement.add(e,t)}selectorUnmatched(t,e){this.delegate.selectorUnmatched(t,e,this.details),this.matchesByElement.delete(e,t)}}class P{constructor(t,e){this.element=t,this.delegate=e,this.started=!1,this.stringMap=new Map,this.mutationObserver=new MutationObserver((t=>this.processMutations(t)))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,attributeOldValue:!0}),this.refresh())}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started)for(const t of this.knownAttributeNames)this.refreshAttribute(t,null)}processMutations(t){if(this.started)for(const e of t)this.processMutation(e)}processMutation(t){const e=t.attributeName;e&&this.refreshAttribute(e,t.oldValue)}refreshAttribute(t,e){const r=this.delegate.getStringMapKeyForAttribute(t);if(null!=r){this.stringMap.has(t)||this.stringMapKeyAdded(r,t);const i=this.element.getAttribute(t);if(this.stringMap.get(t)!=i&&this.stringMapValueChanged(i,r,e),null==i){const e=this.stringMap.get(t);this.stringMap.delete(t),e&&this.stringMapKeyRemoved(r,t,e)}else this.stringMap.set(t,i)}}stringMapKeyAdded(t,e){this.delegate.stringMapKeyAdded&&this.delegate.stringMapKeyAdded(t,e)}stringMapValueChanged(t,e,r){this.delegate.stringMapValueChanged&&this.delegate.stringMapValueChanged(t,e,r)}stringMapKeyRemoved(t,e,r){this.delegate.stringMapKeyRemoved&&this.delegate.stringMapKeyRemoved(t,e,r)}get knownAttributeNames(){return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))}get currentAttributeNames(){return Array.from(this.element.attributes).map((t=>t.name))}get recordedAttributeNames(){return Array.from(this.stringMap.keys())}}class k{constructor(t,e,r){this.attributeObserver=new b(t,e,this),this.delegate=r,this.tokensByElement=new E}get started(){return this.attributeObserver.started}start(){this.attributeObserver.start()}pause(t){this.attributeObserver.pause(t)}stop(){this.attributeObserver.stop()}refresh(){this.attributeObserver.refresh()}get element(){return this.attributeObserver.element}get attributeName(){return this.attributeObserver.attributeName}elementMatchedAttribute(t){this.tokensMatched(this.readTokensForElement(t))}elementAttributeValueChanged(t){const[e,r]=this.refreshTokensForElement(t);this.tokensUnmatched(e),this.tokensMatched(r)}elementUnmatchedAttribute(t){this.tokensUnmatched(this.tokensByElement.getValuesForKey(t))}tokensMatched(t){t.forEach((t=>this.tokenMatched(t)))}tokensUnmatched(t){t.forEach((t=>this.tokenUnmatched(t)))}tokenMatched(t){this.delegate.tokenMatched(t),this.tokensByElement.add(t.element,t)}tokenUnmatched(t){this.delegate.tokenUnmatched(t),this.tokensByElement.delete(t.element,t)}refreshTokensForElement(t){const e=this.tokensByElement.getValuesForKey(t),r=this.readTokensForElement(t),i=function(t,e){const r=Math.max(t.length,e.length);return Array.from({length:r},((r,i)=>[t[i],e[i]]))}(e,r).findIndex((([t,e])=>{return i=e,!((r=t)&&i&&r.index==i.index&&r.content==i.content);var r,i}));return-1==i?[[],[]]:[e.slice(i),r.slice(i)]}readTokensForElement(t){const e=this.attributeName;return function(t,e,r){return t.trim().split(/\s+/).filter((t=>t.length)).map(((t,i)=>({element:e,attributeName:r,content:t,index:i})))}(t.getAttribute(e)||"",t,e)}}class A{constructor(t,e,r){this.tokenListObserver=new k(t,e,this),this.delegate=r,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}get started(){return this.tokenListObserver.started}start(){this.tokenListObserver.start()}stop(){this.tokenListObserver.stop()}refresh(){this.tokenListObserver.refresh()}get element(){return this.tokenListObserver.element}get attributeName(){return this.tokenListObserver.attributeName}tokenMatched(t){const{element:e}=t,{value:r}=this.fetchParseResultForToken(t);r&&(this.fetchValuesByTokenForElement(e).set(t,r),this.delegate.elementMatchedValue(e,r))}tokenUnmatched(t){const{element:e}=t,{value:r}=this.fetchParseResultForToken(t);r&&(this.fetchValuesByTokenForElement(e).delete(t),this.delegate.elementUnmatchedValue(e,r))}fetchParseResultForToken(t){let e=this.parseResultsByToken.get(t);return e||(e=this.parseToken(t),this.parseResultsByToken.set(t,e)),e}fetchValuesByTokenForElement(t){let e=this.valuesByTokenByElement.get(t);return e||(e=new Map,this.valuesByTokenByElement.set(t,e)),e}parseToken(t){try{return{value:this.delegate.parseValueForToken(t)}}catch(t){return{error:t}}}}class M{constructor(t,e){this.context=t,this.delegate=e,this.bindingsByAction=new Map}start(){this.valueListObserver||(this.valueListObserver=new A(this.element,this.actionAttribute,this),this.valueListObserver.start())}stop(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())}get element(){return this.context.element}get identifier(){return this.context.identifier}get actionAttribute(){return this.schema.actionAttribute}get schema(){return this.context.schema}get bindings(){return Array.from(this.bindingsByAction.values())}connectAction(t){const e=new v(this.context,t);this.bindingsByAction.set(t,e),this.delegate.bindingConnected(e)}disconnectAction(t){const e=this.bindingsByAction.get(t);e&&(this.bindingsByAction.delete(t),this.delegate.bindingDisconnected(e))}disconnectAllActions(){this.bindings.forEach((t=>this.delegate.bindingDisconnected(t,!0))),this.bindingsByAction.clear()}parseValueForToken(t){const e=class{constructor(t,e,r,i){this.element=t,this.index=e,this.eventTarget=r.eventTarget||t,this.eventName=r.eventName||function(t){const e=t.tagName.toLowerCase();if(e in m)return m[e](t)}(t)||g("missing event name"),this.eventOptions=r.eventOptions||{},this.identifier=r.identifier||g("missing identifier"),this.methodName=r.methodName||g("missing method name"),this.keyFilter=r.keyFilter||"",this.schema=i}static forToken(t,e){return new this(t.element,t.index,function(t){const e=t.trim().match(s)||[];let r=e[2],i=e[3];return i&&!["keydown","keyup","keypress"].includes(r)&&(r+=`.${i}`,i=""),{eventTarget:a(e[4]),eventName:r,eventOptions:e[7]?(n=e[7],n.split(":").reduce(((t,e)=>Object.assign(t,{[e.replace(/^!/,"")]:!/^!/.test(e)})),{})):{},identifier:e[5],methodName:e[6],keyFilter:e[1]||i};var n}(t.content),e)}toString(){const t=this.keyFilter?`.${this.keyFilter}`:"",e=this.eventTargetName?`@${this.eventTargetName}`:"";return`${this.eventName}${t}${e}->${this.identifier}#${this.methodName}`}shouldIgnoreKeyboardEvent(t){if(!this.keyFilter)return!1;const e=this.keyFilter.split("+");if(this.keyFilterDissatisfied(t,e))return!0;const r=e.filter((t=>!f.includes(t)))[0];return!!r&&(p(this.keyMappings,r)||g(`contains unknown key filter: ${this.keyFilter}`),this.keyMappings[r].toLowerCase()!==t.key.toLowerCase())}shouldIgnoreMouseEvent(t){if(!this.keyFilter)return!1;const e=[this.keyFilter];return!!this.keyFilterDissatisfied(t,e)}get params(){const t={},e=new RegExp(`^data-${this.identifier}-(.+)-param$`,"i");for(const{name:r,value:i}of Array.from(this.element.attributes)){const n=r.match(e),o=n&&n[1];o&&(t[l(o)]=y(i))}return t}get eventTargetName(){return(t=this.eventTarget)==window?"window":t==document?"document":void 0;var t}get keyMappings(){return this.schema.keyMappings}keyFilterDissatisfied(t,e){const[r,i,n,o]=f.map((t=>e.includes(t)));return t.metaKey!==r||t.ctrlKey!==i||t.altKey!==n||t.shiftKey!==o}}.forToken(t,this.schema);if(e.identifier==this.identifier)return e}elementMatchedValue(t,e){this.connectAction(e)}elementUnmatchedValue(t,e){this.disconnectAction(e)}}class C{constructor(t,e){this.context=t,this.receiver=e,this.stringMapObserver=new P(this.element,this),this.valueDescriptorMap=this.controller.valueDescriptorMap}start(){this.stringMapObserver.start(),this.invokeChangedCallbacksForDefaultValues()}stop(){this.stringMapObserver.stop()}get element(){return this.context.element}get controller(){return this.context.controller}getStringMapKeyForAttribute(t){if(t in this.valueDescriptorMap)return this.valueDescriptorMap[t].name}stringMapKeyAdded(t,e){const r=this.valueDescriptorMap[e];this.hasValue(t)||this.invokeChangedCallback(t,r.writer(this.receiver[t]),r.writer(r.defaultValue))}stringMapValueChanged(t,e,r){const i=this.valueDescriptorNameMap[e];null!==t&&(null===r&&(r=i.writer(i.defaultValue)),this.invokeChangedCallback(e,t,r))}stringMapKeyRemoved(t,e,r){const i=this.valueDescriptorNameMap[t];this.hasValue(t)?this.invokeChangedCallback(t,i.writer(this.receiver[t]),r):this.invokeChangedCallback(t,i.writer(i.defaultValue),r)}invokeChangedCallbacksForDefaultValues(){for(const{key:t,name:e,defaultValue:r,writer:i}of this.valueDescriptors)null==r||this.controller.data.has(t)||this.invokeChangedCallback(e,i(r),void 0)}invokeChangedCallback(t,e,r){const i=`${t}Changed`,n=this.receiver[i];if("function"==typeof n){const i=this.valueDescriptorNameMap[t];try{const t=i.reader(e);let o=r;r&&(o=i.reader(r)),n.call(this.receiver,t,o)}catch(t){throw t instanceof TypeError&&(t.message=`Stimulus Value "${this.context.identifier}.${i.name}" - ${t.message}`),t}}}get valueDescriptors(){const{valueDescriptorMap:t}=this;return Object.keys(t).map((e=>t[e]))}get valueDescriptorNameMap(){const t={};return Object.keys(this.valueDescriptorMap).forEach((e=>{const r=this.valueDescriptorMap[e];t[r.name]=r})),t}hasValue(t){const e=`has${u(this.valueDescriptorNameMap[t].name)}`;return this.receiver[e]}}class I{constructor(t,e){this.context=t,this.delegate=e,this.targetsByName=new E}start(){this.tokenListObserver||(this.tokenListObserver=new k(this.element,this.attributeName,this),this.tokenListObserver.start())}stop(){this.tokenListObserver&&(this.disconnectAllTargets(),this.tokenListObserver.stop(),delete this.tokenListObserver)}tokenMatched({element:t,content:e}){this.scope.containsElement(t)&&this.connectTarget(t,e)}tokenUnmatched({element:t,content:e}){this.disconnectTarget(t,e)}connectTarget(t,e){var r;this.targetsByName.has(e,t)||(this.targetsByName.add(e,t),null===(r=this.tokenListObserver)||void 0===r||r.pause((()=>this.delegate.targetConnected(t,e))))}disconnectTarget(t,e){var r;this.targetsByName.has(e,t)&&(this.targetsByName.delete(e,t),null===(r=this.tokenListObserver)||void 0===r||r.pause((()=>this.delegate.targetDisconnected(t,e))))}disconnectAllTargets(){for(const t of this.targetsByName.keys)for(const e of this.targetsByName.getValuesForKey(t))this.disconnectTarget(e,t)}get attributeName(){return`data-${this.context.identifier}-target`}get element(){return this.context.element}get scope(){return this.context.scope}}function O(t,e){const r=D(t);return Array.from(r.reduce(((t,r)=>(function(t,e){const r=t[e];return Array.isArray(r)?r:[]}(r,e).forEach((e=>t.add(e))),t)),new Set))}function L(t,e){return D(t).reduce(((t,r)=>(t.push(...function(t,e){const r=t[e];return r?Object.keys(r).map((t=>[t,r[t]])):[]}(r,e)),t)),[])}function D(t){const e=[];for(;t;)e.push(t),t=Object.getPrototypeOf(t);return e.reverse()}class R{constructor(t,e){this.started=!1,this.context=t,this.delegate=e,this.outletsByName=new E,this.outletElementsByName=new E,this.selectorObserverMap=new Map,this.attributeObserverMap=new Map}start(){this.started||(this.outletDefinitions.forEach((t=>{this.setupSelectorObserverForOutlet(t),this.setupAttributeObserverForOutlet(t)})),this.started=!0,this.dependentContexts.forEach((t=>t.refresh())))}refresh(){this.selectorObserverMap.forEach((t=>t.refresh())),this.attributeObserverMap.forEach((t=>t.refresh()))}stop(){this.started&&(this.started=!1,this.disconnectAllOutlets(),this.stopSelectorObservers(),this.stopAttributeObservers())}stopSelectorObservers(){this.selectorObserverMap.size>0&&(this.selectorObserverMap.forEach((t=>t.stop())),this.selectorObserverMap.clear())}stopAttributeObservers(){this.attributeObserverMap.size>0&&(this.attributeObserverMap.forEach((t=>t.stop())),this.attributeObserverMap.clear())}selectorMatched(t,e,{outletName:r}){const i=this.getOutlet(t,r);i&&this.connectOutlet(i,t,r)}selectorUnmatched(t,e,{outletName:r}){const i=this.getOutletFromMap(t,r);i&&this.disconnectOutlet(i,t,r)}selectorMatchElement(t,{outletName:e}){const r=this.selector(e),i=this.hasOutlet(t,e),n=t.matches(`[${this.schema.controllerAttribute}~=${e}]`);return!!r&&(i&&n&&t.matches(r))}elementMatchedAttribute(t,e){const r=this.getOutletNameFromOutletAttributeName(e);r&&this.updateSelectorObserverForOutlet(r)}elementAttributeValueChanged(t,e){const r=this.getOutletNameFromOutletAttributeName(e);r&&this.updateSelectorObserverForOutlet(r)}elementUnmatchedAttribute(t,e){const r=this.getOutletNameFromOutletAttributeName(e);r&&this.updateSelectorObserverForOutlet(r)}connectOutlet(t,e,r){var i;this.outletElementsByName.has(r,e)||(this.outletsByName.add(r,t),this.outletElementsByName.add(r,e),null===(i=this.selectorObserverMap.get(r))||void 0===i||i.pause((()=>this.delegate.outletConnected(t,e,r))))}disconnectOutlet(t,e,r){var i;this.outletElementsByName.has(r,e)&&(this.outletsByName.delete(r,t),this.outletElementsByName.delete(r,e),null===(i=this.selectorObserverMap.get(r))||void 0===i||i.pause((()=>this.delegate.outletDisconnected(t,e,r))))}disconnectAllOutlets(){for(const t of this.outletElementsByName.keys)for(const e of this.outletElementsByName.getValuesForKey(t))for(const r of this.outletsByName.getValuesForKey(t))this.disconnectOutlet(r,e,t)}updateSelectorObserverForOutlet(t){const e=this.selectorObserverMap.get(t);e&&(e.selector=this.selector(t))}setupSelectorObserverForOutlet(t){const e=this.selector(t),r=new S(document.body,e,this,{outletName:t});this.selectorObserverMap.set(t,r),r.start()}setupAttributeObserverForOutlet(t){const e=this.attributeNameForOutletName(t),r=new b(this.scope.element,e,this);this.attributeObserverMap.set(t,r),r.start()}selector(t){return this.scope.outlets.getSelectorForOutletName(t)}attributeNameForOutletName(t){return this.scope.schema.outletAttributeForScope(this.identifier,t)}getOutletNameFromOutletAttributeName(t){return this.outletDefinitions.find((e=>this.attributeNameForOutletName(e)===t))}get outletDependencies(){const t=new E;return this.router.modules.forEach((e=>{O(e.definition.controllerConstructor,"outlets").forEach((r=>t.add(r,e.identifier)))})),t}get outletDefinitions(){return this.outletDependencies.getKeysForValue(this.identifier)}get dependentControllerIdentifiers(){return this.outletDependencies.getValuesForKey(this.identifier)}get dependentContexts(){const t=this.dependentControllerIdentifiers;return this.router.contexts.filter((e=>t.includes(e.identifier)))}hasOutlet(t,e){return!!this.getOutlet(t,e)||!!this.getOutletFromMap(t,e)}getOutlet(t,e){return this.application.getControllerForElementAndIdentifier(t,e)}getOutletFromMap(t,e){return this.outletsByName.getValuesForKey(e).find((e=>e.element===t))}get scope(){return this.context.scope}get schema(){return this.context.schema}get identifier(){return this.context.identifier}get application(){return this.context.application}get router(){return this.application.router}}class F{constructor(t,e){this.logDebugActivity=(t,e={})=>{const{identifier:r,controller:i,element:n}=this;e=Object.assign({identifier:r,controller:i,element:n},e),this.application.logDebugActivity(this.identifier,t,e)},this.module=t,this.scope=e,this.controller=new t.controllerConstructor(this),this.bindingObserver=new M(this,this.dispatcher),this.valueObserver=new C(this,this.controller),this.targetObserver=new I(this,this),this.outletObserver=new R(this,this);try{this.controller.initialize(),this.logDebugActivity("initialize")}catch(t){this.handleError(t,"initializing controller")}}connect(){this.bindingObserver.start(),this.valueObserver.start(),this.targetObserver.start(),this.outletObserver.start();try{this.controller.connect(),this.logDebugActivity("connect")}catch(t){this.handleError(t,"connecting controller")}}refresh(){this.outletObserver.refresh()}disconnect(){try{this.controller.disconnect(),this.logDebugActivity("disconnect")}catch(t){this.handleError(t,"disconnecting controller")}this.outletObserver.stop(),this.targetObserver.stop(),this.valueObserver.stop(),this.bindingObserver.stop()}get application(){return this.module.application}get identifier(){return this.module.identifier}get schema(){return this.application.schema}get dispatcher(){return this.application.dispatcher}get element(){return this.scope.element}get parentElement(){return this.element.parentElement}handleError(t,e,r={}){const{identifier:i,controller:n,element:o}=this;r=Object.assign({identifier:i,controller:n,element:o},r),this.application.handleError(t,`Error ${e}`,r)}targetConnected(t,e){this.invokeControllerMethod(`${e}TargetConnected`,t)}targetDisconnected(t,e){this.invokeControllerMethod(`${e}TargetDisconnected`,t)}outletConnected(t,e,r){this.invokeControllerMethod(`${c(r)}OutletConnected`,t,e)}outletDisconnected(t,e,r){this.invokeControllerMethod(`${c(r)}OutletDisconnected`,t,e)}invokeControllerMethod(t,...e){const r=this.controller;"function"==typeof r[t]&&r[t](...e)}}function B(t){return function(t,e){const r=j(t),i=function(t,e){return z(e).reduce(((r,i)=>{const n=function(t,e,r){const i=Object.getOwnPropertyDescriptor(t,r);if(!i||!("value"in i)){const t=Object.getOwnPropertyDescriptor(e,r).value;return i&&(t.get=i.get||t.get,t.set=i.set||t.set),t}}(t,e,i);return n&&Object.assign(r,{[i]:n}),r}),{})}(t.prototype,e);return Object.defineProperties(r.prototype,i),r}(t,function(t){return O(t,"blessings").reduce(((e,r)=>{const i=r(t);for(const t in i){const r=e[t]||{};e[t]=Object.assign(r,i[t])}return e}),{})}(t))}const z="function"==typeof Object.getOwnPropertySymbols?t=>[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)]:Object.getOwnPropertyNames,j=(()=>{function t(t){function e(){return Reflect.construct(t,arguments,new.target)}return e.prototype=Object.create(t.prototype,{constructor:{value:e}}),Reflect.setPrototypeOf(e,t),e}try{return function(){const e=t((function(){this.a.call(this)}));e.prototype.a=function(){},new e}(),t}catch(t){return t=>class extends t{}}})();class N{constructor(t,e){this.application=t,this.definition=function(t){return{identifier:t.identifier,controllerConstructor:B(t.controllerConstructor)}}(e),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}get identifier(){return this.definition.identifier}get controllerConstructor(){return this.definition.controllerConstructor}get contexts(){return Array.from(this.connectedContexts)}connectContextForScope(t){const e=this.fetchContextForScope(t);this.connectedContexts.add(e),e.connect()}disconnectContextForScope(t){const e=this.contextsByScope.get(t);e&&(this.connectedContexts.delete(e),e.disconnect())}fetchContextForScope(t){let e=this.contextsByScope.get(t);return e||(e=new F(this,t),this.contextsByScope.set(t,e)),e}}class V{constructor(t){this.scope=t}has(t){return this.data.has(this.getDataKey(t))}get(t){return this.getAll(t)[0]}getAll(t){const e=this.data.get(this.getDataKey(t))||"";return e.match(/[^\s]+/g)||[]}getAttributeName(t){return this.data.getAttributeNameForKey(this.getDataKey(t))}getDataKey(t){return`${t}-class`}get data(){return this.scope.data}}class U{constructor(t){this.scope=t}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get(t){const e=this.getAttributeNameForKey(t);return this.element.getAttribute(e)}set(t,e){const r=this.getAttributeNameForKey(t);return this.element.setAttribute(r,e),this.get(t)}has(t){const e=this.getAttributeNameForKey(t);return this.element.hasAttribute(e)}delete(t){if(this.has(t)){const e=this.getAttributeNameForKey(t);return this.element.removeAttribute(e),!0}return!1}getAttributeNameForKey(t){return`data-${this.identifier}-${h(t)}`}}class ${constructor(t){this.warnedKeysByObject=new WeakMap,this.logger=t}warn(t,e,r){let i=this.warnedKeysByObject.get(t);i||(i=new Set,this.warnedKeysByObject.set(t,i)),i.has(e)||(i.add(e),this.logger.warn(r,t))}}function G(t,e){return`[${t}~="${e}"]`}class H{constructor(t){this.scope=t}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(t){return null!=this.find(t)}find(...t){return t.reduce(((t,e)=>t||this.findTarget(e)||this.findLegacyTarget(e)),void 0)}findAll(...t){return t.reduce(((t,e)=>[...t,...this.findAllTargets(e),...this.findAllLegacyTargets(e)]),[])}findTarget(t){const e=this.getSelectorForTargetName(t);return this.scope.findElement(e)}findAllTargets(t){const e=this.getSelectorForTargetName(t);return this.scope.findAllElements(e)}getSelectorForTargetName(t){return G(this.schema.targetAttributeForScope(this.identifier),t)}findLegacyTarget(t){const e=this.getLegacySelectorForTargetName(t);return this.deprecate(this.scope.findElement(e),t)}findAllLegacyTargets(t){const e=this.getLegacySelectorForTargetName(t);return this.scope.findAllElements(e).map((e=>this.deprecate(e,t)))}getLegacySelectorForTargetName(t){const e=`${this.identifier}.${t}`;return G(this.schema.targetAttribute,e)}deprecate(t,e){if(t){const{identifier:r}=this,i=this.schema.targetAttribute,n=this.schema.targetAttributeForScope(r);this.guide.warn(t,`target:${e}`,`Please replace ${i}="${r}.${e}" with ${n}="${e}". The ${i} attribute is deprecated and will be removed in a future version of Stimulus.`)}return t}get guide(){return this.scope.guide}}class q{constructor(t,e){this.scope=t,this.controllerElement=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(t){return null!=this.find(t)}find(...t){return t.reduce(((t,e)=>t||this.findOutlet(e)),void 0)}findAll(...t){return t.reduce(((t,e)=>[...t,...this.findAllOutlets(e)]),[])}getSelectorForOutletName(t){const e=this.schema.outletAttributeForScope(this.identifier,t);return this.controllerElement.getAttribute(e)}findOutlet(t){const e=this.getSelectorForOutletName(t);if(e)return this.findElement(e,t)}findAllOutlets(t){const e=this.getSelectorForOutletName(t);return e?this.findAllElements(e,t):[]}findElement(t,e){return this.scope.queryElements(t).filter((r=>this.matchesElement(r,t,e)))[0]}findAllElements(t,e){return this.scope.queryElements(t).filter((r=>this.matchesElement(r,t,e)))}matchesElement(t,e,r){const i=t.getAttribute(this.scope.schema.controllerAttribute)||"";return t.matches(e)&&i.split(" ").includes(r)}}class W{constructor(t,e,r,i){this.targets=new H(this),this.classes=new V(this),this.data=new U(this),this.containsElement=t=>t.closest(this.controllerSelector)===this.element,this.schema=t,this.element=e,this.identifier=r,this.guide=new $(i),this.outlets=new q(this.documentScope,e)}findElement(t){return this.element.matches(t)?this.element:this.queryElements(t).find(this.containsElement)}findAllElements(t){return[...this.element.matches(t)?[this.element]:[],...this.queryElements(t).filter(this.containsElement)]}queryElements(t){return Array.from(this.element.querySelectorAll(t))}get controllerSelector(){return G(this.schema.controllerAttribute,this.identifier)}get isDocumentScope(){return this.element===document.documentElement}get documentScope(){return this.isDocumentScope?this:new W(this.schema,document.documentElement,this.identifier,this.guide.logger)}}class Z{constructor(t,e,r){this.element=t,this.schema=e,this.delegate=r,this.valueListObserver=new A(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}start(){this.valueListObserver.start()}stop(){this.valueListObserver.stop()}get controllerAttribute(){return this.schema.controllerAttribute}parseValueForToken(t){const{element:e,content:r}=t;return this.parseValueForElementAndIdentifier(e,r)}parseValueForElementAndIdentifier(t,e){const r=this.fetchScopesByIdentifierForElement(t);let i=r.get(e);return i||(i=this.delegate.createScopeForElementAndIdentifier(t,e),r.set(e,i)),i}elementMatchedValue(t,e){const r=(this.scopeReferenceCounts.get(e)||0)+1;this.scopeReferenceCounts.set(e,r),1==r&&this.delegate.scopeConnected(e)}elementUnmatchedValue(t,e){const r=this.scopeReferenceCounts.get(e);r&&(this.scopeReferenceCounts.set(e,r-1),1==r&&this.delegate.scopeDisconnected(e))}fetchScopesByIdentifierForElement(t){let e=this.scopesByIdentifierByElement.get(t);return e||(e=new Map,this.scopesByIdentifierByElement.set(t,e)),e}}class X{constructor(t){this.application=t,this.scopeObserver=new Z(this.element,this.schema,this),this.scopesByIdentifier=new E,this.modulesByIdentifier=new Map}get element(){return this.application.element}get schema(){return this.application.schema}get logger(){return this.application.logger}get controllerAttribute(){return this.schema.controllerAttribute}get modules(){return Array.from(this.modulesByIdentifier.values())}get contexts(){return this.modules.reduce(((t,e)=>t.concat(e.contexts)),[])}start(){this.scopeObserver.start()}stop(){this.scopeObserver.stop()}loadDefinition(t){this.unloadIdentifier(t.identifier);const e=new N(this.application,t);this.connectModule(e);const r=t.controllerConstructor.afterLoad;r&&r.call(t.controllerConstructor,t.identifier,this.application)}unloadIdentifier(t){const e=this.modulesByIdentifier.get(t);e&&this.disconnectModule(e)}getContextForElementAndIdentifier(t,e){const r=this.modulesByIdentifier.get(e);if(r)return r.contexts.find((e=>e.element==t))}proposeToConnectScopeForElementAndIdentifier(t,e){const r=this.scopeObserver.parseValueForElementAndIdentifier(t,e);r?this.scopeObserver.elementMatchedValue(r.element,r):console.error(`Couldn't find or create scope for identifier: "${e}" and element:`,t)}handleError(t,e,r){this.application.handleError(t,e,r)}createScopeForElementAndIdentifier(t,e){return new W(this.schema,t,e,this.logger)}scopeConnected(t){this.scopesByIdentifier.add(t.identifier,t);const e=this.modulesByIdentifier.get(t.identifier);e&&e.connectContextForScope(t)}scopeDisconnected(t){this.scopesByIdentifier.delete(t.identifier,t);const e=this.modulesByIdentifier.get(t.identifier);e&&e.disconnectContextForScope(t)}connectModule(t){this.modulesByIdentifier.set(t.identifier,t);this.scopesByIdentifier.getValuesForKey(t.identifier).forEach((e=>t.connectContextForScope(e)))}disconnectModule(t){this.modulesByIdentifier.delete(t.identifier);this.scopesByIdentifier.getValuesForKey(t.identifier).forEach((e=>t.disconnectContextForScope(e)))}}const Y={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target",targetAttributeForScope:t=>`data-${t}-target`,outletAttributeForScope:(t,e)=>`data-${t}-${e}-outlet`,keyMappings:Object.assign(Object.assign({enter:"Enter",tab:"Tab",esc:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",home:"Home",end:"End",page_up:"PageUp",page_down:"PageDown"},K("abcdefghijklmnopqrstuvwxyz".split("").map((t=>[t,t])))),K("0123456789".split("").map((t=>[t,t]))))};function K(t){return t.reduce(((t,[e,r])=>Object.assign(Object.assign({},t),{[e]:r})),{})}class J{constructor(t=document.documentElement,e=Y){this.logger=console,this.debug=!1,this.logDebugActivity=(t,e,r={})=>{this.debug&&this.logFormattedMessage(t,e,r)},this.element=t,this.schema=e,this.dispatcher=new n(this),this.router=new X(this),this.actionDescriptorFilters=Object.assign({},o)}static start(t,e){const r=new this(t,e);return r.start(),r}async start(){await new Promise((t=>{"loading"==document.readyState?document.addEventListener("DOMContentLoaded",(()=>t())):t()})),this.logDebugActivity("application","starting"),this.dispatcher.start(),this.router.start(),this.logDebugActivity("application","start")}stop(){this.logDebugActivity("application","stopping"),this.dispatcher.stop(),this.router.stop(),this.logDebugActivity("application","stop")}register(t,e){this.load({identifier:t,controllerConstructor:e})}registerActionOption(t,e){this.actionDescriptorFilters[t]=e}load(t,...e){(Array.isArray(t)?t:[t,...e]).forEach((t=>{t.controllerConstructor.shouldLoad&&this.router.loadDefinition(t)}))}unload(t,...e){(Array.isArray(t)?t:[t,...e]).forEach((t=>this.router.unloadIdentifier(t)))}get controllers(){return this.router.contexts.map((t=>t.controller))}getControllerForElementAndIdentifier(t,e){const r=this.router.getContextForElementAndIdentifier(t,e);return r?r.controller:null}handleError(t,e,r){var i;this.logger.error("%s\n\n%o\n\n%o",e,t,r),null===(i=window.onerror)||void 0===i||i.call(window,e,"",0,0,t)}logFormattedMessage(t,e,r={}){r=Object.assign({application:this},r),this.logger.groupCollapsed(`${t} #${e}`),this.logger.log("details:",Object.assign({},r)),this.logger.groupEnd()}}function Q(t,e,r){return t.application.getControllerForElementAndIdentifier(e,r)}function tt(t,e,r){let i=Q(t,e,r);return i||(t.application.router.proposeToConnectScopeForElementAndIdentifier(e,r),i=Q(t,e,r),i||void 0)}function et([t,e],r){return function(t){const{token:e,typeDefinition:r}=t,i=`${h(e)}-value`,n=function(t){const{controller:e,token:r,typeDefinition:i}=t,n=function(t){const{controller:e,token:r,typeObject:i}=t,n=d(i.type),o=d(i.default),s=n&&o,a=n&&!o,l=!n&&o,c=rt(i.type),u=it(t.typeObject.default);if(a)return c;if(l)return u;if(c!==u){throw new Error(`The specified default value for the Stimulus Value "${e?`${e}.${r}`:r}" must match the defined type "${c}". The provided default value of "${i.default}" is of type "${u}".`)}if(s)return c}({controller:e,token:r,typeObject:i}),o=it(i),s=rt(i),a=n||o||s;if(a)return a;throw new Error(`Unknown value type "${e?`${e}.${i}`:r}" for "${r}" value`)}(t);return{type:n,key:i,name:l(i),get defaultValue(){return function(t){const e=rt(t);if(e)return nt[e];const r=p(t,"default"),i=p(t,"type"),n=t;if(r)return n.default;if(i){const{type:t}=n,e=rt(t);if(e)return nt[e]}return t}(r)},get hasCustomDefaultValue(){return void 0!==it(r)},reader:ot[n],writer:st[n]||st.default}}({controller:r,token:t,typeDefinition:e})}function rt(t){switch(t){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function it(t){switch(typeof t){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}return Array.isArray(t)?"array":"[object Object]"===Object.prototype.toString.call(t)?"object":void 0}const nt={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},ot={array(t){const e=JSON.parse(t);if(!Array.isArray(e))throw new TypeError(`expected value of type "array" but instead got value "${t}" of type "${it(e)}"`);return e},boolean:t=>!("0"==t||"false"==String(t).toLowerCase()),number:t=>Number(t.replace(/_/g,"")),object(t){const e=JSON.parse(t);if(null===e||"object"!=typeof e||Array.isArray(e))throw new TypeError(`expected value of type "object" but instead got value "${t}" of type "${it(e)}"`);return e},string:t=>t},st={default:function(t){return`${t}`},array:at,object:at};function at(t){return JSON.stringify(t)}class lt{constructor(t){this.context=t}static get shouldLoad(){return!0}static afterLoad(t,e){}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get outlets(){return this.scope.outlets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(t,{target:e=this.element,detail:r={},prefix:i=this.identifier,bubbles:n=!0,cancelable:o=!0}={}){const s=new CustomEvent(i?`${i}:${t}`:t,{detail:r,bubbles:n,cancelable:o});return e.dispatchEvent(s),s}}lt.blessings=[function(t){return O(t,"classes").reduce(((t,e)=>{return Object.assign(t,{[`${r=e}Class`]:{get(){const{classes:t}=this;if(t.has(r))return t.get(r);{const e=t.getAttributeName(r);throw new Error(`Missing attribute "${e}"`)}}},[`${r}Classes`]:{get(){return this.classes.getAll(r)}},[`has${u(r)}Class`]:{get(){return this.classes.has(r)}}});var r}),{})},function(t){return O(t,"targets").reduce(((t,e)=>{return Object.assign(t,{[`${r=e}Target`]:{get(){const t=this.targets.find(r);if(t)return t;throw new Error(`Missing target element "${r}" for "${this.identifier}" controller`)}},[`${r}Targets`]:{get(){return this.targets.findAll(r)}},[`has${u(r)}Target`]:{get(){return this.targets.has(r)}}});var r}),{})},function(t){const e=L(t,"values"),r={valueDescriptorMap:{get(){return e.reduce(((t,e)=>{const r=et(e,this.identifier),i=this.data.getAttributeNameForKey(r.key);return Object.assign(t,{[i]:r})}),{})}}};return e.reduce(((t,e)=>Object.assign(t,function(t,e){const r=et(t,e),{key:i,name:n,reader:o,writer:s}=r;return{[n]:{get(){const t=this.data.get(i);return null!==t?o(t):r.defaultValue},set(t){void 0===t?this.data.delete(i):this.data.set(i,s(t))}},[`has${u(n)}`]:{get(){return this.data.has(i)||r.hasCustomDefaultValue}}}}(e))),r)},function(t){return O(t,"outlets").reduce(((t,e)=>Object.assign(t,function(t){const e=c(t);return{[`${e}Outlet`]:{get(){const e=this.outlets.find(t),r=this.outlets.getSelectorForOutletName(t);if(e){const r=tt(this,e,t);if(r)return r;throw new Error(`The provided outlet element is missing an outlet controller "${t}" instance for host controller "${this.identifier}"`)}throw new Error(`Missing outlet element "${t}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${r}".`)}},[`${e}Outlets`]:{get(){const e=this.outlets.findAll(t);return e.length>0?e.map((e=>{const r=tt(this,e,t);if(r)return r;console.warn(`The provided outlet element is missing an outlet controller "${t}" instance for host controller "${this.identifier}"`,e)})).filter((t=>t)):[]}},[`${e}OutletElement`]:{get(){const e=this.outlets.find(t),r=this.outlets.getSelectorForOutletName(t);if(e)return e;throw new Error(`Missing outlet element "${t}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${r}".`)}},[`${e}OutletElements`]:{get(){return this.outlets.findAll(t)}},[`has${u(e)}Outlet`]:{get(){return this.outlets.has(t)}}}}(e))),{})}],lt.targets=[],lt.outlets=[],lt.values={}},89:(t,e,r)=>{"use strict";r.d(e,{dZ:()=>St}),function(){if(void 0===window.Reflect||void 0===window.customElements||window.customElements.polyfillWrapFlushCallback)return;const t=HTMLElement,e=function(){return Reflect.construct(t,[],this.constructor)};window.HTMLElement=e,HTMLElement.prototype=t.prototype,HTMLElement.prototype.constructor=HTMLElement,Object.setPrototypeOf(HTMLElement,t)}(),function(t){function e(t,e,r){throw new t("Failed to execute 'requestSubmit' on 'HTMLFormElement': "+e+".",r)}"function"!=typeof t.requestSubmit&&(t.requestSubmit=function(t){t?(!function(t,r){t instanceof HTMLElement||e(TypeError,"parameter 1 is not of type 'HTMLElement'"),"submit"==t.type||e(TypeError,"The specified element is not a submit button"),t.form==r||e(DOMException,"The specified element is not owned by this form element","NotFoundError")}(t,this),t.click()):((t=document.createElement("input")).type="submit",t.hidden=!0,this.appendChild(t),t.click(),this.removeChild(t))})}(HTMLFormElement.prototype);const i=new WeakMap;function n(t){const e=function(t){const e=t instanceof Element?t:t instanceof Node?t.parentElement:null,r=e?e.closest("input, button"):null;return"submit"==(null==r?void 0:r.type)?r:null}(t.target);e&&e.form&&i.set(e.form,e)}var o,s,a,l,c,u;!function(){if("submitter"in Event.prototype)return;let t=window.Event.prototype;if("SubmitEvent"in window&&/Apple Computer/.test(navigator.vendor))t=window.SubmitEvent.prototype;else if("SubmitEvent"in window)return;addEventListener("click",n,!0),Object.defineProperty(t,"submitter",{get(){if("submit"==this.type&&this.target instanceof HTMLFormElement)return i.get(this.target)}})}(),function(t){t.eager="eager",t.lazy="lazy"}(o||(o={}));class h extends HTMLElement{static get observedAttributes(){return["disabled","complete","loading","src"]}constructor(){super(),this.loaded=Promise.resolve(),this.delegate=new h.delegateConstructor(this)}connectedCallback(){this.delegate.connect()}disconnectedCallback(){this.delegate.disconnect()}reload(){return this.delegate.sourceURLReloaded()}attributeChangedCallback(t){"loading"==t?this.delegate.loadingStyleChanged():"complete"==t?this.delegate.completeChanged():"src"==t?this.delegate.sourceURLChanged():this.delegate.disabledChanged()}get src(){return this.getAttribute("src")}set src(t){t?this.setAttribute("src",t):this.removeAttribute("src")}get loading(){return function(t){if("lazy"===t.toLowerCase())return o.lazy;return o.eager}(this.getAttribute("loading")||"")}set loading(t){t?this.setAttribute("loading",t):this.removeAttribute("loading")}get disabled(){return this.hasAttribute("disabled")}set disabled(t){t?this.setAttribute("disabled",""):this.removeAttribute("disabled")}get autoscroll(){return this.hasAttribute("autoscroll")}set autoscroll(t){t?this.setAttribute("autoscroll",""):this.removeAttribute("autoscroll")}get complete(){return!this.delegate.isLoading}get isActive(){return this.ownerDocument===document&&!this.isPreview}get isPreview(){var t,e;return null===(e=null===(t=this.ownerDocument)||void 0===t?void 0:t.documentElement)||void 0===e?void 0:e.hasAttribute("data-turbo-preview")}}function d(t){return new URL(t.toString(),document.baseURI)}function p(t){let e;return t.hash?t.hash.slice(1):(e=t.href.match(/#(.*)$/))?e[1]:void 0}function f(t,e){return d((null==e?void 0:e.getAttribute("formaction"))||t.getAttribute("action")||t.action)}function m(t){return(function(t){return function(t){return t.pathname.split("/").slice(1)}(t).slice(-1)[0]}(t).match(/\.[^.]*$/)||[])[0]||""}function g(t,e){const r=function(t){return e=t.origin+t.pathname,e.endsWith("/")?e:e+"/";var e}(e);return t.href===d(r).href||t.href.startsWith(r)}function y(t,e){return g(t,e)&&!!m(t).match(/^(?:|\.(?:htm|html|xhtml|php))$/)}function v(t){const e=p(t);return null!=e?t.href.slice(0,-(e.length+1)):t.href}function _(t){return v(t)}class b{constructor(t){this.response=t}get succeeded(){return this.response.ok}get failed(){return!this.succeeded}get clientError(){return this.statusCode>=400&&this.statusCode<=499}get serverError(){return this.statusCode>=500&&this.statusCode<=599}get redirected(){return this.response.redirected}get location(){return d(this.response.url)}get isHTML(){return this.contentType&&this.contentType.match(/^(?:text\/([^\s;,]+\b)?html|application\/xhtml\+xml)\b/)}get statusCode(){return this.response.status}get contentType(){return this.header("Content-Type")}get responseText(){return this.response.clone().text()}get responseHTML(){return this.isHTML?this.response.clone().text():Promise.resolve(void 0)}header(t){return this.response.headers.get(t)}}function x(t){if("false"==t.getAttribute("data-turbo-eval"))return t;{const e=document.createElement("script"),r=D("csp-nonce");return r&&(e.nonce=r),e.textContent=t.textContent,e.async=!1,function(t,e){for(const{name:r,value:i}of e.attributes)t.setAttribute(r,i)}(e,t),e}}function w(t,{target:e,cancelable:r,detail:i}={}){const n=new CustomEvent(t,{cancelable:r,bubbles:!0,composed:!0,detail:i});return e&&e.isConnected?e.dispatchEvent(n):document.documentElement.dispatchEvent(n),n}function T(){return new Promise((t=>requestAnimationFrame((()=>t()))))}function E(t=""){return(new DOMParser).parseFromString(t,"text/html")}function S(t,...e){const r=function(t,e){return t.reduce(((t,r,i)=>t+r+(null==e[i]?"":e[i])),"")}(t,e).replace(/^\n/,"").split("\n"),i=r[0].match(/^\s+/),n=i?i[0].length:0;return r.map((t=>t.slice(n))).join("\n")}function P(){return Array.from({length:36}).map(((t,e)=>8==e||13==e||18==e||23==e?"-":14==e?"4":19==e?(Math.floor(4*Math.random())+8).toString(16):Math.floor(15*Math.random()).toString(16))).join("")}function k(t,...e){for(const r of e.map((e=>null==e?void 0:e.getAttribute(t))))if("string"==typeof r)return r;return null}function A(...t){for(const e of t)"turbo-frame"==e.localName&&e.setAttribute("busy",""),e.setAttribute("aria-busy","true")}function M(...t){for(const e of t)"turbo-frame"==e.localName&&e.removeAttribute("busy"),e.removeAttribute("aria-busy")}function C(t,e=2e3){return new Promise((r=>{const i=()=>{t.removeEventListener("error",i),t.removeEventListener("load",i),r()};t.addEventListener("load",i,{once:!0}),t.addEventListener("error",i,{once:!0}),setTimeout(r,e)}))}function I(t){switch(t){case"replace":return history.replaceState;case"advance":case"restore":return history.pushState}}function O(...t){const e=k("data-turbo-action",...t);return function(t){return"advance"==t||"replace"==t||"restore"==t}(e)?e:null}function L(t){return document.querySelector(`meta[name="${t}"]`)}function D(t){const e=L(t);return e&&e.content}function R(t,e){var r;if(t instanceof Element)return t.closest(e)||R(t.assignedSlot||(null===(r=t.getRootNode())||void 0===r?void 0:r.host),e)}!function(t){t[t.get=0]="get",t[t.post=1]="post",t[t.put=2]="put",t[t.patch=3]="patch",t[t.delete=4]="delete"}(s||(s={}));class F{constructor(t,e,r,i=new URLSearchParams,n=null){this.abortController=new AbortController,this.resolveRequestPromise=t=>{},this.delegate=t,this.method=e,this.headers=this.defaultHeaders,this.body=i,this.url=r,this.target=n}get location(){return this.url}get params(){return this.url.searchParams}get entries(){return this.body?Array.from(this.body.entries()):[]}cancel(){this.abortController.abort()}async perform(){const{fetchOptions:t}=this;this.delegate.prepareRequest(this),await this.allowRequestToBeIntercepted(t);try{this.delegate.requestStarted(this);const e=await fetch(this.url.href,t);return await this.receive(e)}catch(t){if("AbortError"!==t.name)throw this.willDelegateErrorHandling(t)&&this.delegate.requestErrored(this,t),t}finally{this.delegate.requestFinished(this)}}async receive(t){const e=new b(t);return w("turbo:before-fetch-response",{cancelable:!0,detail:{fetchResponse:e},target:this.target}).defaultPrevented?this.delegate.requestPreventedHandlingResponse(this,e):e.succeeded?this.delegate.requestSucceededWithResponse(this,e):this.delegate.requestFailedWithResponse(this,e),e}get fetchOptions(){var t;return{method:s[this.method].toUpperCase(),credentials:"same-origin",headers:this.headers,redirect:"follow",body:this.isSafe?null:this.body,signal:this.abortSignal,referrer:null===(t=this.delegate.referrer)||void 0===t?void 0:t.href}}get defaultHeaders(){return{Accept:"text/html, application/xhtml+xml"}}get isSafe(){return this.method===s.get}get abortSignal(){return this.abortController.signal}acceptResponseType(t){this.headers.Accept=[t,this.headers.Accept].join(", ")}async allowRequestToBeIntercepted(t){const e=new Promise((t=>this.resolveRequestPromise=t));w("turbo:before-fetch-request",{cancelable:!0,detail:{fetchOptions:t,url:this.url,resume:this.resolveRequestPromise},target:this.target}).defaultPrevented&&await e}willDelegateErrorHandling(t){return!w("turbo:fetch-request-error",{target:this.target,cancelable:!0,detail:{request:this,error:t}}).defaultPrevented}}class B{constructor(t,e){this.started=!1,this.intersect=t=>{const e=t.slice(-1)[0];(null==e?void 0:e.isIntersecting)&&this.delegate.elementAppearedInViewport(this.element)},this.delegate=t,this.element=e,this.intersectionObserver=new IntersectionObserver(this.intersect)}start(){this.started||(this.started=!0,this.intersectionObserver.observe(this.element))}stop(){this.started&&(this.started=!1,this.intersectionObserver.unobserve(this.element))}}class z{static wrap(t){return"string"==typeof t?new this(function(t){const e=document.createElement("template");return e.innerHTML=t,e.content}(t)):t}constructor(t){this.fragment=function(t){for(const e of t.querySelectorAll("turbo-stream")){const t=document.importNode(e,!0);for(const e of t.templateElement.content.querySelectorAll("script"))e.replaceWith(x(e));e.replaceWith(t)}return t}(t)}}z.contentType="text/vnd.turbo-stream.html",function(t){t[t.initialized=0]="initialized",t[t.requesting=1]="requesting",t[t.waiting=2]="waiting",t[t.receiving=3]="receiving",t[t.stopping=4]="stopping",t[t.stopped=5]="stopped"}(a||(a={})),function(t){t.urlEncoded="application/x-www-form-urlencoded",t.multipart="multipart/form-data",t.plain="text/plain"}(l||(l={}));class j{static confirmMethod(t,e,r){return Promise.resolve(confirm(t))}constructor(t,e,r,i=!1){this.state=a.initialized,this.delegate=t,this.formElement=e,this.submitter=r,this.formData=function(t,e){const r=new FormData(t),i=null==e?void 0:e.getAttribute("name"),n=null==e?void 0:e.getAttribute("value");i&&r.append(i,n||"");return r}(e,r),this.location=d(this.action),this.method==s.get&&function(t,e){const r=new URLSearchParams;for(const[t,i]of e)i instanceof File||r.append(t,i);t.search=r.toString()}(this.location,[...this.body.entries()]),this.fetchRequest=new F(this,this.method,this.location,this.body,this.formElement),this.mustRedirect=i}get method(){var t;return function(t){switch(t.toLowerCase()){case"get":return s.get;case"post":return s.post;case"put":return s.put;case"patch":return s.patch;case"delete":return s.delete}}(((null===(t=this.submitter)||void 0===t?void 0:t.getAttribute("formmethod"))||this.formElement.getAttribute("method")||"").toLowerCase())||s.get}get action(){var t;const e="string"==typeof this.formElement.action?this.formElement.action:null;return(null===(t=this.submitter)||void 0===t?void 0:t.hasAttribute("formaction"))?this.submitter.getAttribute("formaction")||"":this.formElement.getAttribute("action")||e||""}get body(){return this.enctype==l.urlEncoded||this.method==s.get?new URLSearchParams(this.stringFormData):this.formData}get enctype(){var t;return function(t){switch(t.toLowerCase()){case l.multipart:return l.multipart;case l.plain:return l.plain;default:return l.urlEncoded}}((null===(t=this.submitter)||void 0===t?void 0:t.getAttribute("formenctype"))||this.formElement.enctype)}get isSafe(){return this.fetchRequest.isSafe}get stringFormData(){return[...this.formData].reduce(((t,[e,r])=>t.concat("string"==typeof r?[[e,r]]:[])),[])}async start(){const{initialized:t,requesting:e}=a,r=k("data-turbo-confirm",this.submitter,this.formElement);if("string"==typeof r){if(!await j.confirmMethod(r,this.formElement,this.submitter))return}if(this.state==t)return this.state=e,this.fetchRequest.perform()}stop(){const{stopping:t,stopped:e}=a;if(this.state!=t&&this.state!=e)return this.state=t,this.fetchRequest.cancel(),!0}prepareRequest(t){if(!t.isSafe){const e=function(t){if(null!=t){const e=(document.cookie?document.cookie.split("; "):[]).find((e=>e.startsWith(t)));if(e){const t=e.split("=").slice(1).join("=");return t?decodeURIComponent(t):void 0}}}(D("csrf-param"))||D("csrf-token");e&&(t.headers["X-CSRF-Token"]=e)}this.requestAcceptsTurboStreamResponse(t)&&t.acceptResponseType(z.contentType)}requestStarted(t){var e;this.state=a.waiting,null===(e=this.submitter)||void 0===e||e.setAttribute("disabled",""),this.setSubmitsWith(),w("turbo:submit-start",{target:this.formElement,detail:{formSubmission:this}}),this.delegate.formSubmissionStarted(this)}requestPreventedHandlingResponse(t,e){this.result={success:e.succeeded,fetchResponse:e}}requestSucceededWithResponse(t,e){if(e.clientError||e.serverError)this.delegate.formSubmissionFailedWithResponse(this,e);else if(this.requestMustRedirect(t)&&function(t){return 200==t.statusCode&&!t.redirected}(e)){const t=new Error("Form responses must redirect to another location");this.delegate.formSubmissionErrored(this,t)}else this.state=a.receiving,this.result={success:!0,fetchResponse:e},this.delegate.formSubmissionSucceededWithResponse(this,e)}requestFailedWithResponse(t,e){this.result={success:!1,fetchResponse:e},this.delegate.formSubmissionFailedWithResponse(this,e)}requestErrored(t,e){this.result={success:!1,error:e},this.delegate.formSubmissionErrored(this,e)}requestFinished(t){var e;this.state=a.stopped,null===(e=this.submitter)||void 0===e||e.removeAttribute("disabled"),this.resetSubmitterText(),w("turbo:submit-end",{target:this.formElement,detail:Object.assign({formSubmission:this},this.result)}),this.delegate.formSubmissionFinished(this)}setSubmitsWith(){if(this.submitter&&this.submitsWith)if(this.submitter.matches("button"))this.originalSubmitText=this.submitter.innerHTML,this.submitter.innerHTML=this.submitsWith;else if(this.submitter.matches("input")){const t=this.submitter;this.originalSubmitText=t.value,t.value=this.submitsWith}}resetSubmitterText(){if(this.submitter&&this.originalSubmitText)if(this.submitter.matches("button"))this.submitter.innerHTML=this.originalSubmitText;else if(this.submitter.matches("input")){this.submitter.value=this.originalSubmitText}}requestMustRedirect(t){return!t.isSafe&&this.mustRedirect}requestAcceptsTurboStreamResponse(t){return!t.isSafe||function(t,...e){return e.some((e=>e&&e.hasAttribute(t)))}("data-turbo-stream",this.submitter,this.formElement)}get submitsWith(){var t;return null===(t=this.submitter)||void 0===t?void 0:t.getAttribute("data-turbo-submits-with")}}class N{constructor(t){this.element=t}get activeElement(){return this.element.ownerDocument.activeElement}get children(){return[...this.element.children]}hasAnchor(t){return null!=this.getElementForAnchor(t)}getElementForAnchor(t){return t?this.element.querySelector(`[id='${t}'], a[name='${t}']`):null}get isConnected(){return this.element.isConnected}get firstAutofocusableElement(){for(const t of this.element.querySelectorAll("[autofocus]"))if(null==t.closest("[inert], :disabled, [hidden], details:not([open]), dialog:not([open])"))return t;return null}get permanentElements(){return U(this.element)}getPermanentElementById(t){return V(this.element,t)}getPermanentElementMapForSnapshot(t){const e={};for(const r of this.permanentElements){const{id:i}=r,n=t.getPermanentElementById(i);n&&(e[i]=[r,n])}return e}}function V(t,e){return t.querySelector(`#${e}[data-turbo-permanent]`)}function U(t){return t.querySelectorAll("[id][data-turbo-permanent]")}class ${constructor(t,e){this.started=!1,this.submitCaptured=()=>{this.eventTarget.removeEventListener("submit",this.submitBubbled,!1),this.eventTarget.addEventListener("submit",this.submitBubbled,!1)},this.submitBubbled=t=>{if(!t.defaultPrevented){const e=t.target instanceof HTMLFormElement?t.target:void 0,r=t.submitter||void 0;e&&function(t,e){return"dialog"!=((null==e?void 0:e.getAttribute("formmethod"))||t.getAttribute("method"))}(e,r)&&function(t,e){if((null==e?void 0:e.hasAttribute("formtarget"))||t.hasAttribute("target")){const r=(null==e?void 0:e.getAttribute("formtarget"))||t.target;for(const t of document.getElementsByName(r))if(t instanceof HTMLIFrameElement)return!1;return!0}return!0}(e,r)&&this.delegate.willSubmitForm(e,r)&&(t.preventDefault(),t.stopImmediatePropagation(),this.delegate.formSubmitted(e,r))}},this.delegate=t,this.eventTarget=e}start(){this.started||(this.eventTarget.addEventListener("submit",this.submitCaptured,!0),this.started=!0)}stop(){this.started&&(this.eventTarget.removeEventListener("submit",this.submitCaptured,!0),this.started=!1)}}class G{constructor(t,e){this.resolveRenderPromise=t=>{},this.resolveInterceptionPromise=t=>{},this.delegate=t,this.element=e}scrollToAnchor(t){const e=this.snapshot.getElementForAnchor(t);e?(this.scrollToElement(e),this.focusElement(e)):this.scrollToPosition({x:0,y:0})}scrollToAnchorFromLocation(t){this.scrollToAnchor(p(t))}scrollToElement(t){t.scrollIntoView()}focusElement(t){t instanceof HTMLElement&&(t.hasAttribute("tabindex")?t.focus():(t.setAttribute("tabindex","-1"),t.focus(),t.removeAttribute("tabindex")))}scrollToPosition({x:t,y:e}){this.scrollRoot.scrollTo(t,e)}scrollToTop(){this.scrollToPosition({x:0,y:0})}get scrollRoot(){return window}async render(t){const{isPreview:e,shouldRender:r,newSnapshot:i}=t;if(r)try{this.renderPromise=new Promise((t=>this.resolveRenderPromise=t)),this.renderer=t,await this.prepareToRenderSnapshot(t);const r=new Promise((t=>this.resolveInterceptionPromise=t)),n={resume:this.resolveInterceptionPromise,render:this.renderer.renderElement};this.delegate.allowsImmediateRender(i,n)||await r,await this.renderSnapshot(t),this.delegate.viewRenderedSnapshot(i,e),this.delegate.preloadOnLoadLinksForView(this.element),this.finishRenderingSnapshot(t)}finally{delete this.renderer,this.resolveRenderPromise(void 0),delete this.renderPromise}else this.invalidate(t.reloadReason)}invalidate(t){this.delegate.viewInvalidated(t)}async prepareToRenderSnapshot(t){this.markAsPreview(t.isPreview),await t.prepareToRender()}markAsPreview(t){t?this.element.setAttribute("data-turbo-preview",""):this.element.removeAttribute("data-turbo-preview")}async renderSnapshot(t){await t.render()}finishRenderingSnapshot(t){t.finishRendering()}}class H extends G{missing(){this.element.innerHTML='<strong class="turbo-frame-error">Content missing</strong>'}get snapshot(){return new N(this.element)}}class q{constructor(t,e){this.clickBubbled=t=>{this.respondsToEventTarget(t.target)?this.clickEvent=t:delete this.clickEvent},this.linkClicked=t=>{this.clickEvent&&this.respondsToEventTarget(t.target)&&t.target instanceof Element&&this.delegate.shouldInterceptLinkClick(t.target,t.detail.url,t.detail.originalEvent)&&(this.clickEvent.preventDefault(),t.preventDefault(),this.delegate.linkClickIntercepted(t.target,t.detail.url,t.detail.originalEvent)),delete this.clickEvent},this.willVisit=t=>{delete this.clickEvent},this.delegate=t,this.element=e}start(){this.element.addEventListener("click",this.clickBubbled),document.addEventListener("turbo:click",this.linkClicked),document.addEventListener("turbo:before-visit",this.willVisit)}stop(){this.element.removeEventListener("click",this.clickBubbled),document.removeEventListener("turbo:click",this.linkClicked),document.removeEventListener("turbo:before-visit",this.willVisit)}respondsToEventTarget(t){const e=t instanceof Element?t:t instanceof Node?t.parentElement:null;return e&&e.closest("turbo-frame, html")==this.element}}class W{constructor(t,e){this.started=!1,this.clickCaptured=()=>{this.eventTarget.removeEventListener("click",this.clickBubbled,!1),this.eventTarget.addEventListener("click",this.clickBubbled,!1)},this.clickBubbled=t=>{if(t instanceof MouseEvent&&this.clickEventIsSignificant(t)){const e=t.composedPath&&t.composedPath()[0]||t.target,r=this.findLinkFromClickTarget(e);if(r&&function(t){if(t.hasAttribute("target")){for(const e of document.getElementsByName(t.target))if(e instanceof HTMLIFrameElement)return!1;return!0}return!0}(r)){const e=this.getLocationForLink(r);this.delegate.willFollowLinkToLocation(r,e,t)&&(t.preventDefault(),this.delegate.followedLinkToLocation(r,e))}}},this.delegate=t,this.eventTarget=e}start(){this.started||(this.eventTarget.addEventListener("click",this.clickCaptured,!0),this.started=!0)}stop(){this.started&&(this.eventTarget.removeEventListener("click",this.clickCaptured,!0),this.started=!1)}clickEventIsSignificant(t){return!(t.target&&t.target.isContentEditable||t.defaultPrevented||t.which>1||t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)}findLinkFromClickTarget(t){return R(t,"a[href]:not([target^=_]):not([download])")}getLocationForLink(t){return d(t.getAttribute("href")||"")}}class Z{constructor(t,e){this.delegate=t,this.linkInterceptor=new W(this,e)}start(){this.linkInterceptor.start()}stop(){this.linkInterceptor.stop()}willFollowLinkToLocation(t,e,r){return this.delegate.willSubmitFormLinkToLocation(t,e,r)&&t.hasAttribute("data-turbo-method")}followedLinkToLocation(t,e){const r=document.createElement("form");for(const[t,i]of e.searchParams)r.append(Object.assign(document.createElement("input"),{type:"hidden",name:t,value:i}));const i=Object.assign(e,{search:""});r.setAttribute("data-turbo","true"),r.setAttribute("action",i.href),r.setAttribute("hidden","");const n=t.getAttribute("data-turbo-method");n&&r.setAttribute("method",n);const o=t.getAttribute("data-turbo-frame");o&&r.setAttribute("data-turbo-frame",o);const s=O(t);s&&r.setAttribute("data-turbo-action",s);const a=t.getAttribute("data-turbo-confirm");a&&r.setAttribute("data-turbo-confirm",a);t.hasAttribute("data-turbo-stream")&&r.setAttribute("data-turbo-stream",""),this.delegate.submittedFormLinkToLocation(t,e,r),document.body.appendChild(r),r.addEventListener("turbo:submit-end",(()=>r.remove()),{once:!0}),requestAnimationFrame((()=>r.requestSubmit()))}}class X{static async preservingPermanentElements(t,e,r){const i=new this(t,e);i.enter(),await r(),i.leave()}constructor(t,e){this.delegate=t,this.permanentElementMap=e}enter(){for(const t in this.permanentElementMap){const[e,r]=this.permanentElementMap[t];this.delegate.enteringBardo(e,r),this.replaceNewPermanentElementWithPlaceholder(r)}}leave(){for(const t in this.permanentElementMap){const[e]=this.permanentElementMap[t];this.replaceCurrentPermanentElementWithClone(e),this.replacePlaceholderWithPermanentElement(e),this.delegate.leavingBardo(e)}}replaceNewPermanentElementWithPlaceholder(t){const e=function(t){const e=document.createElement("meta");return e.setAttribute("name","turbo-permanent-placeholder"),e.setAttribute("content",t.id),e}(t);t.replaceWith(e)}replaceCurrentPermanentElementWithClone(t){const e=t.cloneNode(!0);t.replaceWith(e)}replacePlaceholderWithPermanentElement(t){const e=this.getPlaceholderById(t.id);null==e||e.replaceWith(t)}getPlaceholderById(t){return this.placeholders.find((e=>e.content==t))}get placeholders(){return[...document.querySelectorAll("meta[name=turbo-permanent-placeholder][content]")]}}class Y{constructor(t,e,r,i,n=!0){this.activeElement=null,this.currentSnapshot=t,this.newSnapshot=e,this.isPreview=i,this.willRender=n,this.renderElement=r,this.promise=new Promise(((t,e)=>this.resolvingFunctions={resolve:t,reject:e}))}get shouldRender(){return!0}get reloadReason(){}prepareToRender(){}finishRendering(){this.resolvingFunctions&&(this.resolvingFunctions.resolve(),delete this.resolvingFunctions)}async preservingPermanentElements(t){await X.preservingPermanentElements(this,this.permanentElementMap,t)}focusFirstAutofocusableElement(){const t=this.connectedSnapshot.firstAutofocusableElement;(function(t){return t&&"function"==typeof t.focus})(t)&&t.focus()}enteringBardo(t){this.activeElement||t.contains(this.currentSnapshot.activeElement)&&(this.activeElement=this.currentSnapshot.activeElement)}leavingBardo(t){t.contains(this.activeElement)&&this.activeElement instanceof HTMLElement&&(this.activeElement.focus(),this.activeElement=null)}get connectedSnapshot(){return this.newSnapshot.isConnected?this.newSnapshot:this.currentSnapshot}get currentElement(){return this.currentSnapshot.element}get newElement(){return this.newSnapshot.element}get permanentElementMap(){return this.currentSnapshot.getPermanentElementMapForSnapshot(this.newSnapshot)}}class K extends Y{static renderElement(t,e){var r;const i=document.createRange();i.selectNodeContents(t),i.deleteContents();const n=e,o=null===(r=n.ownerDocument)||void 0===r?void 0:r.createRange();o&&(o.selectNodeContents(n),t.appendChild(o.extractContents()))}constructor(t,e,r,i,n,o=!0){super(e,r,i,n,o),this.delegate=t}get shouldRender(){return!0}async render(){await T(),this.preservingPermanentElements((()=>{this.loadFrameElement()})),this.scrollFrameIntoView(),await T(),this.focusFirstAutofocusableElement(),await T(),this.activateScriptElements()}loadFrameElement(){this.delegate.willRenderFrame(this.currentElement,this.newElement),this.renderElement(this.currentElement,this.newElement)}scrollFrameIntoView(){if(this.currentElement.autoscroll||this.newElement.autoscroll){const r=this.currentElement.firstElementChild,i=(t=this.currentElement.getAttribute("data-autoscroll-block"),e="end","end"==t||"start"==t||"center"==t||"nearest"==t?t:e),n=function(t,e){return"auto"==t||"smooth"==t?t:e}(this.currentElement.getAttribute("data-autoscroll-behavior"),"auto");if(r)return r.scrollIntoView({block:i,behavior:n}),!0}var t,e;return!1}activateScriptElements(){for(const t of this.newScriptElements){const e=x(t);t.replaceWith(e)}}get newScriptElements(){return this.currentElement.querySelectorAll("script")}}class J{static get defaultCSS(){return S`
      .turbo-progress-bar {
        position: fixed;
        display: block;
        top: 0;
        left: 0;
        height: 3px;
        background: #0076ff;
        z-index: 2147483647;
        transition:
          width ${J.animationDuration}ms ease-out,
          opacity ${J.animationDuration/2}ms ${J.animationDuration/2}ms ease-in;
        transform: translate3d(0, 0, 0);
      }
    `}constructor(){this.hiding=!1,this.value=0,this.visible=!1,this.trickle=()=>{this.setValue(this.value+Math.random()/100)},this.stylesheetElement=this.createStylesheetElement(),this.progressElement=this.createProgressElement(),this.installStylesheetElement(),this.setValue(0)}show(){this.visible||(this.visible=!0,this.installProgressElement(),this.startTrickling())}hide(){this.visible&&!this.hiding&&(this.hiding=!0,this.fadeProgressElement((()=>{this.uninstallProgressElement(),this.stopTrickling(),this.visible=!1,this.hiding=!1})))}setValue(t){this.value=t,this.refresh()}installStylesheetElement(){document.head.insertBefore(this.stylesheetElement,document.head.firstChild)}installProgressElement(){this.progressElement.style.width="0",this.progressElement.style.opacity="1",document.documentElement.insertBefore(this.progressElement,document.body),this.refresh()}fadeProgressElement(t){this.progressElement.style.opacity="0",setTimeout(t,1.5*J.animationDuration)}uninstallProgressElement(){this.progressElement.parentNode&&document.documentElement.removeChild(this.progressElement)}startTrickling(){this.trickleInterval||(this.trickleInterval=window.setInterval(this.trickle,J.animationDuration))}stopTrickling(){window.clearInterval(this.trickleInterval),delete this.trickleInterval}refresh(){requestAnimationFrame((()=>{this.progressElement.style.width=10+90*this.value+"%"}))}createStylesheetElement(){const t=document.createElement("style");return t.type="text/css",t.textContent=J.defaultCSS,this.cspNonce&&(t.nonce=this.cspNonce),t}createProgressElement(){const t=document.createElement("div");return t.className="turbo-progress-bar",t}get cspNonce(){return D("csp-nonce")}}J.animationDuration=300;class Q extends N{constructor(){super(...arguments),this.detailsByOuterHTML=this.children.filter((t=>!function(t){return"noscript"==t.localName}(t))).map((t=>function(t){t.hasAttribute("nonce")&&t.setAttribute("nonce","");return t}(t))).reduce(((t,e)=>{const{outerHTML:r}=e,i=r in t?t[r]:{type:tt(e),tracked:et(e),elements:[]};return Object.assign(Object.assign({},t),{[r]:Object.assign(Object.assign({},i),{elements:[...i.elements,e]})})}),{})}get trackedElementSignature(){return Object.keys(this.detailsByOuterHTML).filter((t=>this.detailsByOuterHTML[t].tracked)).join("")}getScriptElementsNotInSnapshot(t){return this.getElementsMatchingTypeNotInSnapshot("script",t)}getStylesheetElementsNotInSnapshot(t){return this.getElementsMatchingTypeNotInSnapshot("stylesheet",t)}getElementsMatchingTypeNotInSnapshot(t,e){return Object.keys(this.detailsByOuterHTML).filter((t=>!(t in e.detailsByOuterHTML))).map((t=>this.detailsByOuterHTML[t])).filter((({type:e})=>e==t)).map((({elements:[t]})=>t))}get provisionalElements(){return Object.keys(this.detailsByOuterHTML).reduce(((t,e)=>{const{type:r,tracked:i,elements:n}=this.detailsByOuterHTML[e];return null!=r||i?n.length>1?[...t,...n.slice(1)]:t:[...t,...n]}),[])}getMetaValue(t){const e=this.findMetaElementByName(t);return e?e.getAttribute("content"):null}findMetaElementByName(t){return Object.keys(this.detailsByOuterHTML).reduce(((e,r)=>{const{elements:[i]}=this.detailsByOuterHTML[r];return function(t,e){return"meta"==t.localName&&t.getAttribute("name")==e}(i,t)?i:e}),void 0)}}function tt(t){return function(t){return"script"==t.localName}(t)?"script":function(t){const e=t.localName;return"style"==e||"link"==e&&"stylesheet"==t.getAttribute("rel")}(t)?"stylesheet":void 0}function et(t){return"reload"==t.getAttribute("data-turbo-track")}class rt extends N{static fromHTMLString(t=""){return this.fromDocument(E(t))}static fromElement(t){return this.fromDocument(t.ownerDocument)}static fromDocument({head:t,body:e}){return new this(e,new Q(t))}constructor(t,e){super(t),this.headSnapshot=e}clone(){const t=this.element.cloneNode(!0),e=this.element.querySelectorAll("select"),r=t.querySelectorAll("select");for(const[t,i]of e.entries()){const e=r[t];for(const t of e.selectedOptions)t.selected=!1;for(const t of i.selectedOptions)e.options[t.index].selected=!0}for(const e of t.querySelectorAll('input[type="password"]'))e.value="";return new rt(t,this.headSnapshot)}get headElement(){return this.headSnapshot.element}get rootLocation(){var t;return d(null!==(t=this.getSetting("root"))&&void 0!==t?t:"/")}get cacheControlValue(){return this.getSetting("cache-control")}get isPreviewable(){return"no-preview"!=this.cacheControlValue}get isCacheable(){return"no-cache"!=this.cacheControlValue}get isVisitable(){return"reload"!=this.getSetting("visit-control")}getSetting(t){return this.headSnapshot.getMetaValue(`turbo-${t}`)}}!function(t){t.visitStart="visitStart",t.requestStart="requestStart",t.requestEnd="requestEnd",t.visitEnd="visitEnd"}(c||(c={})),function(t){t.initialized="initialized",t.started="started",t.canceled="canceled",t.failed="failed",t.completed="completed"}(u||(u={}));const it={action:"advance",historyChanged:!1,visitCachedSnapshot:()=>{},willRender:!0,updateHistory:!0,shouldCacheSnapshot:!0,acceptsStreamResponse:!1};var nt,ot;!function(t){t[t.networkFailure=0]="networkFailure",t[t.timeoutFailure=-1]="timeoutFailure",t[t.contentTypeMismatch=-2]="contentTypeMismatch"}(nt||(nt={}));class st{constructor(t,e,r,i={}){this.identifier=P(),this.timingMetrics={},this.followedRedirect=!1,this.historyChanged=!1,this.scrolled=!1,this.shouldCacheSnapshot=!0,this.acceptsStreamResponse=!1,this.snapshotCached=!1,this.state=u.initialized,this.delegate=t,this.location=e,this.restorationIdentifier=r||P();const{action:n,historyChanged:o,referrer:s,snapshot:a,snapshotHTML:l,response:c,visitCachedSnapshot:h,willRender:d,updateHistory:p,shouldCacheSnapshot:f,acceptsStreamResponse:m}=Object.assign(Object.assign({},it),i);this.action=n,this.historyChanged=o,this.referrer=s,this.snapshot=a,this.snapshotHTML=l,this.response=c,this.isSamePage=this.delegate.locationWithActionIsSamePage(this.location,this.action),this.visitCachedSnapshot=h,this.willRender=d,this.updateHistory=p,this.scrolled=!d,this.shouldCacheSnapshot=f,this.acceptsStreamResponse=m}get adapter(){return this.delegate.adapter}get view(){return this.delegate.view}get history(){return this.delegate.history}get restorationData(){return this.history.getRestorationDataForIdentifier(this.restorationIdentifier)}get silent(){return this.isSamePage}start(){this.state==u.initialized&&(this.recordTimingMetric(c.visitStart),this.state=u.started,this.adapter.visitStarted(this),this.delegate.visitStarted(this))}cancel(){this.state==u.started&&(this.request&&this.request.cancel(),this.cancelRender(),this.state=u.canceled)}complete(){this.state==u.started&&(this.recordTimingMetric(c.visitEnd),this.state=u.completed,this.followRedirect(),this.followedRedirect||(this.adapter.visitCompleted(this),this.delegate.visitCompleted(this)))}fail(){this.state==u.started&&(this.state=u.failed,this.adapter.visitFailed(this))}changeHistory(){var t;if(!this.historyChanged&&this.updateHistory){const e=I(this.location.href===(null===(t=this.referrer)||void 0===t?void 0:t.href)?"replace":this.action);this.history.update(e,this.location,this.restorationIdentifier),this.historyChanged=!0}}issueRequest(){this.hasPreloadedResponse()?this.simulateRequest():this.shouldIssueRequest()&&!this.request&&(this.request=new F(this,s.get,this.location),this.request.perform())}simulateRequest(){this.response&&(this.startRequest(),this.recordResponse(),this.finishRequest())}startRequest(){this.recordTimingMetric(c.requestStart),this.adapter.visitRequestStarted(this)}recordResponse(t=this.response){if(this.response=t,t){const{statusCode:e}=t;at(e)?this.adapter.visitRequestCompleted(this):this.adapter.visitRequestFailedWithStatusCode(this,e)}}finishRequest(){this.recordTimingMetric(c.requestEnd),this.adapter.visitRequestFinished(this)}loadResponse(){if(this.response){const{statusCode:t,responseHTML:e}=this.response;this.render((async()=>{this.shouldCacheSnapshot&&this.cacheSnapshot(),this.view.renderPromise&&await this.view.renderPromise,at(t)&&null!=e?(await this.view.renderPage(rt.fromHTMLString(e),!1,this.willRender,this),this.performScroll(),this.adapter.visitRendered(this),this.complete()):(await this.view.renderError(rt.fromHTMLString(e),this),this.adapter.visitRendered(this),this.fail())}))}}getCachedSnapshot(){const t=this.view.getCachedSnapshotForLocation(this.location)||this.getPreloadedSnapshot();if(t&&(!p(this.location)||t.hasAnchor(p(this.location)))&&("restore"==this.action||t.isPreviewable))return t}getPreloadedSnapshot(){if(this.snapshotHTML)return rt.fromHTMLString(this.snapshotHTML)}hasCachedSnapshot(){return null!=this.getCachedSnapshot()}loadCachedSnapshot(){const t=this.getCachedSnapshot();if(t){const e=this.shouldIssueRequest();this.render((async()=>{this.cacheSnapshot(),this.isSamePage?this.adapter.visitRendered(this):(this.view.renderPromise&&await this.view.renderPromise,await this.view.renderPage(t,e,this.willRender,this),this.performScroll(),this.adapter.visitRendered(this),e||this.complete())}))}}followRedirect(){var t;this.redirectedToLocation&&!this.followedRedirect&&(null===(t=this.response)||void 0===t?void 0:t.redirected)&&(this.adapter.visitProposedToLocation(this.redirectedToLocation,{action:"replace",response:this.response,shouldCacheSnapshot:!1,willRender:!1}),this.followedRedirect=!0)}goToSamePageAnchor(){this.isSamePage&&this.render((async()=>{this.cacheSnapshot(),this.performScroll(),this.changeHistory(),this.adapter.visitRendered(this)}))}prepareRequest(t){this.acceptsStreamResponse&&t.acceptResponseType(z.contentType)}requestStarted(){this.startRequest()}requestPreventedHandlingResponse(t,e){}async requestSucceededWithResponse(t,e){const r=await e.responseHTML,{redirected:i,statusCode:n}=e;null==r?this.recordResponse({statusCode:nt.contentTypeMismatch,redirected:i}):(this.redirectedToLocation=e.redirected?e.location:void 0,this.recordResponse({statusCode:n,responseHTML:r,redirected:i}))}async requestFailedWithResponse(t,e){const r=await e.responseHTML,{redirected:i,statusCode:n}=e;null==r?this.recordResponse({statusCode:nt.contentTypeMismatch,redirected:i}):this.recordResponse({statusCode:n,responseHTML:r,redirected:i})}requestErrored(t,e){this.recordResponse({statusCode:nt.networkFailure,redirected:!1})}requestFinished(){this.finishRequest()}performScroll(){this.scrolled||this.view.forceReloaded||("restore"==this.action?this.scrollToRestoredPosition()||this.scrollToAnchor()||this.view.scrollToTop():this.scrollToAnchor()||this.view.scrollToTop(),this.isSamePage&&this.delegate.visitScrolledToSamePageLocation(this.view.lastRenderedLocation,this.location),this.scrolled=!0)}scrollToRestoredPosition(){const{scrollPosition:t}=this.restorationData;if(t)return this.view.scrollToPosition(t),!0}scrollToAnchor(){const t=p(this.location);if(null!=t)return this.view.scrollToAnchor(t),!0}recordTimingMetric(t){this.timingMetrics[t]=(new Date).getTime()}getTimingMetrics(){return Object.assign({},this.timingMetrics)}getHistoryMethodForAction(t){switch(t){case"replace":return history.replaceState;case"advance":case"restore":return history.pushState}}hasPreloadedResponse(){return"object"==typeof this.response}shouldIssueRequest(){return!this.isSamePage&&("restore"==this.action?!this.hasCachedSnapshot():this.willRender)}cacheSnapshot(){this.snapshotCached||(this.view.cacheSnapshot(this.snapshot).then((t=>t&&this.visitCachedSnapshot(t))),this.snapshotCached=!0)}async render(t){this.cancelRender(),await new Promise((t=>{this.frame=requestAnimationFrame((()=>t()))})),await t(),delete this.frame}cancelRender(){this.frame&&(cancelAnimationFrame(this.frame),delete this.frame)}}function at(t){return t>=200&&t<300}class lt{constructor(t){this.progressBar=new J,this.showProgressBar=()=>{this.progressBar.show()},this.session=t}visitProposedToLocation(t,e){this.navigator.startVisit(t,(null==e?void 0:e.restorationIdentifier)||P(),e)}visitStarted(t){this.location=t.location,t.loadCachedSnapshot(),t.issueRequest(),t.goToSamePageAnchor()}visitRequestStarted(t){this.progressBar.setValue(0),t.hasCachedSnapshot()||"restore"!=t.action?this.showVisitProgressBarAfterDelay():this.showProgressBar()}visitRequestCompleted(t){t.loadResponse()}visitRequestFailedWithStatusCode(t,e){switch(e){case nt.networkFailure:case nt.timeoutFailure:case nt.contentTypeMismatch:return this.reload({reason:"request_failed",context:{statusCode:e}});default:return t.loadResponse()}}visitRequestFinished(t){this.progressBar.setValue(1),this.hideVisitProgressBar()}visitCompleted(t){}pageInvalidated(t){this.reload(t)}visitFailed(t){}visitRendered(t){}formSubmissionStarted(t){this.progressBar.setValue(0),this.showFormProgressBarAfterDelay()}formSubmissionFinished(t){this.progressBar.setValue(1),this.hideFormProgressBar()}showVisitProgressBarAfterDelay(){this.visitProgressBarTimeout=window.setTimeout(this.showProgressBar,this.session.progressBarDelay)}hideVisitProgressBar(){this.progressBar.hide(),null!=this.visitProgressBarTimeout&&(window.clearTimeout(this.visitProgressBarTimeout),delete this.visitProgressBarTimeout)}showFormProgressBarAfterDelay(){null==this.formProgressBarTimeout&&(this.formProgressBarTimeout=window.setTimeout(this.showProgressBar,this.session.progressBarDelay))}hideFormProgressBar(){this.progressBar.hide(),null!=this.formProgressBarTimeout&&(window.clearTimeout(this.formProgressBarTimeout),delete this.formProgressBarTimeout)}reload(t){var e;w("turbo:reload",{detail:t}),window.location.href=(null===(e=this.location)||void 0===e?void 0:e.toString())||window.location.href}get navigator(){return this.session.navigator}}class ct{constructor(){this.selector="[data-turbo-temporary]",this.deprecatedSelector="[data-turbo-cache=false]",this.started=!1,this.removeTemporaryElements=t=>{for(const t of this.temporaryElements)t.remove()}}start(){this.started||(this.started=!0,addEventListener("turbo:before-cache",this.removeTemporaryElements,!1))}stop(){this.started&&(this.started=!1,removeEventListener("turbo:before-cache",this.removeTemporaryElements,!1))}get temporaryElements(){return[...document.querySelectorAll(this.selector),...this.temporaryElementsWithDeprecation]}get temporaryElementsWithDeprecation(){const t=document.querySelectorAll(this.deprecatedSelector);return t.length&&console.warn(`The ${this.deprecatedSelector} selector is deprecated and will be removed in a future version. Use ${this.selector} instead.`),[...t]}}class ut{constructor(t,e){this.session=t,this.element=e,this.linkInterceptor=new q(this,e),this.formSubmitObserver=new $(this,e)}start(){this.linkInterceptor.start(),this.formSubmitObserver.start()}stop(){this.linkInterceptor.stop(),this.formSubmitObserver.stop()}shouldInterceptLinkClick(t,e,r){return this.shouldRedirect(t)}linkClickIntercepted(t,e,r){const i=this.findFrameElement(t);i&&i.delegate.linkClickIntercepted(t,e,r)}willSubmitForm(t,e){return null==t.closest("turbo-frame")&&this.shouldSubmit(t,e)&&this.shouldRedirect(t,e)}formSubmitted(t,e){const r=this.findFrameElement(t,e);r&&r.delegate.formSubmitted(t,e)}shouldSubmit(t,e){var r;const i=f(t,e),n=this.element.ownerDocument.querySelector('meta[name="turbo-root"]'),o=d(null!==(r=null==n?void 0:n.content)&&void 0!==r?r:"/");return this.shouldRedirect(t,e)&&y(i,o)}shouldRedirect(t,e){if(t instanceof HTMLFormElement?this.session.submissionIsNavigatable(t,e):this.session.elementIsNavigatable(t)){const r=this.findFrameElement(t,e);return!!r&&r!=t.closest("turbo-frame")}return!1}findFrameElement(t,e){const r=(null==e?void 0:e.getAttribute("data-turbo-frame"))||t.getAttribute("data-turbo-frame");if(r&&"_top"!=r){const t=this.element.querySelector(`#${r}:not([disabled])`);if(t instanceof h)return t}}}class ht{constructor(t){this.restorationIdentifier=P(),this.restorationData={},this.started=!1,this.pageLoaded=!1,this.onPopState=t=>{if(this.shouldHandlePopState()){const{turbo:e}=t.state||{};if(e){this.location=new URL(window.location.href);const{restorationIdentifier:t}=e;this.restorationIdentifier=t,this.delegate.historyPoppedToLocationWithRestorationIdentifier(this.location,t)}}},this.onPageLoad=async t=>{await Promise.resolve(),this.pageLoaded=!0},this.delegate=t}start(){this.started||(addEventListener("popstate",this.onPopState,!1),addEventListener("load",this.onPageLoad,!1),this.started=!0,this.replace(new URL(window.location.href)))}stop(){this.started&&(removeEventListener("popstate",this.onPopState,!1),removeEventListener("load",this.onPageLoad,!1),this.started=!1)}push(t,e){this.update(history.pushState,t,e)}replace(t,e){this.update(history.replaceState,t,e)}update(t,e,r=P()){const i={turbo:{restorationIdentifier:r}};t.call(history,i,"",e.href),this.location=e,this.restorationIdentifier=r}getRestorationDataForIdentifier(t){return this.restorationData[t]||{}}updateRestorationData(t){const{restorationIdentifier:e}=this,r=this.restorationData[e];this.restorationData[e]=Object.assign(Object.assign({},r),t)}assumeControlOfScrollRestoration(){var t;this.previousScrollRestoration||(this.previousScrollRestoration=null!==(t=history.scrollRestoration)&&void 0!==t?t:"auto",history.scrollRestoration="manual")}relinquishControlOfScrollRestoration(){this.previousScrollRestoration&&(history.scrollRestoration=this.previousScrollRestoration,delete this.previousScrollRestoration)}shouldHandlePopState(){return this.pageIsLoaded()}pageIsLoaded(){return this.pageLoaded||"complete"==document.readyState}}class dt{constructor(t){this.delegate=t}proposeVisit(t,e={}){this.delegate.allowsVisitingLocationWithAction(t,e.action)&&(y(t,this.view.snapshot.rootLocation)?this.delegate.visitProposedToLocation(t,e):window.location.href=t.toString())}startVisit(t,e,r={}){this.stop(),this.currentVisit=new st(this,d(t),e,Object.assign({referrer:this.location},r)),this.currentVisit.start()}submitForm(t,e){this.stop(),this.formSubmission=new j(this,t,e,!0),this.formSubmission.start()}stop(){this.formSubmission&&(this.formSubmission.stop(),delete this.formSubmission),this.currentVisit&&(this.currentVisit.cancel(),delete this.currentVisit)}get adapter(){return this.delegate.adapter}get view(){return this.delegate.view}get history(){return this.delegate.history}formSubmissionStarted(t){"function"==typeof this.adapter.formSubmissionStarted&&this.adapter.formSubmissionStarted(t)}async formSubmissionSucceededWithResponse(t,e){if(t==this.formSubmission){const r=await e.responseHTML;if(r){const i=t.isSafe;i||this.view.clearSnapshotCache();const{statusCode:n,redirected:o}=e,s={action:this.getActionForFormSubmission(t),shouldCacheSnapshot:i,response:{statusCode:n,responseHTML:r,redirected:o}};this.proposeVisit(e.location,s)}}}async formSubmissionFailedWithResponse(t,e){const r=await e.responseHTML;if(r){const t=rt.fromHTMLString(r);e.serverError?await this.view.renderError(t,this.currentVisit):await this.view.renderPage(t,!1,!0,this.currentVisit),this.view.scrollToTop(),this.view.clearSnapshotCache()}}formSubmissionErrored(t,e){console.error(e)}formSubmissionFinished(t){"function"==typeof this.adapter.formSubmissionFinished&&this.adapter.formSubmissionFinished(t)}visitStarted(t){this.delegate.visitStarted(t)}visitCompleted(t){this.delegate.visitCompleted(t)}locationWithActionIsSamePage(t,e){const r=p(t),i=p(this.view.lastRenderedLocation),n="restore"===e&&void 0===r;return"replace"!==e&&v(t)===v(this.view.lastRenderedLocation)&&(n||null!=r&&r!==i)}visitScrolledToSamePageLocation(t,e){this.delegate.visitScrolledToSamePageLocation(t,e)}get location(){return this.history.location}get restorationIdentifier(){return this.history.restorationIdentifier}getActionForFormSubmission({submitter:t,formElement:e}){return O(t,e)||"advance"}}!function(t){t[t.initial=0]="initial",t[t.loading=1]="loading",t[t.interactive=2]="interactive",t[t.complete=3]="complete"}(ot||(ot={}));class pt{constructor(t){this.stage=ot.initial,this.started=!1,this.interpretReadyState=()=>{const{readyState:t}=this;"interactive"==t?this.pageIsInteractive():"complete"==t&&this.pageIsComplete()},this.pageWillUnload=()=>{this.delegate.pageWillUnload()},this.delegate=t}start(){this.started||(this.stage==ot.initial&&(this.stage=ot.loading),document.addEventListener("readystatechange",this.interpretReadyState,!1),addEventListener("pagehide",this.pageWillUnload,!1),this.started=!0)}stop(){this.started&&(document.removeEventListener("readystatechange",this.interpretReadyState,!1),removeEventListener("pagehide",this.pageWillUnload,!1),this.started=!1)}pageIsInteractive(){this.stage==ot.loading&&(this.stage=ot.interactive,this.delegate.pageBecameInteractive())}pageIsComplete(){this.pageIsInteractive(),this.stage==ot.interactive&&(this.stage=ot.complete,this.delegate.pageLoaded())}get readyState(){return document.readyState}}class ft{constructor(t){this.started=!1,this.onScroll=()=>{this.updatePosition({x:window.pageXOffset,y:window.pageYOffset})},this.delegate=t}start(){this.started||(addEventListener("scroll",this.onScroll,!1),this.onScroll(),this.started=!0)}stop(){this.started&&(removeEventListener("scroll",this.onScroll,!1),this.started=!1)}updatePosition(t){this.delegate.scrollPositionChanged(t)}}class mt{render({fragment:t}){X.preservingPermanentElements(this,function(t){const e=U(document.documentElement),r={};for(const i of e){const{id:e}=i;for(const n of t.querySelectorAll("turbo-stream")){const t=V(n.templateElement.content,e);t&&(r[e]=[i,t])}}return r}(t),(()=>document.documentElement.appendChild(t)))}enteringBardo(t,e){e.replaceWith(t.cloneNode(!0))}leavingBardo(){}}class gt{constructor(t){this.sources=new Set,this.started=!1,this.inspectFetchResponse=t=>{const e=function(t){var e;const r=null===(e=t.detail)||void 0===e?void 0:e.fetchResponse;if(r instanceof b)return r}(t);e&&function(t){var e;return(null!==(e=t.contentType)&&void 0!==e?e:"").startsWith(z.contentType)}(e)&&(t.preventDefault(),this.receiveMessageResponse(e))},this.receiveMessageEvent=t=>{this.started&&"string"==typeof t.data&&this.receiveMessageHTML(t.data)},this.delegate=t}start(){this.started||(this.started=!0,addEventListener("turbo:before-fetch-response",this.inspectFetchResponse,!1))}stop(){this.started&&(this.started=!1,removeEventListener("turbo:before-fetch-response",this.inspectFetchResponse,!1))}connectStreamSource(t){this.streamSourceIsConnected(t)||(this.sources.add(t),t.addEventListener("message",this.receiveMessageEvent,!1))}disconnectStreamSource(t){this.streamSourceIsConnected(t)&&(this.sources.delete(t),t.removeEventListener("message",this.receiveMessageEvent,!1))}streamSourceIsConnected(t){return this.sources.has(t)}async receiveMessageResponse(t){const e=await t.responseHTML;e&&this.receiveMessageHTML(e)}receiveMessageHTML(t){this.delegate.receivedMessageFromStream(z.wrap(t))}}class yt extends Y{static renderElement(t,e){const{documentElement:r,body:i}=document;r.replaceChild(e,i)}async render(){this.replaceHeadAndBody(),this.activateScriptElements()}replaceHeadAndBody(){const{documentElement:t,head:e}=document;t.replaceChild(this.newHead,e),this.renderElement(this.currentElement,this.newElement)}activateScriptElements(){for(const t of this.scriptElements){const e=t.parentNode;if(e){const r=x(t);e.replaceChild(r,t)}}}get newHead(){return this.newSnapshot.headSnapshot.element}get scriptElements(){return document.documentElement.querySelectorAll("script")}}class vt extends Y{static renderElement(t,e){document.body&&e instanceof HTMLBodyElement?document.body.replaceWith(e):document.documentElement.appendChild(e)}get shouldRender(){return this.newSnapshot.isVisitable&&this.trackedElementsAreIdentical}get reloadReason(){return this.newSnapshot.isVisitable?this.trackedElementsAreIdentical?void 0:{reason:"tracked_element_mismatch"}:{reason:"turbo_visit_control_is_reload"}}async prepareToRender(){await this.mergeHead()}async render(){this.willRender&&await this.replaceBody()}finishRendering(){super.finishRendering(),this.isPreview||this.focusFirstAutofocusableElement()}get currentHeadSnapshot(){return this.currentSnapshot.headSnapshot}get newHeadSnapshot(){return this.newSnapshot.headSnapshot}get newElement(){return this.newSnapshot.element}async mergeHead(){const t=this.mergeProvisionalElements(),e=this.copyNewHeadStylesheetElements();this.copyNewHeadScriptElements(),await t,await e}async replaceBody(){await this.preservingPermanentElements((async()=>{this.activateNewBody(),await this.assignNewBody()}))}get trackedElementsAreIdentical(){return this.currentHeadSnapshot.trackedElementSignature==this.newHeadSnapshot.trackedElementSignature}async copyNewHeadStylesheetElements(){const t=[];for(const e of this.newHeadStylesheetElements)t.push(C(e)),document.head.appendChild(e);await Promise.all(t)}copyNewHeadScriptElements(){for(const t of this.newHeadScriptElements)document.head.appendChild(x(t))}async mergeProvisionalElements(){const t=[...this.newHeadProvisionalElements];for(const e of this.currentHeadProvisionalElements)this.isCurrentElementInElementList(e,t)||document.head.removeChild(e);for(const e of t)document.head.appendChild(e)}isCurrentElementInElementList(t,e){for(const[r,i]of e.entries()){if("TITLE"==t.tagName){if("TITLE"!=i.tagName)continue;if(t.innerHTML==i.innerHTML)return e.splice(r,1),!0}if(i.isEqualNode(t))return e.splice(r,1),!0}return!1}removeCurrentHeadProvisionalElements(){for(const t of this.currentHeadProvisionalElements)document.head.removeChild(t)}copyNewHeadProvisionalElements(){for(const t of this.newHeadProvisionalElements)document.head.appendChild(t)}activateNewBody(){document.adoptNode(this.newElement),this.activateNewBodyScriptElements()}activateNewBodyScriptElements(){for(const t of this.newBodyScriptElements){const e=x(t);t.replaceWith(e)}}async assignNewBody(){await this.renderElement(this.currentElement,this.newElement)}get newHeadStylesheetElements(){return this.newHeadSnapshot.getStylesheetElementsNotInSnapshot(this.currentHeadSnapshot)}get newHeadScriptElements(){return this.newHeadSnapshot.getScriptElementsNotInSnapshot(this.currentHeadSnapshot)}get currentHeadProvisionalElements(){return this.currentHeadSnapshot.provisionalElements}get newHeadProvisionalElements(){return this.newHeadSnapshot.provisionalElements}get newBodyScriptElements(){return this.newElement.querySelectorAll("script")}}class _t{constructor(t){this.keys=[],this.snapshots={},this.size=t}has(t){return _(t)in this.snapshots}get(t){if(this.has(t)){const e=this.read(t);return this.touch(t),e}}put(t,e){return this.write(t,e),this.touch(t),e}clear(){this.snapshots={}}read(t){return this.snapshots[_(t)]}write(t,e){this.snapshots[_(t)]=e}touch(t){const e=_(t),r=this.keys.indexOf(e);r>-1&&this.keys.splice(r,1),this.keys.unshift(e),this.trim()}trim(){for(const t of this.keys.splice(this.size))delete this.snapshots[t]}}class bt extends G{constructor(){super(...arguments),this.snapshotCache=new _t(10),this.lastRenderedLocation=new URL(location.href),this.forceReloaded=!1}renderPage(t,e=!1,r=!0,i){const n=new vt(this.snapshot,t,vt.renderElement,e,r);return n.shouldRender?null==i||i.changeHistory():this.forceReloaded=!0,this.render(n)}renderError(t,e){null==e||e.changeHistory();const r=new yt(this.snapshot,t,yt.renderElement,!1);return this.render(r)}clearSnapshotCache(){this.snapshotCache.clear()}async cacheSnapshot(t=this.snapshot){if(t.isCacheable){this.delegate.viewWillCacheSnapshot();const{lastRenderedLocation:e}=this;await new Promise((t=>setTimeout((()=>t()),0)));const r=t.clone();return this.snapshotCache.put(e,r),r}}getCachedSnapshotForLocation(t){return this.snapshotCache.get(t)}get snapshot(){return rt.fromElement(this.element)}}class xt{constructor(t){this.selector="a[data-turbo-preload]",this.delegate=t}get snapshotCache(){return this.delegate.navigator.view.snapshotCache}start(){if("loading"===document.readyState)return document.addEventListener("DOMContentLoaded",(()=>{this.preloadOnLoadLinksForView(document.body)}));this.preloadOnLoadLinksForView(document.body)}preloadOnLoadLinksForView(t){for(const e of t.querySelectorAll(this.selector))this.preloadURL(e)}async preloadURL(t){const e=new URL(t.href);if(!this.snapshotCache.has(e))try{const t=await fetch(e.toString(),{headers:{"VND.PREFETCH":"true",Accept:"text/html"}}),r=await t.text(),i=rt.fromHTMLString(r);this.snapshotCache.put(e,i)}catch(t){}}}function wt(t){Object.defineProperties(t,Tt)}const Tt={absoluteURL:{get(){return this.toString()}}};const Et={after(){this.targetElements.forEach((t=>{var e;return null===(e=t.parentElement)||void 0===e?void 0:e.insertBefore(this.templateContent,t.nextSibling)}))},append(){this.removeDuplicateTargetChildren(),this.targetElements.forEach((t=>t.append(this.templateContent)))},before(){this.targetElements.forEach((t=>{var e;return null===(e=t.parentElement)||void 0===e?void 0:e.insertBefore(this.templateContent,t)}))},prepend(){this.removeDuplicateTargetChildren(),this.targetElements.forEach((t=>t.prepend(this.templateContent)))},remove(){this.targetElements.forEach((t=>t.remove()))},replace(){this.targetElements.forEach((t=>t.replaceWith(this.templateContent)))},update(){this.targetElements.forEach((t=>{t.innerHTML="",t.append(this.templateContent)}))}},St=new class{constructor(){this.navigator=new dt(this),this.history=new ht(this),this.preloader=new xt(this),this.view=new bt(this,document.documentElement),this.adapter=new lt(this),this.pageObserver=new pt(this),this.cacheObserver=new ct,this.linkClickObserver=new W(this,window),this.formSubmitObserver=new $(this,document),this.scrollObserver=new ft(this),this.streamObserver=new gt(this),this.formLinkClickObserver=new Z(this,document.documentElement),this.frameRedirector=new ut(this,document.documentElement),this.streamMessageRenderer=new mt,this.drive=!0,this.enabled=!0,this.progressBarDelay=500,this.started=!1,this.formMode="on"}start(){this.started||(this.pageObserver.start(),this.cacheObserver.start(),this.formLinkClickObserver.start(),this.linkClickObserver.start(),this.formSubmitObserver.start(),this.scrollObserver.start(),this.streamObserver.start(),this.frameRedirector.start(),this.history.start(),this.preloader.start(),this.started=!0,this.enabled=!0)}disable(){this.enabled=!1}stop(){this.started&&(this.pageObserver.stop(),this.cacheObserver.stop(),this.formLinkClickObserver.stop(),this.linkClickObserver.stop(),this.formSubmitObserver.stop(),this.scrollObserver.stop(),this.streamObserver.stop(),this.frameRedirector.stop(),this.history.stop(),this.started=!1)}registerAdapter(t){this.adapter=t}visit(t,e={}){const r=e.frame?document.getElementById(e.frame):null;r instanceof h?(r.src=t.toString(),r.loaded):this.navigator.proposeVisit(d(t),e)}connectStreamSource(t){this.streamObserver.connectStreamSource(t)}disconnectStreamSource(t){this.streamObserver.disconnectStreamSource(t)}renderStreamMessage(t){this.streamMessageRenderer.render(z.wrap(t))}clearCache(){this.view.clearSnapshotCache()}setProgressBarDelay(t){this.progressBarDelay=t}setFormMode(t){this.formMode=t}get location(){return this.history.location}get restorationIdentifier(){return this.history.restorationIdentifier}historyPoppedToLocationWithRestorationIdentifier(t,e){this.enabled?this.navigator.startVisit(t,e,{action:"restore",historyChanged:!0}):this.adapter.pageInvalidated({reason:"turbo_disabled"})}scrollPositionChanged(t){this.history.updateRestorationData({scrollPosition:t})}willSubmitFormLinkToLocation(t,e){return this.elementIsNavigatable(t)&&y(e,this.snapshot.rootLocation)}submittedFormLinkToLocation(){}willFollowLinkToLocation(t,e,r){return this.elementIsNavigatable(t)&&y(e,this.snapshot.rootLocation)&&this.applicationAllowsFollowingLinkToLocation(t,e,r)}followedLinkToLocation(t,e){const r=this.getActionForLink(t),i=t.hasAttribute("data-turbo-stream");this.visit(e.href,{action:r,acceptsStreamResponse:i})}allowsVisitingLocationWithAction(t,e){return this.locationWithActionIsSamePage(t,e)||this.applicationAllowsVisitingLocation(t)}visitProposedToLocation(t,e){wt(t),this.adapter.visitProposedToLocation(t,e)}visitStarted(t){t.acceptsStreamResponse||A(document.documentElement),wt(t.location),t.silent||this.notifyApplicationAfterVisitingLocation(t.location,t.action)}visitCompleted(t){M(document.documentElement),this.notifyApplicationAfterPageLoad(t.getTimingMetrics())}locationWithActionIsSamePage(t,e){return this.navigator.locationWithActionIsSamePage(t,e)}visitScrolledToSamePageLocation(t,e){this.notifyApplicationAfterVisitingSamePageLocation(t,e)}willSubmitForm(t,e){const r=f(t,e);return this.submissionIsNavigatable(t,e)&&y(d(r),this.snapshot.rootLocation)}formSubmitted(t,e){this.navigator.submitForm(t,e)}pageBecameInteractive(){this.view.lastRenderedLocation=this.location,this.notifyApplicationAfterPageLoad()}pageLoaded(){this.history.assumeControlOfScrollRestoration()}pageWillUnload(){this.history.relinquishControlOfScrollRestoration()}receivedMessageFromStream(t){this.renderStreamMessage(t)}viewWillCacheSnapshot(){var t;(null===(t=this.navigator.currentVisit)||void 0===t?void 0:t.silent)||this.notifyApplicationBeforeCachingSnapshot()}allowsImmediateRender({element:t},e){const r=this.notifyApplicationBeforeRender(t,e),{defaultPrevented:i,detail:{render:n}}=r;return this.view.renderer&&n&&(this.view.renderer.renderElement=n),!i}viewRenderedSnapshot(t,e){this.view.lastRenderedLocation=this.history.location,this.notifyApplicationAfterRender()}preloadOnLoadLinksForView(t){this.preloader.preloadOnLoadLinksForView(t)}viewInvalidated(t){this.adapter.pageInvalidated(t)}frameLoaded(t){this.notifyApplicationAfterFrameLoad(t)}frameRendered(t,e){this.notifyApplicationAfterFrameRender(t,e)}applicationAllowsFollowingLinkToLocation(t,e,r){return!this.notifyApplicationAfterClickingLinkToLocation(t,e,r).defaultPrevented}applicationAllowsVisitingLocation(t){return!this.notifyApplicationBeforeVisitingLocation(t).defaultPrevented}notifyApplicationAfterClickingLinkToLocation(t,e,r){return w("turbo:click",{target:t,detail:{url:e.href,originalEvent:r},cancelable:!0})}notifyApplicationBeforeVisitingLocation(t){return w("turbo:before-visit",{detail:{url:t.href},cancelable:!0})}notifyApplicationAfterVisitingLocation(t,e){return w("turbo:visit",{detail:{url:t.href,action:e}})}notifyApplicationBeforeCachingSnapshot(){return w("turbo:before-cache")}notifyApplicationBeforeRender(t,e){return w("turbo:before-render",{detail:Object.assign({newBody:t},e),cancelable:!0})}notifyApplicationAfterRender(){return w("turbo:render")}notifyApplicationAfterPageLoad(t={}){return w("turbo:load",{detail:{url:this.location.href,timing:t}})}notifyApplicationAfterVisitingSamePageLocation(t,e){dispatchEvent(new HashChangeEvent("hashchange",{oldURL:t.toString(),newURL:e.toString()}))}notifyApplicationAfterFrameLoad(t){return w("turbo:frame-load",{target:t})}notifyApplicationAfterFrameRender(t,e){return w("turbo:frame-render",{detail:{fetchResponse:t},target:e,cancelable:!0})}submissionIsNavigatable(t,e){if("off"==this.formMode)return!1;{const r=!e||this.elementIsNavigatable(e);return"optin"==this.formMode?r&&null!=t.closest('[data-turbo="true"]'):r&&this.elementIsNavigatable(t)}}elementIsNavigatable(t){const e=R(t,"[data-turbo]"),r=R(t,"turbo-frame");return this.drive||r?!e||"false"!=e.getAttribute("data-turbo"):!!e&&"true"==e.getAttribute("data-turbo")}getActionForLink(t){return O(t)||"advance"}get snapshot(){return this.view.snapshot}},Pt=new class{constructor(t){this.session=t}clear(){this.session.clearCache()}resetCacheControl(){this.setCacheControl("")}exemptPageFromCache(){this.setCacheControl("no-cache")}exemptPageFromPreview(){this.setCacheControl("no-preview")}setCacheControl(t){!function(t,e){let r=L(t);r||(r=document.createElement("meta"),r.setAttribute("name",t),document.head.appendChild(r)),r.setAttribute("content",e)}("turbo-cache-control",t)}}(St),{navigator:kt}=St;function At(){St.start()}function Mt(t){St.connectStreamSource(t)}function Ct(t){St.disconnectStreamSource(t)}var It=Object.freeze({__proto__:null,navigator:kt,session:St,cache:Pt,PageRenderer:vt,PageSnapshot:rt,FrameRenderer:K,start:At,registerAdapter:function(t){St.registerAdapter(t)},visit:function(t,e){St.visit(t,e)},connectStreamSource:Mt,disconnectStreamSource:Ct,renderStreamMessage:function(t){St.renderStreamMessage(t)},clearCache:function(){console.warn("Please replace `Turbo.clearCache()` with `Turbo.cache.clear()`. The top-level function is deprecated and will be removed in a future version of Turbo.`"),St.clearCache()},setProgressBarDelay:function(t){St.setProgressBarDelay(t)},setConfirmMethod:function(t){j.confirmMethod=t},setFormMode:function(t){St.setFormMode(t)},StreamActions:Et});class Ot extends Error{}function Lt(t){if(null!=t){const e=document.getElementById(t);if(e instanceof h)return e}}function Dt(t,e){if(t){const i=t.getAttribute("src");if(null!=i&&null!=e&&(r=e,d(i).href==d(r).href))throw new Error(`Matching <turbo-frame id="${t.id}"> element has a source URL which references itself`);if(t.ownerDocument!==document&&(t=document.importNode(t,!0)),t instanceof h)return t.connectedCallback(),t.disconnectedCallback(),t}var r}class Rt extends HTMLElement{static async renderElement(t){await t.performAction()}async connectedCallback(){try{await this.render()}catch(t){console.error(t)}finally{this.disconnect()}}async render(){var t;return null!==(t=this.renderPromise)&&void 0!==t?t:this.renderPromise=(async()=>{const t=this.beforeRenderEvent;this.dispatchEvent(t)&&(await T(),await t.detail.render(this))})()}disconnect(){try{this.remove()}catch(t){}}removeDuplicateTargetChildren(){this.duplicateChildren.forEach((t=>t.remove()))}get duplicateChildren(){var t;const e=this.targetElements.flatMap((t=>[...t.children])).filter((t=>!!t.id)),r=[...(null===(t=this.templateContent)||void 0===t?void 0:t.children)||[]].filter((t=>!!t.id)).map((t=>t.id));return e.filter((t=>r.includes(t.id)))}get performAction(){if(this.action){const t=Et[this.action];if(t)return t;this.raise("unknown action")}this.raise("action attribute is missing")}get targetElements(){return this.target?this.targetElementsById:this.targets?this.targetElementsByQuery:void this.raise("target or targets attribute is missing")}get templateContent(){return this.templateElement.content.cloneNode(!0)}get templateElement(){if(null===this.firstElementChild){const t=this.ownerDocument.createElement("template");return this.appendChild(t),t}if(this.firstElementChild instanceof HTMLTemplateElement)return this.firstElementChild;this.raise("first child element must be a <template> element")}get action(){return this.getAttribute("action")}get target(){return this.getAttribute("target")}get targets(){return this.getAttribute("targets")}raise(t){throw new Error(`${this.description}: ${t}`)}get description(){var t,e;return null!==(e=(null!==(t=this.outerHTML.match(/<[^>]+>/))&&void 0!==t?t:[])[0])&&void 0!==e?e:"<turbo-stream>"}get beforeRenderEvent(){return new CustomEvent("turbo:before-stream-render",{bubbles:!0,cancelable:!0,detail:{newStream:this,render:Rt.renderElement}})}get targetElementsById(){var t;const e=null===(t=this.ownerDocument)||void 0===t?void 0:t.getElementById(this.target);return null!==e?[e]:[]}get targetElementsByQuery(){var t;const e=null===(t=this.ownerDocument)||void 0===t?void 0:t.querySelectorAll(this.targets);return 0!==e.length?Array.prototype.slice.call(e):[]}}class Ft extends HTMLElement{constructor(){super(...arguments),this.streamSource=null}connectedCallback(){this.streamSource=this.src.match(/^ws{1,2}:/)?new WebSocket(this.src):new EventSource(this.src),Mt(this.streamSource)}disconnectedCallback(){this.streamSource&&Ct(this.streamSource)}get src(){return this.getAttribute("src")||""}}h.delegateConstructor=class{constructor(t){this.fetchResponseLoaded=t=>{},this.currentFetchRequest=null,this.resolveVisitPromise=()=>{},this.connected=!1,this.hasBeenLoaded=!1,this.ignoredAttributes=new Set,this.action=null,this.visitCachedSnapshot=({element:t})=>{const e=t.querySelector("#"+this.element.id);e&&this.previousFrameElement&&e.replaceChildren(...this.previousFrameElement.children),delete this.previousFrameElement},this.element=t,this.view=new H(this,this.element),this.appearanceObserver=new B(this,this.element),this.formLinkClickObserver=new Z(this,this.element),this.linkInterceptor=new q(this,this.element),this.restorationIdentifier=P(),this.formSubmitObserver=new $(this,this.element)}connect(){this.connected||(this.connected=!0,this.loadingStyle==o.lazy?this.appearanceObserver.start():this.loadSourceURL(),this.formLinkClickObserver.start(),this.linkInterceptor.start(),this.formSubmitObserver.start())}disconnect(){this.connected&&(this.connected=!1,this.appearanceObserver.stop(),this.formLinkClickObserver.stop(),this.linkInterceptor.stop(),this.formSubmitObserver.stop())}disabledChanged(){this.loadingStyle==o.eager&&this.loadSourceURL()}sourceURLChanged(){this.isIgnoringChangesTo("src")||(this.element.isConnected&&(this.complete=!1),(this.loadingStyle==o.eager||this.hasBeenLoaded)&&this.loadSourceURL())}sourceURLReloaded(){const{src:t}=this.element;return this.ignoringChangesToAttribute("complete",(()=>{this.element.removeAttribute("complete")})),this.element.src=null,this.element.src=t,this.element.loaded}completeChanged(){this.isIgnoringChangesTo("complete")||this.loadSourceURL()}loadingStyleChanged(){this.loadingStyle==o.lazy?this.appearanceObserver.start():(this.appearanceObserver.stop(),this.loadSourceURL())}async loadSourceURL(){this.enabled&&this.isActive&&!this.complete&&this.sourceURL&&(this.element.loaded=this.visit(d(this.sourceURL)),this.appearanceObserver.stop(),await this.element.loaded,this.hasBeenLoaded=!0)}async loadResponse(t){(t.redirected||t.succeeded&&t.isHTML)&&(this.sourceURL=t.response.url);try{const e=await t.responseHTML;if(e){const r=E(e);rt.fromDocument(r).isVisitable?await this.loadFrameResponse(t,r):await this.handleUnvisitableFrameResponse(t)}}finally{this.fetchResponseLoaded=()=>{}}}elementAppearedInViewport(t){this.proposeVisitIfNavigatedWithAction(t,t),this.loadSourceURL()}willSubmitFormLinkToLocation(t){return this.shouldInterceptNavigation(t)}submittedFormLinkToLocation(t,e,r){const i=this.findFrameElement(t);i&&r.setAttribute("data-turbo-frame",i.id)}shouldInterceptLinkClick(t,e,r){return this.shouldInterceptNavigation(t)}linkClickIntercepted(t,e){this.navigateFrame(t,e)}willSubmitForm(t,e){return t.closest("turbo-frame")==this.element&&this.shouldInterceptNavigation(t,e)}formSubmitted(t,e){this.formSubmission&&this.formSubmission.stop(),this.formSubmission=new j(this,t,e);const{fetchRequest:r}=this.formSubmission;this.prepareRequest(r),this.formSubmission.start()}prepareRequest(t){var e;t.headers["Turbo-Frame"]=this.id,(null===(e=this.currentNavigationElement)||void 0===e?void 0:e.hasAttribute("data-turbo-stream"))&&t.acceptResponseType(z.contentType)}requestStarted(t){A(this.element)}requestPreventedHandlingResponse(t,e){this.resolveVisitPromise()}async requestSucceededWithResponse(t,e){await this.loadResponse(e),this.resolveVisitPromise()}async requestFailedWithResponse(t,e){await this.loadResponse(e),this.resolveVisitPromise()}requestErrored(t,e){console.error(e),this.resolveVisitPromise()}requestFinished(t){M(this.element)}formSubmissionStarted({formElement:t}){A(t,this.findFrameElement(t))}formSubmissionSucceededWithResponse(t,e){const r=this.findFrameElement(t.formElement,t.submitter);r.delegate.proposeVisitIfNavigatedWithAction(r,t.formElement,t.submitter),r.delegate.loadResponse(e),t.isSafe||St.clearCache()}formSubmissionFailedWithResponse(t,e){this.element.delegate.loadResponse(e),St.clearCache()}formSubmissionErrored(t,e){console.error(e)}formSubmissionFinished({formElement:t}){M(t,this.findFrameElement(t))}allowsImmediateRender({element:t},e){const r=w("turbo:before-frame-render",{target:this.element,detail:Object.assign({newFrame:t},e),cancelable:!0}),{defaultPrevented:i,detail:{render:n}}=r;return this.view.renderer&&n&&(this.view.renderer.renderElement=n),!i}viewRenderedSnapshot(t,e){}preloadOnLoadLinksForView(t){St.preloadOnLoadLinksForView(t)}viewInvalidated(){}willRenderFrame(t,e){this.previousFrameElement=t.cloneNode(!0)}async loadFrameResponse(t,e){const r=await this.extractForeignFrameElement(e.body);if(r){const e=new N(r),i=new K(this,this.view.snapshot,e,K.renderElement,!1,!1);this.view.renderPromise&&await this.view.renderPromise,this.changeHistory(),await this.view.render(i),this.complete=!0,St.frameRendered(t,this.element),St.frameLoaded(this.element),this.fetchResponseLoaded(t)}else this.willHandleFrameMissingFromResponse(t)&&this.handleFrameMissingFromResponse(t)}async visit(t){var e;const r=new F(this,s.get,t,new URLSearchParams,this.element);return null===(e=this.currentFetchRequest)||void 0===e||e.cancel(),this.currentFetchRequest=r,new Promise((t=>{this.resolveVisitPromise=()=>{this.resolveVisitPromise=()=>{},this.currentFetchRequest=null,t()},r.perform()}))}navigateFrame(t,e,r){const i=this.findFrameElement(t,r);i.delegate.proposeVisitIfNavigatedWithAction(i,t,r),this.withCurrentNavigationElement(t,(()=>{i.src=e}))}proposeVisitIfNavigatedWithAction(t,e,r){if(this.action=O(r,e,t),this.action){const e=rt.fromElement(t).clone(),{visitCachedSnapshot:r}=t.delegate;t.delegate.fetchResponseLoaded=i=>{if(t.src){const{statusCode:n,redirected:o}=i,s={response:{statusCode:n,redirected:o,responseHTML:t.ownerDocument.documentElement.outerHTML},visitCachedSnapshot:r,willRender:!1,updateHistory:!1,restorationIdentifier:this.restorationIdentifier,snapshot:e};this.action&&(s.action=this.action),St.visit(t.src,s)}}}}changeHistory(){if(this.action){const t=I(this.action);St.history.update(t,d(this.element.src||""),this.restorationIdentifier)}}async handleUnvisitableFrameResponse(t){console.warn(`The response (${t.statusCode}) from <turbo-frame id="${this.element.id}"> is performing a full page visit due to turbo-visit-control.`),await this.visitResponse(t.response)}willHandleFrameMissingFromResponse(t){this.element.setAttribute("complete","");const e=t.response;return!w("turbo:frame-missing",{target:this.element,detail:{response:e,visit:async(t,e={})=>{t instanceof Response?this.visitResponse(t):St.visit(t,e)}},cancelable:!0}).defaultPrevented}handleFrameMissingFromResponse(t){this.view.missing(),this.throwFrameMissingError(t)}throwFrameMissingError(t){const e=`The response (${t.statusCode}) did not contain the expected <turbo-frame id="${this.element.id}"> and will be ignored. To perform a full page visit instead, set turbo-visit-control to reload.`;throw new Ot(e)}async visitResponse(t){const e=new b(t),r=await e.responseHTML,{location:i,redirected:n,statusCode:o}=e;return St.visit(i,{response:{redirected:n,statusCode:o,responseHTML:r}})}findFrameElement(t,e){var r;return null!==(r=Lt(k("data-turbo-frame",e,t)||this.element.getAttribute("target")))&&void 0!==r?r:this.element}async extractForeignFrameElement(t){let e;const r=CSS.escape(this.id);try{if(e=Dt(t.querySelector(`turbo-frame#${r}`),this.sourceURL),e)return e;if(e=Dt(t.querySelector(`turbo-frame[src][recurse~=${r}]`),this.sourceURL),e)return await e.loaded,await this.extractForeignFrameElement(e)}catch(t){return console.error(t),new h}return null}formActionIsVisitable(t,e){return y(d(f(t,e)),this.rootLocation)}shouldInterceptNavigation(t,e){const r=k("data-turbo-frame",e,t)||this.element.getAttribute("target");if(t instanceof HTMLFormElement&&!this.formActionIsVisitable(t,e))return!1;if(!this.enabled||"_top"==r)return!1;if(r){const t=Lt(r);if(t)return!t.disabled}return!!St.elementIsNavigatable(t)&&!(e&&!St.elementIsNavigatable(e))}get id(){return this.element.id}get enabled(){return!this.element.disabled}get sourceURL(){if(this.element.src)return this.element.src}set sourceURL(t){this.ignoringChangesToAttribute("src",(()=>{this.element.src=null!=t?t:null}))}get loadingStyle(){return this.element.loading}get isLoading(){return void 0!==this.formSubmission||void 0!==this.resolveVisitPromise()}get complete(){return this.element.hasAttribute("complete")}set complete(t){this.ignoringChangesToAttribute("complete",(()=>{t?this.element.setAttribute("complete",""):this.element.removeAttribute("complete")}))}get isActive(){return this.element.isActive&&this.connected}get rootLocation(){var t;const e=this.element.ownerDocument.querySelector('meta[name="turbo-root"]');return d(null!==(t=null==e?void 0:e.content)&&void 0!==t?t:"/")}isIgnoringChangesTo(t){return this.ignoredAttributes.has(t)}ignoringChangesToAttribute(t,e){this.ignoredAttributes.add(t),e(),this.ignoredAttributes.delete(t)}withCurrentNavigationElement(t,e){this.currentNavigationElement=t,e(),delete this.currentNavigationElement}},void 0===customElements.get("turbo-frame")&&customElements.define("turbo-frame",h),void 0===customElements.get("turbo-stream")&&customElements.define("turbo-stream",Rt),void 0===customElements.get("turbo-stream-source")&&customElements.define("turbo-stream-source",Ft),(()=>{let t=document.currentScript;if(t&&!t.hasAttribute("data-turbo-suppress-warning"))for(t=t.parentElement;t;){if(t==document.body)return console.warn(S`
        You are loading Turbo from a <script> element inside the <body> element. This is probably not what you meant to do!

        Load your application’s JavaScript bundle inside the <head> element instead. <script> elements in <body> are evaluated with each page change.

        For more information, see: https://turbo.hotwired.dev/handbook/building#working-with-script-elements

        ——
        Suppress this warning by adding a "data-turbo-suppress-warning" attribute to: %s
      `,t.outerHTML);t=t.parentElement}})(),window.Turbo=It,At()},4945:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _asyncIterator(t){var e,r,i,n=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,i=Symbol.iterator);n--;){if(r&&null!=(e=t[r]))return e.call(t);if(i&&null!=(e=t[i]))return new AsyncFromSyncIterator(e.call(t));r="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}function AsyncFromSyncIterator(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return AsyncFromSyncIterator=function(t){this.s=t,this.n=t.next},AsyncFromSyncIterator.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new AsyncFromSyncIterator(t)}var REACT_ELEMENT_TYPE;function _jsx(t,e,r,i){REACT_ELEMENT_TYPE||(REACT_ELEMENT_TYPE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var n=t&&t.defaultProps,o=arguments.length-3;if(e||0===o||(e={children:void 0}),1===o)e.children=i;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];e.children=s}if(e&&n)for(var l in n)void 0===e[l]&&(e[l]=n[l]);else e||(e=n||{});return{$$typeof:REACT_ELEMENT_TYPE,type:t,key:void 0===r?null:""+r,ref:null,props:e,_owner:null}}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function _objectSpread2(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach((function(e){_defineProperty(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _wrapRegExp(){_wrapRegExp=function(t,e){return new r(t,void 0,e)};var t=RegExp.prototype,e=new WeakMap;function r(t,i,n){var o=new RegExp(t,i);return e.set(o,n||e.get(t)),_setPrototypeOf(o,r.prototype)}function i(t,r){var i=e.get(r);return Object.keys(i).reduce((function(e,r){return e[r]=t[i[r]],e}),Object.create(null))}return _inherits(r,RegExp),r.prototype.exec=function(e){var r=t.exec.call(this,e);return r&&(r.groups=i(r,this)),r},r.prototype[Symbol.replace]=function(r,n){if("string"==typeof n){var o=e.get(this);return t[Symbol.replace].call(this,r,n.replace(/\$<([^>]+)>/g,(function(t,e){return"$"+o[e]})))}if("function"==typeof n){var s=this;return t[Symbol.replace].call(this,r,(function(){var t=arguments;return"object"!=typeof t[t.length-1]&&(t=[].slice.call(t)).push(i(t,s)),n.apply(this,t)}))}return t[Symbol.replace].call(this,r,n)},_wrapRegExp.apply(this,arguments)}function _AwaitValue(t){this.wrapped=t}function _AsyncGenerator(t){var e,r;function i(e,r){try{var o=t[e](r),s=o.value,a=s instanceof _AwaitValue;Promise.resolve(a?s.wrapped:s).then((function(t){a?i("return"===e?"return":"next",t):n(o.done?"return":"normal",t)}),(function(t){i("throw",t)}))}catch(t){n("throw",t)}}function n(t,n){switch(t){case"return":e.resolve({value:n,done:!0});break;case"throw":e.reject(n);break;default:e.resolve({value:n,done:!1})}(e=e.next)?i(e.key,e.arg):r=null}this._invoke=function(t,n){return new Promise((function(o,s){var a={key:t,arg:n,resolve:o,reject:s,next:null};r?r=r.next=a:(e=r=a,i(t,n))}))},"function"!=typeof t.return&&(this.return=void 0)}function _wrapAsyncGenerator(t){return function(){return new _AsyncGenerator(t.apply(this,arguments))}}function _awaitAsyncGenerator(t){return new _AwaitValue(t)}function _asyncGeneratorDelegate(t,e){var r={},i=!1;function n(r,n){return i=!0,n=new Promise((function(e){e(t[r](n))})),{done:!1,value:e(n)}}return r["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},r.next=function(t){return i?(i=!1,t):n("next",t)},"function"==typeof t.throw&&(r.throw=function(t){if(i)throw i=!1,t;return n("throw",t)}),"function"==typeof t.return&&(r.return=function(t){return i?(i=!1,t):n("return",t)}),r}function asyncGeneratorStep(t,e,r,i,n,o,s){try{var a=t[o](s),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(i,n)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function s(t){asyncGeneratorStep(o,i,n,s,a,"next",t)}function a(t){asyncGeneratorStep(o,i,n,s,a,"throw",t)}s(void 0)}))}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _defineEnumerableProperties(t,e){for(var r in e)(o=e[r]).configurable=o.enumerable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,r,o);if(Object.getOwnPropertySymbols)for(var i=Object.getOwnPropertySymbols(e),n=0;n<i.length;n++){var o,s=i[n];(o=e[s]).configurable=o.enumerable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,s,o)}return t}function _defaults(t,e){for(var r=Object.getOwnPropertyNames(e),i=0;i<r.length;i++){var n=r[i],o=Object.getOwnPropertyDescriptor(e,n);o&&o.configurable&&void 0===t[n]&&Object.defineProperty(t,n,o)}return t}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _extends(){return _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},_extends.apply(this,arguments)}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?Object(arguments[e]):{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&i.push.apply(i,Object.getOwnPropertySymbols(r).filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),i.forEach((function(e){_defineProperty(t,e,r[e])}))}return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _inheritsLoose(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,_setPrototypeOf(t,e)}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function _construct(t,e,r){return _construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,r){var i=[null];i.push.apply(i,e);var n=new(Function.bind.apply(t,i));return r&&_setPrototypeOf(n,r.prototype),n},_construct.apply(null,arguments)}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _wrapNativeSuper(t){var e="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,t)},_wrapNativeSuper(t)}function _instanceof(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(t){return t?r:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=_getRequireWildcardCache(e);if(r&&r.has(t))return r.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var s=n?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=t[o]}return i.default=t,r&&r.set(t,i),i}function _newArrowCheck(t,e){if(t!==e)throw new TypeError("Cannot instantiate an arrow function")}function _objectDestructuringEmpty(t){if(null==t)throw new TypeError("Cannot destructure undefined")}function _objectWithoutPropertiesLoose(t,e){if(null==t)return{};var r,i,n={},o=Object.keys(t);for(i=0;i<o.length;i++)r=o[i],e.indexOf(r)>=0||(n[r]=t[r]);return n}function _objectWithoutProperties(t,e){if(null==t)return{};var r,i,n=_objectWithoutPropertiesLoose(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _possibleConstructorReturn(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,i=_getPrototypeOf(t);if(e){var n=_getPrototypeOf(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var i=_superPropBase(t,e);if(i){var n=Object.getOwnPropertyDescriptor(i,e);return n.get?n.get.call(arguments.length<3?t:r):n.value}},_get.apply(this,arguments)}function set(t,e,r,i){return set="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,r,i){var n,o=_superPropBase(t,e);if(o){if((n=Object.getOwnPropertyDescriptor(o,e)).set)return n.set.call(i,r),!0;if(!n.writable)return!1}if(n=Object.getOwnPropertyDescriptor(i,e)){if(!n.writable)return!1;n.value=r,Object.defineProperty(i,e,n)}else _defineProperty(i,e,r);return!0},set(t,e,r,i)}function _set(t,e,r,i,n){if(!set(t,e,r,i||t)&&n)throw new Error("failed to set property");return r}function _taggedTemplateLiteral(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function _taggedTemplateLiteralLoose(t,e){return e||(e=t.slice(0)),t.raw=e,t}function _readOnlyError(t){throw new TypeError('"'+t+'" is read-only')}function _writeOnlyError(t){throw new TypeError('"'+t+'" is write-only')}function _classNameTDZError(t){throw new Error('Class "'+t+'" cannot be referenced in computed property keys.')}function _temporalUndefined(){}function _tdz(t){throw new ReferenceError(t+" is not defined - temporal dead zone")}function _temporalRef(t,e){return t===_temporalUndefined?_tdz(e):t}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _slicedToArrayLoose(t,e){return _arrayWithHoles(t)||_iterableToArrayLimitLoose(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _toArray(t){return _arrayWithHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableRest()}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _maybeArrayLike(t,e,r){if(e&&!Array.isArray(e)&&"number"==typeof e.length){var i=e.length;return _arrayLikeToArray(e,void 0!==r&&r<i?r:i)}return t(e,r)}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var i,n,o=[],s=!0,a=!1;try{for(r=r.call(t);!(s=(i=r.next()).done)&&(o.push(i.value),!e||o.length!==e);s=!0);}catch(t){a=!0,n=t}finally{try{s||null==r.return||r.return()}finally{if(a)throw n}}return o}}function _iterableToArrayLimitLoose(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=r){var i=[];for(r=r.call(t),_step;!(_step=r.next()).done&&(i.push(_step.value),!e||i.length!==e););return i}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function _createForOfIteratorHelperLoose(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _skipFirstGeneratorNext(t){return function(){var e=t.apply(this,arguments);return e.next(),e}}function _toPrimitive(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==typeof e?e:String(e)}function _initializerWarningHelper(t,e){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}function _initializerDefineProperty(t,e,r,i){r&&Object.defineProperty(t,e,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function _applyDecoratedDescriptor(t,e,r,i,n){var o={};return Object.keys(i).forEach((function(t){o[t]=i[t]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce((function(r,i){return i(t,e,r)||r}),o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(t,e,o),o=null),o}_AsyncGenerator.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},_AsyncGenerator.prototype.next=function(t){return this._invoke("next",t)},_AsyncGenerator.prototype.throw=function(t){return this._invoke("throw",t)},_AsyncGenerator.prototype.return=function(t){return this._invoke("return",t)};var id=0;function _classPrivateFieldLooseKey(t){return"__private_"+id+++"_"+t}function _classPrivateFieldLooseBase(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}function _classPrivateFieldGet(t,e){return _classApplyDescriptorGet(t,_classExtractFieldDescriptor(t,e,"get"))}function _classPrivateFieldSet(t,e,r){return _classApplyDescriptorSet(t,_classExtractFieldDescriptor(t,e,"set"),r),r}function _classPrivateFieldDestructureSet(t,e){return _classApplyDescriptorDestructureSet(t,_classExtractFieldDescriptor(t,e,"set"))}function _classExtractFieldDescriptor(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function _classStaticPrivateFieldSpecGet(t,e,r){return _classCheckPrivateStaticAccess(t,e),_classCheckPrivateStaticFieldDescriptor(r,"get"),_classApplyDescriptorGet(t,r)}function _classStaticPrivateFieldSpecSet(t,e,r,i){return _classCheckPrivateStaticAccess(t,e),_classCheckPrivateStaticFieldDescriptor(r,"set"),_classApplyDescriptorSet(t,r,i),i}function _classStaticPrivateMethodGet(t,e,r){return _classCheckPrivateStaticAccess(t,e),r}function _classStaticPrivateMethodSet(){throw new TypeError("attempted to set read only static private field")}function _classApplyDescriptorGet(t,e){return e.get?e.get.call(t):e.value}function _classApplyDescriptorSet(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function _classApplyDescriptorDestructureSet(t,e){if(e.set)return"__destrObj"in e||(e.__destrObj={set value(r){e.set.call(t,r)}}),e.__destrObj;if(!e.writable)throw new TypeError("attempted to set read only private field");return e}function _classStaticPrivateFieldDestructureSet(t,e,r){return _classCheckPrivateStaticAccess(t,e),_classCheckPrivateStaticFieldDescriptor(r,"set"),_classApplyDescriptorDestructureSet(t,r)}function _classCheckPrivateStaticAccess(t,e){if(t!==e)throw new TypeError("Private static access of wrong provenance")}function _classCheckPrivateStaticFieldDescriptor(t,e){if(void 0===t)throw new TypeError("attempted to "+e+" private static field before its declaration")}function _decorate(t,e,r,i){var n=_getDecoratorsApi();if(i)for(var o=0;o<i.length;o++)n=i[o](n);var s=e((function(t){n.initializeInstanceElements(t,a.elements)}),r),a=n.decorateClass(_coalesceClassElements(s.d.map(_createElementDescriptor)),t);return n.initializeClassElements(s.F,a.elements),n.runClassFinishers(s.F,a.finishers)}function _getDecoratorsApi(){_getDecoratorsApi=function(){return t};var t={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(t,e){["method","field"].forEach((function(r){e.forEach((function(e){e.kind===r&&"own"===e.placement&&this.defineClassElement(t,e)}),this)}),this)},initializeClassElements:function(t,e){var r=t.prototype;["method","field"].forEach((function(i){e.forEach((function(e){var n=e.placement;if(e.kind===i&&("static"===n||"prototype"===n)){var o="static"===n?t:r;this.defineClassElement(o,e)}}),this)}),this)},defineClassElement:function(t,e){var r=e.descriptor;if("field"===e.kind){var i=e.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===i?void 0:i.call(t)}}Object.defineProperty(t,e.key,r)},decorateClass:function(t,e){var r=[],i=[],n={static:[],prototype:[],own:[]};if(t.forEach((function(t){this.addElementPlacement(t,n)}),this),t.forEach((function(t){if(!_hasDecorators(t))return r.push(t);var e=this.decorateElement(t,n);r.push(e.element),r.push.apply(r,e.extras),i.push.apply(i,e.finishers)}),this),!e)return{elements:r,finishers:i};var o=this.decorateConstructor(r,e);return i.push.apply(i,o.finishers),o.finishers=i,o},addElementPlacement:function(t,e,r){var i=e[t.placement];if(!r&&-1!==i.indexOf(t.key))throw new TypeError("Duplicated element ("+t.key+")");i.push(t.key)},decorateElement:function(t,e){for(var r=[],i=[],n=t.decorators,o=n.length-1;o>=0;o--){var s=e[t.placement];s.splice(s.indexOf(t.key),1);var a=this.fromElementDescriptor(t),l=this.toElementFinisherExtras((0,n[o])(a)||a);t=l.element,this.addElementPlacement(t,e),l.finisher&&i.push(l.finisher);var c=l.extras;if(c){for(var u=0;u<c.length;u++)this.addElementPlacement(c[u],e);r.push.apply(r,c)}}return{element:t,finishers:i,extras:r}},decorateConstructor:function(t,e){for(var r=[],i=e.length-1;i>=0;i--){var n=this.fromClassDescriptor(t),o=this.toClassDescriptor((0,e[i])(n)||n);if(void 0!==o.finisher&&r.push(o.finisher),void 0!==o.elements){t=o.elements;for(var s=0;s<t.length-1;s++)for(var a=s+1;a<t.length;a++)if(t[s].key===t[a].key&&t[s].placement===t[a].placement)throw new TypeError("Duplicated element ("+t[s].key+")")}}return{elements:t,finishers:r}},fromElementDescriptor:function(t){var e={kind:t.kind,key:t.key,placement:t.placement,descriptor:t.descriptor};return Object.defineProperty(e,Symbol.toStringTag,{value:"Descriptor",configurable:!0}),"field"===t.kind&&(e.initializer=t.initializer),e},toElementDescriptors:function(t){if(void 0!==t)return _toArray(t).map((function(t){var e=this.toElementDescriptor(t);return this.disallowProperty(t,"finisher","An element descriptor"),this.disallowProperty(t,"extras","An element descriptor"),e}),this)},toElementDescriptor:function(t){var e=String(t.kind);if("method"!==e&&"field"!==e)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+e+'"');var r=_toPropertyKey(t.key),i=String(t.placement);if("static"!==i&&"prototype"!==i&&"own"!==i)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+i+'"');var n=t.descriptor;this.disallowProperty(t,"elements","An element descriptor");var o={kind:e,key:r,placement:i,descriptor:Object.assign({},n)};return"field"!==e?this.disallowProperty(t,"initializer","A method descriptor"):(this.disallowProperty(n,"get","The property descriptor of a field descriptor"),this.disallowProperty(n,"set","The property descriptor of a field descriptor"),this.disallowProperty(n,"value","The property descriptor of a field descriptor"),o.initializer=t.initializer),o},toElementFinisherExtras:function(t){return{element:this.toElementDescriptor(t),finisher:_optionalCallableProperty(t,"finisher"),extras:this.toElementDescriptors(t.extras)}},fromClassDescriptor:function(t){var e={kind:"class",elements:t.map(this.fromElementDescriptor,this)};return Object.defineProperty(e,Symbol.toStringTag,{value:"Descriptor",configurable:!0}),e},toClassDescriptor:function(t){var e=String(t.kind);if("class"!==e)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+e+'"');this.disallowProperty(t,"key","A class descriptor"),this.disallowProperty(t,"placement","A class descriptor"),this.disallowProperty(t,"descriptor","A class descriptor"),this.disallowProperty(t,"initializer","A class descriptor"),this.disallowProperty(t,"extras","A class descriptor");var r=_optionalCallableProperty(t,"finisher");return{elements:this.toElementDescriptors(t.elements),finisher:r}},runClassFinishers:function(t,e){for(var r=0;r<e.length;r++){var i=(0,e[r])(t);if(void 0!==i){if("function"!=typeof i)throw new TypeError("Finishers must return a constructor.");t=i}}return t},disallowProperty:function(t,e,r){if(void 0!==t[e])throw new TypeError(r+" can't have a ."+e+" property.")}};return t}function _createElementDescriptor(t){var e,r=_toPropertyKey(t.key);"method"===t.kind?e={value:t.value,writable:!0,configurable:!0,enumerable:!1}:"get"===t.kind?e={get:t.value,configurable:!0,enumerable:!1}:"set"===t.kind?e={set:t.value,configurable:!0,enumerable:!1}:"field"===t.kind&&(e={configurable:!0,writable:!0,enumerable:!0});var i={kind:"field"===t.kind?"field":"method",key:r,placement:t.static?"static":"field"===t.kind?"own":"prototype",descriptor:e};return t.decorators&&(i.decorators=t.decorators),"field"===t.kind&&(i.initializer=t.value),i}function _coalesceGetterSetter(t,e){void 0!==t.descriptor.get?e.descriptor.get=t.descriptor.get:e.descriptor.set=t.descriptor.set}function _coalesceClassElements(t){for(var e=[],r=function(t){return"method"===t.kind&&t.key===o.key&&t.placement===o.placement},i=0;i<t.length;i++){var n,o=t[i];if("method"===o.kind&&(n=e.find(r)))if(_isDataDescriptor(o.descriptor)||_isDataDescriptor(n.descriptor)){if(_hasDecorators(o)||_hasDecorators(n))throw new ReferenceError("Duplicated methods ("+o.key+") can't be decorated.");n.descriptor=o.descriptor}else{if(_hasDecorators(o)){if(_hasDecorators(n))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+o.key+").");n.decorators=o.decorators}_coalesceGetterSetter(o,n)}else e.push(o)}return e}function _hasDecorators(t){return t.decorators&&t.decorators.length}function _isDataDescriptor(t){return void 0!==t&&!(void 0===t.value&&void 0===t.writable)}function _optionalCallableProperty(t,e){var r=t[e];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+e+"' to be a function");return r}function _classPrivateMethodGet(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}function _checkPrivateRedeclaration(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldInitSpec(t,e,r){_checkPrivateRedeclaration(t,e),e.set(t,r)}function _classPrivateMethodInitSpec(t,e){_checkPrivateRedeclaration(t,e),e.add(t)}function _classPrivateMethodSet(){throw new TypeError("attempted to reassign private method")}var _extendStatics=function(t,e){return _extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},_extendStatics(t,e)};function __extends(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}_extendStatics(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var _assign=function(){return _assign=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},_assign.apply(this,arguments)};function __rest(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]])}return r}function __decorate(t,e,r,i){var n,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(o<3?n(s):o>3?n(e,r,s):n(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s}function __param(t,e){return function(r,i){e(r,i,t)}}function __metadata(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function __awaiter(t,e,r,i){return new(r||(r=Promise))((function(n,o){function s(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}l((i=i.apply(t,e||[])).next())}))}function __generator(t,e){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var __createBinding=Object.create?function(t,e,r,i){void 0===i&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]};function __exportStar(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||__createBinding(e,t,r)}function __values(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,n,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return s}function __spread(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(__read(arguments[e]));return t}function __spreadArrays(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,n++)i[n]=o[s];return i}function __spreadArray(t,e,r){if(r||2===arguments.length)for(var i,n=0,o=e.length;n<o;n++)!i&&n in e||(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}function __await(t){return this instanceof __await?(this.v=t,this):new __await(t)}function __asyncGenerator(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(t,e||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(t){n[t]&&(i[t]=function(e){return new Promise((function(r,i){o.push([t,e,r,i])>1||a(t,e)}))})}function a(t,e){try{!function(t){t.value instanceof __await?Promise.resolve(t.value.v).then(l,c):u(o[0][2],t)}(n[t](e))}catch(t){u(o[0][3],t)}}function l(t){a("next",t)}function c(t){a("throw",t)}function u(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}}function __asyncDelegator(t){var e,r;return e={},i("next"),i("throw",(function(t){throw t})),i("return"),e[Symbol.iterator]=function(){return this},e;function i(i,n){e[i]=t[i]?function(e){return(r=!r)?{value:__await(t[i](e)),done:"return"===i}:n?n(e):e}:n}}function __asyncValues(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(r){e[r]=t[r]&&function(e){return new Promise((function(i,n){!function(t,e,r,i){Promise.resolve(i).then((function(e){t({value:e,done:r})}),e)}(i,n,(e=t[r](e)).done,e.value)}))}}}function __makeTemplateObject(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var __setModuleDefault=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function __importStar(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&__createBinding(e,t,r);return __setModuleDefault(e,t),e}function __importDefault(t){return t&&t.__esModule?t:{default:t}}function __classPrivateFieldGet(t,e,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(t):i?i.value:e.get(t)}function __classPrivateFieldSet(t,e,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(t,r):n?n.value=r:e.set(t,r),r}var t$3=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,e$8=Symbol(),n$5=new Map;class s$3{constructor(t,e){if(this._$cssResult$=!0,e!==e$8)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t}get styleSheet(){var t=n$5.get(this.cssText);return t$3&&void 0===t&&(n$5.set(this.cssText,t=new CSSStyleSheet),t.replaceSync(this.cssText)),t}toString(){return this.cssText}}var o$5=t=>new s$3("string"==typeof t?t:t+"",e$8),r$3=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];var n=1===t.length?t[0]:r.reduce(((e,r,i)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(r)+t[i+1]),t[0]);return new s$3(n,e$8)},i$3=(t,e)=>{t$3?t.adoptedStyleSheets=e.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):e.forEach((e=>{var r=document.createElement("style"),i=window.litNonce;void 0!==i&&r.setAttribute("nonce",i),r.textContent=e.cssText,t.appendChild(r)}))},S$1=t$3?t=>t:t=>t instanceof CSSStyleSheet?(t=>{var e="";for(var r of t.cssRules)e+=r.cssText;return o$5(e)})(t):t,s$2,e$7=window.trustedTypes,r$2=e$7?e$7.emptyScript:"",h$2=window.reactiveElementPolyfillSupport,o$4={toAttribute(t,e){switch(e){case Boolean:t=t?r$2:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){var r=t;switch(e){case Boolean:r=null!==t;break;case Number:r=null===t?null:Number(t);break;case Object:case Array:try{r=JSON.parse(t)}catch(t){r=null}}return r}},n$4=(t,e)=>e!==t&&(e==e||t==t),l$3={attribute:!0,type:String,converter:o$4,reflect:!1,hasChanged:n$4},t$2;class a$1 extends HTMLElement{constructor(){super(),this._$Et=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Ei=null,this.o()}static addInitializer(t){var e;null!==(e=this.l)&&void 0!==e||(this.l=[]),this.l.push(t)}static get observedAttributes(){this.finalize();var t=[];return this.elementProperties.forEach(((e,r)=>{var i=this._$Eh(r,e);void 0!==i&&(this._$Eu.set(i,r),t.push(i))})),t}static createProperty(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l$3;if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){var r="symbol"==typeof t?Symbol():"__"+t,i=this.getPropertyDescriptor(t,r,e);void 0!==i&&Object.defineProperty(this.prototype,t,i)}}static getPropertyDescriptor(t,e,r){return{get(){return this[e]},set(i){var n=this[t];this[e]=i,this.requestUpdate(t,n,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||l$3}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;var t=Object.getPrototypeOf(this);if(t.finalize(),this.elementProperties=new Map(t.elementProperties),this._$Eu=new Map,this.hasOwnProperty("properties")){var e=this.properties,r=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(var i of r)this.createProperty(i,e[i])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){var e=[];if(Array.isArray(t)){var r=new Set(t.flat(1/0).reverse());for(var i of r)e.unshift(S$1(i))}else void 0!==t&&e.push(S$1(t));return e}static _$Eh(t,e){var r=e.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof t?t.toLowerCase():void 0}o(){var t;this._$Ep=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$Em(),this.requestUpdate(),null===(t=this.constructor.l)||void 0===t||t.forEach((t=>t(this)))}addController(t){var e,r;(null!==(e=this._$Eg)&&void 0!==e?e:this._$Eg=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(r=t.hostConnected)||void 0===r||r.call(t))}removeController(t){var e;null===(e=this._$Eg)||void 0===e||e.splice(this._$Eg.indexOf(t)>>>0,1)}_$Em(){this.constructor.elementProperties.forEach(((t,e)=>{this.hasOwnProperty(e)&&(this._$Et.set(e,this[e]),delete this[e])}))}createRenderRoot(){var t,e=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return i$3(e,this.constructor.elementStyles),e}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$Eg)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostConnected)||void 0===e?void 0:e.call(t)}))}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$Eg)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostDisconnected)||void 0===e?void 0:e.call(t)}))}attributeChangedCallback(t,e,r){this._$AK(t,r)}_$ES(t,e){var r,i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l$3,o=this.constructor._$Eh(t,n);if(void 0!==o&&!0===n.reflect){var s=(null!==(i=null===(r=n.converter)||void 0===r?void 0:r.toAttribute)&&void 0!==i?i:o$4.toAttribute)(e,n.type);this._$Ei=t,null==s?this.removeAttribute(o):this.setAttribute(o,s),this._$Ei=null}}_$AK(t,e){var r,i,n,o=this.constructor,s=o._$Eu.get(t);if(void 0!==s&&this._$Ei!==s){var a=o.getPropertyOptions(s),l=a.converter,c=null!==(n=null!==(i=null===(r=l)||void 0===r?void 0:r.fromAttribute)&&void 0!==i?i:"function"==typeof l?l:null)&&void 0!==n?n:o$4.fromAttribute;this._$Ei=s,this[s]=c(e,a.type),this._$Ei=null}}requestUpdate(t,e,r){var i=!0;void 0!==t&&(((r=r||this.constructor.getPropertyOptions(t)).hasChanged||n$4)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),!0===r.reflect&&this._$Ei!==t&&(void 0===this._$E_&&(this._$E_=new Map),this._$E_.set(t,r))):i=!1),!this.isUpdatePending&&i&&(this._$Ep=this._$EC())}_$EC(){var t=this;return _asyncToGenerator((function*(){t.isUpdatePending=!0;try{yield t._$Ep}catch(e){Promise.reject(e)}var e=t.scheduleUpdate();return null!=e&&(yield e),!t.isUpdatePending}))()}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(this.isUpdatePending){this.hasUpdated,this._$Et&&(this._$Et.forEach(((t,e)=>this[e]=t)),this._$Et=void 0);var e=!1,r=this._$AL;try{(e=this.shouldUpdate(r))?(this.willUpdate(r),null===(t=this._$Eg)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostUpdate)||void 0===e?void 0:e.call(t)})),this.update(r)):this._$EU()}catch(t){throw e=!1,this._$EU(),t}e&&this._$AE(r)}}willUpdate(t){}_$AE(t){var e;null===(e=this._$Eg)||void 0===e||e.forEach((t=>{var e;return null===(e=t.hostUpdated)||void 0===e?void 0:e.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$Ep}shouldUpdate(t){return!0}update(t){void 0!==this._$E_&&(this._$E_.forEach(((t,e)=>this._$ES(e,this[e],t))),this._$E_=void 0),this._$EU()}updated(t){}firstUpdated(t){}}a$1.finalized=!0,a$1.elementProperties=new Map,a$1.elementStyles=[],a$1.shadowRootOptions={mode:"open"},null==h$2||h$2({ReactiveElement:a$1}),(null!==(s$2=globalThis.reactiveElementVersions)&&void 0!==s$2?s$2:globalThis.reactiveElementVersions=[]).push("1.2.1");var i$2=globalThis.trustedTypes,s$1=i$2?i$2.createPolicy("lit-html",{createHTML:t=>t}):void 0,e$6="lit$".concat((Math.random()+"").slice(9),"$"),o$3="?"+e$6,n$3="<".concat(o$3,">"),l$2=document,h$1=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return l$2.createComment(t)},r$1=t=>null===t||"object"!=typeof t&&"function"!=typeof t,d=Array.isArray,u=t=>{var e;return d(t)||"function"==typeof(null===(e=t)||void 0===e?void 0:e[Symbol.iterator])},c=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,v=/-->/g,a=/>/g,f=/>|[ 	\n\r](?:([^\s"'>=/]+)([ 	\n\r]*=[ 	\n\r]*(?:[^ 	\n\r"'`<>=]|("|')|))|$)/g,_=/'/g,m=/"/g,g=/^(?:script|style|textarea)$/i,p=t=>function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];return{_$litType$:t,strings:e,values:i}},$=p(1),y=p(2),b=Symbol.for("lit-noChange"),w=Symbol.for("lit-nothing"),T=new WeakMap,x=(t,e,r)=>{var i,n,o=null!==(i=null==r?void 0:r.renderBefore)&&void 0!==i?i:e,s=o._$litPart$;if(void 0===s){var a=null!==(n=null==r?void 0:r.renderBefore)&&void 0!==n?n:null;o._$litPart$=s=new N(e.insertBefore(h$1(),a),a,void 0,null!=r?r:{})}return s._$AI(t),s},A=l$2.createTreeWalker(l$2,129,null,!1),C=(t,e)=>{for(var r,i=t.length-1,n=[],o=2===e?"<svg>":"",s=c,l=0;l<i;l++){for(var u=t[l],h=void 0,d=void 0,p=-1,y=0;y<u.length&&(s.lastIndex=y,null!==(d=s.exec(u)));)y=s.lastIndex,s===c?"!--"===d[1]?s=v:void 0!==d[1]?s=a:void 0!==d[2]?(g.test(d[2])&&(r=RegExp("</"+d[2],"g")),s=f):void 0!==d[3]&&(s=f):s===f?">"===d[0]?(s=null!=r?r:c,p=-1):void 0===d[1]?p=-2:(p=s.lastIndex-d[2].length,h=d[1],s=void 0===d[3]?f:'"'===d[3]?m:_):s===m||s===_?s=f:s===v||s===a?s=c:(s=f,r=void 0);var b=s===f&&t[l+1].startsWith("/>")?" ":"";o+=s===c?u+n$3:p>=0?(n.push(h),u.slice(0,p)+"$lit$"+u.slice(p)+e$6+b):u+e$6+(-2===p?(n.push(void 0),l):b)}var x=o+(t[i]||"<?>")+(2===e?"</svg>":"");if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==s$1?s$1.createHTML(x):x,n]};class E{constructor(t,e){var r,{strings:i,_$litType$:n}=t;this.parts=[];var o=0,s=0,a=i.length-1,l=this.parts,[c,u]=C(i,n);if(this.el=E.createElement(c,e),A.currentNode=this.el.content,2===n){var h=this.el.content,d=h.firstChild;d.remove(),h.append(...d.childNodes)}for(;null!==(r=A.nextNode())&&l.length<a;){if(1===r.nodeType){if(r.hasAttributes()){var p=[];for(var f of r.getAttributeNames())if(f.endsWith("$lit$")||f.startsWith(e$6)){var m=u[s++];if(p.push(f),void 0!==m){var y=r.getAttribute(m.toLowerCase()+"$lit$").split(e$6),v=/([.?@])?(.*)/.exec(m);l.push({type:1,index:o,name:v[2],strings:y,ctor:"."===v[1]?M:"?"===v[1]?H:"@"===v[1]?I:S})}else l.push({type:6,index:o})}for(var _ of p)r.removeAttribute(_)}if(g.test(r.tagName)){var b=r.textContent.split(e$6),x=b.length-1;if(x>0){r.textContent=i$2?i$2.emptyScript:"";for(var w=0;w<x;w++)r.append(b[w],h$1()),A.nextNode(),l.push({type:2,index:++o});r.append(b[x],h$1())}}}else if(8===r.nodeType)if(r.data===o$3)l.push({type:2,index:o});else for(var T=-1;-1!==(T=r.data.indexOf(e$6,T+1));)l.push({type:7,index:o}),T+=e$6.length-1;o++}}static createElement(t,e){var r=l$2.createElement("template");return r.innerHTML=t,r}}function P(t,e){var r,i,n,o,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,a=arguments.length>3?arguments[3]:void 0;if(e===b)return e;var l=void 0!==a?null===(r=s._$Cl)||void 0===r?void 0:r[a]:s._$Cu,c=r$1(e)?void 0:e._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(i=null==l?void 0:l._$AO)||void 0===i||i.call(l,!1),void 0===c?l=void 0:(l=new c(t))._$AT(t,s,a),void 0!==a?(null!==(n=(o=s)._$Cl)&&void 0!==n?n:o._$Cl=[])[a]=l:s._$Cu=l),void 0!==l&&(e=P(t,l._$AS(t,e.values),l,a)),e}class V{constructor(t,e){this.v=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}p(t){var e,{el:{content:r},parts:i}=this._$AD,n=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:l$2).importNode(r,!0);A.currentNode=n;for(var o=A.nextNode(),s=0,a=0,l=i[0];void 0!==l;){if(s===l.index){var c=void 0;2===l.type?c=new N(o,o.nextSibling,this,t):1===l.type?c=new l.ctor(o,l.name,l.strings,this,t):6===l.type&&(c=new L(o,this,t)),this.v.push(c),l=i[++a]}s!==(null==l?void 0:l.index)&&(o=A.nextNode(),s++)}return n}m(t){var e=0;for(var r of this.v)void 0!==r&&(void 0!==r.strings?(r._$AI(t,r,e),e+=r.strings.length-2):r._$AI(t[e])),e++}}class N{constructor(t,e,r,i){var n;this.type=2,this._$AH=w,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=r,this.options=i,this._$Cg=null===(n=null==i?void 0:i.isConnected)||void 0===n||n}get _$AU(){var t,e;return null!==(e=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==e?e:this._$Cg}get parentNode(){var t=this._$AA.parentNode,e=this._$AM;return void 0!==e&&11===t.nodeType&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t){t=P(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this),r$1(t)?t===w||null==t||""===t?(this._$AH!==w&&this._$AR(),this._$AH=w):t!==this._$AH&&t!==b&&this.$(t):void 0!==t._$litType$?this.T(t):void 0!==t.nodeType?this.S(t):u(t)?this.A(t):this.$(t)}M(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._$AB;return this._$AA.parentNode.insertBefore(t,e)}S(t){this._$AH!==t&&(this._$AR(),this._$AH=this.M(t))}$(t){this._$AH!==w&&r$1(this._$AH)?this._$AA.nextSibling.data=t:this.S(l$2.createTextNode(t)),this._$AH=t}T(t){var e,{values:r,_$litType$:i}=t,n="number"==typeof i?this._$AC(t):(void 0===i.el&&(i.el=E.createElement(i.h,this.options)),i);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===n)this._$AH.m(r);else{var o=new V(n,this),s=o.p(this.options);o.m(r),this.S(s),this._$AH=o}}_$AC(t){var e=T.get(t.strings);return void 0===e&&T.set(t.strings,e=new E(t)),e}A(t){d(this._$AH)||(this._$AH=[],this._$AR());var e,r=this._$AH,i=0;for(var n of t)i===r.length?r.push(e=new N(this.M(h$1()),this.M(h$1()),this,this.options)):e=r[i],e._$AI(n),i++;i<r.length&&(this._$AR(e&&e._$AB.nextSibling,i),r.length=i)}_$AR(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._$AA.nextSibling,r=arguments.length>1?arguments[1]:void 0;for(null===(t=this._$AP)||void 0===t||t.call(this,!1,!0,r);e&&e!==this._$AB;){var i=e.nextSibling;e.remove(),e=i}}setConnected(t){var e;void 0===this._$AM&&(this._$Cg=t,null===(e=this._$AP)||void 0===e||e.call(this,t))}}class S{constructor(t,e,r,i,n){this.type=1,this._$AH=w,this._$AN=void 0,this.element=t,this.name=e,this._$AM=i,this.options=n,r.length>2||""!==r[0]||""!==r[1]?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=w}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,n=this.strings,o=!1;if(void 0===n)t=P(this,t,e,0),(o=!r$1(t)||t!==this._$AH&&t!==b)&&(this._$AH=t);else{var s,a,l=t;for(t=n[0],s=0;s<n.length-1;s++)(a=P(this,l[r+s],e,s))===b&&(a=this._$AH[s]),o||(o=!r$1(a)||a!==this._$AH[s]),a===w?t=w:t!==w&&(t+=(null!=a?a:"")+n[s+1]),this._$AH[s]=a}o&&!i&&this.k(t)}k(t){t===w?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:"")}}class M extends S{constructor(){super(...arguments),this.type=3}k(t){this.element[this.name]=t===w?void 0:t}}var k=i$2?i$2.emptyScript:"";class H extends S{constructor(){super(...arguments),this.type=4}k(t){t&&t!==w?this.element.setAttribute(this.name,k):this.element.removeAttribute(this.name)}}class I extends S{constructor(t,e,r,i,n){super(t,e,r,i,n),this.type=5}_$AI(t){var e;if((t=null!==(e=P(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,0))&&void 0!==e?e:w)!==b){var r=this._$AH,i=t===w&&r!==w||t.capture!==r.capture||t.once!==r.once||t.passive!==r.passive,n=t!==w&&(r===w||i);i&&this.element.removeEventListener(this.name,this,r),n&&this.element.addEventListener(this.name,this,t),this._$AH=t}}handleEvent(t){var e,r;"function"==typeof this._$AH?this._$AH.call(null!==(r=null===(e=this.options)||void 0===e?void 0:e.host)&&void 0!==r?r:this.element,t):this._$AH.handleEvent(t)}}class L{constructor(t,e,r){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(t){P(this,t)}}var R={P:"$lit$",V:e$6,L:o$3,I:1,N:C,R:V,D:u,j:P,H:N,O:S,F:H,B:I,W:M,Z:L},z=window.litHtmlPolyfillSupport,l$1,o$2;null==z||z(E,N),(null!==(t$2=globalThis.litHtmlVersions)&&void 0!==t$2?t$2:globalThis.litHtmlVersions=[]).push("2.1.2");var r=a$1;class s extends a$1{constructor(){super(...arguments),this.renderOptions={host:this},this._$Dt=void 0}createRenderRoot(){var t,e,r=super.createRenderRoot();return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=r.firstChild),r}update(t){var e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Dt=x(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Dt)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Dt)||void 0===t||t.setConnected(!1)}render(){return b}}s.finalized=!0,s._$litElement$=!0,null===(l$1=globalThis.litElementHydrateSupport)||void 0===l$1||l$1.call(globalThis,{LitElement:s});var n$2=globalThis.litElementPolyfillSupport;null==n$2||n$2({LitElement:s});var h={_$AK:(t,e,r)=>{t._$AK(e,r)},_$AL:t=>t._$AL};(null!==(o$2=globalThis.litElementVersions)&&void 0!==o$2?o$2:globalThis.litElementVersions=[]).push("3.1.2");var n$1=t=>e=>"function"==typeof e?((t,e)=>(window.customElements.define(t,e),e))(t,e):((t,e)=>{var{kind:r,elements:i}=e;return{kind:r,elements:i,finisher(e){window.customElements.define(t,e)}}})(t,e),i$1=(t,e)=>"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?_objectSpread2(_objectSpread2({},e),{},{finisher(r){r.createProperty(e.key,t)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:e.key,initializer(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(r){r.createProperty(e.key,t)}};function e$5(t){return(e,r)=>void 0!==r?((t,e,r)=>{e.constructor.createProperty(r,t)})(t,e,r):i$1(t,e)}function t$1(t){return e$5(_objectSpread2(_objectSpread2({},t),{},{state:!0}))}var e$4=(t,e,r)=>{Object.defineProperty(e,r,t)},t=(t,e)=>({kind:"method",placement:"prototype",key:e.key,descriptor:t}),o$1=t=>{var{finisher:e,descriptor:r}=t;return(t,i)=>{var n;if(void 0===i){var o=null!==(n=t.originalKey)&&void 0!==n?n:t.key,s=null!=r?{kind:"method",placement:"prototype",key:o,descriptor:r(t.key)}:_objectSpread2(_objectSpread2({},t),{},{key:o});return null!=e&&(s.finisher=function(t){e(t,o)}),s}var a=t.constructor;void 0!==r&&Object.defineProperty(t,i,r(i)),null==e||e(a,i)}},n;function e$3(t){return o$1({finisher:(e,r)=>{Object.assign(e.prototype[r],t)}})}function i(t,e){return o$1({descriptor:r=>{var i={get(){var e,r;return null!==(r=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t))&&void 0!==r?r:null},enumerable:!0,configurable:!0};if(e){var n="symbol"==typeof r?Symbol():"__"+r;i.get=function(){var e,r;return void 0===this[n]&&(this[n]=null!==(r=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t))&&void 0!==r?r:null),this[n]}}return i}})}function e$2(t){return o$1({descriptor:e=>({get(){var e,r;return null!==(r=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelectorAll(t))&&void 0!==r?r:[]},enumerable:!0,configurable:!0})})}function e$1(t){return o$1({descriptor:e=>({get(){var e=this;return _asyncToGenerator((function*(){var r;return yield e.updateComplete,null===(r=e.renderRoot)||void 0===r?void 0:r.querySelector(t)}))()},enumerable:!0,configurable:!0})})}var e=null!=(null===(n=window.HTMLSlotElement)||void 0===n?void 0:n.prototype.assignedElements)?(t,e)=>t.assignedElements(e):(t,e)=>t.assignedNodes(e).filter((t=>t.nodeType===Node.ELEMENT_NODE));function l(t){var{slot:r,selector:i}=null!=t?t:{};return o$1({descriptor:n=>({get(){var n,o="slot"+(r?"[name=".concat(r,"]"):":not([name])"),s=null===(n=this.renderRoot)||void 0===n?void 0:n.querySelector(o),a=null!=s?e(s,t):[];return i?a.filter((t=>t.matches(i))):a},enumerable:!0,configurable:!0})})}function o(t,e,r){var i,n=t;return"object"==typeof t?(n=t.slot,i=t):i={flatten:e},r?l({slot:n,flatten:e,selector:r}):o$1({descriptor:t=>({get(){var t,e,r="slot"+(n?"[name=".concat(n,"]"):":not([name])"),o=null===(t=this.renderRoot)||void 0===t?void 0:t.querySelector(r);return null!==(e=null==o?void 0:o.assignedNodes(i))&&void 0!==e?e:[]},enumerable:!0,configurable:!0})})}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function getDefaultExportFromNamespaceIfPresent(t){return t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function getDefaultExportFromNamespaceIfNotNamed(t){return t&&Object.prototype.hasOwnProperty.call(t,"default")&&1===Object.keys(t).length?t.default:t}function getAugmentedNamespace(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})})),e}function commonjsRequire(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var lottie$1={exports:{}};(function(module){var root,factory;"undefined"!=typeof navigator&&(root=window||{},factory=function(window){var svgNS="http://www.w3.org/2000/svg",locationHref="",initialDefaultFrame=-999999,_useWebWorker=!1,subframeEnabled=!0,idPrefix="",expressionsPlugin,isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),cachedColors={},bmRnd,bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={};function ProjectInterface(){return{}}!function(){var t,e=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],r=e.length;for(t=0;t<r;t+=1)BMMath[e[t]]=Math[e[t]]}(),BMMath.random=Math.random,BMMath.abs=function(t){if("object"==typeof t&&t.length){var e,r=createSizedArray(t.length),i=t.length;for(e=0;e<i;e+=1)r[e]=Math.abs(t[e]);return r}return Math.abs(t)};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function roundValues(t){bmRnd=t?Math.round:function(t){return t}}function styleDiv(t){t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.display="block",t.style.transformOrigin="0 0",t.style.webkitTransformOrigin="0 0",t.style.backfaceVisibility="visible",t.style.webkitBackfaceVisibility="visible",t.style.transformStyle="preserve-3d",t.style.webkitTransformStyle="preserve-3d",t.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(t,e,r,i){this.type=t,this.currentTime=e,this.totalTime=r,this.direction=i<0?-1:1}function BMCompleteEvent(t,e){this.type=t,this.direction=e<0?-1:1}function BMCompleteLoopEvent(t,e,r,i){this.type=t,this.currentLoop=r,this.totalLoops=e,this.direction=i<0?-1:1}function BMSegmentStartEvent(t,e,r){this.type=t,this.firstFrame=e,this.totalFrames=r}function BMDestroyEvent(t,e){this.type=t,this.target=e}function BMRenderFrameErrorEvent(t,e){this.type="renderFrameError",this.nativeError=t,this.currentTime=e}function BMConfigErrorEvent(t){this.type="configError",this.nativeError=t}function BMAnimationConfigErrorEvent(t,e){this.type=t,this.nativeError=e}roundValues(!1);var createElementID=(_count=0,function(){return idPrefix+"__lottie_element_"+(_count+=1)}),_count;function HSVtoRGB(t,e,r){var i,n,o,s,a,l,c,u;switch(l=r*(1-e),c=r*(1-(a=6*t-(s=Math.floor(6*t)))*e),u=r*(1-(1-a)*e),s%6){case 0:i=r,n=u,o=l;break;case 1:i=c,n=r,o=l;break;case 2:i=l,n=r,o=u;break;case 3:i=l,n=c,o=r;break;case 4:i=u,n=l,o=r;break;case 5:i=r,n=l,o=c}return[i,n,o]}function RGBtoHSV(t,e,r){var i,n=Math.max(t,e,r),o=Math.min(t,e,r),s=n-o,a=0===n?0:s/n,l=n/255;switch(n){case o:i=0;break;case t:i=e-r+s*(e<r?6:0),i/=6*s;break;case e:i=r-t+2*s,i/=6*s;break;case r:i=t-e+4*s,i/=6*s}return[i,a,l]}function addSaturationToRGB(t,e){var r=RGBtoHSV(255*t[0],255*t[1],255*t[2]);return r[1]+=e,r[1]>1?r[1]=1:r[1]<=0&&(r[1]=0),HSVtoRGB(r[0],r[1],r[2])}function addBrightnessToRGB(t,e){var r=RGBtoHSV(255*t[0],255*t[1],255*t[2]);return r[2]+=e,r[2]>1?r[2]=1:r[2]<0&&(r[2]=0),HSVtoRGB(r[0],r[1],r[2])}function addHueToRGB(t,e){var r=RGBtoHSV(255*t[0],255*t[1],255*t[2]);return r[0]+=e/360,r[0]>1?r[0]-=1:r[0]<0&&(r[0]+=1),HSVtoRGB(r[0],r[1],r[2])}var rgbToHex=function(){var t,e,r=[];for(t=0;t<256;t+=1)e=t.toString(16),r[t]=1===e.length?"0"+e:e;return function(t,e,i){return t<0&&(t=0),e<0&&(e=0),i<0&&(i=0),"#"+r[t]+r[e]+r[i]}}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(t,e){if(this._cbs[t])for(var r=this._cbs[t],i=0;i<r.length;i+=1)r[i](e)},addEventListener:function(t,e){return this._cbs[t]||(this._cbs[t]=[]),this._cbs[t].push(e),function(){this.removeEventListener(t,e)}.bind(this)},removeEventListener:function(t,e){if(e){if(this._cbs[t]){for(var r=0,i=this._cbs[t].length;r<i;)this._cbs[t][r]===e&&(this._cbs[t].splice(r,1),r-=1,i-=1),r+=1;this._cbs[t].length||(this._cbs[t]=null)}}else this._cbs[t]=null}};var createTypedArray=function(){function t(t,e){var r,i=0,n=[];switch(t){case"int16":case"uint8c":r=1;break;default:r=1.1}for(i=0;i<e;i+=1)n.push(r);return n}return"function"==typeof Uint8ClampedArray&&"function"==typeof Float32Array?function(e,r){return"float32"===e?new Float32Array(r):"int16"===e?new Int16Array(r):"uint8c"===e?new Uint8ClampedArray(r):t(e,r)}:t}();function createSizedArray(t){return Array.apply(null,{length:t})}function createNS(t){return document.createElementNS(svgNS,t)}function createTag(t){return document.createElement(t)}function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(t){-1===this.dynamicProperties.indexOf(t)&&(this.dynamicProperties.push(t),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){var t;this._mdf=!1;var e=this.dynamicProperties.length;for(t=0;t<e;t+=1)this.dynamicProperties[t].getValue(),this.dynamicProperties[t]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(t){this.container=t,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var getBlendMode=(blendModeEnums={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"},function(t){return blendModeEnums[t]||""}),blendModeEnums,lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"},Matrix=function(){var t=Math.cos,e=Math.sin,r=Math.tan,i=Math.round;function n(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function o(r){if(0===r)return this;var i=t(r),n=e(r);return this._t(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1)}function s(r){if(0===r)return this;var i=t(r),n=e(r);return this._t(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1)}function a(r){if(0===r)return this;var i=t(r),n=e(r);return this._t(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1)}function l(r){if(0===r)return this;var i=t(r),n=e(r);return this._t(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1)}function c(t,e){return this._t(1,e,t,1,0,0)}function u(t,e){return this.shear(r(t),r(e))}function h(i,n){var o=t(n),s=e(n);return this._t(o,s,0,0,-s,o,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,r(i),1,0,0,0,0,1,0,0,0,0,1)._t(o,-s,0,0,s,o,0,0,0,0,1,0,0,0,0,1)}function d(t,e,r){return r||0===r||(r=1),1===t&&1===e&&1===r?this:this._t(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1)}function p(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m){return this.props[0]=t,this.props[1]=e,this.props[2]=r,this.props[3]=i,this.props[4]=n,this.props[5]=o,this.props[6]=s,this.props[7]=a,this.props[8]=l,this.props[9]=c,this.props[10]=u,this.props[11]=h,this.props[12]=d,this.props[13]=p,this.props[14]=f,this.props[15]=m,this}function f(t,e,r){return r=r||0,0!==t||0!==e||0!==r?this._t(1,0,0,0,0,1,0,0,0,0,1,0,t,e,r,1):this}function m(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m){var g=this.props;if(1===t&&0===e&&0===r&&0===i&&0===n&&1===o&&0===s&&0===a&&0===l&&0===c&&1===u&&0===h)return g[12]=g[12]*t+g[15]*d,g[13]=g[13]*o+g[15]*p,g[14]=g[14]*u+g[15]*f,g[15]*=m,this._identityCalculated=!1,this;var y=g[0],v=g[1],_=g[2],b=g[3],x=g[4],w=g[5],T=g[6],E=g[7],S=g[8],P=g[9],k=g[10],A=g[11],M=g[12],C=g[13],I=g[14],O=g[15];return g[0]=y*t+v*n+_*l+b*d,g[1]=y*e+v*o+_*c+b*p,g[2]=y*r+v*s+_*u+b*f,g[3]=y*i+v*a+_*h+b*m,g[4]=x*t+w*n+T*l+E*d,g[5]=x*e+w*o+T*c+E*p,g[6]=x*r+w*s+T*u+E*f,g[7]=x*i+w*a+T*h+E*m,g[8]=S*t+P*n+k*l+A*d,g[9]=S*e+P*o+k*c+A*p,g[10]=S*r+P*s+k*u+A*f,g[11]=S*i+P*a+k*h+A*m,g[12]=M*t+C*n+I*l+O*d,g[13]=M*e+C*o+I*c+O*p,g[14]=M*r+C*s+I*u+O*f,g[15]=M*i+C*a+I*h+O*m,this._identityCalculated=!1,this}function g(){return this._identityCalculated||(this._identity=!(1!==this.props[0]||0!==this.props[1]||0!==this.props[2]||0!==this.props[3]||0!==this.props[4]||1!==this.props[5]||0!==this.props[6]||0!==this.props[7]||0!==this.props[8]||0!==this.props[9]||1!==this.props[10]||0!==this.props[11]||0!==this.props[12]||0!==this.props[13]||0!==this.props[14]||1!==this.props[15]),this._identityCalculated=!0),this._identity}function y(t){for(var e=0;e<16;){if(t.props[e]!==this.props[e])return!1;e+=1}return!0}function v(t){var e;for(e=0;e<16;e+=1)t.props[e]=this.props[e];return t}function _(t){var e;for(e=0;e<16;e+=1)this.props[e]=t[e]}function b(t,e,r){return{x:t*this.props[0]+e*this.props[4]+r*this.props[8]+this.props[12],y:t*this.props[1]+e*this.props[5]+r*this.props[9]+this.props[13],z:t*this.props[2]+e*this.props[6]+r*this.props[10]+this.props[14]}}function x(t,e,r){return t*this.props[0]+e*this.props[4]+r*this.props[8]+this.props[12]}function w(t,e,r){return t*this.props[1]+e*this.props[5]+r*this.props[9]+this.props[13]}function T(t,e,r){return t*this.props[2]+e*this.props[6]+r*this.props[10]+this.props[14]}function E(){var t=this.props[0]*this.props[5]-this.props[1]*this.props[4],e=this.props[5]/t,r=-this.props[1]/t,i=-this.props[4]/t,n=this.props[0]/t,o=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/t,s=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/t,a=new Matrix;return a.props[0]=e,a.props[1]=r,a.props[4]=i,a.props[5]=n,a.props[12]=o,a.props[13]=s,a}function S(t){return this.getInverseMatrix().applyToPointArray(t[0],t[1],t[2]||0)}function P(t){var e,r=t.length,i=[];for(e=0;e<r;e+=1)i[e]=S(t[e]);return i}function k(t,e,r){var i=createTypedArray("float32",6);if(this.isIdentity())i[0]=t[0],i[1]=t[1],i[2]=e[0],i[3]=e[1],i[4]=r[0],i[5]=r[1];else{var n=this.props[0],o=this.props[1],s=this.props[4],a=this.props[5],l=this.props[12],c=this.props[13];i[0]=t[0]*n+t[1]*s+l,i[1]=t[0]*o+t[1]*a+c,i[2]=e[0]*n+e[1]*s+l,i[3]=e[0]*o+e[1]*a+c,i[4]=r[0]*n+r[1]*s+l,i[5]=r[0]*o+r[1]*a+c}return i}function A(t,e,r){return this.isIdentity()?[t,e,r]:[t*this.props[0]+e*this.props[4]+r*this.props[8]+this.props[12],t*this.props[1]+e*this.props[5]+r*this.props[9]+this.props[13],t*this.props[2]+e*this.props[6]+r*this.props[10]+this.props[14]]}function M(t,e){if(this.isIdentity())return t+","+e;var r=this.props;return Math.round(100*(t*r[0]+e*r[4]+r[12]))/100+","+Math.round(100*(t*r[1]+e*r[5]+r[13]))/100}function C(){for(var t=0,e=this.props,r="matrix3d(";t<16;)r+=i(1e4*e[t])/1e4,r+=15===t?")":",",t+=1;return r}function I(t){return t<1e-6&&t>0||t>-1e-6&&t<0?i(1e4*t)/1e4:t}function O(){var t=this.props;return"matrix("+I(t[0])+","+I(t[1])+","+I(t[4])+","+I(t[5])+","+I(t[12])+","+I(t[13])+")"}return function(){this.reset=n,this.rotate=o,this.rotateX=s,this.rotateY=a,this.rotateZ=l,this.skew=u,this.skewFromAxis=h,this.shear=c,this.scale=d,this.setTransform=p,this.translate=f,this.transform=m,this.applyToPoint=b,this.applyToX=x,this.applyToY=w,this.applyToZ=T,this.applyToPointArray=A,this.applyToTriplePoints=k,this.applyToPointStringified=M,this.toCSS=C,this.to2dCSS=O,this.clone=v,this.cloneFromProps=_,this.equals=y,this.inversePoints=P,this.inversePoint=S,this.getInverseMatrix=E,this._t=this.transform,this.isIdentity=g,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}}();!function(t,e){var r=this,i=256,n=e.pow(i,6),o=e.pow(2,52),s=2*o,a=255;function l(t){var e,r=t.length,n=this,o=0,s=n.i=n.j=0,l=n.S=[];for(r||(t=[r++]);o<i;)l[o]=o++;for(o=0;o<i;o++)l[o]=l[s=a&s+t[o%r]+(e=l[o])],l[s]=e;n.g=function(t){for(var e,r=0,o=n.i,s=n.j,l=n.S;t--;)e=l[o=a&o+1],r=r*i+l[a&(l[o]=l[s=a&s+e])+(l[s]=e)];return n.i=o,n.j=s,r}}function c(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function u(t,e){var r,i=[],n=typeof t;if(e&&"object"==n)for(r in t)try{i.push(u(t[r],e-1))}catch(t){}return i.length?i:"string"==n?t:t+"\0"}function h(t,e){for(var r,i=t+"",n=0;n<i.length;)e[a&n]=a&(r^=19*e[a&n])+i.charCodeAt(n++);return d(e)}function d(t){return String.fromCharCode.apply(0,t)}e.seedrandom=function(a,p,f){var m=[],g=h(u((p=!0===p?{entropy:!0}:p||{}).entropy?[a,d(t)]:null===a?function(){try{var e=new Uint8Array(i);return(r.crypto||r.msCrypto).getRandomValues(e),d(e)}catch(e){var n=r.navigator,o=n&&n.plugins;return[+new Date,r,o,r.screen,d(t)]}}():a,3),m),y=new l(m),v=function(){for(var t=y.g(6),e=n,r=0;t<o;)t=(t+r)*i,e*=i,r=y.g(1);for(;t>=s;)t/=2,e/=2,r>>>=1;return(t+r)/e};return v.int32=function(){return 0|y.g(4)},v.quick=function(){return y.g(4)/4294967296},v.double=v,h(d(y.S),t),(p.pass||f||function(t,r,i,n){return n&&(n.S&&c(n,y),t.state=function(){return c(y,{})}),i?(e.random=t,r):t})(v,g,"global"in p?p.global:this==e,p.state)},h(e.random(),t)}([],BMMath);var BezierFactory=function(){var t={getBezierEasing:function(t,r,i,n,o){var s=o||("bez_"+t+"_"+r+"_"+i+"_"+n).replace(/\./g,"p");if(e[s])return e[s];var a=new c([t,r,i,n]);return e[s]=a,a}},e={},r=.1,i="function"==typeof Float32Array;function n(t,e){return 1-3*e+3*t}function o(t,e){return 3*e-6*t}function s(t){return 3*t}function a(t,e,r){return((n(e,r)*t+o(e,r))*t+s(e))*t}function l(t,e,r){return 3*n(e,r)*t*t+2*o(e,r)*t+s(e)}function c(t){this._p=t,this._mSampleValues=i?new Float32Array(11):new Array(11),this._precomputed=!1,this.get=this.get.bind(this)}return c.prototype={get:function(t){var e=this._p[0],r=this._p[1],i=this._p[2],n=this._p[3];return this._precomputed||this._precompute(),e===r&&i===n?t:0===t?0:1===t?1:a(this._getTForX(t),r,n)},_precompute:function(){var t=this._p[0],e=this._p[1],r=this._p[2],i=this._p[3];this._precomputed=!0,t===e&&r===i||this._calcSampleValues()},_calcSampleValues:function(){for(var t=this._p[0],e=this._p[2],i=0;i<11;++i)this._mSampleValues[i]=a(i*r,t,e)},_getTForX:function(t){for(var e=this._p[0],i=this._p[2],n=this._mSampleValues,o=0,s=1;10!==s&&n[s]<=t;++s)o+=r;var c=o+(t-n[--s])/(n[s+1]-n[s])*r,u=l(c,e,i);return u>=.001?function(t,e,r,i){for(var n=0;n<4;++n){var o=l(e,r,i);if(0===o)return e;e-=(a(e,r,i)-t)/o}return e}(t,c,e,i):0===u?c:function(t,e,r,i,n){var o,s,l=0;do{(o=a(s=e+(r-e)/2,i,n)-t)>0?r=s:e=s}while(Math.abs(o)>1e-7&&++l<10);return s}(t,o,o+r,e,i)}},t}();function extendPrototype(t,e){var r,i,n=t.length;for(r=0;r<n;r+=1)for(var o in i=t[r].prototype)Object.prototype.hasOwnProperty.call(i,o)&&(e.prototype[o]=i[o])}function getDescriptor(t,e){return Object.getOwnPropertyDescriptor(t,e)}function createProxyFunction(t){function e(){}return e.prototype=t,e}function bezFunction(){var t=Math;function e(t,e,r,i,n,o){var s=t*i+e*n+r*o-n*i-o*t-r*e;return s>-.001&&s<.001}var r=function(t,e,r,i){var n,o,s,a,l,c,u=defaultCurveSegments,h=0,d=[],p=[],f=bezierLengthPool.newElement();for(s=r.length,n=0;n<u;n+=1){for(l=n/(u-1),c=0,o=0;o<s;o+=1)a=bmPow(1-l,3)*t[o]+3*bmPow(1-l,2)*l*r[o]+3*(1-l)*bmPow(l,2)*i[o]+bmPow(l,3)*e[o],d[o]=a,null!==p[o]&&(c+=bmPow(d[o]-p[o],2)),p[o]=d[o];c&&(h+=c=bmSqrt(c)),f.percents[n]=l,f.lengths[n]=h}return f.addedLength=h,f};function i(t){this.segmentLength=0,this.points=new Array(t)}function n(t,e){this.partialLength=t,this.point=e}var o,s=(o={},function(t,r,s,a){var l=(t[0]+"_"+t[1]+"_"+r[0]+"_"+r[1]+"_"+s[0]+"_"+s[1]+"_"+a[0]+"_"+a[1]).replace(/\./g,"p");if(!o[l]){var c,u,h,d,p,f,m,g=defaultCurveSegments,y=0,v=null;2===t.length&&(t[0]!==r[0]||t[1]!==r[1])&&e(t[0],t[1],r[0],r[1],t[0]+s[0],t[1]+s[1])&&e(t[0],t[1],r[0],r[1],r[0]+a[0],r[1]+a[1])&&(g=2);var _=new i(g);for(h=s.length,c=0;c<g;c+=1){for(m=createSizedArray(h),p=c/(g-1),f=0,u=0;u<h;u+=1)d=bmPow(1-p,3)*t[u]+3*bmPow(1-p,2)*p*(t[u]+s[u])+3*(1-p)*bmPow(p,2)*(r[u]+a[u])+bmPow(p,3)*r[u],m[u]=d,null!==v&&(f+=bmPow(m[u]-v[u],2));y+=f=bmSqrt(f),_.points[c]=new n(f,m),v=m}_.segmentLength=y,o[l]=_}return o[l]});function a(t,e){var r=e.percents,i=e.lengths,n=r.length,o=bmFloor((n-1)*t),s=t*e.addedLength,a=0;if(o===n-1||0===o||s===i[o])return r[o];for(var l=i[o]>s?-1:1,c=!0;c;)if(i[o]<=s&&i[o+1]>s?(a=(s-i[o])/(i[o+1]-i[o]),c=!1):o+=l,o<0||o>=n-1){if(o===n-1)return r[o];c=!1}return r[o]+(r[o+1]-r[o])*a}var l=createTypedArray("float32",8);return{getSegmentsLength:function(t){var e,i=segmentsLengthPool.newElement(),n=t.c,o=t.v,s=t.o,a=t.i,l=t._length,c=i.lengths,u=0;for(e=0;e<l-1;e+=1)c[e]=r(o[e],o[e+1],s[e],a[e+1]),u+=c[e].addedLength;return n&&l&&(c[e]=r(o[e],o[0],s[e],a[0]),u+=c[e].addedLength),i.totalLength=u,i},getNewSegment:function(e,r,i,n,o,s,c){o<0?o=0:o>1&&(o=1);var u,h=a(o,c),d=a(s=s>1?1:s,c),p=e.length,f=1-h,m=1-d,g=f*f*f,y=h*f*f*3,v=h*h*f*3,_=h*h*h,b=f*f*m,x=h*f*m+f*h*m+f*f*d,w=h*h*m+f*h*d+h*f*d,T=h*h*d,E=f*m*m,S=h*m*m+f*d*m+f*m*d,P=h*d*m+f*d*d+h*m*d,k=h*d*d,A=m*m*m,M=d*m*m+m*d*m+m*m*d,C=d*d*m+m*d*d+d*m*d,I=d*d*d;for(u=0;u<p;u+=1)l[4*u]=t.round(1e3*(g*e[u]+y*i[u]+v*n[u]+_*r[u]))/1e3,l[4*u+1]=t.round(1e3*(b*e[u]+x*i[u]+w*n[u]+T*r[u]))/1e3,l[4*u+2]=t.round(1e3*(E*e[u]+S*i[u]+P*n[u]+k*r[u]))/1e3,l[4*u+3]=t.round(1e3*(A*e[u]+M*i[u]+C*n[u]+I*r[u]))/1e3;return l},getPointInSegment:function(e,r,i,n,o,s){var l=a(o,s),c=1-l;return[t.round(1e3*(c*c*c*e[0]+(l*c*c+c*l*c+c*c*l)*i[0]+(l*l*c+c*l*l+l*c*l)*n[0]+l*l*l*r[0]))/1e3,t.round(1e3*(c*c*c*e[1]+(l*c*c+c*l*c+c*c*l)*i[1]+(l*l*c+c*l*l+l*c*l)*n[1]+l*l*l*r[1]))/1e3]},buildBezierData:s,pointOnLine2D:e,pointOnLine3D:function(r,i,n,o,s,a,l,c,u){if(0===n&&0===a&&0===u)return e(r,i,o,s,l,c);var h,d=t.sqrt(t.pow(o-r,2)+t.pow(s-i,2)+t.pow(a-n,2)),p=t.sqrt(t.pow(l-r,2)+t.pow(c-i,2)+t.pow(u-n,2)),f=t.sqrt(t.pow(l-o,2)+t.pow(c-s,2)+t.pow(u-a,2));return(h=d>p?d>f?d-p-f:f-p-d:f>p?f-p-d:p-d-f)>-1e-4&&h<1e-4}}}!function(){for(var t=0,e=["ms","moz","webkit","o"],r=0;r<e.length&&!window.requestAnimationFrame;++r)window.requestAnimationFrame=window[e[r]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[r]+"CancelAnimationFrame"]||window[e[r]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var r=(new Date).getTime(),i=Math.max(0,16-(r-t)),n=setTimeout((function(){e(r+i)}),i);return t=r+i,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}();var bez=bezFunction(),dataManager=function(){var t,e,r=1,i=[],n={onmessage:function(){},postMessage:function(e){t({data:e})}},o={postMessage:function(t){n.onmessage({data:t})}};function s(){e||(e=function(e){if(window.Worker&&window.Blob&&_useWebWorker){var r=new Blob(["var _workerSelf = self; self.onmessage = ",e.toString()],{type:"text/javascript"}),i=URL.createObjectURL(r);return new Worker(i)}return t=e,n}((function(t){if(o.dataManager||(o.dataManager=function(){function t(n,o){var s,a,l,c,u,d,p=n.length;for(a=0;a<p;a+=1)if("ks"in(s=n[a])&&!s.completed){if(s.completed=!0,s.tt&&(n[a-1].td=s.tt),s.hasMask){var f=s.masksProperties;for(c=f.length,l=0;l<c;l+=1)if(f[l].pt.k.i)i(f[l].pt.k);else for(d=f[l].pt.k.length,u=0;u<d;u+=1)f[l].pt.k[u].s&&i(f[l].pt.k[u].s[0]),f[l].pt.k[u].e&&i(f[l].pt.k[u].e[0])}0===s.ty?(s.layers=e(s.refId,o),t(s.layers,o)):4===s.ty?r(s.shapes):5===s.ty&&h(s)}}function e(t,e){for(var r=0,i=e.length;r<i;){if(e[r].id===t)return e[r].layers.__used?JSON.parse(JSON.stringify(e[r].layers)):(e[r].layers.__used=!0,e[r].layers);r+=1}return null}function r(t){var e,n,o;for(e=t.length-1;e>=0;e-=1)if("sh"===t[e].ty)if(t[e].ks.k.i)i(t[e].ks.k);else for(o=t[e].ks.k.length,n=0;n<o;n+=1)t[e].ks.k[n].s&&i(t[e].ks.k[n].s[0]),t[e].ks.k[n].e&&i(t[e].ks.k[n].e[0]);else"gr"===t[e].ty&&r(t[e].it)}function i(t){var e,r=t.i.length;for(e=0;e<r;e+=1)t.i[e][0]+=t.v[e][0],t.i[e][1]+=t.v[e][1],t.o[e][0]+=t.v[e][0],t.o[e][1]+=t.v[e][1]}function n(t,e){var r=e?e.split("."):[100,100,100];return t[0]>r[0]||!(r[0]>t[0])&&(t[1]>r[1]||!(r[1]>t[1])&&(t[2]>r[2]||!(r[2]>t[2])&&null))}var o,s=function(){var t=[4,4,14];function e(t){var e,r,i,n=t.length;for(e=0;e<n;e+=1)5===t[e].ty&&(void 0,i=(r=t[e]).t.d,r.t.d={k:[{s:i,t:0}]})}return function(r){if(n(t,r.v)&&(e(r.layers),r.assets)){var i,o=r.assets.length;for(i=0;i<o;i+=1)r.assets[i].layers&&e(r.assets[i].layers)}}}(),a=(o=[4,7,99],function(t){if(t.chars&&!n(o,t.v)){var e,r,s,a,l,c=t.chars.length;for(e=0;e<c;e+=1)if(t.chars[e].data&&t.chars[e].data.shapes)for(s=(l=t.chars[e].data.shapes[0].it).length,r=0;r<s;r+=1)(a=l[r].ks.k).__converted||(i(l[r].ks.k),a.__converted=!0)}}),l=function(){var t=[5,7,15];function e(t){var e,r,i=t.length;for(e=0;e<i;e+=1)5===t[e].ty&&(r=void 0,"number"==typeof(r=t[e].t.p).a&&(r.a={a:0,k:r.a}),"number"==typeof r.p&&(r.p={a:0,k:r.p}),"number"==typeof r.r&&(r.r={a:0,k:r.r}))}return function(r){if(n(t,r.v)&&(e(r.layers),r.assets)){var i,o=r.assets.length;for(i=0;i<o;i+=1)r.assets[i].layers&&e(r.assets[i].layers)}}}(),c=function(){var t=[4,1,9];function e(t){var r,i,n,o=t.length;for(r=0;r<o;r+=1)if("gr"===t[r].ty)e(t[r].it);else if("fl"===t[r].ty||"st"===t[r].ty)if(t[r].c.k&&t[r].c.k[0].i)for(n=t[r].c.k.length,i=0;i<n;i+=1)t[r].c.k[i].s&&(t[r].c.k[i].s[0]/=255,t[r].c.k[i].s[1]/=255,t[r].c.k[i].s[2]/=255,t[r].c.k[i].s[3]/=255),t[r].c.k[i].e&&(t[r].c.k[i].e[0]/=255,t[r].c.k[i].e[1]/=255,t[r].c.k[i].e[2]/=255,t[r].c.k[i].e[3]/=255);else t[r].c.k[0]/=255,t[r].c.k[1]/=255,t[r].c.k[2]/=255,t[r].c.k[3]/=255}function r(t){var r,i=t.length;for(r=0;r<i;r+=1)4===t[r].ty&&e(t[r].shapes)}return function(e){if(n(t,e.v)&&(r(e.layers),e.assets)){var i,o=e.assets.length;for(i=0;i<o;i+=1)e.assets[i].layers&&r(e.assets[i].layers)}}}(),u=function(){var t=[4,4,18];function e(t){var r,i,n;for(r=t.length-1;r>=0;r-=1)if("sh"===t[r].ty)if(t[r].ks.k.i)t[r].ks.k.c=t[r].closed;else for(n=t[r].ks.k.length,i=0;i<n;i+=1)t[r].ks.k[i].s&&(t[r].ks.k[i].s[0].c=t[r].closed),t[r].ks.k[i].e&&(t[r].ks.k[i].e[0].c=t[r].closed);else"gr"===t[r].ty&&e(t[r].it)}function r(t){var r,i,n,o,s,a,l=t.length;for(i=0;i<l;i+=1){if((r=t[i]).hasMask){var c=r.masksProperties;for(o=c.length,n=0;n<o;n+=1)if(c[n].pt.k.i)c[n].pt.k.c=c[n].cl;else for(a=c[n].pt.k.length,s=0;s<a;s+=1)c[n].pt.k[s].s&&(c[n].pt.k[s].s[0].c=c[n].cl),c[n].pt.k[s].e&&(c[n].pt.k[s].e[0].c=c[n].cl)}4===r.ty&&e(r.shapes)}}return function(e){if(n(t,e.v)&&(r(e.layers),e.assets)){var i,o=e.assets.length;for(i=0;i<o;i+=1)e.assets[i].layers&&r(e.assets[i].layers)}}}();function h(t){0!==t.t.a.length||"m"in t.t.p||(t.singleShape=!0)}var d={completeData:function(e){e.__complete||(c(e),s(e),a(e),l(e),u(e),t(e.layers,e.assets),e.__complete=!0)}};return d.checkColors=c,d.checkChars=a,d.checkPathProperties=l,d.checkShapes=u,d.completeLayers=t,d}()),o.assetLoader||(o.assetLoader=function(){function t(t){var e=t.getResponseHeader("content-type");return e&&"json"===t.responseType&&-1!==e.indexOf("json")||t.response&&"object"==typeof t.response?t.response:t.response&&"string"==typeof t.response?JSON.parse(t.response):t.responseText?JSON.parse(t.responseText):null}return{load:function(e,r,i,n){var o,s=new XMLHttpRequest;try{s.responseType="json"}catch(t){}s.onreadystatechange=function(){if(4===s.readyState)if(200===s.status)o=t(s),i(o);else try{o=t(s),i(o)}catch(t){n&&n(t)}};try{s.open("GET",e,!0)}catch(t){s.open("GET",r+"/"+e,!0)}s.send()}}}()),"loadAnimation"===t.data.type)o.assetLoader.load(t.data.path,t.data.fullPath,(function(e){o.dataManager.completeData(e),o.postMessage({id:t.data.id,payload:e,status:"success"})}),(function(){o.postMessage({id:t.data.id,status:"error"})}));else if("complete"===t.data.type){var e=t.data.animation;o.dataManager.completeData(e),o.postMessage({id:t.data.id,payload:e,status:"success"})}else"loadData"===t.data.type&&o.assetLoader.load(t.data.path,t.data.fullPath,(function(e){o.postMessage({id:t.data.id,payload:e,status:"success"})}),(function(){o.postMessage({id:t.data.id,status:"error"})}))})),e.onmessage=function(t){var e=t.data,r=e.id,n=i[r];i[r]=null,"success"===e.status?n.onComplete(e.payload):n.onError&&n.onError()})}function a(t,e){var n="processId_"+(r+=1);return i[n]={onComplete:t,onError:e},n}return{loadAnimation:function(t,r,i){s();var n=a(r,i);e.postMessage({type:"loadAnimation",path:t,fullPath:window.location.origin+window.location.pathname,id:n})},loadData:function(t,r,i){s();var n=a(r,i);e.postMessage({type:"loadData",path:t,fullPath:window.location.origin+window.location.pathname,id:n})},completeAnimation:function(t,r,i){s();var n=a(r,i);e.postMessage({type:"complete",animation:t,id:n})}}}();function getFontProperties(t){for(var e=t.fStyle?t.fStyle.split(" "):[],r="normal",i="normal",n=e.length,o=0;o<n;o+=1)switch(e[o].toLowerCase()){case"italic":i="italic";break;case"bold":r="700";break;case"black":r="900";break;case"medium":r="500";break;case"regular":case"normal":r="400";break;case"light":case"thin":r="200"}return{style:i,weight:t.fWeight||r}}var FontManager=function(){var t={w:0,size:0,shapes:[]},e=[];e=e.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var r=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"],i=[65039,8205];function n(t,e){var r=createTag("span");r.setAttribute("aria-hidden",!0),r.style.fontFamily=e;var i=createTag("span");i.innerText="giItT1WQy@!-/#",r.style.position="absolute",r.style.left="-10000px",r.style.top="-10000px",r.style.fontSize="300px",r.style.fontVariant="normal",r.style.fontStyle="normal",r.style.fontWeight="normal",r.style.letterSpacing="0",r.appendChild(i),document.body.appendChild(r);var n=i.offsetWidth;return i.style.fontFamily=function(t){var e,r=t.split(","),i=r.length,n=[];for(e=0;e<i;e+=1)"sans-serif"!==r[e]&&"monospace"!==r[e]&&n.push(r[e]);return n.join(",")}(t)+", "+e,{node:i,w:n,parent:r}}function o(t,e){var r=createNS("text");r.style.fontSize="100px";var i=getFontProperties(e);return r.setAttribute("font-family",e.fFamily),r.setAttribute("font-style",i.style),r.setAttribute("font-weight",i.weight),r.textContent="1",e.fClass?(r.style.fontFamily="inherit",r.setAttribute("class",e.fClass)):r.style.fontFamily=e.fFamily,t.appendChild(r),createTag("canvas").getContext("2d").font=e.fWeight+" "+e.fStyle+" 100px "+e.fFamily,r}var s=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};s.isModifier=function(t,e){var i=t.toString(16)+e.toString(16);return-1!==r.indexOf(i)},s.isZeroWidthJoiner=function(t,e){return e?t===i[0]&&e===i[1]:t===i[1]},s.isCombinedCharacter=function(t){return-1!==e.indexOf(t)};var a={addChars:function(t){if(t){var e;this.chars||(this.chars=[]);var r,i,n=t.length,o=this.chars.length;for(e=0;e<n;e+=1){for(r=0,i=!1;r<o;)this.chars[r].style===t[e].style&&this.chars[r].fFamily===t[e].fFamily&&this.chars[r].ch===t[e].ch&&(i=!0),r+=1;i||(this.chars.push(t[e]),o+=1)}}},addFonts:function(t,e){if(t){if(this.chars)return this.isLoaded=!0,void(this.fonts=t.list);var r,i=t.list,s=i.length,a=s;for(r=0;r<s;r+=1){var l,c,u=!0;if(i[r].loaded=!1,i[r].monoCase=n(i[r].fFamily,"monospace"),i[r].sansCase=n(i[r].fFamily,"sans-serif"),i[r].fPath){if("p"===i[r].fOrigin||3===i[r].origin){if((l=document.querySelectorAll('style[f-forigin="p"][f-family="'+i[r].fFamily+'"], style[f-origin="3"][f-family="'+i[r].fFamily+'"]')).length>0&&(u=!1),u){var h=createTag("style");h.setAttribute("f-forigin",i[r].fOrigin),h.setAttribute("f-origin",i[r].origin),h.setAttribute("f-family",i[r].fFamily),h.type="text/css",h.innerText="@font-face {font-family: "+i[r].fFamily+"; font-style: normal; src: url('"+i[r].fPath+"');}",e.appendChild(h)}}else if("g"===i[r].fOrigin||1===i[r].origin){for(l=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),c=0;c<l.length;c+=1)-1!==l[c].href.indexOf(i[r].fPath)&&(u=!1);if(u){var d=createTag("link");d.setAttribute("f-forigin",i[r].fOrigin),d.setAttribute("f-origin",i[r].origin),d.type="text/css",d.rel="stylesheet",d.href=i[r].fPath,document.body.appendChild(d)}}else if("t"===i[r].fOrigin||2===i[r].origin){for(l=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),c=0;c<l.length;c+=1)i[r].fPath===l[c].src&&(u=!1);if(u){var p=createTag("link");p.setAttribute("f-forigin",i[r].fOrigin),p.setAttribute("f-origin",i[r].origin),p.setAttribute("rel","stylesheet"),p.setAttribute("href",i[r].fPath),e.appendChild(p)}}}else i[r].loaded=!0,a-=1;i[r].helper=o(e,i[r]),i[r].cache={},this.fonts.push(i[r])}0===a?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}else this.isLoaded=!0},getCharData:function(e,r,i){for(var n=0,o=this.chars.length;n<o;){if(this.chars[n].ch===e&&this.chars[n].style===r&&this.chars[n].fFamily===i)return this.chars[n];n+=1}return("string"==typeof e&&13!==e.charCodeAt(0)||!e)&&console&&console.warn&&!this._warned&&(this._warned=!0,console.warn("Missing character from exported characters list: ",e,r,i)),t},getFontByName:function(t){for(var e=0,r=this.fonts.length;e<r;){if(this.fonts[e].fName===t)return this.fonts[e];e+=1}return this.fonts[0]},measureText:function(t,e,r){var i=this.getFontByName(e),n=t.charCodeAt(0);if(!i.cache[n+1]){var o=i.helper;if(" "===t){o.textContent="|"+t+"|";var s=o.getComputedTextLength();o.textContent="||";var a=o.getComputedTextLength();i.cache[n+1]=(s-a)/100}else o.textContent=t,i.cache[n+1]=o.getComputedTextLength()/100}return i.cache[n+1]*r},checkLoadedFonts:function(){var t,e,r,i=this.fonts.length,n=i;for(t=0;t<i;t+=1)this.fonts[t].loaded?n-=1:"n"===this.fonts[t].fOrigin||0===this.fonts[t].origin?this.fonts[t].loaded=!0:(e=this.fonts[t].monoCase.node,r=this.fonts[t].monoCase.w,e.offsetWidth!==r?(n-=1,this.fonts[t].loaded=!0):(e=this.fonts[t].sansCase.node,r=this.fonts[t].sansCase.w,e.offsetWidth!==r&&(n-=1,this.fonts[t].loaded=!0)),this.fonts[t].loaded&&(this.fonts[t].sansCase.parent.parentNode.removeChild(this.fonts[t].sansCase.parent),this.fonts[t].monoCase.parent.parentNode.removeChild(this.fonts[t].monoCase.parent)));0!==n&&Date.now()-this.initTime<5e3?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)},setIsLoaded:function(){this.isLoaded=!0}};return s.prototype=a,s}(),PropertyFactory=function(){var t=initialDefaultFrame,e=Math.abs;function r(t,e){var r,n=this.offsetTime;"multidimensional"===this.propType&&(r=createTypedArray("float32",this.pv.length));for(var o,s,a,l,c,u,h,d,p,f=e.lastIndex,m=f,g=this.keyframes.length-1,y=!0;y;){if(o=this.keyframes[m],s=this.keyframes[m+1],m===g-1&&t>=s.t-n){o.h&&(o=s),f=0;break}if(s.t-n>t){f=m;break}m<g-1?m+=1:(f=0,y=!1)}a=this.keyframesMetadata[m]||{};var v,_,b,x,w,T,E,S,P,k,A=s.t-n,M=o.t-n;if(o.to){a.bezierData||(a.bezierData=bez.buildBezierData(o.s,s.s||o.e,o.to,o.ti));var C=a.bezierData;if(t>=A||t<M){var I=t>=A?C.points.length-1:0;for(c=C.points[I].point.length,l=0;l<c;l+=1)r[l]=C.points[I].point[l]}else{a.__fnct?p=a.__fnct:(p=BezierFactory.getBezierEasing(o.o.x,o.o.y,o.i.x,o.i.y,o.n).get,a.__fnct=p),u=p((t-M)/(A-M));var O,L=C.segmentLength*u,D=e.lastFrame<t&&e._lastKeyframeIndex===m?e._lastAddedLength:0;for(d=e.lastFrame<t&&e._lastKeyframeIndex===m?e._lastPoint:0,y=!0,h=C.points.length;y;){if(D+=C.points[d].partialLength,0===L||0===u||d===C.points.length-1){for(c=C.points[d].point.length,l=0;l<c;l+=1)r[l]=C.points[d].point[l];break}if(L>=D&&L<D+C.points[d+1].partialLength){for(O=(L-D)/C.points[d+1].partialLength,c=C.points[d].point.length,l=0;l<c;l+=1)r[l]=C.points[d].point[l]+(C.points[d+1].point[l]-C.points[d].point[l])*O;break}d<h-1?d+=1:y=!1}e._lastPoint=d,e._lastAddedLength=D-C.points[d].partialLength,e._lastKeyframeIndex=m}}else{var R,F,B,z,j;if(g=o.s.length,v=s.s||o.e,this.sh&&1!==o.h)if(t>=A)r[0]=v[0],r[1]=v[1],r[2]=v[2];else if(t<=M)r[0]=o.s[0],r[1]=o.s[1],r[2]=o.s[2];else{_=r,b=function(t,e,r){var i,n,o,s,a,l=[],c=t[0],u=t[1],h=t[2],d=t[3],p=e[0],f=e[1],m=e[2],g=e[3];return(n=c*p+u*f+h*m+d*g)<0&&(n=-n,p=-p,f=-f,m=-m,g=-g),1-n>1e-6?(i=Math.acos(n),o=Math.sin(i),s=Math.sin((1-r)*i)/o,a=Math.sin(r*i)/o):(s=1-r,a=r),l[0]=s*c+a*p,l[1]=s*u+a*f,l[2]=s*h+a*m,l[3]=s*d+a*g,l}(i(o.s),i(v),(t-M)/(A-M)),x=b[0],w=b[1],T=b[2],E=b[3],S=Math.atan2(2*w*E-2*x*T,1-2*w*w-2*T*T),P=Math.asin(2*x*w+2*T*E),k=Math.atan2(2*x*E-2*w*T,1-2*x*x-2*T*T),_[0]=S/degToRads,_[1]=P/degToRads,_[2]=k/degToRads}else for(m=0;m<g;m+=1)1!==o.h&&(t>=A?u=1:t<M?u=0:(o.o.x.constructor===Array?(a.__fnct||(a.__fnct=[]),a.__fnct[m]?p=a.__fnct[m]:(R=void 0===o.o.x[m]?o.o.x[0]:o.o.x[m],F=void 0===o.o.y[m]?o.o.y[0]:o.o.y[m],B=void 0===o.i.x[m]?o.i.x[0]:o.i.x[m],z=void 0===o.i.y[m]?o.i.y[0]:o.i.y[m],p=BezierFactory.getBezierEasing(R,F,B,z).get,a.__fnct[m]=p)):a.__fnct?p=a.__fnct:(R=o.o.x,F=o.o.y,B=o.i.x,z=o.i.y,p=BezierFactory.getBezierEasing(R,F,B,z).get,o.keyframeMetadata=p),u=p((t-M)/(A-M)))),v=s.s||o.e,j=1===o.h?o.s[m]:o.s[m]+(v[m]-o.s[m])*u,"multidimensional"===this.propType?r[m]=j:r=j}return e.lastIndex=f,r}function i(t){var e=t[0]*degToRads,r=t[1]*degToRads,i=t[2]*degToRads,n=Math.cos(e/2),o=Math.cos(r/2),s=Math.cos(i/2),a=Math.sin(e/2),l=Math.sin(r/2),c=Math.sin(i/2);return[a*l*s+n*o*c,a*o*s+n*l*c,n*l*s-a*o*c,n*o*s-a*l*c]}function n(){var e=this.comp.renderedFrame-this.offsetTime,r=this.keyframes[0].t-this.offsetTime,i=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(e===this._caching.lastFrame||this._caching.lastFrame!==t&&(this._caching.lastFrame>=i&&e>=i||this._caching.lastFrame<r&&e<r))){this._caching.lastFrame>=e&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var n=this.interpolateValue(e,this._caching);this.pv=n}return this._caching.lastFrame=e,this.pv}function o(t){var r;if("unidimensional"===this.propType)r=t*this.mult,e(this.v-r)>1e-5&&(this.v=r,this._mdf=!0);else for(var i=0,n=this.v.length;i<n;)r=t[i]*this.mult,e(this.v[i]-r)>1e-5&&(this.v[i]=r,this._mdf=!0),i+=1}function s(){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{var t;this.lock=!0,this._mdf=this._isFirstFrame;var e=this.effectsSequence.length,r=this.kf?this.pv:this.data.k;for(t=0;t<e;t+=1)r=this.effectsSequence[t](r);this.setVValue(r),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function a(t){this.effectsSequence.push(t),this.container.addDynamicProperty(this)}function l(t,e,r,i){this.propType="unidimensional",this.mult=r||1,this.data=e,this.v=r?e.k*r:e.k,this.pv=e.k,this._mdf=!1,this.elem=t,this.container=i,this.comp=t.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=s,this.setVValue=o,this.addEffect=a}function c(t,e,r,i){var n;this.propType="multidimensional",this.mult=r||1,this.data=e,this._mdf=!1,this.elem=t,this.container=i,this.comp=t.comp,this.k=!1,this.kf=!1,this.frameId=-1;var l=e.k.length;for(this.v=createTypedArray("float32",l),this.pv=createTypedArray("float32",l),this.vel=createTypedArray("float32",l),n=0;n<l;n+=1)this.v[n]=e.k[n]*this.mult,this.pv[n]=e.k[n];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=s,this.setVValue=o,this.addEffect=a}function u(e,i,l,c){this.propType="unidimensional",this.keyframes=i.k,this.keyframesMetadata=[],this.offsetTime=e.data.st,this.frameId=-1,this._caching={lastFrame:t,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=i,this.mult=l||1,this.elem=e,this.container=c,this.comp=e.comp,this.v=t,this.pv=t,this._isFirstFrame=!0,this.getValue=s,this.setVValue=o,this.interpolateValue=r,this.effectsSequence=[n.bind(this)],this.addEffect=a}function h(e,i,l,c){var u;this.propType="multidimensional";var h,d,p,f,m=i.k.length;for(u=0;u<m-1;u+=1)i.k[u].to&&i.k[u].s&&i.k[u+1]&&i.k[u+1].s&&(h=i.k[u].s,d=i.k[u+1].s,p=i.k[u].to,f=i.k[u].ti,(2===h.length&&(h[0]!==d[0]||h[1]!==d[1])&&bez.pointOnLine2D(h[0],h[1],d[0],d[1],h[0]+p[0],h[1]+p[1])&&bez.pointOnLine2D(h[0],h[1],d[0],d[1],d[0]+f[0],d[1]+f[1])||3===h.length&&(h[0]!==d[0]||h[1]!==d[1]||h[2]!==d[2])&&bez.pointOnLine3D(h[0],h[1],h[2],d[0],d[1],d[2],h[0]+p[0],h[1]+p[1],h[2]+p[2])&&bez.pointOnLine3D(h[0],h[1],h[2],d[0],d[1],d[2],d[0]+f[0],d[1]+f[1],d[2]+f[2]))&&(i.k[u].to=null,i.k[u].ti=null),h[0]===d[0]&&h[1]===d[1]&&0===p[0]&&0===p[1]&&0===f[0]&&0===f[1]&&(2===h.length||h[2]===d[2]&&0===p[2]&&0===f[2])&&(i.k[u].to=null,i.k[u].ti=null));this.effectsSequence=[n.bind(this)],this.data=i,this.keyframes=i.k,this.keyframesMetadata=[],this.offsetTime=e.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=l||1,this.elem=e,this.container=c,this.comp=e.comp,this.getValue=s,this.setVValue=o,this.interpolateValue=r,this.frameId=-1;var g=i.k[0].s.length;for(this.v=createTypedArray("float32",g),this.pv=createTypedArray("float32",g),u=0;u<g;u+=1)this.v[u]=t,this.pv[u]=t;this._caching={lastFrame:t,lastIndex:0,value:createTypedArray("float32",g)},this.addEffect=a}var d={getProp:function(t,e,r,i,n){var o;if(e.k.length)if("number"==typeof e.k[0])o=new c(t,e,i,n);else switch(r){case 0:o=new u(t,e,i,n);break;case 1:o=new h(t,e,i,n)}else o=new l(t,e,i,n);return o.effectsSequence.length&&n.addDynamicProperty(o),o}};return d}(),TransformPropertyFactory=function(){var t=[0,0];function e(t,e,r){if(this.elem=t,this.frameId=-1,this.propType="transform",this.data=e,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(r||t),e.p&&e.p.s?(this.px=PropertyFactory.getProp(t,e.p.x,0,0,this),this.py=PropertyFactory.getProp(t,e.p.y,0,0,this),e.p.z&&(this.pz=PropertyFactory.getProp(t,e.p.z,0,0,this))):this.p=PropertyFactory.getProp(t,e.p||{k:[0,0,0]},1,0,this),e.rx){if(this.rx=PropertyFactory.getProp(t,e.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(t,e.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(t,e.rz,0,degToRads,this),e.or.k[0].ti){var i,n=e.or.k.length;for(i=0;i<n;i+=1)e.or.k[i].to=null,e.or.k[i].ti=null}this.or=PropertyFactory.getProp(t,e.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(t,e.r||{k:0},0,degToRads,this);e.sk&&(this.sk=PropertyFactory.getProp(t,e.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(t,e.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(t,e.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(t,e.s||{k:[100,100,100]},1,.01,this),e.o?this.o=PropertyFactory.getProp(t,e.o,0,.01,t):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}return e.prototype={applyToMatrix:function(t){var e=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||e,this.a&&t.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&t.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&t.skewFromAxis(-this.sk.v,this.sa.v),this.r?t.rotate(-this.r.v):t.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?t.translate(this.px.v,this.py.v,-this.pz.v):t.translate(this.px.v,this.py.v,0):t.translate(this.p.v[0],this.p.v[1],-this.p.v[2])},getValue:function(e){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||e){var r;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var i,n;if(r=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(i=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/r,0),n=this.p.getValueAtTime(this.p.keyframes[0].t/r,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(i=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/r,0),n=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/r,0)):(i=this.p.pv,n=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/r,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){i=[],n=[];var o=this.px,s=this.py;o._caching.lastFrame+o.offsetTime<=o.keyframes[0].t?(i[0]=o.getValueAtTime((o.keyframes[0].t+.01)/r,0),i[1]=s.getValueAtTime((s.keyframes[0].t+.01)/r,0),n[0]=o.getValueAtTime(o.keyframes[0].t/r,0),n[1]=s.getValueAtTime(s.keyframes[0].t/r,0)):o._caching.lastFrame+o.offsetTime>=o.keyframes[o.keyframes.length-1].t?(i[0]=o.getValueAtTime(o.keyframes[o.keyframes.length-1].t/r,0),i[1]=s.getValueAtTime(s.keyframes[s.keyframes.length-1].t/r,0),n[0]=o.getValueAtTime((o.keyframes[o.keyframes.length-1].t-.01)/r,0),n[1]=s.getValueAtTime((s.keyframes[s.keyframes.length-1].t-.01)/r,0)):(i=[o.pv,s.pv],n[0]=o.getValueAtTime((o._caching.lastFrame+o.offsetTime-.01)/r,o.offsetTime),n[1]=s.getValueAtTime((s._caching.lastFrame+s.offsetTime-.01)/r,s.offsetTime))}else i=n=t;this.v.rotate(-Math.atan2(i[1]-n[1],i[0]-n[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}},precalculateMatrix:function(){if(!this.a.k&&(this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1,!this.s.effectsSequence.length)){if(this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2,this.sk){if(this.sk.effectsSequence.length||this.sa.effectsSequence.length)return;this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3}this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):this.rz.effectsSequence.length||this.ry.effectsSequence.length||this.rx.effectsSequence.length||this.or.effectsSequence.length||(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}},autoOrient:function(){}},extendPrototype([DynamicPropertyContainer],e),e.prototype.addDynamicProperty=function(t){this._addDynamicProperty(t),this.elem.addDynamicProperty(t),this._isDirty=!0},e.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty,{getTransformProperty:function(t,r,i){return new e(t,r,i)}}}();function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(t,e){this.c=t,this.setLength(e);for(var r=0;r<e;)this.v[r]=pointPool.newElement(),this.o[r]=pointPool.newElement(),this.i[r]=pointPool.newElement(),r+=1},ShapePath.prototype.setLength=function(t){for(;this._maxLength<t;)this.doubleArrayLength();this._length=t},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(t,e,r,i,n){var o;switch(this._length=Math.max(this._length,i+1),this._length>=this._maxLength&&this.doubleArrayLength(),r){case"v":o=this.v;break;case"i":o=this.i;break;case"o":o=this.o;break;default:o=[]}(!o[i]||o[i]&&!n)&&(o[i]=pointPool.newElement()),o[i][0]=t,o[i][1]=e},ShapePath.prototype.setTripleAt=function(t,e,r,i,n,o,s,a){this.setXYAt(t,e,"v",s,a),this.setXYAt(r,i,"o",s,a),this.setXYAt(n,o,"i",s,a)},ShapePath.prototype.reverse=function(){var t=new ShapePath;t.setPathData(this.c,this._length);var e=this.v,r=this.o,i=this.i,n=0;this.c&&(t.setTripleAt(e[0][0],e[0][1],i[0][0],i[0][1],r[0][0],r[0][1],0,!1),n=1);var o,s=this._length-1,a=this._length;for(o=n;o<a;o+=1)t.setTripleAt(e[s][0],e[s][1],i[s][0],i[s][1],r[s][0],r[s][1],o,!1),s-=1;return t};var ShapePropertyFactory=function(){var t=-999999;function e(t,e,r){var i,n,o,s,a,l,c,u,h,d=r.lastIndex,p=this.keyframes;if(t<p[0].t-this.offsetTime)i=p[0].s[0],o=!0,d=0;else if(t>=p[p.length-1].t-this.offsetTime)i=p[p.length-1].s?p[p.length-1].s[0]:p[p.length-2].e[0],o=!0;else{for(var f,m,g,y=d,v=p.length-1,_=!0;_&&(f=p[y],!((m=p[y+1]).t-this.offsetTime>t));)y<v-1?y+=1:_=!1;if(g=this.keyframesMetadata[y]||{},d=y,!(o=1===f.h)){if(t>=m.t-this.offsetTime)u=1;else if(t<f.t-this.offsetTime)u=0;else{var b;g.__fnct?b=g.__fnct:(b=BezierFactory.getBezierEasing(f.o.x,f.o.y,f.i.x,f.i.y).get,g.__fnct=b),u=b((t-(f.t-this.offsetTime))/(m.t-this.offsetTime-(f.t-this.offsetTime)))}n=m.s?m.s[0]:f.e[0]}i=f.s[0]}for(l=e._length,c=i.i[0].length,r.lastIndex=d,s=0;s<l;s+=1)for(a=0;a<c;a+=1)h=o?i.i[s][a]:i.i[s][a]+(n.i[s][a]-i.i[s][a])*u,e.i[s][a]=h,h=o?i.o[s][a]:i.o[s][a]+(n.o[s][a]-i.o[s][a])*u,e.o[s][a]=h,h=o?i.v[s][a]:i.v[s][a]+(n.v[s][a]-i.v[s][a])*u,e.v[s][a]=h}function r(){var e=this.comp.renderedFrame-this.offsetTime,r=this.keyframes[0].t-this.offsetTime,i=this.keyframes[this.keyframes.length-1].t-this.offsetTime,n=this._caching.lastFrame;return n!==t&&(n<r&&e<r||n>i&&e>i)||(this._caching.lastIndex=n<e?this._caching.lastIndex:0,this.interpolateShape(e,this.pv,this._caching)),this._caching.lastFrame=e,this.pv}function i(){this.paths=this.localShapeCollection}function n(t){(function(t,e){if(t._length!==e._length||t.c!==e.c)return!1;var r,i=t._length;for(r=0;r<i;r+=1)if(t.v[r][0]!==e.v[r][0]||t.v[r][1]!==e.v[r][1]||t.o[r][0]!==e.o[r][0]||t.o[r][1]!==e.o[r][1]||t.i[r][0]!==e.i[r][0]||t.i[r][1]!==e.i[r][1])return!1;return!0})(this.v,t)||(this.v=shapePool.clone(t),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function o(){if(this.elem.globalData.frameId!==this.frameId)if(this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{var t,e;this.lock=!0,this._mdf=!1,t=this.kf?this.pv:this.data.ks?this.data.ks.k:this.data.pt.k;var r=this.effectsSequence.length;for(e=0;e<r;e+=1)t=this.effectsSequence[e](t);this.setVValue(t),this.lock=!1,this.frameId=this.elem.globalData.frameId}else this._mdf=!1}function s(t,e,r){this.propType="shape",this.comp=t.comp,this.container=t,this.elem=t,this.data=e,this.k=!1,this.kf=!1,this._mdf=!1;var n=3===r?e.pt.k:e.ks.k;this.v=shapePool.clone(n),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=i,this.effectsSequence=[]}function a(t){this.effectsSequence.push(t),this.container.addDynamicProperty(this)}function l(e,n,o){this.propType="shape",this.comp=e.comp,this.elem=e,this.container=e,this.offsetTime=e.data.st,this.keyframes=3===o?n.pt.k:n.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var s=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,s),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=t,this.reset=i,this._caching={lastFrame:t,lastIndex:0},this.effectsSequence=[r.bind(this)]}s.prototype.interpolateShape=e,s.prototype.getValue=o,s.prototype.setVValue=n,s.prototype.addEffect=a,l.prototype.getValue=o,l.prototype.interpolateShape=e,l.prototype.setVValue=n,l.prototype.addEffect=a;var c=function(){var t=roundCorner;function e(t,e){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=e.d,this.elem=t,this.comp=t.comp,this.frameId=-1,this.initDynamicPropertyContainer(t),this.p=PropertyFactory.getProp(t,e.p,1,0,this),this.s=PropertyFactory.getProp(t,e.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return e.prototype={reset:i,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var e=this.p.v[0],r=this.p.v[1],i=this.s.v[0]/2,n=this.s.v[1]/2,o=3!==this.d,s=this.v;s.v[0][0]=e,s.v[0][1]=r-n,s.v[1][0]=o?e+i:e-i,s.v[1][1]=r,s.v[2][0]=e,s.v[2][1]=r+n,s.v[3][0]=o?e-i:e+i,s.v[3][1]=r,s.i[0][0]=o?e-i*t:e+i*t,s.i[0][1]=r-n,s.i[1][0]=o?e+i:e-i,s.i[1][1]=r-n*t,s.i[2][0]=o?e+i*t:e-i*t,s.i[2][1]=r+n,s.i[3][0]=o?e-i:e+i,s.i[3][1]=r+n*t,s.o[0][0]=o?e+i*t:e-i*t,s.o[0][1]=r-n,s.o[1][0]=o?e+i:e-i,s.o[1][1]=r+n*t,s.o[2][0]=o?e-i*t:e+i*t,s.o[2][1]=r+n,s.o[3][0]=o?e-i:e+i,s.o[3][1]=r-n*t}},extendPrototype([DynamicPropertyContainer],e),e}(),u=function(){function t(t,e){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=t,this.comp=t.comp,this.data=e,this.frameId=-1,this.d=e.d,this.initDynamicPropertyContainer(t),1===e.sy?(this.ir=PropertyFactory.getProp(t,e.ir,0,0,this),this.is=PropertyFactory.getProp(t,e.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(t,e.pt,0,0,this),this.p=PropertyFactory.getProp(t,e.p,1,0,this),this.r=PropertyFactory.getProp(t,e.r,0,degToRads,this),this.or=PropertyFactory.getProp(t,e.or,0,0,this),this.os=PropertyFactory.getProp(t,e.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return t.prototype={reset:i,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var t,e,r,i,n=2*Math.floor(this.pt.v),o=2*Math.PI/n,s=!0,a=this.or.v,l=this.ir.v,c=this.os.v,u=this.is.v,h=2*Math.PI*a/(2*n),d=2*Math.PI*l/(2*n),p=-Math.PI/2;p+=this.r.v;var f=3===this.data.d?-1:1;for(this.v._length=0,t=0;t<n;t+=1){r=s?c:u,i=s?h:d;var m=(e=s?a:l)*Math.cos(p),g=e*Math.sin(p),y=0===m&&0===g?0:g/Math.sqrt(m*m+g*g),v=0===m&&0===g?0:-m/Math.sqrt(m*m+g*g);m+=+this.p.v[0],g+=+this.p.v[1],this.v.setTripleAt(m,g,m-y*i*r*f,g-v*i*r*f,m+y*i*r*f,g+v*i*r*f,t,!0),s=!s,p+=o*f}},convertPolygonToPath:function(){var t,e=Math.floor(this.pt.v),r=2*Math.PI/e,i=this.or.v,n=this.os.v,o=2*Math.PI*i/(4*e),s=.5*-Math.PI,a=3===this.data.d?-1:1;for(s+=this.r.v,this.v._length=0,t=0;t<e;t+=1){var l=i*Math.cos(s),c=i*Math.sin(s),u=0===l&&0===c?0:c/Math.sqrt(l*l+c*c),h=0===l&&0===c?0:-l/Math.sqrt(l*l+c*c);l+=+this.p.v[0],c+=+this.p.v[1],this.v.setTripleAt(l,c,l-u*o*n*a,c-h*o*n*a,l+u*o*n*a,c+h*o*n*a,t,!0),s+=r*a}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],t),t}(),h=function(){function t(t,e){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=t,this.comp=t.comp,this.frameId=-1,this.d=e.d,this.initDynamicPropertyContainer(t),this.p=PropertyFactory.getProp(t,e.p,1,0,this),this.s=PropertyFactory.getProp(t,e.s,1,0,this),this.r=PropertyFactory.getProp(t,e.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return t.prototype={convertRectToPath:function(){var t=this.p.v[0],e=this.p.v[1],r=this.s.v[0]/2,i=this.s.v[1]/2,n=bmMin(r,i,this.r.v),o=n*(1-roundCorner);this.v._length=0,2===this.d||1===this.d?(this.v.setTripleAt(t+r,e-i+n,t+r,e-i+n,t+r,e-i+o,0,!0),this.v.setTripleAt(t+r,e+i-n,t+r,e+i-o,t+r,e+i-n,1,!0),0!==n?(this.v.setTripleAt(t+r-n,e+i,t+r-n,e+i,t+r-o,e+i,2,!0),this.v.setTripleAt(t-r+n,e+i,t-r+o,e+i,t-r+n,e+i,3,!0),this.v.setTripleAt(t-r,e+i-n,t-r,e+i-n,t-r,e+i-o,4,!0),this.v.setTripleAt(t-r,e-i+n,t-r,e-i+o,t-r,e-i+n,5,!0),this.v.setTripleAt(t-r+n,e-i,t-r+n,e-i,t-r+o,e-i,6,!0),this.v.setTripleAt(t+r-n,e-i,t+r-o,e-i,t+r-n,e-i,7,!0)):(this.v.setTripleAt(t-r,e+i,t-r+o,e+i,t-r,e+i,2),this.v.setTripleAt(t-r,e-i,t-r,e-i+o,t-r,e-i,3))):(this.v.setTripleAt(t+r,e-i+n,t+r,e-i+o,t+r,e-i+n,0,!0),0!==n?(this.v.setTripleAt(t+r-n,e-i,t+r-n,e-i,t+r-o,e-i,1,!0),this.v.setTripleAt(t-r+n,e-i,t-r+o,e-i,t-r+n,e-i,2,!0),this.v.setTripleAt(t-r,e-i+n,t-r,e-i+n,t-r,e-i+o,3,!0),this.v.setTripleAt(t-r,e+i-n,t-r,e+i-o,t-r,e+i-n,4,!0),this.v.setTripleAt(t-r+n,e+i,t-r+n,e+i,t-r+o,e+i,5,!0),this.v.setTripleAt(t+r-n,e+i,t+r-o,e+i,t+r-n,e+i,6,!0),this.v.setTripleAt(t+r,e+i-n,t+r,e+i-n,t+r,e+i-o,7,!0)):(this.v.setTripleAt(t-r,e-i,t-r+o,e-i,t-r,e-i,1,!0),this.v.setTripleAt(t-r,e+i,t-r,e+i-o,t-r,e+i,2,!0),this.v.setTripleAt(t+r,e+i,t+r-o,e+i,t+r,e+i,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:i},extendPrototype([DynamicPropertyContainer],t),t}(),d={getShapeProp:function(t,e,r){var i;return 3===r||4===r?i=(3===r?e.pt:e.ks).k.length?new l(t,e,r):new s(t,e,r):5===r?i=new h(t,e):6===r?i=new c(t,e):7===r&&(i=new u(t,e)),i.k&&t.addDynamicProperty(i),i},getConstructorFunction:function(){return s},getKeyframedConstructorFunction:function(){return l}};return d}(),ShapeModifiers=(ob={},modifiers={},ob.registerModifier=function(t,e){modifiers[t]||(modifiers[t]=e)},ob.getModifier=function(t,e,r){return new modifiers[t](e,r)},ob),ob,modifiers;function ShapeModifier(){}function TrimModifier(){}function RoundCornersModifier(){}function PuckerAndBloatModifier(){}function RepeaterModifier(){}function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}function DashProperty(t,e,r,i){var n;this.elem=t,this.frameId=-1,this.dataProps=createSizedArray(e.length),this.renderer=r,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",e.length?e.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(i);var o,s=e.length||0;for(n=0;n<s;n+=1)o=PropertyFactory.getProp(t,e[n].v,0,0,this),this.k=o.k||this.k,this.dataProps[n]={n:e[n].n,p:o};this.k||this.getValue(!0),this._isAnimated=this.k}function GradientProperty(t,e,r){this.data=e,this.c=createTypedArray("uint8c",4*e.p);var i=e.k.k[0].s?e.k.k[0].s.length-4*e.p:e.k.k.length-4*e.p;this.o=createTypedArray("float32",i),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=i,this.initDynamicPropertyContainer(r),this.prop=PropertyFactory.getProp(t,e.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(t){if(!this.closed){t.sh.container.addDynamicProperty(t.sh);var e={shape:t.sh,data:t,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(e),this.addShapeToModifier(e),this._isAnimated&&t.setAsAnimated()}},ShapeModifier.prototype.init=function(t,e){this.shapes=[],this.elem=t,this.initDynamicPropertyContainer(t),this.initModifierProperties(t,e),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier),extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(t,e){this.s=PropertyFactory.getProp(t,e.s,0,.01,this),this.e=PropertyFactory.getProp(t,e.e,0,.01,this),this.o=PropertyFactory.getProp(t,e.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=e.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(t){t.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(t,e,r,i,n){var o=[];e<=1?o.push({s:t,e}):t>=1?o.push({s:t-1,e:e-1}):(o.push({s:t,e:1}),o.push({s:0,e:e-1}));var s,a,l=[],c=o.length;for(s=0;s<c;s+=1){var u,h;(a=o[s]).e*n<i||a.s*n>i+r||(u=a.s*n<=i?0:(a.s*n-i)/r,h=a.e*n>=i+r?1:(a.e*n-i)/r,l.push([u,h]))}return l.length||l.push([0,0]),l},TrimModifier.prototype.releasePathsData=function(t){var e,r=t.length;for(e=0;e<r;e+=1)segmentsLengthPool.release(t[e]);return t.length=0,t},TrimModifier.prototype.processShapes=function(t){var e,r,i,n;if(this._mdf||t){var o=this.o.v%360/360;if(o<0&&(o+=1),(e=this.s.v>1?1+o:this.s.v<0?0+o:this.s.v+o)>(r=this.e.v>1?1+o:this.e.v<0?0+o:this.e.v+o)){var s=e;e=r,r=s}e=1e-4*Math.round(1e4*e),r=1e-4*Math.round(1e4*r),this.sValue=e,this.eValue=r}else e=this.sValue,r=this.eValue;var a,l,c,u,h,d=this.shapes.length,p=0;if(r===e)for(n=0;n<d;n+=1)this.shapes[n].localShapeCollection.releaseShapes(),this.shapes[n].shape._mdf=!0,this.shapes[n].shape.paths=this.shapes[n].localShapeCollection,this._mdf&&(this.shapes[n].pathsData.length=0);else if(1===r&&0===e||0===r&&1===e){if(this._mdf)for(n=0;n<d;n+=1)this.shapes[n].pathsData.length=0,this.shapes[n].shape._mdf=!0}else{var f,m,g=[];for(n=0;n<d;n+=1)if((f=this.shapes[n]).shape._mdf||this._mdf||t||2===this.m){if(l=(i=f.shape.paths)._length,h=0,!f.shape._mdf&&f.pathsData.length)h=f.totalShapeLength;else{for(c=this.releasePathsData(f.pathsData),a=0;a<l;a+=1)u=bez.getSegmentsLength(i.shapes[a]),c.push(u),h+=u.totalLength;f.totalShapeLength=h,f.pathsData=c}p+=h,f.shape._mdf=!0}else f.shape.paths=f.localShapeCollection;var y,v=e,_=r,b=0;for(n=d-1;n>=0;n-=1)if((f=this.shapes[n]).shape._mdf){for((m=f.localShapeCollection).releaseShapes(),2===this.m&&d>1?(y=this.calculateShapeEdges(e,r,f.totalShapeLength,b,p),b+=f.totalShapeLength):y=[[v,_]],l=y.length,a=0;a<l;a+=1){v=y[a][0],_=y[a][1],g.length=0,_<=1?g.push({s:f.totalShapeLength*v,e:f.totalShapeLength*_}):v>=1?g.push({s:f.totalShapeLength*(v-1),e:f.totalShapeLength*(_-1)}):(g.push({s:f.totalShapeLength*v,e:f.totalShapeLength}),g.push({s:0,e:f.totalShapeLength*(_-1)}));var x=this.addShapes(f,g[0]);if(g[0].s!==g[0].e){if(g.length>1)if(f.shape.paths.shapes[f.shape.paths._length-1].c){var w=x.pop();this.addPaths(x,m),x=this.addShapes(f,g[1],w)}else this.addPaths(x,m),x=this.addShapes(f,g[1]);this.addPaths(x,m)}}f.shape.paths=m}}},TrimModifier.prototype.addPaths=function(t,e){var r,i=t.length;for(r=0;r<i;r+=1)e.addShape(t[r])},TrimModifier.prototype.addSegment=function(t,e,r,i,n,o,s){n.setXYAt(e[0],e[1],"o",o),n.setXYAt(r[0],r[1],"i",o+1),s&&n.setXYAt(t[0],t[1],"v",o),n.setXYAt(i[0],i[1],"v",o+1)},TrimModifier.prototype.addSegmentFromArray=function(t,e,r,i){e.setXYAt(t[1],t[5],"o",r),e.setXYAt(t[2],t[6],"i",r+1),i&&e.setXYAt(t[0],t[4],"v",r),e.setXYAt(t[3],t[7],"v",r+1)},TrimModifier.prototype.addShapes=function(t,e,r){var i,n,o,s,a,l,c,u,h=t.pathsData,d=t.shape.paths.shapes,p=t.shape.paths._length,f=0,m=[],g=!0;for(r?(a=r._length,u=r._length):(r=shapePool.newElement(),a=0,u=0),m.push(r),i=0;i<p;i+=1){for(l=h[i].lengths,r.c=d[i].c,o=d[i].c?l.length:l.length+1,n=1;n<o;n+=1)if(f+(s=l[n-1]).addedLength<e.s)f+=s.addedLength,r.c=!1;else{if(f>e.e){r.c=!1;break}e.s<=f&&e.e>=f+s.addedLength?(this.addSegment(d[i].v[n-1],d[i].o[n-1],d[i].i[n],d[i].v[n],r,a,g),g=!1):(c=bez.getNewSegment(d[i].v[n-1],d[i].v[n],d[i].o[n-1],d[i].i[n],(e.s-f)/s.addedLength,(e.e-f)/s.addedLength,l[n-1]),this.addSegmentFromArray(c,r,a,g),g=!1,r.c=!1),f+=s.addedLength,a+=1}if(d[i].c&&l.length){if(s=l[n-1],f<=e.e){var y=l[n-1].addedLength;e.s<=f&&e.e>=f+y?(this.addSegment(d[i].v[n-1],d[i].o[n-1],d[i].i[0],d[i].v[0],r,a,g),g=!1):(c=bez.getNewSegment(d[i].v[n-1],d[i].v[0],d[i].o[n-1],d[i].i[0],(e.s-f)/y,(e.e-f)/y,l[n-1]),this.addSegmentFromArray(c,r,a,g),g=!1,r.c=!1)}else r.c=!1;f+=s.addedLength,a+=1}if(r._length&&(r.setXYAt(r.v[u][0],r.v[u][1],"i",u),r.setXYAt(r.v[r._length-1][0],r.v[r._length-1][1],"o",r._length-1)),f>e.e)break;i<p-1&&(r=shapePool.newElement(),g=!0,m.push(r),a=0)}return m},ShapeModifiers.registerModifier("tm",TrimModifier),extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(t,e.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(t,e){var r,i=shapePool.newElement();i.c=t.c;var n,o,s,a,l,c,u,h,d,p,f,m,g=t._length,y=0;for(r=0;r<g;r+=1)n=t.v[r],s=t.o[r],o=t.i[r],n[0]===s[0]&&n[1]===s[1]&&n[0]===o[0]&&n[1]===o[1]?0!==r&&r!==g-1||t.c?(a=0===r?t.v[g-1]:t.v[r-1],c=(l=Math.sqrt(Math.pow(n[0]-a[0],2)+Math.pow(n[1]-a[1],2)))?Math.min(l/2,e)/l:0,u=f=n[0]+(a[0]-n[0])*c,h=m=n[1]-(n[1]-a[1])*c,d=u-(u-n[0])*roundCorner,p=h-(h-n[1])*roundCorner,i.setTripleAt(u,h,d,p,f,m,y),y+=1,a=r===g-1?t.v[0]:t.v[r+1],c=(l=Math.sqrt(Math.pow(n[0]-a[0],2)+Math.pow(n[1]-a[1],2)))?Math.min(l/2,e)/l:0,u=d=n[0]+(a[0]-n[0])*c,h=p=n[1]+(a[1]-n[1])*c,f=u-(u-n[0])*roundCorner,m=h-(h-n[1])*roundCorner,i.setTripleAt(u,h,d,p,f,m,y),y+=1):(i.setTripleAt(n[0],n[1],s[0],s[1],o[0],o[1],y),y+=1):(i.setTripleAt(t.v[r][0],t.v[r][1],t.o[r][0],t.o[r][1],t.i[r][0],t.i[r][1],y),y+=1);return i},RoundCornersModifier.prototype.processShapes=function(t){var e,r,i,n,o,s,a=this.shapes.length,l=this.rd.v;if(0!==l)for(r=0;r<a;r+=1){if(s=(o=this.shapes[r]).localShapeCollection,o.shape._mdf||this._mdf||t)for(s.releaseShapes(),o.shape._mdf=!0,e=o.shape.paths.shapes,n=o.shape.paths._length,i=0;i<n;i+=1)s.addShape(this.processPath(e[i],l));o.shape.paths=o.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},ShapeModifiers.registerModifier("rd",RoundCornersModifier),extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(t,e.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(t,e){var r=e/100,i=[0,0],n=t._length,o=0;for(o=0;o<n;o+=1)i[0]+=t.v[o][0],i[1]+=t.v[o][1];i[0]/=n,i[1]/=n;var s,a,l,c,u,h,d=shapePool.newElement();for(d.c=t.c,o=0;o<n;o+=1)s=t.v[o][0]+(i[0]-t.v[o][0])*r,a=t.v[o][1]+(i[1]-t.v[o][1])*r,l=t.o[o][0]+(i[0]-t.o[o][0])*-r,c=t.o[o][1]+(i[1]-t.o[o][1])*-r,u=t.i[o][0]+(i[0]-t.i[o][0])*-r,h=t.i[o][1]+(i[1]-t.i[o][1])*-r,d.setTripleAt(s,a,l,c,u,h,o);return d},PuckerAndBloatModifier.prototype.processShapes=function(t){var e,r,i,n,o,s,a=this.shapes.length,l=this.amount.v;if(0!==l)for(r=0;r<a;r+=1){if(s=(o=this.shapes[r]).localShapeCollection,o.shape._mdf||this._mdf||t)for(s.releaseShapes(),o.shape._mdf=!0,e=o.shape.paths.shapes,n=o.shape.paths._length,i=0;i<n;i+=1)s.addShape(this.processPath(e[i],l));o.shape.paths=o.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(t,e.c,0,null,this),this.o=PropertyFactory.getProp(t,e.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(t,e.tr,this),this.so=PropertyFactory.getProp(t,e.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(t,e.tr.eo,0,.01,this),this.data=e,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(t,e,r,i,n,o){var s=o?-1:1,a=i.s.v[0]+(1-i.s.v[0])*(1-n),l=i.s.v[1]+(1-i.s.v[1])*(1-n);t.translate(i.p.v[0]*s*n,i.p.v[1]*s*n,i.p.v[2]),e.translate(-i.a.v[0],-i.a.v[1],i.a.v[2]),e.rotate(-i.r.v*s*n),e.translate(i.a.v[0],i.a.v[1],i.a.v[2]),r.translate(-i.a.v[0],-i.a.v[1],i.a.v[2]),r.scale(o?1/a:a,o?1/l:l),r.translate(i.a.v[0],i.a.v[1],i.a.v[2])},RepeaterModifier.prototype.init=function(t,e,r,i){for(this.elem=t,this.arr=e,this.pos=r,this.elemsData=i,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(t),this.initModifierProperties(t,e[r]);r>0;)r-=1,this._elements.unshift(e[r]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(t){var e,r=t.length;for(e=0;e<r;e+=1)t[e]._processed=!1,"gr"===t[e].ty&&this.resetElements(t[e].it)},RepeaterModifier.prototype.cloneElements=function(t){var e=JSON.parse(JSON.stringify(t));return this.resetElements(e),e},RepeaterModifier.prototype.changeGroupRender=function(t,e){var r,i=t.length;for(r=0;r<i;r+=1)t[r]._render=e,"gr"===t[r].ty&&this.changeGroupRender(t[r].it,e)},RepeaterModifier.prototype.processShapes=function(t){var e,r,i,n,o,s=!1;if(this._mdf||t){var a,l=Math.ceil(this.c.v);if(this._groups.length<l){for(;this._groups.length<l;){var c={it:this.cloneElements(this._elements),ty:"gr"};c.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,c),this._groups.splice(0,0,c),this._currentCopies+=1}this.elem.reloadShapes(),s=!0}for(o=0,i=0;i<=this._groups.length-1;i+=1){if(a=o<l,this._groups[i]._render=a,this.changeGroupRender(this._groups[i].it,a),!a){var u=this.elemsData[i].it,h=u[u.length-1];0!==h.transform.op.v?(h.transform.op._mdf=!0,h.transform.op.v=0):h.transform.op._mdf=!1}o+=1}this._currentCopies=l;var d=this.o.v,p=d%1,f=d>0?Math.floor(d):Math.ceil(d),m=this.pMatrix.props,g=this.rMatrix.props,y=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var v,_,b=0;if(d>0){for(;b<f;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),b+=1;p&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,p,!1),b+=p)}else if(d<0){for(;b>f;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),b-=1;p&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-p,!0),b-=p)}for(i=1===this.data.m?0:this._currentCopies-1,n=1===this.data.m?1:-1,o=this._currentCopies;o;){if(_=(r=(e=this.elemsData[i].it)[e.length-1].transform.mProps.v.props).length,e[e.length-1].transform.mProps._mdf=!0,e[e.length-1].transform.op._mdf=!0,e[e.length-1].transform.op.v=1===this._currentCopies?this.so.v:this.so.v+(this.eo.v-this.so.v)*(i/(this._currentCopies-1)),0!==b){for((0!==i&&1===n||i!==this._currentCopies-1&&-1===n)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],g[8],g[9],g[10],g[11],g[12],g[13],g[14],g[15]),this.matrix.transform(y[0],y[1],y[2],y[3],y[4],y[5],y[6],y[7],y[8],y[9],y[10],y[11],y[12],y[13],y[14],y[15]),this.matrix.transform(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],m[8],m[9],m[10],m[11],m[12],m[13],m[14],m[15]),v=0;v<_;v+=1)r[v]=this.matrix.props[v];this.matrix.reset()}else for(this.matrix.reset(),v=0;v<_;v+=1)r[v]=this.matrix.props[v];b+=1,o-=1,i+=n}}else for(o=this._currentCopies,i=0,n=1;o;)r=(e=this.elemsData[i].it)[e.length-1].transform.mProps.v.props,e[e.length-1].transform.mProps._mdf=!1,e[e.length-1].transform.op._mdf=!1,o-=1,i+=n;return s},RepeaterModifier.prototype.addShape=function(){},ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeCollection.prototype.addShape=function(t){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=t,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){var t;for(t=0;t<this._length;t+=1)shapePool.release(this.shapes[t]);this._length=0},DashProperty.prototype.getValue=function(t){if((this.elem.globalData.frameId!==this.frameId||t)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||t,this._mdf)){var e=0,r=this.dataProps.length;for("svg"===this.renderer&&(this.dashStr=""),e=0;e<r;e+=1)"o"!==this.dataProps[e].n?"svg"===this.renderer?this.dashStr+=" "+this.dataProps[e].p.v:this.dashArray[e]=this.dataProps[e].p.v:this.dashoffset[0]=this.dataProps[e].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty),GradientProperty.prototype.comparePoints=function(t,e){for(var r=0,i=this.o.length/2;r<i;){if(Math.abs(t[4*r]-t[4*e+2*r])>.01)return!1;r+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!=this.c.length/4)return!1;if(this.data.k.k[0].s)for(var t=0,e=this.data.k.k.length;t<e;){if(!this.comparePoints(this.data.k.k[t].s,this.data.p))return!1;t+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(t){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||t){var e,r,i,n=4*this.data.p;for(e=0;e<n;e+=1)r=e%4==0?100:255,i=Math.round(this.prop.v[e]*r),this.c[e]!==i&&(this.c[e]=i,this._cmdf=!t);if(this.o.length)for(n=this.prop.v.length,e=4*this.data.p;e<n;e+=1)r=e%2==0?100:1,i=e%2==0?Math.round(100*this.prop.v[e]):this.prop.v[e],this.o[e-4*this.data.p]!==i&&(this.o[e-4*this.data.p]=i,this._omdf=!t);this._mdf=!t}},extendPrototype([DynamicPropertyContainer],GradientProperty);var buildShapeString=function(t,e,r,i){if(0===e)return"";var n,o=t.o,s=t.i,a=t.v,l=" M"+i.applyToPointStringified(a[0][0],a[0][1]);for(n=1;n<e;n+=1)l+=" C"+i.applyToPointStringified(o[n-1][0],o[n-1][1])+" "+i.applyToPointStringified(s[n][0],s[n][1])+" "+i.applyToPointStringified(a[n][0],a[n][1]);return r&&e&&(l+=" C"+i.applyToPointStringified(o[n-1][0],o[n-1][1])+" "+i.applyToPointStringified(s[0][0],s[0][1])+" "+i.applyToPointStringified(a[0][0],a[0][1]),l+="z"),l},audioControllerFactory=function(){function t(t){this.audios=[],this.audioFactory=t,this._volume=1,this._isMuted=!1}return t.prototype={addAudio:function(t){this.audios.push(t)},pause:function(){var t,e=this.audios.length;for(t=0;t<e;t+=1)this.audios[t].pause()},resume:function(){var t,e=this.audios.length;for(t=0;t<e;t+=1)this.audios[t].resume()},setRate:function(t){var e,r=this.audios.length;for(e=0;e<r;e+=1)this.audios[e].setRate(t)},createAudio:function(t){return this.audioFactory?this.audioFactory(t):Howl?new Howl({src:[t]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(t){this.audioFactory=t},setVolume:function(t){this._volume=t,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var t,e=this.audios.length;for(t=0;t<e;t+=1)this.audios[t].volume(this._volume*(this._isMuted?0:1))}},function(){return new t}}(),ImagePreloader=function(){var t=function(){var t=createTag("canvas");t.width=1,t.height=1;var e=t.getContext("2d");return e.fillStyle="rgba(0,0,0,0)",e.fillRect(0,0,1,1),t}();function e(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function r(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function i(t,e,r){var i="";if(t.e)i=t.p;else if(e){var n=t.p;-1!==n.indexOf("images/")&&(n=n.split("/")[1]),i=e+n}else i=r,i+=t.u?t.u:"",i+=t.p;return i}function n(t){var e=0,r=setInterval(function(){(t.getBBox().width||e>500)&&(this._imageLoaded(),clearInterval(r)),e+=1}.bind(this),50)}function o(t){var e={assetData:t},r=i(t,this.assetsPath,this.path);return dataManager.loadData(r,function(t){e.img=t,this._footageLoaded()}.bind(this),function(){e.img={},this._footageLoaded()}.bind(this)),e}function s(){this._imageLoaded=e.bind(this),this._footageLoaded=r.bind(this),this.testImageLoaded=n.bind(this),this.createFootageData=o.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return s.prototype={loadAssets:function(t,e){var r;this.imagesLoadedCb=e;var i=t.length;for(r=0;r<i;r+=1)t[r].layers||(t[r].t&&"seq"!==t[r].t?3===t[r].t&&(this.totalFootages+=1,this.images.push(this.createFootageData(t[r]))):(this.totalImages+=1,this.images.push(this._createImageData(t[r]))))},setAssetsPath:function(t){this.assetsPath=t||""},setPath:function(t){this.path=t||""},loadedImages:function(){return this.totalImages===this.loadedAssets},loadedFootages:function(){return this.totalFootages===this.loadedFootagesCount},destroy:function(){this.imagesLoadedCb=null,this.images.length=0},getAsset:function(t){for(var e=0,r=this.images.length;e<r;){if(this.images[e].assetData===t)return this.images[e].img;e+=1}return null},createImgData:function(e){var r=i(e,this.assetsPath,this.path),n=createTag("img");n.crossOrigin="anonymous",n.addEventListener("load",this._imageLoaded,!1),n.addEventListener("error",function(){o.img=t,this._imageLoaded()}.bind(this),!1),n.src=r;var o={img:n,assetData:e};return o},createImageData:function(e){var r=i(e,this.assetsPath,this.path),n=createNS("image");isSafari?this.testImageLoaded(n):n.addEventListener("load",this._imageLoaded,!1),n.addEventListener("error",function(){o.img=t,this._imageLoaded()}.bind(this),!1),n.setAttributeNS("http://www.w3.org/1999/xlink","href",r),this._elementHelper.append?this._elementHelper.append(n):this._elementHelper.appendChild(n);var o={img:n,assetData:e};return o},imageLoaded:e,footageLoaded:r,setCacheType:function(t,e){"svg"===t?(this._elementHelper=e,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}},s}(),featureSupport=function(){var t={maskType:!0};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(t.maskType=!1),t}(),filtersFactory=function(){var t={createFilter:function(t,e){var r=createNS("filter");return r.setAttribute("id",t),!0!==e&&(r.setAttribute("filterUnits","objectBoundingBox"),r.setAttribute("x","0%"),r.setAttribute("y","0%"),r.setAttribute("width","100%"),r.setAttribute("height","100%")),r},createAlphaToLuminanceFilter:function(){var t=createNS("feColorMatrix");return t.setAttribute("type","matrix"),t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),t}};return t}();function TextAnimatorProperty(t,e,r){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=t,this._renderType=e,this._elem=r,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(r)}function TextAnimatorDataProperty(t,e,r){var i={propType:!1},n=PropertyFactory.getProp,o=e.a;this.a={r:o.r?n(t,o.r,0,degToRads,r):i,rx:o.rx?n(t,o.rx,0,degToRads,r):i,ry:o.ry?n(t,o.ry,0,degToRads,r):i,sk:o.sk?n(t,o.sk,0,degToRads,r):i,sa:o.sa?n(t,o.sa,0,degToRads,r):i,s:o.s?n(t,o.s,1,.01,r):i,a:o.a?n(t,o.a,1,0,r):i,o:o.o?n(t,o.o,0,.01,r):i,p:o.p?n(t,o.p,1,0,r):i,sw:o.sw?n(t,o.sw,0,0,r):i,sc:o.sc?n(t,o.sc,1,0,r):i,fc:o.fc?n(t,o.fc,1,0,r):i,fh:o.fh?n(t,o.fh,0,0,r):i,fs:o.fs?n(t,o.fs,0,.01,r):i,fb:o.fb?n(t,o.fb,0,.01,r):i,t:o.t?n(t,o.t,0,0,r):i},this.s=TextSelectorProp.getTextSelectorProp(t,e.s,r),this.s.t=e.s.t}function LetterProps(t,e,r,i,n,o){this.o=t,this.sw=e,this.sc=r,this.fc=i,this.m=n,this.p=o,this._mdf={o:!0,sw:!!e,sc:!!r,fc:!!i,m:!0,p:!0}}function TextProperty(t,e){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,this.data=e,this.elem=t,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}TextAnimatorProperty.prototype.searchProperties=function(){var t,e,r=this._textData.a.length,i=PropertyFactory.getProp;for(t=0;t<r;t+=1)e=this._textData.a[t],this._animatorsData[t]=new TextAnimatorDataProperty(this._elem,e,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:i(this._elem,this._textData.p.a,0,0,this),f:i(this._elem,this._textData.p.f,0,0,this),l:i(this._elem,this._textData.p.l,0,0,this),r:i(this._elem,this._textData.p.r,0,0,this),p:i(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=i(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(t,e){if(this.lettersChangedFlag=e,this._mdf||this._isFirstFrame||e||this._hasMaskedPath&&this._pathData.m._mdf){this._isFirstFrame=!1;var r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y,v,_,b,x=this._moreOptions.alignment.v,w=this._animatorsData,T=this._textData,E=this.mHelper,S=this._renderType,P=this.renderedLetters.length,k=t.l;if(this._hasMaskedPath){if(b=this._pathData.m,!this._pathData.n||this._pathData._mdf){var A,M=b.v;for(this._pathData.r.v&&(M=M.reverse()),s={tLength:0,segments:[]},o=M._length-1,y=0,n=0;n<o;n+=1)A=bez.buildBezierData(M.v[n],M.v[n+1],[M.o[n][0]-M.v[n][0],M.o[n][1]-M.v[n][1]],[M.i[n+1][0]-M.v[n+1][0],M.i[n+1][1]-M.v[n+1][1]]),s.tLength+=A.segmentLength,s.segments.push(A),y+=A.segmentLength;n=o,b.v.c&&(A=bez.buildBezierData(M.v[n],M.v[0],[M.o[n][0]-M.v[n][0],M.o[n][1]-M.v[n][1]],[M.i[0][0]-M.v[0][0],M.i[0][1]-M.v[0][1]]),s.tLength+=A.segmentLength,s.segments.push(A),y+=A.segmentLength),this._pathData.pi=s}if(s=this._pathData.pi,a=this._pathData.f.v,d=0,h=1,c=0,u=!0,m=s.segments,a<0&&b.v.c)for(s.tLength<Math.abs(a)&&(a=-Math.abs(a)%s.tLength),h=(f=m[d=m.length-1].points).length-1;a<0;)a+=f[h].partialLength,(h-=1)<0&&(h=(f=m[d-=1].points).length-1);p=(f=m[d].points)[h-1],g=(l=f[h]).partialLength}o=k.length,r=0,i=0;var C,I,O,L,D,R=1.2*t.finalSize*.714,F=!0;O=w.length;var B,z,j,N,V,U,$,G,H,q,W,Z,X=-1,Y=a,K=d,J=h,Q=-1,tt="",et=this.defaultPropsArray;if(2===t.j||1===t.j){var rt=0,it=0,nt=2===t.j?-.5:-1,ot=0,st=!0;for(n=0;n<o;n+=1)if(k[n].n){for(rt&&(rt+=it);ot<n;)k[ot].animatorJustifyOffset=rt,ot+=1;rt=0,st=!0}else{for(I=0;I<O;I+=1)(C=w[I].a).t.propType&&(st&&2===t.j&&(it+=C.t.v*nt),(D=w[I].s.getMult(k[n].anIndexes[I],T.a[I].s.totalChars)).length?rt+=C.t.v*D[0]*nt:rt+=C.t.v*D*nt);st=!1}for(rt&&(rt+=it);ot<n;)k[ot].animatorJustifyOffset=rt,ot+=1}for(n=0;n<o;n+=1){if(E.reset(),N=1,k[n].n)r=0,i+=t.yOffset,i+=F?1:0,a=Y,F=!1,this._hasMaskedPath&&(h=J,p=(f=m[d=K].points)[h-1],g=(l=f[h]).partialLength,c=0),tt="",W="",H="",Z="",et=this.defaultPropsArray;else{if(this._hasMaskedPath){if(Q!==k[n].line){switch(t.j){case 1:a+=y-t.lineWidths[k[n].line];break;case 2:a+=(y-t.lineWidths[k[n].line])/2}Q=k[n].line}X!==k[n].ind&&(k[X]&&(a+=k[X].extra),a+=k[n].an/2,X=k[n].ind),a+=x[0]*k[n].an*.005;var at=0;for(I=0;I<O;I+=1)(C=w[I].a).p.propType&&((D=w[I].s.getMult(k[n].anIndexes[I],T.a[I].s.totalChars)).length?at+=C.p.v[0]*D[0]:at+=C.p.v[0]*D),C.a.propType&&((D=w[I].s.getMult(k[n].anIndexes[I],T.a[I].s.totalChars)).length?at+=C.a.v[0]*D[0]:at+=C.a.v[0]*D);for(u=!0,this._pathData.a.v&&(a=.5*k[0].an+(y-this._pathData.f.v-.5*k[0].an-.5*k[k.length-1].an)*X/(o-1),a+=this._pathData.f.v);u;)c+g>=a+at||!f?(v=(a+at-c)/l.partialLength,z=p.point[0]+(l.point[0]-p.point[0])*v,j=p.point[1]+(l.point[1]-p.point[1])*v,E.translate(-x[0]*k[n].an*.005,-x[1]*R*.01),u=!1):f&&(c+=l.partialLength,(h+=1)>=f.length&&(h=0,m[d+=1]?f=m[d].points:b.v.c?(h=0,f=m[d=0].points):(c-=l.partialLength,f=null)),f&&(p=l,g=(l=f[h]).partialLength));B=k[n].an/2-k[n].add,E.translate(-B,0,0)}else B=k[n].an/2-k[n].add,E.translate(-B,0,0),E.translate(-x[0]*k[n].an*.005,-x[1]*R*.01,0);for(I=0;I<O;I+=1)(C=w[I].a).t.propType&&(D=w[I].s.getMult(k[n].anIndexes[I],T.a[I].s.totalChars),0===r&&0===t.j||(this._hasMaskedPath?D.length?a+=C.t.v*D[0]:a+=C.t.v*D:D.length?r+=C.t.v*D[0]:r+=C.t.v*D));for(t.strokeWidthAnim&&(U=t.sw||0),t.strokeColorAnim&&(V=t.sc?[t.sc[0],t.sc[1],t.sc[2]]:[0,0,0]),t.fillColorAnim&&t.fc&&($=[t.fc[0],t.fc[1],t.fc[2]]),I=0;I<O;I+=1)(C=w[I].a).a.propType&&((D=w[I].s.getMult(k[n].anIndexes[I],T.a[I].s.totalChars)).length?E.translate(-C.a.v[0]*D[0],-C.a.v[1]*D[1],C.a.v[2]*D[2]):E.translate(-C.a.v[0]*D,-C.a.v[1]*D,C.a.v[2]*D));for(I=0;I<O;I+=1)(C=w[I].a).s.propType&&((D=w[I].s.getMult(k[n].anIndexes[I],T.a[I].s.totalChars)).length?E.scale(1+(C.s.v[0]-1)*D[0],1+(C.s.v[1]-1)*D[1],1):E.scale(1+(C.s.v[0]-1)*D,1+(C.s.v[1]-1)*D,1));for(I=0;I<O;I+=1){if(C=w[I].a,D=w[I].s.getMult(k[n].anIndexes[I],T.a[I].s.totalChars),C.sk.propType&&(D.length?E.skewFromAxis(-C.sk.v*D[0],C.sa.v*D[1]):E.skewFromAxis(-C.sk.v*D,C.sa.v*D)),C.r.propType&&(D.length?E.rotateZ(-C.r.v*D[2]):E.rotateZ(-C.r.v*D)),C.ry.propType&&(D.length?E.rotateY(C.ry.v*D[1]):E.rotateY(C.ry.v*D)),C.rx.propType&&(D.length?E.rotateX(C.rx.v*D[0]):E.rotateX(C.rx.v*D)),C.o.propType&&(D.length?N+=(C.o.v*D[0]-N)*D[0]:N+=(C.o.v*D-N)*D),t.strokeWidthAnim&&C.sw.propType&&(D.length?U+=C.sw.v*D[0]:U+=C.sw.v*D),t.strokeColorAnim&&C.sc.propType)for(G=0;G<3;G+=1)D.length?V[G]+=(C.sc.v[G]-V[G])*D[0]:V[G]+=(C.sc.v[G]-V[G])*D;if(t.fillColorAnim&&t.fc){if(C.fc.propType)for(G=0;G<3;G+=1)D.length?$[G]+=(C.fc.v[G]-$[G])*D[0]:$[G]+=(C.fc.v[G]-$[G])*D;C.fh.propType&&($=D.length?addHueToRGB($,C.fh.v*D[0]):addHueToRGB($,C.fh.v*D)),C.fs.propType&&($=D.length?addSaturationToRGB($,C.fs.v*D[0]):addSaturationToRGB($,C.fs.v*D)),C.fb.propType&&($=D.length?addBrightnessToRGB($,C.fb.v*D[0]):addBrightnessToRGB($,C.fb.v*D))}}for(I=0;I<O;I+=1)(C=w[I].a).p.propType&&(D=w[I].s.getMult(k[n].anIndexes[I],T.a[I].s.totalChars),this._hasMaskedPath?D.length?E.translate(0,C.p.v[1]*D[0],-C.p.v[2]*D[1]):E.translate(0,C.p.v[1]*D,-C.p.v[2]*D):D.length?E.translate(C.p.v[0]*D[0],C.p.v[1]*D[1],-C.p.v[2]*D[2]):E.translate(C.p.v[0]*D,C.p.v[1]*D,-C.p.v[2]*D));if(t.strokeWidthAnim&&(H=U<0?0:U),t.strokeColorAnim&&(q="rgb("+Math.round(255*V[0])+","+Math.round(255*V[1])+","+Math.round(255*V[2])+")"),t.fillColorAnim&&t.fc&&(W="rgb("+Math.round(255*$[0])+","+Math.round(255*$[1])+","+Math.round(255*$[2])+")"),this._hasMaskedPath){if(E.translate(0,-t.ls),E.translate(0,x[1]*R*.01+i,0),this._pathData.p.v){_=(l.point[1]-p.point[1])/(l.point[0]-p.point[0]);var lt=180*Math.atan(_)/Math.PI;l.point[0]<p.point[0]&&(lt+=180),E.rotate(-lt*Math.PI/180)}E.translate(z,j,0),a-=x[0]*k[n].an*.005,k[n+1]&&X!==k[n+1].ind&&(a+=k[n].an/2,a+=.001*t.tr*t.finalSize)}else{switch(E.translate(r,i,0),t.ps&&E.translate(t.ps[0],t.ps[1]+t.ascent,0),t.j){case 1:E.translate(k[n].animatorJustifyOffset+t.justifyOffset+(t.boxWidth-t.lineWidths[k[n].line]),0,0);break;case 2:E.translate(k[n].animatorJustifyOffset+t.justifyOffset+(t.boxWidth-t.lineWidths[k[n].line])/2,0,0)}E.translate(0,-t.ls),E.translate(B,0,0),E.translate(x[0]*k[n].an*.005,x[1]*R*.01,0),r+=k[n].l+.001*t.tr*t.finalSize}"html"===S?tt=E.toCSS():"svg"===S?tt=E.to2dCSS():et=[E.props[0],E.props[1],E.props[2],E.props[3],E.props[4],E.props[5],E.props[6],E.props[7],E.props[8],E.props[9],E.props[10],E.props[11],E.props[12],E.props[13],E.props[14],E.props[15]],Z=N}P<=n?(L=new LetterProps(Z,H,q,W,tt,et),this.renderedLetters.push(L),P+=1,this.lettersChangedFlag=!0):(L=this.renderedLetters[n],this.lettersChangedFlag=L.update(Z,H,q,W,tt,et)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty),LetterProps.prototype.update=function(t,e,r,i,n,o){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var s=!1;return this.o!==t&&(this.o=t,this._mdf.o=!0,s=!0),this.sw!==e&&(this.sw=e,this._mdf.sw=!0,s=!0),this.sc!==r&&(this.sc=r,this._mdf.sc=!0,s=!0),this.fc!==i&&(this.fc=i,this._mdf.fc=!0,s=!0),this.m!==n&&(this.m=n,this._mdf.m=!0,s=!0),!o.length||this.p[0]===o[0]&&this.p[1]===o[1]&&this.p[4]===o[4]&&this.p[5]===o[5]&&this.p[12]===o[12]&&this.p[13]===o[13]||(this.p=o,this._mdf.p=!0,s=!0),s},TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},TextProperty.prototype.setCurrentData=function(t){t.__complete||this.completeTextData(t),this.currentData=t,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(t){this.effectsSequence.push(t),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(t){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length||t){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var e=this.currentData,r=this.keysIndex;if(this.lock)this.setCurrentData(this.currentData);else{var i;this.lock=!0,this._mdf=!1;var n=this.effectsSequence.length,o=t||this.data.d.k[this.keysIndex].s;for(i=0;i<n;i+=1)o=r!==this.keysIndex?this.effectsSequence[i](o,o.t):this.effectsSequence[i](this.currentData,o.t);e!==o&&this.setCurrentData(o),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}}},TextProperty.prototype.getKeyframeValue=function(){for(var t=this.data.d.k,e=this.elem.comp.renderedFrame,r=0,i=t.length;r<=i-1&&!(r===i-1||t[r+1].t>e);)r+=1;return this.keysIndex!==r&&(this.keysIndex=r),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(t){for(var e,r,i=[],n=0,o=t.length,s=!1;n<o;)e=t.charCodeAt(n),FontManager.isCombinedCharacter(e)?i[i.length-1]+=t.charAt(n):e>=55296&&e<=56319?(r=t.charCodeAt(n+1))>=56320&&r<=57343?(s||FontManager.isModifier(e,r)?(i[i.length-1]+=t.substr(n,2),s=!1):i.push(t.substr(n,2)),n+=1):i.push(t.charAt(n)):e>56319?(r=t.charCodeAt(n+1),FontManager.isZeroWidthJoiner(e,r)?(s=!0,i[i.length-1]+=t.substr(n,2),n+=1):i.push(t.charAt(n))):FontManager.isZeroWidthJoiner(e)?(i[i.length-1]+=t.charAt(n),s=!0):i.push(t.charAt(n)),n+=1;return i},TextProperty.prototype.completeTextData=function(t){t.__complete=!0;var e,r,i,n,o,s,a,l=this.elem.globalData.fontManager,c=this.data,u=[],h=0,d=c.m.g,p=0,f=0,m=0,g=[],y=0,v=0,_=l.getFontByName(t.f),b=0,x=getFontProperties(_);t.fWeight=x.weight,t.fStyle=x.style,t.finalSize=t.s,t.finalText=this.buildFinalText(t.t),r=t.finalText.length,t.finalLineHeight=t.lh;var w,T=t.tr/1e3*t.finalSize;if(t.sz)for(var E,S,P=!0,k=t.sz[0],A=t.sz[1];P;){E=0,y=0,r=(S=this.buildFinalText(t.t)).length,T=t.tr/1e3*t.finalSize;var M=-1;for(e=0;e<r;e+=1)w=S[e].charCodeAt(0),i=!1," "===S[e]?M=e:13!==w&&3!==w||(y=0,i=!0,E+=t.finalLineHeight||1.2*t.finalSize),l.chars?(a=l.getCharData(S[e],_.fStyle,_.fFamily),b=i?0:a.w*t.finalSize/100):b=l.measureText(S[e],t.f,t.finalSize),y+b>k&&" "!==S[e]?(-1===M?r+=1:e=M,E+=t.finalLineHeight||1.2*t.finalSize,S.splice(e,M===e?1:0,"\r"),M=-1,y=0):(y+=b,y+=T);E+=_.ascent*t.finalSize/100,this.canResize&&t.finalSize>this.minimumFontSize&&A<E?(t.finalSize-=1,t.finalLineHeight=t.finalSize*t.lh/t.s):(t.finalText=S,r=t.finalText.length,P=!1)}y=-T,b=0;var C,I=0;for(e=0;e<r;e+=1)if(i=!1,13===(w=(C=t.finalText[e]).charCodeAt(0))||3===w?(I=0,g.push(y),v=y>v?y:v,y=-2*T,n="",i=!0,m+=1):n=C,l.chars?(a=l.getCharData(C,_.fStyle,l.getFontByName(t.f).fFamily),b=i?0:a.w*t.finalSize/100):b=l.measureText(n,t.f,t.finalSize)," "===C?I+=b+T:(y+=b+T+I,I=0),u.push({l:b,an:b,add:p,n:i,anIndexes:[],val:n,line:m,animatorJustifyOffset:0}),2==d){if(p+=b,""===n||" "===n||e===r-1){for(""!==n&&" "!==n||(p-=b);f<=e;)u[f].an=p,u[f].ind=h,u[f].extra=b,f+=1;h+=1,p=0}}else if(3==d){if(p+=b,""===n||e===r-1){for(""===n&&(p-=b);f<=e;)u[f].an=p,u[f].ind=h,u[f].extra=b,f+=1;p=0,h+=1}}else u[h].ind=h,u[h].extra=0,h+=1;if(t.l=u,v=y>v?y:v,g.push(y),t.sz)t.boxWidth=t.sz[0],t.justifyOffset=0;else switch(t.boxWidth=v,t.j){case 1:t.justifyOffset=-t.boxWidth;break;case 2:t.justifyOffset=-t.boxWidth/2;break;default:t.justifyOffset=0}t.lineWidths=g;var O,L,D,R,F=c.a;s=F.length;var B=[];for(o=0;o<s;o+=1){for((O=F[o]).a.sc&&(t.strokeColorAnim=!0),O.a.sw&&(t.strokeWidthAnim=!0),(O.a.fc||O.a.fh||O.a.fs||O.a.fb)&&(t.fillColorAnim=!0),R=0,D=O.s.b,e=0;e<r;e+=1)(L=u[e]).anIndexes[o]=R,(1==D&&""!==L.val||2==D&&""!==L.val&&" "!==L.val||3==D&&(L.n||" "==L.val||e==r-1)||4==D&&(L.n||e==r-1))&&(1===O.s.rn&&B.push(R),R+=1);c.a[o].s.totalChars=R;var z,j=-1;if(1===O.s.rn)for(e=0;e<r;e+=1)j!=(L=u[e]).anIndexes[o]&&(j=L.anIndexes[o],z=B.splice(Math.floor(Math.random()*B.length),1)[0]),L.anIndexes[o]=z}t.yOffset=t.finalLineHeight||1.2*t.finalSize,t.ls=t.ls||0,t.ascent=_.ascent*t.finalSize/100},TextProperty.prototype.updateDocumentData=function(t,e){e=void 0===e?this.keysIndex:e;var r=this.copyData({},this.data.d.k[e].s);r=this.copyData(r,t),this.data.d.k[e].s=r,this.recalculate(e),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(t){var e=this.data.d.k[t].s;e.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(e)},TextProperty.prototype.canResizeFont=function(t){this.canResize=t,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(t){this.minimumFontSize=Math.floor(t)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=function(){var t=Math.max,e=Math.min,r=Math.floor;function i(t,e){this._currentTextLength=-1,this.k=!1,this.data=e,this.elem=t,this.comp=t.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(t),this.s=PropertyFactory.getProp(t,e.s||{k:0},0,0,this),this.e="e"in e?PropertyFactory.getProp(t,e.e,0,0,this):{v:100},this.o=PropertyFactory.getProp(t,e.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(t,e.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(t,e.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(t,e.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(t,e.a,0,.01,this),this.dynamicProperties.length||this.getValue()}return i.prototype={getMult:function(i){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var n=0,o=0,s=1,a=1;this.ne.v>0?n=this.ne.v/100:o=-this.ne.v/100,this.xe.v>0?s=1-this.xe.v/100:a=1+this.xe.v/100;var l=BezierFactory.getBezierEasing(n,o,s,a).get,c=0,u=this.finalS,h=this.finalE,d=this.data.sh;if(2===d)c=l(c=h===u?i>=h?1:0:t(0,e(.5/(h-u)+(i-u)/(h-u),1)));else if(3===d)c=l(c=h===u?i>=h?0:1:1-t(0,e(.5/(h-u)+(i-u)/(h-u),1)));else if(4===d)h===u?c=0:(c=t(0,e(.5/(h-u)+(i-u)/(h-u),1)))<.5?c*=2:c=1-2*(c-.5),c=l(c);else if(5===d){if(h===u)c=0;else{var p=h-u,f=-p/2+(i=e(t(0,i+.5-u),h-u)),m=p/2;c=Math.sqrt(1-f*f/(m*m))}c=l(c)}else 6===d?(h===u?c=0:(i=e(t(0,i+.5-u),h-u),c=(1+Math.cos(Math.PI+2*Math.PI*i/(h-u)))/2),c=l(c)):(i>=r(u)&&(c=t(0,e(i-u<0?e(h,1)-(u-i):h-i,1))),c=l(c));if(100!==this.sm.v){var g=.01*this.sm.v;0===g&&(g=1e-8);var y=.5-.5*g;c<y?c=0:(c=(c-y)/g)>1&&(c=1)}return c*this.a.v},getValue:function(t){this.iterateDynamicProperties(),this._mdf=t||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,t&&2===this.data.r&&(this.e.v=this._currentTextLength);var e=2===this.data.r?1:100/this.data.totalChars,r=this.o.v/e,i=this.s.v/e+r,n=this.e.v/e+r;if(i>n){var o=i;i=n,n=o}this.finalS=i,this.finalE=n}},extendPrototype([DynamicPropertyContainer],i),{getTextSelectorProp:function(t,e,r){return new i(t,e,r)}}}(),poolFactory=function(t,e,r){var i=0,n=t,o=createSizedArray(n);return{newElement:function(){return i?o[i-=1]:e()},release:function(t){i===n&&(o=pooling.double(o),n*=2),r&&r(t),o[i]=t,i+=1}}},pooling={double:function(t){return t.concat(createSizedArray(t.length))}},pointPool=poolFactory(8,(function(){return createTypedArray("float32",2)})),shapePool=(factory=poolFactory(4,(function(){return new ShapePath}),(function(t){var e,r=t._length;for(e=0;e<r;e+=1)pointPool.release(t.v[e]),pointPool.release(t.i[e]),pointPool.release(t.o[e]),t.v[e]=null,t.i[e]=null,t.o[e]=null;t._length=0,t.c=!1})),factory.clone=function(t){var e,r=factory.newElement(),i=void 0===t._length?t.v.length:t._length;for(r.setLength(i),r.c=t.c,e=0;e<i;e+=1)r.setTripleAt(t.v[e][0],t.v[e][1],t.o[e][0],t.o[e][1],t.i[e][0],t.i[e][1],e);return r},factory),factory,shapeCollectionPool=function(){var t={newShapeCollection:function(){return e?i[e-=1]:new ShapeCollection},release:function(t){var n,o=t._length;for(n=0;n<o;n+=1)shapePool.release(t.shapes[n]);t._length=0,e===r&&(i=pooling.double(i),r*=2),i[e]=t,e+=1}},e=0,r=4,i=createSizedArray(r);return t}(),segmentsLengthPool=poolFactory(8,(function(){return{lengths:[],totalLength:0}}),(function(t){var e,r=t.lengths.length;for(e=0;e<r;e+=1)bezierLengthPool.release(t.lengths[e]);t.lengths.length=0})),bezierLengthPool=poolFactory(8,(function(){return{addedLength:0,percents:createTypedArray("float32",defaultCurveSegments),lengths:createTypedArray("float32",defaultCurveSegments)}})),markerParser=function(){function t(t){for(var e,r=t.split("\r\n"),i={},n=0,o=0;o<r.length;o+=1)2===(e=r[o].split(":")).length&&(i[e[0]]=e[1].trim(),n+=1);if(0===n)throw new Error;return i}return function(e){for(var r=[],i=0;i<e.length;i+=1){var n=e[i],o={time:n.tm,duration:n.dr};try{o.payload=JSON.parse(e[i].cm)}catch(r){try{o.payload=t(e[i].cm)}catch(t){o.payload={name:e[i]}}}r.push(o)}return r}}();function BaseRenderer(){}function SVGRenderer(t,e){this.animationItem=t,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var r="";if(e&&e.title){var i=createNS("title"),n=createElementID();i.setAttribute("id",n),i.textContent=e.title,this.svgElement.appendChild(i),r+=n}if(e&&e.description){var o=createNS("desc"),s=createElementID();o.setAttribute("id",s),o.textContent=e.description,this.svgElement.appendChild(o),r+=" "+s}r&&this.svgElement.setAttribute("aria-labelledby",r);var a=createNS("defs");this.svgElement.appendChild(a);var l=createNS("g");this.svgElement.appendChild(l),this.layerElement=l,this.renderConfig={preserveAspectRatio:e&&e.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:e&&e.contentVisibility||"visible",progressiveLoad:e&&e.progressiveLoad||!1,hideOnTransparent:!(e&&!1===e.hideOnTransparent),viewBoxOnly:e&&e.viewBoxOnly||!1,viewBoxSize:e&&e.viewBoxSize||!1,className:e&&e.className||"",id:e&&e.id||"",focusable:e&&e.focusable,filterSize:{width:e&&e.filterSize&&e.filterSize.width||"100%",height:e&&e.filterSize&&e.filterSize.height||"100%",x:e&&e.filterSize&&e.filterSize.x||"0%",y:e&&e.filterSize&&e.filterSize.y||"0%"}},this.globalData={_mdf:!1,frameNum:-1,defs:a,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}function CanvasRenderer(t,e){this.animationItem=t,this.renderConfig={clearCanvas:!e||void 0===e.clearCanvas||e.clearCanvas,context:e&&e.context||null,progressiveLoad:e&&e.progressiveLoad||!1,preserveAspectRatio:e&&e.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:e&&e.contentVisibility||"visible",className:e&&e.className||"",id:e&&e.id||""},this.renderConfig.dpr=e&&e.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=e&&e.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas"}function HybridRenderer(t,e){this.animationItem=t,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:e&&e.className||"",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(e&&!1===e.hideOnTransparent),filterSize:{width:e&&e.filterSize&&e.filterSize.width||"400%",height:e&&e.filterSize&&e.filterSize.height||"400%",x:e&&e.filterSize&&e.filterSize.x||"-100%",y:e&&e.filterSize&&e.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}function MaskElement(t,e,r){this.data=t,this.element=e,this.globalData=r,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var i,n,o=this.globalData.defs,s=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(s),this.solidPath="";var a,l,c,u,h,d,p=this.masksProperties,f=0,m=[],g=createElementID(),y="clipPath",v="clip-path";for(i=0;i<s;i+=1)if(("a"!==p[i].mode&&"n"!==p[i].mode||p[i].inv||100!==p[i].o.k||p[i].o.x)&&(y="mask",v="mask"),"s"!==p[i].mode&&"i"!==p[i].mode||0!==f?c=null:((c=createNS("rect")).setAttribute("fill","#ffffff"),c.setAttribute("width",this.element.comp.data.w||0),c.setAttribute("height",this.element.comp.data.h||0),m.push(c)),n=createNS("path"),"n"===p[i].mode)this.viewData[i]={op:PropertyFactory.getProp(this.element,p[i].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,p[i],3),elem:n,lastPath:""},o.appendChild(n);else{var _;if(f+=1,n.setAttribute("fill","s"===p[i].mode?"#000000":"#ffffff"),n.setAttribute("clip-rule","nonzero"),0!==p[i].x.k?(y="mask",v="mask",d=PropertyFactory.getProp(this.element,p[i].x,0,null,this.element),_=createElementID(),(u=createNS("filter")).setAttribute("id",_),(h=createNS("feMorphology")).setAttribute("operator","erode"),h.setAttribute("in","SourceGraphic"),h.setAttribute("radius","0"),u.appendChild(h),o.appendChild(u),n.setAttribute("stroke","s"===p[i].mode?"#000000":"#ffffff")):(h=null,d=null),this.storedData[i]={elem:n,x:d,expan:h,lastPath:"",lastOperator:"",filterId:_,lastRadius:0},"i"===p[i].mode){l=m.length;var b=createNS("g");for(a=0;a<l;a+=1)b.appendChild(m[a]);var x=createNS("mask");x.setAttribute("mask-type","alpha"),x.setAttribute("id",g+"_"+f),x.appendChild(n),o.appendChild(x),b.setAttribute("mask","url("+locationHref+"#"+g+"_"+f+")"),m.length=0,m.push(b)}else m.push(n);p[i].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[i]={elem:n,lastPath:"",op:PropertyFactory.getProp(this.element,p[i].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,p[i],3),invRect:c},this.viewData[i].prop.k||this.drawPath(p[i],this.viewData[i].prop.v,this.viewData[i])}for(this.maskElement=createNS(y),s=m.length,i=0;i<s;i+=1)this.maskElement.appendChild(m[i]);f>0&&(this.maskElement.setAttribute("id",g),this.element.maskedElement.setAttribute(v,"url("+locationHref+"#"+g+")"),o.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}function HierarchyElement(){}function FrameElement(){}function TransformElement(){}function RenderableElement(){}function RenderableDOMElement(){}function ProcessedElement(t,e){this.elem=t,this.pos=e}function SVGStyleData(t,e){this.data=t,this.type=t.ty,this.d="",this.lvl=e,this._mdf=!1,this.closed=!0===t.hd,this.pElem=createNS("path"),this.msElem=null}function SVGShapeData(t,e,r){this.caches=[],this.styles=[],this.transformers=t,this.lStr="",this.sh=r,this.lvl=e,this._isAnimated=!!r.k;for(var i=0,n=t.length;i<n;){if(t[i].mProps.dynamicProperties.length){this._isAnimated=!0;break}i+=1}}function SVGTransformData(t,e,r){this.transform={mProps:t,op:e,container:r},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}function SVGStrokeStyleData(t,e,r){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(t,e.o,0,.01,this),this.w=PropertyFactory.getProp(t,e.w,0,null,this),this.d=new DashProperty(t,e.d||{},"svg",this),this.c=PropertyFactory.getProp(t,e.c,1,255,this),this.style=r,this._isAnimated=!!this._isAnimated}function SVGFillStyleData(t,e,r){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(t,e.o,0,.01,this),this.c=PropertyFactory.getProp(t,e.c,1,255,this),this.style=r}function SVGGradientFillStyleData(t,e,r){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.initGradientData(t,e,r)}function SVGGradientStrokeStyleData(t,e,r){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(t,e.w,0,null,this),this.d=new DashProperty(t,e.d||{},"svg",this),this.initGradientData(t,e,r),this._isAnimated=!!this._isAnimated}function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}BaseRenderer.prototype.checkLayers=function(t){var e,r,i=this.layers.length;for(this.completeLayers=!0,e=i-1;e>=0;e-=1)this.elements[e]||(r=this.layers[e]).ip-r.st<=t-this.layers[e].st&&r.op-r.st>t-this.layers[e].st&&this.buildItem(e),this.completeLayers=!!this.elements[e]&&this.completeLayers;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(t){switch(t.ty){case 2:return this.createImage(t);case 0:return this.createComp(t);case 1:return this.createSolid(t);case 3:default:return this.createNull(t);case 4:return this.createShape(t);case 5:return this.createText(t);case 6:return this.createAudio(t);case 13:return this.createCamera(t);case 15:return this.createFootage(t)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(t){return new AudioElement(t,this.globalData,this)},BaseRenderer.prototype.createFootage=function(t){return new FootageElement(t,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){var t,e=this.layers.length;for(t=0;t<e;t+=1)this.buildItem(t);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(t){var e;this.completeLayers=!1;var r,i=t.length,n=this.layers.length;for(e=0;e<i;e+=1)for(r=0;r<n;){if(this.layers[r].id===t[e].id){this.layers[r]=t[e];break}r+=1}},BaseRenderer.prototype.setProjectInterface=function(t){this.globalData.projectInterface=t},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(t,e,r){for(var i=this.elements,n=this.layers,o=0,s=n.length;o<s;)n[o].ind==e&&(i[o]&&!0!==i[o]?(r.push(i[o]),i[o].setAsParent(),void 0!==n[o].parent?this.buildElementParenting(t,n[o].parent,r):t.setHierarchy(r)):(this.buildItem(o),this.addPendingElement(t))),o+=1},BaseRenderer.prototype.addPendingElement=function(t){this.pendingElements.push(t)},BaseRenderer.prototype.searchExtraCompositions=function(t){var e,r=t.length;for(e=0;e<r;e+=1)if(t[e].xt){var i=this.createComp(t[e]);i.initExpressions(),this.globalData.projectInterface.registerComposition(i)}},BaseRenderer.prototype.setupGlobalData=function(t,e){this.globalData.fontManager=new FontManager,this.globalData.fontManager.addChars(t.chars),this.globalData.fontManager.addFonts(t.fonts,e),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=t.fr,this.globalData.nm=t.nm,this.globalData.compSize={w:t.w,h:t.h}},extendPrototype([BaseRenderer],SVGRenderer),SVGRenderer.prototype.createNull=function(t){return new NullElement(t,this.globalData,this)},SVGRenderer.prototype.createShape=function(t){return new SVGShapeElement(t,this.globalData,this)},SVGRenderer.prototype.createText=function(t){return new SVGTextLottieElement(t,this.globalData,this)},SVGRenderer.prototype.createImage=function(t){return new IImageElement(t,this.globalData,this)},SVGRenderer.prototype.createComp=function(t){return new SVGCompElement(t,this.globalData,this)},SVGRenderer.prototype.createSolid=function(t){return new ISolidElement(t,this.globalData,this)},SVGRenderer.prototype.configAnimation=function(t){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+t.w+" "+t.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",t.w),this.svgElement.setAttribute("height",t.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),void 0!==this.renderConfig.focusable&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var e=this.globalData.defs;this.setupGlobalData(t,e),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=t;var r=createNS("clipPath"),i=createNS("rect");i.setAttribute("width",t.w),i.setAttribute("height",t.h),i.setAttribute("x",0),i.setAttribute("y",0);var n=createElementID();r.setAttribute("id",n),r.appendChild(i),this.layerElement.setAttribute("clip-path","url("+locationHref+"#"+n+")"),e.appendChild(r),this.layers=t.layers,this.elements=createSizedArray(t.layers.length)},SVGRenderer.prototype.destroy=function(){var t;this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var e=this.layers?this.layers.length:0;for(t=0;t<e;t+=1)this.elements[t]&&this.elements[t].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRenderer.prototype.updateContainerSize=function(){},SVGRenderer.prototype.buildItem=function(t){var e=this.elements;if(!e[t]&&99!==this.layers[t].ty){e[t]=!0;var r=this.createItem(this.layers[t]);e[t]=r,expressionsPlugin&&(0===this.layers[t].ty&&this.globalData.projectInterface.registerComposition(r),r.initExpressions()),this.appendElementInPos(r,t),this.layers[t].tt&&(this.elements[t-1]&&!0!==this.elements[t-1]?r.setMatte(e[t-1].layerId):(this.buildItem(t-1),this.addPendingElement(r)))}},SVGRenderer.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var t=this.pendingElements.pop();if(t.checkParenting(),t.data.tt)for(var e=0,r=this.elements.length;e<r;){if(this.elements[e]===t){t.setMatte(this.elements[e-1].layerId);break}e+=1}}},SVGRenderer.prototype.renderFrame=function(t){if(this.renderedFrame!==t&&!this.destroyed){var e;null===t?t=this.renderedFrame:this.renderedFrame=t,this.globalData.frameNum=t,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=t,this.globalData._mdf=!1;var r=this.layers.length;for(this.completeLayers||this.checkLayers(t),e=r-1;e>=0;e-=1)(this.completeLayers||this.elements[e])&&this.elements[e].prepareFrame(t-this.layers[e].st);if(this.globalData._mdf)for(e=0;e<r;e+=1)(this.completeLayers||this.elements[e])&&this.elements[e].renderFrame()}},SVGRenderer.prototype.appendElementInPos=function(t,e){var r=t.getBaseElement();if(r){for(var i,n=0;n<e;)this.elements[n]&&!0!==this.elements[n]&&this.elements[n].getBaseElement()&&(i=this.elements[n].getBaseElement()),n+=1;i?this.layerElement.insertBefore(r,i):this.layerElement.appendChild(r)}},SVGRenderer.prototype.hide=function(){this.layerElement.style.display="none"},SVGRenderer.prototype.show=function(){this.layerElement.style.display="block"},extendPrototype([BaseRenderer],CanvasRenderer),CanvasRenderer.prototype.createShape=function(t){return new CVShapeElement(t,this.globalData,this)},CanvasRenderer.prototype.createText=function(t){return new CVTextElement(t,this.globalData,this)},CanvasRenderer.prototype.createImage=function(t){return new CVImageElement(t,this.globalData,this)},CanvasRenderer.prototype.createComp=function(t){return new CVCompElement(t,this.globalData,this)},CanvasRenderer.prototype.createSolid=function(t){return new CVSolidElement(t,this.globalData,this)},CanvasRenderer.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRenderer.prototype.ctxTransform=function(t){if(1!==t[0]||0!==t[1]||0!==t[4]||1!==t[5]||0!==t[12]||0!==t[13])if(this.renderConfig.clearCanvas){this.transformMat.cloneFromProps(t);var e=this.contextData.cTr.props;this.transformMat.transform(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]),this.contextData.cTr.cloneFromProps(this.transformMat.props);var r=this.contextData.cTr.props;this.canvasContext.setTransform(r[0],r[1],r[4],r[5],r[12],r[13])}else this.canvasContext.transform(t[0],t[1],t[4],t[5],t[12],t[13])},CanvasRenderer.prototype.ctxOpacity=function(t){if(!this.renderConfig.clearCanvas)return this.canvasContext.globalAlpha*=t<0?0:t,void(this.globalData.currentGlobalAlpha=this.contextData.cO);this.contextData.cO*=t<0?0:t,this.globalData.currentGlobalAlpha!==this.contextData.cO&&(this.canvasContext.globalAlpha=this.contextData.cO,this.globalData.currentGlobalAlpha=this.contextData.cO)},CanvasRenderer.prototype.reset=function(){this.renderConfig.clearCanvas?this.contextData.reset():this.canvasContext.restore()},CanvasRenderer.prototype.save=function(t){if(this.renderConfig.clearCanvas){t&&this.canvasContext.save();var e,r=this.contextData.cTr.props;this.contextData._length<=this.contextData.cArrPos&&this.contextData.duplicate();var i=this.contextData.saved[this.contextData.cArrPos];for(e=0;e<16;e+=1)i[e]=r[e];this.contextData.savedOp[this.contextData.cArrPos]=this.contextData.cO,this.contextData.cArrPos+=1}else this.canvasContext.save()},CanvasRenderer.prototype.restore=function(t){if(this.renderConfig.clearCanvas){t&&(this.canvasContext.restore(),this.globalData.blendMode="source-over"),this.contextData.cArrPos-=1;var e,r=this.contextData.saved[this.contextData.cArrPos],i=this.contextData.cTr.props;for(e=0;e<16;e+=1)i[e]=r[e];this.canvasContext.setTransform(r[0],r[1],r[4],r[5],r[12],r[13]),r=this.contextData.savedOp[this.contextData.cArrPos],this.contextData.cO=r,this.globalData.currentGlobalAlpha!==r&&(this.canvasContext.globalAlpha=r,this.globalData.currentGlobalAlpha=r)}else this.canvasContext.restore()},CanvasRenderer.prototype.configAnimation=function(t){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var e=this.animationItem.container.style;e.width="100%",e.height="100%";var r="0px 0px 0px";e.transformOrigin=r,e.mozTransformOrigin=r,e.webkitTransformOrigin=r,e["-webkit-transform"]=r,e.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)}else this.canvasContext=this.renderConfig.context;this.data=t,this.layers=t.layers,this.transformCanvas={w:t.w,h:t.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(t,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(t.layers.length),this.updateContainerSize()},CanvasRenderer.prototype.updateContainerSize=function(){var t,e,r,i;if(this.reset(),this.animationItem.wrapper&&this.animationItem.container?(t=this.animationItem.wrapper.offsetWidth,e=this.animationItem.wrapper.offsetHeight,this.animationItem.container.setAttribute("width",t*this.renderConfig.dpr),this.animationItem.container.setAttribute("height",e*this.renderConfig.dpr)):(t=this.canvasContext.canvas.width*this.renderConfig.dpr,e=this.canvasContext.canvas.height*this.renderConfig.dpr),-1!==this.renderConfig.preserveAspectRatio.indexOf("meet")||-1!==this.renderConfig.preserveAspectRatio.indexOf("slice")){var n=this.renderConfig.preserveAspectRatio.split(" "),o=n[1]||"meet",s=n[0]||"xMidYMid",a=s.substr(0,4),l=s.substr(4);r=t/e,(i=this.transformCanvas.w/this.transformCanvas.h)>r&&"meet"===o||i<r&&"slice"===o?(this.transformCanvas.sx=t/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=t/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=e/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=e/(this.transformCanvas.h/this.renderConfig.dpr)),this.transformCanvas.tx="xMid"===a&&(i<r&&"meet"===o||i>r&&"slice"===o)?(t-this.transformCanvas.w*(e/this.transformCanvas.h))/2*this.renderConfig.dpr:"xMax"===a&&(i<r&&"meet"===o||i>r&&"slice"===o)?(t-this.transformCanvas.w*(e/this.transformCanvas.h))*this.renderConfig.dpr:0,this.transformCanvas.ty="YMid"===l&&(i>r&&"meet"===o||i<r&&"slice"===o)?(e-this.transformCanvas.h*(t/this.transformCanvas.w))/2*this.renderConfig.dpr:"YMax"===l&&(i>r&&"meet"===o||i<r&&"slice"===o)?(e-this.transformCanvas.h*(t/this.transformCanvas.w))*this.renderConfig.dpr:0}else"none"===this.renderConfig.preserveAspectRatio?(this.transformCanvas.sx=t/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=e/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRenderer.prototype.destroy=function(){var t;for(this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),t=(this.layers?this.layers.length:0)-1;t>=0;t-=1)this.elements[t]&&this.elements[t].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRenderer.prototype.renderFrame=function(t,e){if((this.renderedFrame!==t||!0!==this.renderConfig.clearCanvas||e)&&!this.destroyed&&-1!==t){var r;this.renderedFrame=t,this.globalData.frameNum=t-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||e,this.globalData.projectInterface.currentFrame=t;var i=this.layers.length;for(this.completeLayers||this.checkLayers(t),r=0;r<i;r+=1)(this.completeLayers||this.elements[r])&&this.elements[r].prepareFrame(t-this.layers[r].st);if(this.globalData._mdf){for(!0===this.renderConfig.clearCanvas?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),r=i-1;r>=0;r-=1)(this.completeLayers||this.elements[r])&&this.elements[r].renderFrame();!0!==this.renderConfig.clearCanvas&&this.restore()}}},CanvasRenderer.prototype.buildItem=function(t){var e=this.elements;if(!e[t]&&99!==this.layers[t].ty){var r=this.createItem(this.layers[t],this,this.globalData);e[t]=r,r.initExpressions()}},CanvasRenderer.prototype.checkPendingElements=function(){for(;this.pendingElements.length;)this.pendingElements.pop().checkParenting()},CanvasRenderer.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRenderer.prototype.show=function(){this.animationItem.container.style.display="block"},extendPrototype([BaseRenderer],HybridRenderer),HybridRenderer.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRenderer.prototype.checkPendingElements=function(){for(;this.pendingElements.length;)this.pendingElements.pop().checkParenting()},HybridRenderer.prototype.appendElementInPos=function(t,e){var r=t.getBaseElement();if(r){var i=this.layers[e];if(i.ddd&&this.supports3d)this.addTo3dContainer(r,e);else if(this.threeDElements)this.addTo3dContainer(r,e);else{for(var n,o,s=0;s<e;)this.elements[s]&&!0!==this.elements[s]&&this.elements[s].getBaseElement&&(o=this.elements[s],n=(this.layers[s].ddd?this.getThreeDContainerByPos(s):o.getBaseElement())||n),s+=1;n?i.ddd&&this.supports3d||this.layerElement.insertBefore(r,n):i.ddd&&this.supports3d||this.layerElement.appendChild(r)}}},HybridRenderer.prototype.createShape=function(t){return this.supports3d?new HShapeElement(t,this.globalData,this):new SVGShapeElement(t,this.globalData,this)},HybridRenderer.prototype.createText=function(t){return this.supports3d?new HTextElement(t,this.globalData,this):new SVGTextLottieElement(t,this.globalData,this)},HybridRenderer.prototype.createCamera=function(t){return this.camera=new HCameraElement(t,this.globalData,this),this.camera},HybridRenderer.prototype.createImage=function(t){return this.supports3d?new HImageElement(t,this.globalData,this):new IImageElement(t,this.globalData,this)},HybridRenderer.prototype.createComp=function(t){return this.supports3d?new HCompElement(t,this.globalData,this):new SVGCompElement(t,this.globalData,this)},HybridRenderer.prototype.createSolid=function(t){return this.supports3d?new HSolidElement(t,this.globalData,this):new ISolidElement(t,this.globalData,this)},HybridRenderer.prototype.createNull=SVGRenderer.prototype.createNull,HybridRenderer.prototype.getThreeDContainerByPos=function(t){for(var e=0,r=this.threeDElements.length;e<r;){if(this.threeDElements[e].startPos<=t&&this.threeDElements[e].endPos>=t)return this.threeDElements[e].perspectiveElem;e+=1}return null},HybridRenderer.prototype.createThreeDContainer=function(t,e){var r,i,n=createTag("div");styleDiv(n);var o=createTag("div");if(styleDiv(o),"3d"===e){(r=n.style).width=this.globalData.compSize.w+"px",r.height=this.globalData.compSize.h+"px";var s="50% 50%";r.webkitTransformOrigin=s,r.mozTransformOrigin=s,r.transformOrigin=s;var a="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";(i=o.style).transform=a,i.webkitTransform=a}n.appendChild(o);var l={container:o,perspectiveElem:n,startPos:t,endPos:t,type:e};return this.threeDElements.push(l),l},HybridRenderer.prototype.build3dContainers=function(){var t,e,r=this.layers.length,i="";for(t=0;t<r;t+=1)this.layers[t].ddd&&3!==this.layers[t].ty?("3d"!==i&&(i="3d",e=this.createThreeDContainer(t,"3d")),e.endPos=Math.max(e.endPos,t)):("2d"!==i&&(i="2d",e=this.createThreeDContainer(t,"2d")),e.endPos=Math.max(e.endPos,t));for(t=(r=this.threeDElements.length)-1;t>=0;t-=1)this.resizerElem.appendChild(this.threeDElements[t].perspectiveElem)},HybridRenderer.prototype.addTo3dContainer=function(t,e){for(var r=0,i=this.threeDElements.length;r<i;){if(e<=this.threeDElements[r].endPos){for(var n,o=this.threeDElements[r].startPos;o<e;)this.elements[o]&&this.elements[o].getBaseElement&&(n=this.elements[o].getBaseElement()),o+=1;n?this.threeDElements[r].container.insertBefore(t,n):this.threeDElements[r].container.appendChild(t);break}r+=1}},HybridRenderer.prototype.configAnimation=function(t){var e=createTag("div"),r=this.animationItem.wrapper,i=e.style;i.width=t.w+"px",i.height=t.h+"px",this.resizerElem=e,styleDiv(e),i.transformStyle="flat",i.mozTransformStyle="flat",i.webkitTransformStyle="flat",this.renderConfig.className&&e.setAttribute("class",this.renderConfig.className),r.appendChild(e),i.overflow="hidden";var n=createNS("svg");n.setAttribute("width","1"),n.setAttribute("height","1"),styleDiv(n),this.resizerElem.appendChild(n);var o=createNS("defs");n.appendChild(o),this.data=t,this.setupGlobalData(t,n),this.globalData.defs=o,this.layers=t.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize()},HybridRenderer.prototype.destroy=function(){var t;this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;var e=this.layers?this.layers.length:0;for(t=0;t<e;t+=1)this.elements[t].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},HybridRenderer.prototype.updateContainerSize=function(){var t,e,r,i,n=this.animationItem.wrapper.offsetWidth,o=this.animationItem.wrapper.offsetHeight,s=n/o;this.globalData.compSize.w/this.globalData.compSize.h>s?(t=n/this.globalData.compSize.w,e=n/this.globalData.compSize.w,r=0,i=(o-this.globalData.compSize.h*(n/this.globalData.compSize.w))/2):(t=o/this.globalData.compSize.h,e=o/this.globalData.compSize.h,r=(n-this.globalData.compSize.w*(o/this.globalData.compSize.h))/2,i=0);var a=this.resizerElem.style;a.webkitTransform="matrix3d("+t+",0,0,0,0,"+e+",0,0,0,0,1,0,"+r+","+i+",0,1)",a.transform=a.webkitTransform},HybridRenderer.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRenderer.prototype.hide=function(){this.resizerElem.style.display="none"},HybridRenderer.prototype.show=function(){this.resizerElem.style.display="block"},HybridRenderer.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else{var t,e=this.globalData.compSize.w,r=this.globalData.compSize.h,i=this.threeDElements.length;for(t=0;t<i;t+=1){var n=this.threeDElements[t].perspectiveElem.style;n.webkitPerspective=Math.sqrt(Math.pow(e,2)+Math.pow(r,2))+"px",n.perspective=n.webkitPerspective}}},HybridRenderer.prototype.searchExtraCompositions=function(t){var e,r=t.length,i=createTag("div");for(e=0;e<r;e+=1)if(t[e].xt){var n=this.createComp(t[e],i,this.globalData.comp,null);n.initExpressions(),this.globalData.projectInterface.registerComposition(n)}},MaskElement.prototype.getMaskProperty=function(t){return this.viewData[t].prop},MaskElement.prototype.renderFrame=function(t){var e,r=this.element.finalTransform.mat,i=this.masksProperties.length;for(e=0;e<i;e+=1)if((this.viewData[e].prop._mdf||t)&&this.drawPath(this.masksProperties[e],this.viewData[e].prop.v,this.viewData[e]),(this.viewData[e].op._mdf||t)&&this.viewData[e].elem.setAttribute("fill-opacity",this.viewData[e].op.v),"n"!==this.masksProperties[e].mode&&(this.viewData[e].invRect&&(this.element.finalTransform.mProp._mdf||t)&&this.viewData[e].invRect.setAttribute("transform",r.getInverseMatrix().to2dCSS()),this.storedData[e].x&&(this.storedData[e].x._mdf||t))){var n=this.storedData[e].expan;this.storedData[e].x.v<0?("erode"!==this.storedData[e].lastOperator&&(this.storedData[e].lastOperator="erode",this.storedData[e].elem.setAttribute("filter","url("+locationHref+"#"+this.storedData[e].filterId+")")),n.setAttribute("radius",-this.storedData[e].x.v)):("dilate"!==this.storedData[e].lastOperator&&(this.storedData[e].lastOperator="dilate",this.storedData[e].elem.setAttribute("filter",null)),this.storedData[e].elem.setAttribute("stroke-width",2*this.storedData[e].x.v))}},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var t="M0,0 ";return t+=" h"+this.globalData.compSize.w,t+=" v"+this.globalData.compSize.h,(t+=" h-"+this.globalData.compSize.w)+" v-"+this.globalData.compSize.h+" "},MaskElement.prototype.drawPath=function(t,e,r){var i,n,o=" M"+e.v[0][0]+","+e.v[0][1];for(n=e._length,i=1;i<n;i+=1)o+=" C"+e.o[i-1][0]+","+e.o[i-1][1]+" "+e.i[i][0]+","+e.i[i][1]+" "+e.v[i][0]+","+e.v[i][1];if(e.c&&n>1&&(o+=" C"+e.o[i-1][0]+","+e.o[i-1][1]+" "+e.i[0][0]+","+e.i[0][1]+" "+e.v[0][0]+","+e.v[0][1]),r.lastPath!==o){var s="";r.elem&&(e.c&&(s=t.inv?this.solidPath+o:o),r.elem.setAttribute("d",s)),r.lastPath=o}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null},HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(t){this.hierarchy=t},setAsParent:function(){this._isParent=!0},checkParenting:function(){void 0!==this.data.parent&&this.comp.buildElementParenting(this,this.data.parent,[])}},FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(t,e){var r,i=this.dynamicProperties.length;for(r=0;r<i;r+=1)(e||this._isParent&&"transform"===this.dynamicProperties[r].propType)&&(this.dynamicProperties[r].getValue(),this.dynamicProperties[r]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(t){-1===this.dynamicProperties.indexOf(t)&&this.dynamicProperties.push(t)}},TransformElement.prototype={initTransform:function(){this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_opMdf:!1,mat:new Matrix},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var t,e=this.finalTransform.mat,r=0,i=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;r<i;){if(this.hierarchy[r].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}r+=1}if(this.finalTransform._matMdf)for(t=this.finalTransform.mProp.v.props,e.cloneFromProps(t),r=0;r<i;r+=1)t=this.hierarchy[r].finalTransform.mProp.v.props,e.transform(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}},globalToLocal:function(t){var e=[];e.push(this.finalTransform);for(var r,i=!0,n=this.comp;i;)n.finalTransform?(n.data.hasMask&&e.splice(0,0,n.finalTransform),n=n.comp):i=!1;var o,s=e.length;for(r=0;r<s;r+=1)o=e[r].mat.applyToPointArray(0,0,0),t=[t[0]-o[0],t[1]-o[1],0];return t},mHelper:new Matrix},RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(t){-1===this.renderableComponents.indexOf(t)&&this.renderableComponents.push(t)},removeRenderableComponent:function(t){-1!==this.renderableComponents.indexOf(t)&&this.renderableComponents.splice(this.renderableComponents.indexOf(t),1)},prepareRenderableFrame:function(t){this.checkLayerLimits(t)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(t){this.data.ip-this.data.st<=t&&this.data.op-this.data.st>t?!0!==this.isInRange&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):!1!==this.isInRange&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var t,e=this.renderableComponents.length;for(t=0;t<e;t+=1)this.renderableComponents[t].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return 5===this.data.ty?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}},extendPrototype([RenderableElement,createProxyFunction({initElement:function(t,e,r){this.initFrame(),this.initBaseData(t,e,r),this.initTransform(t,e,r),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){this.hidden||this.isInRange&&!this.isTransparent||((this.baseElement||this.layerElement).style.display="none",this.hidden=!0)},show:function(){this.isInRange&&!this.isTransparent&&(this.data.hd||((this.baseElement||this.layerElement).style.display="block"),this.hidden=!1,this._isFirstFrame=!0)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(t){this._mdf=!1,this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}})],RenderableDOMElement),SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1},SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0},extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData),extendPrototype([DynamicPropertyContainer],SVGFillStyleData),SVGGradientFillStyleData.prototype.initGradientData=function(t,e,r){this.o=PropertyFactory.getProp(t,e.o,0,.01,this),this.s=PropertyFactory.getProp(t,e.s,1,null,this),this.e=PropertyFactory.getProp(t,e.e,1,null,this),this.h=PropertyFactory.getProp(t,e.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(t,e.a||{k:0},0,degToRads,this),this.g=new GradientProperty(t,e.g,this),this.style=r,this.stops=[],this.setGradientData(r.pElem,e),this.setGradientOpacity(e,r),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(t,e){var r=createElementID(),i=createNS(1===e.t?"linearGradient":"radialGradient");i.setAttribute("id",r),i.setAttribute("spreadMethod","pad"),i.setAttribute("gradientUnits","userSpaceOnUse");var n,o,s,a=[];for(s=4*e.g.p,o=0;o<s;o+=4)n=createNS("stop"),i.appendChild(n),a.push(n);t.setAttribute("gf"===e.ty?"fill":"stroke","url("+locationHref+"#"+r+")"),this.gf=i,this.cst=a},SVGGradientFillStyleData.prototype.setGradientOpacity=function(t,e){if(this.g._hasOpacity&&!this.g._collapsable){var r,i,n,o=createNS("mask"),s=createNS("path");o.appendChild(s);var a=createElementID(),l=createElementID();o.setAttribute("id",l);var c=createNS(1===t.t?"linearGradient":"radialGradient");c.setAttribute("id",a),c.setAttribute("spreadMethod","pad"),c.setAttribute("gradientUnits","userSpaceOnUse"),n=t.g.k.k[0].s?t.g.k.k[0].s.length:t.g.k.k.length;var u=this.stops;for(i=4*t.g.p;i<n;i+=2)(r=createNS("stop")).setAttribute("stop-color","rgb(255,255,255)"),c.appendChild(r),u.push(r);s.setAttribute("gf"===t.ty?"fill":"stroke","url("+locationHref+"#"+a+")"),"gs"===t.ty&&(s.setAttribute("stroke-linecap",lineCapEnum[t.lc||2]),s.setAttribute("stroke-linejoin",lineJoinEnum[t.lj||2]),1===t.lj&&s.setAttribute("stroke-miterlimit",t.ml)),this.of=c,this.ms=o,this.ost=u,this.maskId=l,e.msElem=s}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData),extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);var SVGElementsRenderer=function(){var t=new Matrix,e=new Matrix;function r(t,e,r){(r||e.transform.op._mdf)&&e.transform.container.setAttribute("opacity",e.transform.op.v),(r||e.transform.mProps._mdf)&&e.transform.container.setAttribute("transform",e.transform.mProps.v.to2dCSS())}function i(r,i,n){var o,s,a,l,c,u,h,d,p,f,m,g=i.styles.length,y=i.lvl;for(u=0;u<g;u+=1){if(l=i.sh._mdf||n,i.styles[u].lvl<y){for(d=e.reset(),f=y-i.styles[u].lvl,m=i.transformers.length-1;!l&&f>0;)l=i.transformers[m].mProps._mdf||l,f-=1,m-=1;if(l)for(f=y-i.styles[u].lvl,m=i.transformers.length-1;f>0;)p=i.transformers[m].mProps.v.props,d.transform(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8],p[9],p[10],p[11],p[12],p[13],p[14],p[15]),f-=1,m-=1}else d=t;if(s=(h=i.sh.paths)._length,l){for(a="",o=0;o<s;o+=1)(c=h.shapes[o])&&c._length&&(a+=buildShapeString(c,c._length,c.c,d));i.caches[u]=a}else a=i.caches[u];i.styles[u].d+=!0===r.hd?"":a,i.styles[u]._mdf=l||i.styles[u]._mdf}}function n(t,e,r){var i=e.style;(e.c._mdf||r)&&i.pElem.setAttribute("fill","rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||r)&&i.pElem.setAttribute("fill-opacity",e.o.v)}function o(t,e,r){s(t,e,r),a(0,e,r)}function s(t,e,r){var i,n,o,s,a,l=e.gf,c=e.g._hasOpacity,u=e.s.v,h=e.e.v;if(e.o._mdf||r){var d="gf"===t.ty?"fill-opacity":"stroke-opacity";e.style.pElem.setAttribute(d,e.o.v)}if(e.s._mdf||r){var p=1===t.t?"x1":"cx",f="x1"===p?"y1":"cy";l.setAttribute(p,u[0]),l.setAttribute(f,u[1]),c&&!e.g._collapsable&&(e.of.setAttribute(p,u[0]),e.of.setAttribute(f,u[1]))}if(e.g._cmdf||r){i=e.cst;var m=e.g.c;for(o=i.length,n=0;n<o;n+=1)(s=i[n]).setAttribute("offset",m[4*n]+"%"),s.setAttribute("stop-color","rgb("+m[4*n+1]+","+m[4*n+2]+","+m[4*n+3]+")")}if(c&&(e.g._omdf||r)){var g=e.g.o;for(o=(i=e.g._collapsable?e.cst:e.ost).length,n=0;n<o;n+=1)s=i[n],e.g._collapsable||s.setAttribute("offset",g[2*n]+"%"),s.setAttribute("stop-opacity",g[2*n+1])}if(1===t.t)(e.e._mdf||r)&&(l.setAttribute("x2",h[0]),l.setAttribute("y2",h[1]),c&&!e.g._collapsable&&(e.of.setAttribute("x2",h[0]),e.of.setAttribute("y2",h[1])));else if((e.s._mdf||e.e._mdf||r)&&(a=Math.sqrt(Math.pow(u[0]-h[0],2)+Math.pow(u[1]-h[1],2)),l.setAttribute("r",a),c&&!e.g._collapsable&&e.of.setAttribute("r",a)),e.e._mdf||e.h._mdf||e.a._mdf||r){a||(a=Math.sqrt(Math.pow(u[0]-h[0],2)+Math.pow(u[1]-h[1],2)));var y=Math.atan2(h[1]-u[1],h[0]-u[0]),v=e.h.v;v>=1?v=.99:v<=-1&&(v=-.99);var _=a*v,b=Math.cos(y+e.a.v)*_+u[0],x=Math.sin(y+e.a.v)*_+u[1];l.setAttribute("fx",b),l.setAttribute("fy",x),c&&!e.g._collapsable&&(e.of.setAttribute("fx",b),e.of.setAttribute("fy",x))}}function a(t,e,r){var i=e.style,n=e.d;n&&(n._mdf||r)&&n.dashStr&&(i.pElem.setAttribute("stroke-dasharray",n.dashStr),i.pElem.setAttribute("stroke-dashoffset",n.dashoffset[0])),e.c&&(e.c._mdf||r)&&i.pElem.setAttribute("stroke","rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||r)&&i.pElem.setAttribute("stroke-opacity",e.o.v),(e.w._mdf||r)&&(i.pElem.setAttribute("stroke-width",e.w.v),i.msElem&&i.msElem.setAttribute("stroke-width",e.w.v))}return{createRenderFunction:function(t){switch(t.ty){case"fl":return n;case"gf":return s;case"gs":return o;case"st":return a;case"sh":case"el":case"rc":case"sr":return i;case"tr":return r;default:return null}}}}();function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}function CVShapeData(t,e,r,i){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var n,o=4;"rc"===e.ty?o=5:"el"===e.ty?o=6:"sr"===e.ty&&(o=7),this.sh=ShapePropertyFactory.getShapeProp(t,e,o,t);var s,a=r.length;for(n=0;n<a;n+=1)r[n].closed||(s={transforms:i.addTransformSequence(r[n].transforms),trNodes:[]},this.styledShapes.push(s),r[n].elements.push(s))}function BaseElement(){}function NullElement(t,e,r){this.initFrame(),this.initBaseData(t,e,r),this.initFrame(),this.initTransform(t,e,r),this.initHierarchy()}function SVGBaseElement(){}function IShapeElement(){}function ITextElement(){}function ICompElement(){}function IImageElement(t,e,r){this.assetData=e.getAssetData(t.refId),this.initElement(t,e,r),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}function ISolidElement(t,e,r){this.initElement(t,e,r)}function AudioElement(t,e,r){this.initFrame(),this.initRenderable(),this.assetData=e.getAssetData(t.refId),this.initBaseData(t,e,r),this._isPlaying=!1,this._canPlay=!1;var i=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(i),this._currentTime=0,this.globalData.audioController.addAudio(this),this.tm=t.tm?PropertyFactory.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0}}function FootageElement(t,e,r){this.initFrame(),this.initRenderable(),this.assetData=e.getAssetData(t.refId),this.footageData=e.imageLoader.getAsset(this.assetData),this.initBaseData(t,e,r)}function SVGCompElement(t,e,r){this.layers=t.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(t,e,r),this.tm=t.tm?PropertyFactory.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0}}function SVGTextLottieElement(t,e,r){this.textSpans=[],this.renderType="svg",this.initElement(t,e,r)}function SVGShapeElement(t,e,r){this.shapes=[],this.shapesData=t.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(t,e,r),this.prevViewData=[]}function SVGTintFilter(t,e){this.filterManager=e;var r=createNS("feColorMatrix");if(r.setAttribute("type","matrix"),r.setAttribute("color-interpolation-filters","linearRGB"),r.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),r.setAttribute("result","f1"),t.appendChild(r),(r=createNS("feColorMatrix")).setAttribute("type","matrix"),r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),r.setAttribute("result","f2"),t.appendChild(r),this.matrixFilter=r,100!==e.effectElements[2].p.v||e.effectElements[2].p.k){var i,n=createNS("feMerge");t.appendChild(n),(i=createNS("feMergeNode")).setAttribute("in","SourceGraphic"),n.appendChild(i),(i=createNS("feMergeNode")).setAttribute("in","f2"),n.appendChild(i)}}function SVGFillFilter(t,e){this.filterManager=e;var r=createNS("feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),t.appendChild(r),this.matrixFilter=r}function SVGGaussianBlurEffect(t,e){t.setAttribute("x","-100%"),t.setAttribute("y","-100%"),t.setAttribute("width","300%"),t.setAttribute("height","300%"),this.filterManager=e;var r=createNS("feGaussianBlur");t.appendChild(r),this.feGaussianBlur=r}function SVGStrokeEffect(t,e){this.initialized=!1,this.filterManager=e,this.elem=t,this.paths=[]}function SVGTritoneFilter(t,e){this.filterManager=e;var r=createNS("feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("color-interpolation-filters","linearRGB"),r.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),r.setAttribute("result","f1"),t.appendChild(r);var i=createNS("feComponentTransfer");i.setAttribute("color-interpolation-filters","sRGB"),t.appendChild(i),this.matrixFilter=i;var n=createNS("feFuncR");n.setAttribute("type","table"),i.appendChild(n),this.feFuncR=n;var o=createNS("feFuncG");o.setAttribute("type","table"),i.appendChild(o),this.feFuncG=o;var s=createNS("feFuncB");s.setAttribute("type","table"),i.appendChild(s),this.feFuncB=s}function SVGProLevelsFilter(t,e){this.filterManager=e;var r=this.filterManager.effectElements,i=createNS("feComponentTransfer");(r[10].p.k||0!==r[10].p.v||r[11].p.k||1!==r[11].p.v||r[12].p.k||1!==r[12].p.v||r[13].p.k||0!==r[13].p.v||r[14].p.k||1!==r[14].p.v)&&(this.feFuncR=this.createFeFunc("feFuncR",i)),(r[17].p.k||0!==r[17].p.v||r[18].p.k||1!==r[18].p.v||r[19].p.k||1!==r[19].p.v||r[20].p.k||0!==r[20].p.v||r[21].p.k||1!==r[21].p.v)&&(this.feFuncG=this.createFeFunc("feFuncG",i)),(r[24].p.k||0!==r[24].p.v||r[25].p.k||1!==r[25].p.v||r[26].p.k||1!==r[26].p.v||r[27].p.k||0!==r[27].p.v||r[28].p.k||1!==r[28].p.v)&&(this.feFuncB=this.createFeFunc("feFuncB",i)),(r[31].p.k||0!==r[31].p.v||r[32].p.k||1!==r[32].p.v||r[33].p.k||1!==r[33].p.v||r[34].p.k||0!==r[34].p.v||r[35].p.k||1!==r[35].p.v)&&(this.feFuncA=this.createFeFunc("feFuncA",i)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(i.setAttribute("color-interpolation-filters","sRGB"),t.appendChild(i),i=createNS("feComponentTransfer")),(r[3].p.k||0!==r[3].p.v||r[4].p.k||1!==r[4].p.v||r[5].p.k||1!==r[5].p.v||r[6].p.k||0!==r[6].p.v||r[7].p.k||1!==r[7].p.v)&&(i.setAttribute("color-interpolation-filters","sRGB"),t.appendChild(i),this.feFuncRComposed=this.createFeFunc("feFuncR",i),this.feFuncGComposed=this.createFeFunc("feFuncG",i),this.feFuncBComposed=this.createFeFunc("feFuncB",i))}function SVGDropShadowEffect(t,e){var r=e.container.globalData.renderConfig.filterSize;t.setAttribute("x",r.x),t.setAttribute("y",r.y),t.setAttribute("width",r.width),t.setAttribute("height",r.height),this.filterManager=e;var i=createNS("feGaussianBlur");i.setAttribute("in","SourceAlpha"),i.setAttribute("result","drop_shadow_1"),i.setAttribute("stdDeviation","0"),this.feGaussianBlur=i,t.appendChild(i);var n=createNS("feOffset");n.setAttribute("dx","25"),n.setAttribute("dy","0"),n.setAttribute("in","drop_shadow_1"),n.setAttribute("result","drop_shadow_2"),this.feOffset=n,t.appendChild(n);var o=createNS("feFlood");o.setAttribute("flood-color","#00ff00"),o.setAttribute("flood-opacity","1"),o.setAttribute("result","drop_shadow_3"),this.feFlood=o,t.appendChild(o);var s=createNS("feComposite");s.setAttribute("in","drop_shadow_3"),s.setAttribute("in2","drop_shadow_2"),s.setAttribute("operator","in"),s.setAttribute("result","drop_shadow_4"),t.appendChild(s);var a,l=createNS("feMerge");t.appendChild(l),a=createNS("feMergeNode"),l.appendChild(a),(a=createNS("feMergeNode")).setAttribute("in","SourceGraphic"),this.feMergeNode=a,this.feMerge=l,this.originalNodeAdded=!1,l.appendChild(a)}ShapeTransformManager.prototype={addTransformSequence:function(t){var e,r=t.length,i="_";for(e=0;e<r;e+=1)i+=t[e].transform.key+"_";var n=this.sequences[i];return n||(n={transforms:[].concat(t),finalTransform:new Matrix,_mdf:!1},this.sequences[i]=n,this.sequenceList.push(n)),n},processSequence:function(t,e){for(var r,i=0,n=t.transforms.length,o=e;i<n&&!e;){if(t.transforms[i].transform.mProps._mdf){o=!0;break}i+=1}if(o)for(t.finalTransform.reset(),i=n-1;i>=0;i-=1)r=t.transforms[i].transform.mProps.v.props,t.finalTransform.transform(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15]);t._mdf=o},processSequences:function(t){var e,r=this.sequenceList.length;for(e=0;e<r;e+=1)this.processSequence(this.sequenceList[e],t)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}},CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated,BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var t=0,e=this.data.masksProperties.length;t<e;){if("n"!==this.data.masksProperties[t].mode&&!1!==this.data.masksProperties[t].cl)return!0;t+=1}return!1},initExpressions:function(){this.layerInterface=LayerExpressionInterface(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var t=EffectsExpressionInterface.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(t),0===this.data.ty||this.data.xt?this.compInterface=CompExpressionInterface(this):4===this.data.ty?(this.layerInterface.shapeInterface=ShapeExpressionInterface(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):5===this.data.ty&&(this.layerInterface.textInterface=TextExpressionInterface(this),this.layerInterface.text=this.layerInterface.textInterface)},setBlendMode:function(){var t=getBlendMode(this.data.bm);(this.baseElement||this.layerElement).style["mix-blend-mode"]=t},initBaseData:function(t,e,r){this.globalData=e,this.comp=r,this.data=t,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}},NullElement.prototype.prepareFrame=function(t){this.prepareProperties(t,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement),SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var t,e,r,i=null;if(this.data.td){if(3==this.data.td||1==this.data.td){var n=createNS("mask");n.setAttribute("id",this.layerId),n.setAttribute("mask-type",3==this.data.td?"luminance":"alpha"),n.appendChild(this.layerElement),i=n,this.globalData.defs.appendChild(n),featureSupport.maskType||1!=this.data.td||(n.setAttribute("mask-type","luminance"),t=createElementID(),e=filtersFactory.createFilter(t),this.globalData.defs.appendChild(e),e.appendChild(filtersFactory.createAlphaToLuminanceFilter()),(r=createNS("g")).appendChild(this.layerElement),i=r,n.appendChild(r),r.setAttribute("filter","url("+locationHref+"#"+t+")"))}else if(2==this.data.td){var o=createNS("mask");o.setAttribute("id",this.layerId),o.setAttribute("mask-type","alpha");var s=createNS("g");o.appendChild(s),t=createElementID(),e=filtersFactory.createFilter(t);var a=createNS("feComponentTransfer");a.setAttribute("in","SourceGraphic"),e.appendChild(a);var l=createNS("feFuncA");l.setAttribute("type","table"),l.setAttribute("tableValues","1.0 0.0"),a.appendChild(l),this.globalData.defs.appendChild(e);var c=createNS("rect");c.setAttribute("width",this.comp.data.w),c.setAttribute("height",this.comp.data.h),c.setAttribute("x","0"),c.setAttribute("y","0"),c.setAttribute("fill","#ffffff"),c.setAttribute("opacity","0"),s.setAttribute("filter","url("+locationHref+"#"+t+")"),s.appendChild(c),s.appendChild(this.layerElement),i=s,featureSupport.maskType||(o.setAttribute("mask-type","luminance"),e.appendChild(filtersFactory.createAlphaToLuminanceFilter()),r=createNS("g"),s.appendChild(c),r.appendChild(this.layerElement),i=r,s.appendChild(r)),this.globalData.defs.appendChild(o)}}else this.data.tt?(this.matteElement.appendChild(this.layerElement),i=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0===this.data.ty&&!this.data.hd){var u=createNS("clipPath"),h=createNS("path");h.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var d=createElementID();if(u.setAttribute("id",d),u.appendChild(h),this.globalData.defs.appendChild(u),this.checkMasks()){var p=createNS("g");p.setAttribute("clip-path","url("+locationHref+"#"+d+")"),p.appendChild(this.layerElement),this.transformedElement=p,i?i.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+locationHref+"#"+d+")")}0!==this.data.bm&&this.setBlendMode()},renderElement:function(){this.finalTransform._matMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.mat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.mProp.o.v)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this)},setMatte:function(t){this.matteElement&&this.matteElement.setAttribute("mask","url("+locationHref+"#"+t+")")}},IShapeElement.prototype={addShapeToModifiers:function(t){var e,r=this.shapeModifiers.length;for(e=0;e<r;e+=1)this.shapeModifiers[e].addShape(t)},isShapeInAnimatedModifiers:function(t){for(var e=this.shapeModifiers.length;0<e;)if(this.shapeModifiers[0].isAnimatedWithShape(t))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var t,e=this.shapes.length;for(t=0;t<e;t+=1)this.shapes[t].sh.reset();for(t=(e=this.shapeModifiers.length)-1;t>=0&&!this.shapeModifiers[t].processShapes(this._isFirstFrame);t-=1);}},searchProcessedElement:function(t){for(var e=this.processedElements,r=0,i=e.length;r<i;){if(e[r].elem===t)return e[r].pos;r+=1}return 0},addProcessedElement:function(t,e){for(var r=this.processedElements,i=r.length;i;)if(r[i-=1].elem===t)return void(r[i].pos=e);r.push(new ProcessedElement(t,e))},prepareFrame:function(t){this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange)}},ITextElement.prototype.initElement=function(t,e,r){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(t,e,r),this.textProperty=new TextProperty(this,t.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(t.t,this.renderType,this),this.initTransform(t,e,r),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(t){this._mdf=!1,this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange),(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)},ITextElement.prototype.createPathShape=function(t,e){var r,i,n=e.length,o="";for(r=0;r<n;r+=1)i=e[r].ks.k,o+=buildShapeString(i,i.i.length,!0,t);return o},ITextElement.prototype.updateDocumentData=function(t,e){this.textProperty.updateDocumentData(t,e)},ITextElement.prototype.canResizeFont=function(t){this.textProperty.canResizeFont(t)},ITextElement.prototype.setMinimumFontSize=function(t){this.textProperty.setMinimumFontSize(t)},ITextElement.prototype.applyTextPropertiesToMatrix=function(t,e,r,i,n){switch(t.ps&&e.translate(t.ps[0],t.ps[1]+t.ascent,0),e.translate(0,-t.ls,0),t.j){case 1:e.translate(t.justifyOffset+(t.boxWidth-t.lineWidths[r]),0,0);break;case 2:e.translate(t.justifyOffset+(t.boxWidth-t.lineWidths[r])/2,0,0)}e.translate(i,n,0)},ITextElement.prototype.buildColor=function(t){return"rgb("+Math.round(255*t[0])+","+Math.round(255*t[1])+","+Math.round(255*t[2])+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(t,e,r){this.initFrame(),this.initBaseData(t,e,r),this.initTransform(t,e,r),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),!this.data.xt&&e.progressiveLoad||this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(t){if(this._mdf=!1,this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange),this.isInRange||this.data.xt){if(this.tm._placeholder)this.renderedFrame=t/this.data.sr;else{var e=this.tm.v;e===this.data.op&&(e=this.data.op-1),this.renderedFrame=e}var r,i=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),r=i-1;r>=0;r-=1)(this.completeLayers||this.elements[r])&&(this.elements[r].prepareFrame(this.renderedFrame-this.layers[r].st),this.elements[r]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){var t,e=this.layers.length;for(t=0;t<e;t+=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()},ICompElement.prototype.setElements=function(t){this.elements=t},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){var t,e=this.layers.length;for(t=0;t<e;t+=1)this.elements[t]&&this.elements[t].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()},extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var t=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",t),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect},extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var t=createNS("rect");t.setAttribute("width",this.data.sw),t.setAttribute("height",this.data.sh),t.setAttribute("fill",this.data.sc),this.layerElement.appendChild(t)},AudioElement.prototype.prepareFrame=function(t){if(this.prepareRenderableFrame(t,!0),this.prepareProperties(t,!0),this.tm._placeholder)this._currentTime=t/this.data.sr;else{var e=this.tm.v;this._currentTime=e}},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(t){this.audio.rate(t)},AudioElement.prototype.volume=function(t){this.audio.volume(t)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){},FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){this.layerInterface=FootageInterface(this)},FootageElement.prototype.getFootageData=function(){return this.footageData},extendPrototype([SVGRenderer,ICompElement,SVGBaseElement],SVGCompElement),extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(t){for(var e=0,r=t.length,i=[],n="";e<r;)t[e]===String.fromCharCode(13)||t[e]===String.fromCharCode(3)?(i.push(n),n=""):n+=t[e],e+=1;return i.push(n),i},SVGTextLottieElement.prototype.buildNewText=function(){var t,e,r=this.textProperty.currentData;this.renderedLetters=createSizedArray(r?r.l.length:0),r.fc?this.layerElement.setAttribute("fill",this.buildColor(r.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),r.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(r.sc)),this.layerElement.setAttribute("stroke-width",r.sw)),this.layerElement.setAttribute("font-size",r.finalSize);var i=this.globalData.fontManager.getFontByName(r.f);if(i.fClass)this.layerElement.setAttribute("class",i.fClass);else{this.layerElement.setAttribute("font-family",i.fFamily);var n=r.fWeight,o=r.fStyle;this.layerElement.setAttribute("font-style",o),this.layerElement.setAttribute("font-weight",n)}this.layerElement.setAttribute("aria-label",r.t);var s,a=r.l||[],l=!!this.globalData.fontManager.chars;e=a.length;var c,u=this.mHelper,h="",d=this.data.singleShape,p=0,f=0,m=!0,g=.001*r.tr*r.finalSize;if(!d||l||r.sz){var y,v,_=this.textSpans.length;for(t=0;t<e;t+=1)l&&d&&0!==t||(s=_>t?this.textSpans[t]:createNS(l?"path":"text"),_<=t&&(s.setAttribute("stroke-linecap","butt"),s.setAttribute("stroke-linejoin","round"),s.setAttribute("stroke-miterlimit","4"),this.textSpans[t]=s,this.layerElement.appendChild(s)),s.style.display="inherit"),u.reset(),u.scale(r.finalSize/100,r.finalSize/100),d&&(a[t].n&&(p=-g,f+=r.yOffset,f+=m?1:0,m=!1),this.applyTextPropertiesToMatrix(r,u,a[t].line,p,f),p+=a[t].l||0,p+=g),l?(c=(y=(v=this.globalData.fontManager.getCharData(r.finalText[t],i.fStyle,this.globalData.fontManager.getFontByName(r.f).fFamily))&&v.data||{}).shapes?y.shapes[0].it:[],d?h+=this.createPathShape(u,c):s.setAttribute("d",this.createPathShape(u,c))):(d&&s.setAttribute("transform","translate("+u.props[12]+","+u.props[13]+")"),s.textContent=a[t].val,s.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"));d&&s&&s.setAttribute("d",h)}else{var b=this.textContainer,x="start";switch(r.j){case 1:x="end";break;case 2:x="middle";break;default:x="start"}b.setAttribute("text-anchor",x),b.setAttribute("letter-spacing",g);var w=this.buildTextContents(r.finalText);for(e=w.length,f=r.ps?r.ps[1]+r.ascent:0,t=0;t<e;t+=1)(s=this.textSpans[t]||createNS("tspan")).textContent=w[t],s.setAttribute("x",0),s.setAttribute("y",f),s.style.display="inherit",b.appendChild(s),this.textSpans[t]=s,f+=r.finalLineHeight;this.layerElement.appendChild(b)}for(;t<this.textSpans.length;)this.textSpans[t].style.display="none",t+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var t=this.layerElement.getBBox();this.bbox={top:t.y,left:t.x,width:t.width,height:t.height}}return this.bbox},SVGTextLottieElement.prototype.renderInnerContent=function(){if(!this.data.singleShape&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){var t,e;this._sizeChanged=!0;var r,i,n=this.textAnimator.renderedLetters,o=this.textProperty.currentData.l;for(e=o.length,t=0;t<e;t+=1)o[t].n||(r=n[t],i=this.textSpans[t],r._mdf.m&&i.setAttribute("transform",r.m),r._mdf.o&&i.setAttribute("opacity",r.o),r._mdf.sw&&i.setAttribute("stroke-width",r.sw),r._mdf.sc&&i.setAttribute("stroke",r.sc),r._mdf.fc&&i.setAttribute("fill",r.fc))}},extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){var t,e,r,i,n=this.shapes.length,o=this.stylesList.length,s=[],a=!1;for(r=0;r<o;r+=1){for(i=this.stylesList[r],a=!1,s.length=0,t=0;t<n;t+=1)-1!==(e=this.shapes[t]).styles.indexOf(i)&&(s.push(e),a=e._isAnimated||a);s.length>1&&a&&this.setShapesAsAnimated(s)}},SVGShapeElement.prototype.setShapesAsAnimated=function(t){var e,r=t.length;for(e=0;e<r;e+=1)t[e].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(t,e){var r,i=new SVGStyleData(t,e),n=i.pElem;return"st"===t.ty?r=new SVGStrokeStyleData(this,t,i):"fl"===t.ty?r=new SVGFillStyleData(this,t,i):"gf"!==t.ty&&"gs"!==t.ty||(r=new("gf"===t.ty?SVGGradientFillStyleData:SVGGradientStrokeStyleData)(this,t,i),this.globalData.defs.appendChild(r.gf),r.maskId&&(this.globalData.defs.appendChild(r.ms),this.globalData.defs.appendChild(r.of),n.setAttribute("mask","url("+locationHref+"#"+r.maskId+")"))),"st"!==t.ty&&"gs"!==t.ty||(n.setAttribute("stroke-linecap",lineCapEnum[t.lc||2]),n.setAttribute("stroke-linejoin",lineJoinEnum[t.lj||2]),n.setAttribute("fill-opacity","0"),1===t.lj&&n.setAttribute("stroke-miterlimit",t.ml)),2===t.r&&n.setAttribute("fill-rule","evenodd"),t.ln&&n.setAttribute("id",t.ln),t.cl&&n.setAttribute("class",t.cl),t.bm&&(n.style["mix-blend-mode"]=getBlendMode(t.bm)),this.stylesList.push(i),this.addToAnimatedContents(t,r),r},SVGShapeElement.prototype.createGroupElement=function(t){var e=new ShapeGroupData;return t.ln&&e.gr.setAttribute("id",t.ln),t.cl&&e.gr.setAttribute("class",t.cl),t.bm&&(e.gr.style["mix-blend-mode"]=getBlendMode(t.bm)),e},SVGShapeElement.prototype.createTransformElement=function(t,e){var r=TransformPropertyFactory.getTransformProperty(this,t,this),i=new SVGTransformData(r,r.o,e);return this.addToAnimatedContents(t,i),i},SVGShapeElement.prototype.createShapeElement=function(t,e,r){var i=4;"rc"===t.ty?i=5:"el"===t.ty?i=6:"sr"===t.ty&&(i=7);var n=new SVGShapeData(e,r,ShapePropertyFactory.getShapeProp(this,t,i,this));return this.shapes.push(n),this.addShapeToModifiers(n),this.addToAnimatedContents(t,n),n},SVGShapeElement.prototype.addToAnimatedContents=function(t,e){for(var r=0,i=this.animatedContents.length;r<i;){if(this.animatedContents[r].element===e)return;r+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(t),element:e,data:t})},SVGShapeElement.prototype.setElementStyles=function(t){var e,r=t.styles,i=this.stylesList.length;for(e=0;e<i;e+=1)this.stylesList[e].closed||r.push(this.stylesList[e])},SVGShapeElement.prototype.reloadShapes=function(){var t;this._isFirstFrame=!0;var e=this.itemsData.length;for(t=0;t<e;t+=1)this.prevViewData[t]=this.itemsData[t];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),e=this.dynamicProperties.length,t=0;t<e;t+=1)this.dynamicProperties[t].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(t,e,r,i,n,o,s){var a,l,c,u,h,d,p=[].concat(o),f=t.length-1,m=[],g=[];for(a=f;a>=0;a-=1){if((d=this.searchProcessedElement(t[a]))?e[a]=r[d-1]:t[a]._render=s,"fl"===t[a].ty||"st"===t[a].ty||"gf"===t[a].ty||"gs"===t[a].ty)d?e[a].style.closed=!1:e[a]=this.createStyleElement(t[a],n),t[a]._render&&e[a].style.pElem.parentNode!==i&&i.appendChild(e[a].style.pElem),m.push(e[a].style);else if("gr"===t[a].ty){if(d)for(c=e[a].it.length,l=0;l<c;l+=1)e[a].prevViewData[l]=e[a].it[l];else e[a]=this.createGroupElement(t[a]);this.searchShapes(t[a].it,e[a].it,e[a].prevViewData,e[a].gr,n+1,p,s),t[a]._render&&e[a].gr.parentNode!==i&&i.appendChild(e[a].gr)}else"tr"===t[a].ty?(d||(e[a]=this.createTransformElement(t[a],i)),u=e[a].transform,p.push(u)):"sh"===t[a].ty||"rc"===t[a].ty||"el"===t[a].ty||"sr"===t[a].ty?(d||(e[a]=this.createShapeElement(t[a],p,n)),this.setElementStyles(e[a])):"tm"===t[a].ty||"rd"===t[a].ty||"ms"===t[a].ty||"pb"===t[a].ty?(d?(h=e[a]).closed=!1:((h=ShapeModifiers.getModifier(t[a].ty)).init(this,t[a]),e[a]=h,this.shapeModifiers.push(h)),g.push(h)):"rp"===t[a].ty&&(d?(h=e[a]).closed=!0:(h=ShapeModifiers.getModifier(t[a].ty),e[a]=h,h.init(this,t,a,e),this.shapeModifiers.push(h),s=!1),g.push(h));this.addProcessedElement(t[a],a+1)}for(f=m.length,a=0;a<f;a+=1)m[a].closed=!0;for(f=g.length,a=0;a<f;a+=1)g[a].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){var t;this.renderModifiers();var e=this.stylesList.length;for(t=0;t<e;t+=1)this.stylesList[t].reset();for(this.renderShape(),t=0;t<e;t+=1)(this.stylesList[t]._mdf||this._isFirstFrame)&&(this.stylesList[t].msElem&&(this.stylesList[t].msElem.setAttribute("d",this.stylesList[t].d),this.stylesList[t].d="M0 0"+this.stylesList[t].d),this.stylesList[t].pElem.setAttribute("d",this.stylesList[t].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){var t,e,r=this.animatedContents.length;for(t=0;t<r;t+=1)e=this.animatedContents[t],(this._isFirstFrame||e.element._isAnimated)&&!0!==e.data&&e.fn(e.data,e.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null},SVGTintFilter.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e=this.filterManager.effectElements[0].p.v,r=this.filterManager.effectElements[1].p.v,i=this.filterManager.effectElements[2].p.v/100;this.matrixFilter.setAttribute("values",r[0]-e[0]+" 0 0 0 "+e[0]+" "+(r[1]-e[1])+" 0 0 0 "+e[1]+" "+(r[2]-e[2])+" 0 0 0 "+e[2]+" 0 0 0 "+i+" 0")}},SVGFillFilter.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e=this.filterManager.effectElements[2].p.v,r=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+e[0]+" 0 0 0 0 "+e[1]+" 0 0 0 0 "+e[2]+" 0 0 0 "+r+" 0")}},SVGGaussianBlurEffect.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e=.3*this.filterManager.effectElements[0].p.v,r=this.filterManager.effectElements[1].p.v,i=3==r?0:e,n=2==r?0:e;this.feGaussianBlur.setAttribute("stdDeviation",i+" "+n);var o=1==this.filterManager.effectElements[2].p.v?"wrap":"duplicate";this.feGaussianBlur.setAttribute("edgeMode",o)}},SVGStrokeEffect.prototype.initialize=function(){var t,e,r,i,n=this.elem.layerElement.children||this.elem.layerElement.childNodes;for(1===this.filterManager.effectElements[1].p.v?(i=this.elem.maskManager.masksProperties.length,r=0):i=1+(r=this.filterManager.effectElements[0].p.v-1),(e=createNS("g")).setAttribute("fill","none"),e.setAttribute("stroke-linecap","round"),e.setAttribute("stroke-dashoffset",1);r<i;r+=1)t=createNS("path"),e.appendChild(t),this.paths.push({p:t,m:r});if(3===this.filterManager.effectElements[10].p.v){var o=createNS("mask"),s=createElementID();o.setAttribute("id",s),o.setAttribute("mask-type","alpha"),o.appendChild(e),this.elem.globalData.defs.appendChild(o);var a=createNS("g");for(a.setAttribute("mask","url("+locationHref+"#"+s+")");n[0];)a.appendChild(n[0]);this.elem.layerElement.appendChild(a),this.masker=o,e.setAttribute("stroke","#fff")}else if(1===this.filterManager.effectElements[10].p.v||2===this.filterManager.effectElements[10].p.v){if(2===this.filterManager.effectElements[10].p.v)for(n=this.elem.layerElement.children||this.elem.layerElement.childNodes;n.length;)this.elem.layerElement.removeChild(n[0]);this.elem.layerElement.appendChild(e),this.elem.layerElement.removeAttribute("mask"),e.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=e},SVGStrokeEffect.prototype.renderFrame=function(t){var e;this.initialized||this.initialize();var r,i,n=this.paths.length;for(e=0;e<n;e+=1)if(-1!==this.paths[e].m&&(r=this.elem.maskManager.viewData[this.paths[e].m],i=this.paths[e].p,(t||this.filterManager._mdf||r.prop._mdf)&&i.setAttribute("d",r.lastPath),t||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||r.prop._mdf)){var o;if(0!==this.filterManager.effectElements[7].p.v||100!==this.filterManager.effectElements[8].p.v){var s=.01*Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v),a=.01*Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v),l=i.getTotalLength();o="0 0 0 "+l*s+" ";var c,u=l*(a-s),h=1+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01,d=Math.floor(u/h);for(c=0;c<d;c+=1)o+="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01+" ";o+="0 "+10*l+" 0 0"}else o="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01;i.setAttribute("stroke-dasharray",o)}if((t||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",2*this.filterManager.effectElements[4].p.v),(t||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(1===this.filterManager.effectElements[10].p.v||2===this.filterManager.effectElements[10].p.v)&&(t||this.filterManager.effectElements[3].p._mdf)){var p=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+bmFloor(255*p[0])+","+bmFloor(255*p[1])+","+bmFloor(255*p[2])+")")}},SVGTritoneFilter.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e=this.filterManager.effectElements[0].p.v,r=this.filterManager.effectElements[1].p.v,i=this.filterManager.effectElements[2].p.v,n=i[0]+" "+r[0]+" "+e[0],o=i[1]+" "+r[1]+" "+e[1],s=i[2]+" "+r[2]+" "+e[2];this.feFuncR.setAttribute("tableValues",n),this.feFuncG.setAttribute("tableValues",o),this.feFuncB.setAttribute("tableValues",s)}},SVGProLevelsFilter.prototype.createFeFunc=function(t,e){var r=createNS(t);return r.setAttribute("type","table"),e.appendChild(r),r},SVGProLevelsFilter.prototype.getTableValue=function(t,e,r,i,n){for(var o,s,a=0,l=Math.min(t,e),c=Math.max(t,e),u=Array.call(null,{length:256}),h=0,d=n-i,p=e-t;a<=256;)s=(o=a/256)<=l?p<0?n:i:o>=c?p<0?i:n:i+d*Math.pow((o-t)/p,1/r),u[h]=s,h+=1,a+=256/255;return u.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e,r=this.filterManager.effectElements;this.feFuncRComposed&&(t||r[3].p._mdf||r[4].p._mdf||r[5].p._mdf||r[6].p._mdf||r[7].p._mdf)&&(e=this.getTableValue(r[3].p.v,r[4].p.v,r[5].p.v,r[6].p.v,r[7].p.v),this.feFuncRComposed.setAttribute("tableValues",e),this.feFuncGComposed.setAttribute("tableValues",e),this.feFuncBComposed.setAttribute("tableValues",e)),this.feFuncR&&(t||r[10].p._mdf||r[11].p._mdf||r[12].p._mdf||r[13].p._mdf||r[14].p._mdf)&&(e=this.getTableValue(r[10].p.v,r[11].p.v,r[12].p.v,r[13].p.v,r[14].p.v),this.feFuncR.setAttribute("tableValues",e)),this.feFuncG&&(t||r[17].p._mdf||r[18].p._mdf||r[19].p._mdf||r[20].p._mdf||r[21].p._mdf)&&(e=this.getTableValue(r[17].p.v,r[18].p.v,r[19].p.v,r[20].p.v,r[21].p.v),this.feFuncG.setAttribute("tableValues",e)),this.feFuncB&&(t||r[24].p._mdf||r[25].p._mdf||r[26].p._mdf||r[27].p._mdf||r[28].p._mdf)&&(e=this.getTableValue(r[24].p.v,r[25].p.v,r[26].p.v,r[27].p.v,r[28].p.v),this.feFuncB.setAttribute("tableValues",e)),this.feFuncA&&(t||r[31].p._mdf||r[32].p._mdf||r[33].p._mdf||r[34].p._mdf||r[35].p._mdf)&&(e=this.getTableValue(r[31].p.v,r[32].p.v,r[33].p.v,r[34].p.v,r[35].p.v),this.feFuncA.setAttribute("tableValues",e))}},SVGDropShadowEffect.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){if((t||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),t||this.filterManager.effectElements[0].p._mdf){var e=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(255*e[0]),Math.round(255*e[1]),Math.round(255*e[2])))}if((t||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),t||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var r=this.filterManager.effectElements[3].p.v,i=(this.filterManager.effectElements[2].p.v-90)*degToRads,n=r*Math.cos(i),o=r*Math.sin(i);this.feOffset.setAttribute("dx",n),this.feOffset.setAttribute("dy",o)}}};var _svgMatteSymbols=[];function SVGMatte3Effect(t,e,r){this.initialized=!1,this.filterManager=e,this.filterElem=t,this.elem=r,r.matteElement=createNS("g"),r.matteElement.appendChild(r.layerElement),r.matteElement.appendChild(r.transformedElement),r.baseElement=r.matteElement}function SVGEffects(t){var e,r,i=t.data.ef?t.data.ef.length:0,n=createElementID(),o=filtersFactory.createFilter(n,!0),s=0;for(this.filters=[],e=0;e<i;e+=1)r=null,20===t.data.ef[e].ty?(s+=1,r=new SVGTintFilter(o,t.effectsManager.effectElements[e])):21===t.data.ef[e].ty?(s+=1,r=new SVGFillFilter(o,t.effectsManager.effectElements[e])):22===t.data.ef[e].ty?r=new SVGStrokeEffect(t,t.effectsManager.effectElements[e]):23===t.data.ef[e].ty?(s+=1,r=new SVGTritoneFilter(o,t.effectsManager.effectElements[e])):24===t.data.ef[e].ty?(s+=1,r=new SVGProLevelsFilter(o,t.effectsManager.effectElements[e])):25===t.data.ef[e].ty?(s+=1,r=new SVGDropShadowEffect(o,t.effectsManager.effectElements[e])):28===t.data.ef[e].ty?r=new SVGMatte3Effect(o,t.effectsManager.effectElements[e],t):29===t.data.ef[e].ty&&(s+=1,r=new SVGGaussianBlurEffect(o,t.effectsManager.effectElements[e])),r&&this.filters.push(r);s&&(t.globalData.defs.appendChild(o),t.layerElement.setAttribute("filter","url("+locationHref+"#"+n+")")),this.filters.length&&t.addRenderableComponent(this)}function CVContextData(){var t;for(this.saved=[],this.cArrPos=0,this.cTr=new Matrix,this.cO=1,this.savedOp=createTypedArray("float32",15),t=0;t<15;t+=1)this.saved[t]=createTypedArray("float32",16);this._length=15}function CVBaseElement(){}function CVImageElement(t,e,r){this.assetData=e.getAssetData(t.refId),this.img=e.imageLoader.getAsset(this.assetData),this.initElement(t,e,r)}function CVCompElement(t,e,r){this.completeLayers=!1,this.layers=t.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(t,e,r),this.tm=t.tm?PropertyFactory.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0}}function CVMaskElement(t,e){var r;this.data=t,this.element=e,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var i=this.masksProperties.length,n=!1;for(r=0;r<i;r+=1)"n"!==this.masksProperties[r].mode&&(n=!0),this.viewData[r]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[r],3);this.hasMasks=n,n&&this.element.addRenderableComponent(this)}function CVShapeElement(t,e,r){this.shapes=[],this.shapesData=t.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(t,e,r)}function CVSolidElement(t,e,r){this.initElement(t,e,r)}function CVTextElement(t,e,r){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(t,e,r)}function CVEffects(){}function HBaseElement(){}function HSolidElement(t,e,r){this.initElement(t,e,r)}function HCompElement(t,e,r){this.layers=t.layers,this.supports3d=!t.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(t,e,r),this.tm=t.tm?PropertyFactory.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0}}function HShapeElement(t,e,r){this.shapes=[],this.shapesData=t.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(t,e,r),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0}}function HTextElement(t,e,r){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(t,e,r)}function HImageElement(t,e,r){this.assetData=e.getAssetData(t.refId),this.initElement(t,e,r)}function HCameraElement(t,e,r){this.initFrame(),this.initBaseData(t,e,r),this.initHierarchy();var i=PropertyFactory.getProp;if(this.pe=i(this,t.pe,0,0,this),t.ks.p.s?(this.px=i(this,t.ks.p.x,1,0,this),this.py=i(this,t.ks.p.y,1,0,this),this.pz=i(this,t.ks.p.z,1,0,this)):this.p=i(this,t.ks.p,1,0,this),t.ks.a&&(this.a=i(this,t.ks.a,1,0,this)),t.ks.or.k.length&&t.ks.or.k[0].to){var n,o=t.ks.or.k.length;for(n=0;n<o;n+=1)t.ks.or.k[n].to=null,t.ks.or.k[n].ti=null}this.or=i(this,t.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=i(this,t.ks.rx,0,degToRads,this),this.ry=i(this,t.ks.ry,0,degToRads,this),this.rz=i(this,t.ks.rz,0,degToRads,this),this.mat=new Matrix,this._prevMat=new Matrix,this._isFirstFrame=!0,this.finalTransform={mProp:this}}function HEffects(){}SVGMatte3Effect.prototype.findSymbol=function(t){for(var e=0,r=_svgMatteSymbols.length;e<r;){if(_svgMatteSymbols[e]===t)return _svgMatteSymbols[e];e+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(t,e){var r=t.layerElement.parentNode;if(r){for(var i,n=r.children,o=0,s=n.length;o<s&&n[o]!==t.layerElement;)o+=1;o<=s-2&&(i=n[o+1]);var a=createNS("use");a.setAttribute("href","#"+e),i?r.insertBefore(a,i):r.appendChild(a)}},SVGMatte3Effect.prototype.setElementAsMask=function(t,e){if(!this.findSymbol(e)){var r=createElementID(),i=createNS("mask");i.setAttribute("id",e.layerId),i.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(e);var n=t.globalData.defs;n.appendChild(i);var o=createNS("symbol");o.setAttribute("id",r),this.replaceInParent(e,r),o.appendChild(e.layerElement),n.appendChild(o);var s=createNS("use");s.setAttribute("href","#"+r),i.appendChild(s),e.data.hd=!1,e.show()}t.setMatte(e.layerId)},SVGMatte3Effect.prototype.initialize=function(){for(var t=this.filterManager.effectElements[0].p.v,e=this.elem.comp.elements,r=0,i=e.length;r<i;)e[r]&&e[r].data.ind===t&&this.setElementAsMask(this.elem,e[r]),r+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()},SVGEffects.prototype.renderFrame=function(t){var e,r=this.filters.length;for(e=0;e<r;e+=1)this.filters[e].renderFrame(t)},CVContextData.prototype.duplicate=function(){var t=2*this._length,e=this.savedOp;this.savedOp=createTypedArray("float32",t),this.savedOp.set(e);var r=0;for(r=this._length;r<t;r+=1)this.saved[r]=createTypedArray("float32",16);this._length=t},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.cO=1},CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){this.canvasContext=this.globalData.canvasContext,this.renderableEffectsManager=new CVEffects(this)},createContent:function(){},setBlendMode:function(){var t=this.globalData;if(t.blendMode!==this.data.bm){t.blendMode=this.data.bm;var e=getBlendMode(this.data.bm);t.canvasContext.globalCompositeOperation=e}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this)},hideElement:function(){this.hidden||this.isInRange&&!this.isTransparent||(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},renderFrame:function(){if(!this.hidden&&!this.data.hd){this.renderTransform(),this.renderRenderable(),this.setBlendMode();var t=0===this.data.ty;this.globalData.renderer.save(t),this.globalData.renderer.ctxTransform(this.finalTransform.mat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.mProp.o.v),this.renderInnerContent(),this.globalData.renderer.restore(t),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1)}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement,extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var t=createTag("canvas");t.width=this.assetData.w,t.height=this.assetData.h;var e,r,i=t.getContext("2d"),n=this.img.width,o=this.img.height,s=n/o,a=this.assetData.w/this.assetData.h,l=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;s>a&&"xMidYMid slice"===l||s<a&&"xMidYMid slice"!==l?e=(r=o)*a:r=(e=n)/a,i.drawImage(this.img,(n-e)/2,(o-r)/2,e,r,0,0,this.assetData.w,this.assetData.h),this.img=t}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null},extendPrototype([CanvasRenderer,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var t,e=this.canvasContext;for(e.beginPath(),e.moveTo(0,0),e.lineTo(this.data.w,0),e.lineTo(this.data.w,this.data.h),e.lineTo(0,this.data.h),e.lineTo(0,0),e.clip(),t=this.layers.length-1;t>=0;t-=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()},CVCompElement.prototype.destroy=function(){var t;for(t=this.layers.length-1;t>=0;t-=1)this.elements[t]&&this.elements[t].destroy();this.layers=null,this.elements=null},CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var t,e,r,i,n=this.element.finalTransform.mat,o=this.element.canvasContext,s=this.masksProperties.length;for(o.beginPath(),t=0;t<s;t+=1)if("n"!==this.masksProperties[t].mode){var a;this.masksProperties[t].inv&&(o.moveTo(0,0),o.lineTo(this.element.globalData.compSize.w,0),o.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),o.lineTo(0,this.element.globalData.compSize.h),o.lineTo(0,0)),i=this.viewData[t].v,e=n.applyToPointArray(i.v[0][0],i.v[0][1],0),o.moveTo(e[0],e[1]);var l=i._length;for(a=1;a<l;a+=1)r=n.applyToTriplePoints(i.o[a-1],i.i[a],i.v[a]),o.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);r=n.applyToTriplePoints(i.o[a-1],i.i[0],i.v[0]),o.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5])}this.element.globalData.renderer.save(!0),o.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null},extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(t,e){var r={data:t,type:t.ty,preTransforms:this.transformsManager.addTransformSequence(e),transforms:[],elements:[],closed:!0===t.hd},i={};if("fl"===t.ty||"st"===t.ty?(i.c=PropertyFactory.getProp(this,t.c,1,255,this),i.c.k||(r.co="rgb("+bmFloor(i.c.v[0])+","+bmFloor(i.c.v[1])+","+bmFloor(i.c.v[2])+")")):"gf"!==t.ty&&"gs"!==t.ty||(i.s=PropertyFactory.getProp(this,t.s,1,null,this),i.e=PropertyFactory.getProp(this,t.e,1,null,this),i.h=PropertyFactory.getProp(this,t.h||{k:0},0,.01,this),i.a=PropertyFactory.getProp(this,t.a||{k:0},0,degToRads,this),i.g=new GradientProperty(this,t.g,this)),i.o=PropertyFactory.getProp(this,t.o,0,.01,this),"st"===t.ty||"gs"===t.ty){if(r.lc=lineCapEnum[t.lc||2],r.lj=lineJoinEnum[t.lj||2],1==t.lj&&(r.ml=t.ml),i.w=PropertyFactory.getProp(this,t.w,0,null,this),i.w.k||(r.wi=i.w.v),t.d){var n=new DashProperty(this,t.d,"canvas",this);i.d=n,i.d.k||(r.da=i.d.dashArray,r.do=i.d.dashoffset[0])}}else r.r=2===t.r?"evenodd":"nonzero";return this.stylesList.push(r),i.style=r,i},CVShapeElement.prototype.createGroupElement=function(){return{it:[],prevViewData:[]}},CVShapeElement.prototype.createTransformElement=function(t){return{transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,t.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,t,this)}}},CVShapeElement.prototype.createShapeElement=function(t){var e=new CVShapeData(this,t,this.stylesList,this.transformsManager);return this.shapes.push(e),this.addShapeToModifiers(e),e},CVShapeElement.prototype.reloadShapes=function(){var t;this._isFirstFrame=!0;var e=this.itemsData.length;for(t=0;t<e;t+=1)this.prevViewData[t]=this.itemsData[t];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),e=this.dynamicProperties.length,t=0;t<e;t+=1)this.dynamicProperties[t].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(t){var e,r=this.stylesList.length;for(e=0;e<r;e+=1)this.stylesList[e].closed||this.stylesList[e].transforms.push(t)},CVShapeElement.prototype.removeTransformFromStyleList=function(){var t,e=this.stylesList.length;for(t=0;t<e;t+=1)this.stylesList[t].closed||this.stylesList[t].transforms.pop()},CVShapeElement.prototype.closeStyles=function(t){var e,r=t.length;for(e=0;e<r;e+=1)t[e].closed=!0},CVShapeElement.prototype.searchShapes=function(t,e,r,i,n){var o,s,a,l,c,u,h=t.length-1,d=[],p=[],f=[].concat(n);for(o=h;o>=0;o-=1){if((l=this.searchProcessedElement(t[o]))?e[o]=r[l-1]:t[o]._shouldRender=i,"fl"===t[o].ty||"st"===t[o].ty||"gf"===t[o].ty||"gs"===t[o].ty)l?e[o].style.closed=!1:e[o]=this.createStyleElement(t[o],f),d.push(e[o].style);else if("gr"===t[o].ty){if(l)for(a=e[o].it.length,s=0;s<a;s+=1)e[o].prevViewData[s]=e[o].it[s];else e[o]=this.createGroupElement(t[o]);this.searchShapes(t[o].it,e[o].it,e[o].prevViewData,i,f)}else"tr"===t[o].ty?(l||(u=this.createTransformElement(t[o]),e[o]=u),f.push(e[o]),this.addTransformToStyleList(e[o])):"sh"===t[o].ty||"rc"===t[o].ty||"el"===t[o].ty||"sr"===t[o].ty?l||(e[o]=this.createShapeElement(t[o])):"tm"===t[o].ty||"rd"===t[o].ty||"pb"===t[o].ty?(l?(c=e[o]).closed=!1:((c=ShapeModifiers.getModifier(t[o].ty)).init(this,t[o]),e[o]=c,this.shapeModifiers.push(c)),p.push(c)):"rp"===t[o].ty&&(l?(c=e[o]).closed=!0:(c=ShapeModifiers.getModifier(t[o].ty),e[o]=c,c.init(this,t,o,e),this.shapeModifiers.push(c),i=!1),p.push(c));this.addProcessedElement(t[o],o+1)}for(this.removeTransformFromStyleList(),this.closeStyles(d),h=p.length,o=0;o<h;o+=1)p[o].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(t,e){(t._opMdf||e.op._mdf||this._isFirstFrame)&&(e.opacity=t.opacity,e.opacity*=e.op.v,e._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){var t,e,r,i,n,o,s,a,l,c=this.stylesList.length,u=this.globalData.renderer,h=this.globalData.canvasContext;for(t=0;t<c;t+=1)if(("st"!==(a=(l=this.stylesList[t]).type)&&"gs"!==a||0!==l.wi)&&l.data._shouldRender&&0!==l.coOp&&0!==this.globalData.currentGlobalAlpha){for(u.save(),o=l.elements,"st"===a||"gs"===a?(h.strokeStyle="st"===a?l.co:l.grd,h.lineWidth=l.wi,h.lineCap=l.lc,h.lineJoin=l.lj,h.miterLimit=l.ml||0):h.fillStyle="fl"===a?l.co:l.grd,u.ctxOpacity(l.coOp),"st"!==a&&"gs"!==a&&h.beginPath(),u.ctxTransform(l.preTransforms.finalTransform.props),r=o.length,e=0;e<r;e+=1){for("st"!==a&&"gs"!==a||(h.beginPath(),l.da&&(h.setLineDash(l.da),h.lineDashOffset=l.do)),n=(s=o[e].trNodes).length,i=0;i<n;i+=1)"m"===s[i].t?h.moveTo(s[i].p[0],s[i].p[1]):"c"===s[i].t?h.bezierCurveTo(s[i].pts[0],s[i].pts[1],s[i].pts[2],s[i].pts[3],s[i].pts[4],s[i].pts[5]):h.closePath();"st"!==a&&"gs"!==a||(h.stroke(),l.da&&h.setLineDash(this.dashResetter))}"st"!==a&&"gs"!==a&&h.fill(l.r),u.restore()}},CVShapeElement.prototype.renderShape=function(t,e,r,i){var n,o;for(o=t,n=e.length-1;n>=0;n-=1)"tr"===e[n].ty?(o=r[n].transform,this.renderShapeTransform(t,o)):"sh"===e[n].ty||"el"===e[n].ty||"rc"===e[n].ty||"sr"===e[n].ty?this.renderPath(e[n],r[n]):"fl"===e[n].ty?this.renderFill(e[n],r[n],o):"st"===e[n].ty?this.renderStroke(e[n],r[n],o):"gf"===e[n].ty||"gs"===e[n].ty?this.renderGradientFill(e[n],r[n],o):"gr"===e[n].ty?this.renderShape(o,e[n].it,r[n].it):e[n].ty;i&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(t,e){if(this._isFirstFrame||e._mdf||t.transforms._mdf){var r,i,n,o=t.trNodes,s=e.paths,a=s._length;o.length=0;var l=t.transforms.finalTransform;for(n=0;n<a;n+=1){var c=s.shapes[n];if(c&&c.v){for(i=c._length,r=1;r<i;r+=1)1===r&&o.push({t:"m",p:l.applyToPointArray(c.v[0][0],c.v[0][1],0)}),o.push({t:"c",pts:l.applyToTriplePoints(c.o[r-1],c.i[r],c.v[r])});1===i&&o.push({t:"m",p:l.applyToPointArray(c.v[0][0],c.v[0][1],0)}),c.c&&i&&(o.push({t:"c",pts:l.applyToTriplePoints(c.o[r-1],c.i[0],c.v[0])}),o.push({t:"z"}))}}t.trNodes=o}},CVShapeElement.prototype.renderPath=function(t,e){if(!0!==t.hd&&t._shouldRender){var r,i=e.styledShapes.length;for(r=0;r<i;r+=1)this.renderStyledShape(e.styledShapes[r],e.sh)}},CVShapeElement.prototype.renderFill=function(t,e,r){var i=e.style;(e.c._mdf||this._isFirstFrame)&&(i.co="rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||r._opMdf||this._isFirstFrame)&&(i.coOp=e.o.v*r.opacity)},CVShapeElement.prototype.renderGradientFill=function(t,e,r){var i,n=e.style;if(!n.grd||e.g._mdf||e.s._mdf||e.e._mdf||1!==t.t&&(e.h._mdf||e.a._mdf)){var o,s=this.globalData.canvasContext,a=e.s.v,l=e.e.v;if(1===t.t)i=s.createLinearGradient(a[0],a[1],l[0],l[1]);else{var c=Math.sqrt(Math.pow(a[0]-l[0],2)+Math.pow(a[1]-l[1],2)),u=Math.atan2(l[1]-a[1],l[0]-a[0]),h=e.h.v;h>=1?h=.99:h<=-1&&(h=-.99);var d=c*h,p=Math.cos(u+e.a.v)*d+a[0],f=Math.sin(u+e.a.v)*d+a[1];i=s.createRadialGradient(p,f,0,a[0],a[1],c)}var m=t.g.p,g=e.g.c,y=1;for(o=0;o<m;o+=1)e.g._hasOpacity&&e.g._collapsable&&(y=e.g.o[2*o+1]),i.addColorStop(g[4*o]/100,"rgba("+g[4*o+1]+","+g[4*o+2]+","+g[4*o+3]+","+y+")");n.grd=i}n.coOp=e.o.v*r.opacity},CVShapeElement.prototype.renderStroke=function(t,e,r){var i=e.style,n=e.d;n&&(n._mdf||this._isFirstFrame)&&(i.da=n.dashArray,i.do=n.dashoffset[0]),(e.c._mdf||this._isFirstFrame)&&(i.co="rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||r._opMdf||this._isFirstFrame)&&(i.coOp=e.o.v*r.opacity),(e.w._mdf||this._isFirstFrame)&&(i.wi=e.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){var t=this.canvasContext;t.fillStyle=this.data.sc,t.fillRect(0,0,this.data.sw,this.data.sh)},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var t=this.textProperty.currentData;this.renderedLetters=createSizedArray(t.l?t.l.length:0);var e=!1;t.fc?(e=!0,this.values.fill=this.buildColor(t.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=e;var r=!1;t.sc&&(r=!0,this.values.stroke=this.buildColor(t.sc),this.values.sWidth=t.sw);var i,n,o,s,a,l,c,u,h,d,p,f,m=this.globalData.fontManager.getFontByName(t.f),g=t.l,y=this.mHelper;this.stroke=r,this.values.fValue=t.finalSize+"px "+this.globalData.fontManager.getFontByName(t.f).fFamily,n=t.finalText.length;var v=this.data.singleShape,_=.001*t.tr*t.finalSize,b=0,x=0,w=!0,T=0;for(i=0;i<n;i+=1){for(s=(o=this.globalData.fontManager.getCharData(t.finalText[i],m.fStyle,this.globalData.fontManager.getFontByName(t.f).fFamily))&&o.data||{},y.reset(),v&&g[i].n&&(b=-_,x+=t.yOffset,x+=w?1:0,w=!1),h=(c=s.shapes?s.shapes[0].it:[]).length,y.scale(t.finalSize/100,t.finalSize/100),v&&this.applyTextPropertiesToMatrix(t,y,g[i].line,b,x),p=createSizedArray(h),u=0;u<h;u+=1){for(l=c[u].ks.k.i.length,d=c[u].ks.k,f=[],a=1;a<l;a+=1)1===a&&f.push(y.applyToX(d.v[0][0],d.v[0][1],0),y.applyToY(d.v[0][0],d.v[0][1],0)),f.push(y.applyToX(d.o[a-1][0],d.o[a-1][1],0),y.applyToY(d.o[a-1][0],d.o[a-1][1],0),y.applyToX(d.i[a][0],d.i[a][1],0),y.applyToY(d.i[a][0],d.i[a][1],0),y.applyToX(d.v[a][0],d.v[a][1],0),y.applyToY(d.v[a][0],d.v[a][1],0));f.push(y.applyToX(d.o[a-1][0],d.o[a-1][1],0),y.applyToY(d.o[a-1][0],d.o[a-1][1],0),y.applyToX(d.i[0][0],d.i[0][1],0),y.applyToY(d.i[0][0],d.i[0][1],0),y.applyToX(d.v[0][0],d.v[0][1],0),y.applyToY(d.v[0][0],d.v[0][1],0)),p[u]=f}v&&(b+=g[i].l,b+=_),this.textSpans[T]?this.textSpans[T].elem=p:this.textSpans[T]={elem:p},T+=1}},CVTextElement.prototype.renderInnerContent=function(){var t,e,r,i,n,o,s=this.canvasContext;s.font=this.values.fValue,s.lineCap="butt",s.lineJoin="miter",s.miterLimit=4,this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var a,l=this.textAnimator.renderedLetters,c=this.textProperty.currentData.l;e=c.length;var u,h,d=null,p=null,f=null;for(t=0;t<e;t+=1)if(!c[t].n){if((a=l[t])&&(this.globalData.renderer.save(),this.globalData.renderer.ctxTransform(a.p),this.globalData.renderer.ctxOpacity(a.o)),this.fill){for(a&&a.fc?d!==a.fc&&(d=a.fc,s.fillStyle=a.fc):d!==this.values.fill&&(d=this.values.fill,s.fillStyle=this.values.fill),i=(u=this.textSpans[t].elem).length,this.globalData.canvasContext.beginPath(),r=0;r<i;r+=1)for(o=(h=u[r]).length,this.globalData.canvasContext.moveTo(h[0],h[1]),n=2;n<o;n+=6)this.globalData.canvasContext.bezierCurveTo(h[n],h[n+1],h[n+2],h[n+3],h[n+4],h[n+5]);this.globalData.canvasContext.closePath(),this.globalData.canvasContext.fill()}if(this.stroke){for(a&&a.sw?f!==a.sw&&(f=a.sw,s.lineWidth=a.sw):f!==this.values.sWidth&&(f=this.values.sWidth,s.lineWidth=this.values.sWidth),a&&a.sc?p!==a.sc&&(p=a.sc,s.strokeStyle=a.sc):p!==this.values.stroke&&(p=this.values.stroke,s.strokeStyle=this.values.stroke),i=(u=this.textSpans[t].elem).length,this.globalData.canvasContext.beginPath(),r=0;r<i;r+=1)for(o=(h=u[r]).length,this.globalData.canvasContext.moveTo(h[0],h[1]),n=2;n<o;n+=6)this.globalData.canvasContext.bezierCurveTo(h[n],h[n+1],h[n+2],h[n+3],h[n+4],h[n+5]);this.globalData.canvasContext.closePath(),this.globalData.canvasContext.stroke()}a&&this.globalData.renderer.restore()}},CVEffects.prototype.renderFrame=function(){},HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement)},createContainerElements:function(){this.renderableEffectsManager=new CVEffects(this),this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0!==this.data.bm&&this.setBlendMode()},renderElement:function(){var t=this.transformedElement?this.transformedElement.style:{};if(this.finalTransform._matMdf){var e=this.finalTransform.mat.toCSS();t.transform=e,t.webkitTransform=e}this.finalTransform._opMdf&&(t.opacity=this.finalTransform.mProp.o.v)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null)},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData)},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=HybridRenderer.prototype.buildElementParenting,extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var t;this.data.hasMask?((t=createNS("rect")).setAttribute("width",this.data.sw),t.setAttribute("height",this.data.sh),t.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):((t=createTag("div")).style.width=this.data.sw+"px",t.style.height=this.data.sh+"px",t.style.backgroundColor=this.data.sc),this.layerElement.appendChild(t)},extendPrototype([HybridRenderer,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement},HCompElement.prototype.addTo3dContainer=function(t,e){for(var r,i=0;i<e;)this.elements[i]&&this.elements[i].getBaseElement&&(r=this.elements[i].getBaseElement()),i+=1;r?this.layerElement.insertBefore(t,r):this.layerElement.appendChild(t)},extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var t;if(this.baseElement.style.fontSize=0,this.data.hasMask)this.layerElement.appendChild(this.shapesContainer),t=this.svgElement;else{t=createNS("svg");var e=this.comp.data?this.comp.data:this.globalData.compSize;t.setAttribute("width",e.w),t.setAttribute("height",e.h),t.appendChild(this.shapesContainer),this.layerElement.appendChild(t)}this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=t},HShapeElement.prototype.getTransformedPoint=function(t,e){var r,i=t.length;for(r=0;r<i;r+=1)e=t[r].mProps.v.applyToPointArray(e[0],e[1],0);return e},HShapeElement.prototype.calculateShapeBoundingBox=function(t,e){var r,i,n,o,s,a=t.sh.v,l=t.transformers,c=a._length;if(!(c<=1)){for(r=0;r<c-1;r+=1)i=this.getTransformedPoint(l,a.v[r]),n=this.getTransformedPoint(l,a.o[r]),o=this.getTransformedPoint(l,a.i[r+1]),s=this.getTransformedPoint(l,a.v[r+1]),this.checkBounds(i,n,o,s,e);a.c&&(i=this.getTransformedPoint(l,a.v[r]),n=this.getTransformedPoint(l,a.o[r]),o=this.getTransformedPoint(l,a.i[0]),s=this.getTransformedPoint(l,a.v[0]),this.checkBounds(i,n,o,s,e))}},HShapeElement.prototype.checkBounds=function(t,e,r,i,n){this.getBoundsOfCurve(t,e,r,i);var o=this.shapeBoundingBox;n.x=bmMin(o.left,n.x),n.xMax=bmMax(o.right,n.xMax),n.y=bmMin(o.top,n.y),n.yMax=bmMax(o.bottom,n.yMax)},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(t,e,r,i){for(var n,o,s,a,l,c,u,h=[[t[0],i[0]],[t[1],i[1]]],d=0;d<2;++d)o=6*t[d]-12*e[d]+6*r[d],n=-3*t[d]+9*e[d]-9*r[d]+3*i[d],s=3*e[d]-3*t[d],o|=0,s|=0,0==(n|=0)&&0===o||(0===n?(a=-s/o)>0&&a<1&&h[d].push(this.calculateF(a,t,e,r,i,d)):(l=o*o-4*s*n)>=0&&((c=(-o+bmSqrt(l))/(2*n))>0&&c<1&&h[d].push(this.calculateF(c,t,e,r,i,d)),(u=(-o-bmSqrt(l))/(2*n))>0&&u<1&&h[d].push(this.calculateF(u,t,e,r,i,d))));this.shapeBoundingBox.left=bmMin.apply(null,h[0]),this.shapeBoundingBox.top=bmMin.apply(null,h[1]),this.shapeBoundingBox.right=bmMax.apply(null,h[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,h[1])},HShapeElement.prototype.calculateF=function(t,e,r,i,n,o){return bmPow(1-t,3)*e[o]+3*bmPow(1-t,2)*t*r[o]+3*(1-t)*bmPow(t,2)*i[o]+bmPow(t,3)*n[o]},HShapeElement.prototype.calculateBoundingBox=function(t,e){var r,i=t.length;for(r=0;r<i;r+=1)t[r]&&t[r].sh?this.calculateShapeBoundingBox(t[r],e):t[r]&&t[r].it&&this.calculateBoundingBox(t[r].it,e)},HShapeElement.prototype.currentBoxContains=function(t){return this.currentBBox.x<=t.x&&this.currentBBox.y<=t.y&&this.currentBBox.width+this.currentBBox.x>=t.x+t.width&&this.currentBBox.height+this.currentBBox.y>=t.y+t.height},HShapeElement.prototype.renderInnerContent=function(){if(this._renderShapeFrame(),!this.hidden&&(this._isFirstFrame||this._mdf)){var t=this.tempBoundingBox,e=999999;if(t.x=e,t.xMax=-e,t.y=e,t.yMax=-e,this.calculateBoundingBox(this.itemsData,t),t.width=t.xMax<t.x?0:t.xMax-t.x,t.height=t.yMax<t.y?0:t.yMax-t.y,this.currentBoxContains(t))return;var r=!1;if(this.currentBBox.w!==t.width&&(this.currentBBox.w=t.width,this.shapeCont.setAttribute("width",t.width),r=!0),this.currentBBox.h!==t.height&&(this.currentBBox.h=t.height,this.shapeCont.setAttribute("height",t.height),r=!0),r||this.currentBBox.x!==t.x||this.currentBBox.y!==t.y){this.currentBBox.w=t.width,this.currentBBox.h=t.height,this.currentBBox.x=t.x,this.currentBBox.y=t.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h);var i=this.shapeCont.style,n="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";i.transform=n,i.webkitTransform=n}}},extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){if(this.isMasked=this.checkMasks(),this.isMasked){this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH);var t=createNS("g");this.maskedElement.appendChild(t),this.innerElem=t}else this.renderType="html",this.innerElem=this.layerElement;this.checkParenting()},HTextElement.prototype.buildNewText=function(){var t=this.textProperty.currentData;this.renderedLetters=createSizedArray(t.l?t.l.length:0);var e=this.innerElem.style,r=t.fc?this.buildColor(t.fc):"rgba(0,0,0,0)";e.fill=r,e.color=r,t.sc&&(e.stroke=this.buildColor(t.sc),e.strokeWidth=t.sw+"px");var i,n,o=this.globalData.fontManager.getFontByName(t.f);if(!this.globalData.fontManager.chars)if(e.fontSize=t.finalSize+"px",e.lineHeight=t.finalSize+"px",o.fClass)this.innerElem.className=o.fClass;else{e.fontFamily=o.fFamily;var s=t.fWeight,a=t.fStyle;e.fontStyle=a,e.fontWeight=s}var l,c,u,h=t.l;n=h.length;var d,p=this.mHelper,f="",m=0;for(i=0;i<n;i+=1){if(this.globalData.fontManager.chars?(this.textPaths[m]?l=this.textPaths[m]:((l=createNS("path")).setAttribute("stroke-linecap",lineCapEnum[1]),l.setAttribute("stroke-linejoin",lineJoinEnum[2]),l.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[m]?u=(c=this.textSpans[m]).children[0]:((c=createTag("div")).style.lineHeight=0,(u=createNS("svg")).appendChild(l),styleDiv(c)))):this.isMasked?l=this.textPaths[m]?this.textPaths[m]:createNS("text"):this.textSpans[m]?(c=this.textSpans[m],l=this.textPaths[m]):(styleDiv(c=createTag("span")),styleDiv(l=createTag("span")),c.appendChild(l)),this.globalData.fontManager.chars){var g,y=this.globalData.fontManager.getCharData(t.finalText[i],o.fStyle,this.globalData.fontManager.getFontByName(t.f).fFamily);if(g=y?y.data:null,p.reset(),g&&g.shapes&&(d=g.shapes[0].it,p.scale(t.finalSize/100,t.finalSize/100),f=this.createPathShape(p,d),l.setAttribute("d",f)),this.isMasked)this.innerElem.appendChild(l);else{if(this.innerElem.appendChild(c),g&&g.shapes){document.body.appendChild(u);var v=u.getBBox();u.setAttribute("width",v.width+2),u.setAttribute("height",v.height+2),u.setAttribute("viewBox",v.x-1+" "+(v.y-1)+" "+(v.width+2)+" "+(v.height+2));var _=u.style,b="translate("+(v.x-1)+"px,"+(v.y-1)+"px)";_.transform=b,_.webkitTransform=b,h[i].yOffset=v.y-1}else u.setAttribute("width",1),u.setAttribute("height",1);c.appendChild(u)}}else if(l.textContent=h[i].val,l.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked)this.innerElem.appendChild(l);else{this.innerElem.appendChild(c);var x=l.style,w="translate3d(0,"+-t.finalSize/1.2+"px,0)";x.transform=w,x.webkitTransform=w}this.isMasked?this.textSpans[m]=l:this.textSpans[m]=c,this.textSpans[m].style.display="block",this.textPaths[m]=l,m+=1}for(;m<this.textSpans.length;)this.textSpans[m].style.display="none",m+=1},HTextElement.prototype.renderInnerContent=function(){var t;if(this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;if(this.isMasked&&this.finalTransform._matMdf){this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),t=this.svgElement.style;var e="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)";t.transform=e,t.webkitTransform=e}}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag){var r,i,n,o,s,a=0,l=this.textAnimator.renderedLetters,c=this.textProperty.currentData.l;for(i=c.length,r=0;r<i;r+=1)c[r].n?a+=1:(o=this.textSpans[r],s=this.textPaths[r],n=l[a],a+=1,n._mdf.m&&(this.isMasked?o.setAttribute("transform",n.m):(o.style.webkitTransform=n.m,o.style.transform=n.m)),o.style.opacity=n.o,n.sw&&n._mdf.sw&&s.setAttribute("stroke-width",n.sw),n.sc&&n._mdf.sc&&s.setAttribute("stroke",n.sc),n.fc&&n._mdf.fc&&(s.setAttribute("fill",n.fc),s.style.color=n.fc));if(this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)){var u=this.innerElem.getBBox();if(this.currentBBox.w!==u.width&&(this.currentBBox.w=u.width,this.svgElement.setAttribute("width",u.width)),this.currentBBox.h!==u.height&&(this.currentBBox.h=u.height,this.svgElement.setAttribute("height",u.height)),this.currentBBox.w!==u.width+2||this.currentBBox.h!==u.height+2||this.currentBBox.x!==u.x-1||this.currentBBox.y!==u.y-1){this.currentBBox.w=u.width+2,this.currentBBox.h=u.height+2,this.currentBBox.x=u.x-1,this.currentBBox.y=u.y-1,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),t=this.svgElement.style;var h="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";t.transform=h,t.webkitTransform=h}}}},extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var t=this.globalData.getAssetsPath(this.assetData),e=new Image;this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",t),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(e),e.crossOrigin="anonymous",e.src=t,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln)},extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){var t,e,r,i,n=this.comp.threeDElements.length;for(t=0;t<n;t+=1)if("3d"===(e=this.comp.threeDElements[t]).type){r=e.perspectiveElem.style,i=e.container.style;var o=this.pe.v+"px",s="0px 0px 0px",a="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";r.perspective=o,r.webkitPerspective=o,i.transformOrigin=s,i.mozTransformOrigin=s,i.webkitTransformOrigin=s,r.transform=a,r.webkitTransform=a}},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var t,e,r=this._isFirstFrame;if(this.hierarchy)for(e=this.hierarchy.length,t=0;t<e;t+=1)r=this.hierarchy[t].finalTransform.mProp._mdf||r;if(r||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(t=e=this.hierarchy.length-1;t>=0;t-=1){var i=this.hierarchy[t].finalTransform.mProp;this.mat.translate(-i.p.v[0],-i.p.v[1],i.p.v[2]),this.mat.rotateX(-i.or.v[0]).rotateY(-i.or.v[1]).rotateZ(i.or.v[2]),this.mat.rotateX(-i.rx.v).rotateY(-i.ry.v).rotateZ(i.rz.v),this.mat.scale(1/i.s.v[0],1/i.s.v[1],1/i.s.v[2]),this.mat.translate(i.a.v[0],i.a.v[1],i.a.v[2])}if(this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a){var n;n=this.p?[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]];var o=Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)),s=[n[0]/o,n[1]/o,n[2]/o],a=Math.sqrt(s[2]*s[2]+s[0]*s[0]),l=Math.atan2(s[1],a),c=Math.atan2(s[0],-s[2]);this.mat.rotateY(c).rotateX(-l)}this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var u=!this._prevMat.equals(this.mat);if((u||this.pe._mdf)&&this.comp.threeDElements){var h,d,p;for(e=this.comp.threeDElements.length,t=0;t<e;t+=1)if("3d"===(h=this.comp.threeDElements[t]).type){if(u){var f=this.mat.toCSS();(p=h.container.style).transform=f,p.webkitTransform=f}this.pe._mdf&&((d=h.perspectiveElem.style).perspective=this.pe.v+"px",d.webkitPerspective=this.pe.v+"px")}this.mat.clone(this._prevMat)}}this._isFirstFrame=!1},HCameraElement.prototype.prepareFrame=function(t){this.prepareProperties(t,!0)},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null},HEffects.prototype.renderFrame=function(){};var animationManager=function(){var t={},e=[],r=0,i=0,n=0,o=!0,s=!1;function a(t){for(var r=0,n=t.target;r<i;)e[r].animation===n&&(e.splice(r,1),r-=1,i-=1,n.isPaused||u()),r+=1}function l(t,r){if(!t)return null;for(var n=0;n<i;){if(e[n].elem===t&&null!==e[n].elem)return e[n].animation;n+=1}var o=new AnimationItem;return h(o,t),o.setData(t,r),o}function c(){n+=1,f()}function u(){n-=1}function h(t,r){t.addEventListener("destroy",a),t.addEventListener("_active",c),t.addEventListener("_idle",u),e.push({elem:r,animation:t}),i+=1}function d(t){var a,l=t-r;for(a=0;a<i;a+=1)e[a].animation.advanceTime(l);r=t,n&&!s?window.requestAnimationFrame(d):o=!0}function p(t){r=t,window.requestAnimationFrame(d)}function f(){!s&&n&&o&&(window.requestAnimationFrame(p),o=!1)}return t.registerAnimation=l,t.loadAnimation=function(t){var e=new AnimationItem;return h(e,null),e.setParams(t),e},t.setSpeed=function(t,r){var n;for(n=0;n<i;n+=1)e[n].animation.setSpeed(t,r)},t.setDirection=function(t,r){var n;for(n=0;n<i;n+=1)e[n].animation.setDirection(t,r)},t.play=function(t){var r;for(r=0;r<i;r+=1)e[r].animation.play(t)},t.pause=function(t){var r;for(r=0;r<i;r+=1)e[r].animation.pause(t)},t.stop=function(t){var r;for(r=0;r<i;r+=1)e[r].animation.stop(t)},t.togglePause=function(t){var r;for(r=0;r<i;r+=1)e[r].animation.togglePause(t)},t.searchAnimations=function(t,e,r){var i,n=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),o=n.length;for(i=0;i<o;i+=1)r&&n[i].setAttribute("data-bm-type",r),l(n[i],t);if(e&&0===o){r||(r="svg");var s=document.getElementsByTagName("body")[0];s.innerText="";var a=createTag("div");a.style.width="100%",a.style.height="100%",a.setAttribute("data-bm-type",r),s.appendChild(a),l(a,t)}},t.resize=function(){var t;for(t=0;t<i;t+=1)e[t].animation.resize()},t.goToAndStop=function(t,r,n){var o;for(o=0;o<i;o+=1)e[o].animation.goToAndStop(t,r,n)},t.destroy=function(t){var r;for(r=i-1;r>=0;r-=1)e[r].animation.destroy(t)},t.freeze=function(){s=!0},t.unfreeze=function(){s=!1,f()},t.setVolume=function(t,r){var n;for(n=0;n<i;n+=1)e[n].animation.setVolume(t,r)},t.mute=function(t){var r;for(r=0;r<i;r+=1)e[r].animation.mute(t)},t.unmute=function(t){var r;for(r=0;r<i;r+=1)e[r].animation.unmute(t)},t.getRegisteredAnimations=function(){var t,r=e.length,i=[];for(t=0;t<r;t+=1)i.push(e[t].animation);return i},t}(),AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=subframeEnabled,this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this)};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(t){(t.wrapper||t.container)&&(this.wrapper=t.wrapper||t.container);var e="svg";switch(t.animType?e=t.animType:t.renderer&&(e=t.renderer),e){case"canvas":this.renderer=new CanvasRenderer(this,t.rendererSettings);break;case"svg":this.renderer=new SVGRenderer(this,t.rendererSettings);break;default:this.renderer=new HybridRenderer(this,t.rendererSettings)}this.imagePreloader.setCacheType(e,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=e,""===t.loop||null===t.loop||void 0===t.loop||!0===t.loop?this.loop=!0:!1===t.loop?this.loop=!1:this.loop=parseInt(t.loop,10),this.autoplay=!("autoplay"in t)||t.autoplay,this.name=t.name?t.name:"",this.autoloadSegments=!Object.prototype.hasOwnProperty.call(t,"autoloadSegments")||t.autoloadSegments,this.assetsPath=t.assetsPath,this.initialSegment=t.initialSegment,t.audioFactory&&this.audioController.setAudioFactory(t.audioFactory),t.animationData?this.setupAnimation(t.animationData):t.path&&(-1!==t.path.lastIndexOf("\\")?this.path=t.path.substr(0,t.path.lastIndexOf("\\")+1):this.path=t.path.substr(0,t.path.lastIndexOf("/")+1),this.fileName=t.path.substr(t.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(t.path,this.configAnimation,this.onSetupError))},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed")},AnimationItem.prototype.setupAnimation=function(t){dataManager.completeAnimation(t,this.configAnimation)},AnimationItem.prototype.setData=function(t,e){e&&"object"!=typeof e&&(e=JSON.parse(e));var r={wrapper:t,animationData:e},i=t.attributes;r.path=i.getNamedItem("data-animation-path")?i.getNamedItem("data-animation-path").value:i.getNamedItem("data-bm-path")?i.getNamedItem("data-bm-path").value:i.getNamedItem("bm-path")?i.getNamedItem("bm-path").value:"",r.animType=i.getNamedItem("data-anim-type")?i.getNamedItem("data-anim-type").value:i.getNamedItem("data-bm-type")?i.getNamedItem("data-bm-type").value:i.getNamedItem("bm-type")?i.getNamedItem("bm-type").value:i.getNamedItem("data-bm-renderer")?i.getNamedItem("data-bm-renderer").value:i.getNamedItem("bm-renderer")?i.getNamedItem("bm-renderer").value:"canvas";var n=i.getNamedItem("data-anim-loop")?i.getNamedItem("data-anim-loop").value:i.getNamedItem("data-bm-loop")?i.getNamedItem("data-bm-loop").value:i.getNamedItem("bm-loop")?i.getNamedItem("bm-loop").value:"";"false"===n?r.loop=!1:"true"===n?r.loop=!0:""!==n&&(r.loop=parseInt(n,10));var o=i.getNamedItem("data-anim-autoplay")?i.getNamedItem("data-anim-autoplay").value:i.getNamedItem("data-bm-autoplay")?i.getNamedItem("data-bm-autoplay").value:!i.getNamedItem("bm-autoplay")||i.getNamedItem("bm-autoplay").value;r.autoplay="false"!==o,r.name=i.getNamedItem("data-name")?i.getNamedItem("data-name").value:i.getNamedItem("data-bm-name")?i.getNamedItem("data-bm-name").value:i.getNamedItem("bm-name")?i.getNamedItem("bm-name").value:"","false"===(i.getNamedItem("data-anim-prerender")?i.getNamedItem("data-anim-prerender").value:i.getNamedItem("data-bm-prerender")?i.getNamedItem("data-bm-prerender").value:i.getNamedItem("bm-prerender")?i.getNamedItem("bm-prerender").value:"")&&(r.prerender=!1),this.setParams(r)},AnimationItem.prototype.includeLayers=function(t){t.op>this.animationData.op&&(this.animationData.op=t.op,this.totalFrames=Math.floor(t.op-this.animationData.ip));var e,r,i=this.animationData.layers,n=i.length,o=t.layers,s=o.length;for(r=0;r<s;r+=1)for(e=0;e<n;){if(i[e].id===o[r].id){i[e]=o[r];break}e+=1}if((t.chars||t.fonts)&&(this.renderer.globalData.fontManager.addChars(t.chars),this.renderer.globalData.fontManager.addFonts(t.fonts,this.renderer.globalData.defs)),t.assets)for(n=t.assets.length,e=0;e<n;e+=1)this.animationData.assets.push(t.assets[e]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete)},AnimationItem.prototype.onSegmentComplete=function(t){this.animationData=t,expressionsPlugin&&expressionsPlugin.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var t=this.animationData.segments;if(!t||0===t.length||!this.autoloadSegments)return this.trigger("data_ready"),void(this.timeCompleted=this.totalFrames);var e=t.shift();this.timeCompleted=e.time*this.frameRate;var r=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,dataManager.loadData(r,this.includeLayers.bind(this),function(){this.trigger("data_failed")}.bind(this))},AnimationItem.prototype.loadSegments=function(){this.animationData.segments||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(t){if(this.renderer)try{this.animationData=t,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(t),t.assets||(t.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(t.assets),this.markers=markerParser(t.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(t){this.triggerConfigError(t)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||"canvas"!==this.renderer.rendererType)&&this.imagePreloader.loadedFootages()&&(this.isLoaded=!0,expressionsPlugin&&expressionsPlugin.initExpressions(this),this.renderer.initItems(),setTimeout(function(){this.trigger("DOMLoaded")}.bind(this),0),this.gotoFrame(),this.autoplay&&this.play())},AnimationItem.prototype.resize=function(){this.renderer.updateContainerSize()},AnimationItem.prototype.setSubframe=function(t){this.isSubframeEnabled=!!t},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},AnimationItem.prototype.renderFrame=function(){if(!1!==this.isLoaded&&this.renderer)try{this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(t){this.triggerRenderFrameError(t)}},AnimationItem.prototype.play=function(t){t&&this.name!==t||!0===this.isPaused&&(this.isPaused=!1,this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(t){t&&this.name!==t||!1===this.isPaused&&(this.isPaused=!0,this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(t){t&&this.name!==t||(!0===this.isPaused?this.play():this.pause())},AnimationItem.prototype.stop=function(t){t&&this.name!==t||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(t){for(var e,r=0;r<this.markers.length;r+=1)if((e=this.markers[r]).payload&&e.payload.name===t)return e;return null},AnimationItem.prototype.goToAndStop=function(t,e,r){if(!r||this.name===r){var i=Number(t);if(isNaN(i)){var n=this.getMarkerData(t);n&&this.goToAndStop(n.time,!0)}else e?this.setCurrentRawFrameValue(t):this.setCurrentRawFrameValue(t*this.frameModifier);this.pause()}},AnimationItem.prototype.goToAndPlay=function(t,e,r){if(!r||this.name===r){var i=Number(t);if(isNaN(i)){var n=this.getMarkerData(t);n&&(n.duration?this.playSegments([n.time,n.time+n.duration],!0):this.goToAndStop(n.time,!0))}else this.goToAndStop(i,e,r);this.play()}},AnimationItem.prototype.advanceTime=function(t){if(!0!==this.isPaused&&!1!==this.isLoaded){var e=this.currentRawFrame+t*this.frameModifier,r=!1;e>=this.totalFrames-1&&this.frameModifier>0?this.loop&&this.playCount!==this.loop?e>=this.totalFrames?(this.playCount+=1,this.checkSegments(e%this.totalFrames)||(this.setCurrentRawFrameValue(e%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(e):this.checkSegments(e>this.totalFrames?e%this.totalFrames:0)||(r=!0,e=this.totalFrames-1):e<0?this.checkSegments(e%this.totalFrames)||(!this.loop||this.playCount--<=0&&!0!==this.loop?(r=!0,e=0):(this.setCurrentRawFrameValue(this.totalFrames+e%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0)):this.setCurrentRawFrameValue(e),r&&(this.setCurrentRawFrameValue(e),this.pause(),this.trigger("complete"))}},AnimationItem.prototype.adjustSegment=function(t,e){this.playCount=0,t[1]<t[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=t[0]-t[1],this.timeCompleted=this.totalFrames,this.firstFrame=t[1],this.setCurrentRawFrameValue(this.totalFrames-.001-e)):t[1]>t[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=t[1]-t[0],this.timeCompleted=this.totalFrames,this.firstFrame=t[0],this.setCurrentRawFrameValue(.001+e)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(t,e){var r=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<t?r=t:this.currentRawFrame+this.firstFrame>e&&(r=e-t)),this.firstFrame=t,this.totalFrames=e-t,this.timeCompleted=this.totalFrames,-1!==r&&this.goToAndStop(r,!0)},AnimationItem.prototype.playSegments=function(t,e){if(e&&(this.segments.length=0),"object"==typeof t[0]){var r,i=t.length;for(r=0;r<i;r+=1)this.segments.push(t[r])}else this.segments.push(t);this.segments.length&&e&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(t){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),t&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(t){return!!this.segments.length&&(this.adjustSegment(this.segments.shift(),t),!0)},AnimationItem.prototype.destroy=function(t){t&&this.name!==t||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.renderer=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(t){this.currentRawFrame=t,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(t){this.playSpeed=t,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(t){this.playDirection=t<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setVolume=function(t,e){e&&this.name!==e||this.audioController.setVolume(t)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(t){t&&this.name!==t||this.audioController.mute()},AnimationItem.prototype.unmute=function(t){t&&this.name!==t||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(t){var e="";if(t.e)e=t.p;else if(this.assetsPath){var r=t.p;-1!==r.indexOf("images/")&&(r=r.split("/")[1]),e=this.assetsPath+r}else e=this.path,e+=t.u?t.u:"",e+=t.p;return e},AnimationItem.prototype.getAssetData=function(t){for(var e=0,r=this.assets.length;e<r;){if(t===this.assets[e].id)return this.assets[e];e+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(t){return t?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.trigger=function(t){if(this._cbs&&this._cbs[t])switch(t){case"enterFrame":case"drawnFrame":this.triggerEvent(t,new BMEnterFrameEvent(t,this.currentFrame,this.totalFrames,this.frameModifier));break;case"loopComplete":this.triggerEvent(t,new BMCompleteLoopEvent(t,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(t,new BMCompleteEvent(t,this.frameMult));break;case"segmentStart":this.triggerEvent(t,new BMSegmentStartEvent(t,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(t,new BMDestroyEvent(t,this));break;default:this.triggerEvent(t)}"enterFrame"===t&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(t,this.currentFrame,this.totalFrames,this.frameMult)),"loopComplete"===t&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(t,this.loop,this.playCount,this.frameMult)),"complete"===t&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(t,this.frameMult)),"segmentStart"===t&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(t,this.firstFrame,this.totalFrames)),"destroy"===t&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(t,this))},AnimationItem.prototype.triggerRenderFrameError=function(t){var e=new BMRenderFrameErrorEvent(t,this.currentFrame);this.triggerEvent("error",e),this.onError&&this.onError.call(this,e)},AnimationItem.prototype.triggerConfigError=function(t){var e=new BMConfigErrorEvent(t,this.currentFrame);this.triggerEvent("error",e),this.onError&&this.onError.call(this,e)};var Expressions=function(){var t={initExpressions:function(t){var e=0,r=[];t.renderer.compInterface=CompExpressionInterface(t.renderer),t.renderer.globalData.projectInterface.registerComposition(t.renderer),t.renderer.globalData.pushExpression=function(){e+=1},t.renderer.globalData.popExpression=function(){0==(e-=1)&&function(){var t,e=r.length;for(t=0;t<e;t+=1)r[t].release();r.length=0}()},t.renderer.globalData.registerExpressionProperty=function(t){-1===r.indexOf(t)&&r.push(t)}}};return t}();expressionsPlugin=Expressions;var ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null;function $bm_isInstanceOfArray(t){return t.constructor===Array||t.constructor===Float32Array}function isNumerable(t,e){return"number"===t||"boolean"===t||"string"===t||e instanceof Number}function $bm_neg(t){var e=typeof t;if("number"===e||"boolean"===e||t instanceof Number)return-t;if($bm_isInstanceOfArray(t)){var r,i=t.length,n=[];for(r=0;r<i;r+=1)n[r]=-t[r];return n}return t.propType?t.v:-t}var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(t,e){var r=typeof t,i=typeof e;if("string"===r||"string"===i)return t+e;if(isNumerable(r,t)&&isNumerable(i,e))return t+e;if($bm_isInstanceOfArray(t)&&isNumerable(i,e))return(t=t.slice(0))[0]+=e,t;if(isNumerable(r,t)&&$bm_isInstanceOfArray(e))return(e=e.slice(0))[0]=t+e[0],e;if($bm_isInstanceOfArray(t)&&$bm_isInstanceOfArray(e)){for(var n=0,o=t.length,s=e.length,a=[];n<o||n<s;)("number"==typeof t[n]||t[n]instanceof Number)&&("number"==typeof e[n]||e[n]instanceof Number)?a[n]=t[n]+e[n]:a[n]=void 0===e[n]?t[n]:t[n]||e[n],n+=1;return a}return 0}var add=sum;function sub(t,e){var r=typeof t,i=typeof e;if(isNumerable(r,t)&&isNumerable(i,e))return"string"===r&&(t=parseInt(t,10)),"string"===i&&(e=parseInt(e,10)),t-e;if($bm_isInstanceOfArray(t)&&isNumerable(i,e))return(t=t.slice(0))[0]-=e,t;if(isNumerable(r,t)&&$bm_isInstanceOfArray(e))return(e=e.slice(0))[0]=t-e[0],e;if($bm_isInstanceOfArray(t)&&$bm_isInstanceOfArray(e)){for(var n=0,o=t.length,s=e.length,a=[];n<o||n<s;)("number"==typeof t[n]||t[n]instanceof Number)&&("number"==typeof e[n]||e[n]instanceof Number)?a[n]=t[n]-e[n]:a[n]=void 0===e[n]?t[n]:t[n]||e[n],n+=1;return a}return 0}function mul(t,e){var r,i,n,o=typeof t,s=typeof e;if(isNumerable(o,t)&&isNumerable(s,e))return t*e;if($bm_isInstanceOfArray(t)&&isNumerable(s,e)){for(n=t.length,r=createTypedArray("float32",n),i=0;i<n;i+=1)r[i]=t[i]*e;return r}if(isNumerable(o,t)&&$bm_isInstanceOfArray(e)){for(n=e.length,r=createTypedArray("float32",n),i=0;i<n;i+=1)r[i]=t*e[i];return r}return 0}function div(t,e){var r,i,n,o=typeof t,s=typeof e;if(isNumerable(o,t)&&isNumerable(s,e))return t/e;if($bm_isInstanceOfArray(t)&&isNumerable(s,e)){for(n=t.length,r=createTypedArray("float32",n),i=0;i<n;i+=1)r[i]=t[i]/e;return r}if(isNumerable(o,t)&&$bm_isInstanceOfArray(e)){for(n=e.length,r=createTypedArray("float32",n),i=0;i<n;i+=1)r[i]=t/e[i];return r}return 0}function mod(t,e){return"string"==typeof t&&(t=parseInt(t,10)),"string"==typeof e&&(e=parseInt(e,10)),t%e}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(t,e,r){if(e>r){var i=r;r=e,e=i}return Math.min(Math.max(t,e),r)}function radiansToDegrees(t){return t/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(t){return t*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(t,e){if("number"==typeof t||t instanceof Number)return e=e||0,Math.abs(t-e);var r;e||(e=helperLengthArray);var i=Math.min(t.length,e.length),n=0;for(r=0;r<i;r+=1)n+=Math.pow(e[r]-t[r],2);return Math.sqrt(n)}function normalize(t){return div(t,length(t))}function rgbToHsl(t){var e,r,i=t[0],n=t[1],o=t[2],s=Math.max(i,n,o),a=Math.min(i,n,o),l=(s+a)/2;if(s===a)e=0,r=0;else{var c=s-a;switch(r=l>.5?c/(2-s-a):c/(s+a),s){case i:e=(n-o)/c+(n<o?6:0);break;case n:e=(o-i)/c+2;break;case o:e=(i-n)/c+4}e/=6}return[e,r,l,t[3]]}function hue2rgb(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function hslToRgb(t){var e,r,i,n=t[0],o=t[1],s=t[2];if(0===o)e=s,i=s,r=s;else{var a=s<.5?s*(1+o):s+o-s*o,l=2*s-a;e=hue2rgb(l,a,n+1/3),r=hue2rgb(l,a,n),i=hue2rgb(l,a,n-1/3)}return[e,r,i,t[3]]}function linear(t,e,r,i,n){if(void 0!==i&&void 0!==n||(i=e,n=r,e=0,r=1),r<e){var o=r;r=e,e=o}if(t<=e)return i;if(t>=r)return n;var s,a=r===e?0:(t-e)/(r-e);if(!i.length)return i+(n-i)*a;var l=i.length,c=createTypedArray("float32",l);for(s=0;s<l;s+=1)c[s]=i[s]+(n[s]-i[s])*a;return c}function random(t,e){if(void 0===e&&(void 0===t?(t=0,e=1):(e=t,t=void 0)),e.length){var r,i=e.length;t||(t=createTypedArray("float32",i));var n=createTypedArray("float32",i),o=BMMath.random();for(r=0;r<i;r+=1)n[r]=t[r]+o*(e[r]-t[r]);return n}return void 0===t&&(t=0),t+BMMath.random()*(e-t)}function createPath(t,e,r,i){var n,o=t.length,s=shapePool.newElement();s.setPathData(!!i,o);var a,l,c=[0,0];for(n=0;n<o;n+=1)a=e&&e[n]?e[n]:c,l=r&&r[n]?r[n]:c,s.setTripleAt(t[n][0],t[n][1],l[0]+t[n][0],l[1]+t[n][1],a[0]+t[n][0],a[1]+t[n][1],n,!0);return s}function initiateExpression(elem,data,property){var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=-1!==val.indexOf("random"),elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||!0!==this.data.hd,wiggle=function(t,e){var r,i,n=this.pv.length?this.pv.length:1,o=createTypedArray("float32",n),s=Math.floor(5*time);for(r=0,i=0;r<s;){for(i=0;i<n;i+=1)o[i]+=-e+2*e*BMMath.random();r+=1}var a=5*time,l=a-Math.floor(a),c=createTypedArray("float32",n);if(n>1){for(i=0;i<n;i+=1)c[i]=this.pv[i]+o[i]+(-e+2*e*BMMath.random())*l;return c}return this.pv+o[0]+(-e+2*e*BMMath.random())*l}.bind(this);function loopInDuration(t,e){return loopIn(t,e,!0)}function loopOutDuration(t,e){return loopOut(t,e,!0)}thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty)),this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface),time,velocity,value,text,textIndex,textTotal,selectorValue;function lookAt(t,e){var r=[e[0]-t[0],e[1]-t[1],e[2]-t[2]],i=Math.atan2(r[0],Math.sqrt(r[1]*r[1]+r[2]*r[2]))/degToRads;return[-Math.atan2(r[1],r[2])/degToRads,i,0]}function easeOut(t,e,r,i,n){return applyEase(easeOutBez,t,e,r,i,n)}function easeIn(t,e,r,i,n){return applyEase(easeInBez,t,e,r,i,n)}function ease(t,e,r,i,n){return applyEase(easeInOutBez,t,e,r,i,n)}function applyEase(t,e,r,i,n,o){void 0===n?(n=r,o=i):e=(e-r)/(i-r),e>1?e=1:e<0&&(e=0);var s=t(e);if($bm_isInstanceOfArray(n)){var a,l=n.length,c=createTypedArray("float32",l);for(a=0;a<l;a+=1)c[a]=(o[a]-n[a])*s+n[a];return c}return(o-n)*s+n}function nearestKey(t){var e,r,i,n=data.k.length;if(data.k.length&&"number"!=typeof data.k[0])if(r=-1,(t*=elem.comp.globalData.frameRate)<data.k[0].t)r=1,i=data.k[0].t;else{for(e=0;e<n-1;e+=1){if(t===data.k[e].t){r=e+1,i=data.k[e].t;break}if(t>data.k[e].t&&t<data.k[e+1].t){t-data.k[e].t>data.k[e+1].t-t?(r=e+2,i=data.k[e+1].t):(r=e+1,i=data.k[e].t);break}}-1===r&&(r=e+1,i=data.k[e].t)}else r=0,i=0;var o={};return o.index=r,o.time=i/elem.comp.globalData.frameRate,o}function key(t){var e,r,i;if(!data.k.length||"number"==typeof data.k[0])throw new Error("The property has no keyframe at index "+t);t-=1,e={time:data.k[t].t/elem.comp.globalData.frameRate,value:[]};var n=Object.prototype.hasOwnProperty.call(data.k[t],"s")?data.k[t].s:data.k[t-1].e;for(i=n.length,r=0;r<i;r+=1)e[r]=n[r],e.value[r]=n[r];return e}function framesToTime(t,e){return e||(e=elem.comp.globalData.frameRate),t/e}function timeToFrames(t,e){return t||0===t||(t=time),e||(e=elem.comp.globalData.frameRate),t*e}function seedRandom(t){BMMath.seedrandom(randSeed+t)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(t,e){return"string"==typeof value?void 0===e?value.substring(t):value.substring(t,e):""}function substr(t,e){return"string"==typeof value?void 0===e?value.substr(t):value.substr(t,e):""}function posterizeTime(t){time=0===t?0:Math.floor(time*t)/t,value=valueAtTime(time)}var index=elem.data.ind,hasParent=!(!elem.hierarchy||!elem.hierarchy.length),parent,randSeed=Math.floor(1e6*Math.random()),globalData=elem.globalData;function executeExpression(t){return value=t,this.frameExpressionId===elem.globalData.frameId&&"textSelector"!==this.propType?value:("textSelector"===this.propType&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),4!==elemType||content||(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),(hasParent=!(!elem.hierarchy||!elem.hierarchy.length))&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,"shape"===scoped_bm_rt.propType&&(scoped_bm_rt=scoped_bm_rt.v),scoped_bm_rt)}return executeExpression}return ob.initiateExpression=initiateExpression,ob}(),expressionHelpers={searchExpressions:function(t,e,r){e.x&&(r.k=!0,r.x=!0,r.initiateExpression=ExpressionManager.initiateExpression,r.effectsSequence.push(r.initiateExpression(t,e,r).bind(r)))},getSpeedAtTime:function(t){var e=this.getValueAtTime(t),r=this.getValueAtTime(t+-.01),i=0;if(e.length){var n;for(n=0;n<e.length;n+=1)i+=Math.pow(r[n]-e[n],2);i=100*Math.sqrt(i)}else i=0;return i},getVelocityAtTime:function(t){if(void 0!==this.vel)return this.vel;var e,r,i=-.001,n=this.getValueAtTime(t),o=this.getValueAtTime(t+i);if(n.length)for(e=createTypedArray("float32",n.length),r=0;r<n.length;r+=1)e[r]=(o[r]-n[r])/i;else e=(o-n)/i;return e},getValueAtTime:function(t){return t*=this.elem.globalData.frameRate,(t-=this.offsetTime)!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<t?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(t,this._cachingAtTime),this._cachingAtTime.lastFrame=t),this._cachingAtTime.value},getStaticValueAtTime:function(){return this.pv},setGroupProperty:function(t){this.propertyGroup=t}};!function(){function t(t,e,r){if(!this.k||!this.keyframes)return this.pv;t=t?t.toLowerCase():"";var i,n,o,s,a,l=this.comp.renderedFrame,c=this.keyframes,u=c[c.length-1].t;if(l<=u)return this.pv;if(r?n=u-(i=e?Math.abs(u-this.elem.comp.globalData.frameRate*e):Math.max(0,u-this.elem.data.ip)):((!e||e>c.length-1)&&(e=c.length-1),i=u-(n=c[c.length-1-e].t)),"pingpong"===t){if(Math.floor((l-n)/i)%2!=0)return this.getValueAtTime((i-(l-n)%i+n)/this.comp.globalData.frameRate,0)}else{if("offset"===t){var h=this.getValueAtTime(n/this.comp.globalData.frameRate,0),d=this.getValueAtTime(u/this.comp.globalData.frameRate,0),p=this.getValueAtTime(((l-n)%i+n)/this.comp.globalData.frameRate,0),f=Math.floor((l-n)/i);if(this.pv.length){for(s=(a=new Array(h.length)).length,o=0;o<s;o+=1)a[o]=(d[o]-h[o])*f+p[o];return a}return(d-h)*f+p}if("continue"===t){var m=this.getValueAtTime(u/this.comp.globalData.frameRate,0),g=this.getValueAtTime((u-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(s=(a=new Array(m.length)).length,o=0;o<s;o+=1)a[o]=m[o]+(m[o]-g[o])*((l-u)/this.comp.globalData.frameRate)/5e-4;return a}return m+(l-u)/.001*(m-g)}}return this.getValueAtTime(((l-n)%i+n)/this.comp.globalData.frameRate,0)}function e(t,e,r){if(!this.k)return this.pv;t=t?t.toLowerCase():"";var i,n,o,s,a,l=this.comp.renderedFrame,c=this.keyframes,u=c[0].t;if(l>=u)return this.pv;if(r?n=u+(i=e?Math.abs(this.elem.comp.globalData.frameRate*e):Math.max(0,this.elem.data.op-u)):((!e||e>c.length-1)&&(e=c.length-1),i=(n=c[e].t)-u),"pingpong"===t){if(Math.floor((u-l)/i)%2==0)return this.getValueAtTime(((u-l)%i+u)/this.comp.globalData.frameRate,0)}else{if("offset"===t){var h=this.getValueAtTime(u/this.comp.globalData.frameRate,0),d=this.getValueAtTime(n/this.comp.globalData.frameRate,0),p=this.getValueAtTime((i-(u-l)%i+u)/this.comp.globalData.frameRate,0),f=Math.floor((u-l)/i)+1;if(this.pv.length){for(s=(a=new Array(h.length)).length,o=0;o<s;o+=1)a[o]=p[o]-(d[o]-h[o])*f;return a}return p-(d-h)*f}if("continue"===t){var m=this.getValueAtTime(u/this.comp.globalData.frameRate,0),g=this.getValueAtTime((u+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(s=(a=new Array(m.length)).length,o=0;o<s;o+=1)a[o]=m[o]+(m[o]-g[o])*(u-l)/.001;return a}return m+(m-g)*(u-l)/.001}}return this.getValueAtTime((i-((u-l)%i+u))/this.comp.globalData.frameRate,0)}function r(t,e){if(!this.k)return this.pv;if(t=.5*(t||.4),(e=Math.floor(e||5))<=1)return this.pv;var r,i,n=this.comp.renderedFrame/this.comp.globalData.frameRate,o=n-t,s=e>1?(n+t-o)/(e-1):1,a=0,l=0;for(r=this.pv.length?createTypedArray("float32",this.pv.length):0;a<e;){if(i=this.getValueAtTime(o+a*s),this.pv.length)for(l=0;l<this.pv.length;l+=1)r[l]+=i[l];else r+=i;a+=1}if(this.pv.length)for(l=0;l<this.pv.length;l+=1)r[l]/=e;else r/=e;return r}function i(t){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var e=this._transformCachingAtTime.v;if(e.cloneFromProps(this.pre.props),this.appliedTransformations<1){var r=this.a.getValueAtTime(t);e.translate(-r[0]*this.a.mult,-r[1]*this.a.mult,r[2]*this.a.mult)}if(this.appliedTransformations<2){var i=this.s.getValueAtTime(t);e.scale(i[0]*this.s.mult,i[1]*this.s.mult,i[2]*this.s.mult)}if(this.sk&&this.appliedTransformations<3){var n=this.sk.getValueAtTime(t),o=this.sa.getValueAtTime(t);e.skewFromAxis(-n*this.sk.mult,o*this.sa.mult)}if(this.r&&this.appliedTransformations<4){var s=this.r.getValueAtTime(t);e.rotate(-s*this.r.mult)}else if(!this.r&&this.appliedTransformations<4){var a=this.rz.getValueAtTime(t),l=this.ry.getValueAtTime(t),c=this.rx.getValueAtTime(t),u=this.or.getValueAtTime(t);e.rotateZ(-a*this.rz.mult).rotateY(l*this.ry.mult).rotateX(c*this.rx.mult).rotateZ(-u[2]*this.or.mult).rotateY(u[1]*this.or.mult).rotateX(u[0]*this.or.mult)}if(this.data.p&&this.data.p.s){var h=this.px.getValueAtTime(t),d=this.py.getValueAtTime(t);if(this.data.p.z){var p=this.pz.getValueAtTime(t);e.translate(h*this.px.mult,d*this.py.mult,-p*this.pz.mult)}else e.translate(h*this.px.mult,d*this.py.mult,0)}else{var f=this.p.getValueAtTime(t);e.translate(f[0]*this.p.mult,f[1]*this.p.mult,-f[2]*this.p.mult)}return e}function n(){return this.v.clone(new Matrix)}var o=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(t,e,r){var s=o(t,e,r);return s.dynamicProperties.length?s.getValueAtTime=i.bind(s):s.getValueAtTime=n.bind(s),s.setGroupProperty=expressionHelpers.setGroupProperty,s};var s=PropertyFactory.getProp;PropertyFactory.getProp=function(i,n,o,a,l){var c=s(i,n,o,a,l);c.kf?c.getValueAtTime=expressionHelpers.getValueAtTime.bind(c):c.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(c),c.setGroupProperty=expressionHelpers.setGroupProperty,c.loopOut=t,c.loopIn=e,c.smooth=r,c.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(c),c.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(c),c.numKeys=1===n.a?n.k.length:0,c.propertyIndex=n.ix;var u=0;return 0!==o&&(u=createTypedArray("float32",1===n.a?n.k[0].s.length:n.k.length)),c._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:u},expressionHelpers.searchExpressions(i,n,c),c.k&&l.addDynamicProperty(c),c};var a=ShapePropertyFactory.getConstructorFunction(),l=ShapePropertyFactory.getKeyframedConstructorFunction();function c(){}c.prototype={vertices:function(t,e){this.k&&this.getValue();var r,i=this.v;void 0!==e&&(i=this.getValueAtTime(e,0));var n=i._length,o=i[t],s=i.v,a=createSizedArray(n);for(r=0;r<n;r+=1)a[r]="i"===t||"o"===t?[o[r][0]-s[r][0],o[r][1]-s[r][1]]:[o[r][0],o[r][1]];return a},points:function(t){return this.vertices("v",t)},inTangents:function(t){return this.vertices("i",t)},outTangents:function(t){return this.vertices("o",t)},isClosed:function(){return this.v.c},pointOnPath:function(t,e){var r=this.v;void 0!==e&&(r=this.getValueAtTime(e,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(r));for(var i,n=this._segmentsLength,o=n.lengths,s=n.totalLength*t,a=0,l=o.length,c=0;a<l;){if(c+o[a].addedLength>s){var u=a,h=r.c&&a===l-1?0:a+1,d=(s-c)/o[a].addedLength;i=bez.getPointInSegment(r.v[u],r.v[h],r.o[u],r.i[h],d,o[a]);break}c+=o[a].addedLength,a+=1}return i||(i=r.c?[r.v[0][0],r.v[0][1]]:[r.v[r._length-1][0],r.v[r._length-1][1]]),i},vectorOnPath:function(t,e,r){1==t?t=this.v.c:0==t&&(t=.999);var i=this.pointOnPath(t,e),n=this.pointOnPath(t+.001,e),o=n[0]-i[0],s=n[1]-i[1],a=Math.sqrt(Math.pow(o,2)+Math.pow(s,2));return 0===a?[0,0]:"tangent"===r?[o/a,s/a]:[-s/a,o/a]},tangentOnPath:function(t,e){return this.vectorOnPath(t,e,"tangent")},normalOnPath:function(t,e){return this.vectorOnPath(t,e,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([c],a),extendPrototype([c],l),l.prototype.getValueAtTime=function(t){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),t*=this.elem.globalData.frameRate,(t-=this.offsetTime)!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<t?this._caching.lastIndex:0,this._cachingAtTime.lastTime=t,this.interpolateShape(t,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue},l.prototype.initiateExpression=ExpressionManager.initiateExpression;var u=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(t,e,r,i,n){var o=u(t,e,r,i,n);return o.propertyIndex=e.ix,o.lock=!1,3===r?expressionHelpers.searchExpressions(t,e.pt,o):4===r&&expressionHelpers.searchExpressions(t,e.ks,o),o.k&&t.addDynamicProperty(o),o}}(),TextProperty.prototype.getExpressionValue=function(t,e){var r=this.calculateExpression(e);if(t.t!==r){var i={};return this.copyData(i,t),i.t=r.toString(),i.__complete=!1,i}return t},TextProperty.prototype.searchProperty=function(){var t=this.searchKeyframes(),e=this.searchExpressions();return this.kf=t||e,this.kf},TextProperty.prototype.searchExpressions=function(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null};var ShapePathInterface=function(t,e,r){var i=e.sh;function n(t){return"Shape"===t||"shape"===t||"Path"===t||"path"===t||"ADBE Vector Shape"===t||2===t?n.path:null}var o=propertyGroupFactory(n,r);return i.setGroupProperty(PropertyInterface("Path",o)),Object.defineProperties(n,{path:{get:function(){return i.k&&i.getValue(),i}},shape:{get:function(){return i.k&&i.getValue(),i}},_name:{value:t.nm},ix:{value:t.ix},propertyIndex:{value:t.ix},mn:{value:t.mn},propertyGroup:{value:r}}),n},propertyGroupFactory=function(t,e){return function(r){return(r=void 0===r?1:r)<=0?t:e(r-1)}},PropertyInterface=function(t,e){var r={_name:t};return function(t){return(t=void 0===t?1:t)<=0?r:e(t-1)}},ShapeExpressionInterface=function(){function t(t,s,d){var p,f=[],m=t?t.length:0;for(p=0;p<m;p+=1)"gr"===t[p].ty?f.push(e(t[p],s[p],d)):"fl"===t[p].ty?f.push(r(t[p],s[p],d)):"st"===t[p].ty?f.push(n(t[p],s[p],d)):"tm"===t[p].ty?f.push(o(t[p],s[p],d)):"tr"===t[p].ty||("el"===t[p].ty?f.push(a(t[p],s[p],d)):"sr"===t[p].ty?f.push(l(t[p],s[p],d)):"sh"===t[p].ty?f.push(ShapePathInterface(t[p],s[p],d)):"rc"===t[p].ty?f.push(c(t[p],s[p],d)):"rd"===t[p].ty?f.push(u(t[p],s[p],d)):"rp"===t[p].ty?f.push(h(t[p],s[p],d)):"gf"===t[p].ty?f.push(i(t[p],s[p],d)):f.push((t[p],s[p],function(){return null})));return f}function e(e,r,i){var n=function(t){switch(t){case"ADBE Vectors Group":case"Contents":case 2:return n.content;default:return n.transform}};n.propertyGroup=propertyGroupFactory(n,i);var o=function(e,r,i){var n,o=function(t){for(var e=0,r=n.length;e<r;){if(n[e]._name===t||n[e].mn===t||n[e].propertyIndex===t||n[e].ix===t||n[e].ind===t)return n[e];e+=1}return"number"==typeof t?n[t-1]:null};o.propertyGroup=propertyGroupFactory(o,i),n=t(e.it,r.it,o.propertyGroup),o.numProperties=n.length;var a=s(e.it[e.it.length-1],r.it[r.it.length-1],o.propertyGroup);return o.transform=a,o.propertyIndex=e.cix,o._name=e.nm,o}(e,r,n.propertyGroup),a=s(e.it[e.it.length-1],r.it[r.it.length-1],n.propertyGroup);return n.content=o,n.transform=a,Object.defineProperty(n,"_name",{get:function(){return e.nm}}),n.numProperties=e.np,n.propertyIndex=e.ix,n.nm=e.nm,n.mn=e.mn,n}function r(t,e,r){function i(t){return"Color"===t||"color"===t?i.color:"Opacity"===t||"opacity"===t?i.opacity:null}return Object.defineProperties(i,{color:{get:ExpressionPropertyInterface(e.c)},opacity:{get:ExpressionPropertyInterface(e.o)},_name:{value:t.nm},mn:{value:t.mn}}),e.c.setGroupProperty(PropertyInterface("Color",r)),e.o.setGroupProperty(PropertyInterface("Opacity",r)),i}function i(t,e,r){function i(t){return"Start Point"===t||"start point"===t?i.startPoint:"End Point"===t||"end point"===t?i.endPoint:"Opacity"===t||"opacity"===t?i.opacity:null}return Object.defineProperties(i,{startPoint:{get:ExpressionPropertyInterface(e.s)},endPoint:{get:ExpressionPropertyInterface(e.e)},opacity:{get:ExpressionPropertyInterface(e.o)},type:{get:function(){return"a"}},_name:{value:t.nm},mn:{value:t.mn}}),e.s.setGroupProperty(PropertyInterface("Start Point",r)),e.e.setGroupProperty(PropertyInterface("End Point",r)),e.o.setGroupProperty(PropertyInterface("Opacity",r)),i}function n(t,e,r){var i,n=propertyGroupFactory(c,r),o=propertyGroupFactory(l,n);function s(r){Object.defineProperty(l,t.d[r].nm,{get:ExpressionPropertyInterface(e.d.dataProps[r].p)})}var a=t.d?t.d.length:0,l={};for(i=0;i<a;i+=1)s(i),e.d.dataProps[i].p.setGroupProperty(o);function c(t){return"Color"===t||"color"===t?c.color:"Opacity"===t||"opacity"===t?c.opacity:"Stroke Width"===t||"stroke width"===t?c.strokeWidth:null}return Object.defineProperties(c,{color:{get:ExpressionPropertyInterface(e.c)},opacity:{get:ExpressionPropertyInterface(e.o)},strokeWidth:{get:ExpressionPropertyInterface(e.w)},dash:{get:function(){return l}},_name:{value:t.nm},mn:{value:t.mn}}),e.c.setGroupProperty(PropertyInterface("Color",n)),e.o.setGroupProperty(PropertyInterface("Opacity",n)),e.w.setGroupProperty(PropertyInterface("Stroke Width",n)),c}function o(t,e,r){function i(e){return e===t.e.ix||"End"===e||"end"===e?i.end:e===t.s.ix?i.start:e===t.o.ix?i.offset:null}var n=propertyGroupFactory(i,r);return i.propertyIndex=t.ix,e.s.setGroupProperty(PropertyInterface("Start",n)),e.e.setGroupProperty(PropertyInterface("End",n)),e.o.setGroupProperty(PropertyInterface("Offset",n)),i.propertyIndex=t.ix,i.propertyGroup=r,Object.defineProperties(i,{start:{get:ExpressionPropertyInterface(e.s)},end:{get:ExpressionPropertyInterface(e.e)},offset:{get:ExpressionPropertyInterface(e.o)},_name:{value:t.nm}}),i.mn=t.mn,i}function s(t,e,r){function i(e){return t.a.ix===e||"Anchor Point"===e?i.anchorPoint:t.o.ix===e||"Opacity"===e?i.opacity:t.p.ix===e||"Position"===e?i.position:t.r.ix===e||"Rotation"===e||"ADBE Vector Rotation"===e?i.rotation:t.s.ix===e||"Scale"===e?i.scale:t.sk&&t.sk.ix===e||"Skew"===e?i.skew:t.sa&&t.sa.ix===e||"Skew Axis"===e?i.skewAxis:null}var n=propertyGroupFactory(i,r);return e.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",n)),e.transform.mProps.p.setGroupProperty(PropertyInterface("Position",n)),e.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",n)),e.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",n)),e.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",n)),e.transform.mProps.sk&&(e.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",n)),e.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",n))),e.transform.op.setGroupProperty(PropertyInterface("Opacity",n)),Object.defineProperties(i,{opacity:{get:ExpressionPropertyInterface(e.transform.mProps.o)},position:{get:ExpressionPropertyInterface(e.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(e.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(e.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(e.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(e.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(e.transform.mProps.sa)},_name:{value:t.nm}}),i.ty="tr",i.mn=t.mn,i.propertyGroup=r,i}function a(t,e,r){function i(e){return t.p.ix===e?i.position:t.s.ix===e?i.size:null}var n=propertyGroupFactory(i,r);i.propertyIndex=t.ix;var o="tm"===e.sh.ty?e.sh.prop:e.sh;return o.s.setGroupProperty(PropertyInterface("Size",n)),o.p.setGroupProperty(PropertyInterface("Position",n)),Object.defineProperties(i,{size:{get:ExpressionPropertyInterface(o.s)},position:{get:ExpressionPropertyInterface(o.p)},_name:{value:t.nm}}),i.mn=t.mn,i}function l(t,e,r){function i(e){return t.p.ix===e?i.position:t.r.ix===e?i.rotation:t.pt.ix===e?i.points:t.or.ix===e||"ADBE Vector Star Outer Radius"===e?i.outerRadius:t.os.ix===e?i.outerRoundness:!t.ir||t.ir.ix!==e&&"ADBE Vector Star Inner Radius"!==e?t.is&&t.is.ix===e?i.innerRoundness:null:i.innerRadius}var n=propertyGroupFactory(i,r),o="tm"===e.sh.ty?e.sh.prop:e.sh;return i.propertyIndex=t.ix,o.or.setGroupProperty(PropertyInterface("Outer Radius",n)),o.os.setGroupProperty(PropertyInterface("Outer Roundness",n)),o.pt.setGroupProperty(PropertyInterface("Points",n)),o.p.setGroupProperty(PropertyInterface("Position",n)),o.r.setGroupProperty(PropertyInterface("Rotation",n)),t.ir&&(o.ir.setGroupProperty(PropertyInterface("Inner Radius",n)),o.is.setGroupProperty(PropertyInterface("Inner Roundness",n))),Object.defineProperties(i,{position:{get:ExpressionPropertyInterface(o.p)},rotation:{get:ExpressionPropertyInterface(o.r)},points:{get:ExpressionPropertyInterface(o.pt)},outerRadius:{get:ExpressionPropertyInterface(o.or)},outerRoundness:{get:ExpressionPropertyInterface(o.os)},innerRadius:{get:ExpressionPropertyInterface(o.ir)},innerRoundness:{get:ExpressionPropertyInterface(o.is)},_name:{value:t.nm}}),i.mn=t.mn,i}function c(t,e,r){function i(e){return t.p.ix===e?i.position:t.r.ix===e?i.roundness:t.s.ix===e||"Size"===e||"ADBE Vector Rect Size"===e?i.size:null}var n=propertyGroupFactory(i,r),o="tm"===e.sh.ty?e.sh.prop:e.sh;return i.propertyIndex=t.ix,o.p.setGroupProperty(PropertyInterface("Position",n)),o.s.setGroupProperty(PropertyInterface("Size",n)),o.r.setGroupProperty(PropertyInterface("Rotation",n)),Object.defineProperties(i,{position:{get:ExpressionPropertyInterface(o.p)},roundness:{get:ExpressionPropertyInterface(o.r)},size:{get:ExpressionPropertyInterface(o.s)},_name:{value:t.nm}}),i.mn=t.mn,i}function u(t,e,r){function i(e){return t.r.ix===e||"Round Corners 1"===e?i.radius:null}var n=propertyGroupFactory(i,r),o=e;return i.propertyIndex=t.ix,o.rd.setGroupProperty(PropertyInterface("Radius",n)),Object.defineProperties(i,{radius:{get:ExpressionPropertyInterface(o.rd)},_name:{value:t.nm}}),i.mn=t.mn,i}function h(t,e,r){function i(e){return t.c.ix===e||"Copies"===e?i.copies:t.o.ix===e||"Offset"===e?i.offset:null}var n=propertyGroupFactory(i,r),o=e;return i.propertyIndex=t.ix,o.c.setGroupProperty(PropertyInterface("Copies",n)),o.o.setGroupProperty(PropertyInterface("Offset",n)),Object.defineProperties(i,{copies:{get:ExpressionPropertyInterface(o.c)},offset:{get:ExpressionPropertyInterface(o.o)},_name:{value:t.nm}}),i.mn=t.mn,i}return function(e,r,i){var n;function o(t){if("number"==typeof t)return 0===(t=void 0===t?1:t)?i:n[t-1];for(var e=0,r=n.length;e<r;){if(n[e]._name===t)return n[e];e+=1}return null}return o.propertyGroup=propertyGroupFactory(o,(function(){return i})),n=t(e,r,o.propertyGroup),o.numProperties=n.length,o._name="Contents",o}}(),TextExpressionInterface=function(t){var e,r;function i(t){return"ADBE Text Document"===t?i.sourceText:null}return Object.defineProperty(i,"sourceText",{get:function(){t.textProperty.getValue();var i=t.textProperty.currentData.t;return i!==e&&(t.textProperty.currentData.t=e,(r=new String(i)).value=i||new String(i)),r}}),i},LayerExpressionInterface=function(){function t(t){var e=new Matrix;return void 0!==t?this._elem.finalTransform.mProp.getValueAtTime(t).clone(e):this._elem.finalTransform.mProp.applyToMatrix(e),e}function e(t,e){var r=this.getMatrix(e);return r.props[12]=0,r.props[13]=0,r.props[14]=0,this.applyPoint(r,t)}function r(t,e){var r=this.getMatrix(e);return this.applyPoint(r,t)}function i(t,e){var r=this.getMatrix(e);return r.props[12]=0,r.props[13]=0,r.props[14]=0,this.invertPoint(r,t)}function n(t,e){var r=this.getMatrix(e);return this.invertPoint(r,t)}function o(t,e){if(this._elem.hierarchy&&this._elem.hierarchy.length){var r,i=this._elem.hierarchy.length;for(r=0;r<i;r+=1)this._elem.hierarchy[r].finalTransform.mProp.applyToMatrix(t)}return t.applyToPointArray(e[0],e[1],e[2]||0)}function s(t,e){if(this._elem.hierarchy&&this._elem.hierarchy.length){var r,i=this._elem.hierarchy.length;for(r=0;r<i;r+=1)this._elem.hierarchy[r].finalTransform.mProp.applyToMatrix(t)}return t.inversePoint(e)}function a(t){var e=new Matrix;if(e.reset(),this._elem.finalTransform.mProp.applyToMatrix(e),this._elem.hierarchy&&this._elem.hierarchy.length){var r,i=this._elem.hierarchy.length;for(r=0;r<i;r+=1)this._elem.hierarchy[r].finalTransform.mProp.applyToMatrix(e);return e.inversePoint(t)}return e.inversePoint(t)}function l(){return[1,1,1,1]}return function(c){var u;function h(t){switch(t){case"ADBE Root Vectors Group":case"Contents":case 2:return h.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return u;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return h.effect;case"ADBE Text Properties":return h.textInterface;default:return null}}h.getMatrix=t,h.invertPoint=s,h.applyPoint=o,h.toWorld=r,h.toWorldVec=e,h.fromWorld=n,h.fromWorldVec=i,h.toComp=r,h.fromComp=a,h.sampleImage=l,h.sourceRectAtTime=c.sourceRectAtTime.bind(c),h._elem=c;var d=getDescriptor(u=TransformExpressionInterface(c.finalTransform.mProp),"anchorPoint");return Object.defineProperties(h,{hasParent:{get:function(){return c.hierarchy.length}},parent:{get:function(){return c.hierarchy[0].layerInterface}},rotation:getDescriptor(u,"rotation"),scale:getDescriptor(u,"scale"),position:getDescriptor(u,"position"),opacity:getDescriptor(u,"opacity"),anchorPoint:d,anchor_point:d,transform:{get:function(){return u}},active:{get:function(){return c.isInRange}}}),h.startTime=c.data.st,h.index=c.data.ind,h.source=c.data.refId,h.height=0===c.data.ty?c.data.h:100,h.width=0===c.data.ty?c.data.w:100,h.inPoint=c.data.ip/c.comp.globalData.frameRate,h.outPoint=c.data.op/c.comp.globalData.frameRate,h._name=c.data.nm,h.registerMaskInterface=function(t){h.mask=new MaskManagerInterface(t,c)},h.registerEffectsInterface=function(t){h.effect=t},h}}(),FootageInterface=(dataInterfaceFactory=function(t){function e(t){return"Outline"===t?e.outlineInterface():null}return e._name="Outline",e.outlineInterface=function(t){var e="",r=t.getFootageData();function i(t){if(r[t])return e=t,"object"==typeof(r=r[t])?i:r;var n=t.indexOf(e);if(-1!==n){var o=parseInt(t.substr(n+e.length),10);return"object"==typeof(r=r[o])?i:r}return""}return function(){return e="",r=t.getFootageData(),i}}(t),e},function(t){function e(t){return"Data"===t?e.dataInterface:null}return e._name="Data",e.dataInterface=dataInterfaceFactory(t),e}),dataInterfaceFactory,CompExpressionInterface=function(t){function e(e){for(var r=0,i=t.layers.length;r<i;){if(t.layers[r].nm===e||t.layers[r].ind===e)return t.elements[r].layerInterface;r+=1}return null}return Object.defineProperty(e,"_name",{value:t.data.nm}),e.layer=e,e.pixelAspect=1,e.height=t.data.h||t.globalData.compSize.h,e.width=t.data.w||t.globalData.compSize.w,e.pixelAspect=1,e.frameDuration=1/t.globalData.frameRate,e.displayStartTime=0,e.numLayers=t.layers.length,e},TransformExpressionInterface=function(t){function e(t){switch(t){case"scale":case"Scale":case"ADBE Scale":case 6:return e.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return e.rotation;case"ADBE Rotate X":return e.xRotation;case"ADBE Rotate Y":return e.yRotation;case"position":case"Position":case"ADBE Position":case 2:return e.position;case"ADBE Position_0":return e.xPosition;case"ADBE Position_1":return e.yPosition;case"ADBE Position_2":return e.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return e.anchorPoint;case"opacity":case"Opacity":case 11:return e.opacity;default:return null}}var r,i,n,o;return Object.defineProperty(e,"rotation",{get:ExpressionPropertyInterface(t.r||t.rz)}),Object.defineProperty(e,"zRotation",{get:ExpressionPropertyInterface(t.rz||t.r)}),Object.defineProperty(e,"xRotation",{get:ExpressionPropertyInterface(t.rx)}),Object.defineProperty(e,"yRotation",{get:ExpressionPropertyInterface(t.ry)}),Object.defineProperty(e,"scale",{get:ExpressionPropertyInterface(t.s)}),t.p?o=ExpressionPropertyInterface(t.p):(r=ExpressionPropertyInterface(t.px),i=ExpressionPropertyInterface(t.py),t.pz&&(n=ExpressionPropertyInterface(t.pz))),Object.defineProperty(e,"position",{get:function(){return t.p?o():[r(),i(),n?n():0]}}),Object.defineProperty(e,"xPosition",{get:ExpressionPropertyInterface(t.px)}),Object.defineProperty(e,"yPosition",{get:ExpressionPropertyInterface(t.py)}),Object.defineProperty(e,"zPosition",{get:ExpressionPropertyInterface(t.pz)}),Object.defineProperty(e,"anchorPoint",{get:ExpressionPropertyInterface(t.a)}),Object.defineProperty(e,"opacity",{get:ExpressionPropertyInterface(t.o)}),Object.defineProperty(e,"skew",{get:ExpressionPropertyInterface(t.sk)}),Object.defineProperty(e,"skewAxis",{get:ExpressionPropertyInterface(t.sa)}),Object.defineProperty(e,"orientation",{get:ExpressionPropertyInterface(t.or)}),e},ProjectInterface=function(){function t(t){this.compositions.push(t)}return function(){function e(t){for(var e=0,r=this.compositions.length;e<r;){if(this.compositions[e].data&&this.compositions[e].data.nm===t)return this.compositions[e].prepareFrame&&this.compositions[e].data.xt&&this.compositions[e].prepareFrame(this.currentFrame),this.compositions[e].compInterface;e+=1}return null}return e.compositions=[],e.currentFrame=0,e.registerComposition=t,e}}(),EffectsExpressionInterface=function(){var t={createEffectsInterface:function(t,r){if(t.effectsManager){var i,n=[],o=t.data.ef,s=t.effectsManager.effectElements.length;for(i=0;i<s;i+=1)n.push(e(o[i],t.effectsManager.effectElements[i],r,t));var a=t.data.ef||[],l=function(t){for(i=0,s=a.length;i<s;){if(t===a[i].nm||t===a[i].mn||t===a[i].ix)return n[i];i+=1}return null};return Object.defineProperty(l,"numProperties",{get:function(){return a.length}}),l}return null}};function e(t,i,n,o){function s(e){for(var r=t.ef,i=0,n=r.length;i<n;){if(e===r[i].nm||e===r[i].mn||e===r[i].ix)return 5===r[i].ty?c[i]:c[i]();i+=1}throw new Error}var a,l=propertyGroupFactory(s,n),c=[],u=t.ef.length;for(a=0;a<u;a+=1)5===t.ef[a].ty?c.push(e(t.ef[a],i.effectElements[a],i.effectElements[a].propertyGroup,o)):c.push(r(i.effectElements[a],t.ef[a].ty,o,l));return"ADBE Color Control"===t.mn&&Object.defineProperty(s,"color",{get:function(){return c[0]()}}),Object.defineProperties(s,{numProperties:{get:function(){return t.np}},_name:{value:t.nm},propertyGroup:{value:l}}),s.enabled=0!==t.en,s.active=s.enabled,s}function r(t,e,r,i){var n=ExpressionPropertyInterface(t.p);return t.p.setGroupProperty&&t.p.setGroupProperty(PropertyInterface("",i)),function(){return 10===e?r.comp.compInterface(t.p.v):n()}}return t}(),MaskManagerInterface=function(){function t(t,e){this._mask=t,this._data=e}return Object.defineProperty(t.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(t.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),100*this._mask.op.v}}),function(e){var r,i=createSizedArray(e.viewData.length),n=e.viewData.length;for(r=0;r<n;r+=1)i[r]=new t(e.viewData[r],e.masksProperties[r]);return function(t){for(r=0;r<n;){if(e.masksProperties[r].nm===t)return i[r];r+=1}return null}}}(),ExpressionPropertyInterface=function(){var t={pv:0,v:0,mult:1},e={pv:[0,0,0],v:[0,0,0],mult:1};function r(t,e,r){Object.defineProperty(t,"velocity",{get:function(){return e.getVelocityAtTime(e.comp.currentFrame)}}),t.numKeys=e.keyframes?e.keyframes.length:0,t.key=function(i){if(!t.numKeys)return 0;var n;n="s"in e.keyframes[i-1]?e.keyframes[i-1].s:"e"in e.keyframes[i-2]?e.keyframes[i-2].e:e.keyframes[i-2].s;var o="unidimensional"===r?new Number(n):Object.assign({},n);return o.time=e.keyframes[i-1].t/e.elem.comp.globalData.frameRate,o.value="unidimensional"===r?n[0]:n,o},t.valueAtTime=e.getValueAtTime,t.speedAtTime=e.getSpeedAtTime,t.velocityAtTime=e.getVelocityAtTime,t.propertyGroup=e.propertyGroup}function i(){return t}return function(n){return n?"unidimensional"===n.propType?function(e){e&&"pv"in e||(e=t);var i=1/e.mult,n=e.pv*i,o=new Number(n);return o.value=n,r(o,e,"unidimensional"),function(){return e.k&&e.getValue(),n=e.v*i,o.value!==n&&((o=new Number(n)).value=n,r(o,e,"unidimensional")),o}}(n):function(t){t&&"pv"in t||(t=e);var i=1/t.mult,n=t.data&&t.data.l||t.pv.length,o=createTypedArray("float32",n),s=createTypedArray("float32",n);return o.value=s,r(o,t,"multidimensional"),function(){t.k&&t.getValue();for(var e=0;e<n;e+=1)s[e]=t.v[e]*i,o[e]=s[e];return o}}(n):i}}(),TextExpressionSelectorPropFactory=function(){function t(t,e){return this.textIndex=t+1,this.textTotal=e,this.v=this.getValue()*this.mult,this.v}return function(e,r){this.pv=1,this.comp=e.comp,this.elem=e,this.mult=.01,this.propType="textSelector",this.textTotal=r.totalChars,this.selectorValue=100,this.lastValue=[1,1,1],this.k=!0,this.x=!0,this.getValue=ExpressionManager.initiateExpression.bind(this)(e,r,this),this.getMult=t,this.getVelocityAtTime=expressionHelpers.getVelocityAtTime,this.kf?this.getValueAtTime=expressionHelpers.getValueAtTime.bind(this):this.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(this),this.setGroupProperty=expressionHelpers.setGroupProperty}}(),propertyGetTextProp=TextSelectorProp.getTextSelectorProp;function SliderEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,0,0,r)}function AngleEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,0,0,r)}function ColorEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,1,0,r)}function PointEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,1,0,r)}function LayerIndexEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,0,0,r)}function MaskIndexEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,0,0,r)}function CheckboxEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,0,0,r)}function NoValueEffect(){this.p={}}function EffectsManager(t,e){var r,i=t.ef||[];this.effectElements=[];var n,o=i.length;for(r=0;r<o;r+=1)n=new GroupEffect(i[r],e),this.effectElements.push(n)}function GroupEffect(t,e){this.init(t,e)}TextSelectorProp.getTextSelectorProp=function(t,e,r){return 1===e.t?new TextExpressionSelectorPropFactory(t,e,r):propertyGetTextProp(t,e,r)},extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(t,e){var r;this.data=t,this.effectElements=[],this.initDynamicPropertyContainer(e);var i,n=this.data.ef.length,o=this.data.ef;for(r=0;r<n;r+=1){switch(i=null,o[r].ty){case 0:i=new SliderEffect(o[r],e,this);break;case 1:i=new AngleEffect(o[r],e,this);break;case 2:i=new ColorEffect(o[r],e,this);break;case 3:i=new PointEffect(o[r],e,this);break;case 4:case 7:i=new CheckboxEffect(o[r],e,this);break;case 10:i=new LayerIndexEffect(o[r],e,this);break;case 11:i=new MaskIndexEffect(o[r],e,this);break;case 5:i=new EffectsManager(o[r],e,this);break;default:i=new NoValueEffect(o[r],e,this)}i&&this.effectElements.push(i)}};var lottie={};function setLocationHref(t){locationHref=t}function searchAnimations(){!0===standalone?animationManager.searchAnimations(animationData,standalone,renderer):animationManager.searchAnimations()}function setSubframeRendering(t){subframeEnabled=t}function setIDPrefix(t){idPrefix=t}function loadAnimation(t){return!0===standalone&&(t.animationData=JSON.parse(animationData)),animationManager.loadAnimation(t)}function setQuality(t){if("string"==typeof t)switch(t){case"high":defaultCurveSegments=200;break;default:case"medium":defaultCurveSegments=50;break;case"low":defaultCurveSegments=10}else!isNaN(t)&&t>1&&(defaultCurveSegments=t);roundValues(!(defaultCurveSegments>=50))}function inBrowser(){return"undefined"!=typeof navigator}function installPlugin(t,e){"expressions"===t&&(expressionsPlugin=e)}function getFactory(t){switch(t){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}function checkReady(){"complete"===document.readyState&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(t){for(var e=queryString.split("&"),r=0;r<e.length;r+=1){var i=e[r].split("=");if(decodeURIComponent(i[0])==t)return decodeURIComponent(i[1])}return null}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocationHref,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=function(t){_useWebWorker=t},lottie.setIDPrefix=setIDPrefix,lottie.__getFactory=getFactory,lottie.version="5.8.1";var standalone="__[STANDALONE]__",animationData="__[ANIMATIONDATA]__",renderer="",queryString;if(standalone){var scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src.replace(/^[^\?]+\??/,""),renderer=getQueryVariable("renderer")}var readyStateCheckInterval=setInterval(checkReady,100);return lottie},module.exports?module.exports=factory(root):(root.lottie=factory(root),root.bodymovin=root.lottie))})(lottie$1);var lottie=lottie$1.exports,_templateObject$1,styles=r$3(_templateObject$1||(_templateObject$1=_taggedTemplateLiteral(["\n  * {\n    box-sizing: border-box;\n  }\n\n  :host {\n    --lottie-player-toolbar-height: 35px;\n    --lottie-player-toolbar-background-color: transparent;\n    --lottie-player-toolbar-icon-color: #999;\n    --lottie-player-toolbar-icon-hover-color: #222;\n    --lottie-player-toolbar-icon-active-color: #555;\n    --lottie-player-seeker-track-color: #ccc;\n    --lottie-player-seeker-thumb-color: rgba(0, 107, 120, 0.8);\n    --lottie-player-seeker-display: block;\n\n    display: block;\n    width: 100%;\n    height: 100%;\n  }\n\n  .main {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    width: 100%;\n  }\n\n  .animation {\n    width: 100%;\n    height: 100%;\n    display: flex;\n  }\n  .animation.controls {\n    height: calc(100% - 35px);\n  }\n\n  .toolbar {\n    display: flex;\n    align-items: center;\n    justify-items: center;\n    background-color: var(--lottie-player-toolbar-background-color);\n    margin: 0 5px;\n    height: 35px;\n  }\n\n  .toolbar button {\n    cursor: pointer;\n    fill: var(--lottie-player-toolbar-icon-color);\n    display: flex;\n    background: none;\n    border: 0;\n    padding: 0;\n    outline: none;\n    height: 100%;\n  }\n\n  .toolbar button:hover {\n    fill: var(--lottie-player-toolbar-icon-hover-color);\n  }\n\n  .toolbar button.active {\n    fill: var(--lottie-player-toolbar-icon-active-color);\n  }\n\n  .toolbar button.active:hover {\n    fill: var(--lottie-player-toolbar-icon-hover-color);\n  }\n\n  .toolbar button:focus {\n    outline: 1px dotted var(--lottie-player-toolbar-icon-active-color);\n  }\n\n  .toolbar button svg {\n  }\n\n  .toolbar button.disabled svg {\n    display: none;\n  }\n\n  .seeker {\n    -webkit-appearance: none;\n    width: 95%;\n    outline: none;\n    background-color: var(--lottie-player-toolbar-background-color);\n    display: var(--lottie-player-seeker-display);\n  }\n\n  .seeker::-webkit-slider-runnable-track {\n    width: 100%;\n    height: 5px;\n    cursor: pointer;\n    background: var(--lottie-player-seeker-track-color);\n    border-radius: 3px;\n  }\n  .seeker::-webkit-slider-thumb {\n    height: 15px;\n    width: 15px;\n    border-radius: 50%;\n    background: var(--lottie-player-seeker-thumb-color);\n    cursor: pointer;\n    -webkit-appearance: none;\n    margin-top: -5px;\n  }\n  .seeker:focus::-webkit-slider-runnable-track {\n    background: #999;\n  }\n  .seeker::-moz-range-track {\n    width: 100%;\n    height: 5px;\n    cursor: pointer;\n    background: var(--lottie-player-seeker-track-color);\n    border-radius: 3px;\n  }\n  .seeker::-moz-range-thumb {\n    height: 15px;\n    width: 15px;\n    border-radius: 50%;\n    background: var(--lottie-player-seeker-thumb-color);\n    cursor: pointer;\n  }\n  .seeker::-ms-track {\n    width: 100%;\n    height: 5px;\n    cursor: pointer;\n    background: transparent;\n    border-color: transparent;\n    color: transparent;\n  }\n  .seeker::-ms-fill-lower {\n    background: var(--lottie-player-seeker-track-color);\n    border-radius: 3px;\n  }\n  .seeker::-ms-fill-upper {\n    background: var(--lottie-player-seeker-track-color);\n    border-radius: 3px;\n  }\n  .seeker::-ms-thumb {\n    border: 0;\n    height: 15px;\n    width: 15px;\n    border-radius: 50%;\n    background: var(--lottie-player-seeker-thumb-color);\n    cursor: pointer;\n  }\n  .seeker:focus::-ms-fill-lower {\n    background: var(--lottie-player-seeker-track-color);\n  }\n  .seeker:focus::-ms-fill-upper {\n    background: var(--lottie-player-seeker-track-color);\n  }\n\n  .error {\n    display: flex;\n    justify-content: center;\n    height: 100%;\n    align-items: center;\n  }\n"]))),_templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,PlayerState,PlayMode,PlayerEvents;function parseSrc(t){if("object"==typeof t)return t;try{return JSON.parse(t)}catch(e){return new URL(t,window.location.href).toString()}}function isLottie(t){return["v","ip","op","layers","fr","w","h"].every((e=>Object.prototype.hasOwnProperty.call(t,e)))}function fromURL(t){return _fromURL.apply(this,arguments)}function _fromURL(){return(_fromURL=_asyncToGenerator((function*(t){if("string"!=typeof t)throw new Error("The url value must be a string");var e;try{var r=new URL(t),i=yield fetch(r.toString());e=yield i.json()}catch(t){throw new Error("An error occurred while trying to load the Lottie file from URL")}return e}))).apply(this,arguments)}!function(t){t.Destroyed="destroyed",t.Error="error",t.Frozen="frozen",t.Loading="loading",t.Paused="paused",t.Playing="playing",t.Stopped="stopped"}(PlayerState||(PlayerState={})),function(t){t.Bounce="bounce",t.Normal="normal"}(PlayMode||(PlayMode={})),function(t){t.Complete="complete",t.Destroyed="destroyed",t.Error="error",t.Frame="frame",t.Freeze="freeze",t.Load="load",t.Loop="loop",t.Pause="pause",t.Play="play",t.Ready="ready",t.Rendered="rendered",t.Stop="stop"}(PlayerEvents||(PlayerEvents={}));var LottiePlayer=class extends s{constructor(){super(...arguments),this.autoplay=!1,this.background="transparent",this.controls=!1,this.currentState=PlayerState.Loading,this.description="Lottie animation",this.direction=1,this.hover=!1,this.intermission=1,this.loop=!1,this.mode=PlayMode.Normal,this.preserveAspectRatio="xMidYMid meet",this.renderer="svg",this.speed=1,this._io=void 0,this._counter=1}load(t){var e=this;return _asyncToGenerator((function*(){if(e.shadowRoot){var r={container:e.container,loop:!1,autoplay:!1,renderer:e.renderer,rendererSettings:{preserveAspectRatio:e.preserveAspectRatio,clearCanvas:!1,progressiveLoad:!0,hideOnTransparent:!0}};try{var i=parseSrc(t),n={},o="string"==typeof i?"path":"animationData";e._lottie&&e._lottie.destroy(),e.webworkers&&lottie$1.exports.useWebWorker(!0),e._lottie=lottie$1.exports.loadAnimation(Object.assign(Object.assign({},r),{[o]:i})),e._attachEventListeners(),"path"===o?(n=yield fromURL(i),o="animationData"):n=i,isLottie(n)||(e.currentState=PlayerState.Error,e.dispatchEvent(new CustomEvent(PlayerEvents.Error)))}catch(t){e.currentState=PlayerState.Error,e.dispatchEvent(new CustomEvent(PlayerEvents.Error))}}}))()}getLottie(){return this._lottie}play(){this._lottie&&(this._lottie.play(),this.currentState=PlayerState.Playing,this.dispatchEvent(new CustomEvent(PlayerEvents.Play)))}pause(){this._lottie&&(this._lottie.pause(),this.currentState=PlayerState.Paused,this.dispatchEvent(new CustomEvent(PlayerEvents.Pause)))}stop(){this._lottie&&(this._counter=1,this._lottie.stop(),this.currentState=PlayerState.Stopped,this.dispatchEvent(new CustomEvent(PlayerEvents.Stop)))}destroy(){this._lottie&&(this._lottie.destroy(),this._lottie=null,this.currentState=PlayerState.Destroyed,this.dispatchEvent(new CustomEvent(PlayerEvents.Destroyed)),this.remove())}seek(t){if(this._lottie){var e=/^(\d+)(%?)$/.exec(t.toString());if(e){var r="%"===e[2]?this._lottie.totalFrames*Number(e[1])/100:Number(e[1]);this.seeker=r,this.currentState===PlayerState.Playing?this._lottie.goToAndPlay(r,!0):(this._lottie.goToAndStop(r,!0),this._lottie.pause())}}}snapshot(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.shadowRoot){var e=this.shadowRoot.querySelector(".animation svg"),r=(new XMLSerializer).serializeToString(e);if(t){var i=document.createElement("a");i.href="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(r)),i.download="download_".concat(this.seeker,".svg"),document.body.appendChild(i),i.click(),document.body.removeChild(i)}return r}}setSpeed(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._lottie&&this._lottie.setSpeed(t)}setDirection(t){this._lottie&&this._lottie.setDirection(t)}setLooping(t){this._lottie&&(this.loop=t,this._lottie.loop=t)}togglePlay(){return this.currentState===PlayerState.Playing?this.pause():this.play()}toggleLooping(){this.setLooping(!this.loop)}resize(){this._lottie&&this._lottie.resize()}static get styles(){return styles}disconnectedCallback(){this._io&&(this._io.disconnect(),this._io=void 0),document.removeEventListener("visibilitychange",(()=>this._onVisibilityChange())),this.destroy()}render(){var t=this.controls?"main controls":"main",e=this.controls?"animation controls":"animation";return $(_templateObject||(_templateObject=_taggedTemplateLiteral([' <div\n      id="animation-container"\n      class=','\n      lang="en"\n      aria-label=','\n      role="img"\n    >\n      <div\n        id="animation"\n        class=','\n        style="background:',';"\n      >\n        ',"\n      </div>\n      ","\n    </div>"])),t,this.description,e,this.background,this.currentState===PlayerState.Error?$(_templateObject2||(_templateObject2=_taggedTemplateLiteral(['<div class="error">⚠️</div>']))):void 0,this.controls?this.renderControls():void 0)}firstUpdated(){"IntersectionObserver"in window&&(this._io=new IntersectionObserver((t=>{t[0].isIntersecting?this.currentState===PlayerState.Frozen&&this.play():this.currentState===PlayerState.Playing&&this.freeze()})),this._io.observe(this.container)),void 0!==document.hidden&&document.addEventListener("visibilitychange",(()=>this._onVisibilityChange())),this.src&&this.load(this.src),this.dispatchEvent(new CustomEvent(PlayerEvents.Rendered))}renderControls(){var t=this.currentState===PlayerState.Playing,e=this.currentState===PlayerState.Paused,r=this.currentState===PlayerState.Stopped;return $(_templateObject3||(_templateObject3=_taggedTemplateLiteral(['\n      <div\n        id="lottie-controls"\n        aria-label="lottie-animation-controls"\n        class="toolbar"\n      >\n        <button\n          id="lottie-play-button"\n          @click=',"\n          class=",'\n          style="align-items:center;"\n          tabindex="0"\n          aria-label="play-pause"\n        >\n          ','\n        </button>\n        <button\n          id="lottie-stop-button"\n          @click=',"\n          class=",'\n          style="align-items:center;"\n          tabindex="0"\n          aria-label="stop"\n        >\n          <svg width="24" height="24" aria-hidden="true" focusable="false">\n            <path d="M6 6h12v12H6V6z" />\n          </svg>\n        </button>\n        <input\n          id="lottie-seeker-input"\n          class="seeker"\n          type="range"\n          min="0"\n          step="1"\n          max="100"\n          .value=',"\n          @input=","\n          @mousedown=","\n          @mouseup=",'\n          aria-valuemin="1"\n          aria-valuemax="100"\n          role="slider"\n          aria-valuenow=','\n          tabindex="0"\n          aria-label="lottie-seek-input"\n        />\n        <button\n          id="lottie-loop-toggle"\n          @click=',"\n          class=",'\n          style="align-items:center;"\n          tabindex="0"\n          aria-label="loop-toggle"\n        >\n          <svg width="24" height="24" aria-hidden="true" focusable="false">\n            <path\n              d="M17.016 17.016v-4.031h1.969v6h-12v3l-3.984-3.984 3.984-3.984v3h10.031zM6.984 6.984v4.031H5.015v-6h12v-3l3.984 3.984-3.984 3.984v-3H6.984z"\n            />\n          </svg>\n        </button>\n      </div>\n    '])),this.togglePlay,t||e?"active":"",$(t?_templateObject4||(_templateObject4=_taggedTemplateLiteral(['<svg\n                width="24"\n                height="24"\n                aria-hidden="true"\n                focusable="false"\n              >\n                <path\n                  d="M14.016 5.016H18v13.969h-3.984V5.016zM6 18.984V5.015h3.984v13.969H6z"\n                />\n              </svg>'])):_templateObject5||(_templateObject5=_taggedTemplateLiteral(['<svg\n                width="24"\n                height="24"\n                aria-hidden="true"\n                focusable="false"\n              >\n                <path d="M8.016 5.016L18.985 12 8.016 18.984V5.015z" />\n              </svg>']))),this.stop,r?"active":"",this.seeker,this._handleSeekChange,(()=>{this._prevState=this.currentState,this.freeze()}),(()=>{this._prevState===PlayerState.Playing&&this.play()}),this.seeker,this.toggleLooping,this.loop?"active":"")}_onVisibilityChange(){!0===document.hidden&&this.currentState===PlayerState.Playing?this.freeze():this.currentState===PlayerState.Frozen&&this.play()}_handleSeekChange(t){if(this._lottie&&!isNaN(t.target.value)){var e=t.target.value/100*this._lottie.totalFrames;this.seek(e)}}_attachEventListeners(){this._lottie.addEventListener("enterFrame",(()=>{this.seeker=this._lottie.currentFrame/this._lottie.totalFrames*100,this.dispatchEvent(new CustomEvent(PlayerEvents.Frame,{detail:{frame:this._lottie.currentFrame,seeker:this.seeker}}))})),this._lottie.addEventListener("complete",(()=>{if(this.currentState===PlayerState.Playing){if(!this.loop||this.count&&this._counter>=this.count){if(this.dispatchEvent(new CustomEvent(PlayerEvents.Complete)),this.mode!==PlayMode.Bounce)return;if(0===this._lottie.currentFrame)return}this.mode===PlayMode.Bounce?(this.count&&(this._counter+=.5),setTimeout((()=>{this.dispatchEvent(new CustomEvent(PlayerEvents.Loop)),this.currentState===PlayerState.Playing&&(this._lottie.setDirection(-1*this._lottie.playDirection),this._lottie.play())}),this.intermission)):(this.count&&(this._counter+=1),window.setTimeout((()=>{this.dispatchEvent(new CustomEvent(PlayerEvents.Loop)),this.currentState===PlayerState.Playing&&(-1===this.direction?(this.seek("99%"),this.play()):(this._lottie.stop(),this._lottie.play()))}),this.intermission))}else this.dispatchEvent(new CustomEvent(PlayerEvents.Complete))})),this._lottie.addEventListener("DOMLoaded",(()=>{this.setSpeed(this.speed),this.setDirection(this.direction),this.autoplay&&(-1===this.direction&&this.seek("100%"),this.play()),this.dispatchEvent(new CustomEvent(PlayerEvents.Ready))})),this._lottie.addEventListener("data_ready",(()=>{this.dispatchEvent(new CustomEvent(PlayerEvents.Load))})),this._lottie.addEventListener("data_failed",(()=>{this.currentState=PlayerState.Error,this.dispatchEvent(new CustomEvent(PlayerEvents.Error))})),this.container.addEventListener("mouseenter",(()=>{this.hover&&this.currentState!==PlayerState.Playing&&this.play()})),this.container.addEventListener("mouseleave",(()=>{this.hover&&this.currentState===PlayerState.Playing&&this.stop()}))}freeze(){this._lottie&&(this._lottie.pause(),this.currentState=PlayerState.Frozen,this.dispatchEvent(new CustomEvent(PlayerEvents.Freeze)))}};__decorate([e$5({type:Boolean})],LottiePlayer.prototype,"autoplay",void 0),__decorate([e$5({type:String,reflect:!0})],LottiePlayer.prototype,"background",void 0),__decorate([e$5({type:Boolean})],LottiePlayer.prototype,"controls",void 0),__decorate([e$5({type:Number})],LottiePlayer.prototype,"count",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"currentState",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"description",void 0),__decorate([e$5({type:Number})],LottiePlayer.prototype,"direction",void 0),__decorate([e$5({type:Boolean})],LottiePlayer.prototype,"hover",void 0),__decorate([e$5()],LottiePlayer.prototype,"intermission",void 0),__decorate([e$5({type:Boolean,reflect:!0})],LottiePlayer.prototype,"loop",void 0),__decorate([e$5()],LottiePlayer.prototype,"mode",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"preserveAspectRatio",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"renderer",void 0),__decorate([e$5()],LottiePlayer.prototype,"seeker",void 0),__decorate([e$5({type:Number})],LottiePlayer.prototype,"speed",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"src",void 0),__decorate([e$5({type:Boolean})],LottiePlayer.prototype,"webworkers",void 0),__decorate([i(".animation")],LottiePlayer.prototype,"container",void 0),LottiePlayer=__decorate([n$1("lottie-player")],LottiePlayer)},7846:t=>{var e;self,e=function(){return(()=>{"use strict";var t={311:(t,e,r)=>{r.r(e),r.d(e,{default:()=>It});var i={};function n(){return n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},n.apply(this,arguments)}r.r(i),r.d(i,{CREATED:()=>$,DESTROYED:()=>W,IDLE:()=>H,MOUNTED:()=>G,MOVING:()=>q});var o=Object.keys;function s(t,e){o(t).some((function(r,i){return e(t[r],r,i)}))}function a(t){return o(t).map((function(e){return t[e]}))}function l(t){return"object"==typeof t}function c(t,e){var r=n({},t);return s(e,(function(t,e){l(t)?(l(r[e])||(r[e]={}),r[e]=c(r[e],t)):r[e]=t})),r}function u(t){return Array.isArray(t)?t:[t]}function h(t,e,r){return Math.min(Math.max(t,e>r?r:e),e>r?e:r)}function d(t,e){var r=0;return t.replace(/%s/g,(function(){return u(e)[r++]}))}function p(t){var e=typeof t;return"number"===e&&t>0?parseFloat(t)+"px":"string"===e?t:""}function f(t){return t<10?"0"+t:t}function m(t,e){if("string"==typeof e){var r=_("div",{});E(r,{position:"absolute",width:e}),w(t,r),e=r.clientWidth,x(r)}return+e||0}function g(t,e){return t?t.querySelector(e.split(" ")[0]):null}function y(t,e){return v(t,e)[0]}function v(t,e){return t?a(t.children).filter((function(t){return A(t,e.split(" ")[0])||t.tagName===e})):[]}function _(t,e){var r=document.createElement(t);return s(e,(function(t,e){return M(r,e,t)})),r}function b(t){var e=_("div",{});return e.innerHTML=t,e.firstChild}function x(t){u(t).forEach((function(t){if(t){var e=t.parentElement;e&&e.removeChild(t)}}))}function w(t,e){t&&t.appendChild(e)}function T(t,e){if(t&&e){var r=e.parentElement;r&&r.insertBefore(t,e)}}function E(t,e){t&&s(e,(function(e,r){null!==e&&(t.style[r]=e)}))}function S(t,e,r){t&&u(e).forEach((function(e){e&&t.classList[r?"remove":"add"](e)}))}function P(t,e){S(t,e,!1)}function k(t,e){S(t,e,!0)}function A(t,e){return!!t&&t.classList.contains(e)}function M(t,e,r){t&&t.setAttribute(e,r)}function C(t,e){return t?t.getAttribute(e):""}function I(t,e){u(e).forEach((function(e){u(t).forEach((function(t){return t&&t.removeAttribute(e)}))}))}function O(t){return t.getBoundingClientRect()}var L="slide",D="loop",R="fade";const F=function(t,e){var r,i;return{mount:function(){r=e.Elements.list,t.on("transitionend",(function(t){t.target===r&&i&&i()}),r)},start:function(n,o,s,a,l){var c=t.options,u=e.Controller.edgeIndex,h=c.speed;i=l,t.is(L)&&(0===s&&o>=u||s>=u&&0===o)&&(h=c.rewindSpeed||h),E(r,{transition:"transform "+h+"ms "+c.easing,transform:"translate("+a.x+"px,"+a.y+"px)"})}}},B=function(t,e){var r={mount:function(){i(t.index)},start:function(t,r,n,o,s){var a=e.Elements.track;E(a,{height:p(a.clientHeight)}),i(r),setTimeout((function(){s(),E(a,{height:""})}))}};function i(r){var i=t.options;E(e.Elements.slides[r],{transition:"opacity "+i.speed+"ms "+i.easing})}return r};function z(t){console.error("[SPLIDE] "+t)}function j(t,e){if(!t)throw new Error(e)}var N="splide",V={active:"is-active",visible:"is-visible",loading:"is-loading"},U={type:"slide",rewind:!1,speed:400,rewindSpeed:0,waitForTransition:!0,width:0,height:0,fixedWidth:0,fixedHeight:0,heightRatio:0,autoWidth:!1,autoHeight:!1,perPage:1,perMove:0,clones:0,start:0,focus:!1,gap:0,padding:0,arrows:!0,arrowPath:"",pagination:!0,autoplay:!1,interval:5e3,pauseOnHover:!0,pauseOnFocus:!0,resetProgress:!0,lazyLoad:!1,preloadPages:1,easing:"cubic-bezier(.42,.65,.27,.99)",keyboard:"global",drag:!0,dragAngleThreshold:30,swipeDistanceThreshold:150,flickVelocityThreshold:.6,flickPower:600,flickMaxPages:1,direction:"ltr",cover:!1,accessibility:!0,slideFocus:!0,isNavigation:!1,trimSpace:!0,updateOnMove:!1,throttle:100,destroy:!1,breakpoints:!1,classes:{root:N,slider:N+"__slider",track:N+"__track",list:N+"__list",slide:N+"__slide",container:N+"__slide__container",arrows:N+"__arrows",arrow:N+"__arrow",prev:N+"__arrow--prev",next:N+"__arrow--next",pagination:N+"__pagination",page:N+"__pagination__page",clone:N+"__slide--clone",progress:N+"__progress",bar:N+"__progress__bar",autoplay:N+"__autoplay",play:N+"__play",pause:N+"__pause",spinner:N+"__spinner",sr:N+"__sr"},i18n:{prev:"Previous slide",next:"Next slide",first:"Go to first slide",last:"Go to last slide",slideX:"Go to slide %s",pageX:"Go to page %s",play:"Start autoplay",pause:"Pause autoplay"}},$=1,G=2,H=3,q=4,W=5;function Z(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var X=function(){function t(t,e,r){var n;void 0===e&&(e={}),void 0===r&&(r={}),this.root=t instanceof Element?t:document.querySelector(t),j(this.root,"An invalid element/selector was given."),this.Components=null,this.Event=function(){var t=[],e={on:function(e,r,i,n){void 0===i&&(i=null),void 0===n&&(n={}),e.split(" ").forEach((function(e){i&&i.addEventListener(e,r,n),t.push({event:e,handler:r,elm:i,options:n})}))},off:function(e,i){void 0===i&&(i=null),e.split(" ").forEach((function(e){t=t.filter((function(t){return!t||t.event!==e||t.elm!==i||(r(t),!1)}))}))},emit:function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];t.forEach((function(t){t.elm||t.event.split(".")[0]!==e||t.handler.apply(t,i)}))},destroy:function(){t.forEach(r),t=[]}};function r(t){t.elm&&t.elm.removeEventListener(t.event,t.handler,t.options)}return e}(),this.State=(n=$,{set:function(t){n=t},is:function(t){return t===n}}),this.STATES=i,this._o=c(U,e),this._i=0,this._c=r,this._e={},this._t=null}var e,r,n,o=t.prototype;return o.mount=function(t,e){var r=this;void 0===t&&(t=this._e),void 0===e&&(e=this._t),this.State.set($),this._e=t,this._t=e,this.Components=function(t,e,r){var i={};return s(e,(function(e,r){i[r]=e(t,i,r.toLowerCase())})),r||(r=t.is(R)?B:F),i.Transition=r(t,i),i}(this,c(this._c,t),e);try{s(this.Components,(function(t,e){var i=t.required;void 0===i||i?t.mount&&t.mount():delete r.Components[e]}))}catch(t){return void z(t.message)}var i=this.State;return i.set(G),s(this.Components,(function(t){t.mounted&&t.mounted()})),this.emit("mounted"),i.set(H),this.emit("ready"),E(this.root,{visibility:"visible"}),this.on("move drag",(function(){return i.set(q)})).on("moved dragged",(function(){return i.set(H)})),this},o.sync=function(t){return this.sibling=t,this},o.on=function(t,e,r,i){return void 0===r&&(r=null),void 0===i&&(i={}),this.Event.on(t,e,r,i),this},o.off=function(t,e){return void 0===e&&(e=null),this.Event.off(t,e),this},o.emit=function(t){for(var e,r=arguments.length,i=new Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];return(e=this.Event).emit.apply(e,[t].concat(i)),this},o.go=function(t,e){return void 0===e&&(e=this.options.waitForTransition),(this.State.is(H)||this.State.is(q)&&!e)&&this.Components.Controller.go(t,!1),this},o.is=function(t){return t===this._o.type},o.add=function(t,e){return void 0===e&&(e=-1),this.Components.Elements.add(t,e,this.refresh.bind(this)),this},o.remove=function(t){return this.Components.Elements.remove(t),this.refresh(),this},o.refresh=function(){return this.emit("refresh:before").emit("refresh").emit("resize"),this},o.destroy=function(t){var e=this;if(void 0===t&&(t=!0),!this.State.is($))return a(this.Components).reverse().forEach((function(e){e.destroy&&e.destroy(t)})),this.emit("destroy",t),this.Event.destroy(),this.State.set(W),this;this.on("ready",(function(){return e.destroy(t)}))},e=t,r=[{key:"index",get:function(){return this._i},set:function(t){this._i=parseInt(t)}},{key:"length",get:function(){return this.Components.Elements.length}},{key:"options",get:function(){return this._o},set:function(t){var e=this.State.is($);e||this.emit("update"),this._o=c(this._o,t),e||this.emit("updated",this._o)}},{key:"classes",get:function(){return this._o.classes}},{key:"i18n",get:function(){return this._o.i18n}}],r&&Z(e.prototype,r),n&&Z(e,n),t}();const Y=function(t){var e=C(t.root,"data-splide");if(e)try{t.options=JSON.parse(e)}catch(t){z(t.message)}return{mount:function(){t.State.is($)&&(t.index=t.options.start)}}};var K="rtl",J="ttb",Q="update.slide";const tt=function(t,e){var r=t.root,i=t.classes,n=[];if(!r.id){window.splide=window.splide||{};var o=window.splide.uid||0;window.splide.uid=++o,r.id="splide"+f(o)}var l={mount:function(){var e=this;this.init(),t.on("refresh",(function(){e.destroy(),e.init()})).on("updated",(function(){k(r,c()),P(r,c())}))},destroy:function(){n.forEach((function(t){t.destroy()})),n=[],k(r,c())},init:function(){var t=this;!function(){l.slider=y(r,i.slider),l.track=g(r,"."+i.track),l.list=y(l.track,i.list),j(l.track&&l.list,"Track or list was not found."),l.slides=v(l.list,i.slide);var t=u(i.arrows);l.arrows={prev:g(t,"."+i.prev),next:g(t,"."+i.next)};var e=u(i.autoplay);l.bar=g(u(i.progress),"."+i.bar),l.play=g(e,"."+i.play),l.pause=g(e,"."+i.pause),l.track.id=l.track.id||r.id+"-track",l.list.id=l.list.id||r.id+"-list"}(),P(r,c()),this.slides.forEach((function(e,r){t.register(e,r,-1)}))},register:function(e,r,i){var o=function(t,e,r,i){var n=t.options.updateOnMove,o="ready.slide updated.slide resized.slide moved.slide"+(n?" move.slide":""),s={slide:i,index:e,realIndex:r,container:y(i,t.classes.container),isClone:r>-1,mount:function(){var s=this;this.isClone||(i.id=t.root.id+"-slide"+f(e+1)),t.on(o,(function(){return s.update()})).on(Q,c).on("click",(function(){return t.emit("click",s)}),i),n&&t.on("move.slide",(function(t){t===r&&l(!0,!1)})),E(i,{display:""}),this.styles=C(i,"style")||""},destroy:function(){t.off(o).off(Q).off("click",i),k(i,a(V)),c(),I(this.container,"style")},update:function(){l(this.isActive(),!1),l(this.isVisible(),!0)},isActive:function(){return t.index===e},isVisible:function(){var e=this.isActive();if(t.is(R)||e)return e;var r=Math.ceil,n=O(t.Components.Elements.track),o=O(i);return t.options.direction===J?n.top<=o.top&&o.bottom<=r(n.bottom):n.left<=o.left&&o.right<=r(n.right)},isWithin:function(r,i){var n=Math.abs(r-e);return t.is(L)||this.isClone||(n=Math.min(n,t.length-n)),n<i}};function l(e,r){var n=r?"visible":"active",o=V[n];e?(P(i,o),t.emit(""+n,s)):A(i,o)&&(k(i,o),t.emit(r?"hidden":"inactive",s))}function c(){M(i,"style",s.styles)}return s}(t,r,i,e);o.mount(),n.push(o)},getSlide:function(t){return n.filter((function(e){return e.index===t}))[0]},getSlides:function(t){return t?n:n.filter((function(t){return!t.isClone}))},getSlidesByPage:function(r){var i=e.Controller.toIndex(r),o=t.options,s=!1!==o.focus?1:o.perPage;return n.filter((function(t){var e=t.index;return i<=e&&e<i+s}))},add:function(t,e,r){if("string"==typeof t&&(t=b(t)),t instanceof Element){var i=this.slides[e];E(t,{display:"none"}),i?(T(t,i),this.slides.splice(e,0,t)):(w(this.list,t),this.slides.push(t)),function(t,e){var r=t.querySelectorAll("img"),i=r.length;if(i){var n=0;s(r,(function(t){t.onload=t.onerror=function(){++n===i&&e()}}))}else e()}(t,(function(){r&&r(t)}))}},remove:function(t){x(this.slides.splice(t,1)[0])},each:function(t){n.forEach(t)},get length(){return this.slides.length},get total(){return n.length}};function c(){var e=i.root,r=t.options;return[e+"--"+r.type,e+"--"+r.direction,r.drag?e+"--draggable":"",r.isNavigation?e+"--nav":"",V.active]}function u(t){return y(r,t)||y(l.slider,t)}return l};var et=Math.floor;const rt=function(t,e){var r,i,n={mount:function(){r=t.options,i=t.is(D),t.on("move",(function(e){t.index=e})).on("updated refresh",(function(e){r=e||r,t.index=h(t.index,0,n.edgeIndex)}))},go:function(t,r){var i=this.trim(this.parse(t));e.Track.go(i,this.rewind(i),r)},parse:function(e){var i=t.index,o=String(e).match(/([+\-<>]+)(\d+)?/),s=o?o[1]:"",a=o?parseInt(o[2]):0;switch(s){case"+":i+=a||1;break;case"-":i-=a||1;break;case">":case"<":i=function(t,e,i){if(t>-1)return n.toIndex(t);var o=r.perMove,s=i?-1:1;return o?e+o*s:n.toIndex(n.toPage(e)+s)}(a,i,"<"===s);break;default:i=parseInt(e)}return i},toIndex:function(e){if(o())return e;var i=t.length,n=r.perPage,s=e*n;return i-n<=(s-=(this.pageLength*n-i)*et(s/i))&&s<i&&(s=i-n),s},toPage:function(e){if(o())return e;var i=t.length,n=r.perPage;return et(i-n<=e&&e<i?(i-1)/n:e/n)},trim:function(t){return i||(t=r.rewind?this.rewind(t):h(t,0,this.edgeIndex)),t},rewind:function(t){var e=this.edgeIndex;if(i){for(;t>e;)t-=e+1;for(;t<0;)t+=e+1}else t>e?t=0:t<0&&(t=e);return t},isRtl:function(){return r.direction===K},get pageLength(){var e=t.length;return o()?e:Math.ceil(e/r.perPage)},get edgeIndex(){var e=t.length;return e?o()||r.isNavigation||i?e-1:e-r.perPage:0},get prevIndex(){var e=t.index-1;return(i||r.rewind)&&(e=this.rewind(e)),e>-1?e:-1},get nextIndex(){var e=t.index+1;return(i||r.rewind)&&(e=this.rewind(e)),t.index<e&&e<=this.edgeIndex||0===e?e:-1}};function o(){return!1!==r.focus}return n};var it=Math.abs;const nt=function(t,e){var r,i,n,o=t.options.direction===J,s=t.is(R),a=t.options.direction===K,l=!1,c=a?1:-1,u={sign:c,mount:function(){i=e.Elements,r=e.Layout,n=i.list},mounted:function(){var e=this;s||(this.jump(0),t.on("mounted resize updated",(function(){e.jump(t.index)})))},go:function(r,i,n){var o=p(r),a=t.index;t.State.is(q)&&l||(l=r!==i,n||t.emit("move",i,a,r),Math.abs(o-this.position)>=1||s?e.Transition.start(r,i,a,this.toCoord(o),(function(){d(r,i,a,n)})):r!==a&&"move"===t.options.trimSpace?e.Controller.go(r+r-a,n):d(r,i,a,n))},jump:function(t){this.translate(p(t))},translate:function(t){E(n,{transform:"translate"+(o?"Y":"X")+"("+t+"px)"})},cancel:function(){t.is(D)?this.shift():this.translate(this.position),E(n,{transition:""})},shift:function(){var e=it(this.position),r=it(this.toPosition(0)),i=it(this.toPosition(t.length)),n=i-r;e<r?e+=n:e>i&&(e-=n),this.translate(c*e)},trim:function(e){return!t.options.trimSpace||t.is(D)?e:h(e,c*(r.totalSize()-r.size-r.gap),0)},toIndex:function(t){var e=this,r=0,n=1/0;return i.getSlides(!0).forEach((function(i){var o=i.index,s=it(e.toPosition(o)-t);s<n&&(n=s,r=o)})),r},toCoord:function(t){return{x:o?0:t,y:o?t:0}},toPosition:function(t){var e=r.totalSize(t)-r.slideSize(t)-r.gap;return c*(e+this.offset(t))},offset:function(e){var i=t.options.focus,n=r.slideSize(e);return"center"===i?-(r.size-n)/2:-(parseInt(i)||0)*(n+r.gap)},get position(){var t=o?"top":a?"right":"left";return O(n)[t]-(O(i.track)[t]-r.padding[t]*c)}};function d(e,r,i,o){E(n,{transition:""}),l=!1,s||u.jump(r),o||t.emit("moved",r,i,e)}function p(t){return u.trim(u.toPosition(t))}return u},ot=function(t,e){var r=[],i=0,n=e.Elements,o={mount:function(){var e=this;t.is(D)&&(s(),t.on("refresh:before",(function(){e.destroy()})).on("refresh",s).on("resize",(function(){i!==a()&&(e.destroy(),t.refresh())})))},destroy:function(){x(r),r=[]},get clones(){return r},get length(){return r.length}};function s(){o.destroy(),function(t){var e=n.length,i=n.register;if(e){for(var o=n.slides;o.length<t;)o=o.concat(o);o.slice(0,t).forEach((function(t,o){var s=l(t);w(n.list,s),r.push(s),i(s,o+e,o%e)})),o.slice(-t).forEach((function(n,s){var a=l(n);T(a,o[0]),r.push(a),i(a,s-t,(e+s-t%e)%e)}))}}(i=a())}function a(){var e=t.options;if(e.clones)return e.clones;var r=e.autoWidth||e.autoHeight?n.length:e.perPage,i=e.direction===J?"Height":"Width",o=m(t.root,e["fixed"+i]);return o&&(r=Math.ceil(n.track["client"+i]/o)),r*(e.drag?e.flickMaxPages+1:1)}function l(e){var r=e.cloneNode(!0);return P(r,t.classes.clone),I(r,"id"),r}return o};function st(t,e){var r;return function(){r||(r=setTimeout((function(){t(),r=null}),e))}}const at=function(t,e){var r,i,n=e.Elements,s=t.options.direction===J,a=(r={mount:function(){t.on("resize load",st((function(){t.emit("resize")}),t.options.throttle),window).on("resize",c).on("updated refresh",l),l(),this.totalSize=s?this.totalHeight:this.totalWidth,this.slideSize=s?this.slideHeight:this.slideWidth},destroy:function(){I([n.list,n.track],"style")},get size(){return s?this.height:this.width}},i=s?function(t,e){var r,i,n=e.Elements,o=t.root;return{margin:"marginBottom",init:function(){this.resize()},resize:function(){i=t.options,r=n.track,this.gap=m(o,i.gap);var e=i.padding,s=m(o,e.top||e),a=m(o,e.bottom||e);this.padding={top:s,bottom:a},E(r,{paddingTop:p(s),paddingBottom:p(a)})},totalHeight:function(e){void 0===e&&(e=t.length-1);var r=n.getSlide(e);return r?O(r.slide).bottom-O(n.list).top+this.gap:0},slideWidth:function(){return m(o,i.fixedWidth||this.width)},slideHeight:function(t){if(i.autoHeight){var e=n.getSlide(t);return e?e.slide.offsetHeight:0}var r=i.fixedHeight||(this.height+this.gap)/i.perPage-this.gap;return m(o,r)},get width(){return r.clientWidth},get height(){var t=i.height||this.width*i.heightRatio;return j(t,'"height" or "heightRatio" is missing.'),m(o,t)-this.padding.top-this.padding.bottom}}}(t,e):function(t,e){var r,i=e.Elements,n=t.root,o=t.options;return{margin:"margin"+(o.direction===K?"Left":"Right"),height:0,init:function(){this.resize()},resize:function(){o=t.options,r=i.track,this.gap=m(n,o.gap);var e=o.padding,s=m(n,e.left||e),a=m(n,e.right||e);this.padding={left:s,right:a},E(r,{paddingLeft:p(s),paddingRight:p(a)})},totalWidth:function(e){void 0===e&&(e=t.length-1);var r=i.getSlide(e),n=0;if(r){var s=O(r.slide),a=O(i.list);n=o.direction===K?a.right-s.left:s.right-a.left,n+=this.gap}return n},slideWidth:function(t){if(o.autoWidth){var e=i.getSlide(t);return e?e.slide.offsetWidth:0}var r=o.fixedWidth||(this.width+this.gap)/o.perPage-this.gap;return m(n,r)},slideHeight:function(){var t=o.height||o.fixedHeight||this.width*o.heightRatio;return m(n,t)},get width(){return r.clientWidth-this.padding.left-this.padding.right}}}(t,e),o(i).forEach((function(t){r[t]||Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(i,t))})),r);function l(){a.init(),E(t.root,{maxWidth:p(t.options.width)}),n.each((function(t){t.slide.style[a.margin]=p(a.gap)})),c()}function c(){var e=t.options;a.resize(),E(n.track,{height:p(a.height)});var r=e.autoHeight?null:p(a.slideHeight());n.each((function(t){E(t.container,{height:r}),E(t.slide,{width:e.autoWidth?null:p(a.slideWidth(t.index)),height:t.container?null:r})})),t.emit("resized")}return a};var lt=Math.abs;const ct=function(t,e){var r,i,n,o,a=e.Track,l=e.Controller,c=t.options.direction===J,u=c?"y":"x",d={disabled:!1,mount:function(){var r=this,i=e.Elements,n=i.track;t.on("touchstart mousedown",p,n).on("touchmove mousemove",m,n,{passive:!1}).on("touchend touchcancel mouseleave mouseup dragend",g,n).on("mounted refresh",(function(){s(i.list.querySelectorAll("img, a"),(function(e){t.off("dragstart",e).on("dragstart",(function(t){t.preventDefault()}),e,{passive:!1})}))})).on("mounted updated",(function(){r.disabled=!t.options.drag}))}};function p(t){d.disabled||o||f(t)}function f(t){r=a.toCoord(a.position),i=y(t,{}),n=i}function m(e){if(i)if(n=y(e,i),o){if(e.cancelable&&e.preventDefault(),!t.is(R)){var s=r[u]+n.offset[u];a.translate(function(e){if(t.is(L)){var r=a.sign,i=r*a.trim(a.toPosition(0)),n=r*a.trim(a.toPosition(l.edgeIndex));(e*=r)<i?e=i-7*Math.log(i-e):e>n&&(e=n+7*Math.log(e-n)),e*=r}return e}(s))}}else(function(e){var r=e.offset;if(t.State.is(q)&&t.options.waitForTransition)return!1;var i=180*Math.atan(lt(r.y)/lt(r.x))/Math.PI;return c&&(i=90-i),i<t.options.dragAngleThreshold})(n)&&(t.emit("drag",i),o=!0,a.cancel(),f(e))}function g(){i=null,o&&(t.emit("dragged",n),function(r){var i=r.velocity[u],n=lt(i);if(n>0){var o=t.options,s=t.index,c=i<0?-1:1,d=s;if(!t.is(R)){var p=a.position;n>o.flickVelocityThreshold&&lt(r.offset[u])<o.swipeDistanceThreshold&&(p+=c*Math.min(n*o.flickPower,e.Layout.size*(o.flickMaxPages||1))),d=a.toIndex(p)}d===s&&n>.1&&(d=s+c*a.sign),t.is(L)&&(d=h(d,0,l.edgeIndex)),l.go(d,o.isNavigation)}}(n),o=!1)}function y(t,e){var r=t.timeStamp,i=t.touches,n=i?i[0]:t,o=n.clientX,s=n.clientY,a=e.to||{},l=a.x,c=void 0===l?o:l,u=a.y,h={x:o-c,y:s-(void 0===u?s:u)},d=r-(e.time||0);return{to:{x:o,y:s},offset:h,time:r,velocity:{x:h.x/d,y:h.y/d}}}return d},ut=function(t,e){var r=!1;function i(t){r&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation())}return{required:t.options.drag,mount:function(){t.on("click",i,e.Elements.track,{capture:!0}).on("drag",(function(){r=!0})).on("dragged",(function(){setTimeout((function(){r=!1}))}))}}};var ht=1,dt=2,pt=3;const ft=function(t,e,r){var i,n,o,s=t.classes,a=t.root,l=e.Elements;function c(){var o=e.Controller,s=o.prevIndex,a=o.nextIndex,l=t.length>t.options.perPage||t.is(D);i.disabled=s<0||!l,n.disabled=a<0||!l,t.emit(r+":updated",i,n,s,a)}function u(e){return b('<button class="'+s.arrow+" "+(e?s.prev:s.next)+'" type="button"><svg xmlns="http://www.w3.org/2000/svg"\tviewBox="0 0 40 40"\twidth="40"\theight="40"><path d="'+(t.options.arrowPath||"m15.5 0.932-4.3 4.38 14.5 14.6-14.5 14.5 4.3 4.4 14.6-14.6 4.4-4.3-4.4-4.4-14.6-14.6z")+'" />')}return{required:t.options.arrows,mount:function(){i=l.arrows.prev,n=l.arrows.next,i&&n||!t.options.arrows||(i=u(!0),n=u(!1),o=!0,function(){var e=_("div",{class:s.arrows});w(e,i),w(e,n);var r=l.slider,o="slider"===t.options.arrows&&r?r:a;T(e,o.firstElementChild)}()),i&&n&&t.on("click",(function(){t.go("<")}),i).on("click",(function(){t.go(">")}),n).on("mounted move updated refresh",c),this.arrows={prev:i,next:n}},mounted:function(){t.emit(r+":mounted",i,n)},destroy:function(){I([i,n],"disabled"),o&&x(i.parentElement)}}};var mt="move.page",gt="updated.page refresh.page";const yt=function(t,e,r){var i={},n=e.Elements,o={mount:function(){var e=t.options.pagination;if(e){i=function(){var e=t.options,r=t.classes,i=_("ul",{class:r.pagination}),o=n.getSlides(!1).filter((function(t){return!1!==e.focus||t.index%e.perPage==0})).map((function(e,o){var s=_("li",{}),a=_("button",{class:r.page,type:"button"});return w(s,a),w(i,s),t.on("click",(function(){t.go(">"+o)}),a),{li:s,button:a,page:o,Slides:n.getSlidesByPage(o)}}));return{list:i,items:o}}();var r=n.slider;w("slider"===e&&r?r:t.root,i.list),t.on(mt,s)}t.off(gt).on(gt,(function(){o.destroy(),t.options.pagination&&(o.mount(),o.mounted())}))},mounted:function(){if(t.options.pagination){var e=t.index;t.emit(r+":mounted",i,this.getItem(e)),s(e,-1)}},destroy:function(){x(i.list),i.items&&i.items.forEach((function(e){t.off("click",e.button)})),t.off(mt),i={}},getItem:function(t){return i.items[e.Controller.toPage(t)]},get data(){return i}};function s(e,n){var s=o.getItem(n),a=o.getItem(e),l=V.active;s&&k(s.button,l),a&&P(a.button,l),t.emit(r+":updated",i,s,a)}return o};var vt="data-splide-lazy",_t="data-splide-lazy-srcset",bt="aria-current",xt="aria-controls",wt="aria-label",Tt="aria-hidden",Et="tabindex",St={ltr:{ArrowLeft:"<",ArrowRight:">",Left:"<",Right:">"},rtl:{ArrowLeft:">",ArrowRight:"<",Left:">",Right:"<"},ttb:{ArrowUp:"<",ArrowDown:">",Up:"<",Down:">"}};const Pt=function(t,e){var r=t.i18n,i=e.Elements,n=[Tt,Et,xt,wt,bt,"role"],o={required:t.options.accessibility,mount:function(){t.on("visible",(function(t){s(t.slide,!0)})).on("hidden",(function(t){s(t.slide,!1)})).on("arrows:mounted",a).on("arrows:updated",l).on("pagination:mounted",c).on("pagination:updated",u).on("refresh",(function(){I(e.Clones.clones,n)})),t.options.isNavigation&&t.on("navigation:mounted navigation:updated",h).on("active",(function(t){p(t,!0)})).on("inactive",(function(t){p(t,!1)})),["play","pause"].forEach((function(t){var e=i[t];e&&(f(e)||M(e,"role","button"),M(e,xt,i.track.id),M(e,wt,r[t]))}))},destroy:function(){var t=e.Arrows,r=t?t.arrows:{};I(i.slides.concat([r.prev,r.next,i.play,i.pause]),n)}};function s(e,r){M(e,Tt,!r),t.options.slideFocus&&M(e,Et,r?0:-1)}function a(t,e){var r=i.track.id;M(t,xt,r),M(e,xt,r)}function l(e,i,n,o){var s=t.index,a=n>-1&&s<n?r.last:r.prev,l=o>-1&&s>o?r.first:r.next;M(e,wt,a),M(i,wt,l)}function c(e,i){i&&M(i.button,bt,!0),e.items.forEach((function(e){var i=t.options,n=d(!1===i.focus&&i.perPage>1?r.pageX:r.slideX,e.page+1),o=e.button,s=e.Slides.map((function(t){return t.slide.id}));M(o,xt,s.join(" ")),M(o,wt,n)}))}function u(t,e,r){e&&I(e.button,bt),r&&M(r.button,bt,!0)}function h(t){i.each((function(e){var i=e.slide,n=e.realIndex;f(i)||M(i,"role","button");var o=n>-1?n:e.index,s=d(r.slideX,o+1),a=t.Components.Elements.getSlide(o);M(i,wt,s),a&&M(i,xt,a.slide.id)}))}function p(t,e){var r=t.slide;e?M(r,bt,!0):I(r,bt)}function f(t){return"BUTTON"===t.tagName}return o};var kt="move.sync",At="mouseup touchend",Mt=[" ","Enter","Spacebar"],Ct={Options:Y,Breakpoints:function(t){var e,r,i=t.options.breakpoints,n=st(s,50),o=[];function s(){var n,s=(n=o.filter((function(t){return t.mql.matches}))[0])?n.point:-1;if(s!==r){r=s;var a=t.State,l=i[s]||e,c=l.destroy;c?(t.options=e,t.destroy("completely"===c)):(a.is(W)&&t.mount(),t.options=l)}}return{required:i&&matchMedia,mount:function(){o=Object.keys(i).sort((function(t,e){return+t-+e})).map((function(t){return{point:t,mql:matchMedia("(max-width:"+t+"px)")}})),this.destroy(!0),addEventListener("resize",n),e=t.options,s()},destroy:function(t){t&&removeEventListener("resize",n)}}},Controller:rt,Elements:tt,Track:nt,Clones:ot,Layout:at,Drag:ct,Click:ut,Autoplay:function(t,e,r){var i,n=[],o=e.Elements,s={required:t.options.autoplay,mount:function(){var e=t.options;o.slides.length>e.perPage&&(i=function(t,e,r){var i,n,o,s=window.requestAnimationFrame,a=!0,l=function l(c){a||(i||(i=c,o&&o<1&&(i-=o*e)),o=(n=c-i)/e,n>=e&&(i=0,o=1,t()),r&&r(o),s(l))};return{pause:function(){a=!0,i=0},play:function(t){i=0,t&&(o=0),a&&(a=!1,s(l))}}}((function(){t.go(">")}),e.interval,(function(e){t.emit(r+":playing",e),o.bar&&E(o.bar,{width:100*e+"%"})})),function(){var e=t.options,r=t.sibling,i=[t.root,r?r.root:null];e.pauseOnHover&&(a(i,"mouseleave",ht,!0),a(i,"mouseenter",ht,!1)),e.pauseOnFocus&&(a(i,"focusout",dt,!0),a(i,"focusin",dt,!1)),o.play&&t.on("click",(function(){s.play(dt),s.play(pt)}),o.play),o.pause&&a([o.pause],"click",pt,!1),t.on("move refresh",(function(){s.play()})).on("destroy",(function(){s.pause()}))}(),this.play())},play:function(e){void 0===e&&(e=0),(n=n.filter((function(t){return t!==e}))).length||(t.emit(r+":play"),i.play(t.options.resetProgress))},pause:function(e){void 0===e&&(e=0),i.pause(),-1===n.indexOf(e)&&n.push(e),1===n.length&&t.emit(r+":pause")}};function a(e,r,i,n){e.forEach((function(e){t.on(r,(function(){s[n?"play":"pause"](i)}),e)}))}return s},Cover:function(t,e){function r(t){e.Elements.each((function(e){var r=y(e.slide,"IMG")||y(e.container,"IMG");r&&r.src&&i(r,t)}))}function i(t,e){E(t.parentElement,{background:e?"":'center/cover no-repeat url("'+t.src+'")'}),E(t,{display:e?"":"none"})}return{required:t.options.cover,mount:function(){t.on("lazyload:loaded",(function(t){i(t,!1)})),t.on("mounted updated refresh",(function(){return r(!1)}))},destroy:function(){r(!0)}}},Arrows:ft,Pagination:yt,LazyLoad:function(t,e,r){var i,n,o=t.options,a="sequential"===o.lazyLoad;function l(){n=[],i=0}function c(e){e=isNaN(e)?t.index:e,(n=n.filter((function(t){return!t.Slide.isWithin(e,o.perPage*(o.preloadPages+1))||(u(t.img,t.Slide),!1)})))[0]||t.off("moved."+r)}function u(e,r){P(r.slide,V.loading);var i=_("span",{class:t.classes.spinner});w(e.parentElement,i),e.onload=function(){d(e,i,r,!1)},e.onerror=function(){d(e,i,r,!0)},M(e,"srcset",C(e,_t)||""),M(e,"src",C(e,vt)||"")}function h(){if(i<n.length){var t=n[i];u(t.img,t.Slide)}i++}function d(e,i,n,o){k(n.slide,V.loading),o||(x(i),E(e,{display:""}),t.emit(r+":loaded",e).emit("resize")),a&&h()}return{required:o.lazyLoad,mount:function(){t.on("mounted refresh",(function(){l(),e.Elements.each((function(t){s(t.slide.querySelectorAll("[data-splide-lazy], ["+_t+"]"),(function(e){e.src||e.srcset||(n.push({img:e,Slide:t}),E(e,{display:"none"}))}))})),a&&h()})),a||t.on("mounted refresh moved."+r,c)},destroy:l}},Keyboard:function(t){var e;return{mount:function(){t.on("mounted updated",(function(){var r=t.options,i=t.root,n=St[r.direction],o=r.keyboard;e&&(t.off("keydown",e),I(i,Et)),o&&("focused"===o?(e=i,M(i,Et,0)):e=document,t.on("keydown",(function(e){n[e.key]&&t.go(n[e.key])}),e))}))}}},Sync:function(t){var e=t.sibling,r=e&&e.options.isNavigation;function i(){t.on(kt,(function(t,r,i){e.off(kt).go(e.is(D)?i:t,!1),n()}))}function n(){e.on(kt,(function(e,r,n){t.off(kt).go(t.is(D)?n:e,!1),i()}))}function o(){e.Components.Elements.each((function(e){var r=e.slide,i=e.index;t.off(At,r).on(At,(function(t){t.button&&0!==t.button||s(i)}),r),t.off("keyup",r).on("keyup",(function(t){Mt.indexOf(t.key)>-1&&(t.preventDefault(),s(i))}),r,{passive:!1})}))}function s(r){t.State.is(H)&&e.go(r)}return{required:!!e,mount:function(){i(),n(),r&&(o(),t.on("refresh",(function(){setTimeout((function(){o(),e.emit("navigation:updated",t)}))})))},mounted:function(){r&&e.emit("navigation:mounted",t)}}},A11y:Pt},It=function(t){var e,r;function i(e,r){return t.call(this,e,r,Ct)||this}return r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r,i}(X)}},e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={exports:{}};return t[i](n,n.exports,r),n.exports}return r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(311)})()},t.exports=e()},5986:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,d(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t,e,r){return(e=d(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>p});var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"connect",value:function(){this.undoHandler=this.undo.bind(this),document.addEventListener("bookmark:undo:".concat(this.indexIdValue),this.undoHandler)}},{key:"disconnect",value:function(){document.removeEventListener("bookmark:undo:".concat(this.indexIdValue),this.undoHandler)}},{key:"undo",value:function(t){this.indexIdValue===t.detail.indexId&&(this.bookmarkedValue?this.remove():this.restore())}},{key:"remove",value:function(){this.toggleBookmark(!1,"Removed from ")}},{key:"restore",value:function(){this.toggleBookmark(!0,"Saved to ")}},{key:"updateDataTrack",value:function(t,e){var r=JSON.parse(this.removeTarget.dataset.track);r[t]=e,this.removeTarget.dataset.track=JSON.stringify(r)}},{key:"toggleBookmark",value:function(t,e){var r=this,i=this.element.style.display;this.element.style.display=t?"":"none",this.bookmarkedValue=t,this.updateDataTrack("bookmark",t?"added":"removed"),this.checkEmptyState(),fetch("/bookmarks/toggle",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({indexId:this.indexIdValue})}).then((function(t){return t.json()})).then((function(t){t.success||!t.redirect?r.showToastMessage(e,t.success?void 0:t.message):window.location.href=t.redirect})).catch((function(e){console.error({error:e}),r.element.style.display=i,r.bookmarkedValue=!t}))}},{key:"showToastMessage",value:function(t,e){var r={message:e||t,account:{text:"My Account",url:"/account/bookmarks/".concat(this.subjectValue)},indexId:this.indexIdValue,undoEventName:"bookmark:undo:".concat(this.indexIdValue)};document.dispatchEvent(new CustomEvent("toast:show",{detail:r}))}},{key:"checkEmptyState",value:function(){var t=document.getElementById("tab-uni"),e=document.getElementById("empty-state");Array.from(t.children).some((function(t){return!t.classList.contains("tw-hidden")&&t!==e&&"none"!==t.style.display}))?e.classList.add("tw-hidden"):e.classList.remove("tw-hidden")}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);h(p,"targets",["remove"]),h(p,"values",{indexId:String,bookmarked:Boolean,subject:String})},3622:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>m});var i=r(2891),n=r(7237),o=r(4292);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,c(i.key),i)}}function c(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}function u(t,e){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},u(t,e)}function h(t){var e=p();return function(){var r,i=f(t);if(e){var n=f(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return d(this,r)}}function d(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(p=function(){return!!t})()}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}n.t1.register(o.A);var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(o,t);var e,r,i,n=h(o);function o(){return a(this,o),n.apply(this,arguments)}return e=o,(r=[{key:"connect",value:function(){this.element.addEventListener("chartjs:pre-connect",this._onPreConnect)}},{key:"disconnect",value:function(){this.element.removeEventListener("chartjs:pre-connect",this._onPreConnect)}},{key:"_onPreConnect",value:function(t){t.detail.options.plugins.datalabels={align:"end",anchor:"start",font:{size:14,weight:600},labels:{title:{color:"white"}},formatter:function(t,e){return"(".concat(t,"%)")}}}}])&&l(e.prototype,r),i&&l(e,i),Object.defineProperty(e,"prototype",{writable:!1}),o}(i.xI)},5464:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>v});var i=r(2891),n=r(8020);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(){s=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function d(t,e,r,i){var o=e&&e.prototype instanceof v?e:v,s=Object.create(o.prototype),a=new I(i||[]);return n(s,"_invoke",{value:k(t,r,a)}),s}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var f="suspendedStart",m="executing",g="completed",y={};function v(){}function _(){}function b(){}var x={};h(x,l,(function(){return this}));var w=Object.getPrototypeOf,T=w&&w(w(O([])));T&&T!==r&&i.call(T,l)&&(x=T);var E=b.prototype=v.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,s,a,l){var c=p(t[n],t,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==o(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,l)}),(function(t){r("throw",t,a,l)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,l)}))}l(c.arg)}var s;n(this,"_invoke",{value:function(t,i){function n(){return new e((function(e,n){r(t,i,e,n)}))}return s=s?s.then(n,n):n()}})}function k(e,r,i){var n=f;return function(o,s){if(n===m)throw Error("Generator is already running");if(n===g){if("throw"===o)throw s;return{value:t,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var l=A(a,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===f)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=m;var c=p(e,r,i);if("normal"===c.type){if(n=i.done?g:"suspendedYield",c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n=g,i.method="throw",i.arg=c.arg)}}}function A(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=p(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(o(e)+" is not iterable")}return _.prototype=b,n(E,"constructor",{value:b,configurable:!0}),n(b,"constructor",{value:_,configurable:!0}),_.displayName=h(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,h(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(P.prototype),h(P.prototype,c,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new P(d(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),h(E,u,"Generator"),h(E,l,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return a.type="throw",a.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;C(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:O(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function a(t,e,r,i,n,o,s){try{var a=t[o](s),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(i,n)}function l(t){return function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function s(t){a(o,i,n,s,l,"next",t)}function l(t){a(o,i,n,s,l,"throw",t)}s(void 0)}))}}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,y(i.key),i)}}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}function d(t){var e=f();return function(){var r,i=m(t);if(e){var n=m(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return p(this,r)}}function p(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function f(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(f=function(){return!!t})()}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}function g(t,e,r){return(e=y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(g,t);var e,r,i,o,a,p,f,m=d(g);function g(){return c(this,g),m.apply(this,arguments)}return e=g,r=[{key:"connect",value:function(){this.setupUndoListener(),this.setupPendingBookmarkListener(),this.globalValue?this.checkAndExecutePendingBookmarks():this.checkAndExecutePendingBookmark()}},{key:"disconnect",value:function(){this.undoHandler&&document.removeEventListener(this.getUndoEventName(),this.undoHandler),!this.globalValue&&this.pendingBookmarkHandler&&document.removeEventListener("bookmark:process-pending",this.pendingBookmarkHandler)}},{key:"setupUndoListener",value:function(){this.undoHandler=this.handleUndoEvent.bind(this),document.addEventListener(this.getUndoEventName(),this.undoHandler)}},{key:"setupPendingBookmarkListener",value:function(){this.globalValue||(this.pendingBookmarkHandler=this.handlePendingBookmarkEvent.bind(this),document.addEventListener("bookmark:process-pending",this.pendingBookmarkHandler))}},{key:"handleUndoEvent",value:function(t){t.detail.indexId===this.indexIdValue&&this.undoBookmark()}},{key:"handlePendingBookmarkEvent",value:function(t){var e=this;t.detail.indexId===this.indexIdValue&&setTimeout((function(){e.updateBookmark()}),100)}},{key:"undoBookmark",value:function(){this.addOrRemove()}},{key:"addOrRemove",value:function(){this.updateBookmark()}},{key:"handleAddOrRemove",value:function(t){t.preventDefault(),t.stopPropagation(),this.updateBookmark()}},{key:"updateDataTrack",value:function(t,e){if(!this.globalValue)try{var r=JSON.parse(this.element.dataset.track||"{}");r[t]=e,this.element.dataset.track=JSON.stringify(r)}catch(t){this.logError("Failed to update data track")}}},{key:"toggleBookmarkState",value:function(){var t=this.bookmarkedValue,e=!t;return this.bookmarkedValue=e,this.updateDataTrack("bookmark",e?"added":"removed"),this.toggleIcon(),{wasBookmarked:t,newState:e}}},{key:"makeBookmarkRequest",value:(f=l(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/bookmarks/toggle",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({indexId:this.indexIdValue})});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},{key:"handleBookmarkResponse",value:(p=l(s().mark((function t(e,r){var i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(403!==e.status){t.next=4;break}return t.next=3,this.handleAuthenticationError(e,r);case 3:return t.abrupt("return",!1);case 4:if(e.ok){t.next=6;break}throw new Error("HTTP ".concat(e.status,": ").concat(e.statusText));case 6:return t.next=8,e.json();case 8:if(null==(i=t.sent)||!i.redirect){t.next=12;break}return window.location.href=i.redirect,t.abrupt("return",!1);case 12:return this.triggerSendDataLayerEvent(),this.showToast(i),t.abrupt("return",!0);case 15:case"end":return t.stop()}}),t,this)}))),function(t,e){return p.apply(this,arguments)})},{key:"handleBookmarkError",value:function(t,e){this.restoreBookmarkState(e),this.showToast({success:!1,message:"Something went wrong. Please try again."}),this.logError("Bookmark toggle failed",t)}},{key:"updateBookmark",value:(a=l(s().mark((function t(){var e,r,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.globalValue){t.next=2;break}return t.abrupt("return");case 2:return e=this.toggleBookmarkState(),r=e.wasBookmarked,t.prev=3,t.next=6,this.makeBookmarkRequest();case 6:return i=t.sent,t.next=9,this.handleBookmarkResponse(i,r);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),this.handleBookmarkError(t.t0,r);case 14:case"end":return t.stop()}}),t,this,[[3,11]])}))),function(){return a.apply(this,arguments)})},{key:"restoreBookmarkState",value:function(t){this.bookmarkedValue=t,this.toggleIcon()}},{key:"triggerSendDataLayerEvent",value:function(){if(!this.globalValue)try{if(!this.hasContainerTarget)return void this.logError("Container target not available for data layer tracking");var t=JSON.parse(this.containerTarget.dataset.track||"{}");(0,n.U)(t)}catch(t){this.logError("Failed to parse tracking data")}}},{key:"isOldProfile",value:function(){return this.iconTarget.querySelectorAll("path").length>1}},{key:"toggleIcon",value:function(){if(this.hasIconTarget){var t=this.iconTarget.querySelectorAll("path");if(this.isOldProfile()){var e=this.bookmarkedValue?"#FBB315":"#7A7A7A",r=this.bookmarkedValue?"#FBB315":"#FFFFFF";t[0].setAttribute("fill",e),t[1].setAttribute("fill",r)}else this.bookmarkedValue?(this.iconTarget.classList.remove("fa-light","tw-text-sc-grey"),this.iconTarget.classList.add("fa-solid","tw-text-sc-gold")):(this.iconTarget.classList.remove("fa-solid","tw-text-sc-gold"),this.iconTarget.classList.add("fa-light","tw-text-sc-grey"));this.iconTarget.setAttribute("title",this.bookmarkedValue?"Remove from bookmarks":"Add to bookmarks")}}},{key:"getToastMessage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t?this.bookmarkedValue?"Saved to ":"Removed from ":e.message||"Something went wrong"}},{key:"showToast",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e="boolean"!=typeof t.success||t.success,r={message:this.getToastMessage(e,t),account:{text:"My Account",url:"/account/bookmarks/".concat(this.subjectValue)},indexId:this.indexIdValue,isMobile:this.isMobileValue,undoEventName:this.getUndoEventName()};document.dispatchEvent(new CustomEvent("toast:show",{detail:r}))}},{key:"savePendingBookmark",value:function(){var t=this;try{var e=[],r=sessionStorage.getItem("pendingBookmarks");if(r)try{e=JSON.parse(r),Array.isArray(e)||(e=[])}catch(t){this.logError("Failed to parse existing pending bookmarks",t)}(e=e.filter((function(e){return e.indexId!==t.indexIdValue}))).push({indexId:this.indexIdValue,action:"toggle",timestamp:Date.now()}),sessionStorage.setItem("pendingBookmarks",JSON.stringify(e))}catch(t){this.logError("Failed to save pending bookmark",t)}}},{key:"checkAndExecutePendingBookmark",value:function(){var t=this;try{if(this.globalValue)return;var e=sessionStorage.getItem("pendingBookmarks");if(!e)return;var r=JSON.parse(e);if(!Array.isArray(r))return;var i=r.findIndex((function(e){return e.indexId===t.indexIdValue}));if(-1===i)return;var n=r[i];Date.now()-n.timestamp>3e5?(r.splice(i,1),sessionStorage.setItem("pendingBookmarks",JSON.stringify(r))):this.isReturnFromLogin()&&(r.splice(i,1),sessionStorage.setItem("pendingBookmarks",JSON.stringify(r)),setTimeout((function(){t.updateBookmark()}),100))}catch(t){this.logError("Failed to check pending bookmark",t)}}},{key:"checkAndExecutePendingBookmarks",value:function(){try{if(!this.globalValue)return;var t=sessionStorage.getItem("pendingBookmarks");if(!t)return;var e=JSON.parse(t);if(!Array.isArray(e)||0===e.length)return void sessionStorage.removeItem("pendingBookmarks");if(!this.isReturnFromLogin())return;var r=Date.now(),i=e.filter((function(t){return r-t.timestamp<=3e5}));if(0===i.length)return void sessionStorage.removeItem("pendingBookmarks");i.forEach((function(t){var e=new CustomEvent("bookmark:process-pending",{detail:{indexId:t.indexId},bubbles:!0});document.dispatchEvent(e)})),sessionStorage.removeItem("pendingBookmarks")}catch(t){this.logError("Failed to process pending bookmarks",t),sessionStorage.removeItem("pendingBookmarks")}}},{key:"isReturnFromLogin",value:function(){try{var t=!1;if(this.hasUserLoggedInTarget)t="true"===this.userLoggedInTarget.value;else{var e=document.querySelector('[data-controller*="login"]');if(e){var r=e.querySelector('[data-login-target="userLoggedIn"]');r&&(t="true"===r.value)}}if(t&&sessionStorage.getItem("pendingBookmarks"))return!0}catch(t){this.logError("Failed to check login status",t)}return!1}},{key:"getUndoEventName",value:function(){return this.isMobileValue?"bookmark:mobile-undo":"bookmark:desktop-undo"}},{key:"handleAuthenticationError",value:(o=l(s().mark((function t(e,r){var i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={},t.prev=1,t.next=4,e.json();case 4:i=t.sent,t.next=12;break;case 7:return t.prev=7,t.t0=t.catch(1),this.savePendingBookmark(),window.location.href="/login",t.abrupt("return");case 12:if(!i.redirect){t.next=16;break}return this.savePendingBookmark(),window.location.href=i.redirect,t.abrupt("return");case 16:this.restoreBookmarkState(r),this.showToast(i);case 18:case"end":return t.stop()}}),t,this,[[1,7]])}))),function(t,e){return o.apply(this,arguments)})},{key:"logError",value:function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null!==(e=window.DD_RUM)&&void 0!==e&&e.addError&&window.DD_RUM.addError(t,{error:r,context:{indexId:this.indexIdValue,bookmarked:this.bookmarkedValue,isMobile:this.isMobileValue}})}}],r&&u(e.prototype,r),i&&u(e,i),Object.defineProperty(e,"prototype",{writable:!1}),g}(i.xI);g(v,"targets",["icon","container","userLoggedIn"]),g(v,"values",{indexId:String,bookmarked:Boolean,isMobile:Boolean,subject:String,global:{type:Boolean,default:!1}})},9239:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,s(i.key),i)}}function s(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function l(t){var e=u();return function(){var r,i=h(t);if(e){var n=h(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return c(this,r)}}function c(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(u=function(){return!!t})()}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}r.r(e),r.d(e,{default:()=>d});var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(c,t);var e,r,i,s=l(c);function c(){return n(this,c),s.apply(this,arguments)}return e=c,(r=[{key:"toggle",value:function(){this.dispatch("toggle",{detail:{content:this.element}})}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI)},7374:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"copy",value:function(t){t.target.classList.add("tw-animate-blink"),navigator.clipboard.writeText(this.sourceTarget.value),setTimeout((function(){t.target.classList.remove("tw-animate-blink")}),1e3)}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["source"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},7674:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>y});var i=r(2891),n=r(6613);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,p(i.key),i)}}function l(t,e){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},l(t,e)}function c(t){var e=h();return function(){var r,i=d(t);if(e){var n=d(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return u(this,r)}}function u(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(h=function(){return!!t})()}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function p(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var f,m,g,y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(u,t);var e,r,i,o=c(u);function u(){return s(this,u),o.apply(this,arguments)}return e=u,(r=[{key:"filtersOverlayTargetConnected",value:function(t){var e=this;window.addEventListener("resize",(function(){return e.onWindowResize()}))}},{key:"onWindowResize",value:function(){(0,n.X)("md").matches&&!this.filtersOverlayTarget.classList.contains("tw-hidden")&&this.filtersOverlayTarget.classList.add("tw-hidden")}},{key:"showOverlay",value:function(t){t.preventDefault(),this.filtersOverlayTarget&&this.filtersOverlayTarget.classList.remove("tw-hidden")}},{key:"hideOverlay",value:function(t){t.preventDefault(),this.filtersOverlayTarget&&this.filtersOverlayTarget.classList.add("tw-hidden")}}])&&a(e.prototype,r),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),u}(i.xI);f=y,g=["filtersOverlay","link"],(m=p(m="targets"))in f?Object.defineProperty(f,m,{value:g,enumerable:!0,configurable:!0,writable:!0}):f[m]=g},6389:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>b});var i=r(2891),n=r(6613);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,m(i.key),i)}}function l(t,e){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},l(t,e)}function c(t){var e=d();return function(){var r,i=p(t);if(e){var n=p(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return u(this,r)}}function u(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function f(t,e,r){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,r)}function m(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var g,y,v,_=new WeakMap,b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(u,t);var e,r,i,o=c(u);function u(){var t;s(this,u);for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return f(h(t=o.call.apply(o,[this].concat(r))),_,{writable:!0,value:null}),t}return e=u,(r=[{key:"moreOptionsTargetConnected",value:function(t){var e=this;window.addEventListener("resize",(function(){return e.onWindowResize()})),this.updateHeight()}},{key:"onWindowResize",value:function(){this.updateHeight()}},{key:"updateHeight",value:function(){this.moreOptionsTarget&&(this.moreOptionsTarget.classList.contains("tw-absolute")||(0,n.X)("md").matches||"0px"===this.moreOptionsTarget.style.height||(this.moreOptionsTarget.style.height="auto",this.moreOptionsHeight=this.moreOptionsTarget.offsetHeight),!this.moreOptionsTarget.classList.contains("tw-absolute")&&(0,n.X)("md").matches&&(this.moreOptionsHeight=null,this.moreOptionsTarget.style.height="auto",this.moreOptionsTarget.classList.add("tw-absolute","tw-invisible")),this.updateLinkText())}},{key:"updateLinkText",value:function(){this.linkTarget&&(this.moreOptionsTarget.style.height==="".concat(this.moreOptionsHeight,"px")||"auto"===this.moreOptionsTarget.style.height&&!this.moreOptionsTarget.classList.contains("tw-absolute")?(this.linkTarget.getElementsByTagName("i").item(0).classList.replace("fa-caret-down","fa-caret-up"),this.linkTarget.innerHTML=this.linkTarget.innerHTML.replace("More","Fewer")):(this.linkTarget.getElementsByTagName("i").item(0).classList.replace("fa-caret-up","fa-caret-down"),this.linkTarget.innerHTML=this.linkTarget.innerHTML.replace("Fewer","More")))}},{key:"toggle",value:function(t){var e=this;t.preventDefault(),this.moreOptionsTarget&&(this.moreOptionsTarget.classList.contains("tw-absolute")&&(this.moreOptionsHeight=this.moreOptionsTarget.offsetHeight,this.moreOptionsTarget.style.height="0px",this.moreOptionsTarget.classList.remove("tw-absolute","tw-invisible")),setTimeout((function(){"0px"===e.moreOptionsTarget.style.height?e.moreOptionsTarget.style.height="".concat(e.moreOptionsHeight,"px"):e.moreOptionsTarget.style.height="0px",e.updateLinkText()}),200))}}])&&a(e.prototype,r),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),u}(i.xI);g=b,v=["moreOptions","link"],(y=m(y="targets"))in g?Object.defineProperty(g,y,{value:v,enumerable:!0,configurable:!0,writable:!0}):g[y]=v},4841:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>y});var i=r(2891),n=r(6613);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(){s=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function d(t,e,r,i){var o=e&&e.prototype instanceof v?e:v,s=Object.create(o.prototype),a=new I(i||[]);return n(s,"_invoke",{value:k(t,r,a)}),s}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var f="suspendedStart",m="executing",g="completed",y={};function v(){}function _(){}function b(){}var x={};h(x,l,(function(){return this}));var w=Object.getPrototypeOf,T=w&&w(w(O([])));T&&T!==r&&i.call(T,l)&&(x=T);var E=b.prototype=v.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,s,a,l){var c=p(t[n],t,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==o(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,l)}),(function(t){r("throw",t,a,l)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,l)}))}l(c.arg)}var s;n(this,"_invoke",{value:function(t,i){function n(){return new e((function(e,n){r(t,i,e,n)}))}return s=s?s.then(n,n):n()}})}function k(e,r,i){var n=f;return function(o,s){if(n===m)throw Error("Generator is already running");if(n===g){if("throw"===o)throw s;return{value:t,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var l=A(a,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===f)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=m;var c=p(e,r,i);if("normal"===c.type){if(n=i.done?g:"suspendedYield",c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n=g,i.method="throw",i.arg=c.arg)}}}function A(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=p(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(o(e)+" is not iterable")}return _.prototype=b,n(E,"constructor",{value:b,configurable:!0}),n(b,"constructor",{value:_,configurable:!0}),_.displayName=h(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,h(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(P.prototype),h(P.prototype,c,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new P(d(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),h(E,u,"Generator"),h(E,l,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return a.type="throw",a.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;C(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:O(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function a(t,e,r,i,n,o,s){try{var a=t[o](s),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(i,n)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,g(i.key),i)}}function u(t,e){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},u(t,e)}function h(t){var e=p();return function(){var r,i=f(t);if(e){var n=f(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return d(this,r)}}function d(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(p=function(){return!!t})()}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function m(t,e,r){return(e=g(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(f,t);var e,r,i,o,d,p=h(f);function f(){return l(this,f),p.apply(this,arguments)}return e=f,r=[{key:"search",value:(o=s().mark((function t(){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==this.abortController&&this.abortController.abort(),!(this.inputTarget.value.length<3)){t.next=4;break}return this.clearResults(),t.abrupt("return");case 4:return this.abortController=new AbortController,t.prev=5,t.next=8,fetch(this.getSearchUrl("q",this.inputTarget.value,this.typeValue),{signal:this.abortController.signal});case 8:return e=t.sent,t.next=11,e.text();case 11:this.resultsTarget.innerHTML=t.sent,t.next=16;break;case 14:t.prev=14,t.t0=t.catch(5);case 16:case"end":return t.stop()}}),t,this,[[5,14]])})),d=function(){var t=this,e=arguments;return new Promise((function(r,i){var n=o.apply(t,e);function s(t){a(n,r,i,s,l,"next",t)}function l(t){a(n,r,i,s,l,"throw",t)}s(void 0)}))},function(){return d.apply(this,arguments)})},{key:"getSearchUrl",value:function(t,e,r){var i=new URLSearchParams;return i.set(t,e),i.set("type",r),i.set("id",this.levelOneValue),this.levelTwoValue&&i.set("parent",this.levelTwoValue),"".concat(this.urlValue,"?").concat(i.toString())}},{key:"getSearchCoursesUrl",value:function(t){var e=new URLSearchParams;return t.forEach((function(t){e.append("slugs[]",t)})),e.set("sortBy",document.getElementById("sort-results").value),"".concat(this.courseUrlValue,"?").concat(e.toString())}},{key:"selectResult",value:function(t){var e=t.target.closest("li");this.setValues(e)}},{key:"setValues",value:function(t){if(this.getAllSelectedFilters().includes(t.dataset.resultSlug))return this.inputTarget.value="",void this.clearResults();var e=(0,n.X)("md").matches?1:0,r=document.querySelectorAll("[id=category-search-selected]")[e],i=document.createElement("span");i.setAttribute("class","tw-bg-sc-light-blue tw-text-white tw-p-1.5 tw-mb-2 tw-cursor-pointer"),i.setAttribute("data-action","click->course-category-search#removeNode"),i.setAttribute("data-url",t.dataset.resultSlug),i.innerHTML="".concat(t.dataset.resultText,'<i class="fas fa-times tw-align-middle tw-ml-2"></i>'),r.prepend(i),this.inputTarget.value="",this.fireChangeEvent(),this.clearResults()}},{key:"fireChangeEvent",value:function(){var t=this.getSearchCoursesUrl(this.getAllSelectedFilters());this.dispatchTurboRequest(t)}},{key:"clearResults",value:function(){this.resultsTarget.innerHTML=""}},{key:"clearAll",value:function(){var t=(0,n.X)("md").matches?1:0;document.querySelectorAll("[id=category-search-selected]")[t].innerHTML="",this.fireChangeEvent()}},{key:"removeNode",value:function(t){var e=t.target;"I"===e.tagName&&(e=e.parentElement),e.remove(),this.fireChangeEvent()}},{key:"getAllSelectedFilters",value:function(){var t=[];return document.querySelectorAll("[id=category-search-selected] span").forEach((function(e){t.push(e.getAttribute("data-url"))})),t}},{key:"dispatchTurboRequest",value:function(t){document.getElementById("course-subcategory").src=t}}],r&&c(e.prototype,r),i&&c(e,i),Object.defineProperty(e,"prototype",{writable:!1}),f}(i.xI);m(y,"targets",["input","results"]),m(y,"values",{url:String,type:String,levelOne:Number,levelTwo:String,courseUrl:String})},9296:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,s(i.key),i)}}function s(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function l(t){var e=u();return function(){var r,i=h(t);if(e){var n=h(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return c(this,r)}}function c(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(u=function(){return!!t})()}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}r.r(e),r.d(e,{default:()=>d});var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(c,t);var e,r,i,s=l(c);function c(){return n(this,c),s.apply(this,arguments)}return e=c,(r=[{key:"onChange",value:function(t){var e=t.target.options[t.target.selectedIndex],r="/".concat(e.getAttribute("data-url-path"));this.element.src=r,this.element.reload()}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI)},9200:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"toggle",value:function(t){var e=t.currentTarget,r=this.questionTargets.indexOf(e),i=this.answerTargets[r],n=this.iconTargets[r];i.classList.toggle("tw-hidden"),i.classList.contains("tw-hidden")?(n.classList.remove("fa-chevron-up"),n.classList.add("fa-chevron-down")):(n.classList.remove("fa-chevron-down"),n.classList.add("fa-chevron-up"))}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["question","answer","icon"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},9094:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"checked",value:function(t){var e=t.detail.content;document.querySelectorAll("input[name="+e.name+"]").forEach((function(t){t.checked=e.checked}))}},{key:"toggle",value:function(t){if(window.innerWidth>769)this.dispatch("toggle",{detail:{content:this.element}});else{this.contentTargets.forEach((function(t){return t.classList.toggle("tw-hidden")}));var e=this.contentTarget.classList.contains("tw-hidden");this.toggleTarget.innerText=e?"Show more":"Show less"}}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["content","toggle"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},414:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,s(i.key),i)}}function s(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function l(t){var e=u();return function(){var r,i=h(t);if(e){var n=h(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return c(this,r)}}function c(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(u=function(){return!!t})()}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}r.r(e),r.d(e,{default:()=>d});var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(c,t);var e,r,i,s=l(c);function c(){return n(this,c),s.apply(this,arguments)}return e=c,(r=[{key:"toggle",value:function(){this.element.classList.toggle("tw-hidden"),document.body.classList.toggle("tw-overflow-hidden")}},{key:"submit",value:function(){document.getElementById("league-table-submit").click(),this.toggle()}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI)},5078:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,s(i.key),i)}}function s(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function l(t){var e=u();return function(){var r,i=h(t);if(e){var n=h(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return c(this,r)}}function c(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(u=function(){return!!t})()}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}r.r(e),r.d(e,{default:()=>d});var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(c,t);var e,r,i,s=l(c);function c(){return n(this,c),s.apply(this,arguments)}return e=c,(r=[{key:"connect",value:function(){this.originalOffset=this.element.offsetTop,this.usesTopBannerReservationOffset=this.element.classList.contains("md:data-[fixed=true]:tw-top-[53px]"),this.setFixed(!1),window.addEventListener("scroll",this.handleScroll.bind(this))}},{key:"disconnect",value:function(){window.removeEventListener("scroll",this.handleScroll.bind(this))}},{key:"setFixed",value:function(t){this.element.setAttribute("data-fixed",t?"true":"false")}},{key:"handleScroll",value:function(){(window.scrollY||document.documentElement.scrollTop)>(this.usesTopBannerReservationOffset?this.originalOffset-53:this.originalOffset)?this.setFixed(!0):this.setFixed(!1)}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI)},9259:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"connect",value:function(){this.footer=document.getElementById("footer"),this.isHidden=!1,this.fixedCtaTarget&&this.footer&&(this.onScroll=this.onScroll.bind(this),window.addEventListener("scroll",this.onScroll))}},{key:"disconnect",value:function(){window.removeEventListener("scroll",this.onScroll)}},{key:"onScroll",value:function(){if(this.fixedCtaTarget&&this.footer){var t=this.footer.getBoundingClientRect(),e=this.fixedCtaTarget.getBoundingClientRect();if(!(t.top<0||e.bottom<0)){var r=e.bottom>t.top;r&&!this.isHidden?(this.fixedCtaTarget.style.opacity="0",this.fixedCtaTarget.style.pointerEvents="none",this.isHidden=!0):!r&&this.isHidden&&(this.fixedCtaTarget.style.opacity="1",this.fixedCtaTarget.style.pointerEvents="auto",this.isHidden=!1)}}}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["fixedCta"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},3211:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,s(i.key),i)}}function s(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function l(t){var e=u();return function(){var r,i=h(t);if(e){var n=h(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return c(this,r)}}function c(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(u=function(){return!!t})()}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}r.r(e),r.d(e,{default:()=>d});var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(c,t);var e,r,i,s=l(c);function c(){return n(this,c),s.apply(this,arguments)}return e=c,(r=[{key:"connect",value:function(){this.updateOptionSelectedClass(),this.changeListener=this.updateOptionSelectedClass.bind(this),this.element.addEventListener("change",this.changeListener)}},{key:"disconnect",value:function(){this.changeListener&&this.element.removeEventListener("change",this.changeListener)}},{key:"updateOptionSelectedClass",value:function(){""===this.element.value?this.element.classList.add("empty"):this.element.classList.remove("empty")}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI)},9382:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,d(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t,e,r){return(e=d(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>p});var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"connect",value:function(){var t=this,e=null,r=null;this.element.addEventListener("touchstart",(function(t){e=t.touches[0].clientX,r=t.touches[0].clientY}),!1),this.element.addEventListener("touchmove",(function(i){if(null!==e&&null!==r){var n=i.touches[0].clientX,o=i.touches[0].clientY,s=e-n,a=r-o;Math.abs(s)>Math.abs(a)&&(s>0?t.next():t.prev()),e=null,r=null,i.preventDefault()}}),!1)}},{key:"next",value:function(){this.positionValue===this.sliderTarget.childElementCount-1?this.positionValue=0:this.positionValue++,this.jump()}},{key:"prev",value:function(){0===this.positionValue?this.positionValue=this.sliderTarget.childElementCount-1:this.positionValue--,this.jump()}},{key:"jump",value:function(){this.sliderTarget.style.marginLeft="-"+100*this.positionValue+"%",this.counterTarget.innerText=this.positionValue+1}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);h(p,"values",{position:Number}),h(p,"targets",["slider","counter","next","prev"])},9940:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>m});var i=r(2891),n=r(8020);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,f(i.key),i)}}function l(t,e){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},l(t,e)}function c(t){var e=h();return function(){var r,i=d(t);if(e){var n=d(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return u(this,r)}}function u(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(h=function(){return!!t})()}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function p(t,e,r){return(e=f(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(u,t);var e,r,i,o=c(u);function u(){return s(this,u),o.apply(this,arguments)}return e=u,(r=[{key:"connect",value:function(){var t=this;this.setImageHeight(),window.addEventListener("resize",(function(){return t.setImageHeight()}))}},{key:"setImageHeight",value:function(){var t=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),e=this.element.querySelector("img.card-image");null!==e&&(e.style.height=t<1024?null:this.element.clientHeight+"px")}},{key:"toggle",value:function(t){var e=t.params.indexId;this.roomDetailsTableTarget.classList.contains("tw-hidden")&&this.trackGTMData(e),this.roomDetailsTableTarget.classList.toggle("tw-hidden"),this.roomDetailsMaskTarget.classList.toggle("tw-hidden");var r=this.hallCardTarget.getBoundingClientRect().width;event.target===this.showRoomDetailsButtonTarget&&r<=420&&this.hallCardTarget.scrollIntoView({behavior:"smooth"})}},{key:"trackGTMData",value:function(t){(0,n.U)({event:"user_event",event_name:"user_event",user_event_type:"room_type_details_click",location:"accommodation-by-location",index_id:t})}}])&&a(e.prototype,r),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),u}(i.xI);p(m,"values",{basePath:String}),p(m,"targets",["roomDetailsMask","showRoomDetailsButton","hideRoomDetailsButton","roomDetailsTable","hallCard"])},8520:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,o(i.key),i)}}function o(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}r.r(e),r.d(e,{default:()=>h});var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(l,t);var e,r,i,o=a(l);function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=o.call(this,t)).search=document.getElementById("header-search-container"),e}return e=l,(r=[{key:"toggle",value:function(t){t.preventDefault(),this.search.classList.contains("tw-h-0")?(this.show(),this.focusOnSearchInput()):this.hide()}},{key:"focusOnSearchInput",value:function(){var t=document.getElementById("header-search-input");t&&t.focus()}},{key:"hide",value:function(){this.search.classList.remove("tw-h-[51px]","md:tw-h-[64px]"),this.search.classList.add("tw-h-0")}},{key:"show",value:function(){this.search.classList.remove("tw-h-0"),this.search.classList.add("tw-h-[51px]","md:tw-h-[64px]")}}])&&n(e.prototype,r),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),l}(r(2891).xI)},5240:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,s(i.key),i)}}function s(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function l(t){var e=u();return function(){var r,i=h(t);if(e){var n=h(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return c(this,r)}}function c(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(u=function(){return!!t})()}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}r.r(e),r.d(e,{default:()=>d});var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(c,t);var e,r,i,s=l(c);function c(){return n(this,c),s.apply(this,arguments)}return e=c,(r=[{key:"connect",value:function(){var t=this;this.jumpButton=this.element,window.addEventListener("scroll",(function(){return t.scroll()}))}},{key:"scroll",value:function(){window.scrollY>1200?this.jumpButton.classList.remove("tw-invisible"):this.jumpButton.classList.add("tw-invisible")}},{key:"jump",value:function(){window.scrollTo({top:0,left:0,behavior:"smooth"})}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI)},9767:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>m});var i=r(2891),n=r(2522),o=r.n(n);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,c(i.key),i)}}function c(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}function u(t,e){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},u(t,e)}function h(t){var e=p();return function(){var r,i=f(t);if(e){var n=f(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return d(this,r)}}function d(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(p=function(){return!!t})()}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(s,t);var e,r,i,n=h(s);function s(){return a(this,s),n.apply(this,arguments)}return e=s,(r=[{key:"connect",value:function(){document.querySelectorAll(".league-table-carousel").forEach((function(t){new(o())(t,{contain:!0,groupCells:!0,pageDots:!0,wrapAround:!0}).on("staticClick",(function(t,e,r){var i=r.getAttribute("data-url");i&&(window.location.href=i)}))}))}}])&&l(e.prototype,r),i&&l(e,i),Object.defineProperty(e,"prototype",{writable:!1}),s}(i.xI)},1241:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>_});var i=r(2891),n=r(6613),o=r(8020);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(){a=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function d(t,e,r,i){var o=e&&e.prototype instanceof v?e:v,s=Object.create(o.prototype),a=new I(i||[]);return n(s,"_invoke",{value:k(t,r,a)}),s}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var f="suspendedStart",m="executing",g="completed",y={};function v(){}function _(){}function b(){}var x={};h(x,l,(function(){return this}));var w=Object.getPrototypeOf,T=w&&w(w(O([])));T&&T!==r&&i.call(T,l)&&(x=T);var E=b.prototype=v.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,o,a,l){var c=p(t[n],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==s(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,l)}),(function(t){r("throw",t,a,l)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,l)}))}l(c.arg)}var o;n(this,"_invoke",{value:function(t,i){function n(){return new e((function(e,n){r(t,i,e,n)}))}return o=o?o.then(n,n):n()}})}function k(e,r,i){var n=f;return function(o,s){if(n===m)throw Error("Generator is already running");if(n===g){if("throw"===o)throw s;return{value:t,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var l=A(a,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===f)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=m;var c=p(e,r,i);if("normal"===c.type){if(n=i.done?g:"suspendedYield",c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n=g,i.method="throw",i.arg=c.arg)}}}function A(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=p(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(s(e)+" is not iterable")}return _.prototype=b,n(E,"constructor",{value:b,configurable:!0}),n(b,"constructor",{value:_,configurable:!0}),_.displayName=h(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,h(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(P.prototype),h(P.prototype,c,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new P(d(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),h(E,u,"Generator"),h(E,l,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return a.type="throw",a.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;C(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:O(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function l(t,e,r,i,n,o,s){try{var a=t[o](s),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(i,n)}function c(t){return function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function s(t){l(o,i,n,s,a,"next",t)}function a(t){l(o,i,n,s,a,"throw",t)}s(void 0)}))}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,v(i.key),i)}}function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}function p(t){var e=m();return function(){var r,i=g(t);if(e){var n=g(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return f(this,r)}}function f(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function m(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(m=function(){return!!t})()}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}function y(t,e,r){return(e=v(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}var _=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(g,t);var e,r,i,s,l,f,m=p(g);function g(){return u(this,g),m.apply(this,arguments)}return e=g,r=[{key:"connect",value:function(){var t=document.querySelector("#advert-banner.tw-sticky");this.previousSize="",this.userToggledFilters=!1,this.bannerHeight=t?t.offsetHeight:0,this.desktopFormTarget.style.top="".concat(this.bannerHeight,"px"),window.addEventListener("resize",this.onWindowResize.bind(this)),window.addEventListener("scroll",this.onWindowScroll.bind(this)),this.userInteractedWithPrice=!1,this.originalPriceMin=this.minPriceTarget.value,this.originalPriceMax=this.maxPriceTarget.value}},{key:"disconnect",value:function(){window.removeEventListener("resize",this.onWindowResize.bind(this)),window.addEventListener("scroll",this.onWindowScroll.bind(this))}},{key:"onWindowScroll",value:function(){var t=this.desktopFormTarget.getBoundingClientRect();this.checkDesktopFormPosition(t)}},{key:"checkDesktopFormPosition",value:function(t){if(!this.userToggledFilters){var e=this.desktopFiltersTarget.classList.contains("tw-hidden");if(t.top<=this.bannerHeight&&!e){var r=window.pageYOffset||document.documentElement.scrollTop;this.hideDesktopFilters(),window.scrollTo(0,r)}}}},{key:"desktopFormTargetConnected",value:function(){this.updateFormFromURL(this.desktopFormTarget)}},{key:"mobileFormTargetConnected",value:function(){this.updateFormFromURL(this.mobileFormTarget)}},{key:"onWindowResize",value:function(){var t=(0,n.X)("md").matches?"md":"";"md"===this.previousSize&&""===t&&this.hideDesktopFilters(),""===this.previousSize&&"md"===t&&(this.hideFiltersOverlay(),this.hideSortingOverlay()),this.previousSize=t}},{key:"showSortingOverlay",value:function(t){t.preventDefault(),this.hasSortingOverlayTarget&&this.sortingOverlayTarget&&this.sortingOverlayTarget.classList.remove("tw-hidden")}},{key:"showFiltersOverlay",value:function(t){var e=this;t&&t.preventDefault(),this.hasFiltersOverlayTarget&&(this.legendTargets.forEach((function(t){t.addEventListener("click",e.handleLegendClick),t.legendTargets=e.legendTargets})),this.filtersOverlayTarget&&this.filtersOverlayTarget.classList.remove("tw-hidden"))}},{key:"handleLegendClick",value:function(t){t.target.nextElementSibling&&(t.target.nextElementSibling.classList.contains("sc-tooltip")||(t.target.nextElementSibling.classList.toggle("tw-hidden"),t.target.classList.toggle("opened"),t.target.legendTargets&&t.target.legendTargets.forEach((function(e){e!==t.target&&(e.classList.remove("opened"),e.nextElementSibling.classList.add("tw-hidden"))}))))}},{key:"hideSortingOverlay",value:function(){this.hasSortingOverlayTarget&&this.sortingOverlayTarget&&this.sortingOverlayTarget.classList.add("tw-hidden")}},{key:"hideFiltersOverlay",value:function(){var t=this;this.hasFiltersOverlayTarget&&(this.legendTargets.forEach((function(e){e.removeEventListener("click",t.handleLegendClick),e.classList.remove("opened"),e.nextElementSibling.classList.add("tw-hidden")})),this.filtersOverlayTarget&&this.filtersOverlayTarget.classList.add("tw-hidden"))}},{key:"loadOpenFilters",value:function(){this.showDesktopFilters()}},{key:"toggleDesktopFilters",value:function(t){t.preventDefault(),this.hasDesktopFiltersTarget&&this.hasToggleFiltersButtonTarget&&(this.userToggledFilters=!0,this.desktopFiltersTarget.classList.contains("tw-hidden")?this.showDesktopFilters():this.hideDesktopFilters())}},{key:"showDesktopFilters",value:function(){var t;this.hasDesktopFiltersTarget&&this.hasToggleFiltersButtonTarget&&(this.desktopFiltersTarget.classList.remove("tw-hidden"),this.toggleFiltersButtonTarget.querySelector("span").innerText="Hide filters",null===(t=this.toggleFiltersButtonTarget.querySelector(".fa-caret-down"))||void 0===t||t.classList.replace("fa-caret-down","fa-caret-up"))}},{key:"hideDesktopFilters",value:function(){var t;this.hasDesktopFiltersTarget&&this.hasToggleFiltersButtonTarget&&(this.desktopFiltersTarget.classList.add("tw-hidden"),this.toggleFiltersButtonTarget.querySelector("span").innerText="Show filters",null===(t=this.toggleFiltersButtonTarget.querySelector(".fa-caret-up"))||void 0===t||t.classList.replace("fa-caret-up","fa-caret-down"))}},{key:"onSortDesktopChange",value:function(){this.desktopFormTarget.requestSubmit()}},{key:"sortByLink",value:function(t){this.sortFilterTarget.value=t.target.dataset.sort,this.desktopFormTarget.requestSubmit()}},{key:"onClearFilters",value:(f=c(a().mark((function t(){var e=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:event.preventDefault(),Array.from(this.desktopFormTarget.elements).forEach((function(t){"INPUT"!==t.tagName&&"SELECT"!==t.tagName||("checkbox"===t.type?t.checked="include_sold_out"===t.name:t.value=""),e.sortFilterTarget.value="rank_asc";var r=document.querySelector('[data-controller="slider"]'),i=e.application.getControllerForElementAndIdentifier(r,"slider");i&&(i.onMinPriceReset(),i.onMaxPriceReset())})),this.userInteractedWithPrice=!1,this.originalPriceMin="",this.originalPriceMax="",this.hideDesktopFilters(),this.hideSortingOverlay(),this.hideFiltersOverlay(),this.desktopFormTarget.requestSubmit();case 9:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},{key:"onAllowToReserve",value:function(t){t.preventDefault(),this.hideDesktopFilters(),this.hideSortingOverlay(),this.hideFiltersOverlay(),this.startLoading(),this.allowReservationTargets.forEach((function(e){e.checked=t.currentTarget.checked})),this.desktopFormTarget.requestSubmit()}},{key:"onAllowToReserveMobile",value:function(t){t.preventDefault(),this.allowReservationTargets.forEach((function(e){e.checked=t.currentTarget.checked})),document.getElementById("league-table-submit").click()}},{key:"trackGTMData",value:function(t,e,r,i,n,s,a,l,c,u,h,d){var p={event:"user_event",event_name:"user_event",user_event_type:"league_table_filter",location:t,league_table_filter_catering:e,league_table_filter_type:r,league_table_filter_room_type:i,league_table_filter_price_min:null,league_table_filter_price_max:null,league_table_sort_by:a,league_table_rated_property:l,league_table_filter_academic_year:c,league_table_filter_tenancy_length:u,league_table_filter_include_sold_out:h,league_table_filter_features:d};this.userInteractedWithPrice&&(p.league_table_filter_price_min=n,p.league_table_filter_price_max=s),(0,o.U)(p)}},{key:"onSubmit",value:(l=c(a().mark((function t(e){var r,i,n,o,s,l,c,u,h,d,p,f,m,g;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),this.hideDesktopFilters(),this.hideSortingOverlay(),this.hideFiltersOverlay(),this.startLoading(),r=e.target,i=new URLSearchParams,n=!1,i.delete("rated_property"),this.hasRatedPropertyTarget&&(n=this.ratedPropertyTarget.checked,i.append("rated_property",n)),o=this.addCateringToParams(r,i),s=this.addHallTypeToParams(r,i),l=this.addRoomTypeToParams(r,i),c=this.addFeaturesToParams(r,i),u=this.eventNameLocationValue,h=r.elements.allow_reservation.checked,d=r.elements.price_min.value,p=r.elements.price_max.value,this.onPriceUpdated(),this.userInteractedWithPrice&&(i.append("price_max",p),i.append("price_min",d)),i.append("sort",r.elements.sort.value),i.append("allow_reservation",h),(f=r.elements.academic_year)&&i.append("academic_year",f.value),(m=r.elements.tenancy_length)&&i.append("tenancy_length",m.value),void 0!==(g=r.elements.include_sold_out)&&i.append("include_sold_out",g.checked?1:0),this.pushHistory(i),this.hasLeagueTableTarget&&this.leagueTableTarget.scrollIntoView({behavior:"smooth"}),t.prev=30,t.next=33,this.updateResults(i);case 33:return t.prev=33,this.stopLoading(),this.updateFormFromURL(this.theOtherForm(r)),this.trackGTMData(u,o,s,l,Number(d),Number(p),r.elements.sort.value,n,f.value,m.value,null==g?void 0:g.checked,c),t.finish(33);case 38:case"end":return t.stop()}}),t,this,[[30,,33,38]])}))),function(t){return l.apply(this,arguments)})},{key:"updateFormFromURL",value:function(t){var e=new URLSearchParams(window.location.search);if(e.has("catering[]")){var r=e.getAll("catering[]");t.elements.catering_catered.checked=r.includes("catered"),t.elements.catering_self.checked=r.includes("self_catered")}else t.elements.catering_catered.checked=!1,t.elements.catering_self.checked=!1;if(e.has("type[]")){var i=e.getAll("type[]");t.elements.type_university.checked=i.includes("university"),t.elements.type_private.checked=i.includes("private")}else t.elements.type_university.checked=!1,t.elements.type_private.checked=!1;if(e.has("room-types[]")){var n=e.getAll("room-types[]");t.elements.room_type_apartment&&(t.elements.room_type_apartment.checked=n.includes("apartment")),t.elements.room_type_cluster&&(t.elements.room_type_cluster.checked=n.includes("cluster_ensuite")),t.elements.room_type_shared_bathroom&&(t.elements.room_type_shared_bathroom.checked=n.includes("cluster_shared_bathroom")),t.elements.room_type_studio&&(t.elements.room_type_studio.checked=n.includes("studio"))}else t.elements.room_type_apartment&&(t.elements.room_type_apartment.checked=!1),t.elements.room_type_cluster&&(t.elements.room_type_cluster.checked=!1),t.elements.room_type_shared_bathroom&&(t.elements.room_type_shared_bathroom.checked=!1),t.elements.room_type_studio&&(t.elements.room_type_studio.checked=!1);Array.from(t.elements).map((function(t,r){if(t.name.startsWith("feature_")){var i=e.getAll("features[]"),n=Array.from(i).find((function(e){return"feature_"+e===t.name}));t.checked=!!n,t.checked&&document.querySelectorAll("input[name="+t.name+"]").forEach((function(t){return t.checked=!0}))}})),e.has("price_min")?(t.elements.price_min.value=e.get("price_min"),this.dispatchPriceInputUpdateEvent(t.elements.price_min)):this.dispatchPriceInputResetEvent(t.elements.price_min),e.has("price_max")?(t.elements.price_max.value=e.get("price_max"),this.dispatchPriceInputUpdateEvent(t.elements.price_max)):this.dispatchPriceInputResetEvent(t.elements.price_max),e.has("academic_year")&&t.elements.academic_year&&(t.elements.academic_year.value=e.get("academic_year")),e.has("tenancy_length")&&t.elements.tenancy_length&&(t.elements.tenancy_length.value=e.get("tenancy_length")),e.has("include_sold_out")&&t.elements.include_sold_out&&(t.elements.include_sold_out.checked=e.get("include_sold_out")?1:0),e.has("sort")&&(t.elements.sort.value=e.get("sort"))}},{key:"theOtherForm",value:function(t){return t===this.desktopFormTarget?this.mobileFormTarget:t===this.mobileFormTarget?this.desktopFormTarget:void 0}},{key:"addCateringToParams",value:function(t,e){var r=[];return t.elements.catering_catered.checked&&r.push("catered"),t.elements.catering_self.checked&&r.push("self_catered"),r.length&&r.forEach((function(t){return e.append("catering[]",t)})),r}},{key:"addFeaturesToParams",value:function(t,e){var r=[];Array.from(t.elements).map((function(t,e){t.name.startsWith("feature_")&&t.checked&&r.push(t.name.replace("feature_",""))}));var i=r.filter((function(t,e,r){return e===r.indexOf(t)}));return i.length&&i.forEach((function(t){return e.append("features[]",t)})),i}},{key:"addHallTypeToParams",value:function(t,e){var r=[];return t.elements.type_university.checked&&r.push("university"),t.elements.type_private.checked&&r.push("private"),r.length&&r.forEach((function(t){return e.append("type[]",t)})),r}},{key:"addRoomTypeToParams",value:function(t,e){var r=[];return t.elements.room_type_apartment&&t.elements.room_type_apartment.checked&&r.push("apartment"),t.elements.room_type_cluster&&t.elements.room_type_cluster.checked&&r.push("cluster_ensuite"),t.elements.room_type_shared_bathroom&&t.elements.room_type_shared_bathroom.checked&&r.push("cluster_shared_bathroom"),t.elements.room_type_studio&&t.elements.room_type_studio.checked&&r.push("studio"),r.length&&r.forEach((function(t){return e.append("room-types[]",t)})),r}},{key:"onPriceUpdated",value:function(){this.minPriceTarget.value===this.originalPriceMin&&this.maxPriceTarget.value===this.originalPriceMax||(this.userInteractedWithPrice=!0)}},{key:"dispatchPriceInputUpdateEvent",value:function(t){var e=new CustomEvent("price-updated");t.dispatchEvent(e)}},{key:"dispatchPriceInputResetEvent",value:function(t){var e=new CustomEvent("price-reset");t.dispatchEvent(e)}},{key:"updateResults",value:(s=c(a().mark((function t(e){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.leagueTableTarget.src="".concat(this.basePathValue,"?").concat(e.toString()),t.next=3,this.leagueTableTarget.reload();case 3:this.updateHallsCount(document.getElementById("hall-count").dataset.count);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"pushHistory",value:function(t){var e=window.location.pathname;window.history.pushState({},"","".concat(e,"?").concat(t.toString()))}},{key:"updateHallsCount",value:function(t){this.hallCountTargets.forEach((function(e){return e.innerText=t}))}},{key:"startLoading",value:function(){this.loadingTargets.forEach((function(t){return t.classList.remove("tw-hidden")}))}},{key:"stopLoading",value:function(){this.loadingTargets.forEach((function(t){return t.classList.add("tw-hidden")}))}}],r&&h(e.prototype,r),i&&h(e,i),Object.defineProperty(e,"prototype",{writable:!1}),g}(i.xI);y(_,"values",{basePath:String,eventNameLocation:String}),y(_,"targets",["leagueTable","leagueTableHeader","sortingOverlay","filtersOverlay","desktopFilters","toggleFiltersButton","sortOption","desktopForm","mobileForm","mobileFilterButtonWrapper","hallCount","loading","ratedProperty","legend","sortFilter","minPrice","maxPrice","allowReservation"])},7445:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>rn});var i=r(2891);const n=function(t){const e=[];let r=0;for(let i=0;i<t.length;i++){let n=t.charCodeAt(i);n<128?e[r++]=n:n<2048?(e[r++]=n>>6|192,e[r++]=63&n|128):55296==(64512&n)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(n=65536+((1023&n)<<10)+(1023&t.charCodeAt(++i)),e[r++]=n>>18|240,e[r++]=n>>12&63|128,e[r++]=n>>6&63|128,e[r++]=63&n|128):(e[r++]=n>>12|224,e[r++]=n>>6&63|128,e[r++]=63&n|128)}return e},o={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const n=t[e],o=e+1<t.length,s=o?t[e+1]:0,a=e+2<t.length,l=a?t[e+2]:0,c=n>>2,u=(3&n)<<4|s>>4;let h=(15&s)<<2|l>>6,d=63&l;a||(d=64,o||(h=64)),i.push(r[c],r[u],r[h],r[d])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(n(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let r=0,i=0;for(;r<t.length;){const n=t[r++];if(n<128)e[i++]=String.fromCharCode(n);else if(n>191&&n<224){const o=t[r++];e[i++]=String.fromCharCode((31&n)<<6|63&o)}else if(n>239&&n<365){const o=((7&n)<<18|(63&t[r++])<<12|(63&t[r++])<<6|63&t[r++])-65536;e[i++]=String.fromCharCode(55296+(o>>10)),e[i++]=String.fromCharCode(56320+(1023&o))}else{const o=t[r++],s=t[r++];e[i++]=String.fromCharCode((15&n)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const n=r[t.charAt(e++)],o=e<t.length?r[t.charAt(e)]:0;++e;const a=e<t.length?r[t.charAt(e)]:64;++e;const l=e<t.length?r[t.charAt(e)]:64;if(++e,null==n||null==o||null==a||null==l)throw new s;const c=n<<2|o>>4;if(i.push(c),64!==a){const t=o<<4&240|a>>2;if(i.push(t),64!==l){const t=a<<6&192|l;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class s extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const a=function(t){return function(t){const e=n(t);return o.encodeByteArray(e,!0)}(t).replace(/\./g,"")},l=function(t){try{return o.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const c=()=>function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r.g)return r.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,u=()=>{try{return c()||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&l(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},h=t=>{var e,r;return null===(r=null===(e=u())||void 0===e?void 0:e.emulatorHosts)||void 0===r?void 0:r[t]},d=()=>{var t;return null===(t=u())||void 0===t?void 0:t.config},p=t=>{var e;return null===(e=u())||void 0===e?void 0:e[`_${t}`]};class f{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,r))}}}function m(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}class g extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,y.prototype.create)}}class y{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},i=`${this.service}/${t}`,n=this.errors[t],o=n?function(t,e){return t.replace(v,((t,r)=>{const i=e[r];return null!=i?String(i):`<${r}?>`}))}(n,r):"Error",s=`${this.serviceName}: ${o} (${i}).`;return new g(i,s,r)}}const v=/\{\$([^}]+)}/g;function _(t,e){if(t===e)return!0;const r=Object.keys(t),i=Object.keys(e);for(const n of r){if(!i.includes(n))return!1;const r=t[n],o=e[n];if(b(r)&&b(o)){if(!_(r,o))return!1}else if(r!==o)return!1}for(const t of i)if(!r.includes(t))return!1;return!0}function b(t){return null!==t&&"object"==typeof t}function x(t){const e=[];for(const[r,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(r)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function w(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[r,i]=t.split("=");e[decodeURIComponent(r)]=decodeURIComponent(i)}})),e}function T(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}class E{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,r){let i;if(void 0===t&&void 0===e&&void 0===r)throw new Error("Missing Observer.");i=function(t,e){if("object"!=typeof t||null===t)return!1;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:r},void 0===i.next&&(i.next=S),void 0===i.error&&(i.error=S),void 0===i.complete&&(i.complete=S);const n=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),n}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function S(){}function P(t){return t&&t._delegate?t._delegate:t}class k{constructor(t,e,r){this.name=t,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const A="[DEFAULT]";class M{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new f;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:e});r&&t.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const r=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:A})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:r});e.resolve(t)}catch(t){}}}}clearInstance(t="[DEFAULT]"){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t="[DEFAULT]"){return this.instances.has(t)}getOptions(t="[DEFAULT]"){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[t,e]of this.instancesDeferred.entries()){r===this.normalizeInstanceIdentifier(t)&&e.resolve(i)}return i}onInit(t,e){var r;const i=this.normalizeInstanceIdentifier(e),n=null!==(r=this.onInitCallbacks.get(i))&&void 0!==r?r:new Set;n.add(t),this.onInitCallbacks.set(i,n);const o=this.instances.get(i);return o&&t(o,i),()=>{n.delete(t)}}invokeOnInitCallbacks(t,e){const r=this.onInitCallbacks.get(e);if(r)for(const i of r)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===A?void 0:i),options:e}),this.instances.set(t,r),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(t){}var i;return r||null}normalizeInstanceIdentifier(t="[DEFAULT]"){return this.component?this.component.multipleInstances?t:A:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class C{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new M(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const I=[];var O;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(O||(O={}));const L={debug:O.DEBUG,verbose:O.VERBOSE,info:O.INFO,warn:O.WARN,error:O.ERROR,silent:O.SILENT},D=O.INFO,R={[O.DEBUG]:"log",[O.VERBOSE]:"log",[O.INFO]:"info",[O.WARN]:"warn",[O.ERROR]:"error"},F=(t,e,...r)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),n=R[e];if(!n)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[n](`[${i}]  ${t.name}:`,...r)};class B{constructor(t){this.name=t,this._logLevel=D,this._logHandler=F,this._userLogHandler=null,I.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in O))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?L[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,O.DEBUG,...t),this._logHandler(this,O.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,O.VERBOSE,...t),this._logHandler(this,O.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,O.INFO,...t),this._logHandler(this,O.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,O.WARN,...t),this._logHandler(this,O.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,O.ERROR,...t),this._logHandler(this,O.ERROR,...t)}}let z,j;const N=new WeakMap,V=new WeakMap,U=new WeakMap,$=new WeakMap,G=new WeakMap;let H={get(t,e,r){if(t instanceof IDBTransaction){if("done"===e)return V.get(t);if("objectStoreNames"===e)return t.objectStoreNames||U.get(t);if("store"===e)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Z(t[e])},set:(t,e,r)=>(t[e]=r,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function q(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(j||(j=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(X(this),e),Z(N.get(this))}:function(...e){return Z(t.apply(X(this),e))}:function(e,...r){const i=t.call(X(this),e,...r);return U.set(i,e.sort?e.sort():[e]),Z(i)}}function W(t){return"function"==typeof t?q(t):(t instanceof IDBTransaction&&function(t){if(V.has(t))return;const e=new Promise(((e,r)=>{const i=()=>{t.removeEventListener("complete",n),t.removeEventListener("error",o),t.removeEventListener("abort",o)},n=()=>{e(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",n),t.addEventListener("error",o),t.addEventListener("abort",o)}));V.set(t,e)}(t),e=t,(z||(z=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>e instanceof t))?new Proxy(t,H):t);var e}function Z(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,r)=>{const i=()=>{t.removeEventListener("success",n),t.removeEventListener("error",o)},n=()=>{e(Z(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",n),t.addEventListener("error",o)}));return e.then((e=>{e instanceof IDBCursor&&N.set(e,t)})).catch((()=>{})),G.set(e,t),e}(t);if($.has(t))return $.get(t);const e=W(t);return e!==t&&($.set(t,e),G.set(e,t)),e}const X=t=>G.get(t);const Y=["get","getKey","getAll","getAllKeys","count"],K=["put","add","delete","clear"],J=new Map;function Q(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(J.get(e))return J.get(e);const r=e.replace(/FromIndex$/,""),i=e!==r,n=K.includes(r);if(!(r in(i?IDBIndex:IDBObjectStore).prototype)||!n&&!Y.includes(r))return;const o=async function(t,...e){const o=this.transaction(t,n?"readwrite":"readonly");let s=o.store;return i&&(s=s.index(e.shift())),(await Promise.all([s[r](...e),n&&o.done]))[0]};return J.set(e,o),o}H=(t=>({...t,get:(e,r,i)=>Q(e,r)||t.get(e,r,i),has:(e,r)=>!!Q(e,r)||t.has(e,r)}))(H);class tt{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const et="@firebase/app",rt="0.10.3",it=new B("@firebase/app"),nt="[DEFAULT]",ot={[et]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/vertexai-preview":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},st=new Map,at=new Map,lt=new Map;function ct(t,e){try{t.container.addComponent(e)}catch(r){it.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function ut(t){const e=t.name;if(lt.has(e))return it.debug(`There were multiple attempts to register component ${e}.`),!1;lt.set(e,t);for(const e of st.values())ct(e,t);for(const e of at.values())ct(e,t);return!0}function ht(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function dt(t){return void 0!==t.settings}const pt=new y("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class ft{constructor(t,e,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new k("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw pt.create("app-deleted",{appName:this._name})}}const mt="10.12.0";function gt(t,e={}){let r=t;if("object"!=typeof e){e={name:e}}const i=Object.assign({name:nt,automaticDataCollectionEnabled:!1},e),n=i.name;if("string"!=typeof n||!n)throw pt.create("bad-app-name",{appName:String(n)});if(r||(r=d()),!r)throw pt.create("no-options");const o=st.get(n);if(o){if(_(r,o.options)&&_(i,o.config))return o;throw pt.create("duplicate-app",{appName:n})}const s=new C(n);for(const t of lt.values())s.addComponent(t);const a=new ft(r,i,s);return st.set(n,a),a}function yt(t,e,r){var i;let n=null!==(i=ot[t])&&void 0!==i?i:t;r&&(n+=`-${r}`);const o=n.match(/\s|\//),s=e.match(/\s|\//);if(o||s){const t=[`Unable to register library "${n}" with version "${e}":`];return o&&t.push(`library name "${n}" contains illegal characters (whitespace or "/")`),o&&s&&t.push("and"),s&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void it.warn(t.join(" "))}ut(new k(`${n}-version`,(()=>({library:n,version:e})),"VERSION"))}const vt="firebase-heartbeat-store";let _t=null;function bt(){return _t||(_t=function(t,e,{blocked:r,upgrade:i,blocking:n,terminated:o}={}){const s=indexedDB.open(t,e),a=Z(s);return i&&s.addEventListener("upgradeneeded",(t=>{i(Z(s.result),t.oldVersion,t.newVersion,Z(s.transaction),t)})),r&&s.addEventListener("blocked",(t=>r(t.oldVersion,t.newVersion,t))),a.then((t=>{o&&t.addEventListener("close",(()=>o())),n&&t.addEventListener("versionchange",(t=>n(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}("firebase-heartbeat-database",1,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(vt)}catch(t){console.warn(t)}}}).catch((t=>{throw pt.create("idb-open",{originalErrorMessage:t.message})}))),_t}async function xt(t,e){try{const r=(await bt()).transaction(vt,"readwrite"),i=r.objectStore(vt);await i.put(e,wt(t)),await r.done}catch(t){if(t instanceof g)it.warn(t.message);else{const e=pt.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});it.warn(e.message)}}}function wt(t){return`${t.name}!${t.options.appId}`}class Tt{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new St(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Et();if((null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==i&&!this._heartbeatsCache.heartbeats.some((t=>t.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=Et(),{heartbeatsToSend:r,unsentEntries:i}=function(t,e=1024){const r=[];let i=t.slice();for(const n of t){const t=r.find((t=>t.agent===n.agent));if(t){if(t.dates.push(n.date),Pt(r)>e){t.dates.pop();break}}else if(r.push({agent:n.agent,dates:[n.date]}),Pt(r)>e){r.pop();break}i=i.slice(1)}return{heartbeatsToSend:r,unsentEntries:i}}(this._heartbeatsCache.heartbeats),n=a(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),n}}function Et(){return(new Date).toISOString().substring(0,10)}class St{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!function(){try{return"object"==typeof indexedDB}catch(t){return!1}}()&&new Promise(((t,e)=>{try{let r=!0;const i="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(i);n.onsuccess=()=>{n.result.close(),r||self.indexedDB.deleteDatabase(i),t(!0)},n.onupgradeneeded=()=>{r=!1},n.onerror=()=>{var t;e((null===(t=n.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await bt()).transaction(vt),r=await e.objectStore(vt).get(wt(t));return await e.done,r}catch(t){if(t instanceof g)it.warn(t.message);else{const e=pt.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});it.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const r=await this.read();return xt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const r=await this.read();return xt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}}}function Pt(t){return a(JSON.stringify({version:2,heartbeats:t})).length}var kt;kt="",ut(new k("platform-logger",(t=>new tt(t)),"PRIVATE")),ut(new k("heartbeat",(t=>new Tt(t)),"PRIVATE")),yt(et,rt,kt),yt(et,rt,"esm2017"),yt("fire-js","");function At(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]])}return r}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;function Mt(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Ct=Mt,It=new y("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Ot=new B("@firebase/auth");function Lt(t,...e){Ot.logLevel<=O.ERROR&&Ot.error(`Auth (10.12.0): ${t}`,...e)}function Dt(t,...e){throw jt(t,...e)}function Rt(t,...e){return jt(t,...e)}function Ft(t,e,r){const i=Object.assign(Object.assign({},Ct()),{[e]:r});return new y("auth","Firebase",i).create(e,{appName:t.name})}function Bt(t){return Ft(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function zt(t,e,r){if(!(e instanceof r))throw r.name!==e.constructor.name&&Dt(t,"argument-error"),Ft(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function jt(t,...e){if("string"!=typeof t){const r=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(r,...i)}return It.create(t,...e)}function Nt(t,e,...r){if(!t)throw jt(e,...r)}function Vt(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Lt(e),new Error(e)}function Ut(t,e){t||Vt(e)}function $t(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function Gt(){return"http:"===Ht()||"https:"===Ht()}function Ht(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}function qt(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Gt()||function(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}()||"connection"in navigator))||navigator.onLine}class Wt{constructor(t,e){this.shortDelay=t,this.longDelay=e,Ut(e>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(m())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return qt()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Zt(t,e){Ut(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}class Xt{static initialize(t,e,r){this.fetchImpl=t,e&&(this.headersImpl=e),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void Vt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void Vt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void Vt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Yt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Kt=new Wt(3e4,6e4);function Jt(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Qt(t,e,r,i,n={}){return te(t,n,(async()=>{let n={},o={};i&&("GET"===e?o=i:n={body:JSON.stringify(i)});const s=x(Object.assign({key:t.config.apiKey},o)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),Xt.fetch()(re(t,t.config.apiHost,r,s),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},n))}))}async function te(t,e,r){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},Yt),e);try{const e=new ne(t),n=await Promise.race([r(),e.promise]);e.clearNetworkTimeout();const o=await n.json();if("needConfirmation"in o)throw oe(t,"account-exists-with-different-credential",o);if(n.ok&&!("errorMessage"in o))return o;{const e=n.ok?o.errorMessage:o.error.message,[r,s]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===r)throw oe(t,"credential-already-in-use",o);if("EMAIL_EXISTS"===r)throw oe(t,"email-already-in-use",o);if("USER_DISABLED"===r)throw oe(t,"user-disabled",o);const a=i[r]||r.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw Ft(t,a,s);Dt(t,a)}}catch(e){if(e instanceof g)throw e;Dt(t,"network-request-failed",{message:String(e)})}}async function ee(t,e,r,i,n={}){const o=await Qt(t,e,r,i,n);return"mfaPendingCredential"in o&&Dt(t,"multi-factor-auth-required",{_serverResponse:o}),o}function re(t,e,r,i){const n=`${e}${r}?${i}`;return t.config.emulator?Zt(t.config,n):`${t.config.apiScheme}://${n}`}function ie(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ne{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(Rt(this.auth,"network-request-failed"))),Kt.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function oe(t,e,r){const i={appName:t.name};r.email&&(i.email=r.email),r.phoneNumber&&(i.phoneNumber=r.phoneNumber);const n=Rt(t,e,i);return n.customData._tokenResponse=r,n}function se(t){return void 0!==t&&void 0!==t.enterprise}class ae{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return ie(e.enforcementState);return null}isProviderEnabled(t){return"ENFORCE"===this.getProviderEnforcementState(t)||"AUDIT"===this.getProviderEnforcementState(t)}}async function le(t,e){return Qt(t,"GET","/v2/recaptchaConfig",Jt(t,e))}async function ce(t,e){return Qt(t,"POST","/v1/accounts:lookup",e)}function ue(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function he(t){return 1e3*Number(t)}function de(t){const[e,r,i]=t.split(".");if(void 0===e||void 0===r||void 0===i)return Lt("JWT malformed, contained fewer than 3 sections"),null;try{const t=l(r);return t?JSON.parse(t):(Lt("Failed to decode base64 JWT payload"),null)}catch(t){return Lt("Caught error parsing JWT payload as JSON",null==t?void 0:t.toString()),null}}function pe(t){const e=de(t);return Nt(e,"internal-error"),Nt(void 0!==e.exp,"internal-error"),Nt(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}async function fe(t,e,r=!1){if(r)return e;try{return await e}catch(e){throw e instanceof g&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class me{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===(null==t?void 0:t.code)&&this.schedule(!0))}this.schedule()}}class ge{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=ue(this.lastLoginAt),this.creationTime=ue(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ye(t){var e;const r=t.auth,i=await t.getIdToken(),n=await fe(t,ce(r,{idToken:i}));Nt(null==n?void 0:n.users.length,r,"internal-error");const o=n.users[0];t._notifyReloadListener(o);const s=(null===(e=o.providerUserInfo)||void 0===e?void 0:e.length)?ve(o.providerUserInfo):[],a=(l=t.providerData,c=s,[...l.filter((t=>!c.some((e=>e.providerId===t.providerId)))),...c]);var l,c;const u=t.isAnonymous,h=!(t.email&&o.passwordHash||(null==a?void 0:a.length)),d=!!u&&h,p={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new ge(o.createdAt,o.lastLoginAt),isAnonymous:d};Object.assign(t,p)}function ve(t){return t.map((t=>{var{providerId:e}=t,r=At(t,["providerId"]);return{providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}}))}class _e{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Nt(t.idToken,"internal-error"),Nt(void 0!==t.idToken,"internal-error"),Nt(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):pe(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){Nt(0!==t.length,"internal-error");const e=pe(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return e||!this.accessToken||this.isExpired?(Nt(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:r,refreshToken:i,expiresIn:n}=await async function(t,e){const r=await te(t,{},(async()=>{const r=x({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:n}=t.config,o=re(t,i,"/v1/token",`key=${n}`),s=await t._getAdditionalHeaders();return s["Content-Type"]="application/x-www-form-urlencoded",Xt.fetch()(o,{method:"POST",headers:s,body:r})}));return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}(t,e);this.updateTokensAndExpiration(r,i,Number(n))}updateTokensAndExpiration(t,e,r){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(t,e){const{refreshToken:r,accessToken:i,expirationTime:n}=e,o=new _e;return r&&(Nt("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),i&&(Nt("string"==typeof i,"internal-error",{appName:t}),o.accessToken=i),n&&(Nt("number"==typeof n,"internal-error",{appName:t}),o.expirationTime=n),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new _e,this.toJSON())}_performRefresh(){return Vt("not implemented")}}function be(t,e){Nt("string"==typeof t||void 0===t,"internal-error",{appName:e})}class xe{constructor(t){var{uid:e,auth:r,stsTokenManager:i}=t,n=At(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new me(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=n.displayName||null,this.email=n.email||null,this.emailVerified=n.emailVerified||!1,this.phoneNumber=n.phoneNumber||null,this.photoURL=n.photoURL||null,this.isAnonymous=n.isAnonymous||!1,this.tenantId=n.tenantId||null,this.providerData=n.providerData?[...n.providerData]:[],this.metadata=new ge(n.createdAt||void 0,n.lastLoginAt||void 0)}async getIdToken(t){const e=await fe(this,this.stsTokenManager.getToken(this.auth,t));return Nt(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const r=P(t),i=await r.getIdToken(e),n=de(i);Nt(n&&n.exp&&n.auth_time&&n.iat,r.auth,"internal-error");const o="object"==typeof n.firebase?n.firebase:void 0,s=null==o?void 0:o.sign_in_provider;return{claims:n,token:i,authTime:ue(he(n.auth_time)),issuedAtTime:ue(he(n.iat)),expirationTime:ue(he(n.exp)),signInProvider:s||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=P(t);await ye(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(Nt(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new xe(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){Nt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let r=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),r=!0),e&&await ye(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(dt(this.auth.app))return Promise.reject(Bt(this.auth));const t=await this.getIdToken();return await fe(this,async function(t,e){return Qt(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var r,i,n,o,s,a,l,c;const u=null!==(r=e.displayName)&&void 0!==r?r:void 0,h=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(n=e.phoneNumber)&&void 0!==n?n:void 0,p=null!==(o=e.photoURL)&&void 0!==o?o:void 0,f=null!==(s=e.tenantId)&&void 0!==s?s:void 0,m=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,g=null!==(l=e.createdAt)&&void 0!==l?l:void 0,y=null!==(c=e.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:_,isAnonymous:b,providerData:x,stsTokenManager:w}=e;Nt(v&&w,t,"internal-error");const T=_e.fromJSON(this.name,w);Nt("string"==typeof v,t,"internal-error"),be(u,t.name),be(h,t.name),Nt("boolean"==typeof _,t,"internal-error"),Nt("boolean"==typeof b,t,"internal-error"),be(d,t.name),be(p,t.name),be(f,t.name),be(m,t.name),be(g,t.name),be(y,t.name);const E=new xe({uid:v,auth:t,email:h,emailVerified:_,displayName:u,isAnonymous:b,photoURL:p,phoneNumber:d,tenantId:f,stsTokenManager:T,createdAt:g,lastLoginAt:y});return x&&Array.isArray(x)&&(E.providerData=x.map((t=>Object.assign({},t)))),m&&(E._redirectEventId=m),E}static async _fromIdTokenResponse(t,e,r=!1){const i=new _e;i.updateFromServerResponse(e);const n=new xe({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:r});return await ye(n),n}static async _fromGetAccountInfoResponse(t,e,r){const i=e.users[0];Nt(void 0!==i.localId,"internal-error");const n=void 0!==i.providerUserInfo?ve(i.providerUserInfo):[],o=!(i.email&&i.passwordHash||(null==n?void 0:n.length)),s=new _e;s.updateFromIdToken(r);const a=new xe({uid:i.localId,auth:t,stsTokenManager:s,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:n,metadata:new ge(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash||(null==n?void 0:n.length))};return Object.assign(a,l),a}}const we=new Map;function Te(t){Ut(t instanceof Function,"Expected a class definition");let e=we.get(t);return e?(Ut(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,we.set(t,e),e)}class Ee{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}Ee.type="NONE";const Se=Ee;function Pe(t,e,r){return`firebase:${t}:${e}:${r}`}class ke{constructor(t,e,r){this.persistence=t,this.auth=e,this.userKey=r;const{config:i,name:n}=this.auth;this.fullUserKey=Pe(this.userKey,i.apiKey,n),this.fullPersistenceKey=Pe("persistence",i.apiKey,n),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?xe._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,r="authUser"){if(!e.length)return new ke(Te(Se),t,r);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let n=i[0]||Te(Se);const o=Pe(r,t.config.apiKey,t.name);let s=null;for(const r of e)try{const e=await r._get(o);if(e){const i=xe._fromJSON(t,e);r!==n&&(s=i),n=r;break}}catch(t){}const a=i.filter((t=>t._shouldAllowMigration));return n._shouldAllowMigration&&a.length?(n=a[0],s&&await n._set(o,s.toJSON()),await Promise.all(e.map((async t=>{if(t!==n)try{await t._remove(o)}catch(t){}}))),new ke(n,t,r)):new ke(n,t,r)}}function Ae(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Oe(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Me(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(De(e))return"Blackberry";if(Re(e))return"Webos";if(Ce(e))return"Safari";if((e.includes("chrome/")||Ie(e))&&!e.includes("edge/"))return"Chrome";if(Le(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(e);if(2===(null==r?void 0:r.length))return r[1]}return"Other"}function Me(t=m()){return/firefox\//i.test(t)}function Ce(t=m()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ie(t=m()){return/crios\//i.test(t)}function Oe(t=m()){return/iemobile/i.test(t)}function Le(t=m()){return/android/i.test(t)}function De(t=m()){return/blackberry/i.test(t)}function Re(t=m()){return/webos/i.test(t)}function Fe(t=m()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Be(){return function(){const t=m();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()&&10===document.documentMode}function ze(t=m()){return Fe(t)||Le(t)||Re(t)||De(t)||/windows phone/i.test(t)||Oe(t)}function je(t,e=[]){let r;switch(t){case"Browser":r=Ae(m());break;case"Worker":r=`${Ae(m())}-${t}`;break;default:r=t}return`${r}/JsCore/10.12.0/${e.length?e.join(","):"FirebaseCore-web"}`}class Ne{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const r=e=>new Promise(((r,i)=>{try{r(t(e))}catch(t){i(t)}}));r.onAbort=e,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const r of this.queue)await r(t),r.onAbort&&e.push(r.onAbort)}catch(t){e.reverse();for(const t of e)try{t()}catch(t){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==t?void 0:t.message})}}}class Ve{constructor(t){var e,r,i,n;const o=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=o.minPasswordLength)&&void 0!==e?e:6,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),void 0!==o.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),void 0!==o.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),void 0!==o.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),void 0!==o.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(r=t.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(n=t.forceUpgradeOnSignin)&&void 0!==n&&n,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,r,i,n,o,s;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,a),this.validatePasswordCharacterOptions(t,a),a.isValid&&(a.isValid=null===(e=a.meetsMinPasswordLength)||void 0===e||e),a.isValid&&(a.isValid=null===(r=a.meetsMaxPasswordLength)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsLowercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(n=a.containsUppercaseLetter)||void 0===n||n),a.isValid&&(a.isValid=null===(o=a.containsNumericCharacter)||void 0===o||o),a.isValid&&(a.isValid=null===(s=a.containsNonAlphanumericCharacter)||void 0===s||s),a}validatePasswordLengthOptions(t,e){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(e.meetsMinPasswordLength=t.length>=r),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){let r;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let i=0;i<t.length;i++)r=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(t,e,r,i,n){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=n))}}class Ue{constructor(t,e,r,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ge(this),this.idTokenSubscription=new Ge(this),this.beforeStateQueue=new Ne(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=It,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=Te(e)),this._initializationPromise=this.queue((async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await ke.create(this,t),!this._deleted)){if(null===(r=this._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUserFromIdToken(t){try{const e=await ce(this,{idToken:t}),r=await xe._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var e;if(dt(this.app)){const t=this.app.settings.authIdToken;return t?new Promise((e=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(t).then(e,e)))})):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,n=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,o=null==i?void 0:i._redirectEventId,s=await this.tryRedirectSignIn(t);r&&r!==o||!(null==s?void 0:s.user)||(i=s.user,n=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(n)try{await this.beforeStateQueue.runMiddleware(i)}catch(t){i=r,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(t)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Nt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await ye(t)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(dt(this.app))return Promise.reject(Bt(this));const e=t?P(t):null;return e&&Nt(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&Nt(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return dt(this.app)?Promise.reject(Bt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return dt(this.app)?Promise.reject(Bt(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(Te(t))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await async function(t,e={}){return Qt(t,"GET","/v2/passwordPolicy",Jt(t,e))}(this),e=new Ve(t);null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new y("auth","Firebase",t())}onAuthStateChanged(t,e,r){return this.registerStateListener(this.authStateSubscription,t,e,r)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,r){return this.registerStateListener(this.idTokenSubscription,t,e,r)}authStateReady(){return new Promise(((t,e)=>{if(this.currentUser)t();else{const r=this.onAuthStateChanged((()=>{r(),t()}),e)}}))}async revokeAccessToken(t){if(this.currentUser){const e={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(e.tenantId=this.tenantId),await async function(t,e){return Qt(t,"POST","/v2/accounts:revokeToken",Jt(t,e))}(this,e)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const r=await this.getOrInitRedirectPersistenceManager(e);return null===t?r.removeCurrentUser():r.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&Te(t)||this._popupRedirectResolver;Nt(e,this,"argument-error"),this.redirectPersistenceManager=await ke.create(this,[Te(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,r;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(r=this.redirectUser)||void 0===r?void 0:r._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,r,i){if(this._deleted)return()=>{};const n="function"==typeof e?e:e.next.bind(e);let o=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(Nt(s,this,"internal-error"),s.then((()=>{o||n(this.currentUser)})),"function"==typeof e){const n=t.addObserver(e,r,i);return()=>{o=!0,n()}}{const r=t.addObserver(e);return()=>{o=!0,r()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Nt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=je(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;const e=await(null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken());return(null==e?void 0:e.error)&&function(t,...e){Ot.logLevel<=O.WARN&&Ot.warn(`Auth (10.12.0): ${t}`,...e)}(`Error while retrieving App Check token: ${e.error}`),null==e?void 0:e.token}}function $e(t){return P(t)}class Ge{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const r=new E(t,e);return r.subscribe.bind(r)}((t=>this.observer=t))}get next(){return Nt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let He={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function qe(t){return He.loadJS(t)}function We(t){return`__${t}${Math.floor(1e6*Math.random())}`}class Ze{constructor(t){this.type="recaptcha-enterprise",this.auth=$e(t)}async verify(t="verify",e=!1){function r(e,r,i){const n=window.grecaptcha;se(n)?n.enterprise.ready((()=>{n.enterprise.execute(e,{action:t}).then((t=>{r(t)})).catch((()=>{r("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((t,i)=>{(async function(t){if(!e){if(null==t.tenantId&&null!=t._agentRecaptchaConfig)return t._agentRecaptchaConfig.siteKey;if(null!=t.tenantId&&void 0!==t._tenantRecaptchaConfigs[t.tenantId])return t._tenantRecaptchaConfigs[t.tenantId].siteKey}return new Promise((async(e,r)=>{le(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const r=new ae(i);return null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,e(r.siteKey)}r(new Error("recaptcha Enterprise site key undefined"))})).catch((t=>{r(t)}))}))})(this.auth).then((n=>{if(!e&&se(window.grecaptcha))r(n,t,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));let e=He.recaptchaEnterpriseScript;0!==e.length&&(e+=n),qe(e).then((()=>{r(n,t,i)})).catch((t=>{i(t)}))}})).catch((t=>{i(t)}))}))}}async function Xe(t,e,r,i=!1){const n=new Ze(t);let o;try{o=await n.verify(r)}catch(t){o=await n.verify(r,!0)}const s=Object.assign({},e);return i?Object.assign(s,{captchaResp:o}):Object.assign(s,{captchaResponse:o}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function Ye(t,e,r,i){var n;if(null===(n=t._getRecaptchaConfig())||void 0===n?void 0:n.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const n=await Xe(t,e,r,"getOobCode"===r);return i(t,n)}return i(t,e).catch((async n=>{if("auth/missing-recaptcha-token"===n.code){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const n=await Xe(t,e,r,"getOobCode"===r);return i(t,n)}return Promise.reject(n)}))}function Ke(t,e,r){const i=$e(t);Nt(i._canInitEmulator,i,"emulator-config-failed"),Nt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const n=!!(null==r?void 0:r.disableWarnings),o=Je(e),{host:s,port:a}=function(t){const e=Je(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const i=r[2].split("@").pop()||"",n=/^(\[[^\]]+\])(:|$)/.exec(i);if(n){const t=n[1];return{host:t,port:Qe(i.substr(t.length+1))}}{const[t,e]=i.split(":");return{host:t,port:Qe(e)}}}(e),l=null===a?"":`:${a}`;i.config.emulator={url:`${o}//${s}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:n})}),n||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}function Je(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Qe(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class tr{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Vt("not implemented")}_getIdTokenResponse(t){return Vt("not implemented")}_linkToIdToken(t,e){return Vt("not implemented")}_getReauthenticationResolver(t){return Vt("not implemented")}}async function er(t,e){return Qt(t,"POST","/v1/accounts:signUp",e)}async function rr(t,e){return ee(t,"POST","/v1/accounts:signInWithPassword",Jt(t,e))}class ir extends tr{constructor(t,e,r,i=null){super("password",r),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new ir(t,e,"password")}static _fromEmailAndCode(t,e,r=null){return new ir(t,e,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return Ye(t,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",rr);case"emailLink":return async function(t,e){return ee(t,"POST","/v1/accounts:signInWithEmailLink",Jt(t,e))}(t,{email:this._email,oobCode:this._password});default:Dt(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return Ye(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",er);case"emailLink":return async function(t,e){return ee(t,"POST","/v1/accounts:signInWithEmailLink",Jt(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:Dt(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function nr(t,e){return ee(t,"POST","/v1/accounts:signInWithIdp",Jt(t,e))}class or extends tr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new or(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Dt("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:r,signInMethod:i}=e,n=At(e,["providerId","signInMethod"]);if(!r||!i)return null;const o=new or(r,i);return o.idToken=n.idToken||void 0,o.accessToken=n.accessToken||void 0,o.secret=n.secret,o.nonce=n.nonce,o.pendingToken=n.pendingToken||null,o}_getIdTokenResponse(t){return nr(t,this.buildRequest())}_linkToIdToken(t,e){const r=this.buildRequest();return r.idToken=e,nr(t,r)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,nr(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=x(e)}return t}}const sr={USER_NOT_FOUND:"user-not-found"};class ar extends tr{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new ar({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new ar({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return ee(t,"POST","/v1/accounts:signInWithPhoneNumber",Jt(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const r=await ee(t,"POST","/v1/accounts:signInWithPhoneNumber",Jt(t,e));if(r.temporaryProof)throw oe(t,"account-exists-with-different-credential",r);return r}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return ee(t,"POST","/v1/accounts:signInWithPhoneNumber",Jt(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),sr)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:r,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:r,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:r,phoneNumber:i,temporaryProof:n}=t;return r||e||i||n?new ar({verificationId:e,verificationCode:r,phoneNumber:i,temporaryProof:n}):null}}class lr{constructor(t){var e,r,i,n,o,s;const a=w(T(t)),l=null!==(e=a.apiKey)&&void 0!==e?e:null,c=null!==(r=a.oobCode)&&void 0!==r?r:null,u=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);Nt(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(n=a.continueUrl)&&void 0!==n?n:null,this.languageCode=null!==(o=a.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=a.tenantId)&&void 0!==s?s:null}static parseLink(t){const e=function(t){const e=w(T(t)).link,r=e?w(T(e)).deep_link_id:null,i=w(T(t)).deep_link_id;return(i?w(T(i)).link:null)||i||r||e||t}(t);try{return new lr(e)}catch(t){return null}}}class cr{constructor(){this.providerId=cr.PROVIDER_ID}static credential(t,e){return ir._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const r=lr.parseLink(e);return Nt(r,"argument-error"),ir._fromEmailAndCode(t,r.code,r.tenantId)}}cr.PROVIDER_ID="password",cr.EMAIL_PASSWORD_SIGN_IN_METHOD="password",cr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ur{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class hr extends ur{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class dr extends hr{constructor(){super("facebook.com")}static credential(t){return or._fromParams({providerId:dr.PROVIDER_ID,signInMethod:dr.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return dr.credentialFromTaggedObject(t)}static credentialFromError(t){return dr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return dr.credential(t.oauthAccessToken)}catch(t){return null}}}dr.FACEBOOK_SIGN_IN_METHOD="facebook.com",dr.PROVIDER_ID="facebook.com";class pr extends hr{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return or._fromParams({providerId:pr.PROVIDER_ID,signInMethod:pr.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return pr.credentialFromTaggedObject(t)}static credentialFromError(t){return pr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:r}=t;if(!e&&!r)return null;try{return pr.credential(e,r)}catch(t){return null}}}pr.GOOGLE_SIGN_IN_METHOD="google.com",pr.PROVIDER_ID="google.com";class fr extends hr{constructor(){super("github.com")}static credential(t){return or._fromParams({providerId:fr.PROVIDER_ID,signInMethod:fr.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return fr.credentialFromTaggedObject(t)}static credentialFromError(t){return fr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return fr.credential(t.oauthAccessToken)}catch(t){return null}}}fr.GITHUB_SIGN_IN_METHOD="github.com",fr.PROVIDER_ID="github.com";class mr extends hr{constructor(){super("twitter.com")}static credential(t,e){return or._fromParams({providerId:mr.PROVIDER_ID,signInMethod:mr.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return mr.credentialFromTaggedObject(t)}static credentialFromError(t){return mr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:r}=t;if(!e||!r)return null;try{return mr.credential(e,r)}catch(t){return null}}}mr.TWITTER_SIGN_IN_METHOD="twitter.com",mr.PROVIDER_ID="twitter.com";class gr{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,r,i=!1){const n=await xe._fromIdTokenResponse(t,r,i),o=yr(r);return new gr({user:n,providerId:o,_tokenResponse:r,operationType:e})}static async _forOperation(t,e,r){await t._updateTokensIfNecessary(r,!0);const i=yr(r);return new gr({user:t,providerId:i,_tokenResponse:r,operationType:e})}}function yr(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class vr extends g{constructor(t,e,r,i){var n;super(e.code,e.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,vr.prototype),this.customData={appName:t.name,tenantId:null!==(n=t.tenantId)&&void 0!==n?n:void 0,_serverResponse:e.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(t,e,r,i){return new vr(t,e,r,i)}}function _r(t,e,r,i){return("reauthenticate"===e?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch((r=>{if("auth/multi-factor-auth-required"===r.code)throw vr._fromErrorAndOperation(t,r,e,i);throw r}))}async function br(t,e,r=!1){const i=await fe(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return gr._forOperation(t,"link",i)}async function xr(t,e,r=!1){const{auth:i}=t;if(dt(i.app))return Promise.reject(Bt(i));const n="reauthenticate";try{const o=await fe(t,_r(i,n,e,t),r);Nt(o.idToken,i,"internal-error");const s=de(o.idToken);Nt(s,i,"internal-error");const{sub:a}=s;return Nt(t.uid===a,i,"user-mismatch"),gr._forOperation(t,n,o)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&Dt(i,"user-mismatch"),t}}async function wr(t,e,r=!1){if(dt(t.app))return Promise.reject(Bt(t));const i="signIn",n=await _r(t,i,e),o=await gr._fromIdTokenResponse(t,i,n);return r||await t._updateCurrentUser(o.user),o}async function Tr(t,e){return wr($e(t),e)}new WeakMap;const Er="__sak";class Sr{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(Er,"1"),this.storage.removeItem(Er),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class Pr extends Sr{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=m();return Ce(t)||Fe(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=ze(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const r=this.storage.getItem(e),i=this.localCache[e];r!==i&&t(e,i,r)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,r)=>{this.notifyListeners(t,r)}));const r=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(r);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(r,t.newValue):this.storage.removeItem(r);else if(this.localCache[r]===t.newValue&&!e)return}const i=()=>{const t=this.storage.getItem(r);(e||this.localCache[r]!==t)&&this.notifyListeners(r,t)},n=this.storage.getItem(r);Be()&&n!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,10):i()}notifyListeners(t,e){this.localCache[t]=e;const r=this.listeners[t];if(r)for(const t of Array.from(r))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:r}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}Pr.type="LOCAL";const kr=Pr;class Ar extends Sr{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}Ar.type="SESSION";const Mr=Ar;class Cr{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const r=new Cr(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:r,eventType:i,data:n}=e.data,o=this.handlersMap[i];if(!(null==o?void 0:o.size))return;e.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const s=Array.from(o).map((async t=>t(e.origin,n))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(s);e.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Ir(t="",e=10){let r="";for(let t=0;t<e;t++)r+=Math.floor(10*Math.random());return t+r}Cr.receivers=[];class Or{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,r=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let n,o;return new Promise(((s,a)=>{const l=Ir("",20);i.port1.start();const c=setTimeout((()=>{a(new Error("unsupported_event"))}),r);o={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===l)switch(e.data.status){case"ack":clearTimeout(c),n=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(n),s(e.data.response);break;default:clearTimeout(c),clearTimeout(n),a(new Error("invalid_response"))}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:t,eventId:l,data:e},[i.port2])})).finally((()=>{o&&this.removeMessageHandler(o)}))}}function Lr(){return window}function Dr(){return void 0!==Lr().WorkerGlobalScope&&"function"==typeof Lr().importScripts}const Rr="firebaseLocalStorageDb",Fr="firebaseLocalStorage",Br="fbase_key";class zr{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function jr(t,e){return t.transaction([Fr],e?"readwrite":"readonly").objectStore(Fr)}function Nr(){const t=indexedDB.open(Rr,1);return new Promise(((e,r)=>{t.addEventListener("error",(()=>{r(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(Fr,{keyPath:Br})}catch(t){r(t)}})),t.addEventListener("success",(async()=>{const r=t.result;r.objectStoreNames.contains(Fr)?e(r):(r.close(),await function(){const t=indexedDB.deleteDatabase(Rr);return new zr(t).toPromise()}(),e(await Nr()))}))}))}async function Vr(t,e,r){const i=jr(t,!0).put({[Br]:e,value:r});return new zr(i).toPromise()}function Ur(t,e){const r=jr(t,!0).delete(e);return new zr(r).toPromise()}class $r{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Nr()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Dr()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Cr._getInstance(Dr()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new Or(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&(null===(t=r[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=r[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){var e;if(this.sender&&this.activeServiceWorker&&((null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Nr();return await Vr(t,Er,"1"),await Ur(t,Er),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((r=>Vr(r,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const r=jr(t,!1).get(e),i=await new zr(r).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>Ur(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=jr(t,!1).getAll();return new zr(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],r=new Set;if(0!==t.length)for(const{fbase_key:i,value:n}of t)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(n)&&(this.notifyListeners(i,n),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!r.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const r=this.listeners[t];if(r)for(const t of Array.from(r))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}$r.type="LOCAL";const Gr=$r;We("rcb"),new Wt(3e4,6e4);const Hr="recaptcha";async function qr(t,e,r){var i;const n=await r.verify();try{let o;if(Nt("string"==typeof n,t,"argument-error"),Nt(r.type===Hr,t,"argument-error"),o="string"==typeof e?{phoneNumber:e}:e,"session"in o){const e=o.session;if("phoneNumber"in o){Nt("enroll"===e.type,t,"internal-error");const r=await function(t,e){return Qt(t,"POST","/v2/accounts/mfaEnrollment:start",Jt(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,recaptchaToken:n}});return r.phoneSessionInfo.sessionInfo}{Nt("signin"===e.type,t,"internal-error");const r=(null===(i=o.multiFactorHint)||void 0===i?void 0:i.uid)||o.multiFactorUid;Nt(r,t,"missing-multi-factor-info");const s=await function(t,e){return Qt(t,"POST","/v2/accounts/mfaSignIn:start",Jt(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:r,phoneSignInInfo:{recaptchaToken:n}});return s.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return Qt(t,"POST","/v1/accounts:sendVerificationCode",Jt(t,e))}(t,{phoneNumber:o.phoneNumber,recaptchaToken:n});return e}}finally{r._reset()}}class Wr{constructor(t){this.providerId=Wr.PROVIDER_ID,this.auth=$e(t)}verifyPhoneNumber(t,e){return qr(this.auth,t,P(e))}static credential(t,e){return ar._fromVerification(t,e)}static credentialFromResult(t){const e=t;return Wr.credentialFromTaggedObject(e)}static credentialFromError(t){return Wr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:r}=t;return e&&r?ar._fromTokenResponse(e,r):null}}function Zr(t,e){return e?Te(e):(Nt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}Wr.PROVIDER_ID="phone",Wr.PHONE_SIGN_IN_METHOD="phone";class Xr extends tr{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return nr(t,this._buildIdpRequest())}_linkToIdToken(t,e){return nr(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return nr(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function Yr(t){return wr(t.auth,new Xr(t),t.bypassAuthState)}function Kr(t){const{auth:e,user:r}=t;return Nt(r,e,"internal-error"),xr(r,new Xr(t),t.bypassAuthState)}async function Jr(t){const{auth:e,user:r}=t;return Nt(r,e,"internal-error"),br(r,new Xr(t),t.bypassAuthState)}class Qr{constructor(t,e,r,i,n=!1){this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=n,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:r,postBody:i,tenantId:n,error:o,type:s}=t;if(o)return void this.reject(o);const a={auth:this.auth,requestUri:e,sessionId:r,tenantId:n||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return Yr;case"linkViaPopup":case"linkViaRedirect":return Jr;case"reauthViaPopup":case"reauthViaRedirect":return Kr;default:Dt(this.auth,"internal-error")}}resolve(t){Ut(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Ut(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ti=new Wt(2e3,1e4);class ei extends Qr{constructor(t,e,r,i,n){super(t,e,i,n),this.provider=r,this.authWindow=null,this.pollId=null,ei.currentPopupAction&&ei.currentPopupAction.cancel(),ei.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Nt(t,this.auth,"internal-error"),t}async onExecution(){Ut(1===this.filter.length,"Popup operations only handle one event");const t=Ir();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(Rt(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(Rt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ei.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,r;(null===(r=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===r?void 0:r.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Rt(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(t,ti.get())};t()}}ei.currentPopupAction=null;const ri=new Map;class ii extends Qr{constructor(t,e,r=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,r),this.eventId=null}async execute(){let t=ri.get(this.auth._key());if(!t){try{const e=await async function(t,e){const r=si(e),i=oi(t);if(!await i._isAvailable())return!1;const n="true"===await i._get(r);return await i._remove(r),n}(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(e)}catch(e){t=()=>Promise.reject(e)}ri.set(this.auth._key(),t)}return this.bypassAuthState||ri.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function ni(t,e){ri.set(t._key(),e)}function oi(t){return Te(t._redirectPersistence)}function si(t){return Pe("pendingRedirect",t.config.apiKey,t.name)}async function ai(t,e,r=!1){if(dt(t.app))return Promise.reject(Bt(t));const i=$e(t),n=Zr(i,e),o=new ii(i,n,r),s=await o.execute();return s&&!r&&(delete s.user._redirectEventId,await i._persistUserIfCurrent(s.user),await i._setRedirectUser(null,e)),s}class li{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((r=>{this.isEventForConsumer(t,r)&&(e=!0,this.sendToConsumer(t,r),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ui(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var r;if(t.error&&!ui(t)){const i=(null===(r=t.error.code)||void 0===r?void 0:r.split("auth/")[1])||"internal-error";e.onError(Rt(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const r=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&r}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(ci(t))}saveEventToCache(t){this.cachedEventUids.add(ci(t)),this.lastProcessedEventTime=Date.now()}}function ci(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function ui({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const hi=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,di=/^https?/;async function pi(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return Qt(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(fi(t))return}catch(t){}Dt(t,"unauthorized-domain")}function fi(t){const e=$t(),{protocol:r,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const n=new URL(t);return""===n.hostname&&""===i?"chrome-extension:"===r&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===r&&n.hostname===i}if(!di.test(r))return!1;if(hi.test(t))return i===t;const n=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+n+"|"+n+")$","i").test(i)}const mi=new Wt(3e4,6e4);function gi(){const t=Lr().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}function yi(t){return new Promise(((e,r)=>{var i,n,o;function s(){gi(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{gi(),r(Rt(t,"network-request-failed"))},timeout:mi.get()})}if(null===(n=null===(i=Lr().gapi)||void 0===i?void 0:i.iframes)||void 0===n?void 0:n.Iframe)e(gapi.iframes.getContext());else{if(!(null===(o=Lr().gapi)||void 0===o?void 0:o.load)){const e=We("iframefcb");return Lr()[e]=()=>{gapi.load?s():r(Rt(t,"network-request-failed"))},qe(`${He.gapiScript}?onload=${e}`).catch((t=>r(t)))}s()}})).catch((t=>{throw vi=null,t}))}let vi=null;const _i=new Wt(5e3,15e3),bi={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xi=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function wi(t){const e=t.config;Nt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Zt(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,i={apiKey:e.apiKey,appName:t.name,v:mt},n=xi.get(t.config.apiHost);n&&(i.eid=n);const o=t._getFrameworks();return o.length&&(i.fw=o.join(",")),`${r}?${x(i).slice(1)}`}async function Ti(t){const e=await function(t){return vi=vi||yi(t),vi}(t),r=Lr().gapi;return Nt(r,t,"internal-error"),e.open({where:document.body,url:wi(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:bi,dontclear:!0},(e=>new Promise((async(r,i)=>{await e.restyle({setHideOnLeave:!1});const n=Rt(t,"network-request-failed"),o=Lr().setTimeout((()=>{i(n)}),_i.get());function s(){Lr().clearTimeout(o),r(e)}e.ping(s).then(s,(()=>{i(n)}))}))))}const Ei={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Si{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}function Pi(t,e,r,i=500,n=600){const o=Math.max((window.screen.availHeight-n)/2,0).toString(),s=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l=Object.assign(Object.assign({},Ei),{width:i.toString(),height:n.toString(),top:o,left:s}),c=m().toLowerCase();r&&(a=Ie(c)?"_blank":r),Me(c)&&(e=e||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce(((t,[e,r])=>`${t}${e}=${r},`),"");if(function(t=m()){var e;return Fe(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==a)return function(t,e){const r=document.createElement("a");r.href=t,r.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(i)}(e||"",a),new Si(null);const h=window.open(e||"",a,u);Nt(h,t,"popup-blocked");try{h.focus()}catch(t){}return new Si(h)}const ki="__/auth/handler",Ai="emulator/auth/handler",Mi=encodeURIComponent("fac");async function Ci(t,e,r,i,n,o){Nt(t.config.authDomain,t,"auth-domain-config-required"),Nt(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:i,v:mt,eventId:n};if(e instanceof ur){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(o||{}))s[t]=e}if(e instanceof hr){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(s.scopes=t.join(","))}t.tenantId&&(s.tid=t.tenantId);const a=s;for(const t of Object.keys(a))void 0===a[t]&&delete a[t];const l=await t._getAppCheckToken(),c=l?`#${Mi}=${encodeURIComponent(l)}`:"";return`${function({config:t}){if(!t.emulator)return`https://${t.authDomain}/${ki}`;return Zt(t,Ai)}(t)}?${x(a).slice(1)}${c}`}const Ii="webStorageSupport";const Oi=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Mr,this._completeRedirectFn=ai,this._overrideRedirectResult=ni}async _openPopup(t,e,r,i){var n;Ut(null===(n=this.eventManagers[t._key()])||void 0===n?void 0:n.manager,"_initialize() not called before _openPopup()");return Pi(t,await Ci(t,e,r,$t(),i),Ir())}async _openRedirect(t,e,r,i){await this._originValidation(t);return function(t){Lr().location.href=t}(await Ci(t,e,r,$t(),i)),new Promise((()=>{}))}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:r}=this.eventManagers[e];return t?Promise.resolve(t):(Ut(r,"If manager is not set, promise should be"),r)}const r=this.initAndGetManager(t);return this.eventManagers[e]={promise:r},r.catch((()=>{delete this.eventManagers[e]})),r}async initAndGetManager(t){const e=await Ti(t),r=new li(t);return e.register("authEvent",(e=>{Nt(null==e?void 0:e.authEvent,t,"invalid-auth-event");return{status:r.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:r},this.iframes[t._key()]=e,r}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Ii,{type:Ii},(r=>{var i;const n=null===(i=null==r?void 0:r[0])||void 0===i?void 0:i.webStorageSupport;void 0!==n&&e(!!n),Dt(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=pi(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return ze()||Ce()||Fe()}};var Li="@firebase/auth",Di="1.7.3";class Ri{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(t)}}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{t((null==e?void 0:e.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Nt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Fi=p("authIdTokenMaxAge")||300;let Bi=null;function zi(t=function(t="[DEFAULT]"){const e=st.get(t);if(!e&&t===nt&&d())return gt();if(!e)throw pt.create("no-app",{appName:t});return e}()){const e=ht(t,"auth");if(e.isInitialized())return e.getImmediate();const r=function(t,e){const r=ht(t,"auth");if(r.isInitialized()){const t=r.getImmediate();if(_(r.getOptions(),null!=e?e:{}))return t;Dt(t,"already-initialized")}return r.initialize({options:e})}(t,{popupRedirectResolver:Oi,persistence:[Gr,kr,Mr]}),i=p("authTokenSyncURL");if(i&&"boolean"==typeof isSecureContext&&isSecureContext){const t=new URL(i,location.origin);if(location.origin===t.origin){const e=(n=t.toString(),async t=>{const e=t&&await t.getIdTokenResult(),r=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(r&&r>Fi)return;const i=null==e?void 0:e.token;Bi!==i&&(Bi=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(t,e,r){P(t).beforeAuthStateChanged(e,r)}(r,e,(()=>e(r.currentUser))),function(t,e,r,i){P(t).onIdTokenChanged(e,r,i)}(r,(t=>e(t)))}}var n;const o=h("auth");return o&&Ke(r,`http://${o}`),r}var ji;He={loadJS:t=>new Promise(((e,r)=>{const i=document.createElement("script");var n,o;i.setAttribute("src",t),i.onload=e,i.onerror=t=>{const e=Rt("internal-error");e.customData=t,r(e)},i.type="text/javascript",i.charset="UTF-8",(null!==(o=null===(n=document.getElementsByTagName("head"))||void 0===n?void 0:n[0])&&void 0!==o?o:document).appendChild(i)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},ji="Browser",ut(new k("auth",((t,{options:e})=>{const r=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),n=t.getProvider("app-check-internal"),{apiKey:o,authDomain:s}=r.options;Nt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const a={apiKey:o,authDomain:s,clientPlatform:ji,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:je(ji)},l=new Ue(r,i,n,a);return function(t,e){const r=(null==e?void 0:e.persistence)||[],i=(Array.isArray(r)?r:[r]).map(Te);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(l,e),l}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,r)=>{t.getProvider("auth-internal").initialize()}))),ut(new k("auth-internal",(t=>(t=>new Ri(t))($e(t.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),yt(Li,Di,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(ji)),yt(Li,Di,"esm2017");yt("firebase","10.12.0","app");var Ni=r(8020);function Vi(t){return Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vi(t)}function Ui(){Ui=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(t,e,r,i){var o=e&&e.prototype instanceof g?e:g,s=Object.create(o.prototype),a=new M(i||[]);return n(s,"_invoke",{value:S(t,r,a)}),s}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",p="executing",f="completed",m={};function g(){}function y(){}function v(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(C([])));x&&x!==r&&i.call(x,s)&&(_=x);var w=v.prototype=g.prototype=Object.create(_);function T(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(n,o,s,a){var l=h(t[n],t,o);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==Vi(u)&&i.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,s,a)}),(function(t){r("throw",t,s,a)})):e.resolve(u).then((function(t){c.value=t,s(c)}),(function(t){return r("throw",t,s,a)}))}a(l.arg)}var o;n(this,"_invoke",{value:function(t,i){function n(){return new e((function(e,n){r(t,i,e,n)}))}return o=o?o.then(n,n):n()}})}function S(e,r,i){var n=d;return function(o,s){if(n===p)throw Error("Generator is already running");if(n===f){if("throw"===o)throw s;return{value:t,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var l=P(a,i);if(l){if(l===m)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===d)throw n=f,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=p;var c=h(e,r,i);if("normal"===c.type){if(n=i.done?f:"suspendedYield",c.arg===m)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n=f,i.method="throw",i.arg=c.arg)}}}function P(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var o=h(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(Vi(e)+" is not iterable")}return y.prototype=v,n(w,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:y,configurable:!0}),y.displayName=c(v,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,l,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},T(E.prototype),c(E.prototype,a,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new E(u(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},T(w),c(w,l,"Generator"),c(w,s,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=C,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return a.type="throw",a.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;A(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:C(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}function $i(t,e,r,i,n,o,s){try{var a=t[o](s),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(i,n)}function Gi(t){return function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function s(t){$i(o,i,n,s,a,"next",t)}function a(t){$i(o,i,n,s,a,"throw",t)}s(void 0)}))}}function Hi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qi(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Ji(i.key),i)}}function Wi(t,e){return Wi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Wi(t,e)}function Zi(t){var e=Yi();return function(){var r,i=Ki(t);if(e){var n=Ki(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return Xi(this,r)}}function Xi(t,e){if(e&&("object"===Vi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Yi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Yi=function(){return!!t})()}function Ki(t){return Ki=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ki(t)}function Ji(t){var e=function(t,e){if("object"!=Vi(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=Vi(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Vi(e)?e:e+""}var Qi,tn,en,rn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wi(t,e)}(o,t);var e,r,i,n=Zi(o);function o(){return Hi(this,o),n.apply(this,arguments)}return e=o,r=[{key:"connect",value:function(){var t=this;this.waitForGoogleLibrary().then((function(){t.initializeGoogleSignIn()}))}},{key:"waitForGoogleLibrary",value:function(){return new Promise((function(t,e){var r=0;!function i(){window.google?t():r<15?setTimeout((function(){r++,i()}),500):e()}()}))}},{key:"initializeGoogleSignIn",value:function(){if(this.hasUserLoggedInTarget&&"false"===this.userLoggedInTarget.value&&this.hasGoogleClientIdTarget){var t=this.googleClientIdTarget.value;google.accounts.id.initialize({client_id:t,callback:this.googleOneTap.bind(this)}),google.accounts.id.prompt()}}},{key:"googleOneTap",value:function(t){var e=this;(0,Ni.U)({event:"user_event",event_name:"user_event",user_event_type:"login_google_click",location:"login"});var r=JSON.parse(this.firebaseConfigTarget.value),i=pr.credential(t.credential);Tr(zi(gt(r)),i).then(function(){var t=Gi(Ui().mark((function t(r){return Ui().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(0,Ni.U)({event:"user_event",event_name:"user_event",user_event_type:"login_google_success",location:"login"}),t.next=3,e.singInBackend(r.user);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){console.error("Error",t)}))}},{key:"google",value:function(){var t=this,e=JSON.parse(this.firebaseConfigTarget.value),r=new pr,i=zi(gt(e));this.errorMessageTarget.classList.add("tw-hidden"),this.disableButtons(),(0,Ni.U)({event:"user_event",event_name:"user_event",user_event_type:"login_google_click",location:"login"}),async function(t,e,r){if(dt(t.app))return Promise.reject(Rt(t,"operation-not-supported-in-this-environment"));const i=$e(t);zt(t,e,ur);const n=Zr(i,r);return new ei(i,"signInViaPopup",e,n).executeNotNull()}(i,r).then(function(){var e=Gi(Ui().mark((function e(r){return Ui().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,Ni.U)({event:"user_event",event_name:"user_event",user_event_type:"login_google_success",location:"login"}),e.next=3,t.singInBackend(r.user);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.errorMessageTarget.innerHTML="Ops! Something went wrong. Please try again later.",t.errorMessageTarget.classList.remove("tw-hidden")})).finally((function(){t.enableButtons()}))}},{key:"singInBackend",value:function(t){var e=this;fetch("/auth/google".concat(window.location.search),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:t})}).then(function(){var t=Gi(Ui().mark((function t(r){var i;return Ui().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.json();case 2:if("/"===(i=t.sent).redirect){t.next=6;break}return window.location.href=i.redirect,t.abrupt("return");case 6:if(200!==r.status){t.next=9;break}return window.location.reload(),t.abrupt("return");case 9:301!==r.status&&302!==r.status||(window.location.href=i.url),e.errorMessageTarget.innerHTML=i.message,e.errorMessageTarget.classList.remove("tw-hidden");case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.errorMessageTarget.innerHTML="Ops! Something went wrong. Please try again later.",e.errorMessageTarget.classList.remove("tw-hidden")}))}},{key:"disableButtons",value:function(){this.googleButtonTarget.disabled=!0}},{key:"enableButtons",value:function(){this.googleButtonTarget.disabled=!1}}],r&&qi(e.prototype,r),i&&qi(e,i),Object.defineProperty(e,"prototype",{writable:!1}),o}(i.xI);Qi=rn,en=["firebaseConfig","errorMessage","googleButton","userLoggedIn","googleClientId"],(tn=Ji(tn="targets"))in Qi?Object.defineProperty(Qi,tn,{value:en,enumerable:!0,configurable:!0,writable:!0}):Qi[tn]=en},9255:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>_});var i=r(2891),n=r(8020);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(){s=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function d(t,e,r,i){var o=e&&e.prototype instanceof v?e:v,s=Object.create(o.prototype),a=new I(i||[]);return n(s,"_invoke",{value:k(t,r,a)}),s}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var f="suspendedStart",m="executing",g="completed",y={};function v(){}function _(){}function b(){}var x={};h(x,l,(function(){return this}));var w=Object.getPrototypeOf,T=w&&w(w(O([])));T&&T!==r&&i.call(T,l)&&(x=T);var E=b.prototype=v.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,s,a,l){var c=p(t[n],t,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==o(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,l)}),(function(t){r("throw",t,a,l)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,l)}))}l(c.arg)}var s;n(this,"_invoke",{value:function(t,i){function n(){return new e((function(e,n){r(t,i,e,n)}))}return s=s?s.then(n,n):n()}})}function k(e,r,i){var n=f;return function(o,s){if(n===m)throw Error("Generator is already running");if(n===g){if("throw"===o)throw s;return{value:t,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var l=A(a,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===f)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=m;var c=p(e,r,i);if("normal"===c.type){if(n=i.done?g:"suspendedYield",c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n=g,i.method="throw",i.arg=c.arg)}}}function A(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=p(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(o(e)+" is not iterable")}return _.prototype=b,n(E,"constructor",{value:b,configurable:!0}),n(b,"constructor",{value:_,configurable:!0}),_.displayName=h(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,h(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(P.prototype),h(P.prototype,c,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new P(d(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),h(E,u,"Generator"),h(E,l,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return a.type="throw",a.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;C(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:O(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function a(t,e,r,i,n,o,s){try{var a=t[o](s),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(i,n)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,m(i.key),i)}}function u(t,e){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},u(t,e)}function h(t){var e=p();return function(){var r,i=f(t);if(e){var n=f(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return d(this,r)}}function d(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(p=function(){return!!t})()}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function m(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var g,y,v,_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(d,t);var e,r,i,o=h(d);function d(){return l(this,d),o.apply(this,arguments)}return e=d,r=[{key:"openModal",value:function(t){t&&(t.preventDefault(),t.stopPropagation()),(0,n.U)({event:"user_event",event_name:"user_event",user_event_type:"login_impression",location:"login"});var e=t.currentTarget;"SELECT"===e.tagName&&e.blur();var r=e.dataset.loginModalLink,i=e.dataset.flashMessage,o=new URLSearchParams;r&&o.append("rd",r),i&&o.append("flash","true");var s=document.getElementById("login-modal-base");s.innerHTML='\n  <div class="tw-fixed tw-bg-blackdrop tw-inset-0 tw-z-[100] tw-flex tw-items-center tw-justify-center">\n    <div class="tw-loader tw-w-10 tw-h-10 tw-border-4 tw-border-white tw-border-t-transparent tw-rounded-full tw-animate-spin tw-z-[9999]"></div>\n  </div>\n',fetch("/login/modal?".concat(o.toString())).then((function(t){return t.text()})).then((function(t){s.innerHTML=t,document.getElementById("_username").focus()}))}},{key:"submitLogin",value:function(t){var e=this;t.preventDefault(),t.stopPropagation();var r=t.currentTarget,i=new FormData(r),n=r.action,o=r.querySelector('[type="submit"]'),l=o.value;o.disabled=!0,o.value="Signing in...",o.style.cursor="default",o.style.opacity=.5,fetch(n,{method:"POST",body:i,headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},credentials:"same-origin"}).then(function(){var t,e=(t=s().mark((function t(e){var r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(401!==e.status&&400!==e.status){t.next=2;break}throw{message:"Invalid email address or password"};case 2:if(!e.ok){t.next=18;break}if(!(e.headers.get("content-type")||"").includes("application/json")){t.next=16;break}return t.prev=5,t.next=8,e.json();case 8:if(!(r=t.sent).success||!r.redirect||"/"===r.redirect){t.next=12;break}return window.location.href=r.redirect,t.abrupt("return");case 12:t.next=16;break;case 14:t.prev=14,t.t0=t.catch(5);case 16:return window.location.reload(),t.abrupt("return");case 18:return t.next=20,e.text();case 20:throw{message:"Login failed",detail:t.sent};case 22:case"end":return t.stop()}}),t,null,[[5,14]])})),function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function s(t){a(o,i,n,s,l,"next",t)}function l(t){a(o,i,n,s,l,"throw",t)}s(void 0)}))});return function(t){return e.apply(this,arguments)}}()).catch((function(t){e.showError(t.message||"Login failed"),o.disabled=!1,o.value=l,o.style.cursor="pointer",o.style.opacity=1}))}},{key:"showError",value:function(t){var e=this.formContainerTarget.querySelector(".login-error");e&&e.remove();var r=document.createElement("div");r.className="login-error tw-mb-0 tw-mt-2 tw-text-white tw-mb-2 tw-bg-red-300 tw-border-l-[11px] tw-text-center tw-border-red-600 tw-w-full tw-py-2.5",r.textContent=t,this.formContainerTarget.querySelector('input[type="password"]').closest("div").insertAdjacentElement("afterend",r)}},{key:"showPage",value:function(t){var e=this;t&&(t.preventDefault(),t.stopPropagation());var r=t.target.href;fetch(r).then((function(t){return t.text()})).then((function(t){e.formContainerTarget.innerHTML=t}))}},{key:"close",value:function(t){t&&(t.preventDefault(),t.stopPropagation()),this.fullscreenTarget.ariaHidden=!0}},{key:"closeWithKeyboard",value:function(t){"Escape"===t.key&&this.close(t)}}],r&&c(e.prototype,r),i&&c(e,i),Object.defineProperty(e,"prototype",{writable:!1}),d}(i.xI);g=_,v=["fullscreen","formContainer","userLoggedIn"],(y=m(y="targets"))in g?Object.defineProperty(g,y,{value:v,enumerable:!0,configurable:!0,writable:!0}):g[y]=v},2457:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>_});var i=r(2891),n=r(842),o=r.n(n);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,v(i.key),i)}}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}function d(t){var e=m();return function(){var r,i=g(t);if(e){var n=g(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return p(this,r)}}function p(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return f(t)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(m=function(){return!!t})()}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}function y(t,e,r){return(e=v(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}var _=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(s,t);var e,r,i,n=d(s);function s(){var t;c(this,s);for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return y(f(t=n.call.apply(n,[this].concat(r))),"loaded",!1),t}return e=s,(r=[{key:"open",value:function(){if(this.staticTarget.classList.toggle("tw-hidden"),this.dynamicTarget.classList.toggle("tw-hidden"),window.location.href="#mapbox",!this.loaded){o().accessToken=this.element.dataset.mapboxAccessToken;var t,e=JSON.parse(this.element.dataset.source),r=new(o().Map)({container:"mapbox",style:"mapbox://styles/mapbox/streets-v12",center:e.features[0].geometry.coordinates,zoom:12}),i=JSON.parse(this.element.dataset.source),n=a(i.features);try{for(n.s();!(t=n.n()).done;){var s=t.value,l=document.createElement("div");l.className="marker marker-"+s.properties["marker-symbol"];var c=new(o().Popup)({offset:25,className:"marker-popup"}).setText(s.properties.name);new(o().Marker)({element:l}).setLngLat(s.geometry.coordinates).setPopup(c).addTo(r)}}catch(t){n.e(t)}finally{n.f()}var u=new(o().LngLatBounds);i.features.forEach((function(t){u.extend(t.geometry.coordinates)})),r.fitBounds(u,{padding:60}),this.loaded=!0}}},{key:"close",value:function(){this.staticTarget.classList.toggle("tw-hidden"),this.dynamicTarget.classList.toggle("tw-hidden"),window.location.href="#map"}}])&&u(e.prototype,r),i&&u(e,i),Object.defineProperty(e,"prototype",{writable:!1}),s}(i.xI);y(_,"targets",["static","dynamic"])},9278:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,s(i.key),i)}}function s(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function l(t){var e=u();return function(){var r,i=h(t);if(e){var n=h(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return c(this,r)}}function c(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(u=function(){return!!t})()}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}r.r(e),r.d(e,{default:()=>d});var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(c,t);var e,r,i,s=l(c);function c(){return n(this,c),s.apply(this,arguments)}return e=c,(r=[{key:"toggle",value:function(t){var e=document.getElementById("mobile-nav");t.preventDefault(),e.classList.toggle("!tw-h-full")}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI)},3785:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"toggle",value:function(){this.contentTargets.forEach((function(t){return t.classList.toggle("tw-hidden")}));var t=this.contentTarget.classList.contains("tw-hidden");this.linkTarget.innerText=t?"Show more":"Show less"}},{key:"toggleFeatures",value:function(){this.contentTargets.forEach((function(t){return t.classList.toggle("tw-hidden")}));var t=this.contentTarget.classList.contains("tw-hidden");this.showMoreButtonTextTarget.innerText=t?"Show more":"Show less",this.showMoreButtonIconTarget.classList.toggle("tw-rotate-180")}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["content","link","showMoreButtonText","showMoreButtonIcon"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},3050:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"toggle",value:function(t){var e=t.detail.content;if(e.dataset.parent){var r=e.classList.contains("tw-bg-[#44BFB6]");this.toggleOutlets.forEach((function(t){t.targets.element.getElementsByTagName("button")[0].dataset.parent||t.toggle({},!1,r)}))}else{var i=this.toggleOutlets.filter((function(t){var e=t.targets.element.getElementsByTagName("button")[0];return e.classList.contains("tw-bg-[#44BFB6]")&&!e.dataset.parent})),n=this.toggleOutlets.find((function(t){return t.targets.element.getElementsByTagName("button")[0].dataset.parent}));n.toggle({content:n.targets.element.getElementsByTagName("button")[0]},!1,i.length)}}},{key:"control",value:function(t){var e=this;if(t.detail.content.dataset.control){var r=this.toggleOutlets.filter((function(t){var e=t.targets.element.getElementsByTagName("button")[0];return e.classList.contains("tw-bg-[#44BFB6]")&&e.dataset.control})),i=this.toggleOutlets.filter((function(t){var e=t.targets.element.getElementsByTagName("button")[0];return e.classList.contains("tw-bg-[#B6BBC1]")&&!e.dataset.control&&!e.dataset.parent}));this.toggleOutlets.forEach((function(t){var n=e.toggleOutlets.filter((function(t){var e=t.targets.element.getElementsByTagName("button")[0];return e.dataset.control||e.dataset.parent})),o=i.length+n.length===e.toggleOutlets.length,s=t.targets.element.getElementsByTagName("button")[0];!o||s.dataset.parent||s.dataset.control||t.toggle({},!1,!1);var a=0===r.length;s.dataset.control||t.toggleOpacity({},a)}))}}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["toggle","control"],(p=h(p="outlets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},9530:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>v});var i=r(2891),n=r(7846),o=r.n(n);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,f(i.key),i)}}function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}function u(t){var e=d();return function(){var r,i=p(t);if(e){var n=p(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return h(this,r)}}function h(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function f(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}var m,g,y,v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(s,t);var e,r,i,n=u(s);function s(){return a(this,s),n.apply(this,arguments)}return e=s,(r=[{key:"connect",value:function(){this.openOnInit()}},{key:"openOnInit",value:function(){var t=new URLSearchParams(window.location.search).get("i");t&&this.doOpenFullscreen(t)}},{key:"openFullscreen",value:function(t){this.doOpenFullscreen(t.currentTarget.dataset.index)}},{key:"doOpenFullscreen",value:function(t){this.hasFullscreenTarget&&this.hasSplideTarget&&void 0!==t&&(this.fullscreenTarget.ariaHidden=!1,this.splide=new(o())(this.splideTarget,{start:t}),this.splide.mount(),this.bodyListener=this.closeFullscreen.bind(this),document.body.addEventListener("keydown",this.bodyListener))}},{key:"closeFullscreen",value:function(t){this.hasFullscreenTarget&&this.hasSplideTarget&&(t.target!==this.fullscreenTarget&&"Escape"!==t.key||(this.fullscreenTarget.ariaHidden=!0,this.bodyListener&&document.body.removeEventListener("keydown",this.bodyListener),this.splide&&(this.splide.destroy(),this.splide=null)))}}])&&l(e.prototype,r),i&&l(e,i),Object.defineProperty(e,"prototype",{writable:!1}),s}(i.xI);m=v,y=["image","fullscreen","splide"],(g=f(g="targets"))in m?Object.defineProperty(m,g,{value:y,enumerable:!0,configurable:!0,writable:!0}):m[g]=y},9688:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"connect",value:function(){this.titleElement=document.querySelector("head title")}},{key:"updateFromPaginator",value:function(t){this.pushState(t.detail.newUrl),this.updateTitle(t.detail),this.updateMeta(t.detail.newUrl)}},{key:"pushState",value:function(t){window.history.pushState({},"",t)}},{key:"updateTitle",value:function(t){var e=t.section,r=t.page;this.titleElement.textContent=this.getNewTitle(e,r)}},{key:"updateMeta",value:function(t){var e=document.querySelector('meta[name="robots"]'),r=document.querySelector('link[rel="canonical"]');t.includes("page=")||t.includes("pq=")?(e||document.head.insertAdjacentHTML("beforeend",'<meta name="robots" content="noindex,follow">'),r&&r.remove()):(e&&e.remove(),r||document.head.insertAdjacentHTML("beforeend",'<link rel="canonical" href="'.concat(this.canonicalUrl,'">')))}},{key:"getNewTitle",value:function(t,e){return"reviews"===t?"".concat(this.baseTitleValue," - Page ").concat(e," of Student Reviews"):"questions"===t?"".concat(this.baseTitleValue," - Page ").concat(e," of Student Questions"):void 0}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,p="values",f={baseTitle:String,canonicalUrl:String},(p=h(p))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},638:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"connect",value:function(){this.observer=null,this.surveyObserver=null,this.waitForHotjar()}},{key:"disconnect",value:function(){var t;null===(t=this.observer)||void 0===t||t.disconnect()}},{key:"waitForHotjar",value:function(){var t=this;this.observer=new MutationObserver((function(){window.hjSiteSettings&&t.checkPolls()})),this.observer.observe(document.body,{subtree:!0,childList:!0})}},{key:"checkPolls",value:function(){var t=this;window.hjSiteSettings&&window.hjSiteSettings.polls.length?window.hjSiteSettings.polls.forEach((function(e){if("popover"===e.display_type){var r=document.getElementById("survey_".concat(e.id));r&&(t.destroyObserver(),t.adjustNav(r),t.observeSurvey(r))}else t.destroyObserver()})):this.destroyObserver()}},{key:"adjustNav",value:function(){this.hasNavTarget&&this.navTarget.setAttribute("data-has-survey",!0)}},{key:"destroyObserver",value:function(){var t;null===(t=this.observer)||void 0===t||t.disconnect(),this.observer=null}},{key:"resetNav",value:function(){this.hasNavTarget&&this.navTarget.setAttribute("data-has-survey",!1)}},{key:"observeSurvey",value:function(t){var e=this;this.observer=new MutationObserver((function(){document.body.contains(t)||(e.resetNav(),e.destroyObserver())})),this.observer.observe(document.body,{subtree:!0,childList:!0})}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["nav"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},7435:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>_});var i=r(2891),n=r(7846),o=r.n(n);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,f(i.key),i)}}function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}function u(t){var e=d();return function(){var r,i=p(t);if(e){var n=p(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return h(this,r)}}function h(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function f(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}var m,g,y,v={pagination:!1,arrows:!1},_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(s,t);var e,r,i,n=u(s);function s(){return a(this,s),n.apply(this,arguments)}return e=s,(r=[{key:"connect",value:function(){this.init()}},{key:"disconnect",value:function(){this.splide.destroy()}},{key:"init",value:function(){this.splide=new(o())(this.element,v),this.splide.on("moved",this.handleMoved.bind(this)),this.splide.mount()}},{key:"handleMoved",value:function(t){this.hasPageTarget&&(this.pageTarget.innerText=t+1)}}])&&l(e.prototype,r),i&&l(e,i),Object.defineProperty(e,"prototype",{writable:!1}),s}(i.xI);m=_,y=["page","showAll"],(g=f(g="targets"))in m?Object.defineProperty(m,g,{value:y,enumerable:!0,configurable:!0,writable:!0}):m[g]=y},7663:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>y});var i=r(2891),n=r(6613);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,p(i.key),i)}}function l(t,e){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},l(t,e)}function c(t){var e=h();return function(){var r,i=d(t);if(e){var n=d(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return u(this,r)}}function u(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(h=function(){return!!t})()}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function p(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var f,m,g,y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(u,t);var e,r,i,o=c(u);function u(){return s(this,u),o.apply(this,arguments)}return e=u,(r=[{key:"connect",value:function(){this.highlightSectionInViewport(),window.addEventListener("scroll",this.handleScroll.bind(this))}},{key:"disconnect",value:function(){window.removeEventListener("scroll",this.handleScroll.bind(this))}},{key:"navTargetConnected",value:function(t){this.initialNavHeight=t.offsetHeight}},{key:"handleScroll",value:function(){this.hideButtonWhenRoomSectionIsActive(),this.highlightSectionInViewport()}},{key:"hideButtonWhenRoomSectionIsActive",value:function(){var t=document.querySelector(".cta-room-section"),e=document.getElementById("rooms"),r=this.isInViewport(e);t&&(t.style.opacity=r?"0":"1")}},{key:"highlightSectionInViewport",value:function(){var t=this.findItemsInViewport(),e=null==t?void 0:t[0];this.clearSelected(),e&&e.setAttribute("aria-selected",!0)}},{key:"isInViewport",value:function(t){var e=t.getBoundingClientRect();return e.top<window.innerHeight-this.getDeviceOffset()&&e.bottom>this.getDeviceOffset()&&e.left<window.innerWidth&&e.right>0}},{key:"findItemsInViewport",value:function(){var t=this;return this.navItemTargets.filter((function(e){var r=e.getAttribute("href").replace("#",""),i=document.getElementById(r);return i&&t.isInViewport(i)}))}},{key:"clearSelected",value:function(){this.navItemTargets.forEach((function(t){t.setAttribute("aria-selected",!1)}))}},{key:"getScrollOffset",value:function(t){return t.getBoundingClientRect().top+window.pageYOffset-this.getDeviceOffset()}},{key:"getDeviceOffset",value:function(){return(0,n.X)("md").matches?this.initialNavHeight:0}}])&&a(e.prototype,r),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),u}(i.xI);f=y,g=["navItem","nav"],(m=p(m="targets"))in f?Object.defineProperty(f,m,{value:g,enumerable:!0,configurable:!0,writable:!0}):f[m]=g},2937:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,d(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t,e,r){return(e=d(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>p});var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"goToPage",value:function(t){t.preventDefault();var e=t.currentTarget,r=new URL(e.dataset.link);this.dispatchPaginatorClick(e.href,e.dataset.page),Turbo.visit(r,{frame:this.turboFrameNameValue})}},{key:"dispatchPaginatorClick",value:function(t,e){var r={section:this.sectionValue,page:e,paramName:this.paramNameValue,newUrl:t};this.dispatch("pageChange",{cancelable:!1,detail:r})}},{key:"onPageChange",value:function(t){var e=t.detail;this.sectionValue!==e.section&&this.linkTargets.forEach((function(t){var r=new URL(t.href);e.page>1?r.searchParams.set(e.paramName,e.page):r.searchParams.delete(e.paramName),t.href=r.href;var i=new URL(t.dataset.link);i.searchParams.set(e.paramName,e.page),t.dataset.link=i.href}))}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);h(p,"targets",["link"]),h(p,"values",{turboFrameName:String,section:String,paramName:String})},9811:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"clickLink",value:function(t){t.preventDefault(),t.stopPropagation(),this.containerLinkTarget.classList.add("tw-hidden"),this.containerAnswerTarget.classList.remove("tw-hidden"),this.containerAnswerTarget.querySelector('textarea[data-profile-question-target="question"]').focus()}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["containerLink","containerAnswer"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},1412:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>_});var i=r(2891);function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){o=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function d(t,e,r,i){var n=e&&e.prototype instanceof v?e:v,o=Object.create(n.prototype),a=new I(i||[]);return s(o,"_invoke",{value:k(t,r,a)}),o}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var f="suspendedStart",m="executing",g="completed",y={};function v(){}function _(){}function b(){}var x={};h(x,l,(function(){return this}));var w=Object.getPrototypeOf,T=w&&w(w(O([])));T&&T!==r&&i.call(T,l)&&(x=T);var E=b.prototype=v.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(o,s,a,l){var c=p(t[o],t,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==n(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,l)}),(function(t){r("throw",t,a,l)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,l)}))}l(c.arg)}var o;s(this,"_invoke",{value:function(t,i){function n(){return new e((function(e,n){r(t,i,e,n)}))}return o=o?o.then(n,n):n()}})}function k(e,r,i){var n=f;return function(o,s){if(n===m)throw Error("Generator is already running");if(n===g){if("throw"===o)throw s;return{value:t,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var l=A(a,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===f)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=m;var c=p(e,r,i);if("normal"===c.type){if(n=i.done?g:"suspendedYield",c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n=g,i.method="throw",i.arg=c.arg)}}}function A(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=p(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,s=function r(){for(;++o<e.length;)if(i.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(n(e)+" is not iterable")}return _.prototype=b,s(E,"constructor",{value:b,configurable:!0}),s(b,"constructor",{value:_,configurable:!0}),_.displayName=h(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,h(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(P.prototype),h(P.prototype,c,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new P(d(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),h(E,u,"Generator"),h(E,l,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return a.type="throw",a.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;C(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:O(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function s(t,e,r,i,n,o,s){try{var a=t[o](s),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(i,n)}function a(t){return function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(t){s(o,i,n,a,l,"next",t)}function l(t){s(o,i,n,a,l,"throw",t)}a(void 0)}))}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,v(i.key),i)}}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var i=h(t,e);if(i){var n=Object.getOwnPropertyDescriptor(i,e);return n.get?n.get.call(arguments.length<3?t:r):n.value}},u.apply(this,arguments)}function h(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}function p(t){var e=m();return function(){var r,i=g(t);if(e){var n=g(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return f(this,r)}}function f(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function m(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(m=function(){return!!t})()}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}function y(t,e,r){return(e=v(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}var _=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(m,t);var e,r,i,n,s,h,f=p(m);function m(){return l(this,m),f.apply(this,arguments)}return e=m,r=[{key:"initialize",value:function(){u(g(m.prototype),"initialize",this).call(this),this.debounceTimeout=null,this.currentAbortController=null}},{key:"connect",value:function(){u(g(m.prototype),"connect",this).call(this),this.handleResize=this.handleResize.bind(this),window.addEventListener("resize",this.handleResize)}},{key:"disconnect",value:function(){u(g(m.prototype),"disconnect",this).call(this),window.removeEventListener("resize",this.handleResize)}},{key:"handleResize",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(!1===t||this.containerRegisterTarget.classList.contains("tw-hidden"))&&(this.isMobile()?(this.accountCreationTextMobileTarget.classList.remove("tw-hidden"),this.accountCreationTextDesktopTarget.classList.add("tw-hidden")):(this.accountCreationTextMobileTarget.classList.add("tw-hidden"),this.accountCreationTextDesktopTarget.classList.remove("tw-hidden")))}},{key:"submitQuestion",value:(h=a(o().mark((function t(e){var r,i,n,s;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),e.stopPropagation(),(r=new FormData).append("indexId",this.indexIdValue),r.append("questionId",this.idValue),r.append(this.defaultActionValue,this.questionTarget.value),this.hiddenErrorBox(),this.questionTarget.classList.remove("!tw-border-sc-yellow"),!(this.questionTarget.value.trim().length<=0)){t.next=14;break}return this.displayErrorBox("Please enter a question."),this.questionTarget.focus(),this.questionTarget.classList.add("!tw-border-sc-yellow"),t.abrupt("return",null);case 14:if(t.prev=14,!this.containerRegisterTarget.classList.contains("tw-hidden")){t.next=22;break}return this.questionTarget.parentElement.classList.add("tw-hidden"),this.containerRegisterTarget.classList.remove("tw-hidden"),this.textSubmitButtonTarget.innerText="Submit",this.stepLabelTarget.innerText="Step 2 of 2",this.handleResize(!1),t.abrupt("return",null);case 22:return t.next=24,this.validateEmail();case 24:if(t.sent){t.next=28;break}return this.displayErrorBox("Please enter a valid email address."),t.abrupt("return",null);case 28:if(this.passwordTarget.classList.remove("!tw-border-sc-yellow"),this.passwordContainerTarget.classList.contains("tw-hidden")){t.next=43;break}if(!(this.passwordTarget.value.length<=0)){t.next=35;break}return this.displayErrorBox("Please enter a password."),this.passwordTarget.focus(),this.passwordTarget.classList.add("!tw-border-sc-yellow"),t.abrupt("return",null);case 35:return r.append("action","login"),r.append("username",this.emailTarget.value),r.append("password",this.passwordTarget.value),t.next=40,this.postQuestion(r);case 40:return t.sent&&(this.containerRegisterTarget.classList.add("tw-hidden"),this.stepLabelTarget.classList.add("tw-hidden")),t.abrupt("return",null);case 43:if(i=this.userTypeTarget.value,this.userTypeTarget.classList.remove("!tw-border-sc-yellow"),""!==i){t.next=50;break}return this.userTypeTarget.focus(),this.userTypeTarget.classList.add("!tw-border-sc-yellow"),this.displayErrorBox("Please select who you are."),t.abrupt("return",null);case 50:if(n=["prospective","graduate","undergrad"],s=this.studentTypeTarget.value,this.studentTypeTarget.classList.remove("!tw-border-sc-yellow"),!n.includes(i)||""!==s){t.next=58;break}return this.studentTypeTarget.focus(),this.studentTypeTarget.classList.add("!tw-border-sc-yellow"),this.displayErrorBox("Please select Domestic or International."),t.abrupt("return",null);case 58:return r.append("action","signup"),r.append("email",this.emailTarget.value),r.append("userType",this.userTypeTarget.value),r.append("studentType",this.studentTypeTarget.value),t.next=64,this.postQuestion(r);case 64:t.sent&&(this.containerRegisterTarget.classList.add("tw-hidden"),this.stepLabelTarget.classList.add("tw-hidden")),t.next=76;break;case 68:if(t.prev=68,t.t0=t.catch(14),-1===t.t0.message.indexOf("containerRegister")){t.next=75;break}return r.append("action",this.defaultActionValue),t.next=74,this.postQuestion(r);case 74:return t.abrupt("return",null);case 75:console.error({error:t.t0});case 76:case"end":return t.stop()}}),t,this,[[14,68]])}))),function(t){return h.apply(this,arguments)})},{key:"displayErrorBox",value:function(t){this.errorContainerTarget.innerText=t,this.errorContainerTarget.classList.remove("tw-hidden")}},{key:"hiddenErrorBox",value:function(){this.errorContainerTarget.classList.add("tw-hidden")}},{key:"validateEmail",value:(s=a(o().mark((function t(){var e=this;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return clearTimeout(this.debounceTimeout),t.abrupt("return",new Promise((function(t){e.debounceTimeout=setTimeout(a(o().mark((function r(){var i,n,s,a,l;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.currentAbortController&&e.currentAbortController.abort(),e.currentAbortController=new AbortController,i=e.currentAbortController.signal,n=e.emailTarget.value,/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(n)){r.next=8;break}return e.emailTarget.classList.add("!tw-border-sc-yellow"),r.abrupt("return",null);case 8:return e.emailTarget.classList.remove("!tw-border-sc-yellow"),(s=new URLSearchParams).append("validate_account_email",n),s.append("current_student_type","false"),r.prev=12,r.next=15,fetch(e.emailValidateUrlValue,{method:"POST",body:s,headers:{"X-Requested-With":"XMLHttpRequest"},signal:i});case 15:return a=r.sent,r.next=18,a.json();case 18:if(!((l=r.sent).length>0)){r.next=41;break}if(e.emailTarget.classList.add("!tw-border-sc-yellow"),"email_already_exists"!==l[0].code){r.next=32;break}return e.titleLabelTarget.innerText="You already have an account! Please sign in to leave your question:",e.userTypeTarget.classList.add("tw-hidden"),e.passwordContainerTarget.classList.remove("tw-hidden"),e.emailTarget.classList.remove("!tw-border-sc-yellow"),e.passwordTarget.focus(),e.userTypeTarget.classList.add("tw-hidden"),e.studentTypeTarget.classList.add("tw-hidden"),t(!0),r.abrupt("return",!0);case 32:return e.passwordContainerTarget.classList.add("tw-hidden"),e.titleLabelTarget.innerText="Let us know who's asking",e.displayErrorBox(l[0].message),e.userTypeTarget.classList.remove("tw-hidden"),e.userTypeTarget.classList.remove("tw-bg-white"),e.userTypeTarget.disabled=!0,e.studentTypeTarget.disabled=!0,t(!1),r.abrupt("return",null);case 41:e.passwordContainerTarget.classList.add("tw-hidden"),e.titleLabelTarget.innerText="Let us know who's asking",e.emailTarget.classList.remove("!tw-border-sc-yellow"),e.userTypeTarget.classList.remove("tw-hidden"),e.userTypeTarget.classList.add("tw-bg-white"),e.userTypeTarget.removeAttribute("disabled"),r.next=52;break;case 49:r.prev=49,r.t0=r.catch(12),"AbortError"!==r.t0.name&&console.error(r.t0.message);case 52:t(!0);case 53:case"end":return r.stop()}}),r,null,[[12,49]])}))),300)})));case 2:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"changeUserType",value:function(){var t=this.userTypeTarget.value;switch(""!==t&&this.userTypeTarget.classList.remove("!tw-border-sc-yellow"),t){case"parent":case"other":this.studentTypeTarget.classList.add("tw-hidden"),this.studentTypeTarget.disabled=!0;break;default:this.studentTypeTarget.classList.remove("tw-hidden"),this.studentTypeTarget.removeAttribute("disabled")}}},{key:"postQuestion",value:(n=a(o().mark((function t(e){var r,i,n,s=this;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=function(t){s.displayErrorBox(t),s.textSubmitButtonTarget.innerText="Submit",s.submitButtonTarget.removeAttribute("disabled")},t.prev=1,this.submitButtonTarget.disabled=!0,this.textSubmitButtonTarget.innerText="Submitting...",t.next=6,fetch(this.askUrlValue,{method:"POST",body:e,headers:{"X-Requested-With":"XMLHttpRequest"}});case 6:if(200!==(i=t.sent).status){t.next=12;break}return this.textSubmitButtonTarget.parentNode.parentNode.classList.add("tw-hidden"),this.successContainerTarget.classList.remove("tw-hidden"),this.questionTarget.classList.add("tw-hidden"),t.abrupt("return",!0);case 12:if(400!==i.status){t.next=18;break}return t.next=15,i.json();case 15:return n=t.sent,r(n.join(", ")),t.abrupt("return",!1);case 18:r("There was an error submitting your question. Please try again."),t.next=25;break;case 21:t.prev=21,t.t0=t.catch(1),console.error(t.t0),r(t.t0.message);case 25:case"end":return t.stop()}}),t,this,[[1,21]])}))),function(t){return n.apply(this,arguments)})},{key:"isMobile",value:function(){return window.innerWidth<=768}}],r&&c(e.prototype,r),i&&c(e,i),Object.defineProperty(e,"prototype",{writable:!1}),m}(i.xI);y(_,"targets",["question","submitButton","textSubmitButton","containerRegister","titleLabel","stepLabel","email","password","passwordContainer","userType","studentType","errorContainer","successContainer","accountCreationTextDesktop","accountCreationTextMobile"]),y(_,"values",{indexId:Number,askUrl:String,id:String,defaultAction:String,emailValidateUrl:String})},1950:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"readMoreReviews",value:function(t){var e=this;t.preventDefault(),this.linkTarget.classList.add("disabled-link");var r=this.linkTarget.href,i=t.params.href;fetch(i,{headers:{"Turbo-Frame":"true"}}).then((function(t){return t.text()})).then((function(t){e.reviewsListTarget.innerHTML=t,window.history.pushState({},"",r)}))}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["link","reviewsList"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},8552:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>y});var i=r(2891),n=r(6613);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,p(i.key),i)}}function l(t,e){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},l(t,e)}function c(t){var e=h();return function(){var r,i=d(t);if(e){var n=d(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return u(this,r)}}function u(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(h=function(){return!!t})()}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function p(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var f,m,g,y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(u,t);var e,r,i,o=c(u);function u(){return s(this,u),o.apply(this,arguments)}return e=u,(r=[{key:"connect",value:function(){var t=this;this.isRatingExpanded=!1,this.isSentimentExpanded=!1,window.addEventListener("resize",(function(){return t.checkSentimentOnDesktop.bind(t)}))}},{key:"disconnect",value:function(){window.removeEventListener(this.checkSentimentOnDesktop.bind(this))}},{key:"updateRating",value:function(){this.isRatingExpanded?(this.ratingTargets.forEach((function(t){t.classList.remove("tw-hidden")})),this.showMoreRatingTarget.text="Show less..."):(this.ratingTargets.slice(4).forEach((function(t){t.classList.add("tw-hidden")})),this.showMoreRatingTarget.text="Show more...")}},{key:"updateSentiment",value:function(){var t=this.sentimentTargets.filter((function(t){return"negative"===t.dataset.sentiment}));this.isSentimentExpanded?(t.forEach((function(t){t.classList.remove("tw-hidden")})),this.showMoreSentimentTarget.text="Show less..."):(t.slice(2).forEach((function(t){t.classList.add("tw-hidden")})),this.showMoreSentimentTarget.text="Show more...")}},{key:"toggleRatingMore",value:function(t){t.preventDefault(),this.isRatingExpanded=!this.isRatingExpanded,this.updateRating(),this.checkSentimentOnDesktop()}},{key:"toggleSentimentMore",value:function(t){t.preventDefault(),this.isSentimentExpanded=!this.isSentimentExpanded,this.updateSentiment()}},{key:"checkSentimentOnDesktop",value:function(){(0,n.X)("md").matches&&(this.isSentimentExpanded=this.isRatingExpanded,this.updateSentiment())}}])&&a(e.prototype,r),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),u}(i.xI);f=y,g=["rating","sentiment","showMoreRating","showMoreSentiment"],(m=p(m="targets"))in f?Object.defineProperty(f,m,{value:g,enumerable:!0,configurable:!0,writable:!0}):f[m]=g},2431:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,p(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=u();return function(){var r,i=h(t);if(e){var n=h(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(u=function(){return!!t})()}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function d(t,e,r){return(e=p(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>f});var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(u,t);var e,r,i,l=a(u);function u(){var t;n(this,u);for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return d(c(t=l.call.apply(l,[this].concat(r))),"initialValues",{}),d(c(t),"submitted",!1),t}return e=u,(r=[{key:"submit",value:function(){this.submitted=!0}},{key:"connect",value:function(){var t=this;window.addEventListener("beforeunload",(function(e){t.leavingPage(e)})),document.addEventListener("turbo:before-visit",(function(e){t.leavingPage(e)}));var e={CURRENT:[this.startYearTarget,this.currentYearTarget,this.countryTarget,this.uniEmailTarget],PROSPECTIVE:[this.countryTarget,this.plannedStartYearTarget],GRADUATE:[this.countryTarget],PARENT:[this.countryTarget,this.plannedStartYearTarget],OTHER:[this.countryTarget]},r={PARENT:"Student’s year of entry",PROSPECTIVE:"Student’s year of entry"},i=[this.startYearTarget,this.currentYearTarget,this.countryTarget,this.plannedStartYearTarget,this.uniEmailTarget];this.initialValues=this.getFormValues(),i.forEach((function(e){e.removeAttribute("required"),t.initialValues[e.getAttribute("name")]=e.value})),this.userTypeTarget.value&&e[this.userTypeTarget.value].forEach((function(e){e.parentElement.classList.remove("!tw-hidden"),"sc_account_user_profile_plannedStartYear"===e.getAttribute("id")&&(e.previousSibling.innerText=r[t.userTypeTarget.value]),e.setAttribute("required","required")})),this.userTypeTarget.addEventListener("change",(function(n){i.forEach((function(t){t.parentElement.classList.add("!tw-hidden"),t.removeAttribute("required")})),n.target.value&&e[n.target.value].forEach((function(e){e.parentElement.classList.remove("!tw-hidden"),"sc_account_user_profile_plannedStartYear"===e.getAttribute("id")&&(e.previousSibling.innerText=r[t.userTypeTarget.value]),e.setAttribute("required","required")}))}))}},{key:"validateEmail",value:function(t){var e=this,r=new URLSearchParams;r.append("validate_account_email",t.target.value),r.append("current_student_type",!0),fetch(window.sc.validateEmailCheckURL,{method:"POST",body:r,headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(t){return t.json()})).catch((function(t){return"AbortError"!==t.name&&console.error(t.message),[]})).then((function(t){t.length>0?(e.uniEmailTarget.classList.add("!tw-border-sc-dark-red"),e.uniEmailTarget.nextSibling.innerText=t[0].message,e.uniEmailTarget.nextSibling.classList.remove("tw-hidden")):(e.uniEmailTarget.classList.remove("!tw-border-sc-dark-red"),e.uniEmailTarget.nextSibling.classList.add("tw-hidden"))}))}},{key:"leavingPage",value:function(t){if(!this.submitted&&JSON.stringify(this.initialValues)!==JSON.stringify(this.getFormValues()))return"turbo:before-visit"!=t.type?(t.returnValue="Leave site? Changes you made may not be saved.",t.returnValue):void(window.confirm("Leave site? Changes you made may not be saved.")||t.preventDefault())}},{key:"getFormValues",value:function(){var t={};return this.element.querySelector("form").querySelectorAll("input, select").forEach((function(e){t[e.getAttribute("name")]=e.value})),t}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),u}(r(2891).xI);d(f,"targets",["userType","startYear","currentYear","country","plannedStartYear","uniEmail"])},1767:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>g});var i=r(2891),n=r(8020);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,m(i.key),i)}}function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}function u(t){var e=d();return function(){var r,i=p(t);if(e){var n=p(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return h(this,r)}}function h(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function f(t,e,r){return(e=m(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,t);var e,r,i,o=u(h);function h(){return a(this,h),o.apply(this,arguments)}return e=h,r=[{key:"connect",value:function(){this.showNextQuestion=this.showNextQuestion.bind(this),this.element.addEventListener("click",this.showNextQuestion)}},{key:"disconnect",value:function(){this.element.removeEventListener("click",this.showNextQuestion)}},{key:"initialize",value:function(){this.showUserAnswers()}},{key:"editAnswer",value:function(t){var e=t.target.parentElement.parentElement;this.startAnswerEdition(e)}},{key:"startAnswerEdition",value:function(t){var e=t.getAttribute("id"),r=this.questionsTarget.childNodes;t.dataset.enable="false",t.classList.add("tw-hidden"),r.forEach((function(t){t.classList.add("tw-hidden")}));for(var i=this.answersTarget.childNodes,n=Array.from(i).indexOf(t)+1;n<i.length;n++)["answer-subject","answer-parent-subject"].includes(i[n].id)||(i[n].dataset.enable="false",i[n].classList.add("tw-hidden"));var o=document.querySelector("[data-answer=".concat(e,"]"));null!=o&&o.parentNode.parentNode&&(document.getElementById("answers-collapsed").dataset.ready="false",o.parentNode.parentNode.classList.remove("tw-hidden"))}},{key:"editSubjectAnswer",value:function(){var t=event.target.parentElement.parentElement;t.dataset.enable="false",t.classList.add("tw-hidden"),this.hasParentSubjectInputTarget&&"answer-parent-subject"===t.id&&(t.nextElementSibling.dataset.enable="false",t.nextElementSibling.classList.add("tw-hidden"),this.parentSubjectInputTarget.closest(".form__item").classList.remove("tw-hidden")),this.subjectInputTarget.closest(".form__item").classList.remove("tw-hidden")}},{key:"showNextQuestion",value:function(t){var e=t.target,r=e.dataset.nextQuestion,i=e.dataset.answer,n=e.dataset.currentQuestion,o=e.dataset.answerText;if(document.getElementById(i)){var s=document.getElementById(i);if(s.dataset.enable="true",document.getElementById(i).classList.remove("tw-hidden"),this.hideAllQuestions(),s.dataset.replacement){var a=document.getElementById("one-line-answer");a.innerHTML=a.innerHTML.replace(s.dataset.replacement,s.dataset.answer)}var l={user_type:o},c="review_user_type";if("question-3"===n?(this.studentTypeInputTarget.value=o,l={user_location:o},c="review_user_location"):this.userTypeInputTarget.value=o,l&&o&&this.sendDataLayerUserTypeEvent(c,l),r)return void document.getElementById(r).classList.remove("tw-hidden");document.getElementById("answers-collapsed").dataset.ready="true"}}},{key:"hideAllQuestions",value:function(){this.nextQuestionTargets.forEach((function(t){t.classList.add("tw-hidden")}))}},{key:"showUserAnswers",value:function(){var t=document.querySelector("[data-group=questions]").childNodes,e=document.querySelector("[data-group=answers]").childNodes,r=this.studentTypeInputTarget.value,i=this.userTypeInputTarget.value;if(i&&("CURRENT"!==i||r)&&(t.forEach((function(t){t.classList.add("tw-hidden")})),e.forEach((function(t){["answer-subject","answer-parent-subject"].includes(t.id)||t.dataset.answer!==r&&t.dataset.answer!==i||t.classList.remove("tw-hidden")})),!r&&!["PARENT","OTHER"].includes(i))){var n=document.querySelector("div[data-group] div[data-answer=DOMESTIC]");this.startAnswerEdition(n)}}},{key:"cleanupInput",value:function(t){var e=t.params.cleanupInput;"userType"===e?this.userTypeInputTarget.value="":this.studentTypeInputTarget.value=""}},{key:"onSubjectSelected",value:function(){var t=document.getElementById("answer-subject"),e=t.querySelector("h4");t.classList.remove("tw-hidden"),t.dataset.text=this.subjectInputTarget.value,e.innerText=this.subjectInputTarget.value,this.subjectInputTarget.closest(".form__item").classList.add("tw-hidden")}},{key:"onParentSubjectSelected",value:function(){var t=document.getElementById("answer-parent-subject"),e=t.querySelector("h4");t.classList.remove("tw-hidden"),t.dataset.text=this.parentSubjectInputTarget.value,e.innerText=this.parentSubjectInputTarget.value,this.parentSubjectInputTarget.closest(".form__item").classList.add("tw-hidden")}},{key:"sendDataLayerUserTypeEvent",value:function(t,e){(0,n.U)(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){f(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({event:"user_event",event_name:"user_event",user_event_type:t,type:this.reviewFormTarget.dataset.scSubject,location:"review_something_flow"},e))}}],r&&l(e.prototype,r),i&&l(e,i),Object.defineProperty(e,"prototype",{writable:!1}),h}(i.xI);f(g,"targets",["nextQuestion","userTypeInput","studentTypeInput","answers","questions","subjectInput","parentSubjectInput","reviewForm"])},8058:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"toggle",value:function(t){this.ellipsisTarget.classList.toggle("tw-hidden"),this.textTarget.classList.toggle("tw-hidden");var e=this.textTarget.classList.contains("tw-hidden");this.readTarget.innerText=e?"more":"less"}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["ellipsis","text","read"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},347:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(){n=function(){return e};var t,e={},r=Object.prototype,o=r.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function d(t,e,r,i){var n=e&&e.prototype instanceof v?e:v,o=Object.create(n.prototype),a=new I(i||[]);return s(o,"_invoke",{value:k(t,r,a)}),o}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var f="suspendedStart",m="executing",g="completed",y={};function v(){}function _(){}function b(){}var x={};h(x,l,(function(){return this}));var w=Object.getPrototypeOf,T=w&&w(w(O([])));T&&T!==r&&o.call(T,l)&&(x=T);var E=b.prototype=v.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,s,a,l){var c=p(t[n],t,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==i(h)&&o.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,l)}),(function(t){r("throw",t,a,l)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,l)}))}l(c.arg)}var n;s(this,"_invoke",{value:function(t,i){function o(){return new e((function(e,n){r(t,i,e,n)}))}return n=n?n.then(o,o):o()}})}function k(e,r,i){var n=f;return function(o,s){if(n===m)throw Error("Generator is already running");if(n===g){if("throw"===o)throw s;return{value:t,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var l=A(a,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===f)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=m;var c=p(e,r,i);if("normal"===c.type){if(n=i.done?g:"suspendedYield",c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n=g,i.method="throw",i.arg=c.arg)}}}function A(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=p(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function r(){for(;++n<e.length;)if(o.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,s(E,"constructor",{value:b,configurable:!0}),s(b,"constructor",{value:_,configurable:!0}),_.displayName=h(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,h(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(P.prototype),h(P.prototype,c,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new P(d(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),h(E,u,"Generator"),h(E,l,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(i,n){return a.type="throw",a.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=o.call(s,"catchLoc"),c=o.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var n=i;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var s=n?n.completion:{};return s.type=t,s.arg=e,n?(this.method="next",this.next=n.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;C(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:O(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function o(t,e,r,i,n,o,s){try{var a=t[o](s),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(i,n)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,p(i.key),i)}}function l(t,e){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},l(t,e)}function c(t){var e=h();return function(){var r,i=d(t);if(e){var n=d(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return u(this,r)}}function u(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(h=function(){return!!t})()}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function p(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>y});var f,m,g,y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(h,t);var e,r,i,u=c(h);function h(){return s(this,h),u.apply(this,arguments)}return e=h,r=[{key:"validatePassword",value:function(t){var e=this.passwordTarget.value,r="blur"===t.type,i=/^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).{8,}$/.test(e);(r||e.length>=8)&&!i?(this.passwordTarget.setCustomValidity("Password must be 8+ characters with at least one digit, one uppercase and one lowercase letter."),this.passwordTarget.classList.add("tw-border-sc-dark-red"),this.passwordTarget.classList.remove("!tw-border-sc-mid-grey"),this.passwordTarget.reportValidity()):(this.passwordTarget.setCustomValidity(""),this.passwordTarget.classList.remove("tw-border-sc-dark-red"),this.passwordTarget.classList.add("!tw-border-sc-mid-grey"))}},{key:"togglePasswordVisibility",value:function(){var t=this.passwordTarget,e="text"===t.type;t.type=e?"password":"text"}},{key:"submit",value:function(t){var e=this;t.preventDefault(),t.stopPropagation();var r=t.target,i=r.action,s=new FormData(r);fetch(i,{method:"POST",body:s,headers:{"X-Requested-With":"XMLHttpRequest"}}).then(function(){var t,r=(t=n().mark((function t(r){var i,o,s;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=r.headers.get("content-type")||"",!r.ok||!i.includes("application/json")){t.next=10;break}return t.next=4,r.json();case 4:if(!(o=t.sent).redirect){t.next=8;break}return window.location.href=o.redirect,t.abrupt("return");case 8:return window.location.reload(),t.abrupt("return");case 10:return t.next=12,r.text();case 12:s=t.sent,e.element.innerHTML=s;case 14:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(i,n){var s=t.apply(e,r);function a(t){o(s,i,n,a,l,"next",t)}function l(t){o(s,i,n,a,l,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}()).catch((function(t){console.error("error to try send form:",t)}))}}],r&&a(e.prototype,r),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),h}(r(2891).xI);f=y,g=["password"],(m=p(m="targets"))in f?Object.defineProperty(f,m,{value:g,enumerable:!0,configurable:!0,writable:!0}):f[m]=g},5363:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"connect",value:function(){this.handleTenancy(this.getChecked(this.tenancyTargets))}},{key:"handleTenancy",value:function(t){var e=t.getAttribute("data-room-details"),r=JSON.parse(e);this.roomDetailsSummaryTargets.forEach((function(t){return t.innerHTML="".concat(r.length,"  |  ").concat(r.moveIn," | ").concat(r.price)})),this.incentiveTextTargets.forEach((function(t){return t.innerHTML=r.incentive})),null===r.incentive?this.tooltipTargets.forEach((function(t){return t.classList.add("tw-hidden")})):this.tooltipTargets.forEach((function(t){return t.classList.remove("tw-hidden")}))}},{key:"handleChangeTenancy",value:function(t){this.handleTenancy(t.currentTarget)}},{key:"getChecked",value:function(t){return t.find((function(t){return t.checked}))}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["roomDetailsSummary","incentiveText","tenancy","tooltip"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},9665:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>w});var i=r(2891),n=r(8020),o=r(1660),s=r.n(o);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(){l=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function d(t,e,r,i){var o=e&&e.prototype instanceof v?e:v,s=Object.create(o.prototype),a=new I(i||[]);return n(s,"_invoke",{value:k(t,r,a)}),s}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var f="suspendedStart",m="executing",g="completed",y={};function v(){}function _(){}function b(){}var x={};h(x,s,(function(){return this}));var w=Object.getPrototypeOf,T=w&&w(w(O([])));T&&T!==r&&i.call(T,s)&&(x=T);var E=b.prototype=v.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,o,s,l){var c=p(t[n],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==a(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,s,l)}),(function(t){r("throw",t,s,l)})):e.resolve(h).then((function(t){u.value=t,s(u)}),(function(t){return r("throw",t,s,l)}))}l(c.arg)}var o;n(this,"_invoke",{value:function(t,i){function n(){return new e((function(e,n){r(t,i,e,n)}))}return o=o?o.then(n,n):n()}})}function k(e,r,i){var n=f;return function(o,s){if(n===m)throw Error("Generator is already running");if(n===g){if("throw"===o)throw s;return{value:t,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var l=A(a,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===f)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=m;var c=p(e,r,i);if("normal"===c.type){if(n=i.done?g:"suspendedYield",c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n=g,i.method="throw",i.arg=c.arg)}}}function A(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=p(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(a(e)+" is not iterable")}return _.prototype=b,n(E,"constructor",{value:b,configurable:!0}),n(b,"constructor",{value:_,configurable:!0}),_.displayName=h(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,h(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(P.prototype),h(P.prototype,c,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new P(d(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),h(E,u,"Generator"),h(E,s,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return a.type="throw",a.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;C(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:O(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function c(t,e,r,i,n,o,s){try{var a=t[o](s),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(i,n)}function u(t){return function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function s(t){c(o,i,n,s,a,"next",t)}function a(t){c(o,i,n,s,a,"throw",t)}s(void 0)}))}}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,b(i.key),i)}}function p(t,e){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},p(t,e)}function f(t){var e=y();return function(){var r,i=v(t);if(e){var n=v(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return m(this,r)}}function m(t,e){if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return g(t)}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(y=function(){return!!t})()}function v(t){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},v(t)}function _(t,e,r){return(e=b(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b(t){var e=function(t,e){if("object"!=a(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=a(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==a(e)?e:e+""}var x={event_name:"user_event",location:"reservation_user_details_validation"},w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}(m,t);var e,r,i,o,a,c=f(m);function m(){var t;h(this,m);for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return _(g(t=c.call.apply(c,[this].concat(r))),"timer",0),_(g(t),"validatedEmail",!1),t}return e=m,r=[{key:"checkEmail",value:function(){var t=this.emailInputTarget.value;return/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(t)?(this.emailRequiredFieldTarget.classList.add("tw-hidden"),this.emailInputTarget.classList.remove("!tw-border-sc-yellow"),this.sendEmailButtonTarget.disabled=!1,this.sendEmailButtonTarget.setAttribute("aria-enabled","true"),(0,n.U)(x,{position:"email",user_event_type:"check_email"}),t):(this.emailRequiredFieldTarget.classList.remove("tw-hidden"),this.emailInputTarget.classList.add("!tw-border-sc-yellow"),this.sendEmailButtonTarget.disabled=!0,this.sendEmailButtonTarget.setAttribute("aria-enabled","false"),null)}},{key:"sendEmailPinCode",value:function(){var t=this;if(0===this.timer){if(!this.checkEmail())return null;this.emailRequiredFieldTarget.classList.add("tw-hidden"),this.emailInputTarget.classList.remove("!tw-border-sc-yellow"),this.sendEmailButtonTarget.innerText+="...",this.tryAgainLoadingTarget.classList.remove("tw-hidden"),this.tryAgainLoadingTarget.innerText="Sending...",(0,n.U)(x,{position:"email",user_event_type:"send_email_pin_code"});var e=new URLSearchParams;e.append("value",this.emailInputTarget.value),e.append("type","email"),fetch(this.sendPinCodeUrlValue,{method:"POST",body:e,headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){t.sendEmailButtonTarget.innerText.replace("...",""),200===e.status?(t.pinCodeAreaTarget.classList.remove("tw-hidden"),t.sendEmailButtonTarget.classList.add("tw-hidden"),t.sendEmailButtonTarget.classList.remove("tw-opacity-70"),t.emailInputTarget.classList.remove("invalid"),t.tryAgainLoadingTarget.classList.add("tw-hidden"),t.sendEmailButtonTarget.classList.add("!tw-hidden"),t.validatedEmail=t.emailInputTarget.value,t.startTimer(),t.pinInputTargets[0].focus(),t.pinInputTargets[0].scrollIntoView({behavior:"smooth",block:"center"})):(t.tryAgainLoadingTarget.classList.add("tw-hidden"),t.tryAgainTimeTarget.classList.add("tw-hidden"),t.sendEmailButtonTarget.disabled=!1)}))}}},{key:"isValidPhoneNumber",value:function(t){return/^\+[1-9]\d{7,14}$/.test(t)}},{key:"phoneInputHandler",value:function(){var t="+".concat(this.phoneInputTarget.value.replace(/\D/g,""));this.validatePhoneNumber(t),(0,n.U)(x,{position:"phone",user_event_type:"check_phone"})}},{key:"handleCountryPhoneInputChange",value:function(){new(s())("".concat(this._getCountryPhoneCode()," 9{1,14}")).mask(this.phoneInputTarget),this.phoneInputTarget.focus()}},{key:"_getCountryPhoneCode",value:function(){var t,e;return null===(t=this.countryPhoneInputTarget)||void 0===t||null===(e=t.selectedOptions[0])||void 0===e?void 0:e.getAttribute("data-country-code")}},{key:"validatePhoneNumber",value:function(t){return this.countryPhoneInputTarget.classList.remove("!tw-border-sc-yellow"),!1===this.isValidPhoneNumber(t)?(this.phoneInputTarget.classList.add("!tw-border-sc-yellow"),this.sendPhoneButtonTarget.setAttribute("aria-enabled","false"),this.sendPhoneButtonTarget.disabled=!0,this.phoneRequiredFieldTarget.classList.remove("tw-hidden"),!1):(this.phoneRequiredFieldTarget.classList.add("tw-hidden"),this.phoneInputTarget.classList.remove("!tw-border-sc-yellow"),this.sendPhoneButtonTarget.disabled=!1,this.sendPhoneButtonTarget.setAttribute("aria-enabled","true"),!0)}},{key:"sendPhonePinCode",value:function(){var t=this;if(0===this.timer){var e="+".concat(this.phoneInputTarget.value.replace(/\D/g,""));if(!1===this.validatePhoneNumber(e))return null;this.phoneRequiredFieldTarget.classList.add("tw-hidden"),this.phoneInputTarget.classList.remove("!tw-border-sc-yellow"),this.sendPhoneButtonTarget.classList.add("tw-opacity-70"),this.sendPhoneButtonTarget.disabled=!0,this.sendPhoneButtonTarget.innerText+="...",this.tryAgainLoadingTarget.classList.remove("tw-hidden"),this.tryAgainLoadingTarget.innerText="Sending...",(0,n.U)(x,{position:"phone",user_event_type:"send_phone_pin_code"});var r=new URLSearchParams;r.append("value",e),r.append("type","phone"),fetch(this.sendPinCodeUrlValue,{method:"POST",body:r,headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){t.sendPhoneButtonTarget.innerText.replace("...",""),200===e.status?(t.pinCodeAreaTarget.classList.remove("tw-hidden"),t.sendPhoneButtonTarget.classList.add("tw-hidden"),t.sendPhoneButtonTarget.classList.remove("tw-opacity-70"),t.sendPhoneButtonTarget.classList.add("!tw-hidden"),t.phoneInputTarget.classList.remove("invalid"),t.tryAgainLoadingTarget.classList.add("tw-hidden"),t.pinTypeTextTarget.innerText="phone",t.startTimer(),t.pinInputTargets[0].focus(),t.pinInputTargets[0].scrollIntoView({behavior:"smooth",block:"center"})):(t.tryAgainLoadingTarget.classList.add("tw-hidden"),t.tryAgainTimeTarget.classList.add("tw-hidden"),t.sendPhoneButtonTarget.classList.remove("tw-opacity-70"),t.sendPhoneButtonTarget.disabled=!1)}))}}},{key:"resendPinCode",value:function(){"email"===this.getValidatorType()?this.sendEmailPinCode():this.sendPhonePinCode()}},{key:"getValidatorType",value:function(){return null!==this.emailInputTarget.offsetParent?"email":"phone"}},{key:"inputPinHandler",value:(a=u(l().mark((function t(e){var r,i,n;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.target.value.replace(/\D/g,""),e.target.value=r.charAt(0),r?e.target.classList.add("!tw-bg-gray-100"):e.target.classList.remove("!tw-bg-gray-100"),!(""===e.target.value&&e.target.dataset.position>1)){t.next=6;break}return this.pinInputTargets[e.target.dataset.position-2].focus(),t.abrupt("return");case 6:if(r&&e.target.dataset.position<4&&this.pinInputTargets[e.target.dataset.position].focus(),0!==this.pinInputTargets.filter((function(t){return""===t.value})).length){t.next=13;break}return i=this.pinInputTargets.map((function(t){return t.value})),n=this.getValidatorType(),t.next=13,this.checkCode(i.join(""),n);case 13:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"checkCode",value:(o=u(l().mark((function t(e,r){var i,o,s,a=this;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=new URLSearchParams,o=this["".concat(r,"InputTarget")],s=o.value,"phone"===r&&(s="+".concat(s.replace(/\D/g,""))),i.append("type",r),i.append("value",s),i.append("code",e),this.tryAgainLoadingTarget.classList.remove("tw-hidden"),this.tryAgainLoadingTarget.innerText="Validating...",(0,n.U)(x,{position:r,user_event_type:"check_pin_code"}),t.abrupt("return",fetch(this.verifyPinCodeUrlValue,{method:"POST",body:i,headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(t){400===t.status?(a.pinInputTargets.map((function(t){return t.classList.add("!tw-border-red-400")})),a.tryAgainLoadingTarget.classList.add("tw-hidden")):(a.pinInputTargets.forEach((function(t){t.blur(),t.classList.remove("!tw-border-red-400","!tw-bg-gray-100"),t.value=""})),a.pinCodeAreaTarget.classList.add("tw-hidden"),a.timer=0,"email"===r?(a.emailContainerTarget.classList.add("tw-hidden"),a.emailInputTarget.readonly=!0,a.phoneContainerTarget.classList.remove("tw-hidden"),a.emailValidatedIconTargets.forEach((function(t){return t.setAttribute("aria-enabled","true")}))):(a.phoneContainerTarget.classList.add("tw-hidden"),a.phoneInputTarget.readonly=!0,a.termsContainerTarget.classList.remove("tw-hidden"),a.phoneValidatedIconTargets.forEach((function(t){return t.setAttribute("aria-enabled","true")}))))})).catch((function(t){return"AbortError"!==t.name&&console.error({error:t}),[]})));case 11:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})},{key:"handleChangeTerms",value:function(t){(0,n.U)(x,{position:"terms",user_event_type:"change_terms"}),t.target.checked?this.btnSubmitTargets.forEach((function(t){t.disabled=!1,t.setAttribute("aria-enabled","true")})):this.btnSubmitTargets.forEach((function(t){t.disabled=!0,t.setAttribute("aria-enabled","false")}))}},{key:"handleSubmit",value:function(t){t.preventDefault(),this.btnSubmitTargets.forEach((function(t){t.disabled=!0,t.setAttribute("aria-enabled","false")})),this.clearPhoneInputMask(),this.formTarget.submit()}},{key:"clearPhoneInputMask",value:function(){var t,e="+".concat(this.phoneInputTarget.value.replace(/\D/g,""));null===(t=this.phoneInputTarget.inputmask)||void 0===t||t.remove(),this.phoneInputTarget.value=e}},{key:"startTimer",value:function(){var t=this;this.timer=60;var e=setInterval((function(){t.timer--,t.tryAgainTimeTarget.innerText="in "+t.timer+" seconds",t.timer<=0&&(t.timer=0,t.tryAgainTimeTarget.innerText="",clearInterval(e))}),1e3)}}],r&&d(e.prototype,r),i&&d(e,i),Object.defineProperty(e,"prototype",{writable:!1}),m}(i.xI);_(w,"targets",["form","emailInput","emailContainer","emailRequiredField","sendEmailButton","btnSubmit","phoneContainer","phoneInput","countryPhoneInput","phoneRequiredField","sendPhoneButton","termsContainer","termsInput","pinInput","pinTypeText","pinCodeArea","tryAgainTime","tryAgainLoading","emailValidatedIcon","phoneValidatedIcon"]),_(w,"values",{sendPinCodeUrl:String,verifyPinCodeUrl:String})},255:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>b});var i=r(2891),n=r(1660),o=r.n(n);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,f(i.key),i)}}function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}function u(t){var e=d();return function(){var r,i=p(t);if(e){var n=p(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return h(this,r)}}function h(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function f(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}var m,g,y,v=[{value:"",text:""},{value:"FIRST",text:"First Year"},{value:"SECOND",text:"Second Year"},{value:"THIRD",text:"Third Year"},{value:"FOURTH",text:"Fourth Year"},{value:"FIFTH",text:"Fifth Year"},{value:"PLACEMENT",text:"Placement Year"},{value:"MASTER",text:"Master"},{value:"PHD",text:"PHD"},{value:"OTHER",text:"Other"}],_=[{value:"",text:""},{value:"FIRST",text:"First Year"},{value:"MASTER",text:"Master"},{value:"PHD",text:"PHD"},{value:"OTHER",text:"Other"}],b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(s,t);var e,r,i,n=u(s);function s(){return a(this,s),n.apply(this,arguments)}return e=s,r=[{key:"connect",value:function(){var t=this;if(this.formSubmitted=!1,this.element.querySelectorAll("[required]").forEach((function(e){e.addEventListener("input",(function(){return t.handleInputChange()})),e.addEventListener("change",(function(){return t.handleInputChange()}))})),"undefined"!=typeof google)this.initAddressAutocomplete();else var e=setInterval((function(){"undefined"!=typeof google&&(clearInterval(e),t.initAddressAutocomplete())}),300)}},{key:"userTypeTargetConnected",value:function(){var t=this;this.handleUserType(this.getCheckedValue(this.userTypeTarget)),this.getRadioInputs(this.userTypeTarget).forEach((function(e){e.addEventListener("change",(function(){return t.handleUserType(e.value)}))}))}},{key:"genderTargetConnected",value:function(){var t=this;this.handleGender(this.getCheckedValue(this.genderTarget)),this.getRadioInputs(this.genderTarget).forEach((function(e){e.addEventListener("change",(function(){return t.handleGender(e.value)}))}))}},{key:"birthDateTargetConnected",value:function(){this.applyBirthDateMask()}},{key:"handleInputChange",value:function(){this.formSubmitted&&this.checkRequiredFields()}},{key:"initAddressAutocomplete",value:function(){var t=this;navigator.geolocation.getCurrentPosition((function(e){var r,i={lat:e.coords.latitude,lng:e.coords.longitude};void 0!==(null===(r=google.maps)||void 0===r?void 0:r.places)&&new google.maps.places.Autocomplete(t.addressTarget,{types:["address"],bounds:new google.maps.LatLngBounds(i),locationBias:new google.maps.LatLng(i)})}),(function(){new google.maps.places.Autocomplete(t.addressTarget,{types:["address"]})}),{timeout:5e3})}},{key:"checkRequiredFields",value:function(){var t=Array.from(this.element.querySelectorAll("[required]")).filter((function(t){return null!==t.offsetParent&&"radio"!==t.type}));this.genderTarget.ariaRequired=void 0===this.getCheckedValue(this.genderTarget),this.userTypeTarget.ariaRequired=void 0===this.getCheckedValue(this.userTypeTarget),t.forEach((function(t){t.ariaRequired=!t.checkValidity()}));var e=this.element.querySelectorAll('[aria-required="true"]');return this.stepButtonTargets.forEach((function(t){t.disabled=e.length>0,0===e.length?t.setAttribute("aria-enabled","true"):t.setAttribute("aria-enabled","false")})),e}},{key:"applyBirthDateMask",value:function(){var t=this;this.hasBirthDateTarget&&new(o())("99/99/9999",{placeholder:"DD/MM/YYYY",postValidation:function(e,r,i,n){t.birthDateTarget.classList.add("!tw-border-sc-yellow");var o=e.join("").replace(/\D/g,""),s=o.length;if(!(s>=2))return!0;var a=parseInt(o.slice(0,2),10);if(a<1||a>31)return!1;if(!(s>=4))return!0;var l,c=parseInt(o.slice(2,4),10);if(c<1||c>12)return!1;if(s>=8){var u=parseInt(o.slice(2,4),10),h=parseInt(o.slice(0,2),10),d=parseInt(o.slice(4,8),10),p=(new Date).getFullYear();if(d<p-100||d>p-10)return!1;if(h>[31,(l=d,l%4==0&&l%100!=0||l%400==0?29:28),31,30,31,30,31,31,30,31,30,31][u-1])return!1}return t.birthDateTarget.classList.remove("!tw-border-sc-yellow"),!0}}).mask(this.birthDateTarget)}},{key:"handleChangeUserType",value:function(t){var e=t.currentTarget.value;this.handleUserType(e)}},{key:"handleUserType",value:function(t){var e=this.getSelectedValue(this.currentYearTarget);switch(t){case"CURRENT":this.startYearTarget.classList.remove("tw-hidden"),this.plannedStartYearTarget.classList.add("tw-hidden"),this.populateCurrentYearOptions(v,e);break;case"PROSPECTIVE":this.startYearTarget.classList.add("tw-hidden"),this.plannedStartYearTarget.classList.remove("tw-hidden"),this.populateCurrentYearOptions(_,e)}}},{key:"populateCurrentYearOptions",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.currentYearTarget.innerHTML="",t.forEach((function(t){var i=document.createElement("option");i.value=t.value,i.textContent=t.text,t.value===r&&(i.selected=!0,i.disabled=!0),e.currentYearTarget.appendChild(i)}))}},{key:"handleChangeGender",value:function(t){var e=t.currentTarget.value;this.handleGender(e)}},{key:"handleGender",value:function(t){"other"===t?this.otherGenderTarget.classList.remove("tw-hidden"):this.otherGenderTarget.classList.add("tw-hidden")}},{key:"handleSubmit",value:function(){this.formSubmitted=!0;var t=this.checkRequiredFields();t.length>0?t[0].scrollIntoView({behavior:"smooth"}):this.element.submit()}},{key:"getCheckedValue",value:function(t){var e=t.querySelector('input[type="radio"]:checked');return null==e?void 0:e.value}},{key:"getSelectedValue",value:function(t){var e=t.querySelector("option:checked");return null==e?void 0:e.value}},{key:"getRadioInputs",value:function(t){return t.querySelectorAll('input[type="radio"]')}}],r&&l(e.prototype,r),i&&l(e,i),Object.defineProperty(e,"prototype",{writable:!1}),s}(i.xI);m=b,y=["userType","startYear","plannedStartYear","currentYear","birthDate","gender","otherGender","stepButton","address"],(g=f(g="targets"))in m?Object.defineProperty(m,g,{value:y,enumerable:!0,configurable:!0,writable:!0}):m[g]=y},2594:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>y});var i=r(2891),n=r(8020);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,p(i.key),i)}}function l(t,e){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},l(t,e)}function c(t){var e=h();return function(){var r,i=d(t);if(e){var n=d(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return u(this,r)}}function u(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(h=function(){return!!t})()}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function p(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var f,m,g,y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(u,t);var e,r,i,o=c(u);function u(){return s(this,u),o.apply(this,arguments)}return e=u,(r=[{key:"connect",value:function(){this.hasTracked=!1,this.initIntersectionObserver()}},{key:"disconnect",value:function(){this.observer&&this.observer.disconnect()}},{key:"initIntersectionObserver",value:function(){var t=this;this.observer=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&!t.hasTracked&&(t.hasTracked=!0,t.trackChipImpression(),t.observer.unobserve(e.target))}))}),{root:null,rootMargin:"0px",threshold:.3}),this.waitForChipContainer()}},{key:"waitForChipContainer",value:function(){var t=this,e=0;!function r(){e++;var i=document.querySelector('[data-controller*="review-aspects"]');i?t.observer.observe(i):e<50&&setTimeout(r,100)}()}},{key:"trackChipImpression",value:function(){if(this.hasIndexIdValue){var t={event:"user_event",event_name:"user_event",user_event_type:"review_chip_impression",location:"hall",index_id:this.indexIdValue};(0,n.U)(t)}}}])&&a(e.prototype,r),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),u}(i.xI);f=y,m="values",g={indexId:String},(m=p(m))in f?Object.defineProperty(f,m,{value:g,enumerable:!0,configurable:!0,writable:!0}):f[m]=g},4316:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>m});var i=r(2891),n=r(8020);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,f(i.key),i)}}function l(t,e){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},l(t,e)}function c(t){var e=h();return function(){var r,i=d(t);if(e){var n=d(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return u(this,r)}}function u(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(h=function(){return!!t})()}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function p(t,e,r){return(e=f(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(u,t);var e,r,i,o=c(u);function u(){return s(this,u),o.apply(this,arguments)}return e=u,(r=[{key:"toggle",value:function(t){var e,r,i=t.currentTarget,o=i.closest("label"),s=null===(e=o.querySelector(".chip-label"))||void 0===e||null===(r=e.textContent)||void 0===r?void 0:r.trim();s&&this.hasIndexIdValue&&(0,n.U)({event:"user_event",event_name:"user_event",user_event_type:"review_chip_click",location:s,index_id:this.indexIdValue}),i.checked?(o.setAttribute("data-checked",!0),i.setAttribute("data-checked",!0),i.style.backgroundImage="url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTQgNEwxMiAxMk0xMiA0TDQgMTIiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+Cjwvc3ZnPg==')"):(o.setAttribute("data-checked",!1),i.setAttribute("data-checked",!1),i.style.backgroundImage="");var a=this.chipTargets.filter((function(t){return t.checked})).map((function(t){return t.dataset.aspectId}));this.filterReviews(a)}},{key:"filterReviews",value:function(t){var e=document.getElementById("turbo-reviews");if(e){var r=new URL(e.src||window.location.href);t.length>0?r.searchParams.set("aspects",t.join(",")):r.searchParams.delete("aspects"),r.searchParams.delete("page"),e.src=r.toString()}}}])&&a(e.prototype,r),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),u}(i.xI);p(m,"targets",["chip"]),p(m,"values",{indexId:String})},2412:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(){n=function(){return e};var t,e={},r=Object.prototype,o=r.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function d(t,e,r,i){var n=e&&e.prototype instanceof v?e:v,o=Object.create(n.prototype),a=new I(i||[]);return s(o,"_invoke",{value:k(t,r,a)}),o}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var f="suspendedStart",m="executing",g="completed",y={};function v(){}function _(){}function b(){}var x={};h(x,l,(function(){return this}));var w=Object.getPrototypeOf,T=w&&w(w(O([])));T&&T!==r&&o.call(T,l)&&(x=T);var E=b.prototype=v.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,s,a,l){var c=p(t[n],t,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==i(h)&&o.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,l)}),(function(t){r("throw",t,a,l)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,l)}))}l(c.arg)}var n;s(this,"_invoke",{value:function(t,i){function o(){return new e((function(e,n){r(t,i,e,n)}))}return n=n?n.then(o,o):o()}})}function k(e,r,i){var n=f;return function(o,s){if(n===m)throw Error("Generator is already running");if(n===g){if("throw"===o)throw s;return{value:t,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var l=A(a,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===f)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=m;var c=p(e,r,i);if("normal"===c.type){if(n=i.done?g:"suspendedYield",c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n=g,i.method="throw",i.arg=c.arg)}}}function A(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=p(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function r(){for(;++n<e.length;)if(o.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,s(E,"constructor",{value:b,configurable:!0}),s(b,"constructor",{value:_,configurable:!0}),_.displayName=h(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,h(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(P.prototype),h(P.prototype,c,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new P(d(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),h(E,u,"Generator"),h(E,l,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(i,n){return a.type="throw",a.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=o.call(s,"catchLoc"),c=o.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var n=i;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var s=n?n.completion:{};return s.type=t,s.arg=e,n?(this.method="next",this.next=n.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;C(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:O(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function o(t,e,r,i,n,o,s){try{var a=t[o](s),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(i,n)}function s(t){return function(){var e=this,r=arguments;return new Promise((function(i,n){var s=t.apply(e,r);function a(t){o(s,i,n,a,l,"next",t)}function l(t){o(s,i,n,a,l,"throw",t)}a(void 0)}))}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,f(i.key),i)}}function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}function u(t){var e=d();return function(){var r,i=p(t);if(e){var n=p(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return h(this,r)}}function h(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function f(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>v});var m,g,y,v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(p,t);var e,r,i,o,h,d=u(p);function p(){return a(this,p),d.apply(this,arguments)}return e=p,r=[{key:"emailInput",value:(h=s(n().mark((function t(e){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.isEmailAvailable(e.target.value);case 2:t.sent?e.target.classList.remove("unavailable"):e.target.classList.add("unavailable"),this.updateFormValidity();case 5:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"passwordInput",value:function(t){this.updateFormValidity()}},{key:"isEmailAvailable",value:(o=s(n().mark((function t(e){var r,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("/review-something/check-email-availability?"+new URLSearchParams({email:e}).toString());case 3:return r=t.sent,t.next=6,r.text();case 6:return i=t.sent,t.abrupt("return","available"===i);case 10:t.prev=10,t.t0=t.catch(0);case 12:return t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t,null,[[0,10]])}))),function(t){return o.apply(this,arguments)})},{key:"isFormValid",value:function(){var t=!0;return this.hasEmailTarget&&(t=(t=t&&!this.emailTarget.classList.contains("unavailable"))&&this.emailTarget.checkValidity()),this.hasPasswordTarget&&(t=t&&this.passwordTarget.checkValidity()),t}},{key:"updateFormValidity",value:function(){var t=this.isFormValid();this.submitTarget.disabled=!t}}],r&&l(e.prototype,r),i&&l(e,i),Object.defineProperty(e,"prototype",{writable:!1}),p}(r(2891).xI);m=v,y=["email","password","submit"],(g=f(g="targets"))in m?Object.defineProperty(m,g,{value:y,enumerable:!0,configurable:!0,writable:!0}):m[g]=y},4098:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"initialize",value:function(){this.staticHeaderText="#location# #user# review for #subject#",this.boundCollapseHeader=this.collapseHeader.bind(this)}},{key:"connect",value:function(){window.addEventListener("scroll",this.boundCollapseHeader)}},{key:"disconnect",value:function(){window.removeEventListener("scroll",this.boundCollapseHeader)}},{key:"collapseHeader",value:function(){var t=document.getElementById("answers-component"),e=t.classList,r=this.collapsedContainerTarget.classList,i=document.getElementById("subject-group"),n=i.querySelector(".subject-value");if("true"===this.collapsedContainerTarget.dataset.ready&&null!=n&&n.value){var o=t.querySelectorAll('div[data-enable="true"]'),s=this.getCollapsedCardText(o,n);this.collapsedTarget.innerHTML=s.replace(/#.*# /,""),this.shouldCollapse(t)&&this.collapse(e,i,r),this.shouldExpand()&&this.expand(e,i,r)}}},{key:"expand",value:function(t,e,r){t.remove("tw-animate-collapsed"),t.add("tw-animate-opened"),t.remove("tw-hidden"),e.classList.remove("tw-hidden"),e.classList.remove("tw-animate-collapsed"),r.add("tw-animate-collapsed"),r.remove("tw-animate-opened"),r.add("tw-hidden")}},{key:"collapse",value:function(t,e,r){t.remove("tw-animate-opened"),t.add("tw-animate-collapsed"),t.add("tw-hidden"),e.classList.add("tw-hidden"),e.classList.add("tw-animate-collapsed"),r.add("tw-animate-opened"),r.remove("tw-animate-collapsed"),r.remove("tw-hidden")}},{key:"shouldExpand",value:function(){return window.innerWidth>1024||this.collapsedContainerTarget.getBoundingClientRect().y>80}},{key:"shouldCollapse",value:function(t){return window.innerWidth<1024&&t.getBoundingClientRect().y<80}},{key:"getCollapsedCardText",value:function(t,e){var r=this,i=this.staticHeaderText;return t.forEach((function(t){if(t.dataset.replacement){var e="#location#"===t.dataset.replacement?r.determineArticle(t.dataset.text):t.dataset.text;i=i.replace(t.dataset.replacement,e)}})),i.replace("#subject#",e.value)}},{key:"determineArticle",value:function(t){var e=t.toLowerCase();return["uk"].some((function(t){return e.startsWith(t)}))?"A ".concat(t):["a","e","i","o","u"].some((function(t){return e.startsWith(t)}))?"An ".concat(t):"A ".concat(t)}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["collapsedContainer","collapsed"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},3308:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>D});var i=r(2891),n=r(4692),o=r.n(n);r(624),r(4945);const s=JSON.parse('{"v":"5.7.4","fr":29.9700012207031,"ip":0,"op":30.0000012219251,"w":1125,"h":207,"nm":"컴포지션 3","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":1,"nm":"star03","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[562.5,103.5,0],"ix":2,"l":2},"a":{"a":0,"k":[562.5,103.5,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"hasMask":true,"masksProperties":[{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":1,"s":[{"i":[[4.481,3.186],[2.839,-1.828],[2.762,-0.428],[2.931,-0.729],[1.735,0.222],[1.066,0.551],[2.198,-0.361],[1.3,-2.893],[-1.551,-3.396],[-0.895,-6.771],[-2.372,0.975],[-3.969,-1.237],[-1.219,0.035],[-2.415,1.214],[-4.532,0.822],[-2.2,2.975],[-1.032,6.744]],"o":[[-3.163,1.503],[-2.062,-0.272],[-0.691,4.041],[-2.348,0.584],[-0.352,-0.045],[-1.776,-0.918],[-2.625,3.362],[-0.743,1.652],[5.676,1.991],[5.057,0.687],[7.873,-3.235],[-0.518,-0.161],[3.186,-0.092],[-2.778,-5.123],[3.005,-0.545],[-3.932,-6.553],[-9.59,1.923]],"v":[[558,91],[553,100],[550,96],[542,100],[538,102],[535,99],[530,98],[529,107],[522,114],[533,126],[541,120],[549,126],[553,124],[558,125],[564,116],[573,116],[574,98]],"c":true}],"h":1},{"t":2,"s":[{"i":[[-3.636,-0.131],[-1.27,1.576],[2.44,1.501],[0.66,1.27],[1.074,0.13],[1.765,-1.41],[1.81,1.626],[7.124,1.047],[2.151,-1.153],[1.278,-2.912],[-0.769,-4.497],[-1.129,-6.537],[-3.469,1.413],[-1.724,4.07],[0.091,0.157],[0.05,1.986],[-2.489,0.562]],"o":[[-0.639,-3.194],[1.27,-1.576],[-1.284,-0.791],[-0.66,-1.27],[-0.13,-0.016],[-1.765,1.41],[3.28,5.936],[-3.486,-0.512],[-2.609,3.375],[-1.36,3.1],[5.841,1.826],[3.835,-1.34],[3.887,-1.583],[-0.208,0.492],[-0.893,-1.534],[-0.064,-2.58],[2.239,-0.506]],"v":[[526,117],[528.351,110.231],[528,106],[525.343,102.505],[523,100],[519.76,103.208],[514,104],[509,112],[501,108],[500,117],[493,124],[504,136],[513,130],[521,127],[519,124],[517,120],[520,114]],"c":true}],"h":1},{"t":3,"s":[{"i":[[0.367,0.005],[0.472,-0.447],[0.51,-0.221],[0.722,-0.28],[-0.943,-1.991],[0.156,-1.221],[-2.624,0],[-1.209,-0.619],[-1.041,0.476],[0.098,1.143],[-0.139,0.314],[-0.902,0.089],[0.251,2.187],[1.053,0.783],[0.808,1.026],[-0.066,0.39],[0.106,0.238]],"o":[[-0.601,-0.007],[-0.472,0.447],[-2.053,0.889],[-0.723,0.28],[1.001,2.114],[-0.156,1.221],[2.123,0],[1.209,0.619],[0.253,-0.116],[-0.098,-1.143],[0.643,-1.456],[0.902,-0.089],[0.018,0.158],[-1.053,-0.783],[-0.158,-0.201],[0.066,-0.39],[-0.71,-1.583]],"v":[[502,104],[500.432,104.829],[499,106],[494.753,107.173],[495,110],[495.284,115.086],[498,117],[502.811,118.357],[506,119],[506.086,116.648],[506,114],[508.67,112.548],[510,110],[508.119,108.888],[505,106],[504.962,105.028],[505,104]],"c":true}],"h":1},{"t":4,"s":[{"i":[[-1.381,1.236],[-0.655,0.896],[-0.717,0.641],[0.187,1.311],[0.735,0.158],[0.944,1.567],[0.127,0.59],[0.286,0.299],[0.521,-0.703],[0.075,-0.066],[1.456,-0.02],[-1.255,-2.65],[0.186,-1.398],[-0.196,-0.25],[-0.874,0.455],[-0.977,-0.147],[-0.45,-0.991]],"o":[[-0.372,-2.078],[0.655,-0.896],[0.717,-0.641],[-0.115,-0.801],[-0.735,-0.158],[-0.204,-0.34],[-0.127,-0.59],[-0.842,-0.879],[-0.521,0.703],[-1.43,1.27],[-1.456,0.02],[0.549,1.16],[-0.186,1.398],[0.528,0.673],[0.874,-0.455],[1.817,0.273],[0.45,0.99]],"v":[[490,121],[490.666,116.77],[492.964,114.696],[494,112],[492.622,111.075],[490,109],[489.562,107.469],[489,106],[486.924,106.291],[486,108],[480.986,108.965],[480,112],[480.265,116.182],[480,119],[482.163,118.895],[485,118],[487.827,120.632]],"c":true}],"h":1},{"t":5,"s":[{"i":[[0.231,-0.039],[1.511,-0.496],[0.019,-0.029],[-0.333,-0.754],[-0.011,-1.469],[0.019,-0.501],[-2.062,0],[-1.094,-0.586],[-0.805,0.344],[0.072,0.921],[-0.102,0.236],[-0.913,0.543],[0.289,1.358],[0.573,0.354],[-0.226,-0.108],[0.697,0.969],[0.381,0.255]],"o":[[0.065,-0.011],[-1.511,0.496],[-0.345,0.516],[0.333,0.754],[0.014,1.994],[-0.019,0.502],[1.817,0],[1.095,0.586],[0.188,-0.08],[-0.072,-0.921],[0.638,-1.471],[0.913,-0.543],[0.065,0.308],[-0.573,-0.354],[-1.157,-0.548],[-0.304,-0.423],[-1.178,-0.79]],"v":[[474,109],[471.063,109.97],[468,111],[468.233,112.785],[469,116],[468.465,119.495],[471,120],[475.258,121.258],[478,122],[478.064,120.117],[478,118],[480.696,115.415],[482,113],[480.879,112.65],[480,112],[478,111],[477,108]],"c":true}],"h":1},{"t":6,"s":[{"i":[[-0.039,0.001],[0.442,-0.449],[0.577,-0.197],[0.69,0.018],[0.374,-0.776],[-0.47,-0.935],[-0.004,-0.5],[0.319,-0.793],[-0.272,-0.317],[-1.077,0.101],[-0.431,-0.1],[-1.683,0.672],[-0.89,1.602],[0.972,7.109],[1.321,1.371],[0.527,0.527],[0.74,0.63]],"o":[[-0.655,0.009],[-0.442,0.448],[-0.867,0.296],[-0.69,-0.018],[0.115,-0.24],[0.47,0.935],[0.004,0.509],[-0.319,0.793],[0.262,0.304],[1.077,-0.101],[2.108,0.487],[1.399,-0.559],[2.336,-4.205],[-0.131,-0.958],[-0.523,-0.543],[-0.648,-0.648],[0.051,0.043]],"v":[[465,110],[463.441,110.859],[462,112],[459.63,112.14],[458,113],[459.084,114.445],[460,117],[459.299,119.144],[459,121],[461.373,121.154],[464,121],[468,123],[469,118],[472,115],[468,112],[467,110],[465,109]],"c":true}],"h":1},{"t":7,"s":[{"i":[[-0.094,0.002],[0.42,-0.458],[0.626,-0.154],[0.876,0.077],[0.179,-0.231],[-0.693,-0.63],[-0.053,-1.417],[0.391,-0.78],[-0.553,-0.565],[-1.157,0.166],[-1.063,-0.346],[-0.407,-0.568],[-0.99,0.396],[-0.18,0.451],[0.239,2.129],[1.694,2.482],[0.338,0.338]],"o":[[-0.692,0.013],[-0.42,0.458],[-0.317,0.078],[-0.876,-0.077],[-0.826,1.061],[0.693,0.63],[0.012,0.316],[-0.391,0.78],[0.309,0.316],[1.157,-0.166],[0.38,0.124],[0.408,0.568],[0.345,-0.138],[0.424,-1.064],[0.021,0.188],[-0.276,-0.404],[-0.617,-0.617]],"v":[[458,111],[456.45,111.895],[455,113],[452.896,112.886],[451,113],[451.341,115.233],[453,118],[452.095,119.813],[452,122],[454.434,121.977],[458,122],[459.042,123.39],[461,124],[461,120],[465,116],[460,112],[460,110]],"c":true}],"h":1},{"t":8,"s":[{"i":[[-0.119,-0.004],[0.454,-0.458],[0.553,-0.189],[0.681,0.017],[0.397,-0.769],[-0.469,-0.937],[0.005,-0.5],[0.383,-0.75],[-0.535,-0.636],[-0.615,0.587],[-1.639,-0.275],[-0.36,-0.633],[-1.308,0.744],[-0.246,0.559],[0.355,4.638],[1.562,2.251],[0.339,0.339]],"o":[[-0.63,-0.02],[-0.454,0.458],[-0.881,0.301],[-0.681,-0.017],[0.128,-0.248],[0.469,0.937],[-0.004,0.365],[-0.383,0.75],[0.903,1.072],[0.615,-0.587],[1.254,0.21],[0.36,0.633],[0.46,-0.262],[1.789,-4.074],[-0.044,-0.581],[-0.279,-0.402],[-0.605,-0.605]],"v":[[452,112],[450.442,112.843],[449,114],[446.637,114.149],[445,115],[446.1,116.439],[447,119],[446.096,120.797],[446,123],[447.948,123.097],[451,122],[452.96,123.716],[455,124],[455,120],[458,117],[454,113],[454,111]],"c":true}],"h":1},{"t":9,"s":[{"i":[[-0.025,0.003],[0.407,-0.444],[0.657,-0.15],[-0.062,-0.448],[-0.057,-1.681],[0.043,-0.502],[-2.105,0],[-0.858,-0.609],[-0.962,0.437],[0.07,0.919],[-0.093,0.24],[-0.465,0.199],[-0.101,0.109],[0.695,0.77],[0.505,0.541],[0.462,0.533],[1.041,0.761]],"o":[[-0.716,0.075],[-0.407,0.444],[-2.303,0.526],[0.062,0.448],[0.067,1.993],[-0.043,0.502],[1.605,0],[0.858,0.609],[0.187,-0.085],[-0.07,-0.919],[0.036,-0.095],[0.466,-0.199],[1.284,-1.379],[-0.695,-0.77],[-0.49,-0.524],[-0.805,-0.928],[0.044,0.032]],"v":[[447,113],[445.455,113.943],[444,115],[441.23,116.133],[442,119],[441.472,122.494],[444,123],[447.482,124.328],[450,125],[450.071,123.117],[450,121],[450.951,120.511],[452,120],[452.341,116.871],[450,115],[449,113],[447,112]],"c":true}],"h":1},{"t":10,"s":[{"i":[[-0.031,0.002],[1.495,-0.199],[0.205,-0.216],[-0.664,-0.767],[-0.043,-1.191],[0.397,-0.861],[-0.59,-0.61],[-0.791,0.357],[-0.477,-0.059],[-0.435,-0.583],[-0.995,0.488],[-0.018,1.045],[-0.48,0.6],[0.293,1.929],[0.941,0.862],[0.434,0.434],[1.227,0.707]],"o":[[0.186,-0.013],[-1.495,0.199],[-0.701,0.74],[0.664,0.767],[-0.002,-0.054],[-0.397,0.861],[0.358,0.37],[0.791,-0.357],[1.264,0.157],[0.435,0.583],[0.447,-0.219],[0.018,-1.045],[0.689,-0.86],[-0.109,-0.721],[-0.436,-0.399],[-0.874,-0.874],[0.047,0.027]],"v":[[443,114],[440.293,114.328],[437,115],[437.442,117.162],[439,120],[438.056,121.502],[438,124],[439.911,123.733],[442,123],[444.201,124.484],[446,125],[446.476,122.785],[447,120],[450,118],[446,116],[445,114],[443,113]],"c":true}],"h":1},{"t":11,"s":[{"i":[[-0.035,0.002],[0.413,-0.455],[0.643,-0.147],[-0.426,-0.466],[-0.13,-1.489],[0.397,-0.803],[-0.562,-0.51],[-1.036,0.104],[-0.5,-0.096],[-0.125,0.179],[-0.765,1.615],[-0.623,0.28],[0.2,1.382],[0.717,0.455],[0.124,0.133],[0.462,0.533],[1.041,0.761]],"o":[[-0.707,0.034],[-0.413,0.455],[-2.836,0.648],[0.426,0.466],[0.024,0.278],[-0.397,0.803],[0.355,0.322],[1.036,-0.104],[1.735,0.332],[0.125,-0.179],[0.709,-1.498],[0.623,-0.28],[-0.007,-0.047],[-0.717,-0.455],[-0.49,-0.524],[-0.805,-0.928],[0.049,0.036]],"v":[[440,114],[438.452,114.915],[437,116],[434.275,117.368],[436,120],[435.097,121.826],[435,124],[437.391,124.169],[440,124],[442.227,124.46],[443,122],[445.182,119.913],[446,118],[444.588,117.064],[443,116],[442,114],[440,113]],"c":true}],"h":1},{"t":12,"s":[{"i":[[0.763,-0.16],[0.738,-0.145],[0.833,-0.168],[0.008,-0.009],[-0.417,-0.745],[0.06,-1.282],[-0.449,0.003],[-2.315,-0.612],[-0.57,-0.503],[-0.317,0.116],[0.328,0.794],[-0.855,1.288],[-0.723,0.152],[0.173,0.965],[0.973,0.656],[0.107,0.367],[0.447,-0.092]],"o":[[0.277,-0.058],[-0.738,0.145],[-0.833,0.168],[-0.607,0.739],[0.417,0.745],[-0.112,2.401],[0.449,-0.003],[0.401,0.106],[0.57,0.502],[1.459,-0.535],[-0.328,-0.794],[0.283,-0.425],[0.722,-0.152],[-0.001,-0.007],[-0.973,-0.656],[-0.447,-1.529],[-0.447,0.092]],"v":[[437,115],[436.079,115.175],[433.491,115.689],[432,116],[432.09,118.093],[433,121],[433.18,123.842],[437,124],[438.563,125.167],[440,126],[440.953,124.064],[441,121],[442.841,120.405],[444,119],[442.079,117.77],[440,116],[438.737,114.234]],"c":true}],"h":1},{"t":13,"s":[{"i":[[0.008,-0.001],[0.44,-0.435],[0.579,-0.219],[0.508,-0.014],[0.273,-0.683],[-0.226,-1.681],[0.129,0.16],[-1.068,0.132],[-0.448,-0.181],[-0.031,-0.139],[-0.568,2.085],[-0.749,0.524],[0.019,-0.185],[0.581,0.417],[0.801,1.115],[-0.067,0.384],[0.112,0.248]],"o":[[-0.663,0.042],[-0.44,0.435],[-0.694,0.263],[-0.508,0.014],[0.226,-0.564],[0.226,1.681],[0.28,0.347],[1.068,-0.132],[1.307,0.528],[0.031,0.139],[0.024,-0.089],[0.749,-0.524],[0.126,-1.219],[-0.581,-0.417],[-0.156,-0.218],[0.067,-0.384],[-0.512,-1.136]],"v":[[436,115],[434.438,115.868],[433,117],[431.184,117.185],[430,118],[430.766,120.697],[431,124],[433.374,124.125],[436,124],[437.553,125.46],[438,123],[439.532,121.794],[441,121],[440.195,118.922],[438,117],[437.967,116.023],[438,115]],"c":true}],"h":1},{"t":14,"s":[{"i":[[-0.015,0.002],[0.594,-0.159],[0.509,-0.141],[0.286,-0.036],[-0.076,0.155],[-0.18,-1.072],[-0.162,-1.009],[0.097,0.104],[-1.472,-0.154],[0.176,-0.074],[-0.82,1.416],[0.201,-1.629],[0.567,0.47],[0.869,0.999],[-0.082,0.412],[0.17,0.17],[0.423,-0.331]],"o":[[-0.539,0.09],[-0.594,0.159],[-0.509,0.141],[-0.286,0.036],[-0.042,0.085],[0.18,1.072],[0.162,1.009],[0.287,0.309],[1.472,0.154],[-0.081,0.034],[0.82,-1.416],[0.138,-1.122],[-0.567,-0.47],[-0.159,-0.183],[0.082,-0.412],[-0.322,-0.322],[-0.423,0.331]],"v":[[434,116],[432.267,116.396],[430.578,116.868],[429.35,117.156],[429,117],[429.268,118.998],[429.842,122.381],[430,124],[433.347,124.676],[436,125],[437.59,121.803],[439,121],[438.255,118.907],[436,117],[436.008,115.99],[436,115],[434.747,115.26]],"c":true}],"h":1},{"t":15,"s":[{"i":[[1.271,-0.268],[0.532,-0.205],[0.096,-0.263],[-0.109,-0.427],[-0.083,-0.696],[-0.209,-0.257],[-0.378,0.256],[-0.705,-0.117],[-0.48,-0.62],[-0.846,0.519],[0.059,0.676],[-0.077,0.198],[-0.529,0.368],[0.294,1.067],[0.751,0.269],[0.022,0.019],[-0.053,0.111]],"o":[[-1.198,0.253],[-0.532,0.205],[-0.096,0.263],[0.109,0.427],[0.199,1.658],[0.209,0.257],[0.378,-0.256],[0.233,0.038],[0.48,0.62],[0.16,-0.099],[-0.059,-0.676],[0.178,-0.46],[0.529,-0.368],[0.025,0.094],[-0.751,-0.269],[-0.942,-0.823],[0.053,-0.111]],"v":[[432,117],[429.462,117.66],[428.577,118.335],[428.654,119.343],[429,121],[429.573,123.651],[430.415,123.431],[432,123],[433.041,124.418],[435,125],[435.062,123.575],[435,122],[436.354,120.955],[437,119],[435.536,118.584],[434,118],[433.247,116.681]],"c":true}],"h":1},{"t":16,"s":[{"i":[[1.227,-0.248],[0.398,-0.133],[-0.057,-0.161],[-0.177,-0.322],[0.039,-0.618],[0.099,-0.201],[0.127,-0.223],[0.09,-0.16],[-0.013,-0.012],[-0.67,-0.05],[-0.579,0.268],[-0.369,0.309],[-0.041,0.073],[0.002,0.298],[0.343,0.093],[0.439,0.439],[-0.032,0.087]],"o":[[-1.189,0.24],[-0.398,0.133],[0.057,0.161],[0.177,0.322],[-0.006,0.096],[-0.099,0.201],[-0.127,0.223],[-0.09,0.16],[0.644,0.644],[0.67,0.05],[0.579,-0.268],[0.369,-0.309],[0.585,-1.053],[-0.002,-0.298],[-0.343,-0.093],[-0.9,-0.9],[0.032,-0.087]],"v":[[431,118],[428.703,118.526],[428.275,118.934],[428.71,119.624],[429,121],[428.827,121.467],[428.472,122.124],[428.132,122.72],[428,123],[430,123.971],[431.904,123.575],[433.356,122.642],[434,122],[434.814,120.111],[434.235,119.661],[433,119],[432.245,117.639]],"c":true}],"h":1},{"t":17,"s":[{"i":[[0.395,-0.298],[0.324,-0.162],[0.272,-0.168],[0.141,-0.241],[-0.071,-0.383],[-0.362,-0.591],[-0.425,-0.069],[-0.545,-0.114],[-0.348,-0.113],[0.167,-0.066],[-0.179,0.409],[-0.24,0.526],[-0.191,0.354],[-0.033,-0.106],[0.279,0.278],[0.364,0.078],[0.403,-0.113]],"o":[[-0.297,0.224],[-0.324,0.162],[-0.272,0.168],[-0.141,0.241],[0.071,0.383],[-0.013,-0.022],[0.425,0.069],[0.545,0.114],[0.348,0.113],[0.009,-0.004],[0.179,-0.409],[0.239,-0.526],[0.191,-0.354],[-0.149,-0.484],[-0.279,-0.278],[-0.364,-0.078],[-0.403,0.113]],"v":[[430,119],[429.049,119.561],[428.134,120.039],[427.495,120.637],[427.371,121.556],[428,123],[428.696,123.083],[430.23,123.369],[431.649,123.721],[432,124],[432.31,123.309],[432.965,121.835],[433.637,120.444],[434,120],[433.346,118.859],[432.369,118.327],[431.208,118.381]],"c":true}],"h":1},{"t":18,"s":[{"i":[[0.001,0],[0.256,-0.013],[0.242,-0.005],[0.203,-0.044],[0.14,-0.128],[0.051,-0.259],[-0.56,-0.456],[-0.828,0.04],[-0.604,0.476],[0.113,0.853],[0.307,0.163],[0.405,0.307],[0.271,0.241],[-0.096,-0.035],[-0.001,-0.094],[0.001,-0.124],[0.002,-0.093]],"o":[[-0.245,0.066],[-0.256,0.013],[-0.242,0.005],[-0.203,0.044],[-0.14,0.128],[-0.2,1.012],[0.56,0.456],[0.828,-0.04],[0.604,-0.476],[0.025,0.192],[-0.307,-0.163],[-0.405,-0.307],[-0.271,-0.241],[0.005,0.002],[0.001,0.094],[-0.001,0.124],[-0.002,0.093]],"v":[[430,119],[429.241,119.107],[428.488,119.122],[427.813,119.184],[427.293,119.43],[427,120],[427.664,122.187],[429.87,122.798],[432.14,122.009],[433,120],[432.52,119.991],[431.393,119.234],[430.32,118.36],[430,118],[430.009,118.159],[430.009,118.502],[430.004,118.844]],"c":true}],"h":1},{"t":19,"s":[{"i":[[1.097,-0.659],[0.075,-0.009],[0.09,0.007],[0.098,0.016],[0.1,0.019],[0.096,0.014],[0.085,0.002],[0.069,-0.016],[0.046,-0.042],[0.018,-0.256],[0.006,-0.371],[-0.006,-0.372],[-0.018,-0.258],[-0.03,-0.03],[-0.715,0.396],[-0.278,0.911],[0.326,0.559]],"o":[[-0.054,0.032],[-0.075,0.009],[-0.09,-0.007],[-0.098,-0.016],[-0.1,-0.019],[-0.096,-0.014],[-0.085,-0.002],[-0.069,0.016],[-0.03,0.027],[-0.018,0.256],[-0.006,0.371],[0.006,0.372],[0.018,0.258],[0.985,0.984],[0.715,-0.396],[0.278,-0.911],[-0.326,-0.559]],"v":[[429,119],[428.805,119.061],[428.556,119.063],[428.273,119.026],[427.975,118.973],[427.68,118.922],[427.406,118.896],[427.174,118.915],[427,119],[426.928,119.454],[426.892,120.423],[426.892,121.566],[426.928,122.539],[427,123],[429.591,123.666],[431.123,121.489],[431.093,119.068]],"c":true}],"h":1},{"t":20,"s":[{"i":[[0.001,0],[0.324,-0.249],[0.095,-0.276],[-0.073,-0.287],[-0.18,-0.282],[-0.226,-0.26],[-0.166,0.078],[-0.337,-0.058],[-0.253,-0.107],[0.087,-0.068],[-0.094,0.459],[0.111,0.511],[0.274,0.421],[0.397,0.19],[-0.002,-0.094],[0.001,-0.124],[0.002,-0.093]],"o":[[-0.614,0.205],[-0.324,0.249],[-0.095,0.276],[0.073,0.287],[0.18,0.282],[-0.262,-0.301],[0.166,-0.078],[0.337,0.058],[0.253,0.107],[0.34,-0.266],[0.094,-0.459],[-0.111,-0.511],[-0.274,-0.421],[0.005,0.003],[0.001,0.094],[-0.001,0.124],[-0.002,0.093]],"v":[[429,119],[427.608,119.685],[426.996,120.477],[426.98,121.326],[427.376,122.184],[428,123],[427.92,122.454],[428.738,122.447],[429.686,122.716],[430,123],[430.641,121.876],[430.606,120.385],[430.018,118.951],[429,118],[429.01,118.161],[429.01,118.503],[429.006,118.844]],"c":true}],"h":1},{"t":21,"s":[{"i":[[0.214,-0.279],[0.07,-0.169],[0.034,-0.187],[-0.004,-0.189],[-0.045,-0.176],[-0.088,-0.147],[-0.133,-0.103],[-0.181,-0.043],[-0.231,0.033],[-0.283,0.124],[-0.108,0.191],[-0.014,0.246],[0.064,0.26],[0.126,0.233],[0.172,0.166],[0.202,0.058],[0.216,-0.09]],"o":[[-0.104,0.135],[-0.07,0.169],[-0.034,0.187],[0.004,0.189],[0.045,0.176],[0.088,0.147],[0.133,0.103],[0.181,0.043],[0.231,-0.033],[0.218,-0.096],[0.108,-0.191],[0.014,-0.246],[-0.064,-0.26],[-0.126,-0.233],[-0.172,-0.166],[-0.202,-0.058],[-0.216,0.09]],"v":[[428,120],[427.739,120.46],[427.583,120.998],[427.538,121.566],[427.611,122.119],[427.81,122.608],[428.142,122.988],[428.613,123.211],[429.23,123.231],[430,123],[430.486,122.56],[430.665,121.895],[430.587,121.126],[430.297,120.375],[429.846,119.766],[429.281,119.418],[428.649,119.456]],"c":true}],"h":1},{"t":22,"s":[{"i":[[0.031,-0.029],[0.12,-0.415],[-0.139,-0.382],[-0.319,-0.315],[-0.42,-0.215],[-0.441,-0.081],[-0.383,0.087],[-0.246,0.288],[-0.03,0.524],[0.25,0.39],[0.409,0.384],[0.458,0.298],[0.399,0.13],[0.23,-0.119],[-0.003,-0.088],[-0.017,-0.113],[-0.005,-0.093]],"o":[[-0.458,0.414],[-0.12,0.415],[0.139,0.382],[0.319,0.315],[0.42,0.215],[0.441,0.081],[0.383,-0.087],[0.246,-0.288],[0.018,-0.314],[-0.25,-0.39],[-0.409,-0.384],[-0.458,-0.298],[-0.399,-0.13],[-0.036,0.019],[0.003,0.088],[0.017,0.113],[0.005,0.093]],"v":[[394,159],[393.152,160.251],[393.201,161.454],[393.908,162.508],[395.036,163.312],[396.346,163.764],[397.603,163.764],[398.566,163.21],[399,162],[398.624,160.923],[397.609,159.742],[396.282,158.699],[394.97,158.037],[394,158],[393.957,158.172],[393.993,158.485],[394.033,158.806]],"c":true}],"h":1},{"t":23,"s":[{"i":[[0.103,0.064],[0.113,-0.587],[-0.159,-0.349],[-0.341,-0.143],[-0.434,0.031],[-0.439,0.174],[-0.355,0.285],[-0.182,0.365],[0.08,0.413],[0.43,0.43],[0.134,0.033],[0.171,-0.004],[0.194,-0.027],[0.203,-0.037],[0.199,-0.032],[0.181,-0.014],[0.149,0.018]],"o":[[-0.473,0.856],[-0.113,0.587],[0.159,0.349],[0.341,0.143],[0.434,-0.031],[0.439,-0.174],[0.355,-0.285],[0.182,-0.365],[-0.08,-0.413],[-0.083,-0.083],[-0.134,-0.033],[-0.171,0.004],[-0.194,0.027],[-0.203,0.037],[-0.199,0.032],[-0.181,0.014],[-0.149,-0.018]],"v":[[394,159],[393.144,161.156],[393.235,162.553],[394.007,163.284],[395.192,163.444],[396.524,163.129],[397.738,162.432],[398.566,161.449],[398.742,160.273],[398,159],[397.67,158.829],[397.209,158.79],[396.658,158.842],[396.058,158.942],[395.451,159.049],[394.878,159.122],[394.381,159.119]],"c":true}],"h":1},{"t":24,"s":[{"i":[[0.116,-0.12],[0.108,-0.251],[-0.02,-0.221],[-0.119,-0.187],[-0.188,-0.148],[-0.227,-0.104],[-0.237,-0.056],[-0.217,-0.004],[-0.167,0.054],[-0.088,0.115],[-0.058,0.26],[0.064,0.231],[0.154,0.193],[0.212,0.147],[0.237,0.093],[0.229,0.03],[0.189,-0.041]],"o":[[-0.266,0.276],[-0.108,0.251],[0.02,0.221],[0.119,0.187],[0.188,0.148],[0.227,0.104],[0.237,0.056],[0.217,0.004],[0.167,-0.054],[0.214,-0.281],[0.058,-0.26],[-0.064,-0.231],[-0.154,-0.193],[-0.212,-0.147],[-0.237,-0.093],[-0.229,-0.03],[-0.189,0.041]],"v":[[394,160],[393.447,160.791],[393.323,161.5],[393.54,162.113],[394.007,162.615],[394.637,162.994],[395.34,163.236],[396.028,163.327],[396.611,163.253],[397,163],[397.399,162.185],[397.382,161.446],[397.046,160.808],[396.488,160.295],[395.807,159.933],[395.1,159.747],[394.465,159.761]],"c":true}],"h":1},{"t":25.0000010182709,"s":[{"i":[[0.239,-0.288],[0.078,-0.219],[-0.02,-0.193],[-0.097,-0.155],[-0.156,-0.105],[-0.194,-0.044],[-0.213,0.029],[-0.212,0.113],[-0.192,0.209],[-0.152,0.316],[0.008,0.139],[0.057,0.155],[0.101,0.145],[0.139,0.11],[0.173,0.049],[0.2,-0.038],[0.222,-0.15]],"o":[[-0.195,0.234],[-0.078,0.219],[0.02,0.193],[0.097,0.155],[0.156,0.105],[0.194,0.044],[0.213,-0.029],[0.212,-0.113],[0.192,-0.209],[0.047,-0.098],[-0.008,-0.139],[-0.057,-0.155],[-0.101,-0.145],[-0.139,-0.11],[-0.173,-0.049],[-0.2,0.038],[-0.222,0.15]],"v":[[394,161],[393.596,161.683],[393.514,162.304],[393.695,162.828],[394.079,163.221],[394.609,163.447],[395.224,163.473],[395.867,163.263],[396.479,162.784],[397,162],[397.058,161.637],[396.96,161.189],[396.722,160.731],[396.36,160.342],[395.89,160.097],[395.329,160.074],[394.694,160.35]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":0,"s":[0],"h":1},{"t":1,"s":[100],"h":1},{"t":26.0000010590017,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 1"},{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":2,"s":[{"i":[[3.888,3.513],[2.024,-2.594],[1.978,-1.487],[1.571,-1.151],[-0.097,0.331],[-0.859,-2.709],[-3.186,1.389],[-1.871,0.374],[-1.07,-0.515],[-2.543,0.204],[-3.253,0.37],[-3.342,1.398],[-0.232,2.652],[0.797,4.557]],"o":[[-3.372,2.425],[-1.295,1.66],[-0.628,0.472],[0.014,-0.01],[-0.595,2.031],[1.378,4.347],[3.345,-1.458],[0.285,-0.057],[1.142,0.549],[2.988,-0.24],[3.722,-0.423],[1.314,-4.267],[0.239,-2.731],[-9.407,0.154]],"v":[[554,111],[551,119],[544,122],[541,127],[537,128],[539,133],[542,137],[549,138],[550,137],[552,139],[560,135],[568,136],[566,127],[570,118]],"c":true}],"h":1},{"t":3,"s":[{"i":[[5.919,0.85],[-0.113,-1.537],[0.659,-1.311],[0.892,-0.397],[0.45,-0.45],[0.34,-0.62],[-0.031,-0.845],[-1.399,-0.317],[-1.139,-1.462],[-0.085,-0.991],[-0.119,-0.343],[-8.911,-3.77],[0.3,2.748],[1.688,3.284]],"o":[[-0.794,1.543],[0.113,1.536],[0.019,-0.038],[-0.892,0.397],[-0.673,0.673],[-0.339,0.621],[1.265,1.269],[1.399,0.317],[0.541,0.694],[0.085,0.991],[2.54,7.338],[1.029,-3.9],[-0.369,-3.381],[-6.917,2.99]],"v":[[478,117],[477.398,121.674],[477,126],[475.352,126.634],[473,128],[471.472,129.871],[471,132],[475.095,133.856],[479,136],[479.817,138.763],[480,141],[497,137],[494,128],[495,119]],"c":true}],"h":1},{"t":4,"s":[{"i":[[3.502,-1.613],[1.783,-1.557],[0.036,-3.499],[-1.214,-0.413],[-0.799,-0.859],[-0.307,-1.275],[-0.934,-1],[-1.087,1.325],[-1.683,0.603],[-1.134,-0.126],[-1.273,1.079],[0.448,2.396],[-0.951,3.164],[3.264,0.594]],"o":[[1.17,5.275],[-1.783,1.557],[1.343,0.488],[1.214,0.413],[0.837,0.9],[0.307,1.275],[1.967,-0.097],[1.087,-1.325],[1.19,-0.426],[1.134,0.126],[-1.157,-2.251],[-0.448,-2.396],[-3.027,-1.974],[-2.478,-0.451]],"v":[[460,124],[457.905,132.832],[454,139],[457.908,140.221],[461,142],[462.427,145.425],[464,149],[468.213,146.38],[472,143],[475.438,142.99],[479,142],[476.419,135.184],[477,127],[468,127]],"c":true}],"h":1},{"t":5,"s":[{"i":[[4.911,1.372],[-0.227,-1.323],[0.64,-1.365],[1.506,-0.737],[-0.534,-1.966],[-1.17,-0.498],[-1.017,-1.158],[-0.388,-1.305],[-1.748,0.019],[-0.698,1.096],[-1.585,0.449],[-3.09,0.355],[0.254,2.934],[2.248,2.901]],"o":[[-1.268,1.344],[0.227,1.323],[-0.51,1.088],[-1.506,0.736],[1.304,0.849],[1.17,0.498],[0.7,0.798],[0.388,1.305],[1.622,-0.166],[0.698,-1.096],[1.793,-0.508],[1.176,-4.13],[-0.226,-2.614],[-6.165,2.623]],"v":[[447,129],[446.029,132.985],[446,137],[442.217,139.341],[440,143],[443.716,144.768],[447,147],[448.214,150.613],[451,153],[454.028,150.712],[457,148],[464,148],[461,139],[462,131]],"c":true}],"h":1},{"t":6,"s":[{"i":[[2.674,-0.626],[-0.164,-1.114],[0.519,-1.242],[1.391,-0.909],[-0.154,-1.954],[-1.646,-1.521],[-0.137,-3.03],[-1.097,1.208],[-1.497,0.525],[-1.132,-0.124],[-1.275,1.075],[0.215,2.95],[0.875,2.957],[3.46,0.777]],"o":[[-1.138,1.3],[0.164,1.114],[-0.589,1.411],[-1.391,0.909],[2.28,0.887],[1.646,1.521],[2.114,0.358],[1.097,-1.208],[1.195,-0.419],[1.132,0.123],[0.021,-3.807],[-0.147,-2.018],[-2.524,-1.658],[-2.454,-0.551]],"v":[[436,133],[435.035,136.544],[435,140],[431.443,143.092],[429,147],[435.108,150.393],[438,157],[442.463,155.163],[446,152],[449.44,151.992],[453,151],[450,143],[451,136],[442,136]],"c":true}],"h":1},{"t":7,"s":[{"i":[[-1.902,6.328],[1.231,-0.443],[1.28,0.18],[1.066,0.962],[1.375,-1.037],[-0.195,-1.144],[0.511,-1.218],[1.406,-0.686],[-0.184,-1.921],[-1.73,-1.437],[0.066,-3.233],[-1.097,1.208],[-1.497,0.525],[-2.551,2.15]],"o":[[-1.796,-0.594],[-1.231,0.443],[-1.36,-0.19],[-1.066,-0.962],[-1.268,1.206],[0.195,1.144],[-0.56,1.334],[-1.406,0.686],[2.147,1.019],[1.73,1.437],[2.114,0.358],[1.097,-1.208],[2.39,-0.838],[-2.314,-4.503]],"v":[[442,139],[437.613,139.19],[434,140],[430.512,137.579],[427,137],[425.933,140.491],[426,144],[422.442,146.56],[420,150],[426.16,153.34],[429,160],[433.463,158.163],[437,155],[444,154]],"c":true}],"h":1},{"t":8,"s":[{"i":[[5.17,2.479],[-0.219,-1.315],[0.621,-1.383],[1.393,-0.744],[-0.995,-2.079],[-1.356,-1.477],[-0.201,-2.632],[-1.091,1.186],[-1.512,0.577],[-0.976,-0.085],[-1.153,0.983],[0.7,1.195],[0.082,1.572],[1.909,1.844]],"o":[[-1.254,1.357],[0.219,1.315],[-0.423,0.943],[-1.393,0.744],[2.375,0.459],[1.356,1.477],[2.125,0.322],[1.091,-1.186],[0.943,-0.359],[0.976,0.085],[-0.118,-1.649],[-0.7,-1.195],[-0.105,-2.009],[-7.631,1.51]],"v":[[420,139],[419.025,142.981],[419,147],[415.436,149.148],[414,153],[419.63,155.87],[422,162],[426.459,160.174],[430,157],[432.843,156.967],[436,156],[434.473,151.942],[433,148],[434,142]],"c":true}],"h":1},{"t":9,"s":[{"i":[[5.866,1.215],[-0.072,-1.201],[0.508,-1.043],[1.146,-0.604],[-0.102,-1.517],[-1.593,-1.573],[-0.558,-2.609],[-0.793,1.218],[-1.119,0.464],[-1.114,-0.163],[-1.302,1.137],[0.7,1.195],[0.082,1.572],[1.909,1.844]],"o":[[-0.778,1.154],[0.072,1.201],[-0.52,1.067],[-1.146,0.604],[2.068,1.099],[1.593,1.573],[1.708,0.337],[0.793,-1.218],[1.244,-0.517],[1.114,0.163],[-0.118,-1.649],[-0.7,-1.195],[-0.105,-2.009],[-7.097,1.865]],"v":[[414,142],[413.298,145.584],[413,149],[410.033,151.163],[408,154],[413.633,157.867],[417,164],[420.442,162.101],[423,159],[426.457,158.965],[430,158],[428.473,153.942],[427,150],[428,144]],"c":true}],"h":1},{"t":10,"s":[{"i":[[2.186,1.355],[1.287,-2.046],[1.629,-1.704],[-1.157,-0.51],[-1.046,-1.132],[-0.418,-1.214],[-1.762,0.467],[-1.852,0.815],[-2.672,-0.005],[0.849,1.037],[0.149,1.147],[-0.528,1.133],[0.953,1.238],[1.861,0.599]],"o":[[-0.222,3.111],[-1.287,2.046],[1.326,0.828],[1.157,0.51],[0.564,0.611],[0.418,1.214],[0.921,-1.745],[1.852,-0.815],[0.543,-1.704],[-0.849,-1.037],[-0.159,-1.231],[0.528,-1.133],[-3.369,0.752],[-1.861,-0.599]],"v":[[410,143],[407.555,150.555],[403,156],[406.71,157.772],[410,160],[411.101,163.308],[414,165],[418.187,161.187],[425,160],[424.019,156.083],[422,153],[423.096,149.505],[423,146],[415.613,146.08]],"c":true}],"h":1},{"t":11,"s":[{"i":[[4.307,1.533],[-0.17,-1.17],[0.541,-1.139],[1.231,-0.569],[-0.417,-1.687],[-1.5,-1.333],[-0.284,-2.549],[-0.984,0.993],[-1.243,0.447],[-1.041,-0.067],[-0.929,0.94],[0.787,0.945],[0.153,1.377],[2.437,2.473]],"o":[[-1.139,1.181],[0.17,1.17],[-0.493,1.038],[-1.231,0.569],[1.714,1.12],[1.501,1.333],[1.822,0.42],[0.984,-0.993],[0.906,-0.326],[1.041,0.066],[0.301,-1.844],[-0.787,-0.945],[-0.243,-2.197],[-5.617,2.383]],"v":[[406,145],[405.051,148.532],[405,152],[401.818,154.013],[400,157],[405.072,160.428],[408,166],[411.934,164.65],[415,162],[417.983,161.961],[421,161],[419.84,157.15],[418,154],[419,147]],"c":true}],"h":1},{"t":12,"s":[{"i":[[1.269,-0.613],[0.324,-1.093],[0.685,-0.732],[0.644,-0.773],[0.2,-1.216],[-1.098,-1.902],[-2.348,-0.652],[-2.058,0.608],[-2.152,0.514],[0.508,1.911],[-0.942,3.058],[1.176,-0.193],[1.336,0.198],[1.164,0.613]],"o":[[0.441,1.858],[-0.324,1.093],[-0.685,0.732],[-0.644,0.773],[3.26,-0.26],[1.098,1.902],[0.614,-2.053],[2.058,-0.608],[-0.91,-2.296],[-0.508,-1.911],[-0.96,-0.573],[-1.176,0.193],[-1.073,-0.159],[-1.165,-0.613]],"v":[[402,147],[402.075,151.325],[400.462,153.962],[398.367,156.117],[397,159],[402.684,162.316],[407,167],[411.346,163.346],[418,162],[415.611,156.071],[416,149],[412.782,148.719],[409,149],[405.647,147.42]],"c":true}],"h":1},{"t":13,"s":[{"i":[[2.089,1.024],[0.376,-1.041],[0.54,-0.876],[0.644,-0.772],[0.688,-0.728],[-0.845,-0.405],[-0.696,-0.554],[-0.378,-0.872],[0.108,-1.358],[-1.41,1.256],[-3.607,-0.94],[0.283,1.917],[-0.753,2.839],[1.755,0.445]],"o":[[-0.151,1.266],[-0.376,1.041],[-0.54,0.876],[-0.644,0.772],[0.825,0.425],[0.845,0.405],[0.696,0.554],[0.378,0.872],[2.752,0.085],[1.41,-1.256],[-0.621,-2.49],[-0.283,-1.918],[-2.892,0.805],[-1.755,-0.446]],"v":[[401,148],[400.195,151.445],[398.806,154.306],[397.014,156.764],[395,159],[397.547,160.203],[399.9,161.6],[401.553,163.697],[402,167],[407.359,164.359],[414,163],[412.469,156.762],[413,150],[406.398,150.372]],"c":true}],"h":1},{"t":14,"s":[{"i":[[-1.749,-3.425],[-1.209,-0.261],[-0.813,-1.156],[0.018,-0.834],[-0.703,-0.141],[-0.891,0.96],[-1.267,0.392],[-0.9,-0.073],[-0.124,0.209],[0.786,0.4],[0.121,2.269],[5.171,0],[1.415,-0.619],[0.811,-1.51]],"o":[[0.349,0.798],[1.209,0.262],[0.368,0.524],[-0.018,0.834],[1.17,0.234],[0.891,-0.96],[0.274,-0.085],[0.901,0.073],[1.264,-2.13],[-0.786,-0.4],[-0.167,-3.128],[-3.728,0],[-0.954,0.417],[-1.668,3.105]],"v":[[394,160],[396.652,161.231],[400,163],[400.248,165.287],[401,167],[403.927,165.47],[407,163],[409.112,163.093],[411,163],[411.039,160.104],[409,157],[407,152],[399,150],[398,156]],"c":true}],"h":1},{"t":15,"s":[{"i":[[-2.495,-0.443],[-1.831,0.271],[1.308,2.76],[-0.011,1.347],[0.502,0.467],[0.785,-0.345],[0.48,0.025],[0.708,0.583],[0.794,-0.404],[0.081,-1.047],[0.329,-0.635],[-0.97,-4.533],[0.454,0.215],[-0.776,-0.802]],"o":[[0.982,-3.156],[1.831,-0.271],[-0.543,-1.145],[0.011,-1.347],[-0.379,-0.353],[-0.785,0.345],[-1.374,-0.072],[-0.708,-0.583],[-0.347,0.177],[-0.081,1.047],[-2.023,3.903],[-0.131,-0.614],[1.157,0.548],[1.636,1.69]],"v":[[401,167],[406.217,163.203],[408,160],[407.47,155.991],[407,153],[405.076,153.254],[403,154],[400.066,152.642],[398,152],[397.486,154.156],[397,157],[394,161],[396,162],[398,163]],"c":true}],"h":1},{"t":16,"s":[{"i":[[0.993,-0.627],[-0.045,-0.444],[0.06,-0.148],[0.598,0.176],[-0.334,-2.344],[-0.791,-0.642],[0.096,0.098],[-0.31,0.47],[-2.387,0.544],[0.515,0.508],[-0.001,2.272],[-0.037,0.48],[2.15,0],[0.524,0.157]],"o":[[-0.119,0.075],[0.045,0.444],[-0.944,2.362],[-0.598,-0.176],[-0.067,-0.468],[0.791,0.642],[2.373,2.423],[0.31,-0.47],[3.06,-0.697],[-0.515,-0.508],[0,-1.079],[0.037,-0.48],[-1.913,0],[-0.524,-0.157]],"v":[[397,155],[396.955,155.945],[397,157],[394.541,159.014],[394,161],[395.522,161.722],[397,163],[399.99,165.225],[403,163],[405.794,161.68],[404,158],[404.613,155.69],[402,155],[398.81,154.529]],"c":true}],"h":1},{"t":17,"s":[{"i":[[0.128,-0.089],[-0.038,-0.443],[0.04,-0.149],[0.486,-0.209],[-0.015,0.096],[-0.869,-0.984],[0.366,0.631],[0.037,-0.467],[-0.089,-0.029],[-1.841,0.536],[0.105,-0.231],[0.179,1.671],[0.294,0.294],[0.264,-0.118]],"o":[[-0.111,0.077],[0.038,0.443],[-0.07,0.262],[-0.486,0.209],[-0.108,0.697],[0.869,0.984],[0.06,0.105],[-0.037,0.467],[-0.26,-0.085],[1.841,-0.537],[0.01,-0.021],[-0.179,-1.671],[-0.705,-0.705],[-0.137,0.061]],"v":[[396,156],[395.947,156.946],[396,158],[394.936,158.768],[394,159],[395.693,161.996],[397,163],[396.979,164.057],[397,165],[400.384,163.763],[404,163],[403.728,159.705],[403,156],[396,155]],"c":true}],"h":1},{"t":18,"s":[{"i":[[0.718,-0.411],[0.677,-1.034],[0.024,0.289],[-0.689,-0.125],[-0.22,-0.2],[-0.111,-0.61],[-1.026,-0.077],[-0.504,0.483],[-0.142,0.056],[-0.502,0.009],[-0.289,0.686],[0.487,0.743],[-0.017,0.188],[0.91,0.825]],"o":[[-0.269,0.154],[-0.676,1.034],[0.025,0.302],[0.689,0.125],[0.53,0.481],[0.111,0.61],[-0.158,-0.012],[0.504,-0.483],[0.701,-0.277],[0.502,-0.009],[-0.067,0.159],[-0.488,-0.743],[-0.003,0.033],[-1.216,-1.102]],"v":[[396,157],[394.316,159.333],[393,161],[394.354,161.577],[396,162],[396.628,163.803],[398,165],[398.775,164.033],[400,163],[401.808,162.807],[403,162],[401.937,160.76],[401,159],[402,157]],"c":true}],"h":1},{"t":19,"s":[{"i":[[1.855,-1.665],[-0.067,-0.416],[0.108,-0.195],[0.508,-0.375],[-0.284,-1.048],[-0.531,-0.322],[0.063,0.064],[-0.367,-0.559],[0.34,0.106],[-1.298,0.833],[0.028,-0.07],[0.211,0.539],[0.022,0.183],[2.156,0.221]],"o":[[-0.159,0.142],[0.067,0.416],[-0.25,0.451],[-0.508,0.375],[-0.06,-0.223],[0.531,0.322],[-0.129,-0.129],[0.367,0.559],[0.834,0.262],[1.298,-0.833],[-0.134,0.341],[-0.211,-0.539],[-0.586,-4.886],[-2.521,-0.259]],"v":[[395,157],[394.962,157.961],[395,159],[393.6,160.052],[393,162],[394.002,162.38],[395,163],[395.658,163.983],[396,165],[399.647,163.644],[402,162],[401.416,161.393],[401,160],[398,158]],"c":true}],"h":1},{"t":20,"s":[{"i":[[0.039,-0.024],[0.176,-0.755],[-0.324,-0.736],[-0.588,-0.489],[-0.617,-0.011],[-0.37,0.299],[-0.514,0.389],[-0.386,0.27],[0.011,-0.057],[0.39,0.616],[0.667,0.475],[0.693,0.247],[0.469,-0.069],[-0.019,-0.243]],"o":[[-0.912,0.543],[-0.176,0.755],[0.324,0.736],[0.588,0.489],[-0.043,-0.001],[0.37,-0.299],[0.514,-0.389],[0.386,-0.27],[0.136,-0.668],[-0.39,-0.616],[-0.667,-0.475],[-0.693,-0.247],[-0.038,0.005],[0.019,0.243]],"v":[[395,158],[393.426,160.005],[393.706,162.298],[395.133,164.193],[397,165],[397.558,164.498],[398.952,163.413],[400.37,162.372],[401,162],[400.555,160.052],[398.907,158.394],[396.805,157.289],[395,157],[395.001,157.486]],"c":true}],"h":1},{"t":21,"s":[{"i":[[0.023,-0.024],[0.028,-0.609],[-0.203,-0.655],[-0.379,-0.469],[-0.501,-0.051],[-0.524,0.483],[-0.101,0.046],[-0.336,0.056],[-0.171,0.552],[0.217,0.982],[0.938,0.704],[1.037,0.046],[0.107,0.004],[-0.01,-0.244]],"o":[[-0.314,0.33],[-0.028,0.609],[0.203,0.655],[0.379,0.469],[-0.199,-0.02],[0.524,-0.483],[0.486,-0.224],[0.336,-0.056],[-0.195,0.63],[-0.217,-0.982],[0.253,0.19],[-1.036,-0.046],[-0.016,0],[0.01,0.244]],"v":[[394,159],[393.501,160.466],[393.778,162.419],[394.666,164.163],[396,165],[396.775,164.02],[398,163],[399.236,162.746],[400,162],[399.558,161],[398,158],[396.27,158.145],[394,158],[394.005,158.482]],"c":true}],"h":1},{"t":22,"s":[{"i":[[-0.046,0.034],[0.045,-0.756],[-0.597,-0.541],[-0.844,-0.139],[-0.695,0.448],[0.064,0.225],[0.168,0.237],[0.145,0.144],[-0.005,-0.056],[-0.149,0.25],[-0.176,0.28],[-0.064,0.266],[0.188,0.205],[0.793,-0.248]],"o":[[-1.082,0.786],[-0.045,0.756],[0.597,0.541],[0.844,0.139],[0.166,-0.107],[-0.064,-0.225],[-0.168,-0.237],[-0.145,-0.144],[-0.016,-0.173],[0.149,-0.25],[0.176,-0.28],[0.064,-0.266],[-0.876,-0.959],[-0.793,0.248]],"v":[[542,195],[540.408,197.359],[541.334,199.35],[543.593,200.416],[546,200],[546.121,199.475],[545.742,198.755],[545.241,198.157],[545,198],[545.235,197.355],[545.757,196.548],[546.151,195.718],[546,195],[543.308,194.306]],"c":true}],"h":1},{"t":23,"s":[{"i":[[0.05,-0.027],[0.292,-0.409],[0.127,-0.493],[-0.104,-0.462],[-0.399,-0.318],[-0.291,0.067],[-0.29,0.178],[-0.229,0.147],[-0.109,-0.026],[-0.184,-0.349],[-0.307,0.385],[0.9,1.169],[0.567,-0.149],[-0.025,-0.24]],"o":[[-0.393,0.212],[-0.292,0.409],[-0.127,0.493],[0.104,0.462],[0.232,0.185],[0.291,-0.067],[0.29,-0.178],[0.229,-0.147],[-0.041,-0.01],[0.184,0.349],[1.169,-1.472],[-0.9,-1.169],[-0.051,0.013],[0.025,0.24]],"v":[[542,195],[540.957,195.96],[540.313,197.341],[540.263,198.801],[541,200],[541.799,200.141],[542.685,199.737],[543.478,199.215],[544,199],[544.239,199.782],[545,200],[544.803,195.784],[542,194],[542,194.49]],"c":true}],"h":1},{"t":24,"s":[{"i":[[0.019,-0.009],[0.19,-0.185],[0.247,-0.246],[0.183,-0.188],[-0.002,-0.011],[-0.321,-0.156],[-0.417,-0.287],[-0.263,-0.238],[0.142,-0.007],[-0.279,0.449],[0.177,0.594],[0.493,0.472],[0.667,0.086],[-0.007,-0.248]],"o":[[-0.013,0.006],[-0.19,0.185],[-0.247,0.246],[-0.183,0.188],[-0.026,-0.156],[0.321,0.156],[0.417,0.287],[0.263,0.238],[0.876,-0.04],[0.279,-0.449],[-0.177,-0.594],[-0.493,-0.472],[-0.01,-0.001],[0.007,0.248]],"v":[[542,196],[541.665,196.316],[540.978,196.993],[540.302,197.672],[540,198],[540.504,198.045],[541.673,198.756],[542.756,199.589],[543,200],[544.697,199.2],[544.814,197.569],[543.774,195.904],[542,195],[542.007,195.493]],"c":true}],"h":1},{"t":25.0000010182709,"s":[{"i":[[0.888,-0.694],[0.072,-0.127],[0.034,-0.153],[-0.004,-0.165],[-0.042,-0.163],[-0.08,-0.146],[-0.118,-0.116],[-0.155,-0.071],[-0.192,-0.012],[-0.272,0.306],[-0.222,0.453],[-0.081,0.427],[0.151,0.227],[0.474,-0.146]],"o":[[-0.111,0.087],[-0.072,0.127],[-0.034,0.153],[0.004,0.165],[0.042,0.163],[0.08,0.146],[0.118,0.116],[0.155,0.071],[0.232,0.014],[0.272,-0.306],[0.222,-0.453],[0.081,-0.427],[-0.151,-0.227],[-0.474,0.146]],"v":[[542,197],[541.725,197.324],[541.566,197.748],[541.521,198.229],[541.591,198.725],[541.775,199.192],[542.071,199.589],[542.48,199.872],[543,200],[543.778,199.519],[544.542,198.336],[545.019,196.972],[544.936,195.948],[544.02,195.783]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":1,"s":[0],"h":1},{"t":2,"s":[100],"h":1},{"t":26.0000010590017,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 2"},{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":3,"s":[{"i":[[3.616,-1.581],[4.358,1.012],[2.779,0.448],[2.279,-1.372],[0.001,-0.004],[-0.703,-3.003],[-5.73,0],[-1.205,0.868],[-1.85,-0.375],[-2.154,-2.846],[-3.679,0.552],[-2.684,2.414],[-2.829,5.306],[3.011,1.619]],"o":[[-0.81,4.567],[-1.841,-0.428],[-0.426,0.945],[-0.152,0.091],[-0.766,2.23],[1.406,5.999],[2.653,0],[0.822,-0.592],[2.711,2.289],[3.76,-0.452],[2.455,-0.368],[-2.799,-8.119],[-4.271,-2.202],[-1.958,-1.053]],"v":[[550,127],[541,137],[537,133],[534,137],[531,138],[533,143],[538,146],[543,147],[544,143],[548,154],[557,150],[565,150],[567,134],[557,132]],"c":true}],"h":1},{"t":4,"s":[{"i":[[3.156,-2.787],[1.694,-1.806],[2.707,-0.793],[-1.32,-0.891],[-0.75,-1.456],[-0.091,-1.341],[-0.986,-1.374],[-1.135,0.896],[-1.687,0.197],[-1.262,-0.373],[-1.732,0.348],[-0.36,2.199],[-1.615,2.852],[3.131,1.648]],"o":[[-0.517,2.983],[-1.694,1.806],[-0.029,1.98],[1.32,0.891],[0.649,1.261],[0.091,1.341],[1.774,-0.218],[1.135,-0.896],[1.221,-0.143],[1.262,0.373],[-1.053,-4.353],[0.36,-2.199],[-3.516,-2.429],[-0.614,-0.323]],"v":[[548,139],[544.643,146.142],[538,150],[540.416,153.893],[544,157],[544.747,160.915],[546,165],[550.066,162.985],[554,161],[557.617,161.654],[562,162],[561,152.874],[564,146],[554,144]],"c":true}],"h":1},{"t":5,"s":[{"i":[[0.245,-0.071],[0.397,-0.454],[0.288,-0.148],[-0.107,-0.53],[-0.679,-1.799],[-0.028,-0.687],[-1.254,-0.567],[-0.759,0.476],[-0.157,0.01],[-1.168,1.115],[-0.318,0.978],[0.681,2.077],[1.015,0.772],[0.566,0.401]],"o":[[-0.122,0.036],[-0.397,0.454],[-2.108,1.082],[0.107,0.53],[0.635,1.685],[0.028,0.687],[-0.191,-0.087],[0.759,-0.476],[0.665,-0.043],[0.698,-0.666],[0.276,-0.85],[-0.413,-1.26],[-0.615,-0.467],[-1.15,-0.815]],"v":[[527,149],[526.125,149.916],[525,151],[522.41,152.962],[524,156],[524.536,159.338],[526,161],[527.239,159.943],[529,159],[533,160],[533,155],[535,152],[531,151],[530,148]],"c":true}],"h":1},{"t":6,"s":[{"i":[[3.167,-0.913],[0.398,-0.455],[0.287,-0.147],[-0.206,-0.463],[-0.456,-1.978],[0.074,-0.88],[-0.224,-0.169],[-0.824,0.375],[-1.103,-0.046],[-0.733,-0.376],[-0.676,0.52],[-0.274,0.842],[0.705,2.059],[1.165,0.636]],"o":[[-0.12,0.034],[-0.398,0.454],[-2.279,1.171],[0.206,0.463],[0.071,0.309],[-0.074,0.88],[0.6,0.456],[0.824,-0.375],[0.392,0.016],[0.733,0.376],[0.634,-0.488],[0.27,-0.831],[-0.411,-1.199],[-3.044,-1.662]],"v":[[524,154],[523.125,154.915],[522,156],[519.449,157.895],[521,161],[520.886,163.105],[521,165],[523.123,164.808],[526,164],[527.788,164.902],[530,165],[530,160],[532,157],[528,156]],"c":true}],"h":1},{"t":7,"s":[{"i":[[1.307,-0.183],[-0.041,-0.399],[0.411,-0.298],[0.859,0.049],[0.274,-1.264],[-0.49,-0.27],[-0.019,-0.019],[-0.045,-1.323],[-0.298,-0.185],[-2.306,-0.275],[0,2.978],[-0.637,1.345],[1.221,0.536],[0.181,0.209]],"o":[[-0.753,0.106],[0.041,0.399],[-1.292,0.933],[-0.859,-0.049],[0.022,-0.1],[0.49,0.27],[0.524,0.524],[0.045,1.323],[2.006,1.243],[2.329,0.278],[0,-3.641],[1.957,-4.133],[-0.184,-0.081],[-1.26,-1.454]],"v":[[522,158],[521.244,158.856],[521,160],[517.737,160.752],[516,162],[517.002,162.411],[518,163],[518.669,166.254],[519,169],[524,168],[527,167],[529,163],[525,160],[524,158]],"c":true}],"h":1},{"t":8,"s":[{"i":[[-0.005,0.001],[-0.041,-0.352],[0.423,-0.409],[0.897,-0.099],[0.13,-0.332],[-0.516,-0.414],[-0.317,-1.376],[0.073,-0.881],[-0.223,-0.167],[-1.717,-0.205],[-1.417,4.356],[0.719,2.047],[0.473,0.298],[1.092,0.848]],"o":[[-0.741,0.183],[0.041,0.352],[-0.282,0.274],[-0.897,0.099],[-0.38,0.968],[0.516,0.414],[0.071,0.307],[-0.073,0.881],[1.069,0.804],[4.552,0.543],[0.267,-0.821],[-0.128,-0.366],[-2.61,-1.644],[0.035,0.027]],"v":[[520,161],[519.261,161.83],[519,163],[516.887,163.456],[515,164],[515.477,165.693],[517,168],[516.886,170.105],[517,172],[522,171],[525,167],[527,164],[523,163],[520,160]],"c":true}],"h":1},{"t":9,"s":[{"i":[[1.406,-0.376],[-0.036,-0.372],[0.427,-0.32],[0.678,0.028],[0.25,-1.333],[-0.486,-0.716],[-0.039,-0.219],[-0.586,0.234],[-2.166,-0.19],[-0.16,0.261],[-0.563,2.114],[0.553,1.319],[0.471,0.237],[0.039,0.039]],"o":[[-0.718,0.192],[0.036,0.372],[-1.038,0.779],[-0.678,-0.028],[0.015,-0.082],[0.486,0.716],[0.489,2.749],[0.586,-0.234],[1.798,0.157],[0.16,-0.261],[-0.009,0.035],[-0.165,-0.395],[0.101,0.051],[-1.292,-1.292]],"v":[[518,164],[517.281,164.904],[517,166],[514.41,166.584],[513,168],[513.982,169.274],[515,171],[516.243,173.919],[520,173],[522.426,173.204],[523,170],[525,166],[521,166],[520,164]],"c":true}],"h":1},{"t":10,"s":[{"i":[[2.943,-0.826],[0.237,-0.387],[0.462,-0.287],[0.59,-0.053],[0.188,-0.509],[-0.506,-0.428],[-0.33,-1.325],[-0.51,0.106],[-1.355,0],[-0.722,-0.382],[-0.698,0.527],[-0.346,0.856],[0.358,1.059],[1.023,0.777]],"o":[[-0.59,0.166],[-0.237,0.387],[-0.452,0.281],[-0.59,0.052],[-0.355,0.964],[0.506,0.428],[0.603,2.426],[0.51,-0.107],[0.413,0],[0.722,0.382],[0.673,-0.508],[0.19,-0.469],[-0.427,-1.263],[-2.732,-2.076]],"v":[[517,166],[515.904,166.909],[515,168],[513.302,168.329],[512,169],[512.487,170.729],[514,173],[515.436,175.82],[518,175],[519.787,175.895],[522,176],[522,171],[524,169],[520,168]],"c":true}],"h":1},{"t":11,"s":[{"i":[[0.169,-0.035],[0.407,-0.424],[0.663,-0.156],[0.456,0.03],[0.049,-0.091],[-0.462,-2.007],[-0.1,-0.07],[-2.132,0.106],[0.477,-0.462],[-0.248,1.837],[0.2,0.454],[0.694,-0.055],[0.164,0.08],[0.535,0.34]],"o":[[-0.71,0.147],[-0.407,0.424],[-0.125,0.029],[-0.456,-0.03],[0.053,-0.096],[0.462,2.007],[-0.052,-0.036],[2.132,-0.106],[0.207,-0.2],[0.249,-1.837],[-0.061,-0.139],[-0.694,0.055],[-0.669,-0.326],[-0.872,-0.554]],"v":[[516,168],[514.465,168.993],[513,170],[511.943,169.954],[511,170],[511.965,173.875],[513,178],[517.319,177.626],[521,178],[521.805,174.19],[522,170],[520.577,169.956],[519,170],[518,167]],"c":true}],"h":1},{"t":12,"s":[{"i":[[0.686,-0.16],[-0.041,-0.355],[0.419,-0.407],[0.9,-0.102],[0.122,-0.325],[-0.509,-0.465],[-0.307,-1.231],[-0.51,0.106],[-1.355,0],[-0.718,-0.381],[-0.708,0.525],[-0.02,0.105],[0.821,1.962],[0.326,0.243]],"o":[[-0.743,0.173],[0.041,0.355],[-0.276,0.267],[-0.9,0.102],[-0.341,0.907],[0.509,0.465],[0.603,2.426],[0.51,-0.107],[0.421,0],[0.718,0.381],[0.987,-0.731],[0.132,-0.701],[-0.117,-0.279],[-2.25,-1.679]],"v":[[515,169],[514.257,169.825],[514,171],[511.885,171.457],[510,172],[510.514,173.757],[512,176],[513.436,178.82],[516,178],[517.784,178.894],[520,179],[519,175],[521,172],[518,170]],"c":true}],"h":1},{"t":13,"s":[{"i":[[3.296,-1.226],[-0.017,-0.233],[0.026,-0.05],[0.905,-0.074],[0.158,-0.286],[-0.474,-1.827],[0.046,0.038],[-1.645,0.028],[-0.666,0.684],[0.35,0.614],[-0.027,0.163],[-0.286,0.352],[0.093,-0.097],[1.526,0.781]],"o":[[-0.043,0.016],[0.017,0.233],[-0.221,0.419],[-0.905,0.074],[0.149,-0.27],[0.474,1.827],[-0.248,-0.204],[1.645,-0.028],[0.372,-0.382],[-0.35,-0.614],[-0.052,0.313],[0.286,-0.352],[2.493,-2.602],[-2.832,-1.45]],"v":[[514,171],[513.988,171.475],[514,172],[511.952,172.6],[510,173],[511.146,176.326],[512,180],[514.815,179.86],[519,179],[518.759,177.336],[518,176],[518.531,175.662],[519,175],[517,173]],"c":true}],"h":1},{"t":14,"s":[{"i":[[2.617,-0.916],[-0.003,-0.383],[0.383,-0.248],[0.696,0.062],[0.058,-0.148],[-0.296,-0.503],[-0.063,-0.361],[-0.582,0.144],[-1.229,-0.053],[-0.54,-0.37],[-0.729,0.486],[-0.017,0.105],[0.923,1.851],[0.354,0.168]],"o":[[-0.63,0.22],[0.003,0.383],[-0.158,0.102],[-0.696,-0.062],[-0.249,0.627],[0.296,0.503],[0.441,2.522],[0.582,-0.144],[0.109,0.005],[0.54,0.37],[0.708,-0.472],[0.099,-0.598],[-0.15,-0.301],[-2.719,-1.288]],"v":[[514,172],[513.315,172.979],[513,174],[511.426,173.966],[510,174],[510.266,175.7],[511,177],[512.409,179.852],[515,179],[516.035,179.868],[518,180],[517,177],[519,174],[516,174]],"c":true}],"h":1},{"t":15,"s":[{"i":[[0.914,-0.477],[0.266,-0.159],[0.43,-0.213],[0.324,-0.072],[-0.053,0.262],[-0.264,-0.828],[-0.628,-0.531],[-0.926,0.063],[-1.155,0.953],[-0.44,1.163],[-0.01,-0.018],[0.686,-0.054],[0.178,0.072],[0.064,0.286]],"o":[[0.169,-0.088],[-0.266,0.159],[-0.43,0.213],[-0.324,0.072],[-0.169,0.831],[0.264,0.828],[0.628,0.531],[0.926,-0.063],[-0.768,0.633],[0.44,-1.163],[-0.076,-0.144],[-0.686,0.054],[-0.83,-0.332],[-0.064,-0.286]],"v":[[513,174],[512.786,174.155],[511.673,174.761],[510.474,175.236],[510,175],[510.159,177.562],[511.515,179.675],[513.863,180.45],[517,179],[516.917,177.462],[518,175],[516.577,174.945],[515,175],[514.063,173.893]],"c":true}],"h":1},{"t":16,"s":[{"i":[[0.495,-0.167],[0.238,-0.739],[-0.536,-0.647],[-0.881,-0.209],[-0.798,0.574],[-0.002,0.258],[0.035,0.33],[0.02,0.282],[-0.049,0.114],[0.035,0.119],[0.202,0.023],[0.316,0.142],[0.375,0.477],[0.023,-0.089]],"o":[[-1.44,0.486],[-0.238,0.739],[0.536,0.647],[0.881,0.209],[0.093,-0.067],[0.002,-0.258],[-0.035,-0.33],[-0.02,-0.282],[0.185,-0.432],[-0.035,-0.119],[-0.202,-0.023],[-0.316,-0.142],[-0.413,-0.524],[-0.023,0.089]],"v":[[513,175],[510.59,176.924],[511.143,179.089],[513.375,180.46],[516,180],[516.129,179.483],[516.066,178.571],[515.969,177.624],[516,177],[516.211,176.227],[515.841,176.068],[515.05,175.875],[514,175],[513.562,174.482]],"c":true}],"h":1},{"t":17,"s":[{"i":[[0.484,-0.206],[0.21,-0.028],[0.174,-0.032],[0.127,-0.113],[0.07,-0.27],[-0.428,-0.419],[-0.665,-0.203],[-0.53,-0.057],[-0.021,0.019],[-0.07,0.429],[-0.1,0.538],[-0.105,0.34],[-0.085,-0.166],[0.815,-0.073]],"o":[[-0.235,0.1],[-0.21,0.028],[-0.174,0.032],[-0.127,0.113],[-0.182,0.707],[0.428,0.419],[0.665,0.203],[0.53,0.057],[0.015,-0.013],[0.07,-0.429],[0.1,-0.538],[0.105,-0.34],[-0.256,-0.499],[-0.815,0.073]],"v":[[512,177],[511.33,177.173],[510.752,177.244],[510.298,177.444],[510,178],[510.462,179.671],[512.196,180.588],[514.082,180.96],[515,181],[515.133,180.259],[515.394,178.731],[515.708,177.337],[516,177],[514.171,176.472]],"c":true}],"h":1},{"t":18,"s":[{"i":[[0.141,-0.083],[0.245,-0.318],[-0.01,-0.289],[-0.196,-0.25],[-0.311,-0.198],[-0.357,-0.135],[-0.333,-0.059],[-0.239,0.027],[-0.075,0.126],[-0.036,0.44],[0.175,0.324],[0.298,0.213],[0.334,0.109],[0.281,0.01]],"o":[[-0.57,0.334],[-0.245,0.318],[0.01,0.289],[0.196,0.25],[0.311,0.198],[0.357,0.135],[0.333,0.059],[0.239,-0.027],[0.334,-0.563],[0.036,-0.44],[-0.175,-0.324],[-0.298,-0.213],[-0.334,-0.109],[-0.281,-0.01]],"v":[[512,177],[510.794,177.981],[510.46,178.895],[510.787,179.706],[511.565,180.38],[512.585,180.882],[513.638,181.175],[514.513,181.227],[515,181],[515.533,179.497],[515.302,178.352],[514.57,177.547],[513.6,177.066],[512.656,176.889]],"c":true}],"h":1},{"t":19,"s":[{"i":[[0.473,-0.279],[0.193,-0.181],[0.243,-0.238],[0.178,-0.188],[0,-0.031],[-0.524,-0.332],[-0.661,0.213],[-0.431,0.564],[0.165,0.719],[0.185,0.078],[0.257,0.151],[0.193,0.123],[-0.005,-0.007],[0.041,-0.045]],"o":[[-0.031,0.018],[-0.193,0.181],[-0.242,0.238],[-0.178,0.188],[0.021,1.073],[0.524,0.332],[0.661,-0.213],[0.431,-0.564],[0.022,0.097],[-0.185,-0.078],[-0.257,-0.151],[-0.193,-0.123],[-0.364,-0.458],[-0.041,0.045]],"v":[[512,177],[511.636,177.326],[510.953,177.981],[510.294,178.646],[510,179],[510.909,181.059],[512.778,181.188],[514.508,179.974],[515,178],[514.722,178.003],[514.025,177.635],[513.316,177.199],[513,177],[512.581,176.447]],"c":true}],"h":1},{"t":20,"s":[{"i":[[-0.056,0.032],[0.142,-0.027],[0.15,-0.012],[0.14,-0.021],[0.11,-0.052],[0.061,-0.107],[-0.006,-0.185],[-0.551,-0.256],[-0.677,0.228],[-0.413,0.496],[0.242,0.545],[0.322,0.044],[0.357,-0.079],[0.231,-0.083]],"o":[[-0.115,0.066],[-0.142,0.027],[-0.15,0.012],[-0.14,0.021],[-0.11,0.052],[-0.061,0.107],[0.033,0.959],[0.551,0.256],[0.677,-0.228],[0.413,-0.496],[-0.127,-0.286],[-0.322,-0.044],[-0.357,0.079],[-0.231,0.083]],"v":[[512,178],[511.61,178.134],[511.167,178.188],[510.728,178.232],[510.349,178.335],[510.087,178.568],[510,179],[510.973,180.768],[512.913,180.756],[514.646,179.616],[515,178],[514.286,177.536],[513.226,177.619],[512.303,177.893]],"c":true}],"h":1},{"t":21.0000008553475,"s":[{"i":[[0.005,-0.002],[0.729,-0.654],[0.022,-0.36],[-0.678,-1.154],[-0.251,-0.019],[-1.188,0.265],[0.115,-0.108],[-0.236,1.257],[-0.024,-0.06],[0.699,-0.045],[0.154,0.061],[0.364,0.433],[0.339,0.186],[0.001,-0.248]],"o":[[-0.061,0.024],[-0.729,0.654],[0.038,-0.637],[0.678,1.155],[-0.638,-0.049],[1.188,-0.265],[0.032,-0.031],[0.236,-1.257],[-0.05,-0.12],[-0.699,0.046],[-0.205,-0.082],[-0.364,-0.433],[0.012,0.007],[-0.002,0.248]],"v":[[542,194],[540.471,195.248],[539,197],[540.341,198.507],[542,201],[543.608,200.382],[546,200],[546.506,197.433],[547,195],[545.578,194.956],[544,195],[543.101,194.078],[542,193],[542.013,193.503]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":2,"s":[0],"h":1},{"t":3,"s":[100],"h":1},{"t":22.0000008960784,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 3"},{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":4,"s":[{"i":[[2.948,-0.594],[0.441,-0.647],[0.516,-0.266],[-1.385,-3.67],[-2.571,-1.163],[-0.314,0.02],[-1.326,1.102],[-0.338,0.906],[-0.189,0.189],[3.426,2.064]],"o":[[-0.721,0.145],[-0.441,0.647],[-4.226,2.17],[1.147,3.042],[-0.382,-0.173],[0.783,-0.051],[0.687,-0.571],[0.061,-0.163],[3.508,-3.508],[-2.993,-1.803]],"v":[[532,142],[530.347,143.41],[529,145],[528,150],[530,155],[533,153],[537,154],[537,149],[539,148],[535,145]],"c":true}],"h":1},{"t":5,"s":[{"i":[[6.081,0.585],[2.069,-1.291],[0.921,-2.738],[-1.13,-2.036],[-0.371,-2.795],[-1.195,0.768],[-1.511,0.237],[-1.323,-0.311],[-1.287,1.023],[-0.771,7.284]],"o":[[0.199,4.1],[-2.069,1.29],[2.106,1.06],[1.13,2.036],[1.711,0.309],[1.194,-0.768],[1.421,-0.223],[1.323,0.311],[-3.245,-8.016],[-8.894,2.227]],"v":[[546,149],[542.34,156.021],[537,161],[541.801,165.699],[544,173],[548.15,171.91],[552,170],[556.101,170.6],[560,170],[561,154]],"c":true}],"h":1},{"t":6,"s":[{"i":[[3.437,-0.048],[0.497,-1.385],[1.112,-0.527],[0.883,-0.327],[0.119,-2.054],[-1.02,-2.151],[-0.154,-3.835],[-7.145,-2.587],[-2.489,5.013],[2.549,0.919]],"o":[[-0.9,1.932],[-0.497,1.385],[-1.351,0.639],[-0.883,0.327],[-0.081,1.406],[1.3,2.743],[6.18,-0.853],[-1.509,-6.911],[-2.819,-1.693],[-2.922,-1.053]],"v":[[545,156],[543.159,161.054],[541,164],[537.576,164.939],[536,168],[541,173],[542,180],[558,178],[560,162],[552,161]],"c":true}],"h":1},{"t":7,"s":[{"i":[[3.448,-0.833],[1.946,-1.439],[0.955,-2.492],[-1.038,-2.128],[-0.681,-2.486],[-0.989,0.932],[-1.271,0.202],[-3.595,1.242],[-1.745,6.24],[2.579,1.043]],"o":[[-0.262,3.751],[-1.946,1.439],[2.165,1.001],[1.038,2.128],[1.774,-0.072],[0.989,-0.932],[2.233,-0.354],[-2.628,-6.593],[-2.696,-2.358],[-2.517,-1.018]],"v":[[544,162],[540.02,168.945],[535,174],[539.613,178.887],[542,186],[545.878,184.097],[549,182],[557,183],[558,168],[550,167]],"c":true}],"h":1},{"t":8,"s":[{"i":[[3.448,-0.833],[1.567,-1.89],[0.876,-0.426],[1.187,-0.077],[-1.343,-3.403],[-1.978,-2.296],[-2.857,0.481],[-2.435,2.052],[-2.169,4.899],[2.579,1.043]],"o":[[-2.07,1.527],[-0.583,0.703],[-0.764,0.372],[0.457,3.793],[0.739,1.872],[3.022,-0.067],[2.741,-0.462],[-2.869,-5.389],[-2.696,-2.358],[-2.517,-1.018]],"v":[[543,167],[541,174],[537,175],[534,177],[540,184],[541,190],[548,187],[556,187],[557,173],[549,172]],"c":true}],"h":1},{"t":9,"s":[{"i":[[3.542,-1.354],[0.357,-1.363],[0.649,-0.683],[1.35,-0.326],[-0.202,-1.853],[-0.272,-5.395],[-7.097,-1.865],[-0.454,2.838],[0.638,2.826],[2.567,1.21]],"o":[[-0.924,0.864],[-0.357,1.363],[-0.801,0.844],[-1.35,0.326],[3.366,2.301],[5.866,-1.215],[1.881,-2.469],[0.373,-2.334],[-2.766,-2.493],[-2.11,-0.995]],"v":[[543,171],[541.294,174.635],[540,178],[536.247,179.243],[534,182],[540,193],[554,191],[553,183],[556,177],[548,176]],"c":true}],"h":1},{"t":10,"s":[{"i":[[4.825,1.175],[2.232,-1.178],[0.144,-2.099],[-1.074,-0.725],[-0.722,-0.847],[-0.057,-1.223],[-0.032,-1.238],[-6.169,-2.792],[-0.354,2.496],[1.765,3.703]],"o":[[0.071,4.188],[-2.232,1.178],[-0.017,0.251],[1.074,0.725],[0.741,0.87],[0.057,1.223],[5.353,-0.702],[2.295,-3.068],[0.322,-2.267],[-7.868,1.868]],"v":[[542,174],[537.661,181.067],[533,185],[534.946,186.553],[538,189],[539.033,192.224],[539,196],[553,194],[552,186],[555,179]],"c":true}],"h":1},{"t":11,"s":[{"i":[[3.062,-0.061],[1.459,-1.374],[2.034,-0.799],[-1.426,-1.574],[0.416,-3.416],[-1.88,0.581],[-3.548,-0.933],[-0.364,2.055],[-0.462,2.745],[1.487,1.513]],"o":[[-0.129,2.704],[-1.459,1.374],[0.711,2.289],[1.426,1.574],[2.933,-0.608],[1.88,-0.581],[-0.918,-3.034],[0.364,-2.055],[-3.992,0.992],[-1.487,-1.513]],"v":[[541,177],[538.429,182.929],[533,186],[536.845,191.155],[539,198],[545.538,195.845],[553,196],[552.465,188.783],[554,182],[546.802,180.198]],"c":true}],"h":1},{"t":12,"s":[{"i":[[4.825,1.175],[1.39,-1.443],[2.106,-0.728],[-1.153,-0.719],[-0.563,-1.331],[0.098,-0.986],[-1.002,-1.137],[-6.331,-2.1],[-0.492,2.777],[1.302,3.075]],"o":[[-0.334,2.499],[-1.39,1.443],[-0.176,1.791],[1.153,0.72],[0.389,0.919],[-0.098,0.986],[5.273,-1.14],[1.888,-2.547],[0.369,-2.083],[-7.868,1.868]],"v":[[541,179],[538.328,184.828],[533,188],[534.945,191.345],[538,194],[538.04,196.837],[539,200],[552,198],[551,190],[554,184]],"c":true}],"h":1},{"t":13,"s":[{"i":[[2.433,0.4],[1.546,-1.454],[1.536,-1.464],[-0.881,-1.785],[-0.523,-2.144],[-1.712,0.532],[-3.402,-0.813],[-0.385,2.02],[-0.475,2.344],[1.463,1.37]],"o":[[-0.28,2.72],[-1.546,1.454],[1.952,0.716],[0.881,1.785],[2.752,-0.685],[1.712,-0.532],[-1.016,-2.576],[0.385,-2.02],[-3.715,0.882],[-1.463,-1.37]],"v":[[541,181],[537.942,186.942],[533,191],[537.071,194.929],[539,201],[545.012,198.877],[552,199],[551.381,192.326],[553,186],[546.038,184.462]],"c":true}],"h":1},{"t":14,"s":[{"i":[[1.146,0.187],[1.224,-1.276],[1.853,-0.647],[-0.965,-0.653],[-0.429,-0.861],[-0.586,-2.306],[-5.257,-2.138],[-1.993,4.05],[2.172,1.098],[0.269,0.269]],"o":[[-0.253,2.247],[-1.224,1.276],[-0.288,1.529],[0.965,0.653],[0.864,1.733],[3.885,-1.753],[-1.03,-5.176],[-2.101,-2.311],[-0.196,-0.099],[-0.667,-0.667]],"v":[[541,183],[538.7,188.2],[534,191],[535.462,194.001],[538,196],[539,202],[551,200],[552,188],[545,187],[544,184]],"c":true}],"h":1},{"t":15,"s":[{"i":[[3.436,1.231],[1.018,-1.148],[1.832,-0.334],[-0.827,-0.832],[-0.592,-1.135],[-0.04,-0.643],[-1.337,-0.462],[-1.713,0.208],[-2.607,1.448],[-0.914,4.365]],"o":[[-0.094,2.073],[-1.018,1.148],[0.099,1.537],[0.827,0.832],[0.505,0.967],[0.04,0.643],[0.117,0.04],[2.999,-0.364],[-1.91,-4.894],[-6.206,1.539]],"v":[[541,185],[539.304,189.804],[535,192],[536.63,195.301],[539,198],[539.376,200.379],[541,202],[545,199],[550,200],[551,189]],"c":true}],"h":1},{"t":16,"s":[{"i":[[3.001,-1.073],[0.085,-0.649],[0.278,-0.269],[0.41,-0.142],[-1.677,-3.066],[0.045,0.023],[-2.567,0.097],[-0.997,1.103],[-0.313,0.564],[2.524,0.763]],"o":[[-0.381,0.136],[-0.085,0.649],[-0.297,0.288],[-4.345,1.504],[0.034,0.063],[1.604,0.833],[0.531,-0.02],[0.191,-0.211],[1.797,-3.235],[-3.325,-1.006]],"v":[[541,189],[540.423,190.4],[540,192],[538,192],[539,197],[540,201],[545,199],[549,200],[549,193],[546,191]],"c":true}],"h":1},{"t":17,"s":[{"i":[[0.063,-0.036],[0.203,-0.284],[0.311,-1.057],[-0.907,-1.65],[-3.996,0.685],[-0.958,1.712],[-0.111,1.365],[1.008,1.414],[0.643,0.252],[0.192,0.218]],"o":[[-0.278,0.158],[-0.508,0.711],[-0.438,1.485],[2.308,4.199],[1.125,-0.193],[0.718,-1.283],[0.016,-0.2],[-0.362,-0.509],[-0.237,-0.093],[-0.834,-0.949]],"v":[[541,191],[541,193],[538,194],[540,198],[545,199],[548,199],[547,195],[548,192],[544,192],[544,190]],"c":true}],"h":1},{"t":18,"s":[{"i":[[0.005,-0.002],[-0.037,-0.33],[0.435,-0.433],[0.61,-0.121],[0.054,-1.011],[0.071,0.023],[-1.333,-0.178],[-0.642,3.637],[0.584,1.002],[0.352,0.274]],"o":[[-0.715,0.247],[0.037,0.33],[-0.506,0.504],[-0.61,0.121],[-0.005,0.094],[-0.224,-0.072],[3.104,0.415],[0.133,-0.754],[0.598,1.026],[0.031,0.024]],"v":[[542,192],[541.29,192.861],[541,194],[539.161,194.619],[538,196],[542,201],[545,199],[547,196],[548,193],[542,191]],"c":true}],"h":1},{"t":19,"s":[{"i":[[1.867,-0.765],[0.657,-0.405],[0.075,-0.257],[-0.689,-1.303],[-0.424,-0.179],[-0.517,0.471],[-0.168,0.017],[-0.5,0.701],[0,0.488],[3.816,1.527]],"o":[[-0.298,0.122],[-0.657,0.405],[-0.179,0.611],[0.689,1.303],[-0.236,-0.1],[0.517,-0.471],[0.447,-0.047],[0.688,-0.964],[0,-3.662],[-1.735,-0.694]],"v":[[542,193],[540.333,193.899],[539,195],[540.048,198.324],[542,201],[542.697,199.938],[544,199],[547,200],[546,197],[544,194]],"c":true}],"h":1},{"t":20.0000008146167,"s":[{"i":[[0.011,-0.004],[-0.001,-0.369],[0.391,-0.276],[0.467,0.042],[0.031,-0.096],[-0.751,-1.301],[-0.229,-0.073],[-0.651,0.937],[-0.351,-0.593],[-0.913,-0.502]],"o":[[-0.614,0.248],[0.001,0.369],[-0.102,0.072],[-0.467,-0.042],[-0.231,0.722],[0.751,1.301],[0.249,0.079],[-0.828,1.192],[0.643,1.086],[0.023,0.013]],"v":[[542,193],[541.333,193.979],[541,195],[539.946,194.982],[539,195],[540.155,198.487],[542,201],[547,199],[547,194],[542,192]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":3,"s":[0],"h":1},{"t":4,"s":[100],"h":1},{"t":21.0000008553475,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 4"}],"sw":1125,"sh":207,"sc":"#ffd200","ip":0,"op":900.000036657751,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":1,"nm":"star02","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[562.5,103.5,0],"ix":2,"l":2},"a":{"a":0,"k":[562.5,103.5,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"hasMask":true,"masksProperties":[{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":1,"s":[{"i":[[-1.765,4.392],[0.24,2.704],[1.131,1.229],[0.899,0.223],[0.248,-0.059],[0.574,-0.655],[0.558,-0.345],[0.915,-0.384],[0.646,-0.036],[1.41,0.582],[1.57,-0.284],[0.179,-0.636],[0.566,-0.328],[1.035,0.222],[0.612,-1.163],[-0.608,-1.392],[0.308,-2.308],[1.415,-0.585],[1.381,-0.618],[-1.201,-4.476],[-0.033,-1.392],[-3.3,-5.94],[-2.115,-1.394],[-2.731,-0.725],[-0.666,0.27],[-2.105,-0.483],[-3.004,-0.722],[-3.822,-0.453],[-1.661,2.865],[1.439,4.96],[2.352,4.347],[1.063,1.215],[2.102,1.367]],"o":[[-3.91,2.046],[-0.24,-2.704],[-0.154,-0.167],[-0.899,-0.223],[-0.147,0.035],[-0.574,0.655],[-0.693,0.428],[-0.915,0.384],[-0.791,0.044],[-1.41,-0.582],[-0.716,0.13],[-0.179,0.636],[-1.247,0.724],[-1.035,-0.222],[-0.122,2.123],[0.608,1.392],[-1.96,0.04],[-1.415,0.585],[0.709,4.244],[0.261,0.971],[0.311,12.996],[2.121,3.818],[2.656,1.751],[1.593,0.423],[4.62,-1.873],[2.796,0.642],[3.328,0.8],[2.883,-2.828],[1.519,-2.62],[-1.036,-2.889],[-0.474,-0.876],[-1.692,-1.935],[-4.028,-2.62]],"v":[[590,92],[584.916,89.456],[584,82],[582.071,81.33],[580,81],[578.808,82.267],[577,84],[574.465,85.294],[572,86],[568.584,84.82],[564,84],[562.887,85.351],[562,87],[558.523,87.17],[556,88],[557.139,92.861],[558,98],[553.066,99.066],[549,101],[555,110],[554,113],[567,117],[572,118],[577,124],[580,123],[582,126],[591,126],[599,131],[601,122],[608,115],[601,110],[600,104],[594,101]],"c":true}],"h":1},{"t":2,"s":[{"i":[[-1.308,6.088],[3.236,-0.153],[3.262,0.579],[0.754,-2.904],[-0.682,-1.561],[-5.209,-3.181],[-1.259,-1.428],[-0.253,-1.811],[0.023,0],[2.714,-1.918],[3.426,-2.066],[2.328,-2.045],[2.483,-10.15],[-3.351,-3.953],[-0.427,-0.679],[-0.612,-0.248],[-4.239,-3.573],[-4.174,2.842],[0.518,-5.565],[-3.059,-0.79],[-4.347,0.844],[-1.789,2.856],[-0.729,0.549],[0.279,2.559],[1.678,2.418],[2.116,2.344],[2.614,5.625],[0.204,-0.319],[0.084,5.696],[0.601,0.464],[1.037,1.948],[4.164,2.033],[4.035,0.569]],"o":[[-3.803,-0.925],[-2.621,0.124],[-3.356,3.929],[-0.127,0.487],[1.458,3.339],[0.726,0.443],[2.171,2.464],[0.129,0.919],[-1.067,-0.002],[-3.434,1.861],[-1.968,1.187],[0.999,6.668],[8.825,-2.933],[1.297,1.53],[0.42,0.668],[3.815,1.546],[1.602,-2.332],[3.57,4.598],[3.501,3.014],[2.92,0.754],[2.599,-3.067],[-0.061,0.098],[1.737,-1.309],[-2.328,-1.875],[-1.668,-2.402],[-3.699,0.805],[-0.031,-0.066],[2.65,-4.145],[-0.04,-2.7],[-1.684,-1.299],[-1.879,-3.531],[-3.42,-1.67],[-4.364,-0.615]],"v":[[599,72],[590,75],[582,73],[582,83],[577,90],[587,93],[589,97],[593,100],[590,105],[586,101],[580,109],[573,111],[579,128],[595,129],[598,132],[599,136],[609,134],[610,124],[610,138],[619,138],[627,143],[629,134],[633,132],[636,128],[629,123],[626,115],[614,119],[616,111],[628,102],[623,98],[618,93],[615,81],[605,86]],"c":true}],"h":1},{"t":3,"s":[{"i":[[1.992,2.527],[1.279,-0.822],[1.608,-0.035],[1.283,0.618],[1.767,-0.447],[-0.619,-1.62],[0.241,-1.215],[1.243,-1.096],[-0.274,-2.1],[-1.019,0.195],[-1.462,-0.556],[-0.998,-1.517],[-1.664,-0.042],[-0.252,0.673],[-0.909,-0.664],[0.731,-0.827],[-2.067,-0.715],[-0.419,-0.753],[-3.218,-1.94],[-3.864,-5.269],[-1.005,-0.303],[-3.411,1.023],[-0.731,0.957],[0.182,5.789],[1.087,0.901],[0.763,4.12],[1.334,0.825],[3.848,-0.731],[2.146,-0.273],[1.954,0.44],[-0.393,1.973],[-2.322,1.345],[1.087,3.742]],"o":[[-2.276,-0.325],[-1.279,0.822],[-1.101,0.024],[-1.283,-0.618],[-1.235,1.305],[0.619,1.62],[-0.302,1.516],[-1.243,1.096],[1.461,1.225],[1.019,-0.195],[2.342,0.89],[0.998,1.517],[1.082,0.028],[0.252,-0.673],[-0.144,1.977],[-0.731,0.827],[1.378,0.477],[2.912,5.241],[2.691,6.7],[1.67,2.278],[3.388,1.021],[3.191,-0.957],[4.194,-5.494],[-0.068,-2.148],[-3.021,-2.505],[0.212,1.143],[-4.047,-2.503],[-3.23,0.613],[-2.253,0.287],[-1.102,-0.248],[2.322,-1.345],[0.158,-4.278],[-0.619,-2.13]],"v":[[612,64],[606.999,65.23],[603,67],[599.499,65.683],[595,65],[594.755,69.568],[596,74],[593.068,77.562],[591,82],[594.499,83.001],[598,83],[602.508,87.136],[606,90],[607.629,88.523],[609,88],[606.842,91.947],[608,94],[611,97],[618,96],[614,112],[626,112],[637,121],[641,110],[653,101],[648,97],[642,88],[641,81],[628,87],[617,85],[613,87],[610,83],[618,80],[613,71]],"c":true}],"h":1},{"t":4,"s":[{"i":[[-0.557,2.224],[0.487,-0.007],[0.414,-0.112],[0.36,-0.182],[0.324,-0.217],[0.308,-0.218],[0.311,-0.184],[0.332,-0.116],[0.373,-0.013],[0.445,0.172],[0.465,0.25],[0.526,0.218],[0.628,0.077],[0.773,-0.175],[-0.081,-1.087],[-0.097,-0.837],[0.032,-0.582],[0.307,-0.321],[0.379,-0.4],[0.287,-0.446],[0.139,-0.573],[-0.063,-0.782],[-1.333,-0.546],[-0.922,-0.822],[-0.878,-0.865],[-1.201,-0.674],[-0.64,1.11],[-0.903,0.847],[-1.187,0.563],[-1.491,0.259],[0.67,0.996],[0.728,0.939],[0.319,1.348]],"o":[[-0.58,-0.133],[-0.487,0.007],[-0.414,0.112],[-0.36,0.182],[-0.324,0.217],[-0.308,0.218],[-0.311,0.184],[-0.332,0.116],[-0.467,0.016],[-0.445,-0.172],[-0.465,-0.25],[-0.526,-0.218],[-0.628,-0.077],[-0.082,1.331],[0.081,1.087],[0.097,0.837],[-0.032,0.582],[-0.417,0.435],[-0.379,0.4],[-0.287,0.446],[-0.139,0.573],[2.112,0.037],[1.333,0.546],[0.922,0.822],[0.878,0.865],[0.396,-1.354],[0.64,-1.11],[0.903,-0.847],[1.187,-0.563],[-0.146,-1.52],[-0.67,-0.996],[-0.728,-0.939],[-0.319,-1.348]],"v":[[623,58],[621.405,57.82],[620.057,58.007],[618.901,58.456],[617.88,59.064],[616.936,59.726],[616.012,60.339],[615.053,60.798],[614,61],[612.642,60.739],[611.287,60.079],[609.812,59.349],[608.091,58.88],[606,59],[606.035,62.628],[606.338,65.515],[606.472,67.645],[606,69],[604.792,70.232],[603.779,71.48],[603.127,72.988],[603,75],[608.076,75.934],[611.367,78.046],[613.974,80.634],[617,83],[618.549,79.299],[620.858,76.358],[623.988,74.238],[628,73],[626.659,69.342],[624.445,66.555],[622.759,63.241]],"c":true}],"h":1},{"t":5,"s":[{"i":[[-1.113,4.447],[0.843,-0.23],[0.652,-0.436],[0.608,-0.363],[0.712,-0.01],[0.465,0.277],[0.512,0.324],[0.666,0.135],[0.926,-0.29],[0.018,-0.727],[-0.144,-0.727],[-0.089,-0.762],[0.18,-0.831],[0.452,-0.522],[0.457,-0.518],[0.152,-0.612],[-0.465,-0.803],[-0.718,-0.064],[-0.695,0.031],[-0.629,-0.045],[-0.522,-0.294],[-0.001,-0.172],[0.022,-0.224],[0.012,-0.19],[-0.032,-0.07],[-0.408,-0.421],[-0.517,-0.406],[-0.476,-0.282],[-0.283,-0.048],[-0.911,1.311],[-1.347,0.875],[-2.156,0.066],[1.455,1.878]],"o":[[-1.181,-0.255],[-0.843,0.23],[-0.652,0.436],[-0.608,0.363],[-0.525,0.007],[-0.465,-0.277],[-0.512,-0.324],[-0.666,-0.135],[-0.394,0.761],[-0.018,0.727],[0.144,0.727],[0.089,0.762],[-0.135,0.623],[-0.452,0.522],[-0.457,0.518],[-0.152,0.612],[0.699,0.331],[0.718,0.064],[0.695,-0.031],[0.629,0.045],[0.058,0.032],[0.001,0.172],[-0.022,0.224],[-0.012,0.19],[0.148,0.328],[0.408,0.421],[0.517,0.406],[0.476,0.282],[0.848,-1.374],[0.911,-1.311],[1.347,-0.875],[-0.293,-3.041],[-1.455,-1.878]],"v":[[631,53],[628.001,53.033],[625.797,54.103],[623.944,55.372],[622,56],[620.541,55.536],[619.102,54.575],[617.361,53.826],[615,54],[614.436,56.222],[614.679,58.394],[615.083,60.619],[615,63],[614.042,64.694],[612.6,66.23],[611.608,67.902],[612,70],[614.136,70.549],[616.265,70.555],[618.262,70.533],[620,71],[620.08,71.328],[620.039,71.944],[619.979,72.588],[620,73],[620.871,74.151],[622.297,75.419],[623.824,76.478],[625,77],[627.546,72.879],[630.839,69.506],[636,68],[632.446,61.555]],"c":true}],"h":1},{"t":6,"s":[{"i":[[0.913,1.073],[0.736,-0.25],[0.58,-0.407],[0.554,-0.328],[0.659,-0.013],[0.473,0.275],[0.53,0.324],[0.667,0.137],[0.882,-0.285],[0.031,-0.635],[-0.138,-0.688],[-0.1,-0.709],[0.146,-0.699],[0.369,-0.6],[0.433,-0.528],[0.347,-0.539],[0.113,-0.632],[-0.767,-0.158],[-0.714,-0.004],[-0.715,-0.093],[-0.771,-0.427],[-0.001,-0.172],[0.022,-0.225],[0.012,-0.191],[-0.031,-0.069],[-0.649,-0.475],[-0.802,-0.251],[-0.719,0.093],[-1.948,1.219],[-2.118,1.049],[1.031,1.078],[0.563,1.885],[-0.047,1.003]],"o":[[-1.022,-0.143],[-0.736,0.25],[-0.58,0.407],[-0.554,0.328],[-0.496,0.01],[-0.474,-0.275],[-0.53,-0.324],[-0.667,-0.137],[-0.408,0.55],[-0.031,0.635],[0.138,0.688],[0.1,0.709],[-0.157,0.755],[-0.369,0.6],[-0.433,0.528],[-0.347,0.539],[0.873,0.557],[0.767,0.158],[0.714,0.004],[0.715,0.093],[0.057,0.032],[0.001,0.172],[-0.022,0.225],[-0.012,0.191],[0.262,0.581],[0.649,0.475],[0.802,0.251],[0.091,-3.076],[1.948,-1.219],[-0.312,-1.805],[-1.031,-1.078],[-0.274,-0.915],[0.047,-1.003]],"v":[[637,49],[634.396,49.22],[632.455,50.266],[630.787,51.429],[629,52],[627.566,51.544],[626.08,50.587],[624.304,49.836],[622,50],[621.393,51.785],[621.607,53.777],[622.016,55.88],[622,58],[621.173,60.012],[619.933,61.684],[618.727,63.264],[618,65],[620.446,66.013],[622.654,66.195],[624.785,66.28],[627,67],[627.079,67.327],[627.039,67.944],[626.98,68.589],[627,69],[628.425,70.614],[630.661,71.733],[633,72],[636.48,65.98],[643,63],[640.688,59.06],[638,55],[637.98,52.119]],"c":true}],"h":1},{"t":7,"s":[{"i":[[-0.474,2.057],[0.681,-0.147],[0.626,-0.134],[0.598,-0.109],[0.596,-0.073],[0.621,-0.025],[0.672,0.035],[0.749,0.107],[0.853,0.189],[-0.098,-0.872],[0.032,-0.674],[0.132,-0.537],[0.203,-0.461],[0.245,-0.447],[0.257,-0.494],[0.24,-0.603],[0.194,-0.772],[-0.566,-0.118],[-0.544,0.025],[-0.522,0.053],[-0.5,-0.035],[-0.479,-0.238],[-0.357,-0.693],[-0.367,-0.746],[-0.576,-0.43],[-0.986,0.254],[-0.536,1.048],[-0.855,0.729],[-1.142,0.442],[-1.397,0.187],[0.691,0.893],[0.645,0.938],[0.257,1.326]],"o":[[-0.763,0.149],[-0.681,0.147],[-0.626,0.134],[-0.598,0.109],[-0.596,0.073],[-0.621,0.025],[-0.672,-0.035],[-0.749,-0.107],[0.256,1.132],[0.098,0.872],[-0.032,0.674],[-0.132,0.537],[-0.203,0.461],[-0.245,0.447],[-0.257,0.494],[-0.24,0.603],[0.589,0.377],[0.566,0.118],[0.544,-0.025],[0.522,-0.053],[0.5,0.035],[0.547,0.272],[0.357,0.693],[0.367,0.746],[0.576,0.43],[0.185,-1.398],[0.536,-1.048],[0.855,-0.729],[1.142,-0.442],[-0.394,-1.19],[-0.691,-0.893],[-0.645,-0.938],[-0.257,-1.326]],"v":[[643,46],[640.841,46.447],[638.886,46.871],[637.056,47.239],[635.271,47.515],[633.452,47.664],[631.521,47.651],[629.396,47.441],[627,47],[627.523,49.991],[627.614,52.295],[627.361,54.097],[626.851,55.579],[626.173,56.927],[625.413,58.323],[624.659,59.953],[624,62],[625.733,62.713],[627.399,62.823],[628.998,62.676],[630.531,62.62],[632,63],[633.306,64.54],[634.342,66.789],[635.707,68.645],[638,69],[639.089,65.339],[641.182,62.683],[644.185,60.935],[648,60],[646.288,56.962],[644.199,54.301],[642.76,50.99]],"c":true}],"h":1},{"t":8,"s":[{"i":[[-1.329,0.255],[0.5,0.7],[0.571,0.629],[0.45,0.75],[0.135,1.065],[-0.374,1.574],[0.723,-0.079],[0.716,-0.406],[0.76,-0.374],[0.854,0.017],[0.451,0.194],[0.424,0.251],[0.511,0.181],[0.712,-0.014],[0.011,-0.652],[-0.114,-0.659],[-0.067,-0.678],[0.149,-0.709],[0.362,-0.543],[0.386,-0.527],[0.205,-0.595],[-0.178,-0.748],[-0.589,-0.114],[-0.567,0.093],[-0.57,0.036],[-0.596,-0.286],[-0.365,-0.671],[-0.334,-0.714],[-0.552,-0.436],[-1.018,0.163],[-0.574,1.01],[-0.849,0.734],[-1.101,0.483]],"o":[[-0.235,-0.965],[-0.5,-0.7],[-0.571,-0.629],[-0.45,-0.75],[-0.135,-1.065],[-0.782,-0.606],[-0.723,0.079],[-0.716,0.406],[-0.76,0.374],[-0.592,-0.012],[-0.451,-0.194],[-0.424,-0.251],[-0.511,-0.181],[-0.305,0.657],[-0.011,0.652],[0.114,0.659],[0.067,0.678],[-0.135,0.644],[-0.362,0.543],[-0.386,0.527],[-0.205,0.595],[0.634,0.587],[0.589,0.114],[0.567,-0.093],[0.57,-0.036],[0.644,0.309],[0.365,0.671],[0.334,0.714],[0.552,0.436],[0.275,-1.308],[0.574,-1.01],[0.849,-0.734],[1.101,-0.483]],"v":[[652,57],[650.849,54.551],[649.194,52.606],[647.615,50.585],[646.69,47.91],[647,44],[644.755,43.3],[642.609,44.117],[640.408,45.376],[638,46],[636.464,45.659],[635.18,44.961],[633.806,44.282],[632,44],[631.568,45.959],[631.766,47.921],[632.08,49.923],[632,52],[631.202,53.76],[630.029,55.345],[629.091,57.007],[629,59],[630.828,59.986],[632.556,59.952],[634.256,59.692],[636,60],[637.451,61.55],[638.438,63.707],[639.706,65.511],[642,66],[643.279,62.529],[645.419,59.919],[648.349,58.1]],"c":true}],"h":1},{"t":9,"s":[{"i":[[-0.467,1.967],[0.304,0.076],[0.307,-0.051],[0.314,-0.14],[0.324,-0.189],[0.338,-0.198],[0.355,-0.168],[0.376,-0.098],[0.4,0.011],[0.378,0.136],[0.349,0.195],[0.366,0.19],[0.43,0.12],[0.54,-0.013],[0.055,-0.658],[-0.165,-0.652],[-0.138,-0.668],[0.138,-0.705],[0.389,-0.515],[0.413,-0.512],[0.192,-0.616],[-0.273,-0.827],[-1.088,-0.412],[-0.787,-0.713],[-0.806,-0.694],[-1.144,-0.355],[-0.587,0.913],[-0.735,0.765],[-1.031,0.469],[-1.474,0.026],[0.67,0.83],[0.668,0.832],[0.289,1.211]],"o":[[-0.304,-0.244],[-0.304,-0.076],[-0.307,0.051],[-0.314,0.14],[-0.324,0.189],[-0.338,0.198],[-0.355,0.168],[-0.376,0.098],[-0.455,-0.012],[-0.378,-0.136],[-0.349,-0.195],[-0.366,-0.19],[-0.43,-0.12],[-0.523,0.685],[-0.055,0.658],[0.165,0.652],[0.138,0.668],[-0.122,0.623],[-0.389,0.515],[-0.413,0.512],[-0.192,0.616],[1.708,-0.208],[1.088,0.412],[0.787,0.713],[0.806,0.694],[0.587,-0.913],[0.587,-0.913],[0.735,-0.765],[1.031,-0.469],[-0.294,-1.206],[-0.67,-0.83],[-0.668,-0.832],[-0.289,-1.211]],"v":[[650,42],[649.089,41.53],[648.173,41.502],[647.243,41.799],[646.287,42.301],[645.295,42.891],[644.257,43.45],[643.162,43.859],[642,44],[640.762,43.762],[639.684,43.251],[638.624,42.658],[637.443,42.177],[636,42],[635.194,44.009],[635.421,45.97],[635.938,47.945],[636,50],[635.172,51.681],[633.908,53.195],[632.94,54.862],[633,57],[637.113,57.387],[639.845,59.155],[642.154,61.346],[645,63],[646.723,60.223],[648.669,57.669],[651.28,55.78],[655,55],[653.46,52.04],[651.359,49.641],[649.828,46.672]],"c":true}],"h":1},{"t":10,"s":[{"i":[[-0.489,1.905],[0.65,-0.13],[0.596,-0.14],[0.566,-0.13],[0.56,-0.098],[0.579,-0.045],[0.622,0.029],[0.689,0.124],[0.78,0.241],[-0.129,-0.694],[0.001,-0.592],[0.1,-0.525],[0.167,-0.492],[0.203,-0.493],[0.207,-0.529],[0.181,-0.599],[0.122,-0.704],[-0.736,-0.113],[-0.561,-0.219],[-0.437,-0.293],[-0.364,-0.335],[-0.342,-0.345],[-0.371,-0.323],[-0.452,-0.27],[-0.583,-0.184],[-0.394,0.739],[-0.54,0.593],[-0.677,0.456],[-0.804,0.329],[-0.922,0.211],[0.537,0.88],[0.61,0.807],[0.268,1.148]],"o":[[-0.728,0.098],[-0.65,0.13],[-0.596,0.14],[-0.566,0.13],[-0.56,0.098],[-0.579,0.045],[-0.622,-0.029],[-0.689,-0.124],[0.29,0.83],[0.129,0.694],[-0.001,0.592],[-0.1,0.525],[-0.167,0.492],[-0.203,0.493],[-0.207,0.529],[-0.181,0.599],[0.962,-0.025],[0.736,0.113],[0.561,0.219],[0.437,0.293],[0.364,0.335],[0.342,0.345],[0.371,0.323],[0.452,0.27],[0.238,-0.895],[0.394,-0.739],[0.54,-0.593],[0.677,-0.456],[0.804,-0.329],[-0.049,-1.368],[-0.537,-0.88],[-0.61,-0.807],[-0.268,-1.148]],"v":[[653,40],[650.938,40.346],[649.075,40.757],[647.339,41.168],[645.655,41.515],[643.952,41.736],[642.158,41.766],[640.198,41.542],[638,41],[638.621,43.277],[638.805,45.196],[638.646,46.862],[638.239,48.378],[637.676,49.846],[637.053,51.371],[636.463,53.054],[636,55],[638.533,55.14],[640.464,55.647],[641.948,56.424],[643.136,57.374],[644.182,58.404],[645.239,59.415],[646.461,60.312],[648,61],[648.95,58.55],[650.355,56.554],[652.184,54.983],[654.408,53.808],[657,53],[656.018,49.732],[654.194,47.306],[652.773,44.477]],"c":true}],"h":1},{"t":11,"s":[{"i":[[0.894,0.698],[0.386,-0.322],[0.415,-0.197],[0.449,-0.096],[0.487,-0.019],[0.531,0.034],[0.579,0.062],[0.632,0.066],[0.69,0.046],[0.036,-1.03],[0.21,-0.856],[0.316,-0.751],[0.352,-0.714],[0.32,-0.746],[-0.693,-0.154],[-0.683,-0.033],[-0.648,-0.113],[-0.59,-0.393],[-0.088,-0.266],[-0.093,-0.344],[-0.083,-0.281],[-0.06,-0.076],[-0.255,-0.164],[-0.288,-0.147],[-0.264,-0.16],[-0.182,-0.202],[-0.72,0.947],[-1,0.667],[-1.03,0.636],[-0.811,0.855],[0.658,0.962],[0.277,1.251],[0.355,1.163]],"o":[[-0.361,0.471],[-0.386,0.322],[-0.415,0.197],[-0.449,0.096],[-0.487,0.019],[-0.531,-0.034],[-0.579,-0.062],[-0.632,-0.066],[0.206,1.273],[-0.036,1.03],[-0.21,0.856],[-0.316,0.751],[-0.352,0.714],[0.679,0.475],[0.693,0.154],[0.683,0.033],[0.648,0.113],[0.069,0.046],[0.088,0.266],[0.093,0.344],[0.083,0.281],[0.164,0.21],[0.255,0.164],[0.288,0.147],[0.264,0.16],[0.19,-1.477],[0.72,-0.947],[1,-0.667],[1.03,-0.636],[-1.5,-0.297],[-0.658,-0.962],[-0.277,-1.251],[-0.355,-1.163]],"v":[[653,38],[651.88,39.183],[650.681,39.955],[649.387,40.387],[647.985,40.553],[646.46,40.524],[644.797,40.374],[642.982,40.175],[641,40],[641.238,43.438],[640.85,46.25],[640.045,48.645],[639.026,50.826],[638,53],[640.064,53.893],[642.133,54.123],[644.136,54.291],[646,55],[646.239,55.503],[646.514,56.454],[646.782,57.428],[647,58],[647.643,58.554],[648.472,59.012],[649.316,59.465],[650,60],[651.427,56.427],[654.068,54.068],[657.175,52.175],[660,50],[656.879,48.018],[655.591,44.603],[654.758,40.887]],"c":true}],"h":1},{"t":12,"s":[{"i":[[-0.412,1.745],[0.625,-0.116],[0.554,-0.134],[0.513,-0.129],[0.503,-0.102],[0.523,-0.052],[0.572,0.021],[0.652,0.116],[0.763,0.234],[-0.032,-0.698],[0.068,-0.599],[0.142,-0.524],[0.192,-0.475],[0.216,-0.451],[0.216,-0.451],[0.19,-0.477],[0.139,-0.527],[-0.736,-0.113],[-0.561,-0.219],[-0.437,-0.293],[-0.364,-0.335],[-0.342,-0.345],[-0.371,-0.323],[-0.452,-0.27],[-0.583,-0.184],[-0.422,0.712],[-0.546,0.587],[-0.665,0.469],[-0.777,0.356],[-0.884,0.249],[0.557,0.776],[0.532,0.801],[0.209,1.124]],"o":[[-0.726,0.076],[-0.625,0.116],[-0.554,0.134],[-0.513,0.129],[-0.503,0.102],[-0.523,0.052],[-0.572,-0.021],[-0.652,-0.116],[0.156,0.823],[0.032,0.698],[-0.068,0.599],[-0.142,0.524],[-0.192,0.475],[-0.216,0.451],[-0.216,0.451],[-0.19,0.477],[0.962,-0.025],[0.736,0.113],[0.561,0.219],[0.437,0.293],[0.364,0.335],[0.342,0.345],[0.371,0.323],[0.452,0.27],[0.292,-0.842],[0.422,-0.712],[0.546,-0.587],[0.665,-0.469],[0.777,-0.356],[-0.284,-1.05],[-0.557,-0.776],[-0.532,-0.801],[-0.209,-1.124]],"v":[[657,38],[654.981,38.293],[653.22,38.674],[651.627,39.075],[650.11,39.428],[648.579,39.665],[646.945,39.718],[645.115,39.519],[643,39],[643.275,41.275],[643.215,43.215],[642.893,44.893],[642.386,46.386],[641.768,47.768],[641.114,49.114],[640.5,50.5],[640,52],[642.533,52.14],[644.464,52.647],[645.948,53.424],[647.136,54.374],[648.182,55.404],[649.239,56.415],[650.461,57.312],[652,58],[653.071,55.671],[654.525,53.724],[656.342,52.142],[658.506,50.906],[661,50],[659.664,47.336],[657.956,45.044],[656.77,42.23]],"c":true}],"h":1},{"t":13,"s":[{"i":[[0.826,0.085],[0.644,-0.39],[0.713,-0.109],[0.772,0.103],[0.821,0.245],[0.86,0.318],[0.056,-1.194],[0.252,-0.998],[0.445,-0.805],[0.636,-0.614],[-0.553,-0.16],[-0.556,-0.005],[-0.6,-0.092],[-0.684,-0.422],[-0.266,-0.456],[-0.196,-0.431],[-0.332,-0.259],[-0.674,0.059],[-0.309,0.351],[-0.228,0.511],[-0.305,0.53],[-0.541,0.407],[-0.377,0.145],[-0.366,0.076],[-0.431,0.143],[-0.572,0.347],[0.277,0.492],[0.445,0.398],[0.446,0.457],[0.278,0.67],[-0.037,0.616],[-0.001,0.623],[0.287,0.446]],"o":[[-0.566,0.742],[-0.644,0.39],[-0.713,0.109],[-0.772,-0.103],[-0.821,-0.245],[0.143,1.394],[-0.056,1.194],[-0.252,0.998],[-0.445,0.805],[0.591,0.559],[0.553,0.16],[0.556,0.005],[0.6,0.092],[0.543,0.335],[0.266,0.456],[0.196,0.431],[0.332,0.259],[0.548,-0.048],[0.309,-0.351],[0.228,-0.511],[0.305,-0.53],[0.464,-0.349],[0.377,-0.145],[0.366,-0.076],[0.431,-0.143],[0.06,-0.739],[-0.277,-0.492],[-0.445,-0.398],[-0.446,-0.457],[-0.177,-0.425],[0.037,-0.616],[0.001,-0.623],[-0.287,-0.446]],"v":[[656,37],[654.182,38.681],[652.144,39.412],[649.915,39.402],[647.524,38.862],[645,38],[645.131,41.881],[644.669,45.169],[643.623,47.873],[642,50],[643.706,51.018],[645.361,51.205],[647.084,51.29],[649,52],[650.163,53.224],[650.804,54.591],[651.544,55.663],[653,56],[654.247,55.367],[655.012,54.038],[655.771,52.441],[657,51],[658.242,50.293],[659.337,49.997],[660.514,49.702],[662,49],[661.632,47.193],[660.507,45.897],[659.128,44.652],[658,43],[657.854,41.393],[657.974,39.489],[657.607,37.841]],"c":true}],"h":1},{"t":14,"s":[{"i":[[-1.079,-0.171],[-0.066,0.349],[-0.043,0.314],[-0.092,0.304],[-0.212,0.322],[-0.404,0.366],[-0.494,0.124],[-0.528,0.093],[-0.395,0.173],[-0.096,0.362],[0.18,0.42],[0.339,0.465],[0.365,0.563],[0.257,0.712],[0.036,0.484],[0.05,0.42],[0.239,0.351],[0.604,0.276],[0.241,-0.192],[0.385,-0.235],[0.327,-0.175],[0.067,-0.013],[0.619,0.039],[0.583,0.133],[0.548,0.153],[0.514,0.098],[0.117,-1.049],[0.301,-0.866],[0.283,-0.884],[0.064,-1.102],[-0.9,-0.35],[-0.581,-0.669],[-0.641,-0.609]],"o":[[0.161,-0.412],[0.066,-0.349],[0.043,-0.314],[0.092,-0.304],[0.212,-0.322],[0.293,-0.265],[0.494,-0.124],[0.528,-0.093],[0.395,-0.173],[0.113,-0.427],[-0.18,-0.42],[-0.339,-0.465],[-0.365,-0.563],[-0.196,-0.544],[-0.036,-0.484],[-0.05,-0.42],[-0.239,-0.351],[0.106,0.048],[-0.241,0.192],[-0.385,0.235],[-0.327,0.175],[-0.655,0.131],[-0.619,-0.039],[-0.583,-0.133],[-0.548,-0.153],[0.267,1.434],[-0.117,1.049],[-0.301,0.866],[-0.283,0.884],[1.598,-0.348],[0.9,0.35],[0.581,0.669],[0.641,0.609]],"v":[[655,55],[655.324,53.865],[655.471,52.878],[655.655,51.957],[656.093,51.025],[657,50],[658.221,49.445],[659.794,49.146],[661.221,48.775],[662,48],[661.867,46.743],[661.055,45.428],[659.966,43.898],[659,42],[658.696,40.456],[658.612,39.098],[658.221,37.941],[657,37],[656.747,37.386],[655.759,38.053],[654.641,38.692],[654,39],[652.089,39.12],[650.287,38.843],[648.592,38.396],[647,38],[647.175,41.674],[646.498,44.497],[645.572,47.071],[645,50],[648.652,50.098],[650.778,51.722],[652.515,53.735]],"c":true}],"h":1},{"t":15,"s":[{"i":[[-1.645,1.12],[-0.486,0.682],[-0.813,0.437],[-0.67,0.287],[-0.057,0.23],[0.201,0.387],[0.37,0.318],[0.359,0.397],[0.167,0.623],[-0.026,0.38],[-0.036,0.447],[0.008,0.343],[0.107,0.07],[0.365,-0.08],[0.281,-0.368],[0.525,-0.354],[1.098,-0.038],[0.275,0.186],[0.432,0.199],[0.441,0.038],[0.302,-0.296],[0.014,-0.425],[-0.052,-0.528],[-0.04,-0.464],[0.051,-0.234],[0.299,-0.468],[0.26,-0.254],[0.081,-0.284],[-0.237,-0.558],[-0.674,0.03],[-0.718,0.054],[-0.201,-0.089],[-0.299,-1.152]],"o":[[-0.311,-1.02],[0.486,-0.682],[0.814,-0.437],[0.67,-0.287],[0.149,-0.603],[-0.201,-0.387],[-0.37,-0.318],[-0.359,-0.397],[-0.038,-0.143],[0.026,-0.38],[0.036,-0.447],[-0.008,-0.343],[-0.777,-0.509],[-0.365,0.08],[-0.281,0.368],[-0.525,0.354],[0.029,-0.001],[-0.275,-0.186],[-0.432,-0.199],[-0.441,-0.038],[-0.159,0.155],[-0.014,0.425],[0.052,0.528],[0.04,0.464],[-0.199,0.925],[-0.299,0.468],[-0.26,0.254],[-0.081,0.284],[0.068,0.161],[0.674,-0.03],[0.718,-0.054],[1.16,0.512],[0.299,1.152]],"v":[[656,53],[656.381,50.47],[658.449,48.815],[660.792,47.752],[662,47],[661.876,45.551],[660.974,44.529],[659.835,43.493],[659,42],[658.995,41.173],[659.102,39.89],[659.158,38.662],[659,38],[657.368,37.433],[656.481,38.18],[655.353,39.338],[653,40],[652.594,39.676],[651.497,39.055],[650.151,38.656],[649,39],[648.761,39.912],[648.838,41.382],[648.996,42.911],[649,44],[648.217,46.029],[647.345,47.052],[646.8,47.799],[647,49],[648.253,49.155],[650.481,48.988],[652,49],[653.636,52.224]],"c":true}],"h":1},{"t":16,"s":[{"i":[[0.28,-0.286],[0.077,-0.272],[0.095,-0.386],[0.086,-0.375],[0.052,-0.241],[-0.008,0.018],[0.006,-0.476],[-0.342,-0.13],[-0.552,-0.089],[-0.623,-0.353],[-0.233,-0.331],[-0.192,-0.333],[-0.238,-0.21],[-0.372,0.037],[-0.197,0.299],[-0.265,0.435],[-0.31,0.419],[-0.333,0.25],[-0.325,0.078],[-0.291,0.072],[-0.195,0.208],[-0.038,0.486],[0.445,0.562],[0.49,0.948],[0.175,0.662],[-0.5,-0.296],[0.571,-0.089],[0.624,-0.229],[0.616,-0.151],[0.547,0.147],[0.045,0.1],[0.003,0.058],[0.082,-0.071]],"o":[[-0.033,0.034],[-0.077,0.272],[-0.095,0.386],[-0.086,0.375],[-0.052,0.241],[-0.492,1.128],[-0.006,0.476],[0.342,0.13],[0.552,0.089],[0.362,0.205],[0.233,0.331],[0.192,0.333],[0.238,0.21],[0.108,-0.011],[0.197,-0.299],[0.265,-0.435],[0.31,-0.419],[0.299,-0.224],[0.325,-0.078],[0.291,-0.072],[0.195,-0.208],[-0.039,0.496],[-0.445,-0.562],[-0.49,-0.948],[-0.175,-0.662],[-0.456,-0.27],[-0.571,0.089],[-0.624,0.229],[-0.616,0.151],[-0.207,-0.056],[-0.045,-0.1],[-0.003,-0.058],[-0.082,0.071]],"v":[[651,40],[650.829,40.489],[650.566,41.506],[650.288,42.679],[650.073,43.634],[650,44],[649.289,46.33],[649.828,47.163],[651.204,47.414],[653,48],[653.87,48.835],[654.485,49.863],[655.107,50.709],[656,51],[656.463,50.498],[657.162,49.359],[658.03,48.041],[659,47],[659.951,46.582],[660.89,46.392],[661.634,46.005],[662,45],[661.184,44.734],[659.692,42.301],[658.604,39.718],[659,39],[657.445,38.784],[655.637,39.316],[653.76,39.94],[652,40],[651.652,39.745],[651.609,39.488],[651.512,39.486]],"c":true}],"h":1},{"t":17,"s":[{"i":[[-0.063,0.002],[0.459,0.042],[0.524,0.036],[0.428,-0.024],[0.17,-0.137],[0.127,-0.592],[0.127,-0.804],[0.062,-0.685],[-0.069,-0.236],[-0.263,0],[-0.355,0.019],[-0.289,0.01],[-0.066,-0.028],[-0.23,-0.328],[-0.195,-0.353],[-0.242,-0.224],[-0.372,0.061],[-0.078,0.277],[-0.142,0.377],[-0.118,0.286],[-0.006,0.006],[-0.289,0.099],[-0.364,0.112],[-0.268,0.082],[-0.002,0.008],[0.113,0.265],[0.245,0.225],[0.26,0.348],[0.157,0.632],[-0.042,0.398],[-0.016,0.381],[0.126,0.138],[0.444,-0.329]],"o":[[-0.232,0.006],[-0.459,-0.042],[-0.524,-0.036],[-0.428,0.024],[-0.06,0.048],[-0.127,0.592],[-0.127,0.804],[-0.062,0.685],[0.014,0.048],[0.263,0],[0.355,-0.019],[0.289,-0.01],[0.349,0.147],[0.23,0.328],[0.195,0.353],[0.242,0.224],[-0.074,0.012],[0.078,-0.277],[0.142,-0.377],[0.118,-0.286],[0.043,-0.043],[0.289,-0.099],[0.364,-0.112],[0.268,-0.082],[0.138,-0.467],[-0.113,-0.265],[-0.245,-0.225],[-0.26,-0.348],[-0.047,-0.19],[0.042,-0.398],[0.016,-0.381],[-0.288,-0.314],[-0.444,0.329]],"v":[[657,40],[655.922,39.932],[654.406,39.803],[652.937,39.772],[652,40],[651.704,41.042],[651.307,43.218],[651.006,45.535],[651,47],[651.455,47.065],[652.422,47.03],[653.428,46.98],[654,47],[654.848,47.751],[655.465,48.812],[656.1,49.717],[657,50],[657.028,49.555],[657.38,48.527],[657.792,47.486],[658,47],[658.54,46.776],[659.561,46.447],[660.552,46.145],[661,46],[661.008,44.942],[660.442,44.247],[659.655,43.429],[659,42],[659.021,41.06],[659.137,39.835],[659,39],[657.737,39.266]],"c":true}],"h":1},{"t":18,"s":[{"i":[[0.165,0.014],[0.446,0.02],[0.325,-0.016],[0.226,-0.058],[0.149,-0.107],[0.094,-0.163],[0.062,-0.225],[0.052,-0.295],[0.065,-0.371],[0.048,-0.289],[0.021,-0.212],[-0.015,-0.155],[-0.06,-0.116],[-0.114,-0.097],[-0.176,-0.096],[-0.247,-0.114],[-0.327,-0.152],[-0.354,-0.102],[-0.209,0.039],[-0.156,0.15],[-0.195,0.231],[-0.325,0.281],[-0.196,0.07],[-0.218,0.073],[-0.163,0.091],[-0.031,0.126],[0.266,0.681],[0.327,0.737],[0.147,0.313],[-0.272,-0.594],[0.072,0.061],[0.044,-0.09],[0.075,-0.106]],"o":[[-0.59,-0.048],[-0.446,-0.02],[-0.325,0.016],[-0.226,0.058],[-0.149,0.107],[-0.094,0.163],[-0.062,0.225],[-0.052,0.295],[-0.067,0.384],[-0.048,0.289],[-0.021,0.212],[0.015,0.155],[0.06,0.116],[0.114,0.097],[0.176,0.096],[0.247,0.114],[0.59,0.274],[0.354,0.102],[0.209,-0.039],[0.156,-0.15],[0.195,-0.231],[0.096,-0.083],[0.196,-0.07],[0.218,-0.073],[0.163,-0.091],[0.035,-0.144],[-0.266,-0.681],[-0.327,-0.738],[-0.147,-0.313],[-0.159,-0.346],[-0.072,-0.061],[-0.044,0.09],[-0.075,0.106]],"v":[[658,40],[656.452,39.896],[655.301,39.888],[654.481,39.996],[653.925,40.241],[653.566,40.643],[653.337,41.223],[653.17,42.002],[653,43],[652.824,44.004],[652.718,44.75],[652.707,45.295],[652.817,45.697],[653.075,46.011],[653.508,46.295],[654.14,46.606],[655,47],[656.394,47.556],[657.216,47.644],[657.741,47.353],[658.244,46.775],[659,46],[659.456,45.775],[660.097,45.565],[660.689,45.322],[661,45],[660.593,43.643],[659.644,41.395],[658.873,39.699],[659,40],[658.668,39.423],[658.509,39.501],[658.345,39.828]],"c":true}],"h":1},{"t":19,"s":[{"i":[[-0.1,0.096],[0.05,-0.148],[0.059,-0.23],[0.062,-0.279],[0.059,-0.295],[0.049,-0.279],[0.033,-0.231],[0.01,-0.149],[-0.019,-0.035],[-0.182,-0.011],[-0.26,0.017],[-0.268,0.023],[-0.206,0.007],[-0.074,-0.03],[-0.122,-0.213],[-0.137,-0.246],[-0.196,-0.16],[-0.301,0.046],[-0.16,0.258],[-0.196,0.352],[-0.188,0.293],[-0.136,0.08],[-0.221,0.025],[-0.207,0.029],[-0.132,0.114],[0.003,0.281],[0.281,0.37],[0.326,0.632],[0.132,0.445],[-0.301,-0.188],[0.701,-0.057],[0.632,-0.238],[0.365,-0.187]],"o":[[-0.034,0.033],[-0.05,0.148],[-0.059,0.23],[-0.062,0.279],[-0.059,0.295],[-0.049,0.279],[-0.033,0.231],[-0.01,0.149],[0.034,0.06],[0.182,0.011],[0.26,-0.017],[0.268,-0.023],[0.206,-0.007],[0.153,0.061],[0.122,0.213],[0.137,0.246],[0.196,0.16],[0.079,-0.012],[0.16,-0.258],[0.196,-0.352],[0.188,-0.292],[0.177,-0.103],[0.221,-0.025],[0.207,-0.029],[0.132,-0.114],[0.003,0.338],[-0.281,-0.37],[-0.326,-0.632],[-0.132,-0.445],[-0.571,-0.357],[-0.701,0.057],[-0.632,0.238],[-0.365,0.187]],"v":[[654,41],[653.872,41.279],[653.706,41.854],[653.522,42.624],[653.339,43.494],[653.176,44.364],[653.052,45.137],[652.987,45.715],[653,46],[653.341,46.102],[654.022,46.088],[654.832,46.023],[655.562,45.972],[656,46],[656.401,46.441],[656.778,47.16],[657.266,47.799],[658,48],[658.369,47.556],[658.914,46.602],[659.502,45.597],[660,45],[660.612,44.827],[661.269,44.767],[661.791,44.573],[662,44],[661.523,43.84],[660.553,42.225],[659.806,40.498],[660,40],[658.043,39.608],[655.994,40.109],[654.448,40.805]],"c":true}],"h":1},{"t":20,"s":[{"i":[[-0.03,-0.011],[0.365,0.033],[0.368,-0.045],[0.346,-0.111],[0.297,-0.164],[0.222,-0.205],[-0.131,-0.113],[-0.106,-0.236],[-0.046,-0.255],[0.046,-0.169],[0.273,-0.195],[0.089,0.034],[-0.353,-0.038],[-1.055,-0.41],[-0.16,-0.257],[-0.194,-0.273],[-0.312,-0.129],[-0.514,0.174],[0.005,0.176],[0.026,0.233],[0.009,0.191],[-0.048,0.048],[-0.19,-0.009],[-0.232,-0.028],[-0.176,-0.005],[-0.022,0.059],[0.152,0.656],[0.296,0.625],[0.246,0.407],[0.003,0.001],[0.004,-0.093],[0.015,-0.118],[0.004,-0.091]],"o":[[-0.336,-0.123],[-0.365,-0.033],[-0.368,0.045],[-0.346,0.111],[-0.297,0.164],[0.124,-0.114],[0.131,0.113],[0.106,0.236],[0.046,0.255],[-0.197,0.724],[-0.273,0.195],[-0.089,-0.034],[0.353,0.038],[0.21,0.082],[0.16,0.257],[0.194,0.273],[0.312,0.129],[0.056,-0.019],[-0.005,-0.176],[-0.026,-0.233],[-0.009,-0.191],[0.051,-0.051],[0.19,0.009],[0.232,0.028],[0.176,0.005],[0.185,-0.5],[-0.152,-0.656],[-0.296,-0.625],[-0.246,-0.407],[0.029,0.016],[-0.004,0.093],[-0.015,0.118],[-0.004,0.091]],"v":[[659,40],[657.941,39.768],[656.834,39.79],[655.756,40.027],[654.786,40.442],[654,41],[654.391,41.025],[654.755,41.575],[654.991,42.338],[655,43],[654.229,44.304],[653.621,44.471],[653.952,44.403],[656,45],[656.535,45.548],[657.045,46.383],[657.783,47.026],[659,47],[659.068,46.683],[659.012,46.044],[658.95,45.383],[659,45],[659.386,44.948],[660.043,45.013],[660.679,45.072],[661,45],[661,43.22],[660.28,41.252],[659.42,39.659],[659,39],[659.033,39.177],[658.999,39.507],[658.966,39.834]],"c":true}],"h":1},{"t":21,"s":[{"i":[[0.28,-0.444],[0.146,-0.351],[0.022,-0.252],[-0.078,-0.173],[-0.151,-0.113],[-0.2,-0.074],[-0.222,-0.055],[-0.22,-0.056],[-0.191,-0.077],[-0.061,-0.077],[-0.063,-0.111],[-0.068,-0.129],[-0.076,-0.129],[-0.086,-0.112],[-0.1,-0.078],[-0.116,-0.027],[-0.136,0.042],[0.019,0.07],[-0.068,0.155],[-0.126,0.211],[-0.157,0.24],[-0.161,0.242],[-0.136,0.215],[-0.084,0.162],[-0.003,0.081],[0.197,0.356],[0.331,0.1],[0.373,-0.043],[0.321,-0.07],[0.176,0.016],[0.134,0.142],[0.134,0.107],[0.183,-0.089]],"o":[[-0.297,0.47],[-0.146,0.351],[-0.022,0.252],[0.078,0.173],[0.151,0.113],[0.2,0.074],[0.222,0.055],[0.22,0.056],[0.062,0.025],[0.061,0.077],[0.063,0.111],[0.068,0.129],[0.076,0.129],[0.086,0.112],[0.1,0.078],[0.116,0.027],[-0.133,0.041],[-0.019,-0.07],[0.068,-0.155],[0.126,-0.211],[0.157,-0.24],[0.161,-0.242],[0.136,-0.215],[0.084,-0.162],[0.03,-0.727],[-0.197,-0.356],[-0.331,-0.1],[-0.373,0.043],[-0.321,0.07],[-0.183,-0.017],[-0.134,-0.142],[-0.134,-0.107],[-0.183,0.089]],"v":[[655,41],[654.342,42.226],[654.096,43.125],[654.186,43.756],[654.536,44.18],[655.069,44.456],[655.708,44.645],[656.377,44.806],[657,45],[657.183,45.156],[657.368,45.443],[657.563,45.807],[657.778,46.199],[658.021,46.566],[658.299,46.856],[658.623,47.018],[659,47],[658.779,46.949],[658.859,46.605],[659.157,46.049],[659.59,45.366],[660.074,44.636],[660.526,43.944],[660.863,43.371],[661,43],[660.727,41.404],[659.911,40.749],[658.832,40.693],[657.769,40.891],[657,41],[656.537,40.722],[656.146,40.309],[655.682,40.241]],"c":true}],"h":1},{"t":22,"s":[{"i":[[-0.041,0.066],[0.093,-0.199],[0.061,-0.194],[0.031,-0.186],[0.003,-0.177],[-0.024,-0.166],[-0.049,-0.153],[-0.072,-0.138],[-0.093,-0.121],[-0.113,-0.102],[-0.131,-0.081],[-0.147,-0.058],[-0.162,-0.033],[-0.174,-0.006],[-0.185,0.023],[-0.194,0.054],[-0.161,0.137],[-0.116,0.197],[-0.076,0.24],[-0.041,0.265],[-0.011,0.273],[0.013,0.263],[0.032,0.236],[0.046,0.191],[0.054,0.129],[0.058,0.049],[0.205,0.035],[0.23,-0.042],[0.235,-0.091],[0.22,-0.113],[0.185,-0.109],[0.13,-0.078],[0.054,-0.019]],"o":[[-0.126,0.202],[-0.093,0.199],[-0.061,0.194],[-0.031,0.186],[-0.003,0.177],[0.024,0.166],[0.049,0.153],[0.072,0.138],[0.093,0.121],[0.113,0.102],[0.131,0.081],[0.147,0.058],[0.162,0.033],[0.174,0.006],[0.185,-0.023],[0.212,-0.059],[0.161,-0.137],[0.116,-0.197],[0.076,-0.24],[0.041,-0.265],[0.011,-0.273],[-0.013,-0.263],[-0.032,-0.236],[-0.046,-0.191],[-0.054,-0.129],[-0.16,-0.138],[-0.205,-0.035],[-0.23,0.042],[-0.235,0.091],[-0.22,0.113],[-0.185,0.109],[-0.13,0.078],[-0.054,0.019]],"v":[[656,41],[655.672,41.602],[655.441,42.191],[655.304,42.762],[655.254,43.308],[655.287,43.823],[655.397,44.302],[655.579,44.739],[655.828,45.127],[656.139,45.461],[656.505,45.735],[656.923,45.944],[657.387,46.08],[657.891,46.139],[658.43,46.114],[659,46],[659.559,45.703],[659.973,45.198],[660.26,44.539],[660.434,43.777],[660.511,42.966],[660.508,42.157],[660.439,41.404],[660.321,40.758],[660.169,40.272],[660,40],[659.446,39.748],[658.788,39.765],[658.084,39.971],[657.396,40.284],[656.784,40.624],[656.307,40.91],[656.025,41.062]],"c":true}],"h":1},{"t":23,"s":[{"i":[[0.034,-0.093],[0.023,-0.351],[-0.076,-0.297],[-0.148,-0.247],[-0.192,-0.199],[-0.209,-0.154],[-0.198,-0.111],[-0.16,-0.072],[-0.095,-0.034],[-0.002,0],[0.015,0.058],[-0.036,0.098],[-0.07,0.121],[-0.087,0.128],[-0.087,0.118],[-0.07,0.091],[-0.036,0.048],[0.015,-0.012],[-0.07,0.033],[-0.058,0.013],[-0.047,0.005],[-0.038,0.009],[-0.03,0.025],[-0.023,0.054],[-0.018,0.095],[-0.014,0.149],[0.107,0.316],[0.216,0.206],[0.285,0.113],[0.314,0.037],[0.304,-0.021],[0.254,-0.062],[0.164,-0.086]],"o":[[-0.15,0.407],[-0.023,0.351],[0.076,0.297],[0.148,0.247],[0.192,0.199],[0.209,0.154],[0.198,0.111],[0.16,0.072],[0.095,0.034],[-0.083,-0.001],[-0.015,-0.058],[0.036,-0.098],[0.07,-0.121],[0.087,-0.128],[0.087,-0.118],[0.07,-0.091],[0.036,-0.048],[0.083,-0.066],[0.07,-0.033],[0.058,-0.013],[0.047,-0.005],[0.038,-0.009],[0.03,-0.025],[0.023,-0.054],[0.018,-0.095],[0.042,-0.443],[-0.107,-0.316],[-0.216,-0.206],[-0.285,-0.113],[-0.314,-0.037],[-0.304,0.021],[-0.254,0.062],[-0.164,0.086]],"v":[[656,41],[655.747,42.135],[655.833,43.107],[656.175,43.923],[656.691,44.591],[657.298,45.12],[657.915,45.517],[658.459,45.791],[658.848,45.949],[659,46],[658.857,45.907],[658.894,45.669],[659.057,45.336],[659.298,44.959],[659.563,44.586],[659.803,44.269],[659.965,44.057],[660,44],[660.23,43.854],[660.422,43.787],[660.58,43.764],[660.708,43.747],[660.81,43.7],[660.89,43.584],[660.952,43.363],[661,43],[660.892,41.866],[660.397,41.088],[659.636,40.614],[658.727,40.393],[657.79,40.372],[656.944,40.501],[656.307,40.728]],"c":true}],"h":1},{"t":24,"s":[{"i":[[0.183,-0.15],[0.13,-0.147],[0.07,-0.132],[0.017,-0.118],[-0.029,-0.103],[-0.069,-0.088],[-0.102,-0.072],[-0.129,-0.056],[-0.149,-0.04],[-0.163,-0.023],[-0.17,-0.006],[-0.17,0.011],[-0.164,0.029],[-0.151,0.047],[-0.132,0.065],[-0.106,0.084],[-0.074,0.103],[-0.035,0.122],[0.011,0.142],[0.018,0.114],[0.027,0.109],[0.037,0.101],[0.047,0.091],[0.058,0.079],[0.068,0.066],[0.08,0.05],[0.091,0.032],[0.103,0.012],[0.116,-0.01],[0.128,-0.034],[0.141,-0.06],[0.155,-0.088],[0.169,-0.118]],"o":[[-0.196,0.16],[-0.13,0.147],[-0.07,0.132],[-0.017,0.118],[0.029,0.103],[0.069,0.088],[0.102,0.072],[0.129,0.056],[0.149,0.04],[0.163,0.023],[0.17,0.006],[0.17,-0.011],[0.164,-0.029],[0.151,-0.047],[0.132,-0.065],[0.106,-0.084],[0.074,-0.103],[0.035,-0.122],[-0.009,-0.118],[-0.018,-0.114],[-0.027,-0.109],[-0.037,-0.101],[-0.047,-0.091],[-0.058,-0.079],[-0.068,-0.066],[-0.08,-0.05],[-0.091,-0.032],[-0.103,-0.012],[-0.116,0.01],[-0.128,0.034],[-0.141,0.06],[-0.155,0.088],[-0.169,0.118]],"v":[[657,42],[656.513,42.461],[656.214,42.879],[656.084,43.255],[656.103,43.586],[656.252,43.872],[656.511,44.111],[656.86,44.304],[657.279,44.448],[657.749,44.543],[658.249,44.587],[658.761,44.58],[659.264,44.52],[659.739,44.407],[660.166,44.239],[660.526,44.015],[660.797,43.735],[660.962,43.397],[661,43],[660.96,42.651],[660.892,42.315],[660.796,42],[660.67,41.711],[660.513,41.455],[660.324,41.236],[660.102,41.062],[659.846,40.939],[659.554,40.872],[659.226,40.868],[658.861,40.933],[658.456,41.072],[658.012,41.292],[657.527,41.6]],"c":true}],"h":1},{"t":25,"s":[{"i":[[0.111,-0.249],[0.016,-0.07],[0.004,-0.073],[-0.007,-0.076],[-0.017,-0.078],[-0.026,-0.078],[-0.034,-0.078],[-0.041,-0.076],[-0.047,-0.074],[-0.051,-0.07],[-0.055,-0.065],[-0.057,-0.059],[-0.059,-0.052],[-0.059,-0.045],[-0.059,-0.035],[-0.057,-0.025],[-0.054,-0.014],[-0.051,-0.002],[-0.046,0.011],[-0.128,0.087],[-0.084,0.122],[-0.044,0.148],[-0.009,0.164],[0.022,0.172],[0.05,0.171],[0.073,0.16],[0.092,0.141],[0.107,0.112],[0.118,0.075],[0.124,0.028],[0.127,-0.028],[0.126,-0.093],[0.12,-0.166]],"o":[[-0.029,0.065],[-0.016,0.07],[-0.004,0.073],[0.007,0.076],[0.017,0.078],[0.026,0.078],[0.034,0.078],[0.041,0.076],[0.047,0.074],[0.051,0.07],[0.055,0.065],[0.057,0.059],[0.059,0.052],[0.059,0.045],[0.059,0.035],[0.057,0.025],[0.054,0.014],[0.051,0.002],[0.175,-0.043],[0.128,-0.087],[0.084,-0.122],[0.044,-0.148],[0.009,-0.164],[-0.022,-0.172],[-0.05,-0.171],[-0.073,-0.16],[-0.092,-0.141],[-0.107,-0.112],[-0.118,-0.075],[-0.124,-0.028],[-0.127,0.028],[-0.126,0.093],[-0.12,0.166]],"v":[[657,42],[656.933,42.202],[656.905,42.417],[656.911,42.641],[656.948,42.873],[657.014,43.107],[657.105,43.341],[657.217,43.573],[657.349,43.798],[657.496,44.013],[657.656,44.216],[657.824,44.403],[657.999,44.571],[658.177,44.717],[658.355,44.837],[658.529,44.929],[658.697,44.989],[658.855,45.013],[659,45],[659.453,44.803],[659.77,44.488],[659.961,44.081],[660.04,43.611],[660.019,43.105],[659.91,42.589],[659.726,42.09],[659.478,41.637],[659.179,41.255],[658.841,40.973],[658.477,40.817],[658.099,40.814],[657.718,40.993],[657.348,41.379]],"c":true}],"h":1},{"t":26,"s":[{"i":[[0.269,0.186],[0.204,-0.14],[0.161,-0.134],[0.122,-0.126],[0.086,-0.119],[0.052,-0.112],[0.021,-0.104],[-0.007,-0.096],[-0.032,-0.088],[-0.054,-0.079],[-0.073,-0.071],[-0.09,-0.062],[-0.103,-0.053],[-0.114,-0.044],[-0.122,-0.034],[-0.127,-0.025],[-0.129,-0.015],[-0.129,-0.005],[-0.125,0.006],[-0.119,0.016],[-0.11,0.027],[-0.098,0.038],[-0.083,0.049],[-0.065,0.06],[-0.045,0.072],[-0.021,0.084],[0.005,0.096],[0.034,0.108],[0.066,0.121],[0.101,0.133],[0.139,0.146],[0.18,0.159],[0.223,0.173]],"o":[[-0.249,0.147],[-0.204,0.14],[-0.161,0.134],[-0.122,0.126],[-0.086,0.119],[-0.052,0.112],[-0.021,0.104],[0.007,0.096],[0.032,0.088],[0.054,0.079],[0.073,0.071],[0.09,0.062],[0.103,0.053],[0.114,0.044],[0.122,0.034],[0.127,0.025],[0.129,0.015],[0.129,0.005],[0.125,-0.006],[0.119,-0.016],[0.11,-0.027],[0.098,-0.038],[0.083,-0.049],[0.065,-0.06],[0.045,-0.072],[0.021,-0.084],[-0.005,-0.096],[-0.034,-0.108],[-0.066,-0.121],[-0.101,-0.133],[-0.139,-0.146],[-0.18,-0.159],[-0.223,-0.173]],"v":[[727,95],[726.322,95.431],[725.775,95.842],[725.351,96.232],[725.04,96.601],[724.834,96.947],[724.725,97.271],[724.703,97.571],[724.762,97.847],[724.891,98.098],[725.082,98.323],[725.328,98.523],[725.618,98.696],[725.946,98.841],[726.301,98.958],[726.676,99.047],[727.061,99.107],[727.45,99.136],[727.832,99.135],[728.199,99.102],[728.543,99.038],[728.855,98.941],[729.127,98.81],[729.35,98.646],[729.515,98.448],[729.614,98.214],[729.639,97.944],[729.58,97.638],[729.429,97.295],[729.178,96.914],[728.819,96.495],[728.341,96.037],[727.738,95.538]],"c":true}],"h":1},{"t":27.0000010997325,"s":[{"i":[[0.033,-0.036],[-0.056,0.036],[-0.042,0.002],[-0.029,-0.027],[-0.018,-0.05],[-0.008,-0.069],[0.001,-0.083],[0.008,-0.091],[0.015,-0.094],[0.02,-0.092],[0.024,-0.084],[0.026,-0.072],[0.027,-0.054],[0.027,-0.032],[0.026,-0.004],[0.024,0.029],[-0.204,-0.108],[-0.219,-0.013],[-0.225,0.062],[-0.221,0.117],[-0.207,0.151],[-0.184,0.165],[-0.151,0.159],[-0.108,0.133],[-0.056,0.086],[0.006,0.019],[0.173,0.138],[0.239,0.056],[0.276,-0.007],[0.285,-0.051],[0.265,-0.076],[0.216,-0.082],[0.139,-0.068]],"o":[[0.071,-0.076],[0.056,-0.036],[0.042,-0.002],[0.029,0.027],[0.018,0.05],[0.008,0.069],[-0.001,0.083],[-0.008,0.091],[-0.015,0.094],[-0.02,0.092],[-0.024,0.084],[-0.026,0.072],[-0.027,0.054],[-0.027,0.032],[-0.026,0.004],[0.179,0.224],[0.204,0.108],[0.219,0.013],[0.225,-0.062],[0.221,-0.117],[0.207,-0.151],[0.184,-0.165],[0.151,-0.159],[0.108,-0.133],[0.056,-0.086],[-0.078,-0.239],[-0.173,-0.138],[-0.239,-0.056],[-0.276,0.007],[-0.285,0.051],[-0.265,0.076],[-0.216,0.082],[-0.139,0.068]],"v":[[725,97],[725.189,96.833],[725.335,96.777],[725.441,96.815],[725.511,96.932],[725.55,97.112],[725.56,97.341],[725.545,97.602],[725.51,97.88],[725.458,98.16],[725.392,98.426],[725.318,98.662],[725.237,98.853],[725.155,98.983],[725.075,99.037],[725,99],[725.576,99.493],[726.212,99.67],[726.88,99.591],[727.55,99.319],[728.194,98.912],[728.782,98.432],[729.286,97.941],[729.676,97.498],[729.924,97.164],[730,97],[729.616,96.438],[728.992,96.151],[728.213,96.083],[727.365,96.174],[726.534,96.369],[725.806,96.61],[725.266,96.839]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":0,"s":[0],"h":1},{"t":1,"s":[100],"h":1},{"t":28.0000011404634,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 1"},{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":2,"s":[{"i":[[0.608,-0.168],[0.25,-0.405],[-0.122,-0.54],[-0.415,-0.598],[-0.628,-0.579],[-0.762,-0.484],[-0.817,-0.312],[-0.792,-0.064],[-0.688,0.261],[0.415,0.693],[0.538,0.723],[0.619,0.652],[0.658,0.48],[0.654,0.206]],"o":[[-0.702,0.194],[-0.25,0.405],[0.122,0.54],[0.415,0.598],[0.628,0.579],[0.762,0.484],[0.817,0.312],[0.792,0.064],[-0.25,-0.561],[-0.415,-0.693],[-0.538,-0.723],[-0.619,-0.652],[-0.658,-0.48],[-0.654,-0.206]],"v":[[599,114],[597.593,114.917],[597.421,116.353],[598.246,118.078],[599.831,119.863],[601.937,121.477],[604.326,122.692],[606.76,123.276],[609,123],[607.993,121.094],[606.553,118.946],[604.807,116.859],[602.882,115.137],[600.904,114.083]],"c":true}],"h":1},{"t":3,"s":[{"i":[[-3.616,1.418],[0.41,1.757],[-0.083,0.388],[-0.673,0.615],[-0.274,0.395],[-0.396,0.679],[0.203,1.397],[1.511,0.093],[1.32,0.778],[3.969,-0.538],[6.586,-0.748],[-1.087,-3.742],[-1.992,-2.527],[-3.207,0.018]],"o":[[0.557,-1.585],[-0.41,-1.757],[0.032,-0.146],[0.673,-0.615],[0.618,-0.888],[0.396,-0.679],[-1.637,-0.852],[-1.511,-0.093],[-2.498,-1.472],[-3.028,4.305],[-0.158,4.278],[0.619,2.13],[4.358,0.195],[2.018,-0.011]],"v":[[614,134],[613.855,128.602],[613,125],[614.318,123.687],[616,122],[617.616,119.882],[618,117],[613.262,115.945],[609,115],[603,109],[591,119],[596,128],[597,135],[606,132]],"c":true}],"h":1},{"t":4,"s":[{"i":[[-0.142,-4.678],[-4.86,-1.591],[-5.101,2.713],[-0.027,0.08],[-1.163,1.385],[-1.758,1.055],[0.097,2.458],[-2.179,-1.627],[0.781,0.608],[0.41,0.77],[3.907,1.849],[2.51,-0.344],[5.228,-1.608],[0.357,-4.139]],"o":[[5.133,3.047],[6.062,1.984],[2.127,-1.132],[0.593,-1.745],[0.868,-1.034],[2.069,-1.242],[-0.044,-1.101],[-0.88,-0.658],[-0.668,-0.521],[-0.866,-1.628],[-2.204,-1.043],[-6.048,0.828],[-0.815,5.483],[-0.357,4.137]],"v":[[634,110],[646,111],[657,118],[659,113],[661,107],[667,105],[671,100],[667,96],[664,95],[662,92],[659,81],[647,87],[636,86],[638,99]],"c":true}],"h":1},{"t":5,"s":[{"i":[[2.01,-1.556],[-0.081,-0.782],[0.44,-1.188],[0.545,-0.385],[-0.34,-1.035],[-0.707,0.039],[-0.138,-0.054],[-0.226,-0.477],[-0.048,-0.074],[-0.685,0.633],[-1.887,0.59],[0.994,4.244],[0.496,0.455],[2.731,0.5]],"o":[[-0.884,0.684],[0.081,0.782],[-0.158,0.426],[-0.546,0.385],[0.034,0.102],[0.707,-0.039],[0.047,0.019],[0.226,0.477],[1.373,2.123],[0.685,-0.633],[5.576,-1.742],[-0.166,-0.71],[-1.299,-1.193],[-3.108,-0.569]],"v":[[628,82],[627.167,84.122],[627,87],[625.627,88.043],[625,90],[626.422,90.035],[628,90],[628.499,90.958],[629,92],[631.615,93.534],[635,91],[636,86],[636,82],[631,83]],"c":true}],"h":1},{"t":6,"s":[{"i":[[1.561,-1.236],[-0.1,-0.861],[0.131,-0.345],[0.658,0.043],[-0.308,-1.4],[-0.947,-0.185],[-0.185,-0.138],[-0.409,-0.902],[-0.808,0.019],[-0.807,0.965],[-0.421,0.13],[0.138,3.005],[1.097,1.089],[4.776,0.539]],"o":[[-0.266,0.211],[0.099,0.861],[-0.675,1.774],[-0.658,-0.043],[0.027,0.124],[0.947,0.185],[0.556,0.412],[0.409,0.902],[0.353,-0.008],[0.806,-0.965],[5.149,-1.594],[0.005,0.103],[-3.978,-3.95],[-2.659,-0.3]],"v":[[634,81],[633.899,82.9],[634,85],[631.763,86.781],[631,88],[632.882,88.489],[635,89],[636.311,91.324],[638,93],[639.949,91.091],[642,89],[642,84],[643,81],[638,81]],"c":true}],"h":1},{"t":7,"s":[{"i":[[0.071,-0.069],[-0.037,-0.427],[0.03,-0.177],[0.496,-0.742],[-0.218,-0.662],[-0.931,-0.148],[-0.209,-0.203],[-0.044,-0.66],[-0.519,-0.065],[-2.567,1.041],[-0.2,0.326],[0.204,4.428],[1.086,1.128],[0.049,-0.01]],"o":[[-0.119,0.115],[0.037,0.427],[-0.235,1.37],[-0.496,0.742],[0.068,0.207],[0.931,0.148],[0.304,0.294],[0.044,0.66],[2.652,0.331],[0.4,-0.162],[2.822,-4.607],[0.003,0.073],[-1.034,-1.074],[-0.078,0.015]],"v":[[639,80],[638.934,80.954],[639,82],[637.661,85.031],[637,87],[638.894,87.503],[641,88],[641.339,89.672],[642,91],[646,88],[649,88],[647,83],[648,80],[639,79]],"c":true}],"h":1},{"t":8,"s":[{"i":[[1.977,-1.286],[-0.047,-0.442],[0.064,-0.153],[0.333,-0.32],[-2.482,-0.981],[-0.226,-0.477],[-0.048,-0.074],[-0.521,0.636],[-1.518,0.616],[-0.685,-0.055],[-0.079,0.148],[0.685,0.731],[0.029,0.64],[4.38,0]],"o":[[-0.123,0.081],[0.047,0.442],[-1.15,2.739],[-0.333,0.32],[0.047,0.019],[0.226,0.477],[1.397,2.159],[0.521,-0.636],[0.181,-0.073],[0.685,0.055],[0.768,-1.438],[-0.685,-0.731],[-0.097,-2.101],[-3.819,0]],"v":[[644,79],[643.955,79.946],[644,81],[641.276,84.819],[644,86],[644.499,86.958],[645,88],[647.409,89.581],[650,87],[651.577,87.055],[653,87],[652.598,83.901],[651,82],[649,79]],"c":true}],"h":1},{"t":9,"s":[{"i":[[1.529,-1.511],[-0.037,-0.426],[0.031,-0.178],[0.48,-0.715],[-0.18,-0.626],[-0.653,-0.097],[-0.283,-0.248],[-0.239,-0.736],[0.027,0.006],[-0.521,0.674],[-1.755,0.548],[0.915,3.972],[0.49,0.442],[0.505,0.093]],"o":[[-0.119,0.118],[0.037,0.426],[-0.26,1.516],[-0.48,0.715],[0.104,0.364],[0.653,0.097],[0.072,0.064],[0.239,0.736],[1.159,0.245],[0.521,-0.674],[5.279,-1.649],[-0.161,-0.699],[-0.69,-0.622],[-1.668,-0.306]],"v":[[647,78],[646.934,78.955],[647,80],[645.67,83.167],[645,85],[646.366,85.587],[648,86],[648.575,87.552],[649,89],[651.053,88.095],[654,86],[655,82],[655,78],[650,79]],"c":true}],"h":1},{"t":10,"s":[{"i":[[1.643,-1.241],[-0.073,-0.655],[0.1,-0.237],[0.688,-0.063],[-0.292,-1.469],[-0.863,-0.007],[-0.428,-0.362],[-0.036,-0.66],[-0.531,-0.085],[-1.603,0.79],[0.027,-0.06],[0.302,0.69],[0.07,0.621],[4.946,0.59]],"o":[[-0.19,0.144],[0.072,0.655],[-0.541,1.279],[-0.688,0.063],[0.121,0.609],[0.863,0.007],[0.326,0.276],[0.036,0.66],[0.615,0.099],[1.603,-0.79],[0.275,-0.62],[-0.301,-0.69],[-0.713,-6.363],[-1.909,-0.228]],"v":[[650,78],[649.933,79.43],[650,81],[647.876,82.358],[647,84],[648.769,84.685],[651,85],[651.346,86.643],[652,88],[655.982,86.529],[659,85],[658.759,83.001],[658,81],[653,78]],"c":true}],"h":1},{"t":11,"s":[{"i":[[1.715,-1.694],[-0.037,-0.426],[0.031,-0.178],[0.491,-0.859],[-0.15,-0.478],[-0.932,-0.159],[-0.213,-0.178],[-0.124,-0.653],[-1.012,0.025],[-0.374,0.722],[-0.343,0.11],[-0.114,0.242],[-0.012,-0.012],[3.331,0.61]],"o":[[-0.119,0.118],[0.037,0.426],[-0.186,1.086],[-0.491,0.859],[0.058,0.186],[0.932,0.159],[0.494,0.411],[0.124,0.653],[0.159,-0.004],[0.374,-0.721],[0.32,-0.103],[0.402,-0.858],[-1.44,-1.508],[-2.471,-0.453]],"v":[[652,77],[651.934,77.955],[652,79],[650.748,81.956],[650,84],[651.884,84.506],[654,85],[654.611,86.827],[656,88],[656.862,86.579],[658,85],[661,85],[660,77],[655,78]],"c":true}],"h":1},{"t":12,"s":[{"i":[[0.718,-0.64],[-0.048,-0.424],[0.059,-0.183],[0.462,-0.487],[-0.229,-0.86],[-0.657,-0.1],[-0.277,-0.243],[-0.244,-0.738],[0.042,0.008],[-0.902,0.723],[-0.608,0.255],[0.594,0.497],[-0.152,2.079],[-0.002,-0.002]],"o":[[-0.134,0.119],[0.048,0.425],[-0.383,1.194],[-0.462,0.487],[0.096,0.358],[0.657,0.1],[0.065,0.058],[0.244,0.738],[0.784,0.148],[0.902,-0.723],[2.224,-0.934],[-0.594,-0.497],[0.025,-0.341],[-1.098,-0.821]],"v":[[654,77],[653.944,77.952],[654,79],[652.541,81.25],[652,83],[653.364,83.586],[655,84],[655.581,85.549],[656,87],[658.632,85.803],[661,84],[662.554,82.359],[661,79],[662,77]],"c":true}],"h":1},{"t":13,"s":[{"i":[[1.165,-1.023],[-0.048,-0.426],[0.058,-0.181],[0.507,-0.204],[-0.519,-1.657],[-0.76,-0.276],[0.007,0.005],[-0.345,-0.447],[-1.103,0.144],[0.031,-0.022],[-0.633,1.935],[-0.04,0.452],[0.929,0.714],[1.989,0.729]],"o":[[-0.132,0.117],[0.048,0.426],[-0.49,1.525],[-0.507,0.204],[-0.032,-0.1],[0.76,0.276],[0.517,0.353],[0.345,0.448],[-0.475,0.062],[1.463,-1.048],[-0.072,0.221],[-0.011,0.122],[-2.733,-2.102],[-0.893,-0.327]],"v":[[656,77],[655.944,77.952],[656,79],[654.244,80.9],[654,83],[655.482,83.428],[657,84],[658.061,85.373],[660,86],[661,84],[664,82],[662,79],[663,77],[657,77]],"c":true}],"h":1},{"t":14,"s":[{"i":[[0.051,-0.047],[0.584,-1.035],[-0.027,-0.15],[-0.816,-0.136],[-0.61,-0.752],[-0.031,-0.418],[-0.611,0.003],[-0.5,0.662],[-0.786,0.35],[-0.373,0.066],[-0.082,0.544],[0.593,1.588],[-0.51,-0.45],[0.485,-0.003]],"o":[[0.311,-0.288],[-0.584,1.034],[0.128,0.703],[0.815,0.136],[0.267,0.329],[0.031,0.418],[0.215,-0.001],[0.5,-0.662],[0.428,-0.191],[0.373,-0.066],[-0.136,0.904],[-0.593,-1.588],[0.276,0.244],[-0.042,0]],"v":[[657,78],[656.213,79.672],[655,82],[656.639,82.963],[659,84],[659.242,85.249],[660,86],[661.071,84.762],[663,83],[664.26,82.765],[665,82],[663.516,79.84],[663,77],[657,77]],"c":true}],"h":1},{"t":15,"s":[{"i":[[0.437,-0.381],[0.205,-0.411],[0.216,-0.486],[0.153,-0.332],[0.016,0.052],[-0.439,-0.271],[-0.561,-0.397],[-0.341,-0.303],[0.22,0.012],[-1.025,0.798],[-0.13,0.796],[0.5,1.035],[1.034,-0.358],[0.409,-0.074]],"o":[[-0.121,0.106],[-0.205,0.411],[-0.216,0.486],[-0.153,0.332],[-0.024,-0.077],[0.44,0.271],[0.561,0.397],[0.341,0.303],[-0.231,-0.013],[1.025,-0.798],[0.035,-0.217],[-0.5,-1.035],[-0.928,0.322],[-0.409,0.074]],"v":[[659,78],[658.492,78.832],[657.842,80.235],[657.271,81.521],[657,82],[657.709,82.346],[659.296,83.403],[660.734,84.509],[661,85],[662.73,83.587],[665,81],[664.302,78.569],[662,77],[660.132,77.455]],"c":true}],"h":1},{"t":16,"s":[{"i":[[1.284,-1.156],[0.083,-0.128],[0.089,-0.177],[0.079,-0.203],[0.054,-0.204],[0.012,-0.182],[-0.045,-0.135],[-0.319,-0.165],[-0.422,-0.282],[-0.267,-0.226],[0.146,0.004],[-0.368,0.827],[0.134,0.919],[0.685,0.258]],"o":[[-0.061,0.055],[-0.083,0.128],[-0.089,0.177],[-0.079,0.203],[-0.054,0.204],[-0.012,0.182],[-0.041,-0.124],[0.319,0.165],[0.422,0.282],[0.267,0.226],[0.82,0.019],[0.368,-0.827],[-0.134,-0.919],[-0.685,-0.258]],"v":[[660,79],[659.78,79.28],[659.518,79.743],[659.261,80.319],[659.058,80.934],[658.955,81.519],[659,82],[659.481,82.106],[660.657,82.82],[661.754,83.624],[662,84],[663.794,82.6],[664.157,79.794],[662.941,77.841]],"c":true}],"h":1},{"t":17,"s":[{"i":[[0.559,-0.114],[0.089,-0.385],[-0.015,-0.331],[-0.109,-0.268],[-0.194,-0.194],[-0.268,-0.109],[-0.331,-0.015],[-0.385,0.089],[-0.429,0.203],[0.069,0.375],[0.11,0.334],[0.179,0.265],[0.277,0.167],[0.404,0.041]],"o":[[-0.203,0.429],[-0.089,0.385],[0.015,0.331],[0.109,0.268],[0.194,0.194],[0.268,0.109],[0.331,0.015],[0.385,-0.089],[-0.057,-0.387],[-0.069,-0.375],[-0.11,-0.334],[-0.179,-0.265],[-0.277,-0.167],[-0.404,-0.041]],"v":[[661,78],[660.564,79.224],[660.456,80.302],[660.646,81.203],[661.103,81.897],[661.797,82.354],[662.698,82.544],[663.776,82.436],[665,82],[664.817,80.85],[664.555,79.779],[664.128,78.872],[663.451,78.216],[662.437,77.897]],"c":true}],"h":1},{"t":18,"s":[{"i":[[0.964,-0.983],[0.053,-0.1],[0.074,-0.148],[0.079,-0.162],[0.068,-0.142],[0.042,-0.088],[0,-0.001],[-0.328,-0.154],[-0.425,-0.263],[-0.259,-0.227],[0.168,-0.047],[-0.299,0.733],[0.255,0.677],[0.676,0.105]],"o":[[-0.017,0.017],[-0.053,0.1],[-0.074,0.148],[-0.079,0.162],[-0.068,0.142],[-0.042,0.088],[-0.031,-0.099],[0.328,0.154],[0.425,0.263],[0.259,0.227],[0.986,-0.273],[0.299,-0.733],[-0.255,-0.677],[-0.676,-0.105]],"v":[[661,79],[660.89,79.184],[660.695,79.564],[660.461,80.038],[660.236,80.503],[660.067,80.858],[660,81],[660.511,81.12],[661.706,81.782],[662.798,82.553],[663,83],[664.893,81.362],[664.925,79.117],[663.494,77.813]],"c":true}],"h":1},{"t":19,"s":[{"i":[[0.571,-0.473],[0.149,-0.239],[-0.005,-0.195],[-0.125,-0.147],[-0.213,-0.095],[-0.267,-0.038],[-0.289,0.023],[-0.278,0.088],[-0.233,0.159],[-0.1,0.276],[0.032,0.306],[0.165,0.246],[0.299,0.096],[0.434,-0.144]],"o":[[-0.335,0.278],[-0.149,0.239],[0.005,0.195],[0.125,0.147],[0.213,0.095],[0.267,0.038],[0.289,-0.023],[0.278,-0.088],[0.23,-0.156],[0.1,-0.276],[-0.032,-0.306],[-0.165,-0.246],[-0.299,-0.096],[-0.434,0.144]],"v":[[662,79],[661.283,79.776],[661.076,80.429],[661.279,80.944],[661.795,81.309],[662.524,81.511],[663.367,81.535],[664.225,81.369],[665,81],[665.494,80.33],[665.596,79.434],[665.301,78.584],[664.606,78.048],[663.507,78.097]],"c":true}],"h":1},{"t":20,"s":[{"i":[[0.457,-0.374],[0.127,-0.29],[-0.112,-0.215],[-0.277,-0.135],[-0.366,-0.052],[-0.381,0.035],[-0.321,0.126],[-0.186,0.221],[0.024,0.32],[0.08,0.263],[0.144,0.199],[0.213,0.103],[0.289,-0.024],[0.37,-0.183]],"o":[[-0.441,0.361],[-0.127,0.29],[0.112,0.215],[0.277,0.135],[0.366,0.052],[0.381,-0.035],[0.321,-0.126],[0.186,-0.221],[-0.022,-0.295],[-0.08,-0.263],[-0.144,-0.199],[-0.213,-0.103],[-0.289,0.024],[-0.37,0.183]],"v":[[662,79],[661.166,79.977],[661.163,80.734],[661.766,81.26],[662.749,81.543],[663.889,81.57],[664.96,81.329],[665.739,80.81],[666,80],[665.848,79.155],[665.513,78.455],[664.978,77.994],[664.226,77.868],[663.239,78.172]],"c":true}],"h":1},{"t":21,"s":[{"i":[[-0.054,-0.003],[1.062,-0.416],[0.226,-0.43],[0.041,-1.676],[0.115,0.172],[-0.886,0.083],[-0.3,-0.101],[-0.397,-0.559],[-1.011,0.373],[0.048,0.702],[-0.072,0.148],[-0.733,0.212],[-0.005,0.022],[0.854,0.704]],"o":[[-1.525,-0.094],[-1.062,0.416],[0.279,-0.532],[-0.041,1.676],[0.154,0.231],[0.886,-0.083],[0.399,0.135],[0.397,0.559],[0.122,-0.045],[-0.048,-0.702],[0.064,-0.132],[0.733,-0.212],[0.447,-1.976],[0.06,0.049]],"v":[[727,93],[723.025,93.606],[721,95],[721.295,97.73],[721,101],[722.891,101.098],[725,101],[726.041,102.381],[728,103],[728.038,101.577],[728,100],[729.545,99.417],[731,99],[727,92]],"c":true}],"h":1},{"t":22,"s":[{"i":[[-0.015,-0.001],[0.645,-0.098],[0.044,-0.299],[-0.123,-0.552],[0.143,-0.856],[-0.263,-0.366],[-1.118,-0.518],[-0.457,0.229],[-0.746,0.746],[-0.13,0.445],[0.551,1.19],[0.312,0.838],[-0.131,-0.105],[0.414,-0.321]],"o":[[-1.679,-0.052],[-0.645,0.098],[-0.044,0.299],[0.123,0.552],[-0.17,1.017],[0.263,0.366],[1.427,0.661],[0.457,-0.229],[1.029,-1.029],[0.13,-0.445],[0.115,0.248],[-0.312,-0.838],[-0.358,-0.285],[-0.414,0.321]],"v":[[727,94],[723.621,94.055],[722.695,94.637],[722.922,95.901],[723,98],[723.034,99.874],[725,101],[727.511,101.556],[729,100],[730.685,98.12],[730,96],[729.488,94.608],[729,93],[727.72,93.286]],"c":true}],"h":1},{"t":23,"s":[{"i":[[-0.02,0.001],[0.867,-0.161],[-0.332,0.663],[-0.049,-1.282],[-0.131,-0.221],[-1.427,-0.465],[0.762,-0.048],[-0.311,0.761],[0.024,-0.031],[-0.446,0.266],[0.033,0.612],[0.966,0.894],[0.115,0.065],[0.012,-0.246]],"o":[[-0.862,0.02],[-0.867,0.161],[-0.327,0.653],[0.049,1.282],[0.055,0.093],[1.427,0.465],[-0.219,0.014],[0.311,-0.761],[0.247,-0.324],[0.446,-0.266],[-0.019,-0.358],[-0.966,-0.894],[0.026,0.014],[-0.011,0.247]],"v":[[727,94],[724.104,94.513],[723,94],[722.656,97.324],[723,100],[726.113,101.033],[728,102],[728.354,100.487],[729,99],[730.21,98.216],[731,97],[729.072,94.78],[727,93],[727.005,93.511]],"c":true}],"h":1},{"t":24,"s":[{"i":[[0.004,-0.001],[0.277,0.023],[0.319,0.026],[0.258,-0.01],[0.093,-0.084],[0.158,-1.231],[0.098,0.169],[-0.689,0.041],[-0.172,-0.037],[0.026,0.319],[-1.357,0.105],[0.587,1.198],[0.844,0.118],[0,-0.25]],"o":[[-0.131,0.02],[-0.277,-0.023],[-0.319,-0.026],[-0.258,0.01],[-0.27,0.246],[-0.158,1.231],[0.073,0.126],[0.689,-0.041],[1.746,0.38],[-0.026,-0.319],[1.19,-0.091],[-0.587,-1.198],[0.002,0.001],[0,0.25]],"v":[[727,95],[726.362,94.986],[725.442,94.903],[724.551,94.869],[724,95],[723.371,97.811],[723,100],[724.426,100.066],[726,100],[727.792,99.863],[729,99],[729.526,96.52],[727,94],[727.004,94.5]],"c":true}],"h":1},{"t":25.0000010182709,"s":[{"i":[[1.128,-1.344],[-0.088,-0.275],[0.048,-0.511],[0.112,-0.356],[0.104,0.191],[-0.172,-0.001],[-0.225,0.023],[-0.191,0.012],[-0.069,-0.032],[-0.244,-0.262],[-0.129,-0.107],[-0.195,0.209],[-0.443,0.685],[1.203,0.723]],"o":[[0.297,-0.353],[0.088,0.275],[-0.048,0.511],[-0.112,0.356],[0.032,0.058],[0.172,0.001],[0.225,-0.023],[0.191,-0.012],[0.542,0.257],[0.244,0.262],[0.129,0.107],[0.195,-0.209],[0.94,-1.453],[-1.203,-0.723]],"v":[[724,96],[724.559,95.98],[724.601,97.256],[724.343,98.655],[724,99],[724.327,99.079],[724.945,99.038],[725.59,98.978],[726,99],[727.134,99.818],[727.648,100.412],[728.088,100.3],[729,99],[728.051,95.402]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":1,"s":[0],"h":1},{"t":2,"s":[100],"h":1},{"t":26.0000010590017,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 2"},{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":3,"s":[{"i":[[0.844,6.104],[1.235,-1.187],[1.865,-0.394],[1.09,0.29],[1.337,-0.886],[-0.717,-1.458],[0.037,-1.778],[0.607,-1.204],[-0.458,-1.741],[-2.831,-0.71],[-4.33,1.588],[-1.955,5.378]],"o":[[-2.194,-0.14],[-1.235,1.187],[-1.302,0.275],[-1.09,-0.29],[-0.83,1.392],[0.717,1.458],[-0.03,1.445],[-0.607,1.204],[4.324,0.489],[2.711,0.68],[-0.861,-8.194],[-5.503,-2.391]],"v":[[648,126],[643.253,128.1],[639,131],[635.526,130.542],[632,131],[632.405,135.21],[634,140],[632.634,143.778],[632,148],[641,148],[649,152],[657,138]],"c":true}],"h":1},{"t":4,"s":[{"i":[[1.956,-1.73],[-0.042,-0.429],[0.044,-0.175],[0.476,-0.911],[-0.283,-0.85],[-0.705,0.045],[-0.14,-0.067],[-1.788,-0.376],[-3.071,0.959],[-0.142,0.265],[0.057,2.993],[4.021,0]],"o":[[-0.124,0.109],[0.042,0.429],[-0.379,1.507],[-0.476,0.911],[0.038,0.112],[0.706,-0.045],[1.997,0.962],[2.378,0.5],[0.346,-0.108],[1.041,-1.95],[-0.062,-3.245],[-4.454,0]],"v":[[619,84],[618.94,84.951],[619,86],[617.504,89.493],[617,92],[618.423,92.034],[620,92],[622,96],[627,93],[630,93],[628,87],[626,84]],"c":true}],"h":1},{"t":5,"s":[{"i":[[-0.455,-5.103],[-5.025,-1.623],[-3.342,0.926],[-1.522,2.046],[-0.127,3.875],[1.117,0.504],[0.347,1.048],[1.509,1.164],[1.607,-1.124],[1.839,-0.294],[2.111,-1.754],[0.387,-4.779]],"o":[[4.494,2.956],[3.737,1.207],[3.169,-0.879],[2.111,-2.839],[0.099,-3.046],[-1.365,-0.616],[-0.576,-1.739],[-2.763,-2.13],[-2.39,1.67],[-0.733,0.117],[-2.631,2.186],[-0.44,5.44]],"v":[[650,109],[661,110],[671,118],[675,108],[685,100],[679,95],[676,90],[675,82],[668,84],[663,87],[652,86],[654,98]],"c":true}],"h":1},{"t":6,"s":[{"i":[[3.988,-1.168],[-1.041,-2.023],[0.159,-1.829],[-1.022,-1.777],[-3.808,-1.409],[-4.983,2.562],[-1.83,2.61],[-0.359,4.544],[0.042,0.034],[0.745,1.389],[0.366,2.445],[3.301,-0.522]],"o":[[-1.005,2.08],[1.041,2.023],[-0.082,0.94],[1.884,3.277],[5.857,2.167],[3.218,-1.655],[2.558,-3.649],[0.221,-2.8],[-0.888,-0.715],[-1.097,-2.046],[-1.53,-10.217],[-2.975,0.471]],"v":[[664,86],[664.866,92.188],[667,98],[662,108],[674,110],[684,116],[687,107],[697,100],[693,96],[689,92],[688,86],[675,87]],"c":true}],"h":1},{"t":7,"s":[{"i":[[2.851,-1.322],[-0.634,-1.728],[0.169,-2.469],[0.645,-0.718],[0.334,-0.901],[-5.662,-1.609],[-4.538,1.493],[-0.959,1.372],[6.064,6.064],[1.35,2.83],[6.391,-5.235],[2.549,-0.328]],"o":[[-0.366,2.62],[0.634,1.728],[-0.084,1.227],[-0.645,0.718],[-3.178,8.572],[3.511,0.997],[3.65,-1.201],[3.533,-5.055],[-2.253,-2.253],[-1.939,-4.066],[-2.544,2.083],[-2.654,0.341]],"v":[[674,86],[674.853,92.113],[676,98],[674.688,100.744],[673,103],[683,109],[693,116],[696,107],[704,97],[698,91],[691,83],[684,87]],"c":true}],"h":1},{"t":8,"s":[{"i":[[-1.596,-4.208],[-1.326,0.298],[-2.361,-0.683],[-4.078,1.477],[-0.649,0.888],[-0.164,5.03],[0.942,0.766],[0.86,2.003],[0.227,1.44],[5.416,-0.893],[3.772,-3.759],[0.342,-3.992]],"o":[[2.337,0.511],[1.326,-0.298],[4.206,1.216],[1.686,-0.611],[2.924,-4],[0.086,-2.632],[-1.67,-1.358],[-0.569,-1.325],[-1.431,-9.062],[-5.337,0.88],[0.559,4.636],[-0.275,3.208]],"v":[[681,108],[685.983,107.871],[691,108],[701,115],[704,106],[713,99],[709,95],[705,91],[705,86],[692,87],[682,87],[684,98]],"c":true}],"h":1},{"t":9,"s":[{"i":[[3.004,4.178],[1.487,-1.219],[1.8,-0.27],[4.451,-0.762],[0.27,-3.246],[-0.399,-4.785],[-5.798,-1.836],[-4.41,1.636],[0.701,-2.014],[-0.274,0.346],[-0.926,0.508],[2.536,5.376]],"o":[[-2.254,-0.145],[-1.487,1.219],[-3.176,0.477],[-1.318,4.881],[-0.281,3.377],[3.932,3.319],[3.95,1.251],[0.277,-0.103],[0.516,-1.482],[1.498,-1.892],[9.206,-5.048],[-2.201,-4.665]],"v":[[709,82],[703.659,84.188],[699,87],[689,86],[691,97],[687,107],[697,108],[707,114],[709,110],[710,105],[715,103],[711,91]],"c":true}],"h":1},{"t":10,"s":[{"i":[[2.439,4.984],[1.453,-1.193],[1.916,-0.364],[3.68,-2.683],[0.4,-4.57],[-1.219,-2.162],[-6.146,-2.258],[-3.269,1.184],[1.597,-4.588],[-0.539,0.716],[-0.327,1.81],[1.197,2.511]],"o":[[-2.271,-0.135],[-1.453,1.193],[-3.373,0.641],[-0.771,4.825],[-0.312,3.557],[2.664,4.726],[2.76,1.014],[0.216,-0.078],[0.685,-1.967],[1.718,-2.279],[0.618,-3.415],[-1.673,-3.507]],"v":[[714,82],[708.734,84.126],[704,87],[694,87],[696,97],[692,106],[703,108],[712,114],[714,110],[715,105],[724,100],[716,91]],"c":true}],"h":1},{"t":11,"s":[{"i":[[2.391,4.285],[1.382,-1.161],[2.223,-0.415],[3.363,-2.174],[0.206,-3.582],[-0.829,-4.254],[-5.295,-1.509],[-2.807,0.754],[-0.483,1.186],[-1.469,0.696],[-0.375,3.777],[1.608,3.373]],"o":[[-2.249,-0.058],[-1.382,1.161],[-3.148,0.587],[0.31,4.149],[-0.199,3.465],[5.042,1.132],[3.312,0.944],[2.667,-0.717],[1.458,-3.582],[2.353,-1.115],[0.316,-3.186],[-2.076,-4.355]],"v":[[718,82],[712.98,84.145],[708,87],[698,87],[700,97],[697,107],[706,107],[715,114],[717,109],[721,103],[727,99],[720,91]],"c":true}],"h":1},{"t":12,"s":[{"i":[[3.56,-6.568],[-1.371,0.298],[-2.293,-0.734],[-1.21,-1.511],[-2.062,0.714],[0.744,-2.136],[-0.738,0.951],[-1.201,0.754],[1.94,4.451],[4.315,1.195],[-0.102,0.07],[4.847,-2.099]],"o":[[2.224,1.457],[1.371,-0.298],[2.096,0.671],[1.211,1.511],[0.234,-0.081],[0.402,-1.156],[1.325,-1.707],[7.769,-4.878],[-2.217,-5.087],[-0.636,-0.176],[-6.206,4.269],[2.085,8.526]],"v":[[700,106],[704.948,107.042],[710,107],[714.525,111.039],[719,113],[721,109],[722,104],[727,102],[723,91],[719,82],[716,85],[702,87]],"c":true}],"h":1},{"t":13,"s":[{"i":[[-7.905,-0.095],[-0.241,1.402],[-0.639,0.85],[-1.7,0.564],[-0.067,2.236],[0.747,0.629],[0.688,1.548],[1.046,2.841],[-0.292,0.209],[5.682,-0.561],[0.242,-3.253],[-1.166,-4.166]],"o":[[0.398,-1.541],[0.241,-1.402],[1.134,-1.507],[1.7,-0.564],[0.072,-2.395],[-0.762,-0.641],[-0.769,-1.73],[-1.284,-3.49],[-4.54,3.255],[-0.388,4.379],[-0.213,2.869],[10.734,-2.734]],"v":[[722,112],[722.819,107.481],[724,104],[728.8,101.546],[732,98],[728,95],[725,91],[724,84],[718,86],[705,87],[707,97],[704,106]],"c":true}],"h":1},{"t":14,"s":[{"i":[[4.015,0.274],[2.233,-0.5],[4.137,0.338],[0.286,-2.378],[1.072,-3.279],[-1.635,0.27],[-1.697,-0.712],[-0.736,-1.422],[-2.027,1.12],[-1.582,2.346],[-0.707,3.928],[1.872,3.572]],"o":[[-1.932,2.338],[-2.233,0.5],[1.216,4.208],[-0.286,2.378],[1.76,1.367],[1.635,-0.27],[1.027,0.43],[0.736,1.422],[2.214,-2.324],[1.863,-2.762],[-2.088,-2.818],[-1.056,-2.015]],"v":[[723,84],[717.154,88.007],[708,88],[709.216,97.196],[707,105],[712.047,105.991],[717,106],[719.25,109.663],[723,111],[725,104],[733,98],[726,91]],"c":true}],"h":1},{"t":15,"s":[{"i":[[1.202,2.223],[1.025,-0.984],[1.648,-0.213],[1.124,0.421],[1.614,-0.57],[0.316,-1.902],[0.848,-3.27],[-1.514,0.219],[-1.484,-0.608],[-3.332,1.81],[-4.465,1.868],[1.48,3.442]],"o":[[-2.253,-0.148],[-1.025,0.984],[-0.891,0.115],[-1.124,-0.421],[1.111,4.12],[-0.316,1.902],[1.462,1.27],[1.514,-0.219],[1.928,0.789],[1.445,-4.889],[-0.539,-3.811],[-0.697,-1.62]],"v":[[726,86],[721.547,87.73],[718,90],[715.042,89.159],[711,89],[711.969,97.137],[710,104],[714.484,104.997],[719,105],[724,109],[733,99],[727,92]],"c":true}],"h":1},{"t":16,"s":[{"i":[[-2.012,0.488],[1.425,1.075],[-0.942,3.442],[1.06,-0.714],[1.247,-0.285],[0.841,0.261],[1.24,-0.726],[0.236,-1.953],[0.849,-1.877],[-1.636,-1.031],[-2.109,-0.558],[-1.125,1.375]],"o":[[-0.243,-2.257],[-1.425,-1.075],[-1.512,-1.141],[-1.06,0.714],[-1.397,0.32],[-0.841,-0.261],[0.793,2.309],[-0.236,1.953],[3.346,-0.68],[1.636,1.031],[0.489,-2.011],[1.125,-1.375]],"v":[[732,99],[728.611,94.889],[727,89],[723.301,88.93],[720,91],[716.882,90.695],[714,91],[714.731,97.324],[713,103],[719.928,104.072],[725,107],[727.358,101.858]],"c":true}],"h":1},{"t":17,"s":[{"i":[[-2.364,1.596],[-1.598,1.344],[-0.015,0.114],[0.95,1.041],[0.331,0.885],[-0.046,0.697],[0.123,0.054],[0.658,-0.53],[1.34,-0.335],[-0.567,-4.723],[-1.084,-1.863],[-0.71,-0.262]],"o":[[-0.409,-1.511],[1.598,-1.344],[0.13,-0.953],[-0.95,-1.041],[-0.06,-0.159],[0.046,-0.697],[-1.027,-0.454],[-0.658,0.53],[-6.151,1.538],[0.375,3.122],[0.325,0.558],[3.413,1.257]],"v":[[725,106],[727.682,101.453],[731,99],[729.346,95.949],[727,93],[727.048,91.422],[727,90],[724.735,90.408],[722,92],[717,95],[716,102],[721,102]],"c":true}],"h":1},{"t":18,"s":[{"i":[[-0.08,-0.013],[0.455,-0.276],[0.445,-0.014],[1.067,-1.103],[0.149,-1.529],[-0.605,-1.108],[-3.423,-1.597],[-1.349,0.322],[-0.685,0.983],[-0.136,0.828],[0.417,0.417],[1.144,0.716]],"o":[[-0.736,-0.12],[-0.455,0.276],[-0.584,0.019],[-0.741,0.766],[-0.252,2.582],[1.949,3.571],[1.241,0.579],[1.207,-0.288],[0.827,-1.187],[0.216,-1.311],[-0.844,-0.844],[0.08,0.05]],"v":[[725,92],[723.281,92.399],[722,93],[718,92],[719,97],[717,101],[723,102],[726,105],[727,101],[731,99],[727,92],[725,91]],"c":true}],"h":1},{"t":19,"s":[{"i":[[0.58,0.056],[0.287,-0.239],[0.377,-0.09],[1.091,0.098],[0.231,-0.293],[-0.372,3.119],[-3.94,-1.521],[-2.784,0.714],[-0.353,0.363],[-0.206,1.063],[1.248,2.296],[0.146,0.548]],"o":[[-0.475,-0.046],[-0.287,0.239],[-0.407,0.097],[-1.091,-0.098],[0.631,-0.804],[-0.506,4.24],[2.726,1.052],[0.325,-0.083],[0.628,-0.647],[0.369,-1.902],[-0.267,-0.491],[-0.52,-1.947]],"v":[[726,92],[724.926,92.398],[724,93],[721.368,92.853],[719,93],[720,98],[723,101],[727,104],[728,100],[731,99],[728,94],[728,92]],"c":true}],"h":1},{"t":20,"s":[{"i":[[-0.038,0.001],[1.185,0.11],[0.418,-0.417],[0.021,-0.882],[-0.99,-1.578],[-0.586,-0.223],[-1.767,0.363],[-0.68,0.937],[0.114,-0.076],[1.916,2.265],[0.488,0.563],[0.958,0.75]],"o":[[-0.841,0.022],[-1.185,-0.11],[-0.672,0.673],[-0.023,0.961],[0.292,0.465],[1.914,0.728],[1.198,-0.246],[-0.063,0.087],[3.114,-2.066],[-0.496,-0.586],[-0.771,-0.89],[0.051,0.04]],"v":[[726,93],[722.682,92.703],[720,93],[721,97],[720,101],[724,101],[727,104],[728,100],[730,99],[729,95],[728,93],[726,92]],"c":true}],"h":1},{"t":21,"s":[{"i":[[0.639,-1.131],[0.02,-0.253],[-0.078,-0.245],[-0.158,-0.218],[-0.218,-0.174],[-0.259,-0.111],[-0.28,-0.029],[-0.283,0.07],[-0.266,0.188],[0.126,0.669],[0.406,0.612],[0.577,0.011]],"o":[[-0.138,0.243],[-0.02,0.253],[0.078,0.245],[0.158,0.218],[0.218,0.174],[0.259,0.111],[0.28,0.029],[0.283,-0.07],[0.262,-0.185],[-0.126,-0.669],[-0.406,-0.612],[-0.577,-0.011]],"v":[[654,142],[653.768,142.75],[653.861,143.501],[654.22,144.201],[654.788,144.793],[655.508,145.224],[656.322,145.439],[657.171,145.382],[658,145],[658.177,143.583],[657.352,141.526],[655.851,140.456]],"c":true}],"h":1},{"t":22,"s":[{"i":[[0.571,-0.268],[0.287,-0.381],[0.093,-0.491],[-0.241,-0.489],[-0.714,-0.376],[-0.285,0.101],[-0.518,0.007],[-0.348,-0.097],[0.222,-0.213],[-0.327,1.202],[0.181,0.315],[0.784,-0.06]],"o":[[-0.342,0.161],[-0.287,0.381],[-0.093,0.491],[0.241,0.489],[-0.348,-0.183],[0.285,-0.101],[0.518,-0.007],[0.348,0.097],[-0.129,0.123],[0.327,-1.202],[-0.293,-0.509],[-0.784,0.06]],"v":[[668,149],[667.021,149.841],[666.416,151.178],[666.603,152.675],[668,154],[668.007,153.571],[669.311,153.406],[670.711,153.537],[671,154],[671.539,151.828],[672,149],[670.208,148.417]],"c":true}],"h":1},{"t":23,"s":[{"i":[[0.011,-0.006],[0.287,-0.416],[0.167,-0.55],[-0.203,-0.483],[-0.824,-0.217],[-0.564,0.487],[-0.135,0.773],[0.496,0.649],[1.331,0.116],[-0.002,-0.092],[-0.005,-0.124],[0,-0.095]],"o":[[-0.156,0.083],[-0.287,0.416],[-0.167,0.55],[0.203,0.483],[0.789,0.208],[0.564,-0.487],[0.136,-0.773],[-0.496,-0.649],[-0.007,0],[0.002,0.092],[0.005,0.124],[0,0.095]],"v":[[668,149],[667.273,149.8],[666.53,151.299],[666.521,152.899],[668,154],[670.081,153.479],[671.181,151.486],[670.69,149.251],[668,148],[667.994,148.152],[668.006,148.491],[668.015,148.834]],"c":true}],"h":1},{"t":24,"s":[{"i":[[0.572,-0.71],[0.053,-0.205],[-0.013,-0.231],[-0.075,-0.229],[-0.134,-0.199],[-0.19,-0.142],[-0.241,-0.056],[-0.29,0.057],[-0.335,0.198],[-0.016,0.573],[0.39,0.459],[0.585,0.032]],"o":[[-0.122,0.151],[-0.053,0.205],[0.013,0.231],[0.075,0.229],[0.134,0.199],[0.19,0.142],[0.241,0.056],[0.29,-0.057],[0.63,-0.373],[0.016,-0.573],[-0.39,-0.459],[-0.585,-0.032]],"v":[[668,150],[667.739,150.541],[667.681,151.202],[667.815,151.899],[668.13,152.548],[668.617,153.066],[669.264,153.37],[670.062,153.376],[671,153],[671.916,151.503],[671.303,149.876],[669.788,149.061]],"c":true}],"h":1},{"t":25.0000010182709,"s":[{"i":[[0.021,-0.006],[0.091,-0.4],[-0.441,-0.354],[-0.561,-0.152],[-0.271,0.205],[0.058,0.448],[0.314,0.432],[0.348,0.268],[0.162,-0.044],[-0.003,-0.093],[-0.011,-0.122],[-0.003,-0.093]],"o":[[-1.033,0.289],[-0.091,0.4],[0.441,0.354],[0.561,0.152],[0.418,-0.317],[-0.058,-0.448],[-0.314,-0.432],[-0.348,-0.268],[-0.021,0.006],[0.003,0.093],[0.011,0.122],[0.003,0.093]],"v":[[669,150],[667.417,151.072],[668.045,152.242],[669.65,153.04],[671,153],[671.483,151.816],[670.87,150.459],[669.822,149.373],[669,149],[668.976,149.163],[669,149.5],[669.024,149.837]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":2,"s":[0],"h":1},{"t":3,"s":[100],"h":1},{"t":26.0000010590017,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 3"},{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":3,"s":[{"i":[[-0.193,0.2],[0.556,-0.728],[-1.686,-1.572],[-0.366,-0.328],[-0.183,-0.428],[0.041,-0.707],[-0.106,-0.035],[-0.959,0.763],[-1.12,0.294],[0.004,0.385],[-0.037,2.677],[-0.177,0.748],[1.736,0],[1.267,0.782],[0.332,-0.128]],"o":[[-1.463,1.517],[-0.556,0.728],[1.352,1.26],[0.366,0.328],[0.06,0.138],[-0.041,0.707],[1.046,0.344],[0.958,-0.763],[2.981,-0.782],[-0.004,-0.385],[0.028,-2.008],[0.177,-0.748],[-1.599,0],[-1.267,-0.782],[-0.54,0.208]],"v":[[614,134],[610.639,136.959],[612,140],[614.376,142.125],[615,143],[614.966,144.578],[615,146],[617.945,144.979],[621,143],[624.708,141.921],[624,138],[624.823,133.994],[623,133],[618.55,131.404],[616,130]],"c":true}],"h":1},{"t":4,"s":[{"i":[[-0.748,7.321],[1.251,-0.019],[1.043,0.583],[-0.059,0.446],[0.1,0.141],[0.438,0.176],[0.15,0.161],[0.601,0.795],[-0.33,-0.1],[1.568,-0.369],[0.857,-3.143],[0.696,-0.278],[4.452,-8.222],[-3.508,0.255],[-2.454,1.387]],"o":[[-0.953,-0.492],[-1.251,0.019],[-0.137,-0.077],[0.059,-0.446],[-0.096,-0.136],[-0.439,-0.176],[0.075,0.081],[-0.601,-0.795],[-3.324,-1.01],[-3.913,0.921],[-0.345,1.265],[-8.481,3.392],[2.265,1.899],[3.592,-0.261],[-2.408,-9.585]],"v":[[630,123],[626.567,122.568],[623,122],[622.972,121.048],[623,120],[622.041,119.519],[621,119],[619.809,117.485],[619,116],[614,118],[611,121],[608,124],[610,140],[618,138],[627,139]],"c":true}],"h":1},{"t":5,"s":[{"i":[[2.217,-0.727],[-0.189,-0.966],[0.613,-1.172],[0.863,-0.257],[-0.098,-1.743],[-0.784,-0.548],[-0.827,-1.14],[-0.187,-1.632],[-1.864,-1.562],[-2.771,-0.265],[-1.526,0.457],[-0.876,2.011],[-0.685,3.066],[4.41,1.275],[1.672,-0.093]],"o":[[-1.144,0.963],[0.189,0.966],[-0.644,1.231],[-0.864,0.257],[0.038,0.669],[0.784,0.548],[1.387,1.911],[0.187,1.632],[1.389,-2.604],[2.771,0.265],[-1.188,-3.888],[0.876,-2.011],[-8.11,0.563],[-0.962,-0.278],[-1.91,0.107]],"v":[[620,121],[619.102,123.843],[619,127],[616.444,128.616],[615,131],[616.408,132.647],[619,135],[620.642,140.262],[623,145],[629.897,142.389],[637,143],[637.096,134.883],[640,128],[627,121],[624,124]],"c":true}],"h":1},{"t":6,"s":[{"i":[[2.243,1.046],[1.13,-1.537],[1.168,-1.499],[-0.901,-1.261],[-0.615,-0.802],[-0.405,-0.329],[-0.128,-0.356],[-1.718,-1.5],[-5.794,-2.464],[-0.619,2.676],[0.486,3.457],[2.429,1.164],[0.812,0.927],[1.937,0.625],[1.499,-0.151]],"o":[[-0.313,2.353],[-1.13,1.537],[1.779,0.156],[0.901,1.261],[0.253,0.329],[0.405,0.329],[0.582,1.625],[5.164,-2.435],[2.618,-2.807],[0.571,-2.472],[-2.571,-2.336],[-1.857,-0.89],[-1.219,-1.391],[-0.754,-0.243],[-2.416,0.243]],"v":[[627,124],[624.641,129.641],[621,134],[624.873,136.516],[627,140],[628.094,140.981],[629,142],[630,148],[644,147],[644,139],[648,132],[641,131],[639,127],[635,125],[632,127]],"c":true}],"h":1},{"t":7,"s":[{"i":[[-1.955,5.694],[1.191,-0.161],[1.837,1.294],[0.18,0.681],[0.127,0.166],[5.375,0.907],[3.906,-2.114],[0.087,-0.338],[-0.321,-3.31],[-2.436,-3.623],[-0.563,-0.513],[-0.815,-1.813],[-0.65,-2.545],[-2.772,0.121],[-2.247,1.674]],"o":[[-1.4,-1.348],[-1.191,0.161],[-0.154,-0.108],[-0.18,-0.681],[-2.704,-3.536],[-3.909,-0.659],[-0.25,0.136],[-0.887,3.45],[0.241,2.48],[0.404,0.601],[1.283,1.169],[0.921,2.048],[3.285,0.88],[2.593,-0.113],[-1.567,-7.688]],"v":[[654,135],[650.328,133.959],[646,133],[645.48,131.543],[645,130],[636,129],[631,127],[631,130],[627,136],[631,139],[632,143],[636,144],[636,150],[644,148],[651,149]],"c":true}],"h":1},{"t":8,"s":[{"i":[[-1.776,5.514],[1.474,0.801],[0.843,0.94],[1.451,-0.083],[2.698,0.661],[0.168,0.578],[1.723,-0.706],[-0.063,-0.969],[0.458,-0.798],[1.051,-0.342],[-0.81,-1.572],[-3.56,-1.786],[0.174,-2.071],[0,-2.333],[-6.7,-1.467]],"o":[[-2.261,0.144],[-1.474,-0.801],[-1.498,-1.671],[-1.451,0.083],[-1.606,-0.394],[-0.168,-0.578],[-0.793,0.325],[0.063,0.969],[-0.608,1.059],[-1.051,0.342],[5.201,0.124],[-0.513,-0.257],[0,2.333],[6.064,-1.017],[-1.974,-7.281]],"v":[[659,137],[653.437,135.813],[650,133],[645.9,131.243],[640,131],[638.087,129.176],[636,129],[635.248,131.145],[635,134],[631.937,135.616],[631,138],[638,145],[641,145],[641,152],[656,151]],"c":true}],"h":1},{"t":9,"s":[{"i":[[-0.236,3.069],[0.992,-0.527],[0.844,-0.632],[1.023,-0.197],[0.783,0.301],[0.921,-1.021],[-0.093,-1.941],[1.015,-3.069],[-1.918,-1.082],[-2.49,-0.51],[0.098,1.198],[-0.562,1.012],[-1.391,0.515],[0.199,1.795],[1.438,1.395]],"o":[[-1.468,-0.119],[-0.992,0.527],[-0.844,0.632],[-0.946,0.182],[-0.783,-0.301],[0.641,3.165],[0.093,1.941],[3.837,-0.837],[1.918,1.082],[0.829,-1.195],[-0.098,-1.198],[0.635,-1.144],[1.391,-0.515],[-1.483,-1.351],[-1.438,-1.395]],"v":[[710,157],[706.392,157.747],[703.719,159.621],[701,161],[698.482,160.371],[696,161],[697.242,168.072],[696,175],[704.01,175.99],[710,179],[710.7,175.363],[711,172],[714.626,169.988],[717,167],[712.211,163.288]],"c":true}],"h":1},{"t":10,"s":[{"i":[[3.212,0.213],[0.996,0.439],[1.649,0.412],[2.038,-0.725],[1.123,-1.776],[-0.185,0.123],[-2.624,-4.162],[-1.35,-1.194],[-0.361,-0.03],[0.713,-3.733],[-5.781,-1.55],[-2.709,4.372],[2.361,1.572],[0.238,0.306],[0.729,0.808]],"o":[[1.632,-2.83],[-0.996,-0.439],[-2.866,-0.717],[-1.506,0.535],[0.121,-0.192],[-4.129,2.739],[1.045,1.658],[-0.486,-0.43],[2.477,0.207],[4.991,-1.422],[-1.504,-6.737],[-2.716,-1.9],[-0.275,-0.183],[-0.655,-0.841],[-1.566,1.434]],"v":[[650,139],[650.461,134.687],[646,134],[642,132],[641,137],[639,138],[642,144],[644,147],[646,145],[649,155],[663,154],[666,141],[658,139],[657,136],[654,134]],"c":true}],"h":1},{"t":11,"s":[{"i":[[2.207,-0.793],[-0.525,1.041],[0.903,1.074],[0.86,0.215],[2.134,-0.841],[-0.163,0.598],[1.498,-1.498],[-1.72,-3.186],[-0.94,-0.749],[-1.304,-0.414],[0.286,-2.625],[-4.72,-1.602],[-1.114,4.219],[2.068,0.992],[3.036,-0.216]],"o":[[-1.198,-0.761],[0.525,-1.041],[-0.518,-0.616],[-3.104,-0.776],[0.499,-0.197],[-0.903,3.312],[-2.739,2.739],[0.619,1.147],[1.145,0.912],[2.795,0.889],[3.773,-1.865],[-1.249,-6.582],[-1.938,-2.097],[-2.138,-1.026],[-2.701,0.299]],"v":[[653,141],[652.779,138.235],[653,135],[648,135],[644,133],[643,135],[641,139],[644,144],[645,147],[649,146],[652,156],[665,155],[668,142],[662,141],[657,136]],"c":true}],"h":1},{"t":12,"s":[{"i":[[3.917,0.584],[0.778,1.48],[-0.403,0.186],[0.413,-0.808],[-0.197,-1.682],[-1.988,-2.884],[-1.526,-1.13],[-0.394,-0.073],[-0.37,-1.392],[-0.328,-2.057],[-6.087,-1.979],[-0.605,2.679],[0.711,2.357],[1.699,0.884],[2.999,-0.173]],"o":[[-1.306,-2.045],[0.123,0.234],[-0.735,0.34],[-1.407,2.754],[0.238,2.032],[1.104,1.601],[-0.456,-0.338],[0.055,0.01],[0.459,1.725],[5.283,-2.33],[1.275,-2.014],[0.514,-2.276],[-1.968,-1.269],[-2.174,-1.131],[-2.447,0.887]],"v":[[654,142],[655,136],[646,134],[645,137],[642,142],[646,145],[648,148],[650,146],[654,151],[654,157],[667,156],[667,149],[670,143],[664,142],[659,137]],"c":true}],"h":1},{"t":13,"s":[{"i":[[2.267,-1.067],[-0.538,1.508],[0.731,0.94],[0.782,0.066],[4.847,-2.639],[0.109,-0.35],[-0.112,-1.527],[-1.098,-2.497],[-0.349,-0.224],[-1.266,-0.181],[-0.151,-0.566],[-0.247,-2.11],[-5.679,-1.506],[-1.048,5.176],[4.649,1.199]],"o":[[-1.419,-1.028],[0.538,-1.508],[-0.511,-0.657],[-4.405,-0.374],[-0.269,0.146],[-0.462,1.484],[0.189,2.579],[0.185,0.42],[1.701,1.092],[0.825,0.118],[0.384,1.442],[4.981,-1.243],[-2.151,-6.324],[-7.035,-0.04],[-0.366,2.967]],"v":[[656,144],[655.484,139.934],[656,136],[652,137],[647,135],[647,138],[644,142],[648,145],[648,148],[652,146],[656,151],[656,157],[669,156],[671,144],[660,138]],"c":true}],"h":1},{"t":14,"s":[{"i":[[4.276,0.289],[-0.374,1.69],[0.287,0.319],[1.045,-0.218],[1.351,0.353],[1.471,-2.691],[-0.428,-3.476],[-0.274,-0.274],[-2.937,0.035],[-2.94,-1.737],[2.46,-7.164],[-5.176,-1.03],[-1.497,3.954],[2.17,1.175],[0.302,0.302]],"o":[[-1.209,-0.921],[0.374,-1.69],[-0.468,-0.519],[-1.045,0.218],[-2.821,-0.736],[-2.133,3.902],[0.021,0.168],[1.796,1.796],[1.932,-0.023],[-2.965,4.477],[4.05,-1.993],[-2.083,-5.116],[-1.884,-2.185],[-0.247,-0.134],[-4.115,-4.115]],"v":[[657,145],[656.308,140.548],[657,137],[654.662,136.875],[651,137],[648,139],[645,143],[649,144],[651,148],[655,145],[658,157],[670,156],[672,145],[666,144],[665,141]],"c":true}],"h":1},{"t":15,"s":[{"i":[[1.718,-1.015],[-0.046,-0.447],[0.064,-0.144],[0.717,-0.137],[-1.359,-1.359],[-0.646,-0.904],[-0.044,-0.01],[-0.492,0.243],[-0.375,0.174],[0.002,0.687],[-0.058,1.35],[-0.39,0.618],[0.56,0.555],[1.042,-0.116],[0.492,0.13]],"o":[[-0.119,0.07],[0.046,0.447],[-0.49,1.094],[-0.717,0.137],[0.373,0.373],[0.646,0.904],[0.656,0.145],[0.492,-0.243],[1.949,-0.903],[-0.002,-0.687],[-0.001,0.026],[0.39,-0.618],[-0.339,-0.336],[-1.042,0.116],[-1.359,-0.358]],"v":[[650,138],[649.959,138.945],[650,140],[647.613,141.301],[648,143],[649.747,145.273],[651,147],[652.71,146.739],[654,146],[656.419,143.835],[656,141],[656.919,139.936],[657,138],[654.615,137.845],[652,138]],"c":true}],"h":1},{"t":16,"s":[{"i":[[-0.108,0.082],[0.188,-0.377],[0.249,-0.5],[0.186,-0.373],[0,0.004],[-0.516,-0.591],[-0.591,-0.58],[-0.229,-0.006],[-0.426,0.486],[-0.307,0.056],[0.234,0.706],[-0.082,0.838],[-0.359,0.37],[0.438,0.481],[1.32,-0.248]],"o":[[-0.004,0.003],[-0.188,0.377],[-0.249,0.5],[-0.186,0.373],[0.003,0.037],[0.516,0.591],[0.591,0.58],[-0.012,0],[0.426,-0.486],[1.853,-0.339],[-0.234,-0.706],[0.004,-0.04],[0.359,-0.37],[-0.83,-0.91],[-1.32,0.248]],"v":[[651,139],[650.681,139.633],[649.994,141.011],[649.311,142.384],[649,143],[649.889,144.082],[651.66,145.98],[653,147],[653.761,146.042],[655,145],[656.828,143.374],[656,141],[656.832,140.33],[657,139],[653.297,138.379]],"c":true}],"h":1},{"t":17,"s":[{"i":[[1.083,0.036],[0.042,-0.301],[0.122,-0.18],[0.164,-0.107],[0.169,-0.084],[0.137,-0.111],[0.068,-0.187],[-0.039,-0.312],[-0.64,-0.375],[-0.826,-0.113],[-0.648,0.069],[-0.107,0.168],[0.038,0.697],[0.477,0.547],[0.826,0.326]],"o":[[0.075,0.473],[-0.042,0.301],[-0.122,0.18],[-0.164,0.107],[-0.169,0.084],[-0.137,0.111],[-0.068,0.187],[0.09,0.718],[0.64,0.375],[0.826,0.113],[0.648,-0.069],[0.493,-0.779],[-0.038,-0.697],[-0.478,-0.546],[-0.826,-0.326]],"v":[[652,139],[652.04,140.149],[651.785,140.858],[651.347,141.276],[650.838,141.551],[650.369,141.831],[650.052,142.265],[650,143],[651.185,144.619],[653.475,145.33],[655.777,145.376],[657,145],[657.659,142.769],[656.863,140.885],[654.886,139.56]],"c":true}],"h":1},{"t":18,"s":[{"i":[[0.05,-0.029],[0.171,-0.324],[0.263,-0.424],[0.21,-0.263],[0.013,0.159],[-0.179,-0.134],[-0.241,-0.183],[-0.192,-0.208],[-0.032,-0.207],[-0.821,0.346],[-0.547,1.043],[0.686,1.185],[1.091,0.247],[-0.32,0.086],[-0.025,-0.239]],"o":[[0.064,-0.037],[-0.171,0.324],[-0.263,0.424],[-0.21,0.263],[0.005,0.059],[0.179,0.134],[0.241,0.183],[0.192,0.208],[0.138,0.906],[0.821,-0.346],[0.547,-1.043],[0.043,0.073],[-1.091,-0.247],[-0.052,0.014],[0.025,0.239]],"v":[[653,140],[652.803,140.496],[652.116,141.683],[651.371,142.778],[651,143],[651.303,143.296],[651.96,143.778],[652.637,144.371],[653,145],[654.678,145.702],[656.969,143.481],[657,140],[654.792,139.619],[653,139],[652.999,139.489]],"c":true}],"h":1},{"t":19,"s":[{"i":[[0.266,-0.205],[0.11,-0.364],[-0.122,-0.369],[-0.287,-0.33],[-0.385,-0.245],[-0.418,-0.115],[-0.384,0.059],[-0.283,0.279],[-0.116,0.543],[0.085,0.291],[0.198,0.271],[0.278,0.226],[0.325,0.156],[0.339,0.061],[0.319,-0.059]],"o":[[-0.408,0.314],[-0.11,0.364],[0.122,0.369],[0.287,0.33],[0.385,0.245],[0.418,0.115],[0.384,-0.059],[0.283,-0.279],[0.061,-0.286],[-0.085,-0.291],[-0.198,-0.271],[-0.278,-0.226],[-0.325,-0.156],[-0.339,-0.061],[-0.319,0.059]],"v":[[653,141],[652.24,142.027],[652.274,143.138],[652.903,144.197],[653.928,145.07],[655.149,145.622],[656.368,145.717],[657.384,145.222],[658,144],[657.956,143.129],[657.522,142.28],[656.799,141.528],[655.885,140.949],[654.881,140.618],[653.886,140.61]],"c":true}],"h":1},{"t":20,"s":[{"i":[[-0.126,0.141],[-0.071,-0.728],[-0.571,-0.431],[-0.714,0.012],[-0.5,0.603],[0.067,0.291],[0.178,0.293],[0.147,0.231],[-0.025,0.103],[-0.151,0.037],[-0.171,0.078],[-0.059,0.127],[0.183,0.183],[0.635,-0.047],[0.388,-0.205]],"o":[[-0.785,0.877],[0.071,0.728],[0.571,0.431],[0.714,-0.012],[0.186,-0.224],[-0.067,-0.291],[-0.178,-0.293],[-0.147,-0.231],[0.001,-0.003],[0.151,-0.037],[0.171,-0.078],[0.059,-0.127],[-0.615,-0.615],[-0.635,0.047],[-0.388,0.205]],"v":[[654,141],[653.018,143.445],[654.071,145.221],[656.089,145.886],[658,145],[658.143,144.211],[657.741,143.319],[657.218,142.517],[657,142],[657.261,141.942],[657.776,141.77],[658.153,141.464],[658,141],[656.059,140.274],[654.459,140.778]],"c":true}],"h":1},{"t":21,"s":[{"i":[[0.151,-0.041],[0.284,-0.086],[0.359,-0.114],[0.27,-0.096],[0.019,-0.032],[-0.106,-0.703],[-0.196,-0.659],[-0.127,-0.114],[-0.603,0.346],[-0.184,-0.017],[-0.377,-0.36],[-0.466,0.442],[-0.308,1.175],[0.154,0.377],[0.909,0.131]],"o":[[-0.047,0.012],[-0.284,0.086],[-0.359,0.114],[-0.27,0.096],[-0.144,0.244],[0.106,0.703],[0.196,0.659],[0.406,0.365],[0.603,-0.346],[0.027,0.002],[0.376,0.36],[-0.08,0.076],[0.308,-1.175],[-0.211,-0.517],[-0.909,-0.131]],"v":[[668,148],[667.464,148.159],[666.459,148.47],[665.475,148.796],[665,149],[664.982,150.546],[665.476,152.714],[666,154],[667.666,153.761],[669,153],[669.671,153.833],[671,154],[671.556,151.84],[672,149],[669.955,148.081]],"c":true}],"h":1},{"t":22,"s":[{"i":[[0.006,-0.002],[0.282,0.02],[0.329,0.035],[0.258,-0.003],[0.069,-0.093],[-0.155,-0.769],[-0.614,-0.524],[-0.652,-0.243],[-0.27,0.072],[-0.285,0.753],[-0.362,0.61],[-0.034,-0.48],[0.785,0.696],[-0.163,-0.081],[0.001,-0.248]],"o":[[-0.116,0.047],[-0.282,-0.02],[-0.329,-0.035],[-0.258,0.003],[-0.724,0.978],[0.155,0.769],[0.614,0.524],[0.652,0.243],[-0.198,0.053],[0.285,-0.753],[0.362,-0.61],[-0.021,-0.298],[-0.785,-0.696],[0.01,0.005],[-0.001,0.248]],"v":[[728,176],[727.374,176.027],[726.429,175.932],[725.519,175.87],[725,176],[724.251,178.629],[725.509,180.576],[727.512,181.735],[729,182],[729.232,180.714],[730.304,178.432],[731,178],[729.362,176.216],[728,175],[728.012,175.502]],"c":true}],"h":1},{"t":23,"s":[{"i":[[0.498,-0.151],[0.321,-0.007],[0.288,-0.02],[0.198,-0.128],[0.052,-0.33],[-0.209,-0.356],[-0.377,-0.374],[-0.479,-0.206],[-0.516,0.147],[-0.281,0.517],[-0.346,0.459],[-0.047,-0.218],[0.515,0.306],[-0.014,-0.019],[0.02,-0.095]],"o":[[-0.296,0.089],[-0.321,0.007],[-0.288,0.02],[-0.198,0.128],[-0.024,0.151],[0.209,0.356],[0.377,0.374],[0.479,0.206],[-0.149,0.043],[0.281,-0.517],[0.346,-0.459],[0.044,0.204],[-0.515,-0.306],[-0.422,-0.531],[-0.02,0.095]],"v":[[728,177],[727.06,177.122],[726.133,177.139],[725.389,177.337],[725,178],[725.294,178.807],[726.19,179.948],[727.49,180.865],[729,181],[729.288,180.134],[730.32,178.516],[731,178],[730.022,177.639],[729,177],[728.557,176.488]],"c":true}],"h":1},{"t":24.00000097754,"s":[{"i":[[0.092,-0.047],[0.188,0.014],[0.217,0.028],[0.171,0],[0.05,-0.07],[-0.111,-0.539],[-0.433,-0.357],[-0.481,-0.14],[-0.253,0.113],[-0.082,0.306],[-0.132,0.402],[-0.109,0.27],[-0.012,-0.09],[0.266,0.164],[0.276,-0.003]],"o":[[-0.083,0.042],[-0.188,-0.014],[-0.217,-0.028],[-0.171,0],[-0.487,0.685],[0.111,0.539],[0.433,0.357],[0.481,0.14],[-0.041,0.018],[0.082,-0.306],[0.132,-0.402],[0.109,-0.27],[-0.061,-0.454],[-0.266,-0.164],[-0.276,0.003]],"v":[[728,177],[727.576,177.032],[726.95,176.958],[726.349,176.906],[726,177],[725.504,178.844],[726.389,180.196],[727.83,180.95],[729,181],[729.081,180.512],[729.421,179.393],[729.801,178.328],[730,178],[729.461,177.104],[728.601,176.894]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":2,"s":[0],"h":1},{"t":3,"s":[100],"h":1},{"t":25.0000010182709,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 4"},{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":4,"s":[{"i":[[-2.039,4.816],[0.976,0.722],[0.796,1.007],[4.485,0.662],[3.247,-0.666],[3.674,-0.347],[3.032,-6.472],[-2.784,-0.571],[-2.901,1.828]],"o":[[-1.298,-1.104],[-0.977,-0.722],[-2.358,-2.983],[-0.292,-0.043],[-2.509,0.515],[2.344,6.805],[2.611,2.626],[3.523,0.723],[0.896,-7.316]],"v":[[673,146],[669.624,143.428],[667,141],[662,134],[656,139],[649,139],[649,155],[657,155],[665,159]],"c":true}],"h":1},{"t":5,"s":[{"i":[[1.277,5.39],[2.001,-1.113],[4.142,1.012],[-0.062,-2.392],[1.157,-2.853],[-1.286,0.352],[-1.351,-0.317],[-4.186,1.733],[-2.169,4.831]],"o":[[-2.855,0.56],[-2.001,1.113],[0.909,3.579],[0.062,2.392],[1.504,1.089],[1.286,-0.352],[2.732,0.641],[-0.868,-7.868],[-5.107,-1.56]],"v":[[678,141],[671.465,144.179],[663,145],[664.549,153.545],[663,161],[667.115,161.579],[671,161],[679,165],[687,152]],"c":true}],"h":1},{"t":6,"s":[{"i":[[0.244,6.306],[2.001,-1.113],[4.142,1.012],[2.314,-6.279],[-4.953,-1.38],[-1.752,2.601],[-0.315,0.142],[-0.349,0.249],[1.113,2.897]],"o":[[-2.855,0.56],[-2.001,1.113],[1.306,6.679],[7.974,-1.64],[2.263,-2.514],[0.174,-0.259],[0.31,-0.14],[1.071,-0.764],[-4.786,-2.618]],"v":[[689,146],[682.465,149.179],[674,150],[674,166],[689,170],[691,162],[693,162],[694,160],[697,157]],"c":true}],"h":1},{"t":7,"s":[{"i":[[0.506,3.96],[0.905,0.715],[0.782,1.096],[4.311,0.956],[0.218,-0.187],[4.671,-0.621],[2.132,-6.93],[-3.693,-2.307],[-1.18,1.936]],"o":[[-1.597,-1.046],[-0.905,-0.715],[-2.036,-2.855],[-0.009,-0.002],[-3.343,2.866],[1.14,7.357],[7.259,-1.259],[2.328,-1.599],[1.515,-2.486]],"v":[[705,161],[701.388,158.537],[699,156],[695,150],[693,153],[683,154],[683,170],[697,174],[699,167]],"c":true}],"h":1},{"t":8,"s":[{"i":[[0.887,5.113],[1.828,-1.172],[3.978,0.978],[0,-2.271],[0.945,-2.957],[-1.922,-1.005],[-2.885,0.09],[-1.765,1.401],[-0.659,2.508]],"o":[[-2.709,0.291],[-1.828,1.172],[0.945,2.957],[0,2.271],[4.428,-0.93],[1.922,1.005],[-0.721,-3.887],[1.765,-1.401],[-4.577,-1.423]],"v":[[704,154],[697.952,156.952],[690,158],[691.418,165.5],[690,173],[698.657,173.87],[705,176],[707.465,168.966],[712,164]],"c":true}],"h":1},{"t":9,"s":[{"i":[[2.614,-1.187],[0.656,-1.244],[-0.25,-1.816],[-0.268,-0.837],[-0.224,-0.095],[-2.739,0.642],[-0.339,0.448],[-0.642,-1.029],[0.744,0.278]],"o":[[-1.296,0.589],[-1.193,2.263],[0.071,0.516],[0.097,0.302],[2.098,0.888],[0.618,-0.145],[-0.142,0.188],[-0.366,-0.586],[-3.241,-1.209]],"v":[[661,160],[660,162],[657,167],[660,169],[660,172],[665,170],[669,170],[669,162],[664,162]],"c":true}],"h":1},{"t":10,"s":[{"i":[[0.32,5.346],[1.828,-1.172],[3.978,0.978],[-0.1,-2.32],[0.553,-2.668],[-1.827,-1.006],[-2.06,-0.774],[-1.472,1.614],[-0.919,2.137]],"o":[[-2.709,0.291],[-1.828,1.172],[1.153,2.053],[0.1,2.32],[3.631,-0.798],[1.827,1.006],[0.192,-3.406],[1.472,-1.614],[-3.3,-2.367]],"v":[[714,159],[707.952,161.952],[700,163],[701.779,169.539],[701,177],[708.679,177.821],[714,181],[716.954,174.048],[721,169]],"c":true}],"h":1},{"t":11,"s":[{"i":[[0.027,5.306],[1.147,-0.973],[1.469,-0.297],[0.992,0.348],[1.056,-1.194],[2.463,-4.264],[-2.515,-0.743],[-2.698,1.285],[-1.456,4.877]],"o":[[-1.943,-0.19],[-1.147,0.973],[-0.977,0.197],[-0.992,-0.348],[1.909,4.533],[2.343,2.058],[2.162,0.639],[-0.503,-6.836],[-4.339,-0.995]],"v":[[718,161],[713.645,162.634],[710,165],[707.059,164.253],[704,165],[704,178],[712,179],[718,182],[725,170]],"c":true}],"h":1},{"t":12,"s":[{"i":[[3.009,2.91],[1.692,-0.808],[2.997,0.496],[-0.375,-2.41],[1.073,-2.733],[-1.796,-0.871],[-2.365,-0.301],[-1.439,1.394],[-0.649,2.184]],"o":[[-1.236,1.263],[-1.692,0.808],[-0.426,1.629],[0.375,2.41],[3.452,-0.786],[1.796,0.871],[-0.405,-3.238],[1.439,-1.394],[-5.373,-1.348]],"v":[[719,162],[714.82,165.32],[708,166],[708.486,172.172],[708,180],[715.315,180.685],[721,183],[723.209,176.709],[727,172]],"c":true}],"h":1},{"t":13,"s":[{"i":[[2.453,0.61],[1.596,-0.738],[2.658,0.325],[-0.336,-2.223],[1.015,-2.65],[-1.728,-0.677],[-1.496,-1.322],[-4.696,0.735],[1.409,2.112]],"o":[[-0.959,1.374],[-1.596,0.738],[-0.327,1.457],[0.336,2.223],[2.59,-1.031],[1.728,0.677],[2.2,-4.781],[-0.378,-2.957],[-1.067,-1.6]],"v":[[721,164],[717.274,167.274],[711,168],[711.516,173.605],[711,181],[717.32,180.735],[722,184],[729,175],[724,169]],"c":true}],"h":1},{"t":14,"s":[{"i":[[-4.519,0.148],[1.002,0.856],[0.731,1.055],[0.172,0.667],[1.546,0.226],[0.04,-0.04],[2.296,-2.201],[-0.94,-3.156],[-2.434,-1.899]],"o":[[-0.259,-1.52],[-1.003,-0.856],[-0.766,-1.106],[-0.172,-0.667],[0.176,0.026],[-2.181,2.181],[3.326,4.998],[5.056,-0.723],[1.363,-3.304]],"v":[[730,176],[727.854,172.652],[725,170],[724.085,167.34],[722,166],[721,168],[713,170],[714,181],[724,184]],"c":true}],"h":1},{"t":15,"s":[{"i":[[3.988,-1.017],[0.26,-0.871],[1.067,-0.288],[-1.248,-4.174],[-0.446,-0.298],[-2.215,-0.132],[0,4.219],[0.705,1.891],[1.865,1.07]],"o":[[-0.896,0.228],[-0.259,0.871],[-6.477,1.754],[0.176,0.589],[0.918,0.613],[3.535,0.21],[0,-3.603],[-0.537,-1.441],[-3.416,-1.96]],"v":[[663,142],[661.628,143.955],[660,146],[660,152],[660,156],[666,155],[670,153],[672,146],[667,145]],"c":true}],"h":1},{"t":16,"s":[{"i":[[3.163,-0.872],[0.588,-0.71],[0.457,-0.108],[-0.65,-1.868],[-1.567,-0.718],[-0.312,0.02],[0,3.564],[0.823,2.348],[1.172,0.64]],"o":[[-0.189,0.052],[-0.589,0.71],[-4.289,1.009],[0.596,1.712],[-0.386,-0.177],[2.564,-0.166],[0,-3.518],[-0.421,-1.202],[-3.054,-1.667]],"v":[[664,144],[662.701,145.458],[661,147],[662,152],[663,156],[666,154],[670,153],[672,147],[668,146]],"c":true}],"h":1},{"t":17,"s":[{"i":[[0.03,-0.013],[1.153,-0.658],[-0.239,0.469],[-0.724,-2.91],[-0.226,-0.108],[-0.966,0.793],[-0.282,0.713],[0.373,1.041],[1.28,0.248]],"o":[[0.372,-0.162],[-1.153,0.658],[-0.98,1.923],[0.078,0.312],[-0.756,-0.363],[0.55,-0.452],[0.179,-0.453],[-0.142,-0.396],[-0.008,-0.002]],"v":[[665,146],[663.1,147.23],[661,148],[663,152],[663,155],[670,154],[670,150],[672,148],[665,145]],"c":true}],"h":1},{"t":18,"s":[{"i":[[0.084,-0.031],[0.188,-0.463],[0.137,-0.104],[0.113,-1.939],[0.259,0.166],[-1.345,0.995],[-0.15,-0.33],[0.329,0.139],[2.202,-0.436]],"o":[[-0.113,0.043],[-0.188,0.463],[-1.164,0.89],[0.128,-2.182],[1.52,0.971],[-1.835,1.358],[-0.122,-0.267],[-1.972,-0.833],[-0.082,0.016]],"v":[[666,146],[665.517,146.954],[665,148],[662,150],[664,154],[671,153],[672,148],[669,148],[666,145]],"c":true}],"h":1},{"t":19,"s":[{"i":[[1.155,-0.268],[0.742,-0.655],[0.018,-0.147],[-0.494,-0.258],[-0.017,-0.036],[0.069,-0.67],[-0.177,-0.111],[0.72,1.646],[0.17,0.154]],"o":[[-1.014,0.235],[-0.742,0.655],[0.009,-0.07],[0.494,0.258],[0.099,0.209],[-0.069,0.67],[5.504,3.44],[0.008,0.019],[-1.042,-0.948]],"v":[[667,147],[664.253,148.566],[663,150],[663.993,150.42],[665,151],[664.941,152.574],[665,154],[672,148],[668,147]],"c":true}],"h":1},{"t":20,"s":[{"i":[[1.077,-0.359],[0.448,-0.161],[0.437,-0.146],[-0.01,0.039],[-1.803,-0.802],[-0.343,0.32],[0.056,0.649],[-0.053,0.245],[0.828,0.391]],"o":[[-0.023,0.008],[-0.448,0.161],[-0.437,0.146],[-0.556,2.111],[1.803,0.802],[0.17,-0.159],[-0.056,-0.649],[0.39,-1.796],[-0.828,-0.391]],"v":[[667,148],[666.184,148.295],[664.748,148.797],[664,149],[666.825,153.323],[671,154],[671.088,152.565],[671,151],[670.101,147.884]],"c":true}],"h":1},{"t":21,"s":[{"i":[[1.65,-0.325],[-0.129,-0.327],[0.113,-1.219],[0.363,-0.391],[-0.45,-0.435],[-1.256,-0.132],[0.354,-0.15],[-0.212,0.328],[1.985,2.072]],"o":[[-2.403,0.474],[0.129,0.327],[0,0.002],[-0.363,0.391],[0.332,0.32],[1.256,0.132],[0.31,-0.131],[0.624,-0.965],[-2.1,-2.192]],"v":[[727,176],[724.283,176.941],[725,179],[724.162,179.675],[724,181],[727.014,181.628],[729,182],[729,179],[730,177]],"c":true}],"h":1},{"t":22.0000008960784,"s":[{"i":[[1.975,1.778],[-0.11,0.069],[-0.024,0.085],[0.098,0.099],[0.257,0.109],[0.375,-0.061],[0.442,0.062],[-0.237,0.184],[-1.6,-0.225]],"o":[[0.16,-0.049],[0.11,-0.069],[0.024,-0.085],[-0.098,-0.099],[0.438,0.186],[-0.375,0.061],[-0.442,-0.062],[-2.423,1.877],[1.6,0.225]],"v":[[657,142],[657.415,141.823],[657.626,141.591],[657.525,141.314],[657,141],[656.907,141.371],[655.494,141.37],[655,141],[655.664,144.241]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":3,"s":[0],"h":1},{"t":4,"s":[100],"h":1},{"t":23.0000009368092,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 5"},{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":4,"s":[{"i":[[0.463,-0.178],[0.086,-0.634],[0.269,-0.315],[0.705,0.003],[-0.223,-2.367],[-0.549,-0.362],[0.166,0.11],[-0.545,-1.124],[-0.129,-0.046],[-2.352,0.489],[0.064,-0.079],[0.038,0.047],[0.848,0.242],[0.326,0.155]],"o":[[-0.385,0.148],[-0.086,0.634],[-1.403,1.647],[-0.705,-0.003],[-0.032,-0.339],[0.549,0.362],[0.689,0.457],[0.545,1.124],[-0.342,-0.124],[2.352,-0.489],[-0.148,0.183],[-0.498,-0.622],[-0.224,-0.064],[-1.384,-0.656]],"v":[[628,140],[627.413,141.374],[627,143],[623.781,144.46],[623,147],[624.101,147.328],[625,148],[626.921,150.808],[628,153],[632.291,151.848],[637,151],[637,141],[632,141],[631,139]],"c":true}],"h":1},{"t":5,"s":[{"i":[[0.274,-0.108],[-0.012,-0.29],[0.366,-0.571],[0.758,-0.454],[-0.111,-1.504],[-1.005,-0.835],[-0.004,-0.008],[-0.637,0.28],[-2.26,0.338],[0.001,0.573],[0,2.261],[-0.453,0.809],[0.811,1.01],[2.104,0.18]],"o":[[-0.682,0.269],[0.012,0.29],[-1.077,1.681],[-0.758,0.454],[-0.025,-0.349],[1.005,0.835],[1.193,2.456],[0.637,-0.28],[3.003,-0.448],[-0.001,-0.573],[0,-0.754],[0.453,-0.809],[-0.312,-0.388],[-2.104,-0.18]],"v":[[638,146],[637.263,146.774],[637,148],[634.109,150.633],[633,153],[634.978,154.232],[637,156],[639.199,158.595],[643,157],[646.752,155.86],[646,152],[647.108,149.692],[647,147],[642.471,146.128]],"c":true}],"h":1},{"t":6,"s":[{"i":[[0.027,-0.013],[-0.047,-0.454],[0.073,-0.129],[0.769,-0.754],[-2.014,-1.337],[-0.307,-0.879],[-1.894,1.763],[-1.378,0.03],[-0.522,0.98],[0.468,0.769],[0.013,0.139],[-0.52,0.611],[0.945,1.134],[0.371,0.096]],"o":[[-0.115,0.055],[0.047,0.454],[-0.94,1.645],[-0.769,0.755],[1.879,1.246],[0.307,0.879],[0.968,-0.901],[1.378,-0.03],[-0.114,0.214],[-0.468,-0.769],[-0.134,-1.423],[0.52,-0.611],[0.355,0.426],[-0.001,0]],"v":[[645,151],[644.969,151.945],[645,153],[641.784,156.232],[643,159],[645.488,162.757],[648,162],[651.835,161.059],[655,160],[653.924,158.765],[653,157],[654.108,154.284],[654,152],[645,150]],"c":true}],"h":1},{"t":7,"s":[{"i":[[2.575,-0.923],[-0.015,-0.3],[0.37,-0.552],[0.757,-0.156],[-0.045,-1.856],[-0.778,-0.094],[-0.864,-1.6],[-0.446,0.226],[-1.946,0.448],[0.015,0.425],[-0.049,2.605],[-0.38,0.733],[0.526,0.673],[0.851,0.277]],"o":[[-0.692,0.249],[0.015,0.3],[-1.019,1.522],[-0.757,0.156],[0.025,1.025],[0.778,0.094],[1.269,2.351],[0.446,-0.226],[3.012,-0.694],[-0.015,-0.425],[0.007,-0.393],[0.38,-0.733],[-0.5,-0.639],[-2.318,-0.754]],"v":[[652,155],[651.258,155.772],[651,157],[648.202,158.75],[647,161],[648.371,162.07],[651,164],[652.993,166.599],[656,165],[659.722,163.933],[659,160],[659.9,158.21],[660,156],[655,156]],"c":true}],"h":1},{"t":8,"s":[{"i":[[2.581,-0.942],[0.003,-0.292],[0.322,-0.588],[0.754,-0.047],[-0.034,-1.951],[-0.78,-0.098],[-0.861,-1.594],[-0.447,0.226],[-1.945,0.448],[-0.88,-0.074],[-0.17,0.224],[-0.076,1.836],[1.04,1.351],[0.842,0.274]],"o":[[-0.666,0.243],[-0.003,0.292],[-1.019,1.859],[-0.754,0.047],[0.017,1.014],[0.78,0.098],[1.269,2.351],[0.447,-0.226],[0.31,-0.072],[0.88,0.074],[0.687,-0.902],[0.032,-0.785],[-0.488,-0.634],[-2.318,-0.754]],"v":[[657,158],[656.242,158.742],[656,160],[653.211,161.932],[652,164],[653.367,165.065],[656,167],[657.993,169.599],[661,168],[663.104,168.114],[665,168],[664,163],[665,159],[660,159]],"c":true}],"h":1},{"t":9,"s":[{"i":[[-4.107,3.183],[3.919,2.401],[0.461,0.189],[0.664,0.18],[1.176,0.067],[1.67,0.424],[3.279,-1.611],[0.157,-0.348],[-0.161,-2.256],[-2.187,-3.411],[-0.782,-0.494],[-0.561,-0.838],[-2.271,-4.398],[-5.312,-2.754]],"o":[[-1.484,-2.881],[-1.316,-0.806],[-1.624,-0.668],[-0.612,-0.166],[-0.307,-0.018],[-3.304,-0.838],[-0.291,0.143],[-1.161,2.576],[0.18,2.521],[0.547,0.854],[1.029,0.65],[2.095,3.13],[4.927,-1.973],[0.719,-4.588]],"v":[[663,140],[656,138],[653,133],[649,134],[647,132],[644,133],[639,131],[639,134],[635,139],[639,142],[640,146],[644,145],[646,154],[659,153]],"c":true}],"h":1},{"t":10,"s":[{"i":[[2.803,-1.277],[-0.016,-0.28],[0.389,-0.574],[0.582,-0.435],[-0.104,-1.111],[-0.746,-0.567],[-0.048,-0.087],[-0.431,0.22],[-1.983,0.457],[-0.066,0.344],[0,1.993],[-0.319,0.772],[0.278,0.368],[0.83,0.27]],"o":[[-0.673,0.307],[0.016,0.28],[-0.777,1.147],[-0.582,0.435],[-0.033,-0.355],[0.746,0.567],[1.292,2.335],[0.431,-0.22],[2.735,-0.63],[0.066,-0.344],[0,-0.546],[0.32,-0.772],[-0.473,-0.627],[-2.855,-0.929]],"v":[[664,163],[663.287,163.8],[663,165],[660.839,167.027],[660,169],[661.439,169.668],[663,171],[664.981,173.594],[668,172],[671.551,171.023],[671,168],[671.708,165.867],[672,164],[667,164]],"c":true}],"h":1},{"t":11,"s":[{"i":[[0.004,-0.001],[0.004,-0.3],[0.315,-0.576],[0.867,-0.521],[-0.038,-0.871],[-0.956,-0.528],[-0.163,-0.557],[-0.72,0.599],[-1.398,0.074],[-0.513,0.688],[-0.062,3.302],[1.063,1.289],[0.91,0.368],[0.272,0.237]],"o":[[-0.668,0.222],[-0.004,0.3],[-0.572,1.044],[-0.867,0.521],[0.014,0.33],[0.956,0.528],[0.723,2.468],[0.72,-0.599],[0.446,-0.024],[1.757,-2.359],[0.014,-0.742],[-0.58,-0.703],[-0.109,-0.044],[0.032,0.028]],"v":[[667,164],[666.236,164.735],[666,166],[663.542,168.13],[662,170],[663.889,171.33],[666,173],[667.994,174.906],[671,173],[674,174],[673,169],[674,165],[669,165],[667,163]],"c":true}],"h":1},{"t":12,"s":[{"i":[[0.467,-0.276],[-0.06,-0.443],[0.1,-0.147],[0.447,-0.388],[-1.881,-0.848],[-0.102,-1.054],[-1.468,-0.276],[-0.507,0.48],[-0.159,0.044],[-0.877,-0.081],[-0.177,0.234],[-0.287,3.276],[4.141,1.327],[0.355,0.168]],"o":[[-0.14,0.082],[0.06,0.443],[-1.093,1.599],[-0.447,0.388],[1.124,0.507],[0.102,1.054],[-0.187,-0.035],[0.507,-0.48],[0.317,-0.088],[0.876,0.081],[1.709,-2.264],[0.327,-3.739],[-0.259,-0.083],[-1.357,-0.643]],"v":[[668,166],[667.97,166.952],[668,168],[665.269,170.563],[667,172],[668.242,174.673],[670,177],[670.741,176.007],[672,175],[674.105,175.11],[676,175],[675,170],[672,167],[671,165]],"c":true}],"h":1},{"t":13,"s":[{"i":[[0.042,-0.012],[-0.015,-0.317],[0.358,-0.528],[0.649,-0.083],[-0.536,-2.279],[-0.706,-0.268],[-0.124,-0.71],[0.022,-0.466],[-0.068,-0.029],[-1.707,0.561],[0.085,-0.137],[0.405,0.636],[0.595,0.235],[1.263,0.013]],"o":[[-0.701,0.205],[0.015,0.317],[-0.942,1.389],[-0.649,0.083],[0.052,0.219],[0.706,0.268],[0.019,0.106],[-0.022,0.466],[0.259,0.108],[1.707,-0.561],[0.809,-1.311],[-0.303,-0.476],[-0.701,-0.277],[-0.033,0]],"v":[[671,167],[670.243,167.758],[670,169],[667.391,170.333],[667,173],[668.446,173.631],[670,175],[669.962,176.058],[670,177],[673.758,175.978],[677,175],[677,168],[673,168],[671,166]],"c":true}],"h":1},{"t":14,"s":[{"i":[[0.761,-0.328],[0.299,-0.342],[0.351,-0.457],[0.251,-0.386],[0,-0.13],[-0.493,-0.541],[-0.029,-0.04],[-0.429,-0.712],[-0.181,-0.005],[-1.687,0.548],[0.167,-0.24],[0.094,1.543],[0.108,0.135],[1.224,-0.027]],"o":[[-0.096,0.041],[-0.299,0.342],[-0.351,0.457],[-0.251,0.386],[0,-0.204],[0.493,0.541],[0.104,0.148],[0.429,0.712],[-1.582,-0.048],[1.687,-0.548],[0.484,-0.694],[-0.094,-1.543],[-0.345,-0.435],[-1.223,0.027]],"v":[[672,169],[671.37,169.622],[670.356,170.867],[669.415,172.179],[669,173],[669.979,173.817],[671,175],[671.943,176.607],[673,178],[674.439,176.784],[678,176],[678.443,172.082],[678,169],[675.312,168.428]],"c":true}],"h":1},{"t":15,"s":[{"i":[[-0.046,-0.005],[0.59,-0.443],[1.375,-0.257],[0.874,0.071],[0.186,-0.224],[-0.295,-1.077],[0,-0.473],[-0.27,-0.264],[-2.918,-0.675],[-1.724,0.605],[-0.706,1.122],[-0.271,0.175],[1.639,2.66],[0.143,0.224]],"o":[[-0.267,-0.028],[-0.589,0.443],[-0.319,0.06],[-0.874,-0.071],[-0.181,0.219],[0.295,1.077],[0,3.267],[0.27,0.264],[2.072,0.479],[1.235,-0.433],[0.156,-0.247],[4.269,-2.762],[-0.934,-1.516],[0.043,0.067]],"v":[[724,169],[722.831,169.787],[720,171],[717.9,170.877],[716,171],[716.364,173.309],[717,176],[716.811,180.444],[721,181],[725,183],[726,179],[728,178],[726,172],[724,168]],"c":true}],"h":1},{"t":16,"s":[{"i":[[0.014,-0.007],[0.291,-0.549],[-0.198,-0.525],[-0.501,-0.412],[-0.618,-0.209],[-0.55,0.083],[-0.295,0.464],[0.281,0.723],[0.642,0.536],[0.54,0.295],[-0.024,0],[-0.002,-0.092],[-0.006,-0.123],[-0.001,-0.095]],"o":[[-0.966,0.483],[-0.291,0.549],[0.198,0.525],[0.501,0.412],[0.618,0.209],[0.55,-0.083],[0.543,-0.855],[-0.281,-0.723],[-0.642,-0.536],[-0.54,-0.295],[-0.011,0],[0.002,0.092],[0.006,0.123],[0.001,0.095]],"v":[[675,171],[673.162,172.57],[673.069,174.203],[674.163,175.631],[675.889,176.585],[677.687,176.798],[679,176],[679.278,173.62],[677.779,171.718],[675.889,170.457],[675,170],[674.989,170.152],[675.004,170.49],[675.017,170.832]],"c":true}],"h":1},{"t":17,"s":[{"i":[[-0.665,0.269],[0.114,0.577],[0.169,0.35],[0.205,0.157],[0.221,-0.002],[0.219,-0.128],[0.197,-0.219],[0.156,-0.277],[0.096,-0.3],[0.017,-0.29],[-0.081,-0.246],[-0.198,-0.168],[-0.335,-0.056],[-0.49,0.089]],"o":[[-0.04,-0.838],[-0.114,-0.577],[-0.169,-0.35],[-0.205,-0.157],[-0.221,0.002],[-0.219,0.128],[-0.197,0.219],[-0.156,0.277],[-0.096,0.3],[-0.017,0.29],[0.081,0.246],[0.198,0.168],[0.335,0.056],[0.49,-0.089]],"v":[[679,176],[678.764,173.885],[678.335,172.503],[677.77,171.751],[677.127,171.527],[676.462,171.731],[675.834,172.26],[675.3,173.012],[674.917,173.886],[674.742,174.781],[674.832,175.594],[675.246,176.225],[676.041,176.57],[677.273,176.529]],"c":true}],"h":1},{"t":18,"s":[{"i":[[-0.06,0.07],[0.168,-0.303],[0.067,-0.365],[-0.134,-0.38],[-0.436,-0.347],[-0.58,0.356],[-0.217,-0.053],[-0.181,-0.348],[-0.313,0.384],[0.356,0.584],[-0.052,0.211],[-0.336,0.142],[0.352,0.4],[0.824,-0.235]],"o":[[-0.168,0.193],[-0.168,0.303],[-0.067,0.365],[0.134,0.38],[0.464,0.37],[0.58,-0.356],[-0.035,-0.008],[0.181,0.348],[0.371,-0.454],[-0.356,-0.584],[0.008,-0.033],[0.336,-0.142],[-0.765,-0.87],[-0.824,0.235]],"v":[[676,173],[675.472,173.756],[675.095,174.769],[675.171,175.898],[676,177],[677.685,176.737],[679,176],[679.239,176.782],[680,177],[679.74,175.317],[679,174],[679.77,173.775],[680,173],[677.381,172.399]],"c":true}],"h":1},{"t":19,"s":[{"i":[[0.675,-0.554],[0.073,-0.137],[0.072,-0.201],[0.052,-0.236],[0.011,-0.243],[-0.049,-0.221],[-0.129,-0.171],[-0.229,-0.092],[-0.349,0.016],[-0.291,0.331],[-0.151,0.481],[0.016,0.467],[0.209,0.29],[0.429,-0.05]],"o":[[-0.055,0.045],[-0.073,0.137],[-0.072,0.201],[-0.052,0.236],[-0.011,0.243],[0.049,0.221],[0.129,0.171],[0.229,0.092],[0.405,-0.018],[0.291,-0.331],[0.151,-0.481],[-0.016,-0.467],[-0.209,-0.29],[-0.429,0.05]],"v":[[677,174],[676.803,174.28],[676.579,174.794],[676.388,175.457],[676.289,176.182],[676.342,176.884],[676.605,177.479],[677.138,177.879],[678,178],[679.052,177.435],[679.722,176.176],[679.932,174.713],[679.6,173.536],[678.65,173.135]],"c":true}],"h":1},{"t":20.0000008146167,"s":[{"i":[[0.352,-0.365],[0.106,-0.282],[-0.052,-0.24],[-0.167,-0.193],[-0.239,-0.14],[-0.269,-0.081],[-0.255,-0.017],[-0.199,0.053],[-0.1,0.128],[-0.035,0.34],[0.105,0.344],[0.213,0.276],[0.29,0.134],[0.337,-0.079]],"o":[[-0.307,0.318],[-0.106,0.282],[0.052,0.24],[0.167,0.193],[0.239,0.14],[0.269,0.081],[0.255,0.017],[0.199,-0.053],[0.205,-0.263],[0.035,-0.34],[-0.105,-0.344],[-0.213,-0.275],[-0.291,-0.134],[-0.337,0.079]],"v":[[677,174],[676.391,174.902],[676.321,175.686],[676.66,176.338],[677.281,176.838],[678.053,177.172],[678.85,177.321],[679.542,177.269],[680,177],[680.351,176.077],[680.238,175.033],[679.754,174.085],[678.991,173.452],[678.042,173.351]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":3,"s":[0],"h":1},{"t":4,"s":[100],"h":1},{"t":21.0000008553475,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 6"},{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":15,"s":[{"i":[[2.392,-2.466],[-0.083,-0.416],[0.168,-0.168],[0.478,0.038],[0.014,-0.079],[-1.849,-0.698],[-1.004,1.041],[-0.174,1.043],[2.339,0.388]],"o":[[-0.166,0.171],[0.083,0.415],[-0.074,0.075],[-0.478,-0.038],[-0.399,2.25],[1.849,0.698],[0.786,-0.816],[0.576,-3.447],[-2.23,-0.37]],"v":[[673,170],[673.001,171.002],[673,172],[671.955,171.997],[671,172],[673.948,176.468],[679,176],[678,172],[676,171]],"c":true}],"h":1},{"t":16,"s":[{"i":[[2.116,-0.203],[1.28,-0.306],[0.372,-0.726],[-1.25,-1.265],[-0.576,-0.065],[-1.936,0.69],[-0.383,0.459],[0.189,1.971],[0.267,0.373]],"o":[[-0.509,0.048],[-1.28,0.306],[0.12,-0.233],[-0.552,-0.558],[2.406,0.271],[0.422,-0.151],[0.76,-0.913],[-0.013,-0.139],[-2.117,-2.963]],"v":[[724,172],[720.898,172.492],[718,174],[720,181],[722,180],[726,182],[727,178],[730,176],[727,174]],"c":true}],"h":1},{"t":17,"s":[{"i":[[-0.047,0.006],[0.496,-3.521],[-0.097,-0.165],[-2.161,-0.71],[-1.85,0.91],[-0.182,0.355],[0.268,1.407],[0.006,0.008],[0.341,0.341]],"o":[[-6.822,0.863],[-0.063,0.446],[1.053,1.8],[0.643,0.211],[0.309,-0.152],[-1.327,2.591],[0.131,0.688],[-0.298,-0.39],[-0.638,-0.638]],"v":[[725,173],[721,178],[720,180],[724,180],[727,182],[727,179],[730,176],[727,174],[727,172]],"c":true}],"h":1},{"t":18,"s":[{"i":[[1.095,-0.205],[0.285,-0.491],[-0.325,-1.627],[-0.236,0.222],[-1.562,-0.426],[-1.066,0.35],[0.199,0.707],[0.177,0.177],[0.339,0.296]],"o":[[-2.187,0.409],[-0.285,0.491],[0.493,2.464],[0.236,-0.222],[0.453,0.123],[0.877,-0.288],[-0.057,-0.202],[-0.321,-0.321],[-1.487,-1.301]],"v":[[725,174],[721.616,175.087],[722,178],[722.698,180.528],[725,180],[727,182],[730,176],[728,176],[728,174]],"c":true}],"h":1},{"t":19,"s":[{"i":[[0.536,-0.03],[0.275,-0.213],[0.401,-0.121],[0.806,-4.159],[-0.026,-0.029],[-1.621,0.617],[-0.048,0.063],[2.053,2.053],[0.446,1.564]],"o":[[-0.498,0.028],[-0.275,0.213],[-4.799,1.451],[-0.064,0.332],[-1.029,-1.142],[-0.091,0.035],[1.837,-2.403],[-0.904,-0.904],[-0.4,-1.403]],"v":[[727,174],[725.927,174.43],[725,175],[723,179],[722,181],[728,182],[729,179],[729,176],[728,174]],"c":true}],"h":1},{"t":20.0000008146167,"s":[{"i":[[-0.024,0.002],[-0.084,-0.482],[0.298,-1.786],[0.362,-0.383],[-0.45,-0.448],[-1.651,1.193],[0.145,0.766],[-0.17,-0.166],[1.226,0.537]],"o":[[-3.037,0.287],[0.084,0.482],[-0.003,0.019],[-0.362,0.383],[1.543,1.537],[1.65,-1.193],[0.104,0.549],[-0.836,-0.817],[0.04,0.018]],"v":[[727,175],[723.446,175.876],[724,179],[723.16,179.678],[723,181],[728.266,180.727],[731,177],[729,176],[727,174]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":14,"s":[0],"h":1},{"t":15,"s":[100],"h":1},{"t":21.0000008553475,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 7"}],"sw":1125,"sh":207,"sc":"#ffd200","ip":0,"op":900.000036657751,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":1,"nm":"star01","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[562.5,103.5,0],"ix":2,"l":2},"a":{"a":0,"k":[562.5,103.5,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"hasMask":true,"masksProperties":[{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":1,"s":[{"i":[[-0.212,2.426],[1.217,0.165],[0.861,0.548],[0.079,0.86],[0.323,0.328],[0.62,-0.092],[0.296,0.141],[0.14,0.452],[0.244,0.1],[0.606,-0.87],[0.873,-0.219],[0.846,0.284],[0.72,-0.162],[0.147,-0.53],[1.725,1.725],[0.776,-1.347],[1.067,-0.441],[1.889,0.596],[1.161,-1.853],[0.383,-2.307],[-1.692,-2.196],[0.974,-0.359],[0.935,-0.399],[-1.09,-2.077],[0.169,-3.335],[-2.891,0.012],[-2.824,7.765],[-3.536,2.278],[-3.182,2.77],[-3.411,2.625],[-2.869,2.994]],"o":[[-1.272,-0.793],[-1.217,-0.165],[-0.362,-0.231],[-0.079,-0.86],[-0.222,-0.226],[-0.62,0.092],[-0.195,-0.093],[-0.14,-0.452],[-1.704,-0.699],[-0.606,0.87],[0.102,-0.025],[-0.846,-0.284],[-2.687,0.606],[-0.147,0.53],[-1.829,-1.829],[-0.776,1.347],[-1.281,0.529],[-1.889,-0.596],[0.84,2.575],[-0.383,2.308],[-1.168,0.165],[-0.974,0.359],[0.811,2.356],[1.09,2.077],[4.345,0.677],[6.996,-0.03],[2.017,-5.545],[1.947,-1.254],[3.199,-2.785],[-0.09,-5.415],[1.547,-1.615]],"v":[[578,91],[574.192,89.816],[571,89],[570.471,87.073],[570,85],[568.556,84.936],[567,85],[566.536,84.006],[566,83],[562.877,83.811],[561,86],[559.617,85.359],[557,85],[553.779,87.248],[552,86],[548.428,86.297],[546,90],[540.91,89.007],[536,90],[535.861,97.284],[537,104],[533.825,104.824],[531,106],[534.235,112.265],[536,120],[544,118],[559,120],[564,118],[569,109],[578,105],[575,96]],"c":true}],"h":1},{"t":2,"s":[{"i":[[2.538,4.638],[1.444,-1.018],[1.802,-0.126],[1.564,0.647],[2.27,-0.487],[-0.58,-1.798],[0.369,-1.852],[0.565,-0.655],[0.653,-0.944],[0.94,-0.958],[1.848,-1.155],[2.481,0.174],[3.429,-0.041],[-0.694,-1.938],[0.293,-2.636],[1.233,-1.981],[-1.101,-1.558],[-3.75,-1.228],[-3.934,-0.745],[-0.119,0.061],[-1.904,-1.024],[-1.384,2.186],[-0.607,0.451],[-2.48,0.76],[-2.253,2.053],[-5.147,1.853],[0.016,5.293],[-1.428,1.639],[-0.63,0.72],[-0.015,2.501],[1.173,4.113]],"o":[[-2.42,-0.198],[-1.444,1.018],[-1.475,0.103],[-1.564,-0.648],[-0.95,1.956],[0.58,1.798],[-0.087,0.434],[-0.565,0.655],[-1.391,2.012],[-0.94,0.958],[-2.649,1.656],[-2.481,-0.174],[-0.481,2.614],[0.694,1.938],[-0.168,1.517],[-1.233,1.981],[1.923,2.72],[3.672,1.202],[-0.182,-0.034],[3.872,-1.982],[2.034,-0.177],[0.379,-0.598],[2.036,-1.514],[1.644,-0.504],[0.49,-6.509],[-1.323,-5.657],[-0.005,-1.679],[0.665,-0.762],[1.016,-1.161],[0.023,-3.836],[-0.954,-3.345]],"v":[[542,67],[536.536,68.756],[532,71],[527.597,69.713],[522,69],[522.064,74.578],[523,80],[521.925,81.618],[520,84],[516.842,88.143],[513,91],[505.586,92.711],[497,92],[497.859,98.483],[499,105],[496.048,110.469],[495,116],[506,117],[518,127],[520,125],[530,126],[531,120],[535,120],[537,114],[542,116],[551,104],[543,94],[547,90],[548,87],[550,85],[543,75]],"c":true}],"h":1},{"t":3,"s":[{"i":[[0.637,4.564],[3.66,-0.342],[3.912,-3.441],[0.297,-2.717],[-0.774,-5.072],[-1.889,-2.919],[-1.35,-2.92],[-0.807,-3.238],[-0.91,-1.781],[-1.325,-1.728],[-0.671,-1.182],[3.114,0.009],[2.701,-3.202],[8.739,1.739],[-1.003,-3.426],[-1.82,-2.151],[-5.337,-1.106],[-3.915,0.605],[-3.164,1.314],[-2.041,1.164],[-3.352,-1.073],[-1.768,2.696],[0.629,4.469],[1.629,3.265],[0.939,1.208],[0.893,1.107],[-0.79,3.21],[1.843,1.171],[-0.119,0.424],[-0.672,0.372],[1.231,2.866]],"o":[[-5.23,-0.905],[-3.047,0.284],[-0.789,4.275],[-0.368,3.368],[6.11,1.643],[1.649,2.549],[1.2,2.597],[0.49,1.966],[0.73,1.429],[0.83,1.083],[-2.483,2.365],[-0.772,4.367],[-6.049,-7.803],[-0.222,3.904],[0.537,1.834],[4.107,-2.306],[0.085,-5.727],[1.742,-0.269],[0.157,-3.362],[2.996,-1.709],[2.316,-3.043],[1.52,-2.318],[-2.525,-1.846],[-0.982,-1.968],[-1.331,-1.713],[1.369,-2.631],[-1.35,-2.289],[-1.157,-0.735],[0.185,-0.659],[6.512,-3.601],[-1.465,-3.411]],"v":[[522,53],[511,57],[501,56],[503,65],[498,75],[510,79],[510,84],[514,89],[514,96],[518,97],[519,101],[510,101],[510,112],[496,117],[500,125],[501,131],[515,130],[518,119],[523,121],[526,114],[533,115],[535,107],[542,101],[535,96],[534,90],[530,89],[535,82],[528,80],[524,74],[527,73],[523,63]],"c":true}],"h":1},{"t":4,"s":[{"i":[[1.456,1.949],[0.838,-0.359],[0.764,-0.495],[0.794,-0.389],[0.928,-0.04],[0.616,0.161],[0.637,0.24],[0.703,0.209],[0.812,0.069],[0.094,-0.851],[-0.219,-0.822],[-0.204,-0.809],[0.141,-0.815],[0.496,-0.728],[0.54,-0.755],[0.274,-0.899],[-0.302,-1.16],[-0.704,-0.014],[-0.631,0.09],[-0.737,-0.066],[-1.021,-0.482],[-0.679,-1.09],[-0.712,-0.883],[-1.074,0.159],[-0.107,1.727],[-1.962,1.706],[-0.974,0.088],[-0.708,0.307],[1.547,1.967],[0.696,2.449],[-0.288,0.901]],"o":[[-1.015,-0.02],[-0.838,0.359],[-0.764,0.495],[-0.794,0.389],[-0.637,0.028],[-0.616,-0.161],[-0.637,-0.24],[-0.703,-0.209],[-0.736,0.899],[-0.094,0.851],[0.219,0.822],[0.204,0.809],[-0.142,0.818],[-0.496,0.728],[-0.54,0.755],[-0.274,0.899],[0.955,0.379],[0.704,0.014],[0.631,-0.09],[0.737,0.066],[0.976,0.461],[0.679,1.09],[0.712,0.883],[2.608,-0.386],[0.107,-1.727],[0.394,-0.343],[0.974,-0.088],[3.883,-1.681],[-1.547,-1.967],[-0.695,-2.445],[0.288,-0.901]],"v":[[505,42],[502.247,42.568],[499.87,43.909],[497.558,45.295],[495,46],[493.131,45.773],[491.262,45.145],[489.262,44.445],[487,44],[485.837,46.621],[486.108,49.126],[486.824,51.568],[487,54],[485.966,56.291],[484.335,58.487],[483.036,60.94],[483,64],[485.444,64.525],[487.401,64.345],[489.408,64.243],[492,65],[494.401,67.536],[496.405,70.705],[499,72],[501.985,68.49],[504,63],[506.264,62.473],[509,62],[510.934,56.576],[506,50],[506.071,45.628]],"c":true}],"h":1},{"t":5,"s":[{"i":[[1.452,2.186],[0.802,-0.32],[0.636,-0.527],[0.641,-0.444],[0.817,-0.07],[0.642,0.234],[0.696,0.31],[0.831,0.171],[1.048,-0.183],[-0.022,-0.751],[-0.289,-0.699],[-0.248,-0.723],[0.102,-0.825],[0.491,-0.719],[0.554,-0.758],[0.286,-0.91],[-0.313,-1.175],[-0.83,-0.032],[-0.729,-0.007],[-0.66,-0.097],[-0.621,-0.3],[-0.525,-1.016],[-0.728,-0.739],[-1.537,0.38],[-0.209,1.409],[-1.401,1.278],[-1.026,0.1],[-0.459,0.204],[1.581,1.503],[0.774,2.168],[-0.287,1.215]],"o":[[-1.139,-0.179],[-0.802,0.32],[-0.636,0.527],[-0.641,0.444],[-0.668,0.057],[-0.642,-0.234],[-0.696,-0.31],[-0.831,-0.171],[-0.555,0.88],[0.022,0.751],[0.289,0.699],[0.248,0.723],[-0.098,0.793],[-0.491,0.719],[-0.554,0.758],[-0.286,0.91],[0.962,0.171],[0.83,0.032],[0.729,0.007],[0.66,0.097],[0.926,0.448],[0.525,1.016],[0.728,0.739],[1.762,-1.085],[0.209,-1.409],[0.436,-0.398],[1.026,-0.099],[4.096,-1.82],[-1.581,-1.503],[-0.697,-1.953],[0.287,-1.215]],"v":[[492,34],[489.132,34.283],[487.017,35.626],[485.144,37.156],[483,38],[481.056,37.68],[479.069,36.81],[476.798,36.035],[474,36],[473.278,38.428],[473.821,40.583],[474.704,42.696],[475,45],[474.033,47.24],[472.383,49.427],[471.041,51.901],[471,55],[473.68,55.276],[476.011,55.306],[478.087,55.433],[480,56],[482.025,58.407],[483.754,61.25],[487,62],[489.271,58.144],[491,54],[493.482,53.355],[496,53],[498.152,48.26],[493,43],[493.066,38.674]],"c":true}],"h":1},{"t":6,"s":[{"i":[[-1.045,1.198],[0.495,0.719],[0.562,0.608],[0.537,0.71],[0.417,1.024],[0.023,0.783],[0.018,0.657],[0.361,0.546],[1.053,0.45],[0.168,-0.19],[0.262,-0.239],[0.214,-0.18],[0.021,-0.011],[1.076,-0.237],[0.974,0.099],[1.036,0.287],[1.261,0.326],[0.091,-0.878],[-0.222,-0.846],[-0.202,-0.795],[0.151,-0.726],[0.688,-0.761],[0.52,-0.834],[-0.288,-1.273],[-1.457,-0.041],[-1.485,-0.773],[-0.91,-1.422],[-2.053,0.367],[-0.363,1.502],[-1.148,1.026],[-1.466,0.207]],"o":[[-0.333,-1.044],[-0.494,-0.719],[-0.562,-0.608],[-0.537,-0.71],[-0.376,-0.924],[-0.023,-0.783],[-0.018,-0.657],[-0.361,-0.546],[0.071,0.03],[-0.168,0.19],[-0.262,0.24],[-0.214,0.18],[-1.342,0.721],[-1.076,0.237],[-0.974,-0.099],[-1.036,-0.287],[-0.737,0.891],[-0.091,0.878],[0.222,0.846],[0.202,0.795],[-0.219,1.053],[-0.688,0.761],[-0.52,0.834],[1.689,1.062],[1.457,0.041],[1.307,0.681],[0.91,1.422],[1.4,-0.967],[0.363,-1.502],[1.091,-0.975],[1.466,-0.207]],"v":[[489,44],[487.736,41.408],[486.127,39.47],[484.454,37.547],[483,35],[482.488,32.443],[482.515,30.288],[482.034,28.489],[480,27],[479.82,27.357],[479.139,28.028],[478.388,28.685],[478,29],[474.413,30.401],[471.379,30.571],[468.405,29.956],[465,29],[463.842,31.658],[464.121,34.248],[464.84,36.714],[465,39],[463.479,41.629],[461.507,43.931],[461,47],[465.653,48.217],[470,49],[472.941,52.786],[477,55],[479.189,51.044],[481,47],[485.035,45.667]],"c":true}],"h":1},{"t":7,"s":[{"i":[[0.947,1.639],[0.828,-0.333],[0.63,-0.515],[0.612,-0.424],[0.774,-0.061],[0.631,0.276],[0.685,0.342],[0.836,0.145],[1.086,-0.316],[-0.023,-1.648],[0.363,-1.286],[0.58,-1.12],[0.628,-1.151],[-0.757,-0.206],[-0.791,0.008],[-0.764,-0.04],[-0.675,-0.35],[-0.438,-0.723],[-0.422,-0.734],[-0.648,-0.394],[-1.116,0.296],[-0.31,0.664],[-0.157,0.743],[-0.269,0.707],[-0.645,0.556],[-1.037,0.131],[-0.982,0.27],[-0.444,0.941],[1.344,0.814],[0.673,1.728],[-0.107,1.532]],"o":[[-1.207,-0.122],[-0.828,0.333],[-0.63,0.515],[-0.612,0.424],[-0.675,0.053],[-0.631,-0.276],[-0.685,-0.342],[-0.836,-0.145],[0.578,2.206],[0.023,1.648],[-0.362,1.286],[-0.58,1.12],[0.662,0.682],[0.757,0.206],[0.791,-0.008],[0.764,0.04],[0.696,0.36],[0.438,0.723],[0.422,0.734],[0.648,0.394],[0.727,-0.471],[0.31,-0.664],[0.157,-0.743],[0.269,-0.707],[0.608,-0.525],[1.037,-0.131],[0.982,-0.27],[0.049,-2.016],[-1.344,-0.814],[-0.479,-1.232],[0.107,-1.532]],"v":[[474,22],[470.992,22.385],[468.85,23.726],[467.033,25.204],[465,26],[463.066,25.599],[461.117,24.605],[458.859,23.808],[456,24],[456.86,29.731],[456.309,34.082],[454.854,37.641],[453,41],[455.143,42.267],[457.48,42.499],[459.826,42.481],[462,43],[463.64,44.712],[464.87,46.985],[466.415,48.765],[469,49],[470.489,47.268],[471.123,45.128],[471.695,42.924],[473,41],[475.589,40.15],[478.739,39.683],[481,38],[478.542,34.284],[475,31],[474.851,26.805]],"c":true}],"h":1},{"t":8,"s":[{"i":[[-1.615,0.844],[0.802,0.948],[0.779,0.971],[0.337,1.413],[-0.524,2.274],[0.707,-0.059],[0.736,-0.379],[0.786,-0.38],[0.857,-0.062],[0.704,0.118],[0.721,0.166],[0.782,0.09],[0.885,-0.11],[-0.106,-0.804],[-0.191,-0.665],[-0.115,-0.654],[0.123,-0.771],[0.444,-0.595],[0.506,-0.566],[0.309,-0.688],[-0.147,-0.96],[-0.779,-0.087],[-0.708,0.105],[-0.7,0.014],[-0.756,-0.359],[-0.199,-0.486],[-0.125,-0.511],[-0.293,-0.32],[-1.131,1.648],[-1.719,1.422],[-1.06,0.302]],"o":[[-0.406,-1.344],[-0.802,-0.948],[-0.779,-0.971],[-0.337,-1.413],[-0.699,-0.579],[-0.707,0.059],[-0.736,0.379],[-0.786,0.38],[-0.729,0.053],[-0.704,-0.118],[-0.721,-0.166],[-0.782,-0.09],[-0.142,1.071],[0.106,0.804],[0.191,0.665],[0.115,0.654],[-0.124,0.774],[-0.444,0.595],[-0.506,0.566],[-0.309,0.688],[0.912,0.561],[0.779,0.087],[0.708,-0.105],[0.7,-0.014],[0.514,0.244],[0.199,0.486],[0.125,0.511],[2.757,3.011],[1.131,-1.648],[1.147,-0.948],[1.06,-0.302]],"v":[[474,34],[472.083,30.667],[469.605,27.895],[467.825,24.425],[468,19],[465.896,18.3],[463.737,19.038],[461.46,20.256],[459,21],[456.861,20.871],[454.734,20.415],[452.489,20.001],[450,20],[449.986,22.78],[450.472,24.95],[450.972,26.896],[451,29],[450.083,31.016],[448.594,32.72],[447.307,34.565],[447,37],[449.52,37.901],[451.734,37.803],[453.831,37.554],[456,38],[457.009,39.149],[457.434,40.699],[458,42],[463.279,42.825],[467,37],[470.149,35.422]],"c":true}],"h":1},{"t":9,"s":[{"i":[[0.34,0.649],[0.776,-0.254],[0.715,-0.217],[0.701,-0.164],[0.735,-0.093],[0.817,-0.005],[0.946,0.101],[1.122,0.223],[-0.127,-0.791],[-0.157,-0.682],[-0.077,-0.675],[0.114,-0.771],[0.497,-0.644],[0.503,-0.614],[0.129,-0.662],[-0.624,-0.791],[-1.315,-0.435],[-0.877,-0.873],[-0.999,-0.751],[-1.68,-0.07],[-0.536,1.048],[-0.855,0.729],[-1.142,0.442],[-1.397,0.187],[0.371,0.747],[0.55,0.604],[0.529,0.68],[0.308,0.974],[0.016,0.544],[0.002,0.591],[0.109,0.626]],"o":[[-0.885,0.273],[-0.776,0.254],[-0.715,0.217],[-0.701,0.164],[-0.735,0.093],[-0.817,0.005],[-0.946,-0.101],[-0.015,1.002],[0.127,0.791],[0.157,0.682],[0.077,0.675],[-0.111,0.755],[-0.497,0.644],[-0.503,0.614],[-0.129,0.662],[2.31,-0.56],[1.315,0.435],[0.877,0.873],[0.999,0.751],[0.185,-1.398],[0.536,-1.048],[0.855,-0.729],[1.142,-0.442],[0.007,-1.109],[-0.371,-0.747],[-0.55,-0.604],[-0.529,-0.68],[-0.154,-0.486],[-0.016,-0.544],[-0.002,-0.591],[-0.109,-0.626]],"v":[[462,15],[459.519,15.794],[457.294,16.505],[455.181,17.081],[453.038,17.47],[450.722,17.621],[448.09,17.481],[445,17],[445.195,19.664],[445.648,21.847],[446.028,23.856],[446,26],[444.992,28.078],[443.397,29.946],[442.353,31.84],[443,34],[448.298,33.952],[451.446,36.054],[454.121,38.629],[458,40],[459.089,36.339],[461.182,33.683],[464.185,31.935],[468,31],[467.403,28.271],[465.972,26.298],[464.305,24.426],[463,22],[462.776,20.451],[462.779,18.745],[462.644,16.916]],"c":true}],"h":1},{"t":10,"s":[{"i":[[-1.046,0.621],[0.361,0.591],[0.461,0.492],[0.477,0.475],[0.411,0.541],[0.263,0.69],[0.031,0.922],[-0.284,1.236],[0.721,-0.155],[0.643,-0.525],[0.725,-0.482],[0.969,-0.028],[0.471,0.283],[0.512,0.332],[0.66,0.133],[0.914,-0.314],[0.046,-0.731],[-0.161,-0.732],[-0.126,-0.76],[0.149,-0.816],[0.428,-0.593],[0.448,-0.626],[0.17,-0.721],[-0.403,-0.876],[-1.315,-0.435],[-0.877,-0.873],[-0.999,-0.751],[-1.68,-0.07],[-0.626,1.041],[-0.969,0.698],[-1.109,0.558]],"o":[[-0.179,-0.774],[-0.361,-0.591],[-0.461,-0.492],[-0.477,-0.475],[-0.411,-0.541],[-0.263,-0.69],[-0.031,-0.922],[-0.961,-0.626],[-0.721,0.155],[-0.643,0.525],[-0.725,0.482],[-0.538,0.015],[-0.471,-0.283],[-0.512,-0.332],[-0.66,-0.133],[-0.493,0.757],[-0.046,0.731],[0.161,0.732],[0.126,0.76],[-0.113,0.62],[-0.428,0.593],[-0.448,0.626],[-0.17,0.721],[2.31,-0.561],[1.315,0.435],[0.877,0.873],[0.999,0.751],[0.079,-1.587],[0.626,-1.041],[0.969,-0.698],[1.109,-0.558]],"v":[[464,27],[463.169,24.974],[461.916,23.37],[460.488,21.941],[459.134,20.438],[458.102,18.612],[457.641,16.216],[458,13],[455.517,12.396],[453.512,13.519],[451.501,15.132],[449,16],[447.513,15.537],[446.064,14.552],[444.334,13.791],[442,14],[441.251,16.224],[441.482,18.411],[441.973,20.642],[442,23],[441.114,24.803],[439.726,26.616],[438.725,28.621],[439,31],[444.298,30.952],[447.446,33.054],[450.121,35.629],[454,37],[455.108,33.108],[457.551,30.551],[460.718,28.718]],"c":true}],"h":1},{"t":11,"s":[{"i":[[-1.031,0.25],[-0.356,0.889],[-0.558,0.577],[-0.662,0.382],[-0.668,0.307],[-0.575,0.349],[-0.383,0.51],[-0.093,0.79],[0.385,0.312],[0.58,0.314],[0.53,0.47],[0.236,0.78],[-0.004,0.488],[-0.076,0.5],[-0.034,0.638],[0.122,0.899],[1.237,-0.264],[1.365,-0.376],[1.57,-0.05],[1.853,0.716],[-0.048,-1.403],[0.275,-1.168],[0.561,-1.057],[0.808,-1.068],[-0.747,-0.222],[-0.828,0.027],[-0.791,-0.015],[-0.638,-0.347],[-0.364,-0.708],[-0.328,-0.723],[-0.551,-0.404]],"o":[[0.055,-1.32],[0.356,-0.889],[0.558,-0.577],[0.662,-0.382],[0.668,-0.307],[0.575,-0.349],[0.383,-0.51],[0.055,-0.465],[-0.385,-0.312],[-0.58,-0.314],[-0.53,-0.47],[-0.181,-0.599],[0.004,-0.488],[0.076,-0.5],[0.034,-0.638],[-1.187,-0.288],[-1.237,0.264],[-1.365,0.376],[-1.57,0.05],[0.409,1.76],[0.048,1.403],[-0.275,1.168],[-0.561,1.057],[0.55,0.761],[0.747,0.222],[0.828,-0.027],[0.791,0.015],[0.657,0.357],[0.364,0.708],[0.328,0.723],[0.551,0.404]],"v":[[450,35],[450.64,31.716],[452.035,29.547],[453.891,28.138],[455.91,27.134],[457.799,26.18],[459.261,24.92],[460,23],[459.444,21.873],[457.937,20.973],[456.21,19.837],[455,18],[454.763,16.401],[454.911,14.95],[455.104,13.274],[455,11],[451.384,11.073],[447.5,12.142],[443.116,12.89],[438,12],[438.676,16.713],[438.326,20.538],[437.062,23.844],[435,27],[436.976,28.401],[439.368,28.621],[441.826,28.53],[444,29],[445.466,30.681],[446.439,32.911],[447.693,34.686]],"c":true}],"h":1},{"t":12,"s":[{"i":[[-0.694,2.73],[0.823,-0.223],[0.641,-0.44],[0.623,-0.372],[0.768,-0.018],[0.484,0.22],[0.579,0.28],[0.68,0.17],[0.788,-0.11],[0.022,-0.697],[-0.142,-0.75],[-0.092,-0.803],[0.169,-0.855],[0.374,-0.562],[0.399,-0.546],[0.2,-0.586],[-0.221,-0.683],[-1.341,-0.48],[-0.877,-0.794],[-0.848,-0.792],[-1.254,-0.473],[-0.323,0.729],[-0.328,0.679],[-0.466,0.611],[-0.738,0.523],[-0.55,0.07],[-0.561,0.114],[-0.355,0.362],[0.067,0.814],[0.972,1.016],[0.52,1.427]],"o":[[-1.166,-0.278],[-0.823,0.223],[-0.641,0.44],[-0.623,0.372],[-0.397,0.009],[-0.484,-0.22],[-0.579,-0.28],[-0.68,-0.17],[-0.397,0.644],[-0.022,0.697],[0.142,0.75],[0.092,0.803],[-0.126,0.635],[-0.374,0.562],[-0.399,0.546],[-0.2,0.586],[2.239,-0.151],[1.341,0.48],[0.877,0.794],[0.848,0.792],[0.452,-0.759],[0.323,-0.729],[0.328,-0.679],[0.466,-0.611],[0.324,-0.23],[0.55,-0.07],[0.561,-0.114],[0.355,-0.362],[-0.661,-1.496],[-0.972,-1.016],[-0.52,-1.427]],"v":[[452,9],[449.057,8.989],[446.902,10.056],[445.046,11.344],[443,12],[441.679,11.642],[440.087,10.849],[438.201,10.132],[436,10],[435.425,12.012],[435.658,14.184],[436.063,16.514],[436,19],[435.194,20.781],[433.979,22.428],[433.025,24.111],[433,26],[438.261,26.573],[441.478,28.564],[443.956,31.023],[447,33],[448.128,30.763],[449.071,28.646],[450.227,26.705],[452,25],[453.366,24.602],[455.087,24.377],[456.514,23.714],[457,22],[454.36,18.454],[451.93,15.012]],"c":true}],"h":1},{"t":13,"s":[{"i":[[-0.537,2.12],[0.492,-0.019],[0.396,-0.152],[0.333,-0.232],[0.303,-0.258],[0.306,-0.231],[0.341,-0.151],[0.408,-0.017],[0.469,0.219],[0.541,0.283],[0.677,0.173],[0.875,-0.111],[0.029,-1.334],[0.341,-1.029],[0.517,-1.056],[0.556,-1.414],[-0.702,-0.096],[-0.697,0.056],[-0.647,-0.001],[-0.55,-0.267],[-0.302,-0.591],[-0.246,-0.604],[-0.446,-0.336],[-0.901,0.213],[-0.609,0.891],[-0.654,0.846],[-0.968,0.532],[-1.552,-0.051],[0.647,0.937],[0.746,0.838],[0.351,1.232]],"o":[[-0.62,-0.167],[-0.492,0.019],[-0.396,0.152],[-0.333,0.232],[-0.303,0.258],[-0.306,0.231],[-0.341,0.151],[-0.459,0.02],[-0.469,-0.219],[-0.541,-0.283],[-0.677,-0.173],[0.42,1.97],[-0.029,1.334],[-0.341,1.029],[-0.517,1.056],[0.661,0.456],[0.702,0.096],[0.697,-0.056],[0.647,0.001],[0.614,0.297],[0.302,0.591],[0.246,0.604],[0.446,0.336],[0.834,-0.666],[0.609,-0.891],[0.654,-0.846],[0.968,-0.532],[-0.053,-1.53],[-0.647,-0.937],[-0.746,-0.838],[-0.351,-1.232]],"v":[[449,8],[447.34,7.792],[446.016,8.063],[444.929,8.653],[443.982,9.401],[443.077,10.148],[442.116,10.734],[441,11],[439.623,10.658],[438.123,9.862],[436.311,9.136],[434,9],[434.552,13.872],[433.963,17.333],[432.643,20.378],[431,24],[433.055,24.775],[435.166,24.783],[437.193,24.65],[439,25],[440.31,26.403],[441.069,28.266],[442.043,29.746],[444,30],[446.097,27.597],[447.923,24.923],[450.288,22.788],[454,22],[452.826,18.424],[450.614,15.886],[448.845,12.905]],"c":true}],"h":1},{"t":14,"s":[{"i":[[-1.813,0.187],[0.644,0.773],[0.685,0.732],[0.324,1.093],[-0.441,1.857],[0.658,-0.054],[0.579,-0.389],[0.632,-0.391],[0.816,-0.059],[0.44,0.178],[0.442,0.207],[0.531,0.051],[0.708,-0.292],[0.015,-0.54],[-0.11,-0.614],[-0.07,-0.642],[0.134,-0.625],[0.324,-0.499],[0.352,-0.432],[0.227,-0.467],[-0.051,-0.604],[-0.602,-0.126],[-0.622,0.065],[-0.584,0.033],[-0.488,-0.222],[-0.338,-0.546],[-0.274,-0.575],[-0.424,-0.367],[-0.787,0.079],[-0.877,1.123],[-1.156,0.844]],"o":[[-0.2,-1.216],[-0.644,-0.773],[-0.685,-0.732],[-0.324,-1.093],[-0.867,-0.614],[-0.658,0.054],[-0.579,0.389],[-0.632,0.391],[-0.525,0.038],[-0.44,-0.178],[-0.442,-0.208],[-0.531,-0.051],[-0.305,0.421],[-0.015,0.54],[0.11,0.614],[0.07,0.642],[-0.143,0.667],[-0.324,0.499],[-0.352,0.432],[-0.227,0.467],[0.524,0.54],[0.602,0.126],[0.622,-0.065],[0.584,-0.033],[0.615,0.279],[0.338,0.546],[0.274,0.575],[0.424,0.367],[0.976,-1.024],[0.877,-1.123],[1.156,-0.844]],"v":[[452,20],[450.633,17.117],[448.538,14.962],[446.925,12.325],[447,8],[444.745,7.242],[442.922,7.989],[441.138,9.241],[439,10],[437.575,9.744],[436.275,9.12],[434.838,8.685],[433,9],[432.56,10.452],[432.742,12.194],[433.054,14.089],[433,16],[432.261,17.724],[431.209,19.095],[430.303,20.418],[430,22],[431.703,22.943],[433.554,22.977],[435.378,22.773],[437,23],[438.376,24.297],[439.242,26.038],[440.236,27.51],[442,28],[444.685,24.685],[447.64,21.64]],"c":true}],"h":1},{"t":15,"s":[{"i":[[-1.22,0.03],[0.201,0.424],[0.269,0.356],[0.294,0.331],[0.278,0.347],[0.22,0.405],[0.12,0.505],[-0.021,0.646],[-0.205,0.83],[0.483,0.011],[0.449,-0.11],[0.443,-0.176],[0.465,-0.187],[0.517,-0.144],[0.596,-0.047],[0.705,0.106],[0.842,0.313],[-0.071,-0.707],[0.043,-0.538],[0.127,-0.442],[0.18,-0.419],[0.203,-0.47],[0.196,-0.595],[0.159,-0.793],[-1.007,-0.356],[-0.624,-0.628],[-0.68,-0.583],[-1.174,-0.221],[-0.433,0.817],[-0.61,0.64],[-0.873,0.377]],"o":[[-0.091,-0.534],[-0.201,-0.424],[-0.269,-0.356],[-0.294,-0.331],[-0.278,-0.347],[-0.22,-0.405],[-0.12,-0.505],[0.021,-0.646],[-0.546,-0.187],[-0.483,-0.011],[-0.449,0.11],[-0.443,0.176],[-0.465,0.187],[-0.517,0.144],[-0.596,0.047],[-0.705,-0.106],[0.215,0.951],[0.071,0.707],[-0.043,0.538],[-0.127,0.442],[-0.18,0.419],[-0.203,0.47],[-0.196,0.595],[1.828,-0.232],[1.007,0.356],[0.624,0.628],[0.68,0.583],[0.339,-0.91],[0.433,-0.817],[0.61,-0.64],[0.873,-0.377]],"v":[[449,19],[448.551,17.574],[447.836,16.414],[446.981,15.394],[446.111,14.389],[445.352,13.273],[444.831,11.919],[444.671,10.204],[445,8],[443.462,7.716],[442.072,7.877],[440.742,8.319],[439.387,8.877],[437.921,9.389],[436.259,9.689],[434.314,9.614],[432,9],[432.422,11.469],[432.457,13.318],[432.195,14.769],[431.728,16.042],[431.146,17.357],[430.539,18.937],[430,21],[434.143,21.266],[436.481,22.821],[438.328,24.716],[441,26],[442.137,23.387],[443.68,21.18],[445.883,19.633]],"c":true}],"h":1},{"t":16,"s":[{"i":[[-1.637,-0.192],[0.249,0.466],[0.473,0.466],[0.488,0.517],[0.293,0.618],[-0.002,0.415],[-0.039,0.242],[0.232,0.206],[0.813,0.307],[0.239,-0.191],[0.376,-0.239],[0.324,-0.179],[0.083,-0.009],[0.679,0.191],[0.344,0.105],[0.118,-0.388],[0,-1.288],[0.231,-0.735],[0.284,-0.543],[0.162,-0.411],[-0.138,-0.34],[-0.416,-0.076],[-0.557,0.077],[-0.612,-0.011],[-0.582,-0.338],[-0.162,-0.477],[-0.152,-0.507],[-0.288,-0.277],[-0.572,0.213],[-0.491,0.953],[-0.868,0.577]],"o":[[0.185,-0.516],[-0.249,-0.466],[-0.473,-0.466],[-0.488,-0.517],[-0.344,-0.724],[0.002,-0.415],[0.039,-0.242],[-0.232,-0.206],[0.087,0.033],[-0.239,0.191],[-0.376,0.239],[-0.324,0.179],[-1.124,0.131],[-0.679,-0.191],[-0.344,-0.105],[-0.118,0.388],[0,0.988],[-0.231,0.735],[-0.284,0.543],[-0.162,0.411],[0.19,0.469],[0.416,0.076],[0.557,-0.077],[0.612,0.011],[0.32,0.186],[0.162,0.477],[0.152,0.507],[0.288,0.277],[0.508,-0.937],[0.491,-0.953],[0.868,-0.577]],"v":[[446,18],[445.852,16.54],[444.718,15.153],[443.224,13.691],[442,12],[441.565,10.325],[441.704,9.373],[441.491,8.735],[440,8],[439.724,8.362],[438.754,9.035],[437.657,9.69],[437,10],[434.322,9.808],[432.814,9.263],[432.149,9.587],[432,12],[431.61,14.57],[430.793,16.473],[430.08,17.889],[430,19],[430.931,19.757],[432.412,19.696],[434.188,19.536],[436,20],[436.687,21.059],[437.122,22.599],[437.746,23.84],[439,24],[440.401,21.068],[442.341,18.675]],"c":true}],"h":1},{"t":17,"s":[{"i":[[0.104,0],[0.219,0.026],[0.311,0.037],[0.361,0.035],[0.37,0.018],[0.337,-0.012],[0.263,-0.055],[0.147,-0.113],[0.01,-0.426],[-0.052,-0.545],[-0.037,-0.471],[0.057,-0.206],[0.238,-0.339],[-0.032,0.015],[-0.503,-0.028],[-1.178,-0.469],[-0.423,-0.587],[-0.331,-0.467],[-0.368,0.103],[-0.532,1.124],[-0.527,0.454],[-0.271,0.184],[0.141,0.513],[0.709,1.442],[-0.012,0.256],[-0.049,0.274],[-0.013,0.256],[0.098,0.202],[0.285,0.074],[0.301,-0.099],[0.241,-0.123]],"o":[[-0.086,0],[-0.219,-0.026],[-0.311,-0.037],[-0.361,-0.035],[-0.37,-0.018],[-0.337,0.012],[-0.263,0.055],[-0.151,0.117],[-0.01,0.426],[0.052,0.545],[0.037,0.471],[-0.305,1.091],[-0.238,0.339],[0.032,-0.015],[0.503,0.028],[0.642,0.255],[0.423,0.587],[0.331,0.467],[0.368,-0.103],[0.627,-1.323],[0.527,-0.454],[0.271,-0.184],[-0.141,-0.513],[-0.099,-0.201],[0.012,-0.256],[0.049,-0.274],[0.013,-0.256],[-0.192,-0.395],[-0.285,-0.074],[-0.301,0.099],[-0.241,0.123]],"v":[[438,10],[437.533,9.958],[436.729,9.86],[435.711,9.75],[434.605,9.667],[433.535,9.654],[432.625,9.751],[432,10],[431.777,10.862],[431.859,12.367],[432.012,13.938],[432,15],[431.136,17.047],[430.777,17.434],[431.529,17.354],[434,18],[435.565,19.376],[436.665,21.069],[437.682,21.728],[439,20],[440.769,17.484],[442.004,16.677],[442.236,15.782],[441,13],[440.888,12.305],[440.999,11.501],[441.11,10.696],[441,10],[440.266,9.335],[439.368,9.409],[438.536,9.779]],"c":true}],"h":1},{"t":18,"s":[{"i":[[-0.049,-0.004],[0.543,0.057],[0.484,-0.026],[0.449,-0.195],[0.438,-0.45],[-0.005,-0.446],[0.267,-0.883],[0.263,-0.746],[-0.016,-0.035],[-0.373,0.023],[-0.506,0.059],[-0.505,-0.118],[-0.37,-0.509],[0.003,-0.194],[0.013,-0.24],[0.003,-0.177],[-0.026,-0.002],[-0.335,0.159],[-0.237,0.299],[-0.283,0.365],[-0.475,0.357],[-0.403,0.208],[-0.085,0.1],[0.236,0.217],[0.558,0.558],[0.089,0.464],[-0.007,0.493],[0.032,0.407],[0.208,0.207],[0.313,-0.147],[0.231,-0.214]],"o":[[-0.627,-0.053],[-0.543,-0.057],[-0.484,0.026],[-0.449,0.195],[0.551,-0.566],[0.005,0.446],[-0.267,0.883],[-0.263,0.746],[0.105,0.227],[0.373,-0.023],[0.506,-0.059],[0.505,0.118],[0.026,0.036],[-0.003,0.194],[-0.013,0.24],[-0.003,0.177],[0.578,0.054],[0.335,-0.159],[0.237,-0.299],[0.283,-0.365],[0.719,-0.541],[0.403,-0.208],[0.085,-0.1],[-0.236,-0.217],[-0.321,-0.321],[-0.089,-0.464],[0.007,-0.493],[-0.032,-0.407],[-0.197,-0.197],[-0.313,0.147],[-0.231,0.214]],"v":[[437,10],[435.251,9.813],[433.716,9.745],[432.324,10.055],[431,11],[431.765,10.964],[431.303,13.1],[430.439,15.686],[430,17],[430.751,17.253],[432.103,17.077],[433.654,17.112],[435,18],[435.03,18.372],[435,19.051],[434.97,19.704],[435,20],[436.333,19.824],[437.155,19.117],[437.899,18.102],[439,17],[440.684,15.931],[441.416,15.525],[441.19,15.106],[440,14],[439.419,12.793],[439.33,11.329],[439.327,9.951],[439,9],[438.186,8.994],[437.322,9.604]],"c":true}],"h":1},{"t":19,"s":[{"i":[[-0.05,-0.004],[0.643,-0.09],[0.106,-0.27],[-0.089,-0.42],[0.055,-0.54],[0.216,-0.237],[0.27,-0.317],[0.169,-0.296],[-0.087,-0.176],[-0.65,-0.332],[-0.825,-0.325],[-0.638,-0.205],[-0.087,0.027],[-0.083,0.274],[-0.131,0.374],[-0.108,0.288],[-0.014,0.016],[-0.233,0.047],[-0.184,0.021],[-0.109,0.214],[-0.007,0.625],[0.161,0.168],[0.231,0.108],[0.204,0.136],[0.081,0.252],[-0.023,0.276],[-0.036,0.314],[0.004,0.256],[0.1,0.102],[0.313,-0.147],[0.231,-0.214]],"o":[[-1.519,-0.12],[-0.643,0.09],[-0.106,0.27],[0.089,0.42],[-0.006,0.058],[-0.216,0.237],[-0.27,0.317],[-0.169,0.296],[0.112,0.227],[0.65,0.332],[0.825,0.325],[0.638,0.205],[-0.037,0.011],[0.083,-0.274],[0.131,-0.374],[0.108,-0.288],[0.255,-0.292],[0.233,-0.047],[0.184,-0.021],[0.109,-0.214],[0.004,-0.315],[-0.161,-0.168],[-0.231,-0.108],[-0.204,-0.136],[-0.046,-0.142],[0.023,-0.276],[0.036,-0.314],[-0.004,-0.256],[-0.195,-0.198],[-0.313,0.147],[-0.231,0.214]],"v":[[436,10],[432.842,9.963],[431.804,10.51],[431.864,11.552],[432,13],[431.628,13.467],[430.86,14.323],[430.162,15.267],[430,16],[431.234,16.866],[433.538,17.88],[435.822,18.704],[437,19],[437.087,18.559],[437.425,17.54],[437.8,16.501],[438,16],[438.739,15.547],[439.372,15.501],[439.819,15.204],[440,14],[439.739,13.297],[439.127,12.905],[438.452,12.56],[438,12],[437.979,11.349],[438.081,10.439],[438.143,9.56],[438,9],[437.188,8.993],[436.322,9.604]],"c":true}],"h":1},{"t":20,"s":[{"i":[[0.216,-0.033],[0.178,0.007],[0.216,0.022],[0.233,0.025],[0.228,0.017],[0.203,-0.001],[0.157,-0.031],[0.091,-0.072],[0.137,-0.554],[0.099,-0.695],[0.037,-0.544],[-0.048,-0.099],[-0.309,-0.089],[-0.421,-0.17],[-0.276,-0.121],[0.124,0.057],[-0.223,-0.13],[-0.242,-0.114],[-0.273,-0.052],[-0.316,0.056],[-0.403,0.374],[-0.462,0.489],[-0.329,0.37],[-0.001,0.018],[0.191,0.236],[0.246,0.437],[0.182,0.357],[-0.002,-0.003],[0.299,0.223],[0.207,-0.025],[0.18,-0.11]],"o":[[-0.12,0.018],[-0.178,-0.007],[-0.216,-0.022],[-0.233,-0.025],[-0.228,-0.017],[-0.203,0.001],[-0.157,0.031],[-0.152,0.12],[-0.137,0.554],[-0.099,0.695],[-0.037,0.544],[-0.058,-0.121],[0.309,0.089],[0.421,0.17],[0.276,0.121],[0.217,0.101],[0.223,0.13],[0.242,0.114],[0.273,0.052],[0.149,-0.026],[0.402,-0.374],[0.463,-0.489],[0.329,-0.37],[-0.017,0.244],[-0.191,-0.236],[-0.246,-0.437],[-0.182,-0.357],[-0.454,-0.631],[-0.299,-0.223],[-0.207,0.025],[-0.18,0.11]],"v":[[435,10],[434.548,10.014],[433.952,9.969],[433.274,9.896],[432.577,9.83],[431.924,9.803],[431.377,9.849],[431,10],[430.561,11.084],[430.201,13.031],[429.991,14.962],[430,16],[430.441,15.984],[431.599,16.404],[432.708,16.873],[433,17],[433.657,17.358],[434.351,17.736],[435.12,17.996],[436,18],[436.875,17.34],[438.221,15.987],[439.457,14.64],[440,14],[439.659,13.941],[438.972,12.862],[438.3,11.601],[438,11],[436.887,9.759],[436.143,9.503],[435.578,9.745]],"c":true}],"h":1},{"t":21,"s":[{"i":[[-0.074,0.001],[0.174,0.013],[0.219,0.02],[0.239,0.019],[0.236,0.01],[0.207,-0.006],[0.154,-0.029],[0.077,-0.061],[0.125,-0.5],[0.135,-0.688],[0.067,-0.594],[-0.077,-0.218],[-0.263,-0.001],[-0.353,0.021],[-0.289,0.011],[-0.071,-0.029],[-0.123,-0.217],[-0.142,-0.251],[-0.198,-0.158],[-0.291,0.06],[-0.289,0.399],[-0.448,0.483],[-0.31,0.218],[0.126,-0.397],[0.107,0.653],[0.165,0.73],[0.1,0.462],[-0.087,-0.152],[0.228,-0.064],[0.246,-0.165],[0.145,-0.144]],"o":[[-0.104,0.001],[-0.174,-0.013],[-0.219,-0.02],[-0.239,-0.019],[-0.236,-0.01],[-0.207,0.006],[-0.154,0.029],[-0.038,0.03],[-0.125,0.5],[-0.135,0.688],[-0.067,0.594],[0.019,0.054],[0.263,0.001],[0.352,-0.021],[0.289,-0.011],[0.142,0.057],[0.123,0.217],[0.142,0.251],[0.198,0.158],[-0.167,0.035],[0.289,-0.399],[0.448,-0.483],[0.31,-0.218],[0.073,-0.232],[-0.107,-0.653],[-0.165,-0.73],[-0.1,-0.462],[-0.092,-0.16],[-0.228,0.064],[-0.246,0.165],[-0.145,0.144]],"v":[[435,10],[434.578,9.98],[433.983,9.929],[433.29,9.87],[432.571,9.824],[431.901,9.816],[431.353,9.867],[431,10],[430.736,10.866],[430.328,12.718],[430.005,14.712],[430,16],[430.461,16.075],[431.422,16.038],[432.422,15.982],[433,16],[433.389,16.443],[433.777,17.176],[434.276,17.822],[435,18],[435.258,17.366],[436.439,15.956],[437.65,14.818],[438,15],[437.919,13.586],[437.48,11.425],[437.051,9.551],[437,9],[436.491,8.886],[435.751,9.26],[435.136,9.755]],"c":true}],"h":1},{"t":22,"s":[{"i":[[0.147,-0.004],[0.176,0.013],[0.215,0.02],[0.233,0.02],[0.23,0.011],[0.205,-0.005],[0.158,-0.03],[0.091,-0.063],[0.119,-0.511],[0.073,-0.609],[0.043,-0.418],[0.028,0.061],[-0.261,0],[-0.345,0.029],[-0.287,0.015],[-0.085,-0.043],[-0.043,-0.259],[-0.041,-0.259],[-0.227,-0.121],[-0.602,0.157],[-0.084,0.199],[-0.17,0.273],[-0.126,0.187],[0.048,-0.059],[-0.195,0.329],[0.066,0.245],[0.228,0.418],[0.293,0.851],[0.07,0.067],[0.058,-0.086],[0.084,-0.11]],"o":[[-0.115,0.003],[-0.176,-0.013],[-0.215,-0.02],[-0.233,-0.02],[-0.23,-0.011],[-0.205,0.005],[-0.158,0.03],[-0.18,0.125],[-0.119,0.511],[-0.073,0.609],[-0.043,0.418],[0.034,0.073],[0.261,0],[0.345,-0.029],[0.287,-0.015],[0.234,0.12],[0.043,0.259],[0.041,0.259],[0.227,0.121],[-0.132,0.034],[0.084,-0.199],[0.17,-0.273],[0.126,-0.187],[0.555,-0.671],[0.195,-0.329],[-0.066,-0.244],[-0.228,-0.418],[-0.12,-0.348],[-0.07,-0.067],[-0.058,0.086],[-0.084,0.11]],"v":[[435,10],[434.558,9.984],[433.965,9.933],[433.287,9.87],[432.587,9.822],[431.929,9.811],[431.379,9.862],[431,10],[430.556,11.027],[430.272,12.779],[430.102,14.392],[430,15],[430.478,15.1],[431.423,15.045],[432.407,14.968],[433,15],[433.368,15.603],[433.447,16.415],[433.802,17.02],[435,17],[434.962,16.712],[435.375,15.963],[435.852,15.233],[436,15],[437.101,13.564],[437.271,12.768],[436.806,11.839],[436,10],[435.725,9.41],[435.541,9.471],[435.337,9.797]],"c":true}],"h":1},{"t":23,"s":[{"i":[[0.058,-0.054],[0.048,-0.117],[0.059,-0.182],[0.064,-0.221],[0.061,-0.234],[0.051,-0.223],[0.034,-0.186],[0.009,-0.123],[-0.022,-0.035],[-0.309,-0.154],[-0.37,-0.003],[-0.396,0.11],[-0.386,0.185],[-0.341,0.222],[-0.26,0.221],[-0.144,0.181],[0.007,0.104],[0.052,0.048],[0.089,0.067],[0.112,0.082],[0.121,0.094],[0.115,0.101],[0.096,0.105],[0.063,0.104],[0.015,0.1],[0.155,0.194],[0.22,0.055],[0.253,-0.044],[0.253,-0.105],[0.221,-0.126],[0.156,-0.11]],"o":[[-0.029,0.027],[-0.048,0.117],[-0.059,0.182],[-0.064,0.221],[-0.061,0.234],[-0.051,0.223],[-0.034,0.186],[-0.009,0.123],[0.213,0.343],[0.309,0.154],[0.37,0.003],[0.396,-0.11],[0.386,-0.185],[0.341,-0.222],[0.26,-0.221],[0.144,-0.181],[-0.002,-0.025],[-0.052,-0.048],[-0.089,-0.067],[-0.112,-0.082],[-0.121,-0.094],[-0.115,-0.101],[-0.096,-0.105],[-0.063,-0.104],[-0.056,-0.37],[-0.155,-0.194],[-0.22,-0.055],[-0.253,0.044],[-0.253,0.105],[-0.221,0.126],[-0.156,0.11]],"v":[[431,11],[430.883,11.222],[430.721,11.677],[430.535,12.286],[430.347,12.976],[430.178,13.668],[430.05,14.287],[429.983,14.756],[430,15],[430.793,15.736],[431.821,15.963],[432.979,15.793],[434.16,15.342],[435.259,14.723],[436.169,14.05],[436.785,13.438],[437,13],[436.915,12.89],[436.699,12.716],[436.394,12.491],[436.041,12.225],[435.683,11.932],[435.362,11.622],[435.12,11.307],[435,11],[434.675,10.164],[434.105,9.8],[433.388,9.792],[432.621,10.025],[431.902,10.381],[431.329,10.745]],"c":true}],"h":1},{"t":24,"s":[{"i":[[0.02,-0.028],[0.078,-0.316],[-0.035,-0.307],[-0.124,-0.284],[-0.189,-0.247],[-0.23,-0.195],[-0.247,-0.129],[-0.24,-0.048],[-0.209,0.046],[0.023,0.068],[-0.077,0.136],[-0.143,0.172],[-0.175,0.173],[-0.172,0.141],[-0.135,0.075],[-0.064,-0.024],[0.041,-0.157],[0.063,0.409],[0.217,0.282],[0.315,0.18],[0.358,0.102],[0.344,0.048],[0.274,0.019],[0.148,0.014],[-0.033,0.033],[0.007,-0.04],[-0.004,-0.051],[-0.01,-0.057],[-0.011,-0.058],[-0.006,-0.053],[0.004,-0.044]],"o":[[-0.215,0.31],[-0.078,0.316],[0.035,0.307],[0.124,0.284],[0.189,0.247],[0.23,0.195],[0.247,0.129],[0.24,0.048],[-0.158,0.035],[-0.023,-0.068],[0.077,-0.136],[0.143,-0.172],[0.175,-0.173],[0.172,-0.141],[0.135,-0.075],[0.064,0.024],[0.147,-0.56],[-0.063,-0.409],[-0.217,-0.282],[-0.315,-0.18],[-0.358,-0.102],[-0.344,-0.048],[-0.274,-0.019],[-0.148,-0.014],[-0.024,0.024],[-0.007,0.04],[0.004,0.051],[0.01,0.057],[0.011,0.058],[0.006,0.053],[-0.004,0.044]],"v":[[431,11],[430.566,11.942],[430.508,12.879],[430.752,13.769],[431.228,14.568],[431.862,15.234],[432.584,15.723],[433.32,15.993],[434,16],[433.737,15.943],[433.826,15.628],[434.165,15.158],[434.65,14.633],[435.18,14.153],[435.65,13.82],[435.957,13.736],[436,14],[436.112,12.552],[435.678,11.521],[434.865,10.835],[433.842,10.419],[432.775,10.201],[431.834,10.107],[431.187,10.065],[431,10],[430.954,10.098],[430.951,10.237],[430.973,10.401],[431.005,10.576],[431.031,10.744],[431.035,10.891]],"c":true}],"h":1},{"t":25,"s":[{"i":[[0.003,0],[0.303,-0.094],[0.207,-0.122],[0.121,-0.142],[0.045,-0.154],[-0.02,-0.159],[-0.076,-0.156],[-0.121,-0.146],[-0.156,-0.128],[-0.181,-0.102],[-0.196,-0.069],[-0.2,-0.028],[-0.195,0.02],[-0.179,0.075],[-0.153,0.139],[-0.117,0.21],[-0.01,0.249],[0.088,0.236],[0.15,0.215],[0.177,0.187],[0.169,0.151],[0.126,0.108],[0.047,0.057],[-0.066,-0.001],[0.001,-0.027],[0,-0.047],[-0.001,-0.058],[-0.001,-0.062],[-0.001,-0.059],[0,-0.047],[0.001,-0.028]],"o":[[-0.41,0.059],[-0.303,0.094],[-0.207,0.122],[-0.121,0.142],[-0.045,0.154],[0.02,0.159],[0.076,0.156],[0.121,0.146],[0.156,0.128],[0.181,0.102],[0.196,0.069],[0.2,0.028],[0.195,-0.02],[0.179,-0.075],[0.153,-0.139],[0.142,-0.255],[0.01,-0.249],[-0.088,-0.236],[-0.15,-0.215],[-0.177,-0.187],[-0.169,-0.151],[-0.126,-0.108],[-0.047,-0.057],[-0.002,0],[-0.001,0.027],[0,0.047],[0.001,0.058],[0.001,0.062],[0.001,0.059],[0,0.047],[-0.001,0.028]],"v":[[433,11],[431.933,11.232],[431.17,11.559],[430.68,11.956],[430.432,12.401],[430.397,12.872],[430.544,13.346],[430.842,13.8],[431.26,14.212],[431.769,14.559],[432.337,14.818],[432.933,14.966],[433.529,14.981],[434.092,14.84],[434.593,14.521],[435,14],[435.218,13.243],[435.092,12.515],[434.727,11.838],[434.228,11.233],[433.7,10.725],[433.25,10.335],[432.981,10.086],[433,10],[432.996,10.043],[432.996,10.156],[432.998,10.316],[433.002,10.499],[433.005,10.682],[433.007,10.842],[433.006,10.956]],"c":true}],"h":1},{"t":26.0000010590017,"s":[{"i":[[0.008,-0.003],[0.287,-0.173],[0.18,-0.16],[0.087,-0.145],[0.007,-0.127],[-0.06,-0.107],[-0.114,-0.084],[-0.154,-0.059],[-0.181,-0.031],[-0.195,-0.001],[-0.195,0.032],[-0.182,0.067],[-0.156,0.104],[-0.116,0.144],[-0.063,0.186],[0.003,0.231],[0.053,0.043],[0.091,0.09],[0.114,0.119],[0.123,0.131],[0.117,0.124],[0.095,0.1],[0.059,0.059],[0.008,0],[0.002,-0.027],[-0.001,-0.046],[-0.003,-0.057],[-0.004,-0.062],[-0.003,-0.058],[-0.001,-0.047],[0.003,-0.029]],"o":[[-0.407,0.184],[-0.287,0.173],[-0.18,0.16],[-0.087,0.145],[-0.007,0.127],[0.06,0.107],[0.114,0.084],[0.154,0.059],[0.181,0.031],[0.195,0.001],[0.195,-0.032],[0.182,-0.067],[0.156,-0.104],[0.116,-0.144],[0.063,-0.186],[0,0.022],[-0.053,-0.043],[-0.091,-0.09],[-0.114,-0.119],[-0.123,-0.131],[-0.117,-0.124],[-0.095,-0.1],[-0.059,-0.059],[-0.007,0],[-0.002,0.027],[0.001,0.046],[0.003,0.057],[0.004,0.062],[0.003,0.058],[0.001,0.047],[-0.003,0.029]],"v":[[433,11],[431.963,11.537],[431.265,12.038],[430.868,12.496],[430.731,12.904],[430.815,13.255],[431.079,13.541],[431.483,13.755],[431.989,13.89],[432.555,13.938],[433.143,13.893],[433.711,13.746],[434.221,13.49],[434.632,13.119],[434.905,12.625],[435,12],[434.917,11.964],[434.698,11.76],[434.386,11.443],[434.026,11.064],[433.663,10.677],[433.341,10.336],[433.105,10.092],[433,10],[432.987,10.043],[432.986,10.154],[432.993,10.31],[433.003,10.491],[433.013,10.672],[433.018,10.832],[433.015,10.949]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":0,"s":[0],"h":1},{"t":1,"s":[100],"h":1},{"t":27.0000010997325,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 1"},{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":2,"s":[{"i":[[-1.285,0.202],[0.084,0.613],[-0.006,0.559],[-0.012,0.493],[0.068,0.414],[0.232,0.321],[0.481,0.216],[0.814,0.098],[0.017,-1.1],[-0.166,-0.917],[-0.6,-0.483]],"o":[[-0.259,-0.654],[-0.084,-0.613],[0.006,-0.559],[0.012,-0.493],[-0.068,-0.414],[-0.232,-0.321],[-0.481,-0.216],[0.051,1.032],[-0.017,1.1],[0.166,0.917],[0.6,0.483]],"v":[[526,100],[525.507,98.097],[525.411,96.335],[525.46,94.754],[525.397,93.391],[524.969,92.285],[523.921,91.475],[522,91],[521.989,94.261],[522.149,97.35],[523.235,99.514]],"c":true}],"h":1},{"t":3,"s":[{"i":[[3.678,-0.172],[1.659,-1.508],[3.246,0.079],[-1.213,-1.023],[-0.385,-1.496],[0.443,-1.14],[-1.486,-1.335],[-2.906,0.08],[-1.848,1.713],[-1.954,4.046],[2.364,1.525]],"o":[[-1.12,2.047],[-1.659,1.508],[-0.238,2.411],[1.213,1.023],[0.285,1.105],[-0.443,1.14],[3.094,0.035],[2.67,-0.073],[-1.503,-7.503],[-2.554,-2.15],[-2.336,-1.507]],"v":[[577,59],[573.094,64.594],[566,67],[568.032,71.686],[571,75],[570.1,78.327],[571,82],[579,80],[586,81],[590,67],[582,65]],"c":true}],"h":1},{"t":4,"s":[{"i":[[5.091,0.909],[1.464,-1.369],[2.997,0.165],[-1.172,-1.828],[0.978,-3.978],[-2.155,0.307],[-2.476,-1.608],[0.101,1.337],[-0.353,1.334],[-0.805,1.073],[0.549,1.465]],"o":[[-1.146,1.688],[-1.464,1.369],[0.291,2.709],[1.172,1.828],[2.904,-0.381],[2.155,-0.307],[1.052,-1.32],[-0.101,-1.337],[0.33,-1.245],[0.805,-1.073],[-7.759,1.759]],"v":[[581,52],[577.389,56.889],[571,59],[573.952,65.048],[575,73],[582.322,71.508],[589,73],[590.024,69.011],[590,65],[592.159,61.665],[593,58]],"c":true}],"h":1},{"t":5,"s":[{"i":[[2.628,0.037],[0.8,-0.977],[1.209,-0.569],[1.599,-0.179],[-1.22,-1.613],[0.977,-3.811],[-1.942,0.093],[-3.069,-1.015],[-0.827,2.006],[-0.384,2.45],[1.354,1.682]],"o":[[-0.373,1.404],[-0.8,0.977],[-1.209,0.569],[0.098,2.736],[1.22,1.613],[3.165,-0.642],[1.942,-0.093],[-0.692,-3.525],[0.827,-2.006],[-3.955,0.766],[-1.354,-1.682]],"v":[[584,46],[582.235,49.568],[579.216,51.883],[575,53],[577.806,58.694],[579,66],[586.072,64.758],[593,66],[593.694,58.194],[596,52],[589.005,49.602]],"c":true}],"h":1},{"t":6,"s":[{"i":[[3.4,-0.597],[1.464,-1.203],[2.322,-0.345],[-0.923,-1.083],[-0.289,-1.495],[0.33,-0.82],[-1.155,-0.867],[-4.977,-2.354],[-0.601,2.387],[-0.039,2.713],[1.916,1.192]],"o":[[-0.822,1.844],[-1.464,1.203],[0.019,2.172],[0.923,1.083],[0.165,0.852],[-0.33,0.82],[5.148,-1.579],[1.761,-2.138],[0.679,-2.693],[-1.85,-1.862],[-2.123,-1.32]],"v":[[587,41],[583.624,45.624],[578,48],[579.797,52.508],[582,56],[581.257,58.489],[582,61],[595,61],[595,54],[599,48],[592,46]],"c":true}],"h":1},{"t":7,"s":[{"i":[[2.327,0.506],[0.768,-1.009],[1.211,-0.567],[1.695,-0.083],[-1.123,-1.71],[0.827,-3.66],[-2.022,0.179],[-2.679,-0.592],[-0.935,1.732],[-0.022,2.645],[1.296,1.537]],"o":[[-0.367,1.411],[-0.768,1.009],[-1.211,0.567],[0.334,2.499],[1.123,1.71],[2.235,-0.877],[2.022,-0.179],[-0.762,-3.429],[0.935,-1.732],[-3.487,0.654],[-1.296,-1.537]],"v":[[589,37],[587.307,40.641],[584.349,43.016],[580,44],[582.87,49.63],[584,57],[590.167,55.398],[597,56],[597.912,48.912],[600,43],[593.63,40.87]],"c":true}],"h":1},{"t":8,"s":[{"i":[[0.729,0.808],[1.477,-1.19],[2.389,-0.278],[-1.03,-1.636],[0.68,-3.346],[-1.843,-0.044],[-2.884,-0.781],[-0.63,1.614],[-1.269,2.168],[1.887,1.286],[0.249,0.32]],"o":[[-0.704,1.962],[-1.477,1.19],[0.558,2.108],[1.031,1.636],[2.742,-0.957],[1.844,0.044],[-0.787,-3.377],[0.63,-1.614],[-1.736,-1.934],[-0.292,-0.199],[-0.655,-0.841]],"v":[[591,34],[587.764,38.763],[582,41],[584.928,46.072],[586,53],[592.393,51.697],[599,53],[598.958,46.093],[602,41],[595,39],[594,36]],"c":true}],"h":1},{"t":9,"s":[{"i":[[2.238,0.595],[0.634,-0.921],[1.051,-0.504],[1.653,0.098],[-0.927,-1.573],[0.819,-3.319],[-2.321,0.434],[-2.401,-1.264],[-0.729,1.772],[-0.635,1.864],[1.422,1.411]],"o":[[-0.402,1.154],[-0.634,0.921],[-1.051,0.504],[0.111,2.389],[0.927,1.573],[1.314,0.471],[2.321,-0.434],[-0.55,-3.05],[0.729,-1.772],[-3.073,0.239],[-1.422,-1.411]],"v":[[592,32],[590.492,35.159],[588.01,37.344],[584,38],[586.197,43.303],[587,50],[592.685,49.405],[600,50],[600.611,43.111],[603,38],[596.874,35.626]],"c":true}],"h":1},{"t":10,"s":[{"i":[[2.238,0.595],[0.569,-0.986],[1.019,-0.537],[1.847,0.292],[-0.927,-1.573],[0.819,-3.319],[-1.745,0.142],[-2.885,-1.1],[-0.709,1.791],[-0.757,1.742],[1.422,1.411]],"o":[[-0.499,1.056],[-0.569,0.986],[-1.019,0.537],[0.111,2.389],[0.927,1.573],[3.134,-0.532],[1.745,-0.142],[-0.594,-3.094],[0.709,-1.791],[-3.073,0.239],[-1.422,-1.411]],"v":[[593,30],[591.492,33.159],[589.205,35.538],[585,36],[587.197,41.303],[588,48],[594.686,46.776],[601,48],[601.486,40.986],[604,36],[597.874,33.626]],"c":true}],"h":1},{"t":11,"s":[{"i":[[-0.892,5.333],[1.211,1.41],[1.896,-0.197],[0.691,-1.13],[1.027,-0.458],[0.741,-0.006],[0.325,-0.657],[-0.697,-0.729],[-0.303,-1.692],[-0.543,-0.418],[-1.602,-2.702]],"o":[[-3.262,0.445],[-1.211,-1.41],[-0.209,0.021],[-0.691,1.13],[-0.712,0.317],[-0.74,0.006],[-0.092,1.392],[0.697,0.729],[0.138,0.771],[1.838,1.414],[-1.994,-6.168]],"v":[[604,34],[597.976,31.686],[594,29],[592.613,31.173],[590,34],[587.71,34.245],[586,35],[587.204,37.775],[589,41],[589,46],[602,46]],"c":true}],"h":1},{"t":12,"s":[{"i":[[0.729,0.808],[1.375,-1.125],[2.011,-0.489],[-0.643,-1.829],[-0.402,-2.043],[-2.911,0.045],[-1.438,1.221],[-0.441,1.643],[0.805,2.995],[1.462,0.889],[0.197,0.253]],"o":[[-0.488,2.012],[-1.375,1.125],[1.026,1.642],[0.643,1.829],[2.543,0.186],[2.032,-0.032],[0.697,-0.592],[0.841,-3.133],[-1.657,-1.262],[-0.206,-0.125],[-0.655,-0.841]],"v":[[595,27],[592.142,31.642],[587,34],[589.468,39.199],[591,45],[597,43],[602,44],[602,38],[605,33],[599,32],[598,29]],"c":true}],"h":1},{"t":13,"s":[{"i":[[0.447,2.726],[0.992,-0.029],[1.147,0.709],[0.16,0.676],[0.187,0.187],[0.739,-1.277],[0.359,-1.26],[-0.572,-3.192],[-5.351,-0.086],[-2.38,-0.409],[-0.463,2.054]],"o":[[-0.885,-0.407],[-0.992,0.029],[-0.175,-0.108],[-0.16,-0.676],[-2.587,-2.587],[-1.172,2.024],[-0.439,1.544],[1.113,6.206],[2.382,0.038],[1.425,-1.661],[0.466,-2.065]],"v":[[605,32],[602.196,31.727],[599,31],[598.509,29.559],[598,28],[594,30],[588,33],[591,39],[597,42],[602,43],[602,38]],"c":true}],"h":1},{"t":14,"s":[{"i":[[-2.707,1.26],[0.305,0.54],[-0.09,0.895],[0.546,1.428],[3.34,1.916],[3.432,-0.415],[0.395,-0.495],[1.048,-0.414],[-1.023,-4.018],[-0.558,-0.39],[-2.368,0.205]],"o":[[0.131,-0.944],[-0.305,-0.541],[0.176,-1.759],[-1.269,-3.32],[-3.03,-1.738],[-0.615,0.074],[-0.615,0.771],[-5.611,2.218],[0.193,0.759],[1.464,1.022],[2.564,-0.222]],"v":[[603,41],[602.531,38.963],[602,37],[605,32],[600,31],[596,27],[595,30],[592,31],[592,37],[592,42],[597,40]],"c":true}],"h":1},{"t":15,"s":[{"i":[[-0.003,0],[2.651,-1.646],[0.327,-1.008],[-0.619,-2.688],[-0.437,-0.319],[-2.203,-0.052],[-0.693,0.535],[-0.235,0.826],[-0.155,0.326],[1.199,0.561],[-1.65,-3.48]],"o":[[-1.573,0.258],[-0.875,0.543],[-0.639,1.972],[0.138,0.601],[1.195,0.872],[1.045,0.025],[0.61,-0.471],[0.064,-0.224],[1.967,-4.153],[-0.352,-0.165],[0.026,0.055]],"v":[[597,28],[594,31],[591,32],[593,36],[593,40],[598,39],[602,40],[602,35],[604,34],[600,31],[597,27]],"c":true}],"h":1},{"t":16,"s":[{"i":[[3.215,-0.696],[-0.041,-0.38],[0.424,-0.319],[0.572,0.193],[0.364,-1.761],[-0.478,-0.542],[-0.036,-0.081],[-0.254,-0.307],[-2.06,0.294],[-0.705,3.994],[3.181,1.629]],"o":[[-0.738,0.16],[0.04,0.38],[-1.348,1.012],[-0.572,-0.193],[0.052,-0.249],[0.478,0.542],[0.924,2.066],[0.254,0.307],[4.894,-0.699],[0.686,-3.885],[-2.938,-1.504]],"v":[[597,29],[596.264,29.881],[596,31],[593.262,31.438],[592,33],[593.011,33.752],[594,35],[595.148,38.27],[598,38],[602,34],[600,31]],"c":true}],"h":1},{"t":17,"s":[{"i":[[0.036,-0.017],[0.878,-0.399],[-0.158,0.423],[-0.177,-1.418],[-0.305,-0.297],[-0.833,0.37],[-0.168,0.009],[-1.654,1.654],[-0.172,0.668],[0.955,1.808],[0.796,0.124]],"o":[[0.354,-0.173],[-0.878,0.399],[-0.012,0.032],[0.177,1.418],[0.502,0.489],[0.832,-0.37],[1.039,-0.055],[-0.474,0.474],[0.152,-0.59],[0.136,0.257],[-0.016,-0.002]],"v":[[597,30],[595.647,30.688],[594,31],[594.262,33.801],[595,37],[597.251,36.873],[599,36],[602,36],[601,34],[603,31],[597,29]],"c":true}],"h":1},{"t":18,"s":[{"i":[[0,0],[0.631,-0.255],[0.203,-0.616],[-0.761,-1.345],[0.151,0.055],[-1.206,1.541],[0.104,0.305],[0.706,-0.04],[0.14,0.056],[0.364,0.433],[0.339,0.186]],"o":[[-1.275,0.365],[-0.63,0.255],[0.107,-0.323],[0.761,1.345],[1.281,0.469],[1.206,-1.541],[-0.036,-0.105],[-0.706,0.04],[-0.205,-0.082],[-0.364,-0.433],[0.028,0.015]],"v":[[598,30],[595.196,30.812],[594,32],[595.694,34.299],[597,37],[601.039,34.581],[603,31],[601.578,30.963],[600,31],[599.101,30.078],[598,29]],"c":true}],"h":1},{"t":19,"s":[{"i":[[0.302,-0.082],[0.717,-0.227],[0.038,-0.065],[-0.245,-1.168],[-0.141,-0.123],[-0.599,0.343],[-0.192,-0.012],[-0.443,-0.254],[-0.032,0.029],[-0.289,1.154],[0.156,0.383]],"o":[[-0.093,0.025],[-0.717,0.228],[-0.121,0.205],[0.245,1.168],[0.414,0.362],[0.599,-0.343],[0.196,0.013],[0.443,0.254],[0.002,-0.002],[0.289,-1.154],[-0.422,-1.035]],"v":[[598,30],[596.459,30.47],[595,31],[595.303,33.561],[596,36],[597.667,35.762],[599,35],[600.123,35.532],[601,36],[601.618,33.786],[602,31]],"c":true}],"h":1},{"t":20,"s":[{"i":[[0.723,-0.209],[0.313,-0.141],[0.335,-0.194],[0.23,-0.206],[-0.003,-0.176],[-0.629,-0.56],[-0.887,-0.327],[-0.779,0.348],[-0.311,0.612],[0.029,-0.352],[0.86,0.309]],"o":[[-0.163,0.047],[-0.313,0.141],[-0.335,0.194],[-0.23,0.206],[0.006,0.352],[0.629,0.56],[0.887,0.327],[-0.215,0.096],[0.311,-0.612],[0.163,-1.974],[-0.86,-0.309]],"v":[[598,30],[597.254,30.293],[596.251,30.807],[595.372,31.417],[595,32],[596.044,33.479],[598.41,34.921],[601,35],[601.361,33.808],[602,33],[600.664,29.862]],"c":true}],"h":1},{"t":21,"s":[{"i":[[1.467,-0.771],[0.291,-0.378],[0.14,-0.478],[-0.096,-0.486],[-0.418,-0.402],[-0.407,0.157],[-0.357,0.232],[-0.111,-0.027],[-0.164,-0.344],[-0.35,0.373],[0.684,1.123]],"o":[[-0.356,0.187],[-0.291,0.378],[-0.14,0.478],[0.096,0.486],[0.261,0.251],[0.407,-0.157],[0.357,-0.232],[-0.007,-0.002],[0.164,0.343],[1.204,-1.28],[-0.684,-1.123]],"v":[[598,30],[597.007,30.871],[596.339,32.178],[596.25,33.646],[597,35],[598.052,35.057],[599.248,34.391],[600,34],[600.232,34.778],[601,35],[601.503,30.961]],"c":true}],"h":1},{"t":22,"s":[{"i":[[-0.316,0.189],[0.226,-0.026],[0.218,-0.034],[0.133,-0.116],[-0.03,-0.272],[-0.667,-0.283],[-0.789,0.231],[-0.478,0.524],[0.267,0.594],[0.698,-0.063],[0.475,-0.261]],"o":[[-0.157,0.093],[-0.226,0.026],[-0.218,0.034],[-0.133,0.116],[0.111,1.019],[0.667,0.283],[0.789,-0.231],[0.478,-0.524],[-0.352,-0.782],[-0.698,0.063],[-0.475,0.261]],"v":[[598,31],[597.407,31.161],[596.721,31.232],[596.174,31.437],[596,32],[597.275,33.898],[599.567,33.919],[601.576,32.732],[602,31],[600.283,30.084],[598.381,30.73]],"c":true}],"h":1},{"t":23,"s":[{"i":[[0.554,-0.554],[0.031,-0.241],[-0.08,-0.27],[-0.164,-0.255],[-0.223,-0.197],[-0.254,-0.095],[-0.26,0.05],[-0.239,0.239],[0.05,0.512],[0.314,0.436],[0.481,0.081]],"o":[[-0.169,0.169],[-0.031,0.241],[0.08,0.27],[0.164,0.255],[0.223,0.197],[0.254,0.095],[0.26,-0.05],[0.308,-0.308],[-0.05,-0.512],[-0.314,-0.436],[-0.481,-0.081]],"v":[[598,31],[597.706,31.626],[597.785,32.405],[598.157,33.204],[598.744,33.894],[599.467,34.344],[600.245,34.423],[601,34],[601.362,32.7],[600.793,31.207],[599.576,30.361]],"c":true}],"h":1},{"t":24,"s":[{"i":[[0.022,-0.003],[0.054,-0.366],[-0.507,-0.372],[-0.558,-0.195],[-0.099,0.165],[0.135,0.504],[0.382,0.311],[0.306,0.151],[-0.092,0.025],[-0.007,-0.147],[-0.007,-0.146]],"o":[[-1.125,0.176],[-0.054,0.366],[0.507,0.372],[0.558,0.195],[0.436,-0.732],[-0.135,-0.504],[-0.382,-0.311],[-0.306,-0.151],[-0.022,0.006],[0.007,0.147],[0.007,0.146]],"v":[[599,31],[597.359,31.859],[598.165,33.013],[599.888,33.91],[601,34],[601.371,32.153],[600.515,30.939],[599.402,30.255],[599,30],[598.985,30.265],[599.014,30.74]],"c":true}],"h":1},{"t":25,"s":[{"i":[[1.446,-0.854],[0.182,0.014],[0.204,0.036],[0.171,0.003],[0.08,-0.082],[-0.036,-0.403],[-0.16,-0.439],[-0.169,-0.316],[-0.063,-0.035],[-0.63,0.877],[0.229,0.803]],"o":[[-0.102,0.06],[-0.182,-0.014],[-0.204,-0.036],[-0.171,-0.003],[-0.204,0.209],[0.036,0.403],[0.16,0.439],[0.169,0.316],[1.131,0.63],[0.63,-0.877],[-0.229,-0.803]],"v":[[367,113],[366.561,113.055],[365.967,112.967],[365.391,112.895],[365,113],[364.776,113.958],[365.099,115.261],[365.623,116.434],[366,117],[368.731,116.234],[369.423,113.318]],"c":true}],"h":1},{"t":26.0000010590017,"s":[{"i":[[0.007,-0.002],[0.188,0.014],[0.219,0.024],[0.171,-0.002],[0.045,-0.063],[-0.418,-0.603],[-0.649,-0.305],[-0.079,0.033],[0.163,1.079],[1.023,0.404],[0,-0.249]],"o":[[-0.08,0.031],[-0.188,-0.014],[-0.219,-0.024],[-0.171,0.002],[-0.614,0.863],[0.418,0.603],[0.649,0.305],[0.677,-0.279],[-0.163,-1.079],[0.007,0.003],[0,0.249]],"v":[[367,113],[366.577,113.017],[365.947,112.952],[365.343,112.911],[365,113],[364.906,115.21],[366.708,116.582],[368,117],[368.775,114.593],[367,112],[367.011,112.5]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":1,"s":[0],"h":1},{"t":2,"s":[100],"h":1},{"t":27.0000010997325,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 2"},{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":2,"s":[{"i":[[3.503,-2.045],[1.941,-1.392],[2.632,-0.701],[-1.235,-2.098],[0.933,-4.267],[-2.552,0.095],[-3.871,1.486],[-0.593,2.888],[-0.498,0.739],[1.385,1.869],[2.657,1.855]],"o":[[-0.603,2.73],[-1.941,1.392],[0.992,2.341],[1.235,2.098],[4.176,0.487],[2.221,-0.083],[1.368,-3.751],[0.041,-0.198],[1.221,-1.811],[-3.18,-2.103],[-1.212,-0.846]],"v":[[571,69],[567.022,75.022],[560,78],[563.944,84.056],[565,93],[573,90],[581,92],[580,84],[583,81],[584,77],[576,75]],"c":true}],"h":1},{"t":3,"s":[{"i":[[-1.377,-4.664],[-4.064,-1.339],[-5.014,1.587],[-1.134,1.39],[-0.264,4.935],[0.147,0.118],[0.949,1.98],[3.016,1.754],[1.846,-0.329],[4.134,-3.56],[0.469,-3.823]],"o":[[4.839,2.838],[5.509,1.815],[3.713,-1.175],[2.642,-3.237],[0.169,-3.152],[-1.52,-1.224],[-0.942,-1.964],[-2.068,-1.203],[-6.014,1.073],[-0.15,5.108],[-0.427,3.477]],"v":[[465,117],[475,118],[486,126],[490,116],[500,109],[496,105],[492,101],[490,90],[479,95],[467,95],[469,107]],"c":true}],"h":1},{"t":4,"s":[{"i":[[0.281,2.124],[1.236,0.032],[0.875,0.564],[0.393,1.265],[0.494,0.339],[2.603,-1.523],[1.068,-1.771],[-0.579,-2.919],[-2.639,-2.343],[-5.435,-2.91],[-0.596,2.013]],"o":[[-1.178,-1.307],[-1.237,-0.032],[-0.935,-0.602],[-0.393,-1.265],[-3.298,-2.26],[-1.295,0.758],[-0.349,3.941],[0.441,2.22],[5.682,-2.737],[3.021,-2.681],[0.541,-1.826]],"v":[[525,78],[521.273,76.443],[518,76],[516.169,72.802],[515,70],[507,76],[502,77],[506,85],[506,92],[520,92],[520,84]],"c":true}],"h":1},{"t":5,"s":[{"i":[[-1.019,4.981],[1.528,1.853],[2.731,-0.278],[0.311,-0.769],[-0.031,0.054],[1.318,-0.325],[1.698,-0.919],[-0.957,-1.085],[-0.311,-1.628],[-2.373,-2.12],[-5.166,-1.733]],"o":[[-4.158,0.135],[-1.528,-1.853],[0.212,-0.022],[-0.311,0.769],[-1.03,1.779],[-1.318,0.325],[-0.139,2.034],[0.957,1.085],[0.375,1.964],[5.012,-2.454],[-1.673,-7.673]],"v":[[517,74],[509.43,70.393],[504,67],[503.635,68.525],[503,70],[499.501,72.645],[495,74],[496.662,78.304],[499,82],[499,88],[513,88]],"c":true}],"h":1},{"t":6,"s":[{"i":[[1.597,0.128],[2.207,-0.96],[1.211,-1.956],[-0.752,-1.915],[0.462,-3.128],[-2.086,0.051],[-2.762,-1.045],[-1.172,1.828],[-0.291,2.709],[1.905,1.23],[0.505,0.723]],"o":[[0.037,3.204],[-2.207,0.96],[1.455,1.212],[0.752,1.915],[2.894,-0.84],[2.086,-0.051],[-0.978,-3.978],[1.172,-1.828],[-2.425,-1.093],[-0.672,-0.434],[-1.21,-1.733]],"v":[[499,64],[494.936,69.436],[489,73],[492.437,77.563],[493,85],[500.099,83.587],[507,85],[508.048,77.048],[511,71],[504,70],[503,66]],"c":true}],"h":1},{"t":7,"s":[{"i":[[3.646,2.354],[1.597,-1.236],[2.874,0.041],[-0.966,-1.174],[-0.28,-1.428],[0.3,-0.929],[-0.964,-1.088],[-2.219,0],[-2.061,-1.16],[-0.533,2.129],[0.876,3.964]],"o":[[-0.736,2.097],[-1.597,1.236],[-0.145,1.875],[0.966,1.174],[0.235,1.195],[-0.3,0.929],[2.061,-1.16],[2.219,0],[2.707,-2.411],[0.632,-2.525],[-6.576,0.576]],"v":[[495,62],[491.603,67.103],[485,69],[486.681,73.335],[489,77],[488.453,80.081],[489,83],[495.5,81.26],[502,83],[502,76],[506,69]],"c":true}],"h":1},{"t":8,"s":[{"i":[[4.345,1.655],[1.6,-1.067],[2.185,-0.482],[-0.74,-1.503],[0.833,-3.423],[-1.331,0.506],[-1.567,-0.186],[-0.666,-0.516],[-1.174,0.202],[-0.655,2.117],[1.175,2.908]],"o":[[-0.414,2.252],[-1.6,1.066],[0.873,2.564],[0.74,1.503],[1.107,0.838],[1.331,-0.506],[1.161,0.138],[0.666,0.516],[1.999,-2.209],[0.716,-2.314],[-5.904,-0.096]],"v":[[491,61],[487.827,65.828],[482,68],[484.779,73.356],[485,80],[488.655,79.989],[493,79],[495.49,80.255],[498,81],[499,74],[502,68]],"c":true}],"h":1},{"t":9,"s":[{"i":[[2.378,0.622],[1.06,-0.829],[1.344,-0.545],[0.819,-1.07],[-0.513,-2.102],[-0.021,-1.596],[-1.745,-0.142],[-3.134,-0.532],[-0.709,1.791],[-0.757,1.743],[1.397,1.603]],"o":[[0.033,1.922],[-1.06,0.829],[-1.344,0.545],[1.926,0.994],[0.513,2.102],[2.885,-1.1],[1.745,0.142],[-0.594,-3.094],[0.709,-1.791],[-3.034,0.034],[-1.397,-1.603]],"v":[[488,60],[486.257,63.924],[482.447,65.781],[479,68],[482.429,73.048],[483,79],[489.314,77.776],[496,79],[496.486,71.986],[499,67],[493.008,63.992]],"c":true}],"h":1},{"t":10,"s":[{"i":[[3.588,-1.238],[1.631,-1.036],[1.974,-0.693],[-0.912,-0.726],[-0.339,-1.311],[0.371,-1.069],[-1.29,-0.981],[-1.907,-0.064],[-2.259,-0.902],[-1.562,3.771],[2.148,1.631]],"o":[[-0.504,2.163],[-1.631,1.036],[0.014,1.785],[0.912,0.726],[0.193,0.745],[-0.371,1.069],[2.113,-1.159],[1.907,0.064],[-1.358,-6.691],[-2.451,-1.902],[-1.377,-1.045]],"v":[[486,59],[482.602,63.602],[477,66],[478.756,69.355],[481,72],[480.177,74.823],[481,78],[486.89,76.455],[493,78],[497,66],[490,64]],"c":true}],"h":1},{"t":11,"s":[{"i":[[-4.518,-1.804],[-1.328,1.799],[0.683,2.064],[0.897,-0.319],[0.823,0.489],[0.133,0.743],[0.52,0.463],[0.975,-1.236],[1.274,-0.684],[-0.639,-3.47],[-0.042,-3.193]],"o":[[-1.629,-2.74],[1.328,-1.799],[-0.591,-1.785],[-0.897,0.319],[-0.949,-0.564],[-0.133,-0.743],[-1.826,-1.628],[-0.975,1.236],[-3.313,1.779],[3.852,1.988],[4.225,-2.317]],"v":[[491,77],[491.791,70.493],[494,65],[491.674,63.528],[489,64],[487.678,61.924],[487,60],[483.087,60.266],[480,64],[475,66],[479,77]],"c":true}],"h":1},{"t":12,"s":[{"i":[[3.303,2.031],[1.387,-1.113],[2.595,0.094],[-0.637,-0.889],[-0.347,-1.251],[0.023,-1.067],[-0.832,-0.802],[-1.717,0],[-2.065,-1.037],[-0.486,1.801],[0.075,3.424]],"o":[[-0.858,1.642],[-1.387,1.113],[0.106,1.192],[0.637,0.889],[0.259,0.93],[-0.023,1.067],[2.065,-1.037],[1.717,0],[2.474,-1.822],[0.689,-2.552],[-5.954,0.621]],"v":[[483,58],[479.802,62.302],[474,64],[475.319,66.956],[477,70],[477.07,73.096],[478,76],[483.5,74.445],[489,76],[489,70],[493,64]],"c":true}],"h":1},{"t":13,"s":[{"i":[[2.696,2.304],[1.35,-0.984],[1.973,-0.361],[-0.671,-0.889],[-0.208,-1.059],[0.293,-0.837],[-0.995,-0.743],[-1.661,-0.056],[-2.257,-0.845],[-0.774,1.56],[-0.559,1.775]],"o":[[-0.628,1.705],[-1.35,0.984],[0.108,1.385],[0.671,0.889],[0.178,0.909],[-0.293,0.837],[2.097,-1.069],[1.661,0.056],[-0.653,-2.986],[0.774,-1.56],[-5.007,0.007]],"v":[[482,58],[479.009,62.008],[474,64],[475.425,67.244],[477,70],[476.387,72.625],[477,75],[482.38,73.564],[488,75],[488.591,68.591],[491,64]],"c":true}],"h":1},{"t":14,"s":[{"i":[[-0.198,1.478],[0.315,0.542],[-0.111,0.891],[-0.824,0.686],[0.426,1.207],[1.124,0.708],[0.774,0.671],[1.304,-0.787],[0.882,-3.682],[-0.036,-0.039],[-6.363,3.014]],"o":[[0.149,-0.941],[-0.315,-0.542],[0.131,-1.05],[0.824,-0.686],[-0.436,-1.236],[-1.046,-0.659],[-2.51,-2.176],[-4.06,2.45],[0.049,-0.205],[3.157,3.391],[2.157,-1.022]],"v":[[487,73],[486.528,70.962],[486,69],[487.918,66.618],[489,64],[485,63],[483,59],[477,63],[473,65],[475,66],[480,73]],"c":true}],"h":1},{"t":15,"s":[{"i":[[1.18,-0.192],[0.376,-0.666],[0.962,-0.248],[-1.033,-4.409],[-0.461,-0.367],[-2.029,-0.084],[-1.283,1.052],[-0.246,0.862],[-0.155,0.326],[1.148,0.614],[-0.164,-0.247]],"o":[[-0.535,0.087],[-0.376,0.666],[-5.712,1.476],[0.15,0.64],[0.989,0.786],[0.733,0.03],[0.63,-0.516],[0.064,-0.224],[1.988,-4.197],[0.302,0.161],[-1.186,-1.788]],"v":[[480,60],[478.821,61.379],[477,63],[476,68],[476,72],[481,71],[485,72],[485,67],[487,66],[483,63],[482,61]],"c":true}],"h":1},{"t":16,"s":[{"i":[[1.602,-0.433],[1.174,-0.672],[0.097,-0.255],[-0.258,-0.752],[-0.168,-0.471],[-0.578,0.097],[-1.908,-0.203],[-0.459,-0.095],[0,1.505],[0.356,1.147],[-0.063,-0.036]],"o":[[-0.208,0.056],[-1.174,0.672],[-0.199,0.523],[0.258,0.752],[0.781,2.183],[0.578,-0.096],[1.163,0.124],[0.459,0.095],[0,-3.136],[0.072,0.233],[-2.777,-1.608]],"v":[[480,61],[477.417,62.351],[475,64],[475.224,66.039],[476,68],[477.655,70.485],[481,70],[483.373,70.721],[484,69],[486,64],[483,63]],"c":true}],"h":1},{"t":17,"s":[{"i":[[0.004,-0.001],[0.295,-0.808],[-0.155,-1.294],[-0.553,0.154],[-1.486,-0.106],[-0.581,-0.329],[-0.378,0.336],[-0.315,1.383],[0.187,0.535],[1.188,0.717],[0.225,0.07]],"o":[[-1.976,0.472],[-0.295,0.808],[0.301,2.508],[0.553,-0.153],[0.3,0.022],[0.581,0.329],[-0.075,0.067],[0.315,-1.383],[-0.022,-0.064],[-1.188,-0.717],[0.017,0.005]],"v":[[479,62],[475.901,63.883],[476,67],[477.111,69.802],[480,69],[481.442,69.768],[483,70],[483.584,67.452],[484,64],[481.652,62.505],[479,61]],"c":true}],"h":1},{"t":18,"s":[{"i":[[1,-0.15],[0.724,-1.413],[-1.25,-1.145],[-0.818,0.378],[-0.189,-0.019],[-0.371,-0.359],[-0.478,0.439],[-0.315,1.129],[0.174,0.563],[0.684,0.388],[0.2,0.248]],"o":[[-1.354,0.203],[-0.724,1.413],[0.541,0.495],[0.818,-0.378],[0.038,0.004],[0.371,0.359],[-0.087,0.08],[0.315,-1.129],[-0.062,-0.201],[-0.685,-0.388],[-0.911,-1.129]],"v":[[479,62],[475.547,64.793],[476,69],[478.264,68.857],[480,68],[480.67,68.832],[482,69],[482.566,66.982],[483,64],[481.603,63.035],[480,62]],"c":true}],"h":1},{"t":19,"s":[{"i":[[1.624,-0.619],[0.126,-1.386],[-1.111,-0.846],[-0.504,0.201],[-0.278,-0.028],[0.064,0.142],[-0.637,1.593],[-0.512,0.296],[0.153,0.556],[0.757,0.278],[0.001,0.001]],"o":[[-1.605,0.611],[-0.126,1.386],[-0.292,-0.222],[0.504,-0.201],[1.618,0.162],[-0.064,-0.142],[0.103,-0.259],[0.512,-0.296],[0.03,0.111],[-0.757,-0.278],[-1.568,-1.199]],"v":[[478,62],[475.463,65.324],[477,69],[477.572,68.312],[479,68],[480.736,68.316],[481,66],[482.192,65.223],[483,64],[481.524,63.584],[480,63]],"c":true}],"h":1},{"t":20,"s":[{"i":[[0.764,-0.277],[0.282,-0.883],[-0.553,-0.778],[-0.934,-0.256],[-0.86,0.682],[-0.132,0.66],[-0.153,0.596],[-0.048,-0.203],[0.484,0.233],[0.058,0.053],[0.125,0.151]],"o":[[-1.573,0.571],[-0.282,0.883],[0.553,0.778],[0.934,0.256],[-0.015,0.012],[0.132,-0.66],[0.153,-0.596],[-0.004,-0.017],[-0.484,-0.233],[-0.738,-0.672],[-0.124,-0.151]],"v":[[478,62],[475.331,64.284],[475.851,66.879],[478.195,68.534],[481,68],[481.207,66.843],[481.667,64.774],[482,64],[481.041,63.527],[480,63],[479.019,61.789]],"c":true}],"h":1},{"t":21,"s":[{"i":[[1.03,-0.201],[0.338,-0.084],[0.271,-0.138],[0.173,-0.235],[0.042,-0.376],[-0.738,-0.447],[-0.776,-0.129],[-0.009,0.009],[-0.286,0.614],[0.032,-0.35],[0.516,0.543]],"o":[[-0.373,0.073],[-0.338,0.084],[-0.271,0.138],[-0.173,0.235],[-0.106,0.945],[0.738,0.447],[0.776,0.129],[-0.111,0.105],[0.286,-0.614],[0.095,-1.031],[-0.516,-0.542]],"v":[[478,63],[476.926,63.224],[476.004,63.546],[475.33,64.095],[475,65],[476.149,67.044],[478.621,67.864],[480,68],[480.441,66.817],[481,66],[480.344,63.575]],"c":true}],"h":1},{"t":22,"s":[{"i":[[0.02,-0.005],[0.312,-0.141],[0.333,-0.196],[0.229,-0.207],[0.002,-0.175],[-0.957,-0.214],[-0.893,0.565],[0.204,1.086],[0.835,0.577],[-0.28,0.002],[-0.009,-0.249]],"o":[[-0.167,0.043],[-0.312,0.141],[-0.333,0.196],[-0.229,0.207],[-0.012,1.25],[0.957,0.214],[0.893,-0.565],[0.058,0.311],[-0.835,-0.577],[-0.017,0],[0.009,0.249]],"v":[[478,63],[477.251,63.286],[476.252,63.802],[475.378,64.417],[475,65],[476.676,67.131],[479.709,66.54],[481,64],[479.334,63.234],[478,62],[478.003,62.496]],"c":true}],"h":1},{"t":23,"s":[{"i":[[0.552,-0.552],[0.144,-0.354],[-0.068,-0.282],[-0.218,-0.202],[-0.305,-0.114],[-0.332,-0.018],[-0.296,0.086],[-0.198,0.198],[0.044,0.519],[0.323,0.427],[0.493,0.07]],"o":[[-0.418,0.418],[-0.144,0.354],[0.068,0.282],[0.218,0.202],[0.305,0.114],[0.332,0.018],[0.296,-0.086],[0.345,-0.345],[-0.044,-0.519],[-0.323,-0.427],[-0.493,-0.07]],"v":[[477,64],[476.173,65.16],[476.074,66.116],[476.517,66.844],[477.317,67.321],[478.288,67.522],[479.244,67.423],[480,67],[480.424,65.638],[479.846,64.154],[478.595,63.343]],"c":true}],"h":1},{"t":24.00000097754,"s":[{"i":[[0.355,-0.908],[-0.032,-0.128],[-0.069,-0.21],[-0.11,-0.244],[-0.156,-0.229],[-0.208,-0.165],[-0.264,-0.053],[-0.326,0.109],[0.037,0.609],[0.464,0.543],[0.57,0.037]],"o":[[0.001,-0.004],[0.032,0.128],[0.069,0.21],[0.11,0.244],[0.156,0.229],[0.208,0.165],[0.264,0.053],[0.712,-0.237],[-0.037,-0.609],[-0.464,-0.543],[-0.57,-0.037]],"v":[[495,98],[495.049,98.198],[495.2,98.717],[495.466,99.41],[495.864,100.131],[496.408,100.734],[497.115,101.072],[498,101],[498.933,99.62],[498.101,97.782],[496.469,96.803]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":1,"s":[0],"h":1},{"t":2,"s":[100],"h":1},{"t":25.0000010182709,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 3"},{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":4,"s":[{"i":[[3.977,2.096],[3.104,-0.611],[2.155,-2.73],[0.954,-2.552],[-0.028,0.017],[1.213,-0.128],[1.441,-1.271],[1.135,-4.705],[-4.825,-1.175],[-1.439,2.029],[1.013,0.058],[-2.725,1.504],[-1.681,2.667],[0.106,3.011],[2.04,1.612]],"o":[[-2.617,1.866],[-2.085,0.41],[0.129,3.29],[0.061,-0.163],[-0.794,0.47],[-1.748,0.185],[2.048,5.283],[7.868,-1.868],[1.42,-1.012],[0.654,-0.922],[1.774,0.102],[2.265,-2.508],[1.878,-2.98],[-0.069,-1.943],[-3.852,-3.045]],"v":[[525,89],[518,94],[511,94],[513,101],[510,102],[507,104],[501,103],[500,117],[513,122],[515,116],[522,111],[526,114],[528,107],[535,101],[531,99]],"c":true}],"h":1},{"t":5,"s":[{"i":[[-0.185,3.533],[1.001,0.799],[0.799,1.174],[0.348,1.28],[1.942,-0.1],[1.622,-0.465],[3.51,-0.401],[-0.335,-3.332],[8.192,2.596],[1.546,-6.259],[-5.472,-0.195],[-3.66,2.006],[-3.299,1.494],[-4.109,-0.224],[-1.319,2.003]],"o":[[-1.197,-1.63],[-1.001,-0.799],[-0.667,-0.981],[-0.348,-1.28],[-0.86,0.045],[-1.968,0.564],[-0.897,4.564],[-5.825,-1.49],[2.478,6.504],[7.621,-1.955],[0.737,-4.929],[1.345,-2.822],[4.746,-0.413],[2.015,-2.21],[1.637,-2.487]],"v":[[529,101],[525.701,97.658],[523,95],[521.956,91.189],[519,89],[515,93],[507,93],[509,102],[494,104],[493,118],[506,122],[514,113],[512,109],[521,113],[523,106]],"c":true}],"h":1},{"t":6,"s":[{"i":[[-2.618,2.041],[-0.984,0.182],[-1.179,-0.285],[-1.019,-1.089],[-1.668,0.659],[-1.245,1.755],[-2.37,0.63],[0.569,6.431],[7.364,1.364],[4.469,-3.706],[-0.145,0.005],[3.62,1.905],[1.243,-4.981],[-3.787,-1.506],[-4.477,1.19]],"o":[[0.884,0.442],[0.984,-0.182],[1.257,0.304],[1.019,1.089],[0.649,-2.351],[1.245,-1.755],[-2.262,-4.738],[-4.185,1.815],[1.071,7.643],[0.169,-0.14],[-1.097,0.036],[1.506,5.679],[6.604,0.458],[1.057,-4.609],[1.172,-3.905]],"v":[[504,108],[506.778,108.118],[510,108],[513.192,110.723],[517,112],[519.709,105.709],[525,102],[517,89],[503,93],[502,105],[502,102],[489,105],[488,118],[500,123],[508,114]],"c":true}],"h":1},{"t":7,"s":[{"i":[[0.621,1.793],[0.556,0.355],[0.627,0.293],[0.554,0.714],[0.322,1.481],[1.932,0.071],[2.019,-0.647],[2.967,0.3],[0,-2.094],[0.857,-3.312],[-2.005,-0.995],[-2.262,-0.739],[-0.087,1.327],[-0.887,1.173],[-1.275,0.38]],"o":[[-0.341,-0.897],[-0.556,-0.355],[-0.627,-0.293],[-0.779,-1.005],[-0.322,-1.481],[-0.956,1.711],[-2.019,0.647],[0.857,3.312],[0,2.094],[3.719,-0.719],[2.005,0.995],[0.763,-1.519],[0.088,-1.327],[0.52,-0.688],[1.275,-0.38]],"v":[[521,100],[519.618,98.243],[517.807,97.391],[516,96],[514.864,91.8],[512,89],[507.509,92.509],[500,93],[501.286,100.5],[500,108],[508.093,108.907],[514,112],[514.907,107.74],[516,104],[519.356,102.829]],"c":true}],"h":1},{"t":8,"s":[{"i":[[2.786,0.902],[1.915,-0.752],[3.128,0.462],[0,-1.848],[0.78,-3.303],[-1.003,0.228],[-1.028,-0.257],[-1.028,-1.005],[-1.578,0.35],[-0.047,1.15],[-0.842,1.15],[-1.204,0.416],[0.351,1.606],[0.882,0.675],[0.757,1.204]],"o":[[-1.212,1.455],[-1.915,0.752],[0.78,3.303],[0,1.848],[0.959,0.656],[1.003,-0.228],[1.312,0.328],[1.027,1.005],[0.971,-1.249],[0.047,-1.15],[0.534,-0.729],[1.204,-0.416],[-0.716,-1.094],[-0.882,-0.675],[-1.164,-1.852]],"v":[[510,89],[505.437,92.437],[498,93],[499.17,100],[498,107],[500.949,107.299],[504,107],[507.301,109.508],[511,111],[512.096,107.425],[513,104],[516.164,102.658],[518,100],[515.531,97.583],[513,95]],"c":true}],"h":1},{"t":9,"s":[{"i":[[0.491,2.175],[0.901,-0.432],[0.898,-0.436],[1.173,-0.161],[1.726,0.393],[-0.195,-1.106],[0,-0.924],[0.195,-1.106],[0.39,-1.652],[-1.468,-0.421],[-1.119,-0.77],[-1.373,-0.516],[-1.631,1.536],[-0.728,2.439],[1.1,1.567]],"o":[[-1.183,0.15],[-0.901,0.432],[-0.898,0.436],[-1.173,0.161],[0.39,1.652],[0.195,1.106],[0,0.924],[-0.195,1.106],[2.421,-0.532],[1.468,0.421],[1.119,0.77],[-0.251,-3.418],[1.631,-1.536],[-2.108,-0.559],[-1.1,-1.567]],"v":[[509,90],[505.944,90.944],[503.315,92.315],[500.279,93.279],[496,93],[496.877,97.046],[497.17,100],[496.877,102.954],[496,107],[501.683,106.984],[505.413,108.921],[509,111],[511.765,104.265],[516,99],[511.288,95.712]],"c":true}],"h":1},{"t":10,"s":[{"i":[[-0.373,2.873],[1.164,-0.614],[1.338,-0.44],[2.286,0.508],[-0.506,-1.331],[0.187,-1.567],[0.516,-0.666],[-0.202,-1.174],[-1.195,0.075],[-1.054,-0.312],[-1.004,-0.852],[-1.735,0.779],[-1.606,1.227],[-0.301,2.532],[1.22,1.28]],"o":[[-1.763,0.014],[-1.164,0.614],[-1.338,0.44],[-0.838,1.108],[0.506,1.331],[-0.138,1.161],[-0.516,0.666],[1.166,0.987],[1.195,-0.075],[1.249,0.37],[1.004,0.852],[-0.725,-3.559],[1.606,-1.227],[-1.494,-1.007],[-1.22,-1.28]],"v":[[508,90],[503.803,91.136],[500.243,92.909],[495,93],[495.011,96.655],[496,101],[494.745,103.49],[494,106],[497.584,107.007],[501,107],[504.136,109.361],[508,110],[510.231,103.73],[514,99],[509.6,95.9]],"c":true}],"h":1},{"t":11,"s":[{"i":[[0.048,2.952],[0.901,-0.432],[0.898,-0.436],[1.173,-0.161],[1.726,0.393],[-0.209,-1.32],[0.209,-1.32],[0.627,-1.817],[-1.002,0.366],[-0.953,-0.24],[-0.94,-1.019],[-2.018,0.382],[-1.1,1.566],[-2.33,0.337],[1.531,1.469]],"o":[[-1.183,0.15],[-0.901,0.432],[-0.898,0.436],[-1.173,0.161],[0.627,1.817],[0.209,1.32],[-0.209,1.32],[1.038,1.225],[1.002,-0.366],[1.22,0.307],[0.94,1.019],[0.269,-2.398],[1.1,-1.567],[-0.827,-2.172],[-1.531,-1.469]],"v":[[506,90],[502.944,90.944],[500.315,92.315],[497.279,93.279],[493,93],[494.254,97.581],[494.254,101.419],[493,106],[496.064,106.739],[499,106],[501.901,108.517],[506,110],[507.955,103.954],[513,101],[508.915,96.085]],"c":true}],"h":1},{"t":12,"s":[{"i":[[-0.476,3.309],[0.83,-0.42],[0.786,-0.463],[1.063,-0.187],[1.659,0.41],[-0.152,-0.728],[-0.337,-0.829],[0.011,-0.927],[0.465,-1.019],[-0.876,-0.736],[-1.573,-0.927],[-2.389,-0.111],[-1.104,1.23],[-1.731,0.602],[1.508,1.325]],"o":[[-1.195,0.055],[-0.83,0.42],[-0.786,0.464],[-1.063,0.187],[-0.568,0.623],[0.152,0.728],[0.337,0.829],[-0.014,1.189],[-0.465,1.019],[3.319,-0.819],[1.573,0.927],[-0.147,-2.48],[1.104,-1.23],[-0.444,-2.389],[-1.508,-1.325]],"v":[[505,90],[502.043,90.793],[499.697,92.197],[497.004,93.254],[493,93],[492.51,95.027],[493.377,97.365],[494,100],[492.832,103.339],[493,106],[499.697,106.802],[505,109],[506.592,103.592],[511,101],[507.31,96.19]],"c":true}],"h":1},{"t":13,"s":[{"i":[[-2.715,-3.698],[0.136,0.776],[-0.545,0.978],[-1.079,0.462],[0.086,1.775],[0.942,0.77],[0.206,0.392],[0.272,1.011],[-0.084,-0.037],[0.804,-0.817],[1.428,-0.334],[0.803,0.466],[0.986,-1.443],[0,-1.717],[1.037,-2.066]],"o":[[0.999,-0.919],[-0.136,-0.776],[0.768,-1.378],[1.079,-0.462],[-0.025,-0.529],[-0.942,-0.77],[0.004,0.008],[-0.272,-1.011],[-1.355,-0.6],[-0.804,0.816],[-1.804,0.422],[-0.803,-0.466],[1.037,2.066],[0,1.717],[3.773,0.458]],"v":[[503,109],[503.84,106.544],[504,104],[507.141,101.798],[509,99],[507.135,96.898],[505,95],[504.44,92.978],[504,91],[501.055,91.8],[498,94],[494.387,93.234],[492,94],[493.556,99.5],[492,105]],"c":true}],"h":1},{"t":14,"s":[{"i":[[-1.686,-2.981],[0.283,0.653],[-0.815,1.377],[-1.106,0.422],[0.034,1.279],[1.158,0.715],[0.352,0.594],[0.012,0.63],[1.223,0.249],[0.837,-0.73],[0.017,-0.005],[0.866,0.233],[0.931,-0.466],[-0.109,-1.568],[1.221,-1.82]],"o":[[1.316,-1.013],[-0.283,-0.653],[0.611,-1.032],[1.106,-0.422],[-0.014,-0.545],[-1.158,-0.715],[-0.73,-1.231],[-0.012,-0.63],[0.365,0.075],[-0.837,0.73],[-1.603,0.466],[-0.866,-0.233],[0.784,1.907],[0.109,1.568],[3.362,1.305]],"v":[[502,108],[502.876,105.773],[503,103],[505.984,101.185],[508,99],[505.753,97.037],[503,95],[502.37,92.263],[501,91],[499.787,92.552],[498,94],[494.496,94],[492,94],[493.503,99.066],[492,104]],"c":true}],"h":1},{"t":15,"s":[{"i":[[0.136,-0.011],[1.519,-0.277],[-0.085,0.111],[0.049,-2.438],[0.19,0.254],[-1.093,0.103],[-0.403,-0.112],[-0.581,-0.518],[-0.451,0.136],[-0.008,0.822],[-0.354,0.526],[-0.442,0.195],[-0.143,0.088],[0.857,2.388],[0.351,0.259]],"o":[[-0.009,0.001],[-1.519,0.278],[0.385,-0.498],[-0.049,2.438],[0.223,0.298],[1.094,-0.103],[0.225,0.063],[0.581,0.518],[0.615,-0.185],[0.008,-0.822],[0.087,-0.13],[0.442,-0.196],[4.393,-2.704],[-0.161,-0.45],[-1.1,-0.811]],"v":[[499,94],[495.93,94.583],[493,95],[493.431,99.317],[493,104],[495.365,104.139],[498,104],[499.331,105.149],[501,106],[501.696,104.256],[502,102],[502.958,101.469],[504,101],[502,96],[502,93]],"c":true}],"h":1},{"t":16,"s":[{"i":[[1.282,-0.06],[1.063,-0.151],[-0.333,0.656],[-0.023,-1.748],[-0.24,-0.36],[-0.883,0.091],[-0.307,-0.121],[-0.291,-0.509],[-0.567,0.141],[-0.014,0.837],[-0.34,0.502],[-0.46,0.204],[-0.105,0.105],[0.76,0.367],[0.222,1.27]],"o":[[-1.082,0.05],[-1.063,0.151],[-0.329,0.648],[0.022,1.748],[0.163,0.245],[0.883,-0.091],[0.269,0.106],[0.291,0.509],[0.603,-0.15],[0.014,-0.837],[0.055,-0.081],[0.46,-0.204],[1.263,-1.263],[-0.76,-0.367],[-0.491,-2.81]],"v":[[499,95],[495.439,95.53],[494,95],[493.573,99.216],[494,103],[495.892,103.092],[498,103],[498.776,104.185],[500,105],[500.698,103.264],[501,101],[501.963,100.518],[503,100],[503.114,98.006],[501,96]],"c":true}],"h":1},{"t":17,"s":[{"i":[[1.002,-0.141],[0.636,-0.198],[0.541,-0.177],[0.26,-0.016],[-0.208,0.287],[-0.414,-1.023],[-0.761,-0.601],[-0.091,-0.042],[-0.148,0.398],[-0.606,1.245],[-0.743,0.247],[0.007,-0.064],[0.429,0.099],[0.414,0.473],[-0.031,0.465]],"o":[[-0.545,0.077],[-0.636,0.198],[-0.541,0.177],[-0.26,0.016],[-0.949,1.309],[0.414,1.023],[0.761,0.601],[1.803,0.836],[0.148,-0.398],[0.037,-0.076],[0.742,-0.247],[0.128,-1.13],[-0.428,-0.099],[-1.12,-1.28],[0.031,-0.465]],"v":[[499,95],[497.183,95.447],[495.371,96.045],[494.124,96.371],[494,96],[493.452,99.532],[495.469,102.002],[497,103],[499.398,103.56],[500,101],[501.533,100.395],[503,100],[502.406,98.507],[501,98],[499.912,95.434]],"c":true}],"h":1},{"t":18,"s":[{"i":[[0.846,-0.038],[0.532,-0.101],[0.03,-0.207],[-0.142,-0.377],[0.015,-0.613],[0.157,-0.365],[-0.304,-0.146],[-1.361,-0.238],[0.131,0.328],[-1.238,1.089],[-0.478,-0.035],[-0.012,0.073],[0.487,0.34],[0.229,0.59],[0.16,-0.071]],"o":[[-1.365,0.061],[-0.533,0.101],[-0.03,0.207],[0.142,0.377],[-0.022,0.895],[-0.157,0.365],[0.304,0.146],[2.287,0.4],[-0.131,-0.328],[0.077,-0.067],[0.478,0.035],[0.177,-1.052],[-0.487,-0.34],[-0.514,-1.322],[-0.16,0.071]],"v":[[498,96],[495.236,96.227],[494.475,96.672],[494.726,97.532],[495,99],[494.582,100.813],[494.652,101.502],[497,102],[499.287,102.116],[500,100],[501.049,100.004],[502,100],[501.305,98.154],[500,97],[499.249,95.48]],"c":true}],"h":1},{"t":19,"s":[{"i":[[-0.012,0.001],[0.381,0.025],[0.452,0.026],[0.346,-0.012],[0.06,-0.09],[0.007,-0.88],[-0.101,-0.738],[-0.022,-0.026],[-0.661,0.052],[-0.224,-0.048],[-0.22,0.104],[-0.828,0.865],[0.582,1.125],[0.686,0.44],[0.008,-0.247]],"o":[[-0.13,0.014],[-0.381,-0.025],[-0.452,-0.026],[-0.346,0.012],[-0.303,0.453],[-0.007,0.88],[0.101,0.738],[0.132,0.16],[0.661,-0.052],[1.291,0.281],[0.22,-0.104],[1.014,-1.059],[-0.582,-1.126],[0.022,0.014],[-0.008,0.247]],"v":[[498,96],[497.19,95.974],[495.895,95.887],[494.654,95.857],[494,96],[493.581,98.142],[493.769,100.711],[494,102],[495.432,102.084],[497,102],[498.846,102.359],[500,101],[500.275,97.536],[498,95],[498.007,95.512]],"c":true}],"h":1},{"t":20,"s":[{"i":[[-0.062,-0.007],[0.035,-0.625],[0.077,-0.834],[-0.128,0.002],[-1.615,-0.646],[-0.34,-0.54],[-0.462,0.23],[0.1,0.682],[-0.188,0.165],[-0.478,-0.035],[-0.012,0.073],[0.468,0.371],[0.298,0.522],[0.036,0.334],[0.583,0.185]],"o":[[-2.781,-0.335],[-0.035,0.625],[-0.126,1.362],[0.128,-0.002],[0.177,0.071],[0.34,0.54],[0.212,-0.106],[-0.1,-0.683],[0.077,-0.068],[0.478,0.035],[0.171,-0.993],[-0.468,-0.371],[-0.273,-0.477],[-0.036,-0.334],[0.066,0.021]],"v":[[498,96],[494.472,96.624],[495,99],[494.695,100.537],[497,101],[497.786,102.225],[499,103],[499.019,101.544],[499,100],[500.049,100.004],[501,100],[500.352,98.147],[499,97],[498.733,95.781],[498,95]],"c":true}],"h":1},{"t":21,"s":[{"i":[[-0.04,0.003],[0.304,-0.019],[0.242,-0.055],[0.191,-0.133],[0.154,-0.254],[-0.102,-0.283],[0.001,-0.514],[0.103,-0.349],[0.202,0.211],[-0.836,0.064],[-0.678,0.553],[-0.128,0.838],[0.815,0.918],[0.31,-0.149],[0.233,-0.219]],"o":[[-0.38,0.026],[-0.304,0.019],[-0.242,0.055],[-0.191,0.133],[0.208,-0.344],[0.102,0.283],[-0.001,0.514],[-0.103,0.349],[0.602,0.63],[0.836,-0.064],[0.678,-0.553],[0.128,-0.838],[-0.19,-0.214],[-0.31,0.149],[-0.233,0.219]],"v":[[497,97],[495.977,97.057],[495.161,97.158],[494.514,97.43],[494,98],[494.464,98.008],[494.615,99.301],[494.458,100.694],[494,101],[496.256,101.798],[498.626,100.822],[499.933,98.685],[499,96],[498.202,95.976],[497.339,96.602]],"c":true}],"h":1},{"t":22,"s":[{"i":[[0.494,-0.057],[0.304,-0.018],[0.241,-0.047],[0.192,-0.13],[0.155,-0.268],[-0.102,-0.284],[-0.001,-0.515],[0.101,-0.349],[0.205,0.215],[-0.966,0.123],[-0.75,0.59],[0.232,0.965],[0.513,0.298],[-0.007,-0.009],[0.012,-0.129]],"o":[[-0.38,0.044],[-0.304,0.018],[-0.241,0.047],[-0.192,0.13],[0.201,-0.346],[0.102,0.284],[0.001,0.515],[-0.101,0.349],[0.415,0.436],[0.966,-0.123],[0.75,-0.59],[0.044,0.184],[-0.513,-0.298],[-0.457,-0.575],[-0.012,0.129]],"v":[[497,97],[495.978,97.079],[495.164,97.164],[494.517,97.417],[494,98],[494.454,98.007],[494.608,99.304],[494.459,100.7],[494,101],[496.264,101.447],[499.031,100.355],[500,98],[499.028,97.632],[498,97],[497.527,96.526]],"c":true}],"h":1},{"t":23,"s":[{"i":[[0.006,-0.002],[0.188,0.014],[0.217,0.026],[0.171,-0.001],[0.049,-0.067],[-0.123,-0.532],[-0.452,-0.348],[-0.478,-0.142],[-0.202,0.086],[-0.118,0.446],[0.114,0.539],[0.3,0.449],[0.44,0.173],[-0.002,-0.147],[0.001,-0.148]],"o":[[-0.083,0.036],[-0.188,-0.014],[-0.217,-0.026],[-0.171,0.001],[-0.51,0.694],[0.123,0.532],[0.452,0.348],[0.478,0.142],[0.396,-0.169],[0.118,-0.446],[-0.114,-0.539],[-0.3,-0.449],[0.004,0.002],[0.002,0.147],[-0.001,0.148]],"v":[[497,97],[496.575,97.023],[495.949,96.954],[495.348,96.907],[495,97],[494.495,98.845],[495.432,100.17],[496.904,100.911],[498,101],[498.76,100.032],[498.754,98.507],[498.121,96.979],[497,96],[497.01,96.26],[497.01,96.739]],"c":true}],"h":1},{"t":24.00000097754,"s":[{"i":[[0.372,-0.638],[0.036,-0.268],[-0.048,-0.283],[-0.117,-0.28],[-0.168,-0.258],[-0.204,-0.217],[-0.223,-0.158],[-0.226,-0.081],[-0.213,0.016],[-0.293,0.342],[-0.012,0.505],[0.201,0.537],[0.346,0.439],[0.423,0.211],[0.432,-0.148]],"o":[[-0.137,0.234],[-0.036,0.268],[0.048,0.283],[0.117,0.28],[0.168,0.258],[0.204,0.217],[0.223,0.158],[0.226,0.081],[0.642,-0.048],[0.293,-0.342],[0.012,-0.505],[-0.201,-0.537],[-0.346,-0.439],[-0.423,-0.211],[-0.432,0.148]],"v":[[365,113],[364.745,113.758],[364.768,114.589],[365.02,115.438],[365.451,116.25],[366.014,116.967],[366.659,117.536],[367.337,117.898],[368,118],[369.386,117.383],[369.827,116.081],[369.527,114.486],[368.691,112.988],[367.521,111.98],[366.223,111.853]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":3,"s":[0],"h":1},{"t":4,"s":[100],"h":1},{"t":25.0000010182709,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 4"},{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":4,"s":[{"i":[[-0.711,-0.139],[0.114,-0.071],[2.617,-0.435],[3.505,-2.919],[0.212,-1.831],[0.239,-0.533],[-2.147,-2.181],[-1.195,-0.385],[-5.628,1.45],[-1.324,1.605],[-0.164,5.256],[2.47,5.987],[1.135,3.009]],"o":[[-2.892,-0.563],[-1.217,0.76],[-7.206,1.198],[-2.925,2.436],[-0.067,0.579],[-0.824,1.837],[1.425,1.448],[4.543,1.462],[4.115,-1.06],[2.685,-3.255],[0.071,-2.264],[-1.558,-3.776],[-0.312,-0.827]],"v":[[464,93],[460,95],[456,97],[445,96],[447,108],[444,113],[443,119],[453,119],[462,126],[466,117],[476,110],[468,102],[467,93]],"c":true}],"h":1},{"t":5,"s":[{"i":[[-1.432,-4.927],[-1.329,0.271],[-2.336,-0.805],[-1.403,-1.698],[-1.532,0.431],[-0.297,1.102],[-0.173,0.412],[-3.604,2.024],[3.401,2.935],[0.349,4.891],[4.272,-0.556],[3.953,-1.561],[0.343,-3.278]],"o":[[2.351,1.279],[1.328,-0.271],[1.857,0.641],[1.403,1.698],[0.639,-0.179],[0.297,-1.102],[2.039,-4.839],[5.841,-3.28],[-3.258,-2.812],[-0.726,-10.168],[-4.539,0.591],[-0.85,5.16],[-0.333,3.182]],"v":[[425,119],[430.011,119.855],[435,120],[439.744,124.304],[444,127],[445.349,124.674],[446,122],[453,115],[453,107],[449,99],[437,99],[427,98],[429,109]],"c":true}],"h":1},{"t":6,"s":[{"i":[[-1.358,-4.862],[-2.686,-2.505],[-2.659,0.829],[-0.441,1.102],[0.2,-0.542],[-0.553,0.957],[-1.972,0.955],[-0.311,0.136],[1.884,4.162],[0.786,4.186],[4.696,-0.612],[4.43,-1.078],[0.371,-3.495]],"o":[[5.597,-2.193],[2.686,2.505],[0.437,-0.136],[0.441,-1.102],[0.817,-2.219],[0.553,-0.957],[0.638,-0.309],[8.054,-3.511],[-2.133,-4.712],[-4.495,-2.536],[-3.138,0.409],[-0.894,5.147],[-0.306,2.882]],"v":[[411,120],[422.704,122.477],[430,127],[431.478,124.491],[432,123],[433.634,118.552],[437,116],[439,115],[435,105],[434,96],[423,100],[413,99],[415,110]],"c":true}],"h":1},{"t":7,"s":[{"i":[[-1.711,-4.702],[-1.224,0.308],[-2.289,-0.754],[-4.01,1.097],[-0.155,0.367],[-1.399,0.663],[-0.361,3.773],[-1.087,-1.001],[0.71,1.862],[1.677,1.219],[1.455,-1.095],[6.47,0.25],[0.468,-3.541]],"o":[[1.815,1.477],[1.224,-0.308],[4.119,1.356],[2.04,-0.558],[1.304,-3.094],[2.343,-1.11],[0.185,-1.931],[-1.523,-1.403],[-0.39,-1.023],[-2.457,-1.786],[-5.1,3.836],[-0.948,5.299],[-0.352,2.659]],"v":[[400,120],[404.144,121.042],[409,121],[418,127],[420,123],[424,117],[430,113],[427,109],[423,105],[422,97],[417,98],[402,100],[404,111]],"c":true}],"h":1},{"t":8,"s":[{"i":[[-4.708,0.768],[-0.159,1.547],[-1.505,1.57],[-1.075,0.525],[-0.163,2.464],[0.705,0.611],[0.86,2.032],[4.095,0.724],[-0.017,0.012],[5.948,-0.613],[0.322,-3.248],[-0.319,-4.204],[-2.788,-0.918]],"o":[[1.858,-1.244],[0.159,-1.547],[1.28,-1.335],[1.718,-0.839],[0.134,-2.034],[0.801,0.694],[-1.7,-4.02],[-0.761,-0.134],[-5.098,3.507],[-0.448,4.375],[-0.333,3.352],[3.375,2.36],[3.732,1.229]],"v":[[409,127],[411.265,122.744],[413,118],[418,117],[421,113],[417,110],[414,106],[410,97],[407,100],[393,101],[395,111],[391,120],[400,121]],"c":true}],"h":1},{"t":9,"s":[{"i":[[-0.45,4.727],[1.246,0.888],[0.678,1.995],[-0.114,1.252],[1.008,0.675],[4.475,-0.579],[0.903,0.129],[2.093,-1.91],[0.463,-3.509],[-0.454,-3.459],[-2.788,-0.918],[-4.708,0.768],[-1.528,2.221]],"o":[[-1.337,-1.453],[-1.247,-0.888],[-0.447,-1.316],[0.114,-1.252],[-3.668,-2.458],[-1.417,0.183],[-1.294,-0.185],[-0.102,4.335],[-0.355,2.693],[3.375,2.36],[3.732,1.229],[2.205,-2.289],[2.182,-3.17]],"v":[[413,113],[409.006,109.906],[406,106],[405.92,102.019],[405,99],[395,103],[390,102],[386,102],[388,112],[384,120],[393,121],[402,127],[404,120]],"c":true}],"h":1},{"t":10,"s":[{"i":[[2.378,4.058],[1.496,-0.962],[1.913,-0.283],[1.577,0.375],[1.39,-1.308],[0.613,-2.838],[0.516,-3.372],[-2.942,-2.489],[-1.989,4.748],[-0.251,0.875],[-1.186,0.562],[-0.262,3.69],[1.279,3.161]],"o":[[-2.104,-0.132],[-1.496,0.962],[-1.3,0.192],[-1.577,-0.375],[1.966,3.276],[-0.613,2.838],[5.243,-2.208],[2.942,2.489],[0.812,-1.938],[0.251,-0.875],[2.381,-1.128],[0.163,-2.301],[-1.721,-4.254]],"v":[[399,99],[393.857,100.689],[389,103],[384.567,102.164],[380,103],[381.361,111.928],[379,121],[390.94,124.405],[398,124],[399.219,119.968],[401,118],[407,114],[400,107]],"c":true}],"h":1},{"t":11,"s":[{"i":[[5.007,2.825],[1.044,-1.024],[1.561,-0.273],[1.569,0.594],[1.384,-1.143],[0.434,-2.416],[1.571,-3.053],[-1.284,0.159],[-1.366,-0.487],[-5.407,1.189],[-3.669,1.94],[-0.2,3.177],[1.684,1.459]],"o":[[-1.264,0.63],[-1.044,1.024],[-1.34,0.235],[-1.569,-0.594],[1.305,4.282],[-0.434,2.416],[1.499,1.15],[1.284,-0.16],[3.461,1.235],[0.435,-5.881],[1.953,-1.033],[0.107,-1.702],[-4.431,-3.84]],"v":[[392,99],[388.722,101.768],[385,104],[380.533,102.819],[376,103],[377.157,112.422],[374,120],[378.1,120.997],[382,121],[392,127],[398,117],[402,114],[398,111]],"c":true}],"h":1},{"t":12,"s":[{"i":[[2.066,2.612],[1.313,-0.958],[1.762,-0.298],[1.558,0.391],[1.422,-1.335],[0.706,-2.498],[0.299,-3.246],[-2.163,-1.671],[-3.723,-0.11],[-1.923,1.578],[-2.517,0.983],[1.497,1.176],[0.726,2.047]],"o":[[-1.986,-0.129],[-1.313,0.957],[-1.346,0.228],[-1.558,-0.391],[2.121,3.761],[-0.706,2.498],[4.625,-0.792],[2.163,1.671],[-0.207,-3.707],[1.922,-1.578],[-0.287,-2.25],[-1.497,-1.176],[-0.73,-2.056]],"v":[[390,100],[385.333,101.68],[381,104],[376.557,103.169],[372,104],[373.315,112.886],[371,121],[380.177,123.323],[388,127],[390.958,119.458],[398,116],[394.83,111.347],[391,107]],"c":true}],"h":1},{"t":13,"s":[{"i":[[-5.328,1.672],[1.78,1.72],[-0.833,4.333],[1.479,-0.986],[2.053,-0.189],[1.062,0.423],[1.606,-0.588],[0.417,-2.633],[1.272,-2.245],[-1.301,0.15],[-1.363,-0.465],[-1.102,-1.343],[-1.935,-0.061]],"o":[[-0.712,-2.788],[-1.78,-1.72],[-2.03,-1.133],[-1.479,0.986],[-1.144,0.106],[-1.062,-0.423],[0.941,3.221],[-0.417,2.634],[1.434,1.136],[1.301,-0.15],[1.655,0.565],[1.102,1.343],[0.448,-6.552]],"v":[[394,116],[389.342,110.158],[387,102],[382.017,102.508],[377,105],[373.846,104.138],[370,104],[370.659,112.731],[368,120],[372.053,121.002],[376,121],[379.79,124.378],[384,127]],"c":true}],"h":1},{"t":14,"s":[{"i":[[-1.187,0.077],[1.609,1.558],[-0.895,4.061],[1.324,-0.981],[1.832,-0.19],[1.067,0.429],[1.597,-0.597],[0.318,-2.104],[0.897,-3.144],[-2.461,-0.861],[-3.446,0.069],[-1.567,1.89],[-0.876,0.426]],"o":[[-0.458,-2.709],[-1.609,-1.557],[-1.872,-1.114],[-1.324,0.981],[-1.132,0.118],[-1.067,-0.429],[1.17,3.441],[-0.318,2.104],[2.484,2.133],[2.932,1.026],[2.07,-1.527],[0.583,-0.703],[0.764,-0.372]],"v":[[390,116],[385.985,110.515],[384,103],[379.47,103.522],[375,106],[371.849,105.14],[368,105],[369.05,112.722],[367,120],[374,121],[381,126],[383,119],[387,118]],"c":true}],"h":1},{"t":15,"s":[{"i":[[-0.41,2.91],[1.033,-0.39],[0.94,-0.291],[1.187,-0.005],[1.774,0.466],[0.022,-1.551],[0.376,-1.487],[0.378,-1.568],[-1.683,-1.15],[-1.697,-1.136],[-1.661,1.387],[-0.923,2.233],[1.002,1.498]],"o":[[-1.466,0.304],[-1.033,0.39],[-0.94,0.291],[-1.187,0.005],[0.683,1.761],[-0.022,1.551],[-0.376,1.487],[3.57,-0.737],[1.683,1.15],[0.433,-3.219],[1.661,-1.387],[-1.404,-1.096],[-1.002,-1.498]],"v":[[381,104],[377.336,105.087],[374.462,106.155],[371.357,106.645],[367,106],[367.903,110.932],[367.219,115.453],[366,120],[373.404,121.096],[378,125],[381.632,118.761],[386,114],[382.14,110.36]],"c":true}],"h":1},{"t":16,"s":[{"i":[[-1.979,3.354],[0.715,0.284],[0.799,1.465],[0.206,1.154],[-0.045,-0.02],[0.619,-0.542],[1.481,-0.312],[0.525,0.023],[0.456,0],[-0.29,-1.067],[0.212,-1.733],[-1.784,-2.602],[-3.961,-0.706]],"o":[[-0.34,-0.398],[-0.715,-0.284],[-0.221,-0.406],[-0.206,-1.154],[-1.044,-0.481],[-0.619,0.542],[-0.445,0.094],[-0.525,-0.023],[-2.948,0],[0.29,1.067],[-0.369,3.023],[6.556,-1.889],[0.412,-4.922]],"v":[[383,114],[381.344,113.3],[379,111],[378.3,108.18],[378,106],[375.827,106.405],[373,108],[371.508,108.07],[370,108],[366.948,109.7],[368,114],[366,119],[376,123]],"c":true}],"h":1},{"t":17,"s":[{"i":[[0.789,0.026],[1.716,-0.192],[0.24,-0.228],[0.266,-2.166],[-0.128,-0.275],[-0.916,0.073],[-0.245,-0.1],[-0.384,-0.437],[-0.29,-0.18],[-1.272,1.988],[-0.029,0.873],[1.077,1.956],[0.326,0.816]],"o":[[0.104,0.004],[-1.716,0.192],[-0.065,0.061],[-0.266,2.166],[0.09,0.194],[0.916,-0.074],[0.174,0.071],[0.384,0.437],[3.457,2.149],[-1.419,2.218],[0.003,-0.091],[-0.421,-0.764],[-0.746,-1.865]],"v":[[374,108],[370.758,108.332],[367,109],[366.356,113.339],[366,118],[367.884,118.071],[370,118],[370.913,118.918],[372,120],[375,118],[380,114],[376,111],[376,108]],"c":true}],"h":1},{"t":18,"s":[{"i":[[0.797,0.087],[1.693,-0.187],[0.278,-0.245],[-0.354,-0.809],[0.055,-0.446],[0.667,-0.299],[-0.841,-1.43],[-0.716,-0.267],[-2.125,0.45],[-0.286,0.358],[0.052,-0.035],[1.317,1.853],[0.487,0.752]],"o":[[0.05,0.005],[-1.693,0.187],[-0.36,0.317],[0.354,0.809],[-0.172,1.374],[-0.667,0.299],[0.331,0.564],[2.514,0.938],[0.248,-0.053],[-0.006,0.007],[3.429,-2.275],[-0.606,-0.852],[-0.842,-1.301]],"v":[[373,109],[369.746,109.32],[366,110],[366.272,111.904],[367,114],[365.241,115.958],[365,118],[370,118],[373,121],[374,117],[376,116],[375,112],[374,109]],"c":true}],"h":1},{"t":19,"s":[{"i":[[1.772,-0.186],[1.033,0.088],[0.368,-0.3],[0.235,-1.865],[-0.177,-0.346],[-0.912,0.07],[-0.252,-0.085],[-0.374,-0.54],[-1.059,0.312],[-0.252,0.742],[-0.049,0.049],[0.015,-0.071],[1.134,2.7]],"o":[[-0.5,0.053],[-1.033,-0.088],[-0.238,0.195],[-0.235,1.865],[0.099,0.194],[0.912,-0.07],[0.446,0.15],[0.374,0.54],[-0.059,0.017],[0.252,-0.742],[0.123,-0.123],[0.406,-1.91],[-1.071,-2.55]],"v":[[371,110],[368.401,109.814],[366,110],[365.188,113.886],[365,118],[366.885,118.081],[369,118],[370.04,119.347],[372,120],[372.419,118.55],[373,117],[376,116],[373,111]],"c":true}],"h":1},{"t":20,"s":[{"i":[[0.598,0.147],[0.465,-0.294],[0.424,0],[0.568,0.338],[0.401,-0.352],[0.031,-0.223],[-0.371,-0.67],[-3.639,-1.74],[-1.111,0.297],[-0.08,0.08],[0.019,-0.102],[0.174,0.181],[0.665,1.336]],"o":[[-0.717,-0.177],[-0.465,0.294],[-0.328,0],[-0.568,-0.338],[-1,0.88],[-0.03,0.219],[1.483,2.68],[0.526,0.252],[-0.156,0.042],[0.11,-0.11],[0.361,-1.93],[-0.869,-0.907],[-0.695,-1.397]],"v":[[371,110],[369.28,110.368],[368,111],[366.555,110.236],[365,110],[366,114],[364,117],[369,118],[371,120],[372,117],[375,116],[373,112],[372,110]],"c":true}],"h":1},{"t":21,"s":[{"i":[[-0.005,0.001],[0.55,-0.036],[0.134,-0.355],[0.129,-1.227],[-0.216,-0.406],[-1.323,-0.613],[-0.449,0.64],[-1.189,0.371],[0.256,0.42],[0.613,0.81],[0.27,0.303],[0.865,0.397],[0.005,-0.249]],"o":[[-1.376,0.268],[-0.55,0.036],[-0.134,0.355],[-0.185,1.763],[0.216,0.406],[2.014,0.933],[0.449,-0.64],[1.637,-0.511],[-0.256,-0.42],[-1.053,-1.392],[-0.271,-0.303],[0.015,0.007],[-0.005,0.249]],"v":[[369,111],[366.214,111.318],[365.292,111.766],[365,114],[364.869,116.863],[367,118],[370.118,117.978],[372,116],[373.688,114.724],[372,113],[370.359,110.754],[369,110],[369.008,110.506]],"c":true}],"h":1},{"t":22,"s":[{"i":[[-0.082,-0.015],[0.275,-0.278],[0.4,0.023],[0.197,-0.061],[0.192,-1.817],[-0.135,-0.062],[-1.683,-0.654],[-0.426,-0.573],[-0.949,0.428],[0.094,0.689],[-0.177,0.155],[-0.044,0.179],[0.634,0.463]],"o":[[-0.499,-0.09],[-0.275,0.278],[-1.02,-0.06],[-0.197,0.061],[-0.221,2.097],[0.135,0.062],[0.349,0.136],[0.426,0.573],[0.201,-0.09],[-0.094,-0.689],[0.175,-0.154],[0.663,-2.673],[0.08,0.058]],"v":[[369,111],[367.926,111.45],[367,112],[365.379,111.592],[365,114],[364.572,116.583],[367,117],[368.05,118.422],[370,119],[370.018,117.548],[370,116],[372,116],[369,110]],"c":true}],"h":1},{"t":23,"s":[{"i":[[0.775,-0.225],[0.275,0.023],[0.311,0.036],[0.255,-0.005],[0.109,-0.099],[0.155,-0.73],[0.082,-0.681],[-0.02,-0.033],[-1.966,0.347],[0.202,2.154],[0.48,0.174],[0.08,0.299],[0.223,-0.005]],"o":[[-0.148,0.043],[-0.275,-0.023],[-0.311,-0.036],[-0.255,0.005],[-0.197,0.179],[-0.155,0.73],[-0.082,0.681],[0.337,0.544],[1.966,-0.347],[0,-0.004],[-0.48,-0.174],[-0.333,-1.247],[-0.223,0.005]],"v":[[368,112],[367.343,112.017],[366.442,111.916],[365.57,111.857],[365,112],[364.465,113.514],[364.101,115.78],[364,117],[368.405,117.524],[372,114],[371.06,113.722],[370,113],[369.332,111.396]],"c":true}],"h":1},{"t":24.00000097754,"s":[{"i":[[0.202,-0.202],[0.168,-0.305],[0.037,-0.272],[-0.068,-0.225],[-0.149,-0.163],[-0.206,-0.087],[-0.237,0.003],[-0.244,0.107],[-0.226,0.226],[-0.044,0.364],[0.171,0.309],[0.283,0.197],[0.294,0.026]],"o":[[-0.323,0.323],[-0.168,0.305],[-0.037,0.272],[0.068,0.225],[0.149,0.163],[0.206,0.087],[0.237,-0.003],[0.244,-0.107],[0.361,-0.361],[0.044,-0.364],[-0.171,-0.309],[-0.283,-0.197],[-0.294,-0.026]],"v":[[448,138],[447.27,138.945],[446.968,139.813],[447.021,140.561],[447.353,141.147],[447.892,141.526],[448.562,141.657],[449.289,141.496],[450,141],[450.582,139.898],[450.367,138.873],[449.66,138.1],[448.769,137.751]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":3,"s":[0],"h":1},{"t":4,"s":[100],"h":1},{"t":25.0000010182709,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 5"},{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":4,"s":[{"i":[[2.732,0.267],[0.701,-0.966],[1.142,-0.525],[1.454,-0.213],[-1.22,-1.613],[0.977,-3.81],[-2.066,0.178],[-3.127,-0.538],[-0.718,1.898],[-0.427,2.493],[1.487,1.513]],"o":[[-0.131,1.536],[-0.701,0.966],[-1.142,0.525],[0.097,2.736],[1.22,1.613],[2.611,-0.826],[2.065,-0.178],[-1.299,-2.916],[0.718,-1.898],[-3.319,0.319],[-1.487,-1.513]],"v":[[493,114],[491.721,117.721],[488.926,119.926],[485,121],[487.806,126.694],[489,134],[495.612,132.477],[503,133],[502.705,126.182],[505,120],[498.56,117.44]],"c":true}],"h":1},{"t":5,"s":[{"i":[[3.505,-1.028],[1.852,-1.148],[1.334,-1.666],[-0.462,-2.204],[-0.822,-1.844],[-2.086,0.115],[-2.624,-0.537],[-0.531,1.712],[-1.518,1.918],[1.288,0.044],[1.016,0.633]],"o":[[-0.257,2.743],[-1.852,1.148],[2.328,0.338],[0.462,2.204],[2.033,-1.079],[2.086,-0.115],[-0.644,-3.233],[0.531,-1.712],[-0.832,-1.19],[-1.288,-0.044],[-1.835,-1.143]],"v":[[484,117],[480.308,122.308],[475,126],[478.63,130.37],[480,137],[486.057,135.288],[493,136],[492.879,129.014],[496,124],[492.638,122.582],[489,122]],"c":true}],"h":1},{"t":6,"s":[{"i":[[2.776,0.209],[0.796,-0.871],[1.184,-0.482],[1.168,-0.498],[-1.064,-1.603],[0.824,-3.49],[-1.918,0.283],[-2.839,-0.753],[-0.709,1.791],[-0.757,1.743],[1.36,1.47]],"o":[[-0.003,1.664],[-0.796,0.871],[-1.184,0.482],[0.567,2.099],[1.064,1.603],[2.49,-0.621],[1.918,-0.283],[-0.594,-3.094],[0.709,-1.791],[-3.786,0.09],[-1.36,-1.47]],"v":[[476,120],[474.701,123.701],[471.63,125.63],[468,127],[471.044,131.956],[472,139],[478.238,137.469],[485,138],[485.486,130.986],[488,126],[481.243,123.225]],"c":true}],"h":1},{"t":7,"s":[{"i":[[-1.415,4.064],[0.594,2.021],[2.534,0.812],[0.569,-0.47],[0.034,-0.02],[1.477,0.239],[1.329,-0.87],[2.839,-3.888],[-2.614,-1.158],[-0.224,-0.22],[-1.707,0.033]],"o":[[-3.091,-1.102],[-0.594,-2.021],[0.308,0.099],[-0.569,0.47],[-1.764,1.085],[-1.477,-0.239],[2.193,4.816],[2.799,2.457],[0.112,0.05],[0.846,0.83],[-0.27,-6.825]],"v":[[503,113],[498.582,107.782],[495,103],[494.256,104.059],[493,105],[488.175,105.661],[484,106],[483,118],[491,119],[492,122],[496,123]],"c":true}],"h":1},{"t":8,"s":[{"i":[[-0.856,3.523],[1.222,-0.53],[1.34,-0.17],[2.11,0.7],[0.217,-2.188],[0.933,-1.886],[-1.603,-1.064],[-2.099,-0.567],[-1.125,1.375],[-2.012,0.488],[1.385,1.281]],"o":[[-1.758,0.38],[-1.222,0.53],[-1.34,0.17],[0.801,2.36],[-0.217,2.188],[3.49,-0.824],[1.603,1.064],[0.489,-2.011],[1.125,-1.375],[-0.314,-2.353],[-1.385,-1.281]],"v":[[494,104],[489.693,105.492],[486.012,106.668],[481,106],[481.8,112.855],[480,119],[487.044,119.956],[492,123],[494.358,117.858],[499,115],[495.623,110.377]],"c":true}],"h":1},{"t":9,"s":[{"i":[[3.248,0.294],[1.893,-0.44],[2.547,0.214],[0.143,-1.7],[1.461,-1.81],[-1.701,-1.005],[-1.894,-0.753],[-1.125,1.375],[-2.012,0.488],[1.055,0.76],[0.661,1.315]],"o":[[-0.88,1.454],[-1.894,0.44],[1.034,2.392],[-0.144,1.7],[3.302,0.229],[1.701,1.005],[0.489,-2.011],[1.125,-1.375],[-0.117,-1.646],[-1.055,-0.76],[-0.853,-1.695]],"v":[[489,104],[484.75,106.751],[478,107],[479.371,112.936],[477,118],[484.056,120.107],[489,123],[491.358,117.858],[496,115],[493.908,111.751],[491,109]],"c":true}],"h":1},{"t":10,"s":[{"i":[[2.034,2.125],[0.775,-0.822],[1.031,-0.146],[0.95,0.415],[1.452,-0.554],[0.236,-1.953],[0.849,-1.877],[-1.689,-0.852],[-2.134,-0.328],[-0.133,3.531],[1.035,2.292]],"o":[[-1.869,-0.433],[-0.775,0.822],[-0.747,0.106],[-0.95,-0.415],[0.793,2.309],[-0.236,1.953],[3.109,0.261],[1.689,0.853],[-0.847,-6.176],[0.062,-1.631],[-1.009,-2.233]],"v":[[488,105],[484.372,106.066],[482,108],[479.529,107.163],[476,107],[476.731,113.324],[475,119],[481.731,120.95],[487,123],[493,114],[489,110]],"c":true}],"h":1},{"t":11,"s":[{"i":[[-0.538,4.462],[0.467,1.784],[2.336,0.703],[0.568,-0.472],[0.033,-0.02],[1.276,0.24],[1.226,-0.933],[0.177,-1.666],[1.317,-1.954],[-1.689,-0.852],[-2.134,-0.328]],"o":[[-2.797,-1.159],[-0.467,-1.785],[0.304,0.091],[-0.568,0.472],[-1.672,1.029],[-1.276,-0.24],[1.025,2.382],[-0.177,1.666],[3.109,0.261],[1.689,0.853],[-0.731,-5.731]],"v":[[491,114],[487.154,109.158],[484,105],[483.253,106.053],[482,107],[477.666,107.572],[474,108],[475.256,113.821],[473,119],[479.731,120.95],[485,123]],"c":true}],"h":1},{"t":12,"s":[{"i":[[0.124,-3.14],[-0.936,0.117],[-1.404,-0.486],[-0.818,-0.634],[-0.871,2.177],[0.06,2.824],[0.939,3.612],[0.342,0.166],[3.201,-0.561],[1.701,-1.777],[0.249,-2.545]],"o":[[0.852,0.983],[0.936,-0.117],[1.856,0.642],[0.818,0.634],[1.577,-3.943],[-0.054,-2.519],[-0.123,-0.475],[-1.926,-0.936],[-1.68,0.295],[-0.956,0.998],[-0.298,3.056]],"v":[[472,119],[474.586,119.873],[478,120],[481.739,122.615],[484,121],[489,114],[485,110],[485,106],[479,108],[473,108],[474,114]],"c":true}],"h":1},{"t":13,"s":[{"i":[[-2.925,-1.408],[-0.173,0.911],[-0.535,0.614],[-0.888,0.317],[-0.037,0.257],[1.048,1.719],[0.524,1.137],[-0.677,-0.341],[2.047,-0.24],[2.761,0.154],[2.164,-4.983]],"o":[[0.775,-0.74],[0.173,-0.911],[0.413,-0.474],[0.888,-0.317],[0.186,-1.288],[-0.449,-0.736],[0.324,0.703],[-2.459,-1.238],[-2.85,0.334],[-0.612,3.703],[5.547,-1.214]],"v":[[481,123],[482.18,120.405],[483,118],[485.282,116.837],[487,116],[485,112],[484,110],[483,107],[478,109],[473,108],[472,119]],"c":true}],"h":1},{"t":14,"s":[{"i":[[-0.152,-0.035],[2.251,-0.104],[1.032,-1.214],[0.187,-1.913],[0.367,-0.66],[-3.018,-1.408],[-1.827,0.437],[-0.923,0.777],[-0.45,0.156],[1.308,2.241],[0.374,0.789]],"o":[[-0.916,-0.21],[0.254,-0.012],[-0.873,1.026],[-0.087,0.888],[-2.375,4.275],[2.156,1.006],[0.786,-0.188],[0.352,-0.296],[4.958,-1.716],[-0.438,-0.75],[-0.503,-1.063]],"v":[[480,108],[476,110],[472,109],[473,114],[472,116],[477,119],[480,122],[482,117],[484,117],[482,111],[482,108]],"c":true}],"h":1},{"t":15,"s":[{"i":[[-0.045,-0.005],[0.745,-0.177],[0.465,-0.588],[0.025,-1.045],[-0.99,-1.577],[-0.586,-0.223],[-1.936,0.413],[-0.75,0.837],[-0.074,0.446],[1.326,2.117],[0.889,1.493]],"o":[[-0.941,-0.102],[-0.817,0.195],[-0.701,0.887],[-0.023,0.961],[0.292,0.465],[2.253,0.857],[1.233,-0.263],[0.367,-0.409],[0.4,-2.409],[-1.217,-1.943],[0.04,0.068]],"v":[[479,109],[477,110],[472,110],[473,114],[472,118],[476,118],[479,121],[480,117],[484,116],[481,112],[479,108]],"c":true}],"h":1},{"t":16,"s":[{"i":[[1.246,-0.272],[0.437,-0.168],[0.197,-1.877],[-0.213,-0.435],[-1.327,-0.544],[-0.661,-0.274],[-0.865,0.3],[0.054,0.702],[-0.087,0.145],[0.086,2.037],[-0.004,-0.005]],"o":[[-2.055,0.45],[-0.437,0.168],[-0.18,1.715],[0.213,0.435],[0.494,0.203],[0.66,0.274],[0.129,-0.045],[-0.054,-0.702],[0.594,-0.994],[0.019,0.441],[-2.148,-2.317]],"v":[[477,111],[473.607,111.429],[473,114],[472.869,116.878],[475,118],[476.722,118.877],[479,119],[479.032,117.575],[479,116],[482,114],[480,112]],"c":true}],"h":1},{"t":17,"s":[{"i":[[0.857,-0.127],[0.384,-0.234],[0.305,-1.743],[-0.157,-0.129],[-1.692,-0.657],[-0.37,-0.531],[-1.062,0.3],[0.048,0.709],[-0.079,0.132],[0.064,2.041],[0.776,1.285]],"o":[[-2.159,0.319],[-0.384,0.234],[-0.319,1.825],[0.157,0.13],[0.456,0.177],[0.37,0.531],[0.112,-0.031],[-0.048,-0.709],[0.6,-1.003],[0.011,0.357],[-0.744,-1.233]],"v":[[477,111],[473.61,111.432],[473,114],[472.492,116.375],[475,117],[476.045,118.358],[478,119],[478.025,117.575],[478,116],[481,114],[478,111]],"c":true}],"h":1},{"t":18,"s":[{"i":[[0.659,-0.185],[0.271,0.023],[0.3,0.037],[0.254,-0.005],[0.133,-0.102],[0.179,-0.691],[0.079,-0.688],[-0.094,-0.151],[-1.933,0.442],[0.175,1.944],[0.812,0.295]],"o":[[-0.166,0.047],[-0.271,-0.023],[-0.3,-0.037],[-0.254,0.005],[-0.208,0.16],[-0.179,0.691],[-0.079,0.688],[0.442,0.71],[1.933,-0.442],[-0.091,-1.005],[-0.812,-0.295]],"v":[[476,112],[475.326,112.021],[474.45,111.917],[473.6,111.854],[473,112],[472.401,113.409],[471.996,115.609],[472,117],[476.463,117.49],[480,114],[478.427,112.108]],"c":true}],"h":1},{"t":19,"s":[{"i":[[0.548,-0.101],[-0.149,-0.255],[0.244,-1.546],[0.358,-0.368],[-0.44,-0.483],[-1.187,-0.159],[0.055,-0.027],[-0.689,0.986],[0.042,0.407],[0.48,0.358],[0.065,0.429]],"o":[[-2.351,0.433],[0.149,0.255],[-0.007,0.047],[-0.358,0.367],[0.308,0.339],[1.187,0.158],[-0.715,0.351],[0.689,-0.986],[-0.014,-0.138],[-0.48,-0.358],[-0.288,-1.888]],"v":[[475,112],[472.42,112.665],[473,115],[472.165,115.673],[472,117],[474.772,117.734],[477,118],[477.495,116.569],[479,114],[478.039,113.219],[477,112]],"c":true}],"h":1},{"t":20,"s":[{"i":[[-0.028,-0.006],[0.509,-0.084],[0.021,-0.324],[-0.124,-0.453],[0.075,-0.472],[-0.692,-0.163],[-0.821,0.812],[-0.094,1.069],[1.489,0.609],[0.009,-0.146],[0.01,-0.144]],"o":[[-1.341,-0.267],[-0.509,0.084],[-0.021,0.324],[0.124,0.453],[-0.293,1.856],[0.692,0.163],[0.821,-0.812],[0.094,-1.069],[0.029,0.012],[-0.009,0.146],[-0.01,0.144]],"v":[[476,112],[473.311,111.753],[472.601,112.392],[472.84,113.585],[473,115],[473.812,117.85],[476.294,116.698],[477.88,113.696],[476,111],[476.02,111.271],[475.982,111.741]],"c":true}],"h":1},{"t":21,"s":[{"i":[[1.089,-1.174],[-0.027,-0.139],[-0.059,-0.226],[-0.089,-0.271],[-0.115,-0.273],[-0.137,-0.232],[-0.157,-0.15],[-0.173,-0.024],[-0.463,0.698],[0.391,0.852],[0.908,0.228]],"o":[[-0.009,0.01],[0.027,0.139],[0.059,0.226],[0.089,0.271],[0.115,0.273],[0.137,0.232],[0.157,0.15],[1.652,0.233],[0.463,-0.698],[-0.391,-0.852],[-0.908,-0.228]],"v":[[472,113],[472.026,113.235],[472.156,113.794],[472.378,114.55],[472.684,115.376],[473.062,116.145],[473.504,116.728],[474,117],[477.088,116.108],[477.112,113.589],[475.08,111.775]],"c":true}],"h":1},{"t":22,"s":[{"i":[[0.031,-0.006],[0.437,-0.273],[0.194,-0.307],[0.035,-0.255],[-0.04,-0.119],[-0.526,-0.065],[-0.587,0.301],[-0.392,0.465],[0.058,0.427],[0.286,0.15],[0.275,-0.011]],"o":[[-0.764,0.155],[-0.437,0.273],[-0.194,0.307],[-0.035,0.255],[0.212,0.633],[0.526,0.065],[0.587,-0.301],[0.392,-0.465],[-0.065,-0.478],[-0.286,-0.15],[-0.275,0.011]],"v":[[475,113],[473.219,113.664],[472.294,114.554],[471.972,115.418],[472,116],[473.171,116.996],[474.904,116.59],[476.435,115.39],[477,114],[476.416,113.099],[475.517,112.932]],"c":true}],"h":1},{"t":23.0000009368092,"s":[{"i":[[0.064,-0.738],[-0.603,0.112],[-0.351,0.193],[-0.139,0.237],[0.031,0.244],[0.159,0.215],[0.247,0.148],[0.293,0.045],[0.298,-0.096],[0.261,-0.273],[0.183,-0.487]],"o":[[0.897,0.006],[0.603,-0.112],[0.351,-0.193],[0.139,-0.237],[-0.031,-0.244],[-0.159,-0.215],[-0.247,-0.148],[-0.293,-0.045],[-0.298,0.096],[-0.261,0.273],[-0.183,0.487]],"v":[[472,116],[474.239,115.832],[475.659,115.365],[476.384,114.712],[476.536,113.981],[476.241,113.283],[475.622,112.73],[474.802,112.432],[473.906,112.5],[473.058,113.043],[472.381,114.173]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":3,"s":[0],"h":1},{"t":4,"s":[100],"h":1},{"t":24.00000097754,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 6"},{"inv":false,"mode":"f","pt":{"a":1,"k":[{"t":7,"s":[{"i":[[2.776,0.209],[0.575,-0.759],[0.904,-0.429],[0.877,-0.456],[0.495,-0.838],[-0.858,-1.475],[0.505,-2.839],[-2.321,0.434],[-2.401,-1.264],[-0.61,1.89],[-0.994,1.507],[1.36,1.47]],"o":[[0.111,1.444],[-0.575,0.759],[-0.904,0.429],[-0.877,0.456],[1.073,1.26],[0.858,1.475],[1.314,0.471],[2.321,-0.434],[-0.435,-2.935],[0.61,-1.89],[-3.786,0.09],[-1.36,-1.47]],"v":[[470,122],[469.215,125.215],[466.908,126.908],[464.147,128.148],[462,130],[465.183,133.816],[466,140],[471.685,139.405],[479,140],[479.429,132.929],[482,128],[475.243,125.225]],"c":true}],"h":1},{"t":8,"s":[{"i":[[-1.113,1.22],[1.201,0.064],[1.074,0.696],[0.152,0.669],[0.2,0.2],[1.513,-2.013],[2.925,1.031],[-1.03,-1.636],[0.68,-3.346],[-1.953,0.236],[-2.31,-0.793],[-0.555,1.779]],"o":[[-1.12,-1.047],[-1.201,-0.064],[-0.193,-0.126],[-0.152,-0.669],[-2.02,-2.02],[-1.514,2.013],[0.558,2.108],[1.031,1.636],[1.877,-0.849],[1.953,-0.236],[-0.332,-2.665],[0.555,-1.779]],"v":[[477,130],[473.465,128.737],[470,128],[469.505,126.556],[469,125],[464.179,126.758],[458,130],[460.928,135.072],[462,142],[467.676,140.269],[474,141],[474.416,134.416]],"c":true}],"h":1},{"t":9,"s":[{"i":[[2.257,0.243],[0.575,-0.759],[0.904,-0.429],[0.877,-0.456],[0.495,-0.838],[-0.656,-1.678],[0.332,-2.665],[-1.953,0.236],[-2.31,-0.793],[-0.934,1.859],[0.8,1.42],[1.075,1.425]],"o":[[0.111,1.444],[-0.575,0.759],[-0.904,0.429],[-0.877,0.456],[1.709,0.625],[0.656,1.678],[1.877,-0.849],[1.953,-0.236],[-0.937,-3.144],[0.934,-1.859],[-3.442,0.942],[-1.075,-1.425]],"v":[[462,125],[461.215,128.215],[458.908,129.908],[456.147,131.148],[454,133],[457.531,136.47],[458,143],[463.676,141.269],[470,142],[470.898,134.707],[472,130],[466.111,128.389]],"c":true}],"h":1},{"t":10,"s":[{"i":[[2.257,0.243],[0.175,-0.83],[0.904,-0.684],[1.135,-0.167],[-0.008,0.024],[-1.209,-1.428],[1.137,-3.286],[-2.083,0.449],[-2.346,-1.246],[-0.55,1.474],[-0.555,2.775],[1.075,1.425]],"o":[[-0.397,0.994],[-0.175,0.831],[-0.47,0.356],[-1.135,0.167],[-0.699,2.002],[1.209,1.428],[1.321,0.548],[2.083,-0.449],[-0.754,-3.327],[0.55,-1.474],[-3.442,0.942],[-1.075,-1.425]],"v":[[459,126],[458.38,128.732],[457,131],[454.141,131.785],[452,132],[453.829,136.537],[455,143],[460.231,142.477],[467,143],[467.019,136.586],[469,131],[463.111,129.389]],"c":true}],"h":1},{"t":11,"s":[{"i":[[1.499,1.168],[0.613,-0.733],[0.837,-0.434],[0.806,-0.484],[0.52,-0.883],[-0.718,-1.448],[0.374,-2.541],[-1.493,0.112],[-2.461,-1.048],[-0.555,1.779],[-1.113,1.22],[1.537,1.13]],"o":[[-0.134,1.38],[-0.613,0.733],[-0.836,0.434],[-0.806,0.484],[1.501,0.666],[0.718,1.448],[2.567,-0.6],[1.493,-0.112],[-0.332,-2.665],[0.555,-1.779],[-2.353,-0.313],[-1.537,-1.13]],"v":[[457,127],[455.817,130.082],[453.58,131.746],[451.053,133.036],[449,135],[452.407,138.094],[453,144],[458.58,142.764],[464,144],[464.416,137.416],[467,133],[461.359,130.641]],"c":true}],"h":1},{"t":12,"s":[{"i":[[-0.008,0.002],[-0.012,-0.342],[0.342,-0.489],[1.285,-0.439],[0.01,-0.029],[-0.817,-0.864],[-0.259,-0.987],[-3.872,1.659],[0,5.362],[0.897,2.197],[0.29,0.079],[-1.239,-1.381]],"o":[[-0.707,0.143],[0.012,0.342],[-0.851,1.216],[-1.285,0.439],[-0.526,1.555],[0.817,0.864],[1.197,4.557],[3.977,-1.704],[0,-4.324],[-0.084,-0.206],[-0.957,-0.261],[0.035,0.039]],"v":[[455,129],[454.227,129.74],[454,131],[450.369,133.39],[448,134],[448.911,137.427],[451,140],[454,144],[462,141],[464,133],[461,133],[455,128]],"c":true}],"h":1},{"t":13,"s":[{"i":[[1.95,-0.478],[0.084,-0.716],[0.416,-0.493],[1.101,-0.246],[0.128,-0.464],[-0.708,-0.913],[-0.396,-1.525],[-0.188,-0.495],[-1.765,0.836],[0,5.468],[0.574,1.437],[1.553,0.856]],"o":[[-0.25,0.641],[-0.084,0.716],[-0.466,0.553],[-1.101,0.246],[-0.226,0.822],[0.708,0.913],[0.481,1.855],[0.188,0.495],[3.758,-1.78],[0,-3.657],[-0.353,-0.883],[-2.209,-1.217]],"v":[[453,129],[452.624,131.11],[452,133],[449.246,134.067],[447,135],[448.033,137.472],[450,141],[450.537,144.518],[453,144],[460,141],[462,134],[457,133]],"c":true}],"h":1},{"t":14,"s":[{"i":[[-0.012,0.002],[0.819,-0.801],[0.594,-1.344],[-0.779,-2.9],[-0.438,-0.3],[-2.106,-0.05],[-0.66,0.53],[-0.19,0.823],[1.255,3.364],[3.36,1.958],[0.114,0.114],[1.142,0.716]],"o":[[-1.493,0.292],[-2.126,2.082],[-1.143,2.587],[0.158,0.589],[1.039,0.711],[1.02,0.024],[0.59,-0.474],[0.685,-2.961],[-1.296,-3.474],[-0.022,-0.013],[-0.843,-0.843],[0.036,0.022]],"v":[[452,132],[451,134],[446,135],[449,140],[449,144],[454,143],[458,144],[458,139],[460,135],[455,134],[454,132],[452,131]],"c":true}],"h":1},{"t":15,"s":[{"i":[[3.329,-0.921],[-0.041,-0.346],[0.428,-0.415],[0.897,-0.099],[0.13,-0.332],[-0.869,-1.956],[-2.235,-0.973],[-0.303,0.036],[-1.78,2.199],[-0.146,0.798],[0.743,1.506],[0.512,0.225]],"o":[[-0.735,0.203],[0.041,0.345],[-0.281,0.273],[-0.897,0.099],[-0.57,1.452],[1.273,2.865],[-0.387,-0.169],[2.951,-0.348],[-0.593,0.733],[0.255,-1.393],[-0.206,-0.418],[-2.932,-1.288]],"v":[[451,133],[450.27,133.841],[450,135],[447.886,135.456],[446,136],[448,140],[450,144],[453,142],[457,142],[456,139],[458,135],[454,135]],"c":true}],"h":1},{"t":16,"s":[{"i":[[0.787,-0.116],[-0.042,-0.394],[0.413,-0.31],[0.757,-0.024],[0.174,-1.304],[-0.661,-1.535],[0.749,0.343],[-1.727,0.102],[-0.45,0.43],[0.016,0.04],[0.308,0.146],[0.08,0.153]],"o":[[-0.754,0.112],[0.042,0.394],[-0.798,0.599],[-0.757,0.024],[0.106,-0.797],[0.661,1.535],[-0.357,-0.163],[1.727,-0.102],[0.412,-0.394],[-0.101,-0.254],[-0.11,-0.052],[-0.661,-1.274]],"v":[[451,134],[450.245,134.851],[450,136],[447.532,136.471],[446,138],[447.641,140.159],[448,143],[450.895,142.7],[455,142],[456,136],[453,136],[452,134]],"c":true}],"h":1},{"t":17,"s":[{"i":[[0.021,-0.005],[-0.041,-0.374],[0.428,-0.337],[0.65,0.029],[-0.025,-0.783],[-0.656,-1.26],[0.605,0.378],[-1.321,0.038],[-0.249,0.137],[-0.072,0.333],[0.097,0.291],[-0.907,-0.104]],"o":[[-0.738,0.169],[0.042,0.374],[-0.424,0.334],[-0.65,-0.029],[-0.021,-0.661],[0.656,1.26],[0.466,0.291],[1.321,-0.038],[0.242,-0.134],[0.112,-0.513],[-0.397,-1.185],[-0.008,-0.001]],"v":[[450,135],[449.267,135.874],[449,137],[447.163,137.164],[446,138],[447.438,139.788],[448,142],[451.163,142.322],[454,142],[454,139],[455,137],[450,134]],"c":true}],"h":1},{"t":18,"s":[{"i":[[0.053,-0.03],[0.192,-1.166],[-0.806,-0.739],[-1.356,0.132],[0.501,-0.459],[0.055,0.651],[-0.053,0.242],[0.245,-0.104],[1.389,0.713],[0.092,0.529],[1.187,-0.346],[-0.027,-0.239]],"o":[[-1.037,0.596],[-0.192,1.166],[0.075,0.069],[1.356,-0.132],[0.169,-0.154],[-0.055,-0.651],[0.37,-1.704],[-0.245,0.104],[-0.447,-0.23],[-0.092,-0.529],[-0.054,0.016],[0.027,0.239]],"v":[[449,136],[447.118,138.892],[448,142],[450.932,141.707],[453,142],[453.087,140.565],[453,139],[453.319,137.257],[451,137],[450.555,135.569],[449,135],[448.999,135.489]],"c":true}],"h":1},{"t":19,"s":[{"i":[[1.319,-0.489],[0.242,-0.175],[0.228,-0.241],[0.193,-0.285],[0.138,-0.308],[0.063,-0.309],[-0.034,-0.288],[-0.151,-0.246],[-0.288,-0.183],[-0.876,0.54],[-0.211,1.105],[0.52,0.762]],"o":[[-0.235,0.087],[-0.242,0.175],[-0.228,0.241],[-0.193,0.285],[-0.138,0.308],[-0.063,0.309],[0.034,0.288],[0.151,0.246],[1.473,0.933],[0.876,-0.54],[0.211,-1.105],[-0.52,-0.762]],"v":[[449,136],[448.279,136.398],[447.569,137.027],[446.932,137.82],[446.43,138.714],[446.123,139.644],[446.075,140.545],[446.347,141.352],[447,142],[450.54,142.361],[452.188,139.665],[451.741,136.637]],"c":true}],"h":1},{"t":20,"s":[{"i":[[0.043,-0.016],[0.295,-0.363],[0.154,-0.492],[-0.093,-0.508],[-0.447,-0.41],[-0.614,0.104],[-0.652,0.165],[-0.337,-0.021],[0.33,-0.454],[1.091,1.124],[0.859,-0.178],[-0.021,-0.244]],"o":[[-0.329,0.12],[-0.295,0.363],[-0.154,0.492],[0.093,0.508],[0.223,0.205],[0.614,-0.104],[0.652,-0.165],[0.337,0.021],[1.223,-1.684],[-1.091,-1.124],[-0.042,0.008],[0.021,0.244]],"v":[[448,137],[447.037,137.754],[446.336,139.066],[446.217,140.595],[447,142],[448.343,142.09],[450.329,141.626],[451.901,141.349],[452,142],[451.562,137.603],[448,136],[448.001,136.495]],"c":true}],"h":1},{"t":21,"s":[{"i":[[0.354,-0.157],[0.289,-0.331],[0.17,-0.487],[-0.204,-0.538],[-0.832,-0.483],[-0.284,0.102],[-0.515,0.001],[-0.349,-0.101],[0.215,-0.205],[0.037,0.645],[0.465,0.494],[0.57,0.227]],"o":[[-0.154,0.069],[-0.289,0.331],[-0.17,0.487],[0.204,0.538],[-0.346,-0.201],[0.284,-0.102],[0.515,-0.001],[0.349,0.101],[0.712,-0.679],[-0.037,-0.645],[-0.465,-0.494],[-0.57,-0.227]],"v":[[448,137],[447.272,137.625],[446.521,138.879],[446.509,140.443],[448,142],[448.007,141.546],[449.304,141.392],[450.7,141.541],[451,142],[451.933,139.984],[451.1,138.245],[449.467,137.134]],"c":true}],"h":1},{"t":22,"s":[{"i":[[1.024,-0.389],[0.211,-0.028],[0.174,-0.037],[0.126,-0.115],[0.068,-0.263],[-0.173,-0.264],[-0.231,-0.39],[-0.193,-0.306],[-0.059,-0.013],[-0.445,0.47],[-0.09,0.633],[0.4,0.347]],"o":[[-0.236,0.09],[-0.211,0.028],[-0.174,0.037],[-0.126,0.115],[0.019,-0.072],[0.173,0.264],[0.231,0.39],[0.193,0.306],[0.666,0.145],[0.445,-0.469],[0.09,-0.633],[-0.4,-0.347]],"v":[[448,138],[447.327,138.16],[446.748,138.24],[446.294,138.45],[446,139],[446.311,139.34],[446.94,140.373],[447.599,141.469],[448,142],[449.699,141.4],[450.534,139.633],[450.102,138.05]],"c":true}],"h":1},{"t":23.0000009368092,"s":[{"i":[[0,0.001],[0.177,-0.435],[-0.09,-0.223],[-0.269,-0.047],[-0.36,0.094],[-0.363,0.2],[-0.277,0.27],[-0.104,0.305],[0.158,0.305],[0.309,0.053],[0.338,-0.072],[0.235,-0.089]],"o":[[-0.533,0.682],[-0.177,0.435],[0.09,0.223],[0.269,0.047],[0.36,-0.094],[0.363,-0.2],[0.277,-0.27],[0.104,-0.305],[-0.149,-0.286],[-0.309,-0.053],[-0.338,0.072],[-0.235,0.089]],"v":[[448,138],[446.958,139.666],[446.85,140.644],[447.411,141.04],[448.378,140.96],[449.484,140.51],[450.467,139.796],[451.06,138.924],[451,138],[450.28,137.518],[449.276,137.572],[448.384,137.841]],"c":true}],"h":1}],"ix":1},"o":{"a":1,"k":[{"t":6,"s":[0],"h":1},{"t":7,"s":[100],"h":1},{"t":24.00000097754,"s":[0],"h":1}],"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"마스크 7"}],"sw":1125,"sh":207,"sc":"#ffd200","ip":0,"op":900.000036657751,"st":0,"bm":0}],"markers":[]}');function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){var i;return i=function(t,e){if("object"!=a(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=a(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"),(e="symbol"==a(i)?i:i+"")in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=document.querySelector("lottie-player"),d=o()('[data-remodal-id="one-star-modal"]').remodal(),p=o()('[data-remodal-id="five-star-modal"]').remodal();o()("#sc_review_something_hall_subject").on("subject-selected",(function(t){f(d,{subject_id:t.target.value}),f(p,{subject_id:t.target.value})})),o()('#reviewForm input[name="subject-text"]').on("subject-selected",(function(t){f(d,{subject_name:t.target.value}),f(p,{subject_name:t.target.value})}));var f=function(t,e){var r=JSON.parse(t.$modal[0].dataset.track);t.$modal[0].dataset.track=JSON.stringify(c(c({},r),e))},m=function(t){var e=g(1),r=g(5);return e?(y(d,t),!1):!r||(y(p,t,!0),!1)},g=function(t){var e=document.querySelectorAll('input[type="radio"][value="'.concat(t,'"]'));return 0===Array.from(e).filter((function(t){return!t.checked})).length},y=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.open(),r&&(h.load(s),h.seek(0),h.play()),o()(document).on("confirmation",".remodal",(function(r){t.close(),e.submit()})),o()(document).on("cancellation",".remodal",(function(e){t.close()}))},v=r(8020);function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function b(t){return function(t){if(Array.isArray(t))return x(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return x(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function w(){w=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(t,e,r,i){var o=e&&e.prototype instanceof g?e:g,s=Object.create(o.prototype),a=new I(i||[]);return n(s,"_invoke",{value:k(t,r,a)}),s}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",p="executing",f="completed",m={};function g(){}function y(){}function v(){}var b={};c(b,s,(function(){return this}));var x=Object.getPrototypeOf,T=x&&x(x(O([])));T&&T!==r&&i.call(T,s)&&(b=T);var E=v.prototype=g.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,o,s,a){var l=h(t[n],t,o);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==_(u)&&i.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,s,a)}),(function(t){r("throw",t,s,a)})):e.resolve(u).then((function(t){c.value=t,s(c)}),(function(t){return r("throw",t,s,a)}))}a(l.arg)}var o;n(this,"_invoke",{value:function(t,i){function n(){return new e((function(e,n){r(t,i,e,n)}))}return o=o?o.then(n,n):n()}})}function k(e,r,i){var n=d;return function(o,s){if(n===p)throw Error("Generator is already running");if(n===f){if("throw"===o)throw s;return{value:t,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var l=A(a,i);if(l){if(l===m)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===d)throw n=f,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=p;var c=h(e,r,i);if("normal"===c.type){if(n=i.done?f:"suspendedYield",c.arg===m)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n=f,i.method="throw",i.arg=c.arg)}}}function A(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var o=h(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(_(e)+" is not iterable")}return y.prototype=v,n(E,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:y,configurable:!0}),y.displayName=c(v,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(P.prototype),c(P.prototype,a,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new P(u(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return a.type="throw",a.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;C(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:O(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}function T(t,e,r,i,n,o,s){try{var a=t[o](s),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(i,n)}function E(t){return function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function s(t){T(o,i,n,s,a,"next",t)}function a(t){T(o,i,n,s,a,"throw",t)}s(void 0)}))}}function S(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,L(i.key),i)}}function P(t,e){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},P(t,e)}function k(t){var e=C();return function(){var r,i=I(t);if(e){var n=I(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return A(this,r)}}function A(t,e){if(e&&("object"===_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return M(t)}function M(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(C=function(){return!!t})()}function I(t){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},I(t)}function O(t,e,r){return(e=L(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function L(t){var e=function(t,e){if("object"!=_(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=_(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_(e)?e:e+""}var D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&P(t,e)}(h,t);var e,r,i,n,o,s,a,l,c,u=k(h);function h(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),O(M(e=u.call(this,t)),"timer",0),O(M(e),"validateEmailPending",!0),O(M(e),"observers",{userTypeInput:null,studentTypeInput:null}),e.formConfig={beforeSubmit:window.sc.confirmFiveStarsReviews?m:function(){return!0}},e}return e=h,r=[{key:"initialize",value:function(){this.boundhandleClassChange=this.handleClassChange.bind(this),new MutationObserver(this.boundhandleClassChange).observe(document.getElementById("answer-1-1"),{attributes:!0})}},{key:"validateEmailOrLoggedIn",value:function(){return window.sc.isUserLoggedIn||!this.validateEmailPending}},{key:"inputPinHandler",value:(c=E(w().mark((function t(e){var r,i;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.target.value.replace(/\D/g,""),e.target.value=r.charAt(0),r?e.target.classList.add("!tw-bg-gray-100"):e.target.classList.remove("!tw-bg-gray-100"),!(""===e.target.value&&e.target.dataset.position>1)){t.next=6;break}return this.pinInputTargets[e.target.dataset.position-2].focus(),t.abrupt("return");case 6:if(r&&e.target.dataset.position<4&&this.pinInputTargets[e.target.dataset.position].focus(),0!==this.pinInputTargets.filter((function(t){return""===t.value})).length){t.next=12;break}return i=this.pinInputTargets.map((function(t){return t.value})),t.next=12,this.checkCode(i.join(""));case 12:case"end":return t.stop()}}),t,this)}))),function(t){return c.apply(this,arguments)})},{key:"checkCode",value:(l=E(w().mark((function t(e){var r,i=this;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=new URLSearchParams).append("email",this.emailInputTarget.value),r.append("code",e),this.tryAgainLoadingTarget.classList.remove("tw-hidden"),this.tryAgainLoadingTarget.innerText="Validating...",t.abrupt("return",fetch(window.sc.validatePinCodeCheckURL,{method:"POST",body:r,headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(t){401===t.status?(i.pinInputTargets.map((function(t){return t.classList.add("!tw-border-red-400")})),i.tryAgainLoadingTarget.classList.add("tw-hidden")):(i.universityEmailContainerTarget.classList.add("tw-hidden"),i.universityEmailTarget.getElementsByTagName("span")[0].innerText=i.emailInputTarget.value,i.universityEmailTarget.classList.remove("tw-hidden"),i.validateEmailPending=!1,i.formChangeHandler())})).catch((function(t){return"AbortError"!==t.name&&console.error(t.message),[]})));case 6:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"sendPinCode",value:(a=E(w().mark((function t(){var e,r=this;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0===this.timer){t.next=2;break}return t.abrupt("return");case 2:return(e=new URLSearchParams).append("email",this.emailInputTarget.value),this.sendCodeButtonTarget.classList.add("tw-opacity-70"),this.sendCodeButtonTarget.innerText+="...",this.tryAgainLoadingTarget.classList.remove("tw-hidden"),this.tryAgainLoadingTarget.innerText="Sending...",t.abrupt("return",fetch(window.sc.sendPinCodeURL,{method:"POST",body:e,headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(t){r.pinCodeAreaTarget.classList.remove("tw-hidden"),r.sendCodeButtonTarget.classList.add("tw-hidden"),r.sendCodeButtonTarget.classList.remove("tw-opacity-70"),r.sendCodeButtonTarget.innerText.replace("...",""),r.emailInputTarget.classList.remove("invalid"),r.tryAgainLoadingTarget.classList.add("tw-hidden"),r.startTimer()})).catch((function(t){return"AbortError"!==t.name&&console.error(t.message),[]})));case 9:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"userTypeInputTargetConnected",value:function(t){var e=this;this.observers.userTypeInput||(this.observers.userTypeInput=new MutationObserver((function(t){t.forEach((function(t){"value"===t.attributeName&&(e.validateUserType(),e.validateStudentType(),e.formChangeHandler(),e.handleEmailLabel(t.target.value))}))})),this.observers.userTypeInput.observe(t,{attributes:!0}))}},{key:"userTypeInputTargetDisconnected",value:function(){this.observers.userTypeInput&&this.observers.userTypeInput.disconnect()}},{key:"studentTypeInputTargetConnected",value:function(t){var e=this;this.observers.studentTypeInput||(this.observers.studentTypeInput=new MutationObserver((function(t){t.forEach((function(t){"value"===t.attributeName&&(e.validateStudentType(),e.formChangeHandler())}))})),this.observers.studentTypeInput.observe(t,{attributes:!0}))}},{key:"studentTypeInputTargetDisconnected",value:function(){this.observers.studentTypeInput&&this.observers.studentTypeInput.disconnect()}},{key:"handleClassChange",value:function(t){var e=this;t.forEach((function(t){"class"===t.attributeName&&e.inputEmailHandler()}))}},{key:"handleEmailLabel",value:function(t){if("CURRENT"===t)return document.getElementById("userEmailLabel").innerText="University email address",void this.uniEmailTextContainerTarget.classList.remove("tw-hidden");this.uniEmailTextContainerTarget.classList.add("tw-hidden"),document.getElementById("userEmailLabel").innerText="Email address"}},{key:"validateUserType",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.userTypeInputTarget.value?this.userTypeInputTarget.classList.remove("invalid"):(this.userTypeInputTarget.classList.add("invalid"),t&&this.userTypeValidationMessageTargets.forEach((function(t){t.classList.remove("tw-hidden")})))}},{key:"validateStudentType",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.studentTypeInputTarget.value||["PARENT","OTHER"].includes(this.userTypeInputTarget.value)?this.studentTypeInputTarget.classList.remove("invalid"):(this.studentTypeInputTarget.classList.add("invalid"),t&&this.studentTypeValidationMessageTargets.forEach((function(t){t.classList.remove("tw-hidden")})))}},{key:"validateEmail",value:function(t,e,r){var i=new URLSearchParams;return i.append(e.name,e.value),i.append("validate_account_email",e.value),i.append("subject_id",this.reviewFormTarget.querySelector(".subject-id").value),i.append("current_student_type",r),i.append("subject_type",this.reviewFormTarget.dataset.scSubject),fetch(window.sc.validateEmailCheckURL,{method:"POST",body:i,headers:{"X-Requested-With":"XMLHttpRequest"},signal:t}).then((function(t){return t.json()})).catch((function(t){return"AbortError"!==t.name&&console.error(t.message),[]}))}},{key:"startTimer",value:function(){var t=this;this.timer=60;var e=setInterval((function(){t.timer--,t.tryAgainTimeTarget.innerText="in "+t.timer+" seconds",0===t.timer&&(t.tryAgainTimeTarget.innerText="",clearInterval(e))}),1e3)}},{key:"modalSubmit",value:function(){var t=this.submitFormTarget,e=t.value,r=this.formConfig||{beforeSubmit:function(){return!0}};t.disabled=!0,t.value=e+" ...";var i=this.reviewFormTarget.dataset.scSubject;if("undefined"!=typeof hj&&hj("tagRecording",["submit review",i]),!r.beforeSubmit(this.reviewFormTarget))return t.disabled=!1,void(t.value=e);(0,v.U)(JSON.parse(this.reviewFormTarget.dataset.track)),this.reviewFormTarget.submit()}},{key:"inputRadioHandler",value:function(t){var e=t.target;if(e.checkValidity()){this.starsContainerTarget.querySelectorAll("input:valid").length<=5&&(0,v.U)({event:"user_event",event_name:"user_event",user_event_type:"review_stars_started",user_type:this.userTypeInputTarget.value,student_type:this.studentTypeInputTarget.value,location:"review_something_flow",type:this.reviewFormTarget.dataset.scSubject});var r=e.parentElement.parentElement.querySelector(".requirements");r&&(r.style.display="none")}}},{key:"inputEmailHandler",value:(s=E(w().mark((function t(){var e,r,i,n,o,s,a,l;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.emailInputTarget,r=document.querySelector("[data-answer=CURRENT]"),e.checkValidity()){t.next=4;break}return t.abrupt("return");case 4:return window.controller&&window.controller.abort(),window.controller=new AbortController,i=!r.classList.contains("tw-hidden"),t.next=9,this.validateEmail(window.controller.signal,e,i);case 9:if(n=t.sent,o=n.map((function(t){return t.message})),(s=function(t){return n.filter((function(e){return e.code===t})).length>0})("email_already_exists")&&(0,v.U)({event:"user_event",event_name:"user_event",user_event_type:"review_email_validation_fail",user_type:this.userTypeInputTarget.value,student_type:this.studentTypeInputTarget.value,location:"review_something_flow"}),this.validateEmailPending=s("email_already_exists"),a=e.parentElement.querySelector(".domain-requirements"),!(void 0!==o&&o.length>0)){t.next=23;break}return l=o.join(", "),s("email_not_university")&&(l=n.filter((function(t){return"email_not_university"===t.code}))[0].message,e.focus()),e.classList.add("invalid"),a.innerHTML=l,a.classList.remove("tw-hidden"),s("email_already_exists")&&1===n.length&&this.sendCodeButtonTarget.classList.remove("tw-hidden"),t.abrupt("return");case 23:this.sendCodeButtonTarget.classList.add("tw-hidden"),this.pinCodeAreaTarget.classList.add("tw-hidden"),e.classList.remove("invalid"),a.classList.add("tw-hidden"),this.formChangeHandler();case 28:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"formChangeHandler",value:function(){var t=this.reviewFormTarget.querySelector(".invalid"),e=this.reviewFormTarget.checkValidity(),r=this.validateEmailOrLoggedIn();this.submitFormTarget.disabled=!(e&&!t&&r)}},{key:"submitHandler",value:(o=E(w().mark((function t(){var e,r,i,n,o,s,a,l=this;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.validateUserType(!0),this.validateStudentType(!0),t.next=4,this.validEmailHandler();case 4:if(e=this.submitFormTarget,r=this.reviewFormTarget.querySelectorAll(":invalid"),i=this.reviewFormTarget.querySelectorAll(".invalid"),n=this.validateEmailOrLoggedIn()?[]:[this.emailInputTarget],!((o=[].concat(b(r),b(i),n)).length>0)){t.next=16;break}return e.disabled=!0,s=o[0],o.forEach((function(t){"hidden"===t.type&&(s=l.element),"radio"===t.type&&(t=t.parentElement);var e=t.parentElement.querySelector("[class$=requirements]");e&&e.classList.remove("tw-hidden")})),a=s.getBoundingClientRect().top+window.scrollY,this.scrollToTop(a),t.abrupt("return");case 16:e.disabled=!1,this.modalSubmit();case 18:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"scrollToTop",value:function(t){window.scroll({top:t,behavior:"smooth"})}},{key:"subjectHandler",value:function(){""!==this.subjectIdTarget.value?(this.subjectInputTarget.classList.remove("invalid"),this.formChangeHandler()):this.subjectInputTarget.classList.add("invalid")}},{key:"inputHandler",value:function(t){var e=t.target,r=e.parentElement.querySelector(".requirements");return e.validity.valueMissing?(r.style.display="block",void(r.innerHTML="This field is required.")):e.validity.typeMismatch?(r.style.display="block",void(r.innerHTML="This field is invalid.")):void(r&&(r.style.display="none"))}},{key:"focusOutProsHandler",value:function(t){var e=t.target;void 0!==e.value&&e.checkValidity()&&(0,v.U)({event:"user_event",event_name:"user_event",user_event_type:"long_text_focusout",type:this.reviewFormTarget.dataset.scSubject,location:"review_something_flow"})}},{key:"validEmailHandler",value:(n=E(w().mark((function t(){var e,r,i,n,o;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=this.emailInputTarget,i=document.querySelector("[data-answer=CURRENT]"),r.checkValidity()){t.next=5;break}return t.abrupt("return");case 5:return window.controller&&window.controller.abort(),window.controller=new AbortController,n=!i.classList.contains("tw-hidden"),t.next=10,this.validateEmail(window.controller.signal,r,n);case 10:o=t.sent,this.validateEmailPending=o.length>0&&"email_already_exists"===(null===(e=o[0])||void 0===e?void 0:e.code),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),this.validateEmailPending=!1;case 17:case"end":return t.stop()}}),t,this,[[0,14]])}))),function(){return n.apply(this,arguments)})}],r&&S(e.prototype,r),i&&S(e,i),Object.defineProperty(e,"prototype",{writable:!1}),h}(i.xI);O(D,"targets",["reviewForm","submitForm","subjectId","subjectInput","emailInput","userTypeInput","studentTypeInput","userTypeValidationMessage","studentTypeValidationMessage","starsContainer","uniEmailTextContainer","universityEmailContainer","pinInput","sendCodeButton","pinCodeArea","universityEmail","tryAgainTime","tryAgainLoading"])},4280:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"toggle",value:function(t){var e=t.target,r=e.parentNode.nextSibling;t.preventDefault(),"none"===window.getComputedStyle(r).display?(e.innerText="read less",r.style.display="flex"):(e.innerText="read more",r.style.display="none")}},{key:"toggleReadMoreNewProfile",value:function(t){t.preventDefault();var e=t.target,r=this.moreTarget;r.classList.contains("tw-hidden")?(e.innerText="read less",r.classList.remove("tw-hidden")):(e.innerText="read more",r.classList.add("tw-hidden"))}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["more"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},8673:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"show",value:function(){this.signinButtonContainerTarget.remove(),this.universityEmailContainerTarget.remove(),this.signinFormContainerTarget.classList.remove("tw-hidden"),this.signinFormContainerTarget.querySelector('input[name="_username"]').required=!0,this.signinFormContainerTarget.querySelector('input[name="_password"]').required=!0}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["universityEmailContainer","signinButtonContainer","signinFormContainer"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},2397:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"connect",value:function(){var t=this;this.linkTargets.forEach((function(e){e.addEventListener("click",t.handleClick.bind(t))}))}},{key:"handleClick",value:function(t){t.preventDefault();var e=new URL(t.currentTarget.href),r=e.searchParams.get("page"),i="".concat(window.location.origin).concat(window.location.pathname.replace("/review",""),"/review?page=").concat(r);history.pushState({},"",i),Turbo.visit(e,{frame:"turbo-reviews"})}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["link"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},9655:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>y});var i=r(2891),n=r(6613);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,f(i.key),i)}}function l(t,e){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},l(t,e)}function c(t){var e=h();return function(){var r,i=d(t);if(e){var n=d(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return u(this,r)}}function u(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(h=function(){return!!t})()}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function p(t,e,r){return(e=f(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var m="all",g="asc",y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(u,t);var e,r,i,o=c(u);function u(){return s(this,u),o.apply(this,arguments)}return e=u,r=[{key:"connect",value:function(){var t=this;this.updateRoomTypeProfiles(),this.handleResize=function(){t.updateRoomTypeProfiles()},window.addEventListener("resize",this.handleResize)}},{key:"disconnect",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"onAcademicYearFilterChange",value:function(){this.updateRoomTypeProfiles(),this.filterRoomTypeOptions()}},{key:"onRoomTypeOptionFilterChange",value:function(){this.updateRoomTypeProfiles()}},{key:"onRoomSortByPriceChange",value:function(){this.updateRoomTypeProfiles()}},{key:"updateRoomTypeProfiles",value:function(){var t=this,e=this.academicYearFilterTarget.value,r=this.roomTypeOptionFilterTarget.value,i=this.calculateVisibleCountThreshold(),n=this.roomSortByPriceTarget.value||g;this.sortRoomTypesBy("roomTypeProfilePrice",n);var o=0,s=0;this.roomTypeProfileTargets.forEach((function(n){t.shouldProfileBeVisible(n,e,r)?(s++,o>=i&&!t.isExpanded()?n.classList.add("tw-hidden"):(n.classList.remove("tw-hidden"),o++)):n.classList.add("tw-hidden")})),this.showMoreButtonTarget.classList.toggle("tw-hidden",s<=i)}},{key:"shouldProfileBeVisible",value:function(t,e,r){var i=t.dataset.roomTypeProfileAcademicYear,n=t.dataset.roomTypeProfileArrangement;return(r===m||n===r)&&i===e}},{key:"calculateVisibleCountThreshold",value:function(){if(!(0,n.X)("md").matches||!this.hasProfilesContainerTarget||!this.hasRoomTypeProfileTarget)return 3;var t=this.profilesContainerTarget.clientWidth,e=parseInt(window.getComputedStyle(this.profilesContainerTarget).gap),r=0;if(this.roomTypeProfileTargets.forEach((function(t){r=Math.max(r,t.offsetWidth)})),!r||!t)return 3;var i=Math.floor(t/r);return i*(r+e)-e>t?i-1:i}},{key:"isExpanded",value:function(){return"Show Less"===this.showMoreButtonTextTarget.innerText}},{key:"filterRoomTypeOptions",value:function(){var t=this,e=this.academicYearFilterTarget.value,r=function(r){var i=t.shouldOptionBeVisible(r,e);r.classList.toggle("tw-hidden",!i),i&&r.value!==m&&r.selected&&(t.roomTypeOptionFilterTarget.value=r.value)};this.roomTypeOptionFilterTarget.querySelectorAll("option").forEach(r),this.roomTypeOptionFilterMobileTarget.querySelectorAll("option").forEach(r)}},{key:"sortRoomTypesBy",value:function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g,i=Array.from(this.roomTypeProfileTargets).sort((function(e,i){var n=e.dataset[t],o=i.dataset[t],s=e.dataset.roomTypeProfileAvailable;return s!==i.dataset.roomTypeProfileAvailable?s?-1:1:r===g?n-o:o-n})),n=null===(e=this.roomTypeProfileTargets[0])||void 0===e?void 0:e.parentElement;n&&i.forEach((function(t){return n.appendChild(t)}))}},{key:"shouldOptionBeVisible",value:function(t,e){return t.dataset.roomTypeProfileArrangementAcademicYear===e||t.value===m}},{key:"toggleRoomTypes",value:function(){this.updateShowMoreButtonText(),this.updateRoomTypeProfiles()}},{key:"updateShowMoreButtonText",value:function(){var t="Show Less",e="fa-caret-up";this.isExpanded()&&(t="Show More",e="fa-caret-down"),this.showMoreButtonTextTarget.innerText=t,this.showMoreButtonIconTarget&&(this.showMoreButtonIconTarget.classList.remove("fa-caret-up"),this.showMoreButtonIconTarget.classList.remove("fa-caret-down"),this.showMoreButtonIconTarget.classList.add(e))}},{key:"toggleMobileFilterOverlay",value:function(){this.filtersOverlayTarget.classList.toggle("tw-hidden")}},{key:"hideFiltersOverlay",value:function(){this.filtersOverlayTarget.classList.toggle("tw-hidden")}},{key:"onClearFilters",value:function(t){t.preventDefault(),this.academicYearFilterTarget.value=this.academicYearValue,this.roomTypeOptionFilterTarget.value=m,this.academicYearFilterMobileTarget.value=this.academicYearValue,this.roomTypeOptionFilterMobileTarget.value=m,this.updateRoomTypeProfiles(),this.hideFiltersOverlay()}},{key:"onSubmit",value:function(){this.academicYearFilterTarget.value=this.academicYearFilterMobileTarget.value,this.roomTypeOptionFilterTarget.value=this.roomTypeOptionFilterMobileTarget.value,this.roomSortByPriceTarget.value=this.roomSortByPriceMobileTarget.value,this.updateRoomTypeProfiles(),this.hideFiltersOverlay()}}],r&&a(e.prototype,r),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),u}(i.xI);p(y,"targets",["academicYearFilter","academicYearFilterMobile","roomTypeOptionFilter","roomTypeOptionFilterMobile","roomSortByPrice","roomSortByPriceMobile","roomTypeProfile","showMoreButton","showMoreButtonText","showMoreButtonIcon","filtersOverlay","profilesContainer"]),p(y,"values",{academicYear:String})},912:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>g});var i=r(2891),n=r(6613);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,d(i.key),i)}}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function l(t){var e=u();return function(){var r,i=h(t);if(e){var n=h(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return c(this,r)}}function c(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(u=function(){return!!t})()}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function d(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var p,f,m,g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(c,t);var e,r,i,o=l(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=o.call(this,t)).waitAndClearTimeout=null,e}return e=c,(r=[{key:"input",value:function(){this.formTarget.requestSubmit()}},{key:"submit",value:function(t){this.getQuery().length<2&&(t.preventDefault(),t.stopPropagation(),this.clearResults())}},{key:"blur",value:function(){this.resetWaitAndClear(),this.waitAndClear()}},{key:"resetWaitAndClear",value:function(){null!==this.waitAndClearTimeout&&(clearTimeout(this.waitAndClearTimeout),this.waitAndClearTimeout=null)}},{key:"waitAndClear",value:function(){var t=this;this.waitAndClearTimeout=setTimeout((function(){t.clearResults(),t.waitAndClearTimeout=null}),200)}},{key:"focus",value:function(){var t=this.getQuery();this.resetWaitAndClear(),0!==t.length||(0,n.X)("md").matches?this.formTarget.requestSubmit():this.formTarget.scrollIntoView({block:"start",behavior:"smooth"})}},{key:"keyDown",value:function(t){27===t.keyCode&&this.clearResults(),13===t.keyCode&&this.submitFirstResult()}},{key:"clearResults",value:function(){this.hasResultsTarget&&(this.resultsTarget.children.results.innerHTML="")}},{key:"submitFirstResult",value:function(){if(this.hasResultsTarget){var t=this.resultsTarget.getElementsByTagName("a");t.length&&void 0!==t[0].href&&(window.location.href=t[0].href)}}},{key:"getQuery",value:function(){if(this.hasFormTarget)return this.formTarget.elements.q.value.trim()}}])&&s(e.prototype,r),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(i.xI);p=g,m=["results","form"],(f=d(f="targets"))in p?Object.defineProperty(p,f,{value:m,enumerable:!0,configurable:!0,writable:!0}):p[f]=m},5664:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,d(i.key),i)}}function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function s(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return a(this,r)}}function a(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t,e,r){return(e=d(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>p});var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o(t,e)}(c,t);var e,r,i,a=s(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),h(l(e=a.call(this,t)),"tags",[]),h(l(e),"bindElement",null),e.waitAndClearTimeout=null,e}return e=c,(r=[{key:"connect",value:function(){var t=this,e=this.tagsTarget.dataset.selectedTags;e&&(this.tags=JSON.parse(e),this.tags=this.tags.filter((function(e){return t.tags.find((function(t){return Number.parseInt(t.value)===Number.parseInt(e.value)}))})),this.syncLabels()),addEventListener("turbo:submit-end",(function(e){e.target,setTimeout((function(){t.optionTargets.forEach((function(e){var r=t.tags.find((function(t){return t.value==e.value}));e.checked=!!r}))}),500)}))}},{key:"remove",value:function(t){var e=this,r=t.srcElement;"LI"!==r.nodeName&&(r=r.parentNode),this.tags=this.tags.filter((function(t){return t.value!==Number.parseInt(r.dataset.id)})),r.remove(),this.optionTargets.forEach((function(t){var r=e.tags.find((function(e){return e.value===Number.parseInt(t.value)}));t.checked=!!r})),this.syncInput()}},{key:"syncInput",value:function(){var t=this.tagsTarget.dataset.bindElementId,e=document.getElementById(t);e&&(e.value=this.tags.map((function(t){return t.value})).join(","))}},{key:"syncLabels",value:function(){var t=this;this.tagsTarget.innerHTML="",this.tags.forEach((function(e){var r=t.templateTarget.content.cloneNode(!0),i=r.childNodes.item(0);i.childNodes.item(0).textContent=e.name,i.setAttribute("data-id",e.value),t.tagsTarget.appendChild(r)}))}},{key:"toggle",value:function(t){var e=this.tags.findIndex((function(e){return e.value===Number.parseInt(t.target.value)}));-1===e?this.tags.push({value:Number.parseInt(t.target.value),name:t.target.dataset.display}):this.tags.splice(e,1),this.syncLabels(),this.syncInput()}},{key:"input",value:function(){this.formTarget.requestSubmit()}},{key:"submit",value:function(t){this.getQuery().length<1&&(t.preventDefault(),t.stopPropagation(),this.clearResults())}},{key:"blur",value:function(){this.resetWaitAndClear(),this.waitAndClear()}},{key:"resetWaitAndClear",value:function(){null!==this.waitAndClearTimeout&&(clearTimeout(this.waitAndClearTimeout),this.waitAndClearTimeout=null)}},{key:"waitAndClear",value:function(){var t=this;this.waitAndClearTimeout=setTimeout((function(){t.clearResults(),t.waitAndClearTimeout=null}),200)}},{key:"focus",value:function(){this.resetWaitAndClear(),this.formTarget.requestSubmit()}},{key:"keyDown",value:function(t){27===t.keyCode&&this.clearResults(),13===t.keyCode&&this.submitFirstResult()}},{key:"clearResults",value:function(){this.hasSelectBoxResult&&(this.selectBoxResult.children["selected-box-results"].innerHTML="")}},{key:"submitFirstResult",value:function(){if(this.hasSelectBoxResult){var t=this.selectBoxResult.getElementsByTagName("a");t.length&&void 0!==t[0].href&&(window.location.href=t[0].href)}}},{key:"getQuery",value:function(){if(this.hasFormTarget)return this.formTarget.elements.q.value.trim()}}])&&n(e.prototype,r),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);h(p,"targets",["results","form","option","tags","template","bindElement"])},2843:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,d(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t,e,r){return(e=d(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>p});var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"connect",value:function(){var t=this,e={CURRENT:[this.startYearTarget,this.currentYearTarget,this.countryTarget,this.uniEmailTarget],PROSPECTIVE:[this.countryTarget,this.plannedStartYearTarget],GRADUATE:[this.countryTarget],PARENT:[this.countryTarget,this.plannedStartYearTarget],OTHER:[this.countryTarget]},r={PARENT:"Student’s year of entry",PROSPECTIVE:"Student’s year of entry"},i=[this.startYearTarget,this.currentYearTarget,this.countryTarget,this.plannedStartYearTarget,this.uniEmailTarget];i.forEach((function(t){t.removeAttribute("required")})),this.userTypeTarget.value&&e[this.userTypeTarget.value].forEach((function(e){"sc_student_type_uniEmail"===e.getAttribute("id")?e.parentElement.classList.remove("!tw-hidden"):e.classList.remove("!tw-hidden"),"sc_student_type_plannedStartYear"===e.getAttribute("id")&&(e.options[0].innerText=r[t.userTypeTarget.value]),e.setAttribute("required","required")})),this.userTypeTarget.addEventListener("change",(function(n){i.forEach((function(t){"sc_student_type_uniEmail"===t.getAttribute("id")?t.parentElement.classList.add("!tw-hidden"):t.classList.add("!tw-hidden"),t.removeAttribute("required")})),n.target.value&&e[n.target.value].forEach((function(e){"sc_student_type_uniEmail"===e.getAttribute("id")?e.parentElement.classList.remove("!tw-hidden"):e.classList.remove("!tw-hidden"),"sc_student_type_plannedStartYear"===e.getAttribute("id")&&(e.options[0].innerText=r[t.userTypeTarget.value]),e.setAttribute("required","required")}))}))}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);h(p,"values",{basePath:String}),h(p,"targets",["userType","startYear","currentYear","country","plannedStartYear","uniEmail"])},8367:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(){n=function(){return e};var t,e={},r=Object.prototype,o=r.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function d(t,e,r,i){var n=e&&e.prototype instanceof v?e:v,o=Object.create(n.prototype),a=new I(i||[]);return s(o,"_invoke",{value:k(t,r,a)}),o}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var f="suspendedStart",m="executing",g="completed",y={};function v(){}function _(){}function b(){}var x={};h(x,l,(function(){return this}));var w=Object.getPrototypeOf,T=w&&w(w(O([])));T&&T!==r&&o.call(T,l)&&(x=T);var E=b.prototype=v.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,s,a,l){var c=p(t[n],t,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==i(h)&&o.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,l)}),(function(t){r("throw",t,a,l)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,l)}))}l(c.arg)}var n;s(this,"_invoke",{value:function(t,i){function o(){return new e((function(e,n){r(t,i,e,n)}))}return n=n?n.then(o,o):o()}})}function k(e,r,i){var n=f;return function(o,s){if(n===m)throw Error("Generator is already running");if(n===g){if("throw"===o)throw s;return{value:t,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var l=A(a,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===f)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=m;var c=p(e,r,i);if("normal"===c.type){if(n=i.done?g:"suspendedYield",c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n=g,i.method="throw",i.arg=c.arg)}}}function A(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=p(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function r(){for(;++n<e.length;)if(o.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,s(E,"constructor",{value:b,configurable:!0}),s(b,"constructor",{value:_,configurable:!0}),_.displayName=h(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,h(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(P.prototype),h(P.prototype,c,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new P(d(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),h(E,u,"Generator"),h(E,l,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(i,n){return a.type="throw",a.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=o.call(s,"catchLoc"),c=o.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var n=i;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var s=n?n.completion:{};return s.type=t,s.arg=e,n?(this.method="next",this.next=n.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;C(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:O(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function o(t,e,r,i,n,o,s){try{var a=t[o](s),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(i,n)}function s(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,f(i.key),i)}}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function l(t){var e=h();return function(){var r,i=d(t);if(e){var n=d(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return c(this,r)}}function c(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(h=function(){return!!t})()}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function p(t,e,r){return(e=f(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,t);var e,r,i,c,h,d=l(f);function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),p(u(e=d.call(this,t)),"onMoveMin",(function(t){var r=e.state,i=r.minPercentage,n=r.currentMinPercentage,o=r.currentMaxPercentage,s=r.minValueBetween,a=r.velocity,l=e.pxToPercentage(t)*a+n;l<i&&(l=0),l>100-o-e.pxToPercentage(s)&&(l=100-o-e.pxToPercentage(s));var c=Math.round(l*(e.maxValue-e.minValue)/100)+e.minValue;e.state.currentMinPercentage=l,e.sliderTarget.style.paddingLeft=l+"%",e.updatePriceInput(e.minPriceInputTarget,c),e.updatePriceBox(e.minPriceBoxTarget,c)})),p(u(e),"onMouseMoveMin",(function(t){t.preventDefault(),e.onMoveMin(t.movementX)})),p(u(e),"onMouseUpMin",(function(){document.removeEventListener("mousemove",e.onMouseMoveMin),document.removeEventListener("mouseup",e.onMouseUpMin)})),p(u(e),"onTouchMoveMin",(function(t){t.preventDefault(),e.onMoveMin(t.touches[0].pageX-e.touchX),e.touchX=t.touches[0].pageX})),p(u(e),"onTouchEndMin",(function(){document.removeEventListener("touchmove",e.onTouchMoveMin),document.removeEventListener("touchend",e.onTouchEndMin),document.removeEventListener("touchcancel",e.onTouchEndMin),e.touchX=null})),p(u(e),"onMoveMax",(function(t){var r=e.state,i=r.currentMinPercentage,n=r.currentMaxPercentage,o=r.minValueBetween,s=r.velocity,a=-1*e.pxToPercentage(t)*s+n;a<0&&(a=0),a>100-i-e.pxToPercentage(o)&&(a=100-i-e.pxToPercentage(o));var l=e.maxValue-Math.round(a*(e.maxValue-e.minValue)/100);e.sliderTarget.style.paddingRight=a+"%",e.state.currentMaxPercentage=a,e.updatePriceInput(e.maxPriceInputTarget,l),e.updatePriceBox(e.maxPriceBoxTarget,l)})),p(u(e),"onMouseMoveMax",(function(t){t.preventDefault(),e.onMoveMax(t.movementX)})),p(u(e),"onMouseUpMax",(function(){document.removeEventListener("mousemove",e.onMouseMoveMax),document.removeEventListener("mouseup",e.onMouseUpMax)})),p(u(e),"onTouchMoveMax",(function(t){t.preventDefault(),e.onMoveMax(t.touches[0].pageX-e.touchX),e.touchX=t.touches[0].pageX})),p(u(e),"onTouchEndMax",(function(){document.removeEventListener("touchmove",e.onTouchMoveMax),document.removeEventListener("touchend",e.onTouchEndMax),document.removeEventListener("touchcancel",e.onTouchEndMax),e.touchX=null})),e.touchX=null,e.state={paddingLeft:0,paddingRight:0,minPercentage:0,maxPercentage:100,minValueBetween:40,currentMinPercentage:0,currentMaxPercentage:0,velocity:1},e}return e=f,r=[{key:"initialize",value:(c=n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.updatePaddingFromValues(0,this.maxPriceInputTarget.value),this.updatePriceBox(this.minPriceBoxTarget,this.minPriceInputTarget.value),this.updatePriceBox(this.maxPriceBoxTarget,this.maxPriceInputTarget.value);case 3:case"end":return t.stop()}}),t,this)})),h=function(){var t=this,e=arguments;return new Promise((function(r,i){var n=c.apply(t,e);function s(t){o(n,r,i,s,a,"next",t)}function a(t){o(n,r,i,s,a,"throw",t)}s(void 0)}))},function(){return h.apply(this,arguments)})},{key:"onMinPriceChange",value:function(t){var e=isNaN(t.target.value)?this.minValue:parseInt(t.target.value);this.updatePriceBox(this.minPriceBoxTarget,e),this.updatePaddingFromValues(e,this.maxPriceInputTarget.value)}},{key:"onMinPriceReset",value:function(){this.updatePriceBox(this.minPriceBoxTarget,this.minValue),this.updatePaddingLeftFromMin(this.minValue)}},{key:"onMaxPriceChange",value:function(t){var e=isNaN(t.target.value)?this.maxValue:parseInt(t.target.value);this.updatePriceBox(this.maxPriceBoxTarget,e),this.updatePaddingFromValues(this.minPriceInputTarget.value,e)}},{key:"onMaxPriceReset",value:function(){this.updatePriceBox(this.maxPriceBoxTarget,this.maxValue),this.updatePaddingRightFromMax(this.maxValue)}},{key:"updatePaddingFromValues",value:function(t,e){this.updatePaddingLeftFromMin(t),this.updatePaddingRightFromMax(e)}},{key:"updatePaddingLeftFromMin",value:function(t){this.state.currentMinPercentage=100*(t-this.minValue)/(this.maxValue-this.minValue),this.sliderTarget.style.paddingLeft=this.state.currentMinPercentage+"%"}},{key:"updatePaddingRightFromMax",value:function(t){this.state.currentMaxPercentage=100-100*t/this.maxValue,this.sliderTarget.style.paddingRight=this.state.currentMaxPercentage+"%"}},{key:"updatePriceBox",value:function(t,e){t.innerHTML="&pound;".concat(e)}},{key:"updatePriceInput",value:function(t,e){t.value=e}},{key:"pxToPercentage",value:function(t){return 100*t/this.sliderTarget.offsetWidth}},{key:"onMouseDownMin",value:function(t){t.preventDefault(),document.addEventListener("mousemove",this.onMouseMoveMin),document.addEventListener("mouseup",this.onMouseUpMin)}},{key:"onTouchStartMin",value:function(t){t.preventDefault(),this.touchX=t.targetTouches[0].pageX,document.addEventListener("touchmove",this.onTouchMoveMin),document.addEventListener("touchend",this.onTouchEndMin),document.addEventListener("touchcancel",this.onTouchEndMin)}},{key:"onMouseDownMax",value:function(t){t.preventDefault(),document.addEventListener("mousemove",this.onMouseMoveMax),document.addEventListener("mouseup",this.onMouseUpMax)}},{key:"onTouchStartMax",value:function(t){t.preventDefault(),this.touchX=t.targetTouches[0].pageX,document.addEventListener("touchmove",this.onTouchMoveMax),document.addEventListener("touchend",this.onTouchEndMax),document.addEventListener("touchcancel",this.onTouchEndMax)}}],r&&s(e.prototype,r),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),f}(r(2891).xI);p(m,"targets",["slider","minPriceBox","maxPriceBox","minPriceInput","maxPriceInput"]),p(m,"values",{min:Number,max:Number})},969:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>v});var i=r(2891),n=r(8020);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(){s=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function d(t,e,r,i){var o=e&&e.prototype instanceof v?e:v,s=Object.create(o.prototype),a=new I(i||[]);return n(s,"_invoke",{value:k(t,r,a)}),s}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var f="suspendedStart",m="executing",g="completed",y={};function v(){}function _(){}function b(){}var x={};h(x,l,(function(){return this}));var w=Object.getPrototypeOf,T=w&&w(w(O([])));T&&T!==r&&i.call(T,l)&&(x=T);var E=b.prototype=v.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,s,a,l){var c=p(t[n],t,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==o(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,l)}),(function(t){r("throw",t,a,l)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,l)}))}l(c.arg)}var s;n(this,"_invoke",{value:function(t,i){function n(){return new e((function(e,n){r(t,i,e,n)}))}return s=s?s.then(n,n):n()}})}function k(e,r,i){var n=f;return function(o,s){if(n===m)throw Error("Generator is already running");if(n===g){if("throw"===o)throw s;return{value:t,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var l=A(a,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===f)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=m;var c=p(e,r,i);if("normal"===c.type){if(n=i.done?g:"suspendedYield",c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n=g,i.method="throw",i.arg=c.arg)}}}function A(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=p(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(o(e)+" is not iterable")}return _.prototype=b,n(E,"constructor",{value:b,configurable:!0}),n(b,"constructor",{value:_,configurable:!0}),_.displayName=h(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,h(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(P.prototype),h(P.prototype,c,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new P(d(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),h(E,u,"Generator"),h(E,l,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return a.type="throw",a.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;C(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:O(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function a(t,e,r,i,n,o,s){try{var a=t[o](s),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(i,n)}function l(t){return function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function s(t){a(o,i,n,s,l,"next",t)}function l(t){a(o,i,n,s,l,"throw",t)}s(void 0)}))}}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,y(i.key),i)}}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}function d(t){var e=f();return function(){var r,i=m(t);if(e){var n=m(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return p(this,r)}}function p(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function f(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(f=function(){return!!t})()}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}function g(t,e,r){return(e=y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(f,t);var e,r,i,o,a,p=d(f);function f(){return c(this,f),p.apply(this,arguments)}return e=f,r=[{key:"initialize",value:(a=l(s().mark((function t(){var e,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.selectedTarget.value&&this.selectedTarget.value.length>0)){t.next=10;break}return t.next=3,fetch(this.getSearchUrl("id",this.selectedTarget.value,this.typeValue,null));case 3:return e=t.sent,t.next=6,e.text();case 6:this.resultsTarget.innerHTML=t.sent,""!==(r=this.resultsTarget.getElementsByTagName("li")[0]).dataset.resultParentId&&this.setParentValues(r),this.setValues(r.dataset.resultValue,r.dataset.resultText);case 10:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"setParentValues",value:function(t){var e=document.getElementById("parent-id"),r=document.getElementById("parent-text");e.value=t.dataset.resultParentId,r.value=t.dataset.resultParentName}},{key:"search",value:(o=l(s().mark((function t(e){var r,i,n,o,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==this.abortController&&this.abortController.abort(),!(this.inputTarget.value.length<3)){t.next=4;break}return this.clearResults(),t.abrupt("return");case 4:return r=e.params,i=r.hasParent,n=r.optional,o=null,i&&document.getElementById("parent-id").value>0&&(o=document.getElementById("parent-id").value),this.abortController=new AbortController,t.prev=8,t.next=11,fetch(this.getSearchUrl("q",this.inputTarget.value,this.typeValue,o,n),{signal:this.abortController.signal});case 11:return a=t.sent,t.next=14,a.text();case 14:this.resultsTarget.innerHTML=t.sent,t.next=19;break;case 17:t.prev=17,t.t0=t.catch(8);case 19:case"end":return t.stop()}}),t,this,[[8,17]])}))),function(t){return o.apply(this,arguments)})},{key:"getSearchUrl",value:function(t,e,r,i,n){var o=new URLSearchParams;return o.set(t,e),o.set("type",r),i&&o.set("parent",i),n&&o.set("optional",n),"".concat(this.urlValue,"?").concat(o.toString())}},{key:"selectResult",value:function(t){var e=t.target.closest("li");this.setValues(e.dataset.resultValue,e.dataset.resultText),(0,n.U)({event:"user_event",event_name:"user_event",user_event_type:"subject_selected",type:this.typeValue,location:"review_something_flow"})}},{key:"setValues",value:function(t,e){this.inputTarget.value=e,this.selectedTarget.value=t,this.fireChangeEvent(),this.clearResults()}},{key:"fireChangeEvent",value:function(){var t=new Event("subject-selected");this.inputTarget.dispatchEvent(t),this.selectedTarget.dispatchEvent(t)}},{key:"clearResults",value:function(){this.resultsTarget.innerHTML=""}},{key:"clearSubject",value:function(){var t=document.querySelector(".subject-id"),e=document.getElementById("subject-text");t.value="",e.value=""}}],r&&u(e.prototype,r),i&&u(e,i),Object.defineProperty(e,"prototype",{writable:!1}),f}(i.xI);g(v,"targets",["input","results","selected"]),g(v,"values",{url:String,type:String})},807:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"connect",value:function(){var t=this;this.formTarget.addEventListener("submit",(function(){t.disableButtons()}))}},{key:"disableButtons",value:function(){this.submitButtonTarget.disabled=!0,this.submitButtonTarget.style.cursor="default",this.submitButtonTarget.style.opacity=.5}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["submitButton","form"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},1641:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,d(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t,e,r){return(e=d(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>p});var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"connect",value:function(){this.toastTarget.classList.add("tw-hidden"),document.addEventListener("toast:show",this.show.bind(this))}},{key:"show",value:function(t){this.indexIdValue=t.detail.indexId,this.isMobileValue=t.detail.isMobile,this.setMessage(t),this.hasMyAccount(t),this.setUndo(t),this.toastTarget.classList.remove("tw-hidden"),this.toastTarget.classList.add("tw-flex","tw-animate-fadeIn"),this.resetHideTimer(),this.toastTarget.addEventListener("click",this.resetHideTimer.bind(this))}},{key:"hide",value:function(){var t=this;this.toastTarget.classList.remove("tw-animate-fadeIn","tw-hidden"),this.toastTarget.classList.add("tw-animate-fadeOut"),this.toastTarget.addEventListener("animationend",(function e(){t.toastTarget.classList.add("tw-hidden"),t.toastTarget.classList.remove("tw-animate-fadeOut"),t.toastTarget.removeEventListener("animationend",e)}))}},{key:"hasMyAccount",value:function(t){var e,r;t.detail.account?(this.accountTarget.textContent=(null===(e=t.detail.account)||void 0===e?void 0:e.text)||"",this.accountTarget.href=(null===(r=t.detail.account)||void 0===r?void 0:r.url)||"#"):(this.accountTarget.classList.remove("tw-block"),this.accountTarget.classList.add("tw-hidden"))}},{key:"setMessage",value:function(t){var e=this.messageTarget.childNodes[0];e.nodeType===Node.TEXT_NODE&&(e.textContent=t.detail.message||"")}},{key:"setUndo",value:function(t){var e=this;if(t.detail.undoEventName){var r=new CustomEvent(t.detail.undoEventName,{detail:{indexId:this.indexIdValue,isMobile:this.isMobileValue}}),i=function t(){document.dispatchEvent(r),e.undoTarget.removeEventListener("click",t),e.undoTarget.hasEventListener=!1};this.undoTarget.hasEventListener&&this.undoTarget.removeEventListener("click",this.undoTarget.undoHandler),this.undoTarget.addEventListener("click",i),this.undoTarget.hasEventListener=!0,this.undoTarget.undoHandler=i}}},{key:"resetHideTimer",value:function(){var t=this;this.hideTimeout&&clearTimeout(this.hideTimeout),this.hideTimeout=setTimeout((function(){t.hide()}),1e4)}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);h(p,"targets",["toast","message","account","undo"]),h(p,"values",{indexId:String,isMobile:Boolean})},2728:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,r=[{key:"toggle",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null!==r)return r?(this.iconTimesTarget.classList.remove("tw-hidden"),this.iconCheckTarget.classList.add("tw-hidden"),this.translateTarget.classList.remove("tw-translate-x-5"),this.translateTarget.classList.add("tw-translate-x-0"),this.buttonTarget.classList.remove("tw-bg-[#44BFB6]"),this.buttonTarget.classList.add("tw-bg-[#B6BBC1]")):(this.iconTimesTarget.classList.add("tw-hidden"),this.iconCheckTarget.classList.remove("tw-hidden"),this.translateTarget.classList.add("tw-translate-x-5"),this.translateTarget.classList.remove("tw-translate-x-0"),this.buttonTarget.classList.add("tw-bg-[#44BFB6]"),this.buttonTarget.classList.remove("tw-bg-[#B6BBC1]")),void(this.checkboxTarget.checked=!r);this.checkboxTarget.checked=!this.checkboxTarget.checked,this.iconCheckTarget.classList.toggle("tw-hidden"),this.iconTimesTarget.classList.toggle("tw-hidden"),this.translateTarget.classList.toggle("tw-translate-x-5"),this.translateTarget.classList.toggle("tw-translate-x-0"),this.buttonTarget.classList.toggle("tw-bg-[#44BFB6]"),this.buttonTarget.classList.toggle("tw-bg-[#B6BBC1]"),e&&this.dispatch("toggle",{detail:{content:this.buttonTarget}})}},{key:"control",value:function(){this.dispatch("toggleOpacity",{detail:{content:this.buttonTarget}})}},{key:"toggleOpacity",value:function(t,e){e?this.element.classList.add("tw-opacity-10"):this.element.classList.remove("tw-opacity-10")}}],r&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["button","checkbox","translate","iconCheck","iconTimes"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},3046:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>Rt});var i=r(2891);const n=Math.min,o=Math.max,s=Math.round,a=(Math.floor,t=>({x:t,y:t})),l={left:"right",right:"left",bottom:"top",top:"bottom"},c={start:"end",end:"start"};function u(t,e,r){return o(t,n(e,r))}function h(t,e){return"function"==typeof t?t(e):t}function d(t){return t.split("-")[0]}function p(t){return t.split("-")[1]}function f(t){return"x"===t?"y":"x"}function m(t){return"y"===t?"height":"width"}const g=new Set(["top","bottom"]);function y(t){return g.has(d(t))?"y":"x"}function v(t){return f(y(t))}function _(t){return t.replace(/start|end/g,(t=>c[t]))}const b=["left","right"],x=["right","left"],w=["top","bottom"],T=["bottom","top"];function E(t,e,r,i){const n=p(t);let o=function(t,e,r){switch(t){case"top":case"bottom":return r?e?x:b:e?b:x;case"left":case"right":return e?w:T;default:return[]}}(d(t),"start"===r,i);return n&&(o=o.map((t=>t+"-"+n)),e&&(o=o.concat(o.map(_)))),o}function S(t){return t.replace(/left|right|bottom|top/g,(t=>l[t]))}function P(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function k(t){const{x:e,y:r,width:i,height:n}=t;return{width:i,height:n,top:r,left:e,right:e+i,bottom:r+n,x:e,y:r}}function A(t,e,r){let{reference:i,floating:n}=t;const o=y(e),s=v(e),a=m(s),l=d(e),c="y"===o,u=i.x+i.width/2-n.width/2,h=i.y+i.height/2-n.height/2,f=i[a]/2-n[a]/2;let g;switch(l){case"top":g={x:u,y:i.y-n.height};break;case"bottom":g={x:u,y:i.y+i.height};break;case"right":g={x:i.x+i.width,y:h};break;case"left":g={x:i.x-n.width,y:h};break;default:g={x:i.x,y:i.y}}switch(p(e)){case"start":g[s]-=f*(r&&c?-1:1);break;case"end":g[s]+=f*(r&&c?-1:1)}return g}async function M(t,e){var r;void 0===e&&(e={});const{x:i,y:n,platform:o,rects:s,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:p=!1,padding:f=0}=h(e,t),m=P(f),g=a[p?"floating"===d?"reference":"floating":d],y=k(await o.getClippingRect({element:null==(r=await(null==o.isElement?void 0:o.isElement(g)))||r?g:g.contextElement||await(null==o.getDocumentElement?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),v="floating"===d?{x:i,y:n,width:s.floating.width,height:s.floating.height}:s.reference,_=await(null==o.getOffsetParent?void 0:o.getOffsetParent(a.floating)),b=await(null==o.isElement?void 0:o.isElement(_))&&await(null==o.getScale?void 0:o.getScale(_))||{x:1,y:1},x=k(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:v,offsetParent:_,strategy:l}):v);return{top:(y.top-x.top+m.top)/b.y,bottom:(x.bottom-y.bottom+m.bottom)/b.y,left:(y.left-x.left+m.left)/b.x,right:(x.right-y.right+m.right)/b.x}}const C=new Set(["left","top"]);function I(){return"undefined"!=typeof window}function O(t){return R(t)?(t.nodeName||"").toLowerCase():"#document"}function L(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function D(t){var e;return null==(e=(R(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function R(t){return!!I()&&(t instanceof Node||t instanceof L(t).Node)}function F(t){return!!I()&&(t instanceof Element||t instanceof L(t).Element)}function B(t){return!!I()&&(t instanceof HTMLElement||t instanceof L(t).HTMLElement)}function z(t){return!(!I()||"undefined"==typeof ShadowRoot)&&(t instanceof ShadowRoot||t instanceof L(t).ShadowRoot)}const j=new Set(["inline","contents"]);function N(t){const{overflow:e,overflowX:r,overflowY:i,display:n}=J(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+r)&&!j.has(n)}const V=new Set(["table","td","th"]);function U(t){return V.has(O(t))}const $=[":popover-open",":modal"];function G(t){return $.some((e=>{try{return t.matches(e)}catch(t){return!1}}))}const H=["transform","translate","scale","rotate","perspective"],q=["transform","translate","scale","rotate","perspective","filter"],W=["paint","layout","strict","content"];function Z(t){const e=X(),r=F(t)?J(t):t;return H.some((t=>!!r[t]&&"none"!==r[t]))||!!r.containerType&&"normal"!==r.containerType||!e&&!!r.backdropFilter&&"none"!==r.backdropFilter||!e&&!!r.filter&&"none"!==r.filter||q.some((t=>(r.willChange||"").includes(t)))||W.some((t=>(r.contain||"").includes(t)))}function X(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const Y=new Set(["html","body","#document"]);function K(t){return Y.has(O(t))}function J(t){return L(t).getComputedStyle(t)}function Q(t){return F(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function tt(t){if("html"===O(t))return t;const e=t.assignedSlot||t.parentNode||z(t)&&t.host||D(t);return z(e)?e.host:e}function et(t){const e=tt(t);return K(e)?t.ownerDocument?t.ownerDocument.body:t.body:B(e)&&N(e)?e:et(e)}function rt(t,e,r){var i;void 0===e&&(e=[]),void 0===r&&(r=!0);const n=et(t),o=n===(null==(i=t.ownerDocument)?void 0:i.body),s=L(n);if(o){const t=it(s);return e.concat(s,s.visualViewport||[],N(n)?n:[],t&&r?rt(t):[])}return e.concat(n,rt(n,[],r))}function it(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function nt(t){const e=J(t);let r=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const n=B(t),o=n?t.offsetWidth:r,a=n?t.offsetHeight:i,l=s(r)!==o||s(i)!==a;return l&&(r=o,i=a),{width:r,height:i,$:l}}function ot(t){return F(t)?t:t.contextElement}function st(t){const e=ot(t);if(!B(e))return a(1);const r=e.getBoundingClientRect(),{width:i,height:n,$:o}=nt(e);let l=(o?s(r.width):r.width)/i,c=(o?s(r.height):r.height)/n;return l&&Number.isFinite(l)||(l=1),c&&Number.isFinite(c)||(c=1),{x:l,y:c}}const at=a(0);function lt(t){const e=L(t);return X()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:at}function ct(t,e,r,i){void 0===e&&(e=!1),void 0===r&&(r=!1);const n=t.getBoundingClientRect(),o=ot(t);let s=a(1);e&&(i?F(i)&&(s=st(i)):s=st(t));const l=function(t,e,r){return void 0===e&&(e=!1),!(!r||e&&r!==L(t))&&e}(o,r,i)?lt(o):a(0);let c=(n.left+l.x)/s.x,u=(n.top+l.y)/s.y,h=n.width/s.x,d=n.height/s.y;if(o){const t=L(o),e=i&&F(i)?L(i):i;let r=t,n=it(r);for(;n&&i&&e!==r;){const t=st(n),e=n.getBoundingClientRect(),i=J(n),o=e.left+(n.clientLeft+parseFloat(i.paddingLeft))*t.x,s=e.top+(n.clientTop+parseFloat(i.paddingTop))*t.y;c*=t.x,u*=t.y,h*=t.x,d*=t.y,c+=o,u+=s,r=L(n),n=it(r)}}return k({width:h,height:d,x:c,y:u})}function ut(t,e){const r=Q(t).scrollLeft;return e?e.left+r:ct(D(t)).left+r}function ht(t,e){const r=t.getBoundingClientRect();return{x:r.left+e.scrollLeft-ut(t,r),y:r.top+e.scrollTop}}const dt=new Set(["absolute","fixed"]);function pt(t,e,r){let i;if("viewport"===e)i=function(t,e){const r=L(t),i=D(t),n=r.visualViewport;let o=i.clientWidth,s=i.clientHeight,a=0,l=0;if(n){o=n.width,s=n.height;const t=X();(!t||t&&"fixed"===e)&&(a=n.offsetLeft,l=n.offsetTop)}const c=ut(i);if(c<=0){const t=i.ownerDocument,e=t.body,r=getComputedStyle(e),n="CSS1Compat"===t.compatMode&&parseFloat(r.marginLeft)+parseFloat(r.marginRight)||0,s=Math.abs(i.clientWidth-e.clientWidth-n);s<=25&&(o-=s)}else c<=25&&(o+=c);return{width:o,height:s,x:a,y:l}}(t,r);else if("document"===e)i=function(t){const e=D(t),r=Q(t),i=t.ownerDocument.body,n=o(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),s=o(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let a=-r.scrollLeft+ut(t);const l=-r.scrollTop;return"rtl"===J(i).direction&&(a+=o(e.clientWidth,i.clientWidth)-n),{width:n,height:s,x:a,y:l}}(D(t));else if(F(e))i=function(t,e){const r=ct(t,!0,"fixed"===e),i=r.top+t.clientTop,n=r.left+t.clientLeft,o=B(t)?st(t):a(1);return{width:t.clientWidth*o.x,height:t.clientHeight*o.y,x:n*o.x,y:i*o.y}}(e,r);else{const r=lt(t);i={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return k(i)}function ft(t,e){const r=tt(t);return!(r===e||!F(r)||K(r))&&("fixed"===J(r).position||ft(r,e))}function mt(t,e,r){const i=B(e),n=D(e),o="fixed"===r,s=ct(t,!0,o,e);let l={scrollLeft:0,scrollTop:0};const c=a(0);function u(){c.x=ut(n)}if(i||!i&&!o)if(("body"!==O(e)||N(n))&&(l=Q(e)),i){const t=ct(e,!0,o,e);c.x=t.x+e.clientLeft,c.y=t.y+e.clientTop}else n&&u();o&&!i&&n&&u();const h=!n||i||o?a(0):ht(n,l);return{x:s.left+l.scrollLeft-c.x-h.x,y:s.top+l.scrollTop-c.y-h.y,width:s.width,height:s.height}}function gt(t){return"static"===J(t).position}function yt(t,e){if(!B(t)||"fixed"===J(t).position)return null;if(e)return e(t);let r=t.offsetParent;return D(t)===r&&(r=r.ownerDocument.body),r}function vt(t,e){const r=L(t);if(G(t))return r;if(!B(t)){let e=tt(t);for(;e&&!K(e);){if(F(e)&&!gt(e))return e;e=tt(e)}return r}let i=yt(t,e);for(;i&&U(i)&&gt(i);)i=yt(i,e);return i&&K(i)&&gt(i)&&!Z(i)?r:i||function(t){let e=tt(t);for(;B(e)&&!K(e);){if(Z(e))return e;if(G(e))return null;e=tt(e)}return null}(t)||r}const _t={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{elements:e,rect:r,offsetParent:i,strategy:n}=t;const o="fixed"===n,s=D(i),l=!!e&&G(e.floating);if(i===s||l&&o)return r;let c={scrollLeft:0,scrollTop:0},u=a(1);const h=a(0),d=B(i);if((d||!d&&!o)&&(("body"!==O(i)||N(s))&&(c=Q(i)),B(i))){const t=ct(i);u=st(i),h.x=t.x+i.clientLeft,h.y=t.y+i.clientTop}const p=!s||d||o?a(0):ht(s,c);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-c.scrollLeft*u.x+h.x+p.x,y:r.y*u.y-c.scrollTop*u.y+h.y+p.y}},getDocumentElement:D,getClippingRect:function(t){let{element:e,boundary:r,rootBoundary:i,strategy:s}=t;const a="clippingAncestors"===r?G(e)?[]:function(t,e){const r=e.get(t);if(r)return r;let i=rt(t,[],!1).filter((t=>F(t)&&"body"!==O(t))),n=null;const o="fixed"===J(t).position;let s=o?tt(t):t;for(;F(s)&&!K(s);){const e=J(s),r=Z(s);r||"fixed"!==e.position||(n=null),(o?!r&&!n:!r&&"static"===e.position&&n&&dt.has(n.position)||N(s)&&!r&&ft(t,s))?i=i.filter((t=>t!==s)):n=e,s=tt(s)}return e.set(t,i),i}(e,this._c):[].concat(r),l=[...a,i],c=l[0],u=l.reduce(((t,r)=>{const i=pt(e,r,s);return t.top=o(i.top,t.top),t.right=n(i.right,t.right),t.bottom=n(i.bottom,t.bottom),t.left=o(i.left,t.left),t}),pt(e,c,s));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}},getOffsetParent:vt,getElementRects:async function(t){const e=this.getOffsetParent||vt,r=this.getDimensions,i=await r(t.floating);return{reference:mt(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}},getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){const{width:e,height:r}=nt(t);return{width:e,height:r}},getScale:st,isElement:F,isRTL:function(t){return"rtl"===J(t).direction}};const bt=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(e){var r,i;const{x:n,y:o,placement:s,middlewareData:a}=e,l=await async function(t,e){const{placement:r,platform:i,elements:n}=t,o=await(null==i.isRTL?void 0:i.isRTL(n.floating)),s=d(r),a=p(r),l="y"===y(r),c=C.has(s)?-1:1,u=o&&l?-1:1,f=h(e,t);let{mainAxis:m,crossAxis:g,alignmentAxis:v}="number"==typeof f?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return a&&"number"==typeof v&&(g="end"===a?-1*v:v),l?{x:g*u,y:m*c}:{x:m*c,y:g*u}}(e,t);return s===(null==(r=a.offset)?void 0:r.placement)&&null!=(i=a.arrow)&&i.alignmentOffset?{}:{x:n+l.x,y:o+l.y,data:{...l,placement:s}}}}},xt=function(t){return void 0===t&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:i,placement:n}=e,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:t=>{let{x:e,y:r}=t;return{x:e,y:r}}},...l}=h(t,e),c={x:r,y:i},p=await M(e,l),m=y(d(n)),g=f(m);let v=c[g],_=c[m];if(o){const t="y"===g?"bottom":"right";v=u(v+p["y"===g?"top":"left"],v,v-p[t])}if(s){const t="y"===m?"bottom":"right";_=u(_+p["y"===m?"top":"left"],_,_-p[t])}const b=a.fn({...e,[g]:v,[m]:_});return{...b,data:{x:b.x-r,y:b.y-i,enabled:{[g]:o,[m]:s}}}}}},wt=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(e){var r,i;const{placement:n,middlewareData:o,rects:s,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:g,fallbackStrategy:b="bestFit",fallbackAxisSideDirection:x="none",flipAlignment:w=!0,...T}=h(t,e);if(null!=(r=o.arrow)&&r.alignmentOffset)return{};const P=d(n),k=y(a),A=d(a)===a,C=await(null==l.isRTL?void 0:l.isRTL(c.floating)),I=g||(A||!w?[S(a)]:function(t){const e=S(t);return[_(t),e,_(e)]}(a)),O="none"!==x;!g&&O&&I.push(...E(a,w,x,C));const L=[a,...I],D=await M(e,T),R=[];let F=(null==(i=o.flip)?void 0:i.overflows)||[];if(u&&R.push(D[P]),f){const t=function(t,e,r){void 0===r&&(r=!1);const i=p(t),n=v(t),o=m(n);let s="x"===n?i===(r?"end":"start")?"right":"left":"start"===i?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=S(s)),[s,S(s)]}(n,s,C);R.push(D[t[0]],D[t[1]])}if(F=[...F,{placement:n,overflows:R}],!R.every((t=>t<=0))){var B,z;const t=((null==(B=o.flip)?void 0:B.index)||0)+1,e=L[t];if(e){if(!("alignment"===f&&k!==y(e))||F.every((t=>y(t.placement)!==k||t.overflows[0]>0)))return{data:{index:t,overflows:F},reset:{placement:e}}}let r=null==(z=F.filter((t=>t.overflows[0]<=0)).sort(((t,e)=>t.overflows[1]-e.overflows[1]))[0])?void 0:z.placement;if(!r)switch(b){case"bestFit":{var j;const t=null==(j=F.filter((t=>{if(O){const e=y(t.placement);return e===k||"y"===e}return!0})).map((t=>[t.placement,t.overflows.filter((t=>t>0)).reduce(((t,e)=>t+e),0)])).sort(((t,e)=>t[1]-e[1]))[0])?void 0:j[0];t&&(r=t);break}case"initialPlacement":r=a}if(n!==r)return{reset:{placement:r}}}return{}}}},Tt=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:i,placement:o,rects:s,platform:a,elements:l,middlewareData:c}=e,{element:d,padding:f=0}=h(t,e)||{};if(null==d)return{};const g=P(f),y={x:r,y:i},_=v(o),b=m(_),x=await a.getDimensions(d),w="y"===_,T=w?"top":"left",E=w?"bottom":"right",S=w?"clientHeight":"clientWidth",k=s.reference[b]+s.reference[_]-y[_]-s.floating[b],A=y[_]-s.reference[_],M=await(null==a.getOffsetParent?void 0:a.getOffsetParent(d));let C=M?M[S]:0;C&&await(null==a.isElement?void 0:a.isElement(M))||(C=l.floating[S]||s.floating[b]);const I=k/2-A/2,O=C/2-x[b]/2-1,L=n(g[T],O),D=n(g[E],O),R=L,F=C-x[b]-D,B=C/2-x[b]/2+I,z=u(R,B,F),j=!c.arrow&&null!=p(o)&&B!==z&&s.reference[b]/2-(B<R?L:D)-x[b]/2<0,N=j?B<R?B-R:B-F:0;return{[_]:y[_]+N,data:{[_]:z,centerOffset:B-z-N,...j&&{alignmentOffset:N}},reset:j}}}),Et=(t,e,r)=>{const i=new Map,n={platform:_t,...r},o={...n.platform,_c:i};return(async(t,e,r)=>{const{placement:i="bottom",strategy:n="absolute",middleware:o=[],platform:s}=r,a=o.filter(Boolean),l=await(null==s.isRTL?void 0:s.isRTL(e));let c=await s.getElementRects({reference:t,floating:e,strategy:n}),{x:u,y:h}=A(c,i,l),d=i,p={},f=0;for(let r=0;r<a.length;r++){const{name:o,fn:m}=a[r],{x:g,y,data:v,reset:_}=await m({x:u,y:h,initialPlacement:i,placement:d,strategy:n,middlewareData:p,rects:c,platform:s,elements:{reference:t,floating:e}});u=null!=g?g:u,h=null!=y?y:h,p={...p,[o]:{...p[o],...v}},_&&f<=50&&(f++,"object"==typeof _&&(_.placement&&(d=_.placement),_.rects&&(c=!0===_.rects?await s.getElementRects({reference:t,floating:e,strategy:n}):_.rects),({x:u,y:h}=A(c,d,l))),r=-1)}return{x:u,y:h,placement:d,strategy:n,middlewareData:p}})(t,e,{...n,platform:o})};function St(t){return St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},St(t)}function Pt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kt(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Dt(i.key),i)}}function At(t,e){return At=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},At(t,e)}function Mt(t){var e=It();return function(){var r,i=Ot(t);if(e){var n=Ot(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return Ct(this,r)}}function Ct(t,e){if(e&&("object"===St(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function It(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(It=function(){return!!t})()}function Ot(t){return Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ot(t)}function Lt(t,e,r){return(e=Dt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Dt(t){var e=function(t,e){if("object"!=St(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=St(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==St(e)?e:e+""}var Rt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&At(t,e)}(o,t);var e,r,i,n=Mt(o);function o(){return Pt(this,o),n.apply(this,arguments)}return e=o,(r=[{key:"show",value:function(){this.isMobile()||(this.positionTooltip(),this.tooltipTarget.classList.remove("tw-hidden"))}},{key:"hide",value:function(){this.isMobile()||this.tooltipTarget.classList.add("tw-hidden")}},{key:"toggle",value:function(t){if(this.isMobile()){var e=this.tooltipTarget.classList.contains("tw-hidden");Array.from(document.getElementsByClassName("sc-tooltip")).forEach((function(t){t.classList.contains("tw-hidden")||t.classList.add("tw-hidden")})),this.element.closest("a")&&t&&(t.preventDefault(),t.stopPropagation(),"function"==typeof t.stopImmediatePropagation&&t.stopImmediatePropagation()),e&&this.tooltipTarget.classList.remove("tw-hidden")}this.positionTooltip()}},{key:"positionTooltip",value:function(){var t,e=this.iconTarget,r=this.tooltipTarget,i=this.arrowTarget,n=null===(t=document.getElementById("filters-overlay-league-table"))||void 0===t?void 0:t.getBoundingClientRect();if(n&&0!==n.top&&this.isMobile())return i.style.display="none",void Object.assign(r.style,{position:"fixed",left:"10px",top:"".concat(n.top+10,"px"),width:"".concat(n.width-20,"px")});Et(e,r,{strategy:"absolute",placement:"bottom-start",middleware:[bt(9),wt(),xt((function(t){return{padding:t.rects.reference.width}})),Tt({element:i,padding:12})]}).then((function(t){var e=t.x,n=t.y,o=t.placement,s=t.middlewareData;Object.assign(r.style,{left:"".concat(e,"px"),top:"".concat(n,"px")});var a=s.arrow,l=a.x,c=a.y,u={top:"bottom",bottom:"top"}[o.split("-")[0]];Object.assign(i.style,Lt({left:null!=l?"".concat(l,"px"):"",top:null!=c?"".concat(c,"px"):"",transform:"bottom"===u?"rotate(225deg)":"rotate(45deg)",right:"",bottom:""},u,"-7px"))}))}},{key:"isMobile",value:function(){return window.innerWidth<=768}}])&&kt(e.prototype,r),i&&kt(e,i),Object.defineProperty(e,"prototype",{writable:!1}),o}(i.xI);Lt(Rt,"targets",["tooltip","icon","arrow"])},3121:(t,e,r)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=c();return function(){var r,i=u(t);if(e){var n=u(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function h(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}r.r(e),r.d(e,{default:()=>m});var d,p,f,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(c,t);var e,r,i,l=a(c);function c(){return n(this,c),l.apply(this,arguments)}return e=c,(r=[{key:"connect",value:function(){this.checkIfContentIsTruncated()}},{key:"checkIfContentIsTruncated",value:function(){var t=this.contentTarget,e=this.moreButtonTarget;t.scrollHeight>t.clientHeight&&e.classList.remove("tw-hidden")}},{key:"showMore",value:function(){this.contentTarget.classList.remove("tw-line-clamp-[10]"),this.moreButtonTarget.classList.add("tw-hidden"),this.lessButtonTarget.classList.remove("tw-hidden")}},{key:"showLess",value:function(){this.contentTarget.classList.add("tw-line-clamp-[10]"),this.moreButtonTarget.classList.remove("tw-hidden"),this.lessButtonTarget.classList.add("tw-hidden")}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),c}(r(2891).xI);d=m,f=["content","moreButton","lessButton"],(p=h(p="targets"))in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f},3343:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>_});var i=r(2891),n=r(7237),o=r(4292),s=r(2936),a=r.n(s);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,p(i.key),i)}}function p(t){var e=function(t,e){if("object"!=l(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=l(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==l(e)?e:e+""}function f(t,e){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},f(t,e)}function m(t){var e=y();return function(){var r,i=v(t);if(e){var n=v(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return g(this,r)}}function g(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(y=function(){return!!t})()}function v(t){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},v(t)}n.t1.register(o.A),n.t1.register(a());var _=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(o,t);var e,r,i,n=m(o);function o(){return h(this,o),n.apply(this,arguments)}return e=o,(r=[{key:"connect",value:function(){this.element.addEventListener("chartjs:connect",this._onConnect),this.element.addEventListener("chartjs:pre-connect",this._onPreConnect)}},{key:"disconnect",value:function(){this.element.removeEventListener("chartjs:connect",this._onConnect),this.element.removeEventListener("chartjs:pre-connect",this._onPreConnect)}},{key:"_onPreConnect",value:function(t){t.detail.options.layout={padding:{left:function(t){var e=b(t),r=document.getElementById("ucasTariffMin").value;if(e>0&&r>0){var i=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0);return i<1024?0:160}return 0},right:50}}}},{key:"_onConnect",value:function(t){t.detail.chart.data.datasets[0].backgroundColor=function(t){var e=t.target.getContext("2d").createLinearGradient(0,0,0,336);return e.addColorStop(.4,"rgba(167, 195, 101, 1)"),e.addColorStop(.5,"rgba(248, 177, 32, 1)"),e.addColorStop(.75,"rgba(227, 54, 64, 1)"),e}(t),t.detail.chart.data.datasets[0].datalabels={align:"start",anchor:"start",display:x(),clip:!1,padding:{left:-510},font:w(),labels:{title:{color:T()}},formatter:E()},t.detail.chart.data.datasets[1].datalabels={align:"end",anchor:"end",display:!0,clip:!1,font:{size:14,weight:400},labels:{title:{color:"black"}},formatter:function(t,e){return"".concat(e.chart.data.datasets[0].data[e.dataIndex],"%")}},t.detail.chart.update()}}])&&d(e.prototype,r),i&&d(e,i),Object.defineProperty(e,"prototype",{writable:!1}),o}(i.xI);function b(t){var e=t.chart.data.datasets[0].data,r=e.reduce((function(t,e){return t+e}),0),i=e.indexOf(Math.max.apply(Math,c(e)));return 0===r&&(i=null),i}function x(){return function(t){var e=b(t);return t.dataIndex===e||t.dataIndex===e-1}}function w(){return function(t){var e=b(t);return t.dataIndex===e-1?{size:14,weight:400}:{size:14,weight:700}}}function T(){return function(t){var e=b(t);return t.dataIndex===e-1?"rgba(89, 167, 221, 1)":"black"}}function E(){return function(t,e){var r=b(e),i=document.getElementById("ucasTariffMin").value;return i>0?e.dataIndex===r-1?"Asked for:":"".concat(i," UCAS Tariff points"):null}}},4233:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>n});var i=r(2891);r(89);class n extends i.xI{}},8406:(t,e,r)=>{"use strict";r.d(e,{$:()=>s,g:()=>o});var i=r(4692),n=r.n(i),o=function(t){if(/^#/.test(t))return!1;if(/^\//.test(t))return!1;var e=function(t){return"localhost"===t||/\d+.\d+\.\d+\.\d+/.test(t)?t:t.split(".").slice(-2).join(".")}(window.location.hostname),r=t.replace(/(https?:\/\/)?(www.)?(:\d+)?/gi,"").split("/")[0],i=e.split(".").join("\\.");return!new RegExp(i+"$").test(r)},s=function(t,e){n()(t).each((function(){var t=this;if(t.href&&!/^mailto:/i.test(t.href)&&o(t.href)&&function(t){return!t.startsWith("https://ad.doubleclick.net")&&!t.includes("utm_source")}(t.href)){var r=t.href.split("?"),i=new URLSearchParams(r[1]);i.append("utm_source",e.utmSource),i.append("utm_campaign",e.utmCampaign),i.append("utm_medium",e.utmMedium),t.href=r[0]+"?"+i.toString()}}))};window.fixLinksReferralTracking=s},8020:(t,e,r)=>{"use strict";r.d(e,{U:()=>u,X:()=>g});var i=r(4692),n=r.n(i),o=r(8406);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function c(t,e,r){var i;return i=function(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"),(e="symbol"==s(i)?i:i+"")in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var u=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};window.dataLayer.push(l(l({},t),e))},h=function(t){var e=t.closest(".js-track");return e?Object.assign({},JSON.parse(e.dataset.track),JSON.parse(t.dataset.track||"{}")):JSON.parse(t.dataset.track)},d=function(t){var e=l(l({},h(t.target)),"A"===t.target.tagName?{link:t.target.text,link_url:t.target.href,external:(0,o.g)(t.target.href)}:{});u(e)},p=function(t){var e=t.target.closest(".js-track--link-click"),r="A"===t.target.tagName?t.target:t.target.closest("a"),i={link:r.text,link_url:r.href,external:(0,o.g)(r.href)};u(l(l({},h(e)),i))},f=function(t){if(!n()(t.target).valid||n()(t.target).valid()){var e=h(t.target);u(e)}},m=function(t){var e=h(t.target);u(l(l({},e),{},{target_value:t.target.value}))},g=function(t){!function(t){(t||document).querySelectorAll(".js-track--click").forEach((function(t){t.addEventListener("click",d)}))}(t),function(t){(t||document).querySelectorAll(".js-track--impression").forEach((function(t){var e=h(t);u(e)}))}(t),n()(document).on("opened",".remodal.js-track--modal",(function(t){var e=h(t.target);window.dataLayer.push(l(l({},e),{},{event:"modal_open",event_name:"modal_open"}))})),n()(document).on("closing",".remodal.js-track--modal",(function(t){var e=h(t.target);u(l(l({},e),{},{event:"modal_close",event_name:"modal_close",reason:t.reason}))})),function(t){(t||document).querySelectorAll(".js-track--link-click a").forEach((function(t){t.addEventListener("click",p)}))}(t),function(t){(t||document).querySelectorAll(".js-track--submit").forEach((function(t){t.addEventListener("submit",f)}))}(t),function(t){(t||document).querySelectorAll(".js-track--onchange").forEach((function(t){t.addEventListener("change",m)}))}(t)}},6613:(t,e,r)=>{"use strict";r.d(e,{X:()=>n});var i={xs:"30em",sm:"40em",md:"50em",lg:"64em"},n=function(t){return window.matchMedia("(min-width: ".concat(i[t],")"))}},9101:(t,e,r)=>{"use strict";var i=r(2891);const n={"symfony--ux-turbo--turbo-core":Promise.resolve().then(r.bind(r,4233)),"symfony--ux-chartjs--chart":Promise.resolve().then(r.bind(r,2088))};function o(t){return t.keys().map((e=>function(t,e){const r=function(t){const e=(t.match(/^(?:\.\/)?(.+)(?:[_-]controller\..+?)$/)||[])[1];if(e)return e.replace(/_/g,"-").replace(/\//g,"--")}(e);if(r)return function(t,e){const r=t.default;if("function"==typeof r)return{identifier:e,controllerConstructor:r}}(t(e),r)}(t,e))).filter((t=>t))}!function(t){const e=i.lg.start();t&&e.load(o(t));for(const t in n)n.hasOwnProperty(t)&&n[t].then((r=>{e.register(t,r.default)}))}(r(8430))},4292:(t,e,r)=>{"use strict";r.d(e,{A:()=>D});var i=r(2998),n=r(7237),o=function(){if("undefined"!=typeof window){if(window.devicePixelRatio)return window.devicePixelRatio;var t=window.screen;if(t)return(t.deviceXDPI||1)/(t.logicalXDPI||1)}return 1}(),s=function(t){var e,r=[];for(t=[].concat(t);t.length;)"string"==typeof(e=t.pop())?r.unshift.apply(r,e.split("\n")):Array.isArray(e)?t.push.apply(t,e):(0,i.k)(t)||r.unshift(""+e);return r},a=function(t,e,r){var i,n=[].concat(e),o=n.length,s=t.font,a=0;for(t.font=r.string,i=0;i<o;++i)a=Math.max(t.measureText(n[i]).width,a);return t.font=s,{height:o*r.lineHeight,width:a}},l=function(t,e,r){return Math.max(t,Math.min(e,r))},c=function(t,e){var r,i,n,o,s=t.slice(),a=[];for(r=0,n=e.length;r<n;++r)o=e[r],-1===(i=s.indexOf(o))?a.push([o,1]):s.splice(i,1);for(r=0,n=s.length;r<n;++r)a.push([s[r],-1]);return a};function u(t,e){var r=e.x,i=e.y;if(null===r)return{x:0,y:-1};if(null===i)return{x:1,y:0};var n=t.x-r,o=t.y-i,s=Math.sqrt(n*n+o*o);return{x:s?n/s:0,y:s?o/s:-1}}function h(t,e,r){var i=0;return t<r.left?i|=1:t>r.right&&(i|=2),e<r.top?i|=8:e>r.bottom&&(i|=4),i}function d(t,e){var r,i,n=e.anchor,o=t;return e.clamp&&(o=function(t,e){for(var r,i,n,o=t.x0,s=t.y0,a=t.x1,l=t.y1,c=h(o,s,e),u=h(a,l,e);c|u&&!(c&u);)8&(r=c||u)?(i=o+(a-o)*(e.top-s)/(l-s),n=e.top):4&r?(i=o+(a-o)*(e.bottom-s)/(l-s),n=e.bottom):2&r?(n=s+(l-s)*(e.right-o)/(a-o),i=e.right):1&r&&(n=s+(l-s)*(e.left-o)/(a-o),i=e.left),r===c?c=h(o=i,s=n,e):u=h(a=i,l=n,e);return{x0:o,x1:a,y0:s,y1:l}}(o,e.area)),"start"===n?(r=o.x0,i=o.y0):"end"===n?(r=o.x1,i=o.y1):(r=(o.x0+o.x1)/2,i=(o.y0+o.y1)/2),function(t,e,r,i,n){switch(n){case"center":r=i=0;break;case"bottom":r=0,i=1;break;case"right":r=1,i=0;break;case"left":r=-1,i=0;break;case"top":r=0,i=-1;break;case"start":r=-r,i=-i;break;case"end":break;default:n*=Math.PI/180,r=Math.cos(n),i=Math.sin(n)}return{x:t,y:e,vx:r,vy:i}}(r,i,t.vx,t.vy,e.align)}var p=function(t,e){var r=(t.startAngle+t.endAngle)/2,i=Math.cos(r),n=Math.sin(r),o=t.innerRadius,s=t.outerRadius;return d({x0:t.x+i*o,y0:t.y+n*o,x1:t.x+i*s,y1:t.y+n*s,vx:i,vy:n},e)},f=function(t,e){var r=u(t,e.origin),i=r.x*t.options.radius,n=r.y*t.options.radius;return d({x0:t.x-i,y0:t.y-n,x1:t.x+i,y1:t.y+n,vx:r.x,vy:r.y},e)},m=function(t,e){var r=u(t,e.origin),i=t.x,n=t.y,o=0,s=0;return t.horizontal?(i=Math.min(t.x,t.base),o=Math.abs(t.base-t.x)):(n=Math.min(t.y,t.base),s=Math.abs(t.base-t.y)),d({x0:i,y0:n+s,x1:i+o,y1:n,vx:r.x,vy:r.y},e)},g=function(t,e){var r=u(t,e.origin);return d({x0:t.x,y0:t.y,x1:t.x,y1:t.y,vx:r.x,vy:r.y},e)},y=function(t){return Math.round(t*o)/o};function v(t,e){var r=e.chart.getDatasetMeta(e.datasetIndex).vScale;if(!r)return null;if(void 0!==r.xCenter&&void 0!==r.yCenter)return{x:r.xCenter,y:r.yCenter};var i=r.getBasePixel();return t.horizontal?{x:i,y:null}:{x:null,y:i}}function _(t,e,r){var i=r.backgroundColor,n=r.borderColor,o=r.borderWidth;(i||n&&o)&&(t.beginPath(),function(t,e,r,i,n,o){var s=Math.PI/2;if(o){var a=Math.min(o,n/2,i/2),l=e+a,c=r+a,u=e+i-a,h=r+n-a;t.moveTo(e,c),l<u&&c<h?(t.arc(l,c,a,-Math.PI,-s),t.arc(u,c,a,-s,0),t.arc(u,h,a,0,s),t.arc(l,h,a,s,Math.PI)):l<u?(t.moveTo(l,r),t.arc(u,c,a,-s,s),t.arc(l,c,a,s,Math.PI+s)):c<h?(t.arc(l,c,a,-Math.PI,0),t.arc(l,h,a,0,Math.PI)):t.arc(l,c,a,-Math.PI,Math.PI),t.closePath(),t.moveTo(e,r)}else t.rect(e,r,i,n)}(t,y(e.x)+o/2,y(e.y)+o/2,y(e.w)-o,y(e.h)-o,r.borderRadius),t.closePath(),i&&(t.fillStyle=i,t.fill()),n&&o&&(t.strokeStyle=n,t.lineWidth=o,t.lineJoin="miter",t.stroke()))}function b(t,e,r){var i=t.shadowBlur,n=r.stroked,o=y(r.x),s=y(r.y),a=y(r.w);n&&t.strokeText(e,o,s,a),r.filled&&(i&&n&&(t.shadowBlur=0),t.fillText(e,o,s,a),i&&n&&(t.shadowBlur=i))}var x=function(t,e,r,i){var n=this;n._config=t,n._index=i,n._model=null,n._rects=null,n._ctx=e,n._el=r};(0,i.V)(x.prototype,{_modelize:function(t,e,r,o){var s,l=this,c=l._index,u=(0,i.O)((0,i.a)([r.font,{}],o,c)),h=(0,i.a)([r.color,n.NT.color],o,c);return{align:(0,i.a)([r.align,"center"],o,c),anchor:(0,i.a)([r.anchor,"center"],o,c),area:o.chart.chartArea,backgroundColor:(0,i.a)([r.backgroundColor,null],o,c),borderColor:(0,i.a)([r.borderColor,null],o,c),borderRadius:(0,i.a)([r.borderRadius,0],o,c),borderWidth:(0,i.a)([r.borderWidth,0],o,c),clamp:(0,i.a)([r.clamp,!1],o,c),clip:(0,i.a)([r.clip,!1],o,c),color:h,display:t,font:u,lines:e,offset:(0,i.a)([r.offset,0],o,c),opacity:(0,i.a)([r.opacity,1],o,c),origin:v(l._el,o),padding:(0,i.K)((0,i.a)([r.padding,0],o,c)),positioner:(s=l._el,s instanceof n.Bs?p:s instanceof n.FN?f:s instanceof n.E8?m:g),rotation:(0,i.a)([r.rotation,0],o,c)*(Math.PI/180),size:a(l._ctx,e,u),textAlign:(0,i.a)([r.textAlign,"start"],o,c),textShadowBlur:(0,i.a)([r.textShadowBlur,0],o,c),textShadowColor:(0,i.a)([r.textShadowColor,h],o,c),textStrokeColor:(0,i.a)([r.textStrokeColor,h],o,c),textStrokeWidth:(0,i.a)([r.textStrokeWidth,0],o,c)}},update:function(t){var e,r,n,o=this,a=null,l=null,c=o._index,u=o._config,h=(0,i.a)([u.display,!0],t,c);h&&(e=t.dataset.data[c],r=(0,i.v)((0,i.C)(u.formatter,[e,t]),e),(n=(0,i.k)(r)?[]:s(r)).length&&(l=function(t){var e=t.borderWidth||0,r=t.padding,i=t.size.height,n=t.size.width,o=-n/2,s=-i/2;return{frame:{x:o-r.left-e,y:s-r.top-e,w:n+r.width+2*e,h:i+r.height+2*e},text:{x:o,y:s,w:n,h:i}}}(a=o._modelize(h,n,u,t)))),o._model=a,o._rects=l},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(t,e){var r,i=t.ctx,n=this._model,o=this._rects;this.visible()&&(i.save(),n.clip&&(r=n.area,i.beginPath(),i.rect(r.left,r.top,r.right-r.left,r.bottom-r.top),i.clip()),i.globalAlpha=l(0,n.opacity,1),i.translate(y(e.x),y(e.y)),i.rotate(n.rotation),_(i,o.frame,n),function(t,e,r,i){var n,o=i.textAlign,s=i.color,a=!!s,l=i.font,c=e.length,u=i.textStrokeColor,h=i.textStrokeWidth,d=u&&h;if(c&&(a||d))for(r=function(t,e,r){var i=r.lineHeight,n=t.w,o=t.x;return"center"===e?o+=n/2:"end"!==e&&"right"!==e||(o+=n),{h:i,w:n,x:o,y:t.y+i/2}}(r,o,l),t.font=l.string,t.textAlign=o,t.textBaseline="middle",t.shadowBlur=i.textShadowBlur,t.shadowColor=i.textShadowColor,a&&(t.fillStyle=s),d&&(t.lineJoin="round",t.lineWidth=h,t.strokeStyle=u),n=0,c=e.length;n<c;++n)b(t,e[n],{stroked:d,filled:a,w:r.w,x:r.x,y:r.y+r.h*n})}(i,n.lines,o.text,n),i.restore())}});var w=Number.MIN_SAFE_INTEGER||-9007199254740991,T=Number.MAX_SAFE_INTEGER||9007199254740991;function E(t,e,r){var i=Math.cos(r),n=Math.sin(r),o=e.x,s=e.y;return{x:o+i*(t.x-o)-n*(t.y-s),y:s+n*(t.x-o)+i*(t.y-s)}}function S(t,e){var r,i,n,o,s,a=T,l=w,c=e.origin;for(r=0;r<t.length;++r)n=(i=t[r]).x-c.x,o=i.y-c.y,s=e.vx*n+e.vy*o,a=Math.min(a,s),l=Math.max(l,s);return{min:a,max:l}}function P(t,e){var r=e.x-t.x,i=e.y-t.y,n=Math.sqrt(r*r+i*i);return{vx:(e.x-t.x)/n,vy:(e.y-t.y)/n,origin:t,ln:n}}var k=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};function A(t,e,r){var i=e.positioner(t,e),n=i.vx,o=i.vy;if(!n&&!o)return{x:i.x,y:i.y};var s=r.w,a=r.h,l=e.rotation,c=Math.abs(s/2*Math.cos(l))+Math.abs(a/2*Math.sin(l)),u=Math.abs(s/2*Math.sin(l))+Math.abs(a/2*Math.cos(l)),h=1/Math.max(Math.abs(n),Math.abs(o));return c*=n*h,u*=o*h,c+=e.offset*n,u+=e.offset*o,{x:i.x+c,y:i.y+u}}(0,i.V)(k.prototype,{center:function(){var t=this._rect;return{x:t.x+t.w/2,y:t.y+t.h/2}},update:function(t,e,r){this._rotation=r,this._rect={x:e.x+t.x,y:e.y+t.y,w:e.w,h:e.h}},contains:function(t){var e=this,r=e._rect;return!((t=E(t,e.center(),-e._rotation)).x<r.x-1||t.y<r.y-1||t.x>r.x+r.w+2||t.y>r.y+r.h+2)},intersects:function(t){var e,r,i,n=this._points(),o=t._points(),s=[P(n[0],n[1]),P(n[0],n[3])];for(this._rotation!==t._rotation&&s.push(P(o[0],o[1]),P(o[0],o[3])),e=0;e<s.length;++e)if(r=S(n,s[e]),i=S(o,s[e]),r.max<i.min||i.max<r.min)return!1;return!0},_points:function(){var t=this,e=t._rect,r=t._rotation,i=t.center();return[E({x:e.x,y:e.y},i,r),E({x:e.x+e.w,y:e.y},i,r),E({x:e.x+e.w,y:e.y+e.h},i,r),E({x:e.x,y:e.y+e.h},i,r)]}});var M={prepare:function(t){var e,r,i,n,o,s=[];for(e=0,i=t.length;e<i;++e)for(r=0,n=t[e].length;r<n;++r)o=t[e][r],s.push(o),o.$layout={_box:new k,_hidable:!1,_visible:!0,_set:e,_idx:r};return s.sort((function(t,e){var r=t.$layout,i=e.$layout;return r._idx===i._idx?i._set-r._set:i._idx-r._idx})),this.update(s),s},update:function(t){var e,r,i,n,o,s=!1;for(e=0,r=t.length;e<r;++e)n=(i=t[e]).model(),(o=i.$layout)._hidable=n&&"auto"===n.display,o._visible=i.visible(),s|=o._hidable;s&&function(t){var e,r,i,n,o,s,a;for(e=0,r=t.length;e<r;++e)(n=(i=t[e]).$layout)._visible&&(a=new Proxy(i._el,{get:(t,e)=>t.getProps([e],!0)[e]}),o=i.geometry(),s=A(a,i.model(),o),n._box.update(s,o,i.rotation()));(function(t,e){var r,i,n,o;for(r=t.length-1;r>=0;--r)for(n=t[r].$layout,i=r-1;i>=0&&n._visible;--i)(o=t[i].$layout)._visible&&n._box.intersects(o._box)&&e(n,o)})(t,(function(t,e){var r=t._hidable,i=e._hidable;r&&i||i?e._visible=!1:r&&(t._visible=!1)}))}(t)},lookup:function(t,e){var r,i;for(r=t.length-1;r>=0;--r)if((i=t[r].$layout)&&i._visible&&i._box.contains(e))return t[r];return null},draw:function(t,e){var r,i,n,o,s,a;for(r=0,i=e.length;r<i;++r)(o=(n=e[r]).$layout)._visible&&(s=n.geometry(),a=A(n._el,n.model(),s),o._box.update(a,s,n.rotation()),n.draw(t,a))}},C="$default";function I(t,e,r){if(e){var n,o=r.$context,s=r.$groups;e[s._set]&&(n=e[s._set][s._key])&&!0===(0,i.C)(n,[o])&&(t.$datalabels._dirty=!0,r.update(o))}}function O(t,e){var r,i,n=t.$datalabels,o=n._listeners;if(o.enter||o.leave){if("mousemove"===e.type)i=M.lookup(n._labels,e);else if("mouseout"!==e.type)return;r=n._hovered,n._hovered=i,function(t,e,r,i){var n,o;(r||i)&&(r?i?r!==i&&(o=n=!0):o=!0:n=!0,o&&I(t,e.leave,r),n&&I(t,e.enter,i))}(t,o,r,i)}}var L={id:"datalabels",defaults:{align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:function(t){if((0,i.k)(t))return null;var e,r,n,o=t;if((0,i.i)(t))if((0,i.k)(t.label))if((0,i.k)(t.r))for(o="",n=0,r=(e=Object.keys(t)).length;n<r;++n)o+=(0!==n?", ":"")+e[n]+": "+t[e[n]];else o=t.r;else o=t.label;return""+o},labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},beforeInit:function(t){t.$datalabels={_actives:[]}},beforeUpdate:function(t){var e=t.$datalabels;e._listened=!1,e._listeners={},e._datasets=[],e._labels=[]},afterDatasetUpdate:function(t,e,r){var n,o,s,a,l,c,u,h,d=e.index,p=t.$datalabels,f=p._datasets[d]=[],m=t.isDatasetVisible(d),g=t.data.datasets[d],y=function(t,e){var r,n,o,s=t.datalabels,a=[];return!1===s?null:(!0===s&&(s={}),e=(0,i.V)({},[e,s]),n=e.labels||{},o=Object.keys(n),delete e.labels,o.length?o.forEach((function(t){n[t]&&a.push((0,i.V)({},[e,n[t],{_key:t}]))})):a.push(e),r=a.reduce((function(t,e){return(0,i.Q)(e.listeners||{},(function(r,i){t[i]=t[i]||{},t[i][e._key||C]=r})),delete e.listeners,t}),{}),{labels:a,listeners:r})}(g,r),v=e.meta.data||[],_=t.ctx;for(_.save(),n=0,s=v.length;n<s;++n)if((u=v[n]).$datalabels=[],m&&u&&t.getDataVisibility(n)&&!u.skip)for(o=0,a=y.labels.length;o<a;++o)c=(l=y.labels[o])._key,(h=new x(l,_,u,n)).$groups={_set:d,_key:c||C},h.$context={active:!1,chart:t,dataIndex:n,dataset:g,datasetIndex:d},h.update(h.$context),u.$datalabels.push(h),f.push(h);_.restore(),(0,i.V)(p._listeners,y.listeners,{merger:function(t,r,i){r[t]=r[t]||{},r[t][e.index]=i[t],p._listened=!0}})},afterUpdate:function(t,e){t.$datalabels._labels=M.prepare(t.$datalabels._datasets,e)},afterDatasetsDraw:function(t){M.draw(t,t.$datalabels._labels)},beforeEvent:function(t,e){if(t.$datalabels._listened){var r=e.event;switch(r.type){case"mousemove":case"mouseout":O(t,r);break;case"click":!function(t,e){var r=t.$datalabels,i=r._listeners.click,n=i&&M.lookup(r._labels,e);n&&I(t,i,n)}(t,r)}}},afterEvent:function(t){var e,r,i,n,o,s,a,l=t.$datalabels,u=l._actives,h=l._actives=t.getActiveElements(),d=c(u,h);for(e=0,r=d.length;e<r;++e)if((o=d[e])[1])for(i=0,n=(a=o[0].element.$datalabels||[]).length;i<n;++i)(s=a[i]).$context.active=1===o[1],s.update(s.$context);(l._dirty||d.length)&&(M.update(l._labels),t.render()),delete l._dirty}};const D=L},2936:t=>{var e;self,e=()=>(()=>{"use strict";var t={d:(e,r)=>{for(var i in r)t.o(r,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:r[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{default:()=>c});var r=function(t,e){return"object"==typeof(r=t)&&r?e?t.x:t.y:t;var r},i=function(t){t.originalData=t.datasets.map((function(t){return function(t,e,r){if(r||2===arguments.length)for(var i,n=0,o=e.length;n<o;n++)!i&&n in e||(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}([],t.data,!0)}))},n=function(){return(n=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},o=Symbol(),s=function(t,e,i,n,s){var a=function(t,e,i,n){var s,a=(null==t?void 0:t.reduce((function(t,e){var r,i=(null===(r=null==e?void 0:e.data)||void 0===r?void 0:r.length)||0;return i>t?i:t}),0))||0,l=null===(s=null==t?void 0:t[0])||void 0===s?void 0:s.stack,c=function(t,e,r){if(r||2===arguments.length)for(var i,n=0,o=e.length;n<o;n++)!i&&n in e||(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}([],new Array(a),!0).map((function(s,a){return t.reduce((function(t,s,c){var u=s.stack||o;t[u]||(t[u]=0);var h=Math.abs(r(s.data[a],i)||0)*e[c];return n&&!l?t[u]<h&&(t[u]=h):t[u]+=h,t}),{})}));return l&&n?c.map((function(t){var e=Math.max.apply(Math,Object.values(t));return Object.keys(t).forEach((function(r){return t[r]=e})),t})):c}(null==t?void 0:t.datasets,e,i,s);return t.datasets.map((function(t){return t.data.map((function(e,s){var l=a[s][t.stack||o],c=r(e,i);return c&&l?function(t,e){var r=Math.pow(10,e);return Math.round(100*t*r)/r}(c/l,n):0}))}))},a=function(t,e){t&&t.forEach((function(t,r){e[r].data=t}))},l=function(t){return"y"===t.options.indexAxis};const c={id:"stacked100",beforeInit:function(t,e,i){if(i.enable){var o=i.replaceTooltipLabel,s=void 0===o||o,a=i.fixNegativeScale,c=void 0===a||a,u=i.individual,h=void 0!==u&&u,d=l(t),p=d?"x":"y",f=t.data.datasets.some((function(t){return t.data.some((function(t){return(r(t,d)||0)<0}))}));["x","y"].forEach((function(e){var r=e===p?function(t,e){var r={max:100};return t?e?n({min:-100},r):r:n({min:0},r)}(f,c):{},i=n(n({stacked:!h},r),t.options.scales[e]);t.options.scales[e]=i})),s&&(t.options.plugins.tooltip.callbacks.label=function(t){return function(e){var i=e.chart.data,n=e.datasetIndex,o=e.dataIndex,s=i.datasets[n].label||"",a=i.originalData[n][o],l=i.calculatedData[n][o],c=r(a,t);return"".concat(s,": ").concat(l,"% (").concat(c,")")}}(d))}},beforeUpdate:function(t,e,r){if(r.enable){var n=t.data;i(n);var o=n.datasets.map((function(e,r){var i,n;return(null!==(n=null===(i=t.getDatasetMeta(r))||void 0===i?void 0:i.hidden)&&void 0!==n?n:e.hidden)?0:1})),c=function(t){if(!("precision"in t))return 1;if("number"!=typeof t.precision)return 1;var e=Math.floor(t.precision);return e<0||e>16?1:e}(r);n.calculatedData=s(n,o,l(t),c,r.individual),a(n.calculatedData,n.datasets)}},afterUpdate:function(t,e,r){if(r.enable){var i=t.data;a(i.originalData,i.datasets)}}};return e})(),t.exports=e()},9786:(t,e,r)=>{var i,n;!function(o,s){"use strict";void 0===(n="function"==typeof(i=s)?i.call(e,r,e,t):i)||(t.exports=n)}(window,(function(){"use strict";var t=function(){var t=window.Element.prototype;if(t.matches)return"matches";if(t.matchesSelector)return"matchesSelector";for(var e=["webkit","moz","ms","o"],r=0;r<e.length;r++){var i=e[r]+"MatchesSelector";if(t[i])return i}}();return function(e,r){return e[t](r)}}))},2137:function(t,e,r){var i,n;"undefined"!=typeof window&&window,void 0===(n="function"==typeof(i=function(){"use strict";function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var r=this._events=this._events||{},i=r[t]=r[t]||[];return-1==i.indexOf(e)&&i.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var r=this._onceEvents=this._onceEvents||{};return(r[t]=r[t]||{})[e]=!0,this}},e.off=function(t,e){var r=this._events&&this._events[t];if(r&&r.length){var i=r.indexOf(e);return-1!=i&&r.splice(i,1),this}},e.emitEvent=function(t,e){var r=this._events&&this._events[t];if(r&&r.length){r=r.slice(0),e=e||[];for(var i=this._onceEvents&&this._onceEvents[t],n=0;n<r.length;n++){var o=r[n];i&&i[o]&&(this.off(t,o),delete i[o]),o.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t})?i.call(e,r,e,t):i)||(t.exports=n)},977:(t,e,r)=>{var i,n;!function(o,s){i=[r(9786)],n=function(t){return function(t,e){"use strict";var r={extend:function(t,e){for(var r in e)t[r]=e[r];return t},modulo:function(t,e){return(t%e+e)%e}},i=Array.prototype.slice;r.makeArray=function(t){return Array.isArray(t)?t:null==t?[]:"object"==typeof t&&"number"==typeof t.length?i.call(t):[t]},r.removeFrom=function(t,e){var r=t.indexOf(e);-1!=r&&t.splice(r,1)},r.getParent=function(t,r){for(;t.parentNode&&t!=document.body;)if(t=t.parentNode,e(t,r))return t},r.getQueryElement=function(t){return"string"==typeof t?document.querySelector(t):t},r.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},r.filterFindElements=function(t,i){t=r.makeArray(t);var n=[];return t.forEach((function(t){if(t instanceof HTMLElement)if(i){e(t,i)&&n.push(t);for(var r=t.querySelectorAll(i),o=0;o<r.length;o++)n.push(r[o])}else n.push(t)})),n},r.debounceMethod=function(t,e,r){r=r||100;var i=t.prototype[e],n=e+"Timeout";t.prototype[e]=function(){var t=this[n];clearTimeout(t);var e=arguments,o=this;this[n]=setTimeout((function(){i.apply(o,e),delete o[n]}),r)}},r.docReady=function(t){var e=document.readyState;"complete"==e||"interactive"==e?setTimeout(t):document.addEventListener("DOMContentLoaded",t)},r.toDashed=function(t){return t.replace(/(.)([A-Z])/g,(function(t,e,r){return e+"-"+r})).toLowerCase()};var n=t.console;return r.htmlInit=function(e,i){r.docReady((function(){var o=r.toDashed(i),s="data-"+o,a=document.querySelectorAll("["+s+"]"),l=document.querySelectorAll(".js-"+o),c=r.makeArray(a).concat(r.makeArray(l)),u=s+"-options",h=t.jQuery;c.forEach((function(t){var r,o=t.getAttribute(s)||t.getAttribute(u);try{r=o&&JSON.parse(o)}catch(e){return void(n&&n.error("Error parsing "+s+" on "+t.className+": "+e))}var a=new e(t,r);h&&h.data(t,i,a)}))}))},r}(o,t)}.apply(e,i),void 0===n||(t.exports=n)}(window)},9943:(t,e,r)=>{var i,n;window,i=[r(9249),r(977)],void 0===(n=function(t,e){return function(t,e,r){"use strict";function i(t){var e=document.createDocumentFragment();return t.forEach((function(t){e.appendChild(t.element)})),e}var n=e.prototype;return n.insert=function(t,e){var r=this._makeCells(t);if(r&&r.length){var n=this.cells.length;e=void 0===e?n:e;var o=i(r),s=e==n;if(s)this.slider.appendChild(o);else{var a=this.cells[e].element;this.slider.insertBefore(o,a)}if(0===e)this.cells=r.concat(this.cells);else if(s)this.cells=this.cells.concat(r);else{var l=this.cells.splice(e,n-e);this.cells=this.cells.concat(r).concat(l)}this._sizeCells(r),this.cellChange(e,!0)}},n.append=function(t){this.insert(t,this.cells.length)},n.prepend=function(t){this.insert(t,0)},n.remove=function(t){var e=this.getCells(t);if(e&&e.length){var i=this.cells.length-1;e.forEach((function(t){t.remove();var e=this.cells.indexOf(t);i=Math.min(e,i),r.removeFrom(this.cells,t)}),this),this.cellChange(i,!0)}},n.cellSizeChange=function(t){var e=this.getCell(t);if(e){e.getSize();var r=this.cells.indexOf(e);this.cellChange(r)}},n.cellChange=function(t,e){var r=this.selectedElement;this._positionCells(t),this._getWrapShiftCells(),this.setGallerySize();var i=this.getCell(r);i&&(this.selectedIndex=this.getCellSlideIndex(i)),this.selectedIndex=Math.min(this.slides.length-1,this.selectedIndex),this.emitEvent("cellChange",[t]),this.select(this.selectedIndex),e&&this.positionSliderAtSelected()},e}(0,t,e)}.apply(e,i))||(t.exports=n)},2121:(t,e,r)=>{var i,n;window,i=[r(977)],void 0===(n=function(t){return function(t,e){"use strict";var r={startAnimation:function(){this.isAnimating||(this.isAnimating=!0,this.restingFrames=0,this.animate())},animate:function(){this.applyDragForce(),this.applySelectedAttraction();var t=this.x;if(this.integratePhysics(),this.positionSlider(),this.settle(t),this.isAnimating){var e=this;requestAnimationFrame((function(){e.animate()}))}},positionSlider:function(){var t=this.x;this.options.wrapAround&&this.cells.length>1&&(t=e.modulo(t,this.slideableWidth),t-=this.slideableWidth,this.shiftWrapCells(t)),this.setTranslateX(t,this.isAnimating),this.dispatchScrollEvent()},setTranslateX:function(t,e){t+=this.cursorPosition,t=this.options.rightToLeft?-t:t;var r=this.getPositionValue(t);this.slider.style.transform=e?"translate3d("+r+",0,0)":"translateX("+r+")"},dispatchScrollEvent:function(){var t=this.slides[0];if(t){var e=-this.x-t.target,r=e/this.slidesWidth;this.dispatchEvent("scroll",null,[r,e])}},positionSliderAtSelected:function(){this.cells.length&&(this.x=-this.selectedSlide.target,this.velocity=0,this.positionSlider())},getPositionValue:function(t){return this.options.percentPosition?.01*Math.round(t/this.size.innerWidth*1e4)+"%":Math.round(t)+"px"},settle:function(t){!this.isPointerDown&&Math.round(100*this.x)==Math.round(100*t)&&this.restingFrames++,this.restingFrames>2&&(this.isAnimating=!1,delete this.isFreeScrolling,this.positionSlider(),this.dispatchEvent("settle",null,[this.selectedIndex]))},shiftWrapCells:function(t){var e=this.cursorPosition+t;this._shiftCells(this.beforeShiftCells,e,-1);var r=this.size.innerWidth-(t+this.slideableWidth+this.cursorPosition);this._shiftCells(this.afterShiftCells,r,1)},_shiftCells:function(t,e,r){for(var i=0;i<t.length;i++){var n=t[i],o=e>0?r:0;n.wrapShift(o),e-=n.size.outerWidth}},_unshiftCells:function(t){if(t&&t.length)for(var e=0;e<t.length;e++)t[e].wrapShift(0)},integratePhysics:function(){this.x+=this.velocity,this.velocity*=this.getFrictionFactor()},applyForce:function(t){this.velocity+=t},getFrictionFactor:function(){return 1-this.options[this.isFreeScrolling?"freeScrollFriction":"friction"]},getRestingPosition:function(){return this.x+this.velocity/(1-this.getFrictionFactor())},applyDragForce:function(){if(this.isDraggable&&this.isPointerDown){var t=this.dragX-this.x-this.velocity;this.applyForce(t)}},applySelectedAttraction:function(){if((!this.isDraggable||!this.isPointerDown)&&!this.isFreeScrolling&&this.slides.length){var t=(-1*this.selectedSlide.target-this.x)*this.options.selectedAttraction;this.applyForce(t)}}};return r}(0,t)}.apply(e,i))||(t.exports=n)},4092:(t,e,r)=>{var i,n;window,i=[r(1485)],void 0===(n=function(t){return function(t,e){"use strict";function r(t,e){this.element=t,this.parent=e,this.create()}var i=r.prototype;return i.create=function(){this.element.style.position="absolute",this.element.setAttribute("aria-hidden","true"),this.x=0,this.shift=0,this.element.style[this.parent.originSide]=0},i.destroy=function(){this.unselect(),this.element.style.position="";var t=this.parent.originSide;this.element.style[t]="",this.element.style.transform="",this.element.removeAttribute("aria-hidden")},i.getSize=function(){this.size=e(this.element)},i.setPosition=function(t){this.x=t,this.updateTarget(),this.renderPosition(t)},i.updateTarget=i.setDefaultTarget=function(){var t="left"==this.parent.originSide?"marginLeft":"marginRight";this.target=this.x+this.size[t]+this.size.width*this.parent.cellAlign},i.renderPosition=function(t){var e="left"===this.parent.originSide?1:-1,r=this.parent.options.percentPosition?t*e*(this.parent.size.innerWidth/this.size.width):t*e;this.element.style.transform="translateX("+this.parent.getPositionValue(r)+")"},i.select=function(){this.element.classList.add("is-selected"),this.element.removeAttribute("aria-hidden")},i.unselect=function(){this.element.classList.remove("is-selected"),this.element.setAttribute("aria-hidden","true")},i.wrapShift=function(t){this.shift=t,this.renderPosition(this.x+this.parent.slideableWidth*t)},i.remove=function(){this.element.parentNode.removeChild(this.element)},r}(0,t)}.apply(e,i))||(t.exports=n)},3170:(t,e,r)=>{var i,n;!function(o,s){i=[r(9249),r(6377),r(977)],n=function(t,e,r){return function(t,e,r,i){"use strict";i.extend(e.defaults,{draggable:">1",dragThreshold:3}),e.createMethods.push("_createDrag");var n=e.prototype;i.extend(n,r.prototype),n._touchActionValue="pan-y",n._createDrag=function(){this.on("activate",this.onActivateDrag),this.on("uiChange",this._uiChangeDrag),this.on("deactivate",this.onDeactivateDrag),this.on("cellChange",this.updateDraggable)},n.onActivateDrag=function(){this.handles=[this.viewport],this.bindHandles(),this.updateDraggable()},n.onDeactivateDrag=function(){this.unbindHandles(),this.element.classList.remove("is-draggable")},n.updateDraggable=function(){">1"==this.options.draggable?this.isDraggable=this.slides.length>1:this.isDraggable=this.options.draggable,this.isDraggable?this.element.classList.add("is-draggable"):this.element.classList.remove("is-draggable")},n.bindDrag=function(){this.options.draggable=!0,this.updateDraggable()},n.unbindDrag=function(){this.options.draggable=!1,this.updateDraggable()},n._uiChangeDrag=function(){delete this.isFreeScrolling},n.pointerDown=function(e,r){this.isDraggable?this.okayPointerDown(e)&&(this._pointerDownPreventDefault(e),this.pointerDownFocus(e),document.activeElement!=this.element&&this.pointerDownBlur(),this.dragX=this.x,this.viewport.classList.add("is-pointer-down"),this.pointerDownScroll=s(),t.addEventListener("scroll",this),this._pointerDownDefault(e,r)):this._pointerDownDefault(e,r)},n._pointerDownDefault=function(t,e){this.pointerDownPointer={pageX:e.pageX,pageY:e.pageY},this._bindPostStartEvents(t),this.dispatchEvent("pointerDown",t,[e])};var o={INPUT:!0,TEXTAREA:!0,SELECT:!0};function s(){return{x:t.pageXOffset,y:t.pageYOffset}}return n.pointerDownFocus=function(t){o[t.target.nodeName]||this.focus()},n._pointerDownPreventDefault=function(t){var e="touchstart"==t.type,r="touch"==t.pointerType,i=o[t.target.nodeName];e||r||i||t.preventDefault()},n.hasDragStarted=function(t){return Math.abs(t.x)>this.options.dragThreshold},n.pointerUp=function(t,e){delete this.isTouchScrolling,this.viewport.classList.remove("is-pointer-down"),this.dispatchEvent("pointerUp",t,[e]),this._dragPointerUp(t,e)},n.pointerDone=function(){t.removeEventListener("scroll",this),delete this.pointerDownScroll},n.dragStart=function(e,r){this.isDraggable&&(this.dragStartPosition=this.x,this.startAnimation(),t.removeEventListener("scroll",this),this.dispatchEvent("dragStart",e,[r]))},n.pointerMove=function(t,e){var r=this._dragPointerMove(t,e);this.dispatchEvent("pointerMove",t,[e,r]),this._dragMove(t,e,r)},n.dragMove=function(t,e,r){if(this.isDraggable){t.preventDefault(),this.previousDragX=this.dragX;var i=this.options.rightToLeft?-1:1;this.options.wrapAround&&(r.x%=this.slideableWidth);var n=this.dragStartPosition+r.x*i;if(!this.options.wrapAround&&this.slides.length){var o=Math.max(-this.slides[0].target,this.dragStartPosition);n=n>o?.5*(n+o):n;var s=Math.min(-this.getLastSlide().target,this.dragStartPosition);n=n<s?.5*(n+s):n}this.dragX=n,this.dragMoveTime=new Date,this.dispatchEvent("dragMove",t,[e,r])}},n.dragEnd=function(t,e){if(this.isDraggable){this.options.freeScroll&&(this.isFreeScrolling=!0);var r=this.dragEndRestingSelect();if(this.options.freeScroll&&!this.options.wrapAround){var i=this.getRestingPosition();this.isFreeScrolling=-i>this.slides[0].target&&-i<this.getLastSlide().target}else this.options.freeScroll||r!=this.selectedIndex||(r+=this.dragEndBoostSelect());delete this.previousDragX,this.isDragSelect=this.options.wrapAround,this.select(r),delete this.isDragSelect,this.dispatchEvent("dragEnd",t,[e])}},n.dragEndRestingSelect=function(){var t=this.getRestingPosition(),e=Math.abs(this.getSlideDistance(-t,this.selectedIndex)),r=this._getClosestResting(t,e,1),i=this._getClosestResting(t,e,-1);return r.distance<i.distance?r.index:i.index},n._getClosestResting=function(t,e,r){for(var i=this.selectedIndex,n=1/0,o=this.options.contain&&!this.options.wrapAround?function(t,e){return t<=e}:function(t,e){return t<e};o(e,n)&&(i+=r,n=e,null!==(e=this.getSlideDistance(-t,i)));)e=Math.abs(e);return{distance:n,index:i-r}},n.getSlideDistance=function(t,e){var r=this.slides.length,n=this.options.wrapAround&&r>1,o=n?i.modulo(e,r):e,s=this.slides[o];if(!s)return null;var a=n?this.slideableWidth*Math.floor(e/r):0;return t-(s.target+a)},n.dragEndBoostSelect=function(){if(void 0===this.previousDragX||!this.dragMoveTime||new Date-this.dragMoveTime>100)return 0;var t=this.getSlideDistance(-this.dragX,this.selectedIndex),e=this.previousDragX-this.dragX;return t>0&&e>0?1:t<0&&e<0?-1:0},n.staticClick=function(t,e){var r=this.getParentCell(t.target),i=r&&r.element,n=r&&this.cells.indexOf(r);this.dispatchEvent("staticClick",t,[e,i,n])},n.onscroll=function(){var t=s(),e=this.pointerDownScroll.x-t.x,r=this.pointerDownScroll.y-t.y;(Math.abs(e)>3||Math.abs(r)>3)&&this._pointerDone()},e}(o,t,e,r)}.apply(e,i),void 0===n||(t.exports=n)}(window)},9249:(t,e,r)=>{var i,n;!function(o,s){i=[r(2137),r(1485),r(977),r(4092),r(1331),r(2121)],n=function(t,e,r,i,n,s){return function(t,e,r,i,n,o,s){"use strict";var a=t.jQuery,l=t.getComputedStyle,c=t.console;function u(t,e){for(t=i.makeArray(t);t.length;)e.appendChild(t.shift())}var h=0,d={};function p(t,e){var r=i.getQueryElement(t);if(r){if(this.element=r,this.element.flickityGUID){var n=d[this.element.flickityGUID];return n&&n.option(e),n}a&&(this.$element=a(this.element)),this.options=i.extend({},this.constructor.defaults),this.option(e),this._create()}else c&&c.error("Bad element for Flickity: "+(r||t))}p.defaults={accessibility:!0,cellAlign:"center",freeScrollFriction:.075,friction:.28,namespaceJQueryEvents:!0,percentPosition:!0,resize:!0,selectedAttraction:.025,setGallerySize:!0},p.createMethods=[];var f=p.prototype;i.extend(f,e.prototype),f._create=function(){var e=this.guid=++h;for(var r in this.element.flickityGUID=e,d[e]=this,this.selectedIndex=0,this.restingFrames=0,this.x=0,this.velocity=0,this.originSide=this.options.rightToLeft?"right":"left",this.viewport=document.createElement("div"),this.viewport.className="flickity-viewport",this._createSlider(),(this.options.resize||this.options.watchCSS)&&t.addEventListener("resize",this),this.options.on){var i=this.options.on[r];this.on(r,i)}p.createMethods.forEach((function(t){this[t]()}),this),this.options.watchCSS?this.watchCSS():this.activate()},f.option=function(t){i.extend(this.options,t)},f.activate=function(){this.isActive||(this.isActive=!0,this.element.classList.add("flickity-enabled"),this.options.rightToLeft&&this.element.classList.add("flickity-rtl"),this.getSize(),u(this._filterFindCellElements(this.element.children),this.slider),this.viewport.appendChild(this.slider),this.element.appendChild(this.viewport),this.reloadCells(),this.options.accessibility&&(this.element.tabIndex=0,this.element.addEventListener("keydown",this)),this.emitEvent("activate"),this.selectInitialIndex(),this.isInitActivated=!0,this.dispatchEvent("ready"))},f._createSlider=function(){var t=document.createElement("div");t.className="flickity-slider",t.style[this.originSide]=0,this.slider=t},f._filterFindCellElements=function(t){return i.filterFindElements(t,this.options.cellSelector)},f.reloadCells=function(){this.cells=this._makeCells(this.slider.children),this.positionCells(),this._getWrapShiftCells(),this.setGallerySize()},f._makeCells=function(t){return this._filterFindCellElements(t).map((function(t){return new n(t,this)}),this)},f.getLastCell=function(){return this.cells[this.cells.length-1]},f.getLastSlide=function(){return this.slides[this.slides.length-1]},f.positionCells=function(){this._sizeCells(this.cells),this._positionCells(0)},f._positionCells=function(t){t=t||0,this.maxCellHeight=t&&this.maxCellHeight||0;var e=0;if(t>0){var r=this.cells[t-1];e=r.x+r.size.outerWidth}for(var i=this.cells.length,n=t;n<i;n++){var o=this.cells[n];o.setPosition(e),e+=o.size.outerWidth,this.maxCellHeight=Math.max(o.size.outerHeight,this.maxCellHeight)}this.slideableWidth=e,this.updateSlides(),this._containSlides(),this.slidesWidth=i?this.getLastSlide().target-this.slides[0].target:0},f._sizeCells=function(t){t.forEach((function(t){t.getSize()}))},f.updateSlides=function(){if(this.slides=[],this.cells.length){var t=new o(this);this.slides.push(t);var e="left"==this.originSide?"marginRight":"marginLeft",r=this._getCanCellFit();this.cells.forEach((function(i,n){if(t.cells.length){var s=t.outerWidth-t.firstMargin+(i.size.outerWidth-i.size[e]);r.call(this,n,s)||(t.updateTarget(),t=new o(this),this.slides.push(t)),t.addCell(i)}else t.addCell(i)}),this),t.updateTarget(),this.updateSelectedSlide()}},f._getCanCellFit=function(){var t=this.options.groupCells;if(!t)return function(){return!1};if("number"==typeof t){var e=parseInt(t,10);return function(t){return t%e!=0}}var r="string"==typeof t&&t.match(/^(\d+)%$/),i=r?parseInt(r[1],10)/100:1;return function(t,e){return e<=(this.size.innerWidth+1)*i}},f._init=f.reposition=function(){this.positionCells(),this.positionSliderAtSelected()},f.getSize=function(){this.size=r(this.element),this.setCellAlign(),this.cursorPosition=this.size.innerWidth*this.cellAlign};var m={center:{left:.5,right:.5},left:{left:0,right:1},right:{right:0,left:1}};f.setCellAlign=function(){var t=m[this.options.cellAlign];this.cellAlign=t?t[this.originSide]:this.options.cellAlign},f.setGallerySize=function(){if(this.options.setGallerySize){var t=this.options.adaptiveHeight&&this.selectedSlide?this.selectedSlide.height:this.maxCellHeight;this.viewport.style.height=t+"px"}},f._getWrapShiftCells=function(){if(this.options.wrapAround){this._unshiftCells(this.beforeShiftCells),this._unshiftCells(this.afterShiftCells);var t=this.cursorPosition,e=this.cells.length-1;this.beforeShiftCells=this._getGapCells(t,e,-1),t=this.size.innerWidth-this.cursorPosition,this.afterShiftCells=this._getGapCells(t,0,1)}},f._getGapCells=function(t,e,r){for(var i=[];t>0;){var n=this.cells[e];if(!n)break;i.push(n),e+=r,t-=n.size.outerWidth}return i},f._containSlides=function(){if(this.options.contain&&!this.options.wrapAround&&this.cells.length){var t=this.options.rightToLeft,e=t?"marginRight":"marginLeft",r=t?"marginLeft":"marginRight",i=this.slideableWidth-this.getLastCell().size[r],n=i<this.size.innerWidth,o=this.cursorPosition+this.cells[0].size[e],s=i-this.size.innerWidth*(1-this.cellAlign);this.slides.forEach((function(t){n?t.target=i*this.cellAlign:(t.target=Math.max(t.target,o),t.target=Math.min(t.target,s))}),this)}},f.dispatchEvent=function(t,e,r){var i=e?[e].concat(r):r;if(this.emitEvent(t,i),a&&this.$element){var n=t+=this.options.namespaceJQueryEvents?".flickity":"";if(e){var o=new a.Event(e);o.type=t,n=o}this.$element.trigger(n,r)}},f.select=function(t,e,r){if(this.isActive&&(t=parseInt(t,10),this._wrapSelect(t),(this.options.wrapAround||e)&&(t=i.modulo(t,this.slides.length)),this.slides[t])){var n=this.selectedIndex;this.selectedIndex=t,this.updateSelectedSlide(),r?this.positionSliderAtSelected():this.startAnimation(),this.options.adaptiveHeight&&this.setGallerySize(),this.dispatchEvent("select",null,[t]),t!=n&&this.dispatchEvent("change",null,[t]),this.dispatchEvent("cellSelect")}},f._wrapSelect=function(t){var e=this.slides.length;if(!(this.options.wrapAround&&e>1))return t;var r=i.modulo(t,e),n=Math.abs(r-this.selectedIndex),o=Math.abs(r+e-this.selectedIndex),s=Math.abs(r-e-this.selectedIndex);!this.isDragSelect&&o<n?t+=e:!this.isDragSelect&&s<n&&(t-=e),t<0?this.x-=this.slideableWidth:t>=e&&(this.x+=this.slideableWidth)},f.previous=function(t,e){this.select(this.selectedIndex-1,t,e)},f.next=function(t,e){this.select(this.selectedIndex+1,t,e)},f.updateSelectedSlide=function(){var t=this.slides[this.selectedIndex];t&&(this.unselectSelectedSlide(),this.selectedSlide=t,t.select(),this.selectedCells=t.cells,this.selectedElements=t.getCellElements(),this.selectedCell=t.cells[0],this.selectedElement=this.selectedElements[0])},f.unselectSelectedSlide=function(){this.selectedSlide&&this.selectedSlide.unselect()},f.selectInitialIndex=function(){var t=this.options.initialIndex;if(this.isInitActivated)this.select(this.selectedIndex,!1,!0);else{if(t&&"string"==typeof t)if(this.queryCell(t))return void this.selectCell(t,!1,!0);var e=0;t&&this.slides[t]&&(e=t),this.select(e,!1,!0)}},f.selectCell=function(t,e,r){var i=this.queryCell(t);if(i){var n=this.getCellSlideIndex(i);this.select(n,e,r)}},f.getCellSlideIndex=function(t){for(var e=0;e<this.slides.length;e++){if(-1!=this.slides[e].cells.indexOf(t))return e}},f.getCell=function(t){for(var e=0;e<this.cells.length;e++){var r=this.cells[e];if(r.element==t)return r}},f.getCells=function(t){t=i.makeArray(t);var e=[];return t.forEach((function(t){var r=this.getCell(t);r&&e.push(r)}),this),e},f.getCellElements=function(){return this.cells.map((function(t){return t.element}))},f.getParentCell=function(t){var e=this.getCell(t);return e||(t=i.getParent(t,".flickity-slider > *"),this.getCell(t))},f.getAdjacentCellElements=function(t,e){if(!t)return this.selectedSlide.getCellElements();e=void 0===e?this.selectedIndex:e;var r=this.slides.length;if(1+2*t>=r)return this.getCellElements();for(var n=[],o=e-t;o<=e+t;o++){var s=this.options.wrapAround?i.modulo(o,r):o,a=this.slides[s];a&&(n=n.concat(a.getCellElements()))}return n},f.queryCell=function(t){if("number"==typeof t)return this.cells[t];if("string"==typeof t){if(t.match(/^[#.]?[\d/]/))return;t=this.element.querySelector(t)}return this.getCell(t)},f.uiChange=function(){this.emitEvent("uiChange")},f.childUIPointerDown=function(t){"touchstart"!=t.type&&t.preventDefault(),this.focus()},f.onresize=function(){this.watchCSS(),this.resize()},i.debounceMethod(p,"onresize",150),f.resize=function(){if(this.isActive&&!this.isAnimating&&!this.isDragging){this.getSize(),this.options.wrapAround&&(this.x=i.modulo(this.x,this.slideableWidth)),this.positionCells(),this._getWrapShiftCells(),this.setGallerySize(),this.emitEvent("resize");var t=this.selectedElements&&this.selectedElements[0];this.selectCell(t,!1,!0)}},f.watchCSS=function(){this.options.watchCSS&&(-1!=l(this.element,":after").content.indexOf("flickity")?this.activate():this.deactivate())},f.onkeydown=function(t){var e=document.activeElement&&document.activeElement!=this.element;if(this.options.accessibility&&!e){var r=p.keyboardHandlers[t.keyCode];r&&r.call(this)}},p.keyboardHandlers={37:function(){var t=this.options.rightToLeft?"next":"previous";this.uiChange(),this[t]()},39:function(){var t=this.options.rightToLeft?"previous":"next";this.uiChange(),this[t]()}},f.focus=function(){var e=t.pageYOffset;this.element.focus({preventScroll:!0}),t.pageYOffset!=e&&t.scrollTo(t.pageXOffset,e)},f.deactivate=function(){this.isActive&&(this.element.classList.remove("flickity-enabled"),this.element.classList.remove("flickity-rtl"),this.unselectSelectedSlide(),this.cells.forEach((function(t){t.destroy()})),this.element.removeChild(this.viewport),u(this.slider.children,this.element),this.options.accessibility&&(this.element.removeAttribute("tabIndex"),this.element.removeEventListener("keydown",this)),this.isActive=!1,this.emitEvent("deactivate"))},f.destroy=function(){this.deactivate(),t.removeEventListener("resize",this),this.allOff(),this.emitEvent("destroy"),a&&this.$element&&a.removeData(this.element,"flickity"),delete this.element.flickityGUID,delete d[this.guid]},i.extend(f,s),p.data=function(t){var e=(t=i.getQueryElement(t))&&t.flickityGUID;return e&&d[e]},i.htmlInit(p,"flickity"),a&&a.bridget&&a.bridget("flickity",p);return p.setJQuery=function(t){a=t},p.Cell=n,p.Slide=o,p}(o,t,e,r,i,n,s)}.apply(e,i),void 0===n||(t.exports=n)}(window)},2522:(t,e,r)=>{var i,n,o;window,n=[r(9249),r(3170),r(7824),r(7728),r(9453),r(9943),r(766)],void 0===(o="function"==typeof(i=function(t){return t})?i.apply(e,n):i)||(t.exports=o)},766:(t,e,r)=>{var i,n;window,i=[r(9249),r(977)],void 0===(n=function(t,e){return function(t,e,r){"use strict";e.createMethods.push("_createLazyload");var i=e.prototype;function n(t){if("IMG"==t.nodeName){var e=t.getAttribute("data-flickity-lazyload"),i=t.getAttribute("data-flickity-lazyload-src"),n=t.getAttribute("data-flickity-lazyload-srcset");if(e||i||n)return[t]}var o="img[data-flickity-lazyload], img[data-flickity-lazyload-src], img[data-flickity-lazyload-srcset]",s=t.querySelectorAll(o);return r.makeArray(s)}function o(t,e){this.img=t,this.flickity=e,this.load()}return i._createLazyload=function(){this.on("select",this.lazyLoad)},i.lazyLoad=function(){var t=this.options.lazyLoad;if(t){var e="number"==typeof t?t:0,r=this.getAdjacentCellElements(e),i=[];r.forEach((function(t){var e=n(t);i=i.concat(e)})),i.forEach((function(t){new o(t,this)}),this)}},o.prototype.handleEvent=r.handleEvent,o.prototype.load=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this);var t=this.img.getAttribute("data-flickity-lazyload")||this.img.getAttribute("data-flickity-lazyload-src"),e=this.img.getAttribute("data-flickity-lazyload-srcset");this.img.src=t,e&&this.img.setAttribute("srcset",e),this.img.removeAttribute("data-flickity-lazyload"),this.img.removeAttribute("data-flickity-lazyload-src"),this.img.removeAttribute("data-flickity-lazyload-srcset")},o.prototype.onload=function(t){this.complete(t,"flickity-lazyloaded")},o.prototype.onerror=function(t){this.complete(t,"flickity-lazyerror")},o.prototype.complete=function(t,e){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this);var r=this.flickity.getParentCell(this.img),i=r&&r.element;this.flickity.cellSizeChange(i),this.img.classList.add(e),this.flickity.dispatchEvent("lazyLoad",t,i)},e.LazyLoader=o,e}(0,t,e)}.apply(e,i))||(t.exports=n)},7728:(t,e,r)=>{var i,n;window,i=[r(9249),r(2475),r(977)],void 0===(n=function(t,e,r){return function(t,e,r,i){"use strict";function n(t){this.parent=t,this._create()}n.prototype=Object.create(r.prototype),n.prototype._create=function(){this.holder=document.createElement("ol"),this.holder.className="flickity-page-dots",this.dots=[],this.handleClick=this.onClick.bind(this),this.on("pointerDown",this.parent.childUIPointerDown.bind(this.parent))},n.prototype.activate=function(){this.setDots(),this.holder.addEventListener("click",this.handleClick),this.bindStartEvent(this.holder),this.parent.element.appendChild(this.holder)},n.prototype.deactivate=function(){this.holder.removeEventListener("click",this.handleClick),this.unbindStartEvent(this.holder),this.parent.element.removeChild(this.holder)},n.prototype.setDots=function(){var t=this.parent.slides.length-this.dots.length;t>0?this.addDots(t):t<0&&this.removeDots(-t)},n.prototype.addDots=function(t){for(var e=document.createDocumentFragment(),r=[],i=this.dots.length,n=i+t,o=i;o<n;o++){var s=document.createElement("li");s.className="dot",s.setAttribute("aria-label","Page dot "+(o+1)),e.appendChild(s),r.push(s)}this.holder.appendChild(e),this.dots=this.dots.concat(r)},n.prototype.removeDots=function(t){this.dots.splice(this.dots.length-t,t).forEach((function(t){this.holder.removeChild(t)}),this)},n.prototype.updateSelected=function(){this.selectedDot&&(this.selectedDot.className="dot",this.selectedDot.removeAttribute("aria-current")),this.dots.length&&(this.selectedDot=this.dots[this.parent.selectedIndex],this.selectedDot.className="dot is-selected",this.selectedDot.setAttribute("aria-current","step"))},n.prototype.onTap=n.prototype.onClick=function(t){var e=t.target;if("LI"==e.nodeName){this.parent.uiChange();var r=this.dots.indexOf(e);this.parent.select(r)}},n.prototype.destroy=function(){this.deactivate(),this.allOff()},e.PageDots=n,i.extend(e.defaults,{pageDots:!0}),e.createMethods.push("_createPageDots");var o=e.prototype;return o._createPageDots=function(){this.options.pageDots&&(this.pageDots=new n(this),this.on("activate",this.activatePageDots),this.on("select",this.updateSelectedPageDots),this.on("cellChange",this.updatePageDots),this.on("resize",this.updatePageDots),this.on("deactivate",this.deactivatePageDots))},o.activatePageDots=function(){this.pageDots.activate()},o.updateSelectedPageDots=function(){this.pageDots.updateSelected()},o.updatePageDots=function(){this.pageDots.setDots()},o.deactivatePageDots=function(){this.pageDots.deactivate()},e.PageDots=n,e}(0,t,e,r)}.apply(e,i))||(t.exports=n)},9453:(t,e,r)=>{var i,n;window,i=[r(2137),r(977),r(9249)],void 0===(n=function(t,e,r){return function(t,e,r){"use strict";function i(t){this.parent=t,this.state="stopped",this.onVisibilityChange=this.visibilityChange.bind(this),this.onVisibilityPlay=this.visibilityPlay.bind(this)}i.prototype=Object.create(t.prototype),i.prototype.play=function(){"playing"!=this.state&&(document.hidden?document.addEventListener("visibilitychange",this.onVisibilityPlay):(this.state="playing",document.addEventListener("visibilitychange",this.onVisibilityChange),this.tick()))},i.prototype.tick=function(){if("playing"==this.state){var t=this.parent.options.autoPlay;t="number"==typeof t?t:3e3;var e=this;this.clear(),this.timeout=setTimeout((function(){e.parent.next(!0),e.tick()}),t)}},i.prototype.stop=function(){this.state="stopped",this.clear(),document.removeEventListener("visibilitychange",this.onVisibilityChange)},i.prototype.clear=function(){clearTimeout(this.timeout)},i.prototype.pause=function(){"playing"==this.state&&(this.state="paused",this.clear())},i.prototype.unpause=function(){"paused"==this.state&&this.play()},i.prototype.visibilityChange=function(){this[document.hidden?"pause":"unpause"]()},i.prototype.visibilityPlay=function(){this.play(),document.removeEventListener("visibilitychange",this.onVisibilityPlay)},e.extend(r.defaults,{pauseAutoPlayOnHover:!0}),r.createMethods.push("_createPlayer");var n=r.prototype;return n._createPlayer=function(){this.player=new i(this),this.on("activate",this.activatePlayer),this.on("uiChange",this.stopPlayer),this.on("pointerDown",this.stopPlayer),this.on("deactivate",this.deactivatePlayer)},n.activatePlayer=function(){this.options.autoPlay&&(this.player.play(),this.element.addEventListener("mouseenter",this))},n.playPlayer=function(){this.player.play()},n.stopPlayer=function(){this.player.stop()},n.pausePlayer=function(){this.player.pause()},n.unpausePlayer=function(){this.player.unpause()},n.deactivatePlayer=function(){this.player.stop(),this.element.removeEventListener("mouseenter",this)},n.onmouseenter=function(){this.options.pauseAutoPlayOnHover&&(this.player.pause(),this.element.addEventListener("mouseleave",this))},n.onmouseleave=function(){this.player.unpause(),this.element.removeEventListener("mouseleave",this)},r.Player=i,r}(t,e,r)}.apply(e,i))||(t.exports=n)},7824:(t,e,r)=>{var i,n;window,i=[r(9249),r(2475),r(977)],void 0===(n=function(t,e,r){return function(t,e,r,i){"use strict";var n="http://www.w3.org/2000/svg";function o(t,e){this.direction=t,this.parent=e,this._create()}function s(t){return"string"==typeof t?t:"M "+t.x0+",50 L "+t.x1+","+(t.y1+50)+" L "+t.x2+","+(t.y2+50)+" L "+t.x3+",50  L "+t.x2+","+(50-t.y2)+" L "+t.x1+","+(50-t.y1)+" Z"}o.prototype=Object.create(r.prototype),o.prototype._create=function(){this.isEnabled=!0,this.isPrevious=-1==this.direction;var t=this.parent.options.rightToLeft?1:-1;this.isLeft=this.direction==t;var e=this.element=document.createElement("button");e.className="flickity-button flickity-prev-next-button",e.className+=this.isPrevious?" previous":" next",e.setAttribute("type","button"),this.disable(),e.setAttribute("aria-label",this.isPrevious?"Previous":"Next");var r=this.createSVG();e.appendChild(r),this.parent.on("select",this.update.bind(this)),this.on("pointerDown",this.parent.childUIPointerDown.bind(this.parent))},o.prototype.activate=function(){this.bindStartEvent(this.element),this.element.addEventListener("click",this),this.parent.element.appendChild(this.element)},o.prototype.deactivate=function(){this.parent.element.removeChild(this.element),this.unbindStartEvent(this.element),this.element.removeEventListener("click",this)},o.prototype.createSVG=function(){var t=document.createElementNS(n,"svg");t.setAttribute("class","flickity-button-icon"),t.setAttribute("viewBox","0 0 100 100");var e=document.createElementNS(n,"path"),r=s(this.parent.options.arrowShape);return e.setAttribute("d",r),e.setAttribute("class","arrow"),this.isLeft||e.setAttribute("transform","translate(100, 100) rotate(180) "),t.appendChild(e),t},o.prototype.handleEvent=i.handleEvent,o.prototype.onclick=function(){if(this.isEnabled){this.parent.uiChange();var t=this.isPrevious?"previous":"next";this.parent[t]()}},o.prototype.enable=function(){this.isEnabled||(this.element.disabled=!1,this.isEnabled=!0)},o.prototype.disable=function(){this.isEnabled&&(this.element.disabled=!0,this.isEnabled=!1)},o.prototype.update=function(){var t=this.parent.slides;if(this.parent.options.wrapAround&&t.length>1)this.enable();else{var e=t.length?t.length-1:0,r=this.isPrevious?0:e;this[this.parent.selectedIndex==r?"disable":"enable"]()}},o.prototype.destroy=function(){this.deactivate(),this.allOff()},i.extend(e.defaults,{prevNextButtons:!0,arrowShape:{x0:10,x1:60,y1:50,x2:70,y2:40,x3:30}}),e.createMethods.push("_createPrevNextButtons");var a=e.prototype;return a._createPrevNextButtons=function(){this.options.prevNextButtons&&(this.prevButton=new o(-1,this),this.nextButton=new o(1,this),this.on("activate",this.activatePrevNextButtons))},a.activatePrevNextButtons=function(){this.prevButton.activate(),this.nextButton.activate(),this.on("deactivate",this.deactivatePrevNextButtons)},a.deactivatePrevNextButtons=function(){this.prevButton.deactivate(),this.nextButton.deactivate(),this.off("deactivate",this.deactivatePrevNextButtons)},e.PrevNextButton=o,e}(0,t,e,r)}.apply(e,i))||(t.exports=n)},1331:(t,e,r)=>{var i,n;window,void 0===(n="function"==typeof(i=function(){"use strict";function t(t){this.parent=t,this.isOriginLeft="left"==t.originSide,this.cells=[],this.outerWidth=0,this.height=0}var e=t.prototype;return e.addCell=function(t){if(this.cells.push(t),this.outerWidth+=t.size.outerWidth,this.height=Math.max(t.size.outerHeight,this.height),1==this.cells.length){this.x=t.x;var e=this.isOriginLeft?"marginLeft":"marginRight";this.firstMargin=t.size[e]}},e.updateTarget=function(){var t=this.isOriginLeft?"marginRight":"marginLeft",e=this.getLastCell(),r=e?e.size[t]:0,i=this.outerWidth-(this.firstMargin+r);this.target=this.x+this.firstMargin+i*this.parent.cellAlign},e.getLastCell=function(){return this.cells[this.cells.length-1]},e.select=function(){this.cells.forEach((function(t){t.select()}))},e.unselect=function(){this.cells.forEach((function(t){t.unselect()}))},e.getCellElements=function(){return this.cells.map((function(t){return t.element}))},t})?i.call(e,r,e,t):i)||(t.exports=n)},1485:(t,e,r)=>{var i,n;window,void 0===(n="function"==typeof(i=function(){"use strict";function t(t){var e=parseFloat(t);return-1==t.indexOf("%")&&!isNaN(e)&&e}function e(){}var r="undefined"==typeof console?e:function(t){console.error(t)},i=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],n=i.length;function o(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;e<n;e++)t[i[e]]=0;return t}function s(t){var e=getComputedStyle(t);return e||r("Style returned "+e+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),e}var a,l=!1;function c(){if(!l){l=!0;var e=document.createElement("div");e.style.width="200px",e.style.padding="1px 2px 3px 4px",e.style.borderStyle="solid",e.style.borderWidth="1px 2px 3px 4px",e.style.boxSizing="border-box";var r=document.body||document.documentElement;r.appendChild(e);var i=s(e);a=200==Math.round(t(i.width)),u.isBoxSizeOuter=a,r.removeChild(e)}}function u(e){if(c(),"string"==typeof e&&(e=document.querySelector(e)),e&&"object"==typeof e&&e.nodeType){var r=s(e);if("none"==r.display)return o();var l={};l.width=e.offsetWidth,l.height=e.offsetHeight;for(var u=l.isBorderBox="border-box"==r.boxSizing,h=0;h<n;h++){var d=i[h],p=r[d],f=parseFloat(p);l[d]=isNaN(f)?0:f}var m=l.paddingLeft+l.paddingRight,g=l.paddingTop+l.paddingBottom,y=l.marginLeft+l.marginRight,v=l.marginTop+l.marginBottom,_=l.borderLeftWidth+l.borderRightWidth,b=l.borderTopWidth+l.borderBottomWidth,x=u&&a,w=t(r.width);!1!==w&&(l.width=w+(x?0:m+_));var T=t(r.height);return!1!==T&&(l.height=T+(x?0:g+b)),l.innerWidth=l.width-(m+_),l.innerHeight=l.height-(g+b),l.outerWidth=l.width+y,l.outerHeight=l.height+v,l}}return u})?i.call(e,r,e,t):i)||(t.exports=n)},1660:function(t){"undefined"!=typeof self&&self,t.exports=function(){"use strict";var t={3976:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default={_maxTestPos:500,placeholder:"_",optionalmarker:["[","]"],quantifiermarker:["{","}"],groupmarker:["(",")"],alternatormarker:"|",escapeChar:"\\",mask:null,regex:null,oncomplete:function(){},onincomplete:function(){},oncleared:function(){},repeat:0,greedy:!1,autoUnmask:!1,removeMaskOnSubmit:!1,clearMaskOnLostFocus:!0,insertMode:!0,insertModeVisual:!0,clearIncomplete:!1,alias:null,onKeyDown:function(){},onBeforeMask:null,onBeforePaste:function(t,e){return"function"==typeof e.onBeforeMask?e.onBeforeMask.call(this,t,e):t},onBeforeWrite:null,onUnMask:null,showMaskOnFocus:!0,showMaskOnHover:!0,onKeyValidation:function(){},skipOptionalPartCharacter:" ",numericInput:!1,rightAlign:!1,undoOnEscape:!0,radixPoint:"",_radixDance:!1,groupSeparator:"",keepStatic:null,positionCaretOnTab:!0,tabThrough:!1,supportsInputType:["text","tel","url","password","search"],isComplete:null,preValidation:null,postValidation:null,staticDefinitionSymbol:void 0,jitMasking:!1,nullable:!0,inputEventOnly:!1,noValuePatching:!1,positionCaretOnClick:"lvp",casing:null,inputmode:"text",importDataAttributes:!0,shiftPositions:!0,usePrototypeDefinitions:!0,validationEventTimeOut:3e3,substitutes:{}}},7392:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default={9:{validator:"[0-9０-９]",definitionSymbol:"*"},a:{validator:"[A-Za-zА-яЁёÀ-ÿµ]",definitionSymbol:"*"},"*":{validator:"[0-9０-９A-Za-zА-яЁёÀ-ÿµ]"}}},253:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r){if(void 0===r)return t.__data?t.__data[e]:null;t.__data=t.__data||{},t.__data[e]=r}},3776:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.Event=void 0,e.off=function(t,e){var r,i;return u(this[0])&&t&&(r=this[0].eventRegistry,i=this[0],t.split(" ").forEach((function(t){var n=s(t.split("."),2);(function(t,i){var n,o,s=[];if(t.length>0)if(void 0===e)for(n=0,o=r[t][i].length;n<o;n++)s.push({ev:t,namespace:i&&i.length>0?i:"global",handler:r[t][i][n]});else s.push({ev:t,namespace:i&&i.length>0?i:"global",handler:e});else if(i.length>0)for(var a in r)for(var l in r[a])if(l===i)if(void 0===e)for(n=0,o=r[a][l].length;n<o;n++)s.push({ev:a,namespace:l,handler:r[a][l][n]});else s.push({ev:a,namespace:l,handler:e});return s})(n[0],n[1]).forEach((function(t){var e=t.ev,n=t.handler;!function(t,e,n){if(t in r==1)if(i.removeEventListener?i.removeEventListener(t,n,!1):i.detachEvent&&i.detachEvent("on".concat(t),n),"global"===e)for(var o in r[t])r[t][o].splice(r[t][o].indexOf(n),1);else r[t][e].splice(r[t][e].indexOf(n),1)}(e,t.namespace,n)}))}))),this},e.on=function(t,e){if(u(this[0])){var r=this[0].eventRegistry,i=this[0];t.split(" ").forEach((function(t){var n=s(t.split("."),2),o=n[0],a=n[1];!function(t,n){i.addEventListener?i.addEventListener(t,e,!1):i.attachEvent&&i.attachEvent("on".concat(t),e),r[t]=r[t]||{},r[t][n]=r[t][n]||[],r[t][n].push(e)}(o,void 0===a?"global":a)}))}return this},e.trigger=function(t){var e=arguments;if(u(this[0]))for(var r=this[0].eventRegistry,i=this[0],s="string"==typeof t?t.split(" "):[t.type],a=0;a<s.length;a++){var l=s[a].split("."),h=l[0],d=l[1]||"global";if(void 0!==c&&"global"===d){var p,f={bubbles:!0,cancelable:!0,composed:!0,detail:arguments[1]};if(c.createEvent){try{"input"===h?(f.inputType="insertText",p=new InputEvent(h,f)):p=new CustomEvent(h,f)}catch(t){(p=c.createEvent("CustomEvent")).initCustomEvent(h,f.bubbles,f.cancelable,f.detail)}t.type&&(0,n.default)(p,t),i.dispatchEvent(p)}else(p=c.createEventObject()).eventType=h,p.detail=arguments[1],t.type&&(0,n.default)(p,t),i.fireEvent("on"+p.eventType,p)}else if(void 0!==r[h]){arguments[0]=arguments[0].type?arguments[0]:o.default.Event(arguments[0]),arguments[0].detail=arguments.slice(1);var m=r[h];("global"===d?Object.values(m).flat():m[d]).forEach((function(t){return t.apply(i,e)}))}}return this};var i=l(r(9380)),n=l(r(600)),o=l(r(4963));function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var i,n,o,s,a=[],l=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(i=o.call(r)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(t){c=!0,n=t}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function l(t){return t&&t.__esModule?t:{default:t}}var c=i.default.document;function u(t){return t instanceof Element}var h=e.Event=void 0;"function"==typeof i.default.CustomEvent?e.Event=h=i.default.CustomEvent:i.default.Event&&c&&c.createEvent?(e.Event=h=function(t,e){e=e||{bubbles:!1,cancelable:!1,composed:!0,detail:void 0};var r=c.createEvent("CustomEvent");return r.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),r},h.prototype=i.default.Event.prototype):"undefined"!=typeof Event&&(e.Event=h=Event)},600:function(t,e){function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function t(){var e,i,n,o,s,a,l=arguments[0]||{},c=1,u=arguments.length,h=!1;for("boolean"==typeof l&&(h=l,l=arguments[c]||{},c++),"object"!==r(l)&&"function"!=typeof l&&(l={});c<u;c++)if(null!=(e=arguments[c]))for(i in e)n=l[i],l!==(o=e[i])&&(h&&o&&("[object Object]"===Object.prototype.toString.call(o)||(s=Array.isArray(o)))?(s?(s=!1,a=n&&Array.isArray(n)?n:[]):a=n&&"[object Object]"===Object.prototype.toString.call(n)?n:{},l[i]=t(h,a,o)):void 0!==o&&(l[i]=o));return l}},4963:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(r(9380)),n=a(r(253)),o=r(3776),s=a(r(600));function a(t){return t&&t.__esModule?t:{default:t}}var l=i.default.document;function c(t){return t instanceof c?t:this instanceof c?void(null!=t&&t!==i.default&&(this[0]=t.nodeName?t:void 0!==t[0]&&t[0].nodeName?t[0]:l.querySelector(t),void 0!==this[0]&&null!==this[0]&&(this[0].eventRegistry=this[0].eventRegistry||{}))):new c(t)}c.prototype={on:o.on,off:o.off,trigger:o.trigger},c.extend=s.default,c.data=n.default,c.Event=o.Event,e.default=c},9845:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.mobile=e.iphone=e.ie=void 0;var i,n=(i=r(9380))&&i.__esModule?i:{default:i},o=n.default.navigator&&n.default.navigator.userAgent||"";e.ie=o.indexOf("MSIE ")>0||o.indexOf("Trident/")>0,e.mobile=n.default.navigator&&n.default.navigator.userAgentData&&n.default.navigator.userAgentData.mobile||n.default.navigator&&n.default.navigator.maxTouchPoints||"ontouchstart"in n.default,e.iphone=/iphone/i.test(o)},7184:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t.replace(r,"\\$1")};var r=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^"].join("|\\")+")","gim")},6030:function(t,e,r){function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.EventHandlers=void 0;var n,o=r(9845),s=(n=r(9380))&&n.__esModule?n:{default:n},a=r(7760),l=r(2839),c=r(8711),u=r(7215),h=r(4713);function d(){d=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function h(t,e,r,i){var n=e&&e.prototype instanceof _?e:_,s=Object.create(n.prototype),a=new O(i||[]);return o(s,"_invoke",{value:A(t,r,a)}),s}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",m="suspendedYield",g="executing",y="completed",v={};function _(){}function b(){}function x(){}var w={};u(w,a,(function(){return this}));var T=Object.getPrototypeOf,E=T&&T(T(L([])));E&&E!==r&&n.call(E,a)&&(w=E);var S=x.prototype=_.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,s,a,l){var c=p(t[o],t,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==i(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,l)}),(function(t){r("throw",t,a,l)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,l)}))}l(c.arg)}var s;o(this,"_invoke",{value:function(t,i){function n(){return new e((function(e,n){r(t,i,e,n)}))}return s=s?s.then(n,n):n()}})}function A(e,r,i){var n=f;return function(o,s){if(n===g)throw new Error("Generator is already running");if(n===y){if("throw"===o)throw s;return{value:t,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var l=M(a,i);if(l){if(l===v)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===f)throw n=y,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=g;var c=p(e,r,i);if("normal"===c.type){if(n=i.done?y:m,c.arg===v)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n=y,i.method="throw",i.arg=c.arg)}}}function M(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,M(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),v;var o=p(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function L(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,s=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(i(e)+" is not iterable")}return b.prototype=x,o(S,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:b,configurable:!0}),b.displayName=u(x,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,u(t,c,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},P(k.prototype),u(k.prototype,l,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new k(h(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},P(S),u(S,c,"Generator"),u(S,a,(function(){return this})),u(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=L,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(i,n){return a.type="throw",a.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;I(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:L(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),v}},e}function p(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return f(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function m(t,e,r,i,n,o,s){try{var a=t[o](s),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(i,n)}var g,y,v=e.EventHandlers={keyEvent:function(t,e,r,i,n){var s=this.inputmask,d=s.opts,p=s.dependencyLib,f=s.maskset,m=this,g=p(m),y=t.key,_=c.caret.call(s,m),b=d.onKeyDown.call(this,t,c.getBuffer.call(s),_,d);if(void 0!==b)return b;if(y===l.keys.Backspace||y===l.keys.Delete||o.iphone&&y===l.keys.BACKSPACE_SAFARI||t.ctrlKey&&y===l.keys.x&&!("oncut"in m))t.preventDefault(),u.handleRemove.call(s,m,y,_),(0,a.writeBuffer)(m,c.getBuffer.call(s,!0),f.p,t,m.inputmask._valueGet()!==c.getBuffer.call(s).join(""));else if(y===l.keys.End||y===l.keys.PageDown){t.preventDefault();var x=c.seekNext.call(s,c.getLastValidPosition.call(s));c.caret.call(s,m,t.shiftKey?_.begin:x,x,!0)}else y===l.keys.Home&&!t.shiftKey||y===l.keys.PageUp?(t.preventDefault(),c.caret.call(s,m,0,t.shiftKey?_.begin:0,!0)):d.undoOnEscape&&y===l.keys.Escape&&!0!==t.altKey?((0,a.checkVal)(m,!0,!1,s.undoValue.split("")),g.trigger("click")):y!==l.keys.Insert||t.shiftKey||t.ctrlKey||void 0!==s.userOptions.insertMode?!0===d.tabThrough&&y===l.keys.Tab?!0===t.shiftKey?(_.end=c.seekPrevious.call(s,_.end,!0),!0===h.getTest.call(s,_.end-1).match.static&&_.end--,_.begin=c.seekPrevious.call(s,_.end,!0),_.begin>=0&&_.end>0&&(t.preventDefault(),c.caret.call(s,m,_.begin,_.end))):(_.begin=c.seekNext.call(s,_.begin,!0),_.end=c.seekNext.call(s,_.begin,!0),_.end<f.maskLength&&_.end--,_.begin<=f.maskLength&&(t.preventDefault(),c.caret.call(s,m,_.begin,_.end))):t.shiftKey||(d.insertModeVisual&&!1===d.insertMode?y===l.keys.ArrowRight?setTimeout((function(){var t=c.caret.call(s,m);c.caret.call(s,m,t.begin)}),0):y===l.keys.ArrowLeft&&setTimeout((function(){var t=c.translatePosition.call(s,m.inputmask.caretPos.begin);c.translatePosition.call(s,m.inputmask.caretPos.end),s.isRTL?c.caret.call(s,m,t+(t===f.maskLength?0:1)):c.caret.call(s,m,t-(0===t?0:1))}),0):void 0===s.keyEventHook||s.keyEventHook(t)):u.isSelection.call(s,_)?d.insertMode=!d.insertMode:(d.insertMode=!d.insertMode,c.caret.call(s,m,_.begin,_.begin));return s.isComposing=y==l.keys.Process||y==l.keys.Unidentified,s.ignorable=y.length>1&&!("textarea"===m.tagName.toLowerCase()&&y==l.keys.Enter),v.keypressEvent.call(this,t,e,r,i,n)},keypressEvent:function(t,e,r,i,n){var o=this.inputmask||this,s=o.opts,h=o.dependencyLib,d=o.maskset,p=o.el,f=h(p),m=t.key;if(!0===e||t.ctrlKey&&t.altKey&&!o.ignorable||!(t.ctrlKey||t.metaKey||o.ignorable)){if(m){var g,y=e?{begin:n,end:n}:c.caret.call(o,p);e||(m=s.substitutes[m]||m),d.writeOutBuffer=!0;var v=u.isValid.call(o,y,m,i,void 0,void 0,void 0,e);if(!1!==v&&(c.resetMaskSet.call(o,!0),g=void 0!==v.caret?v.caret:c.seekNext.call(o,v.pos.begin?v.pos.begin:v.pos),d.p=g),g=s.numericInput&&void 0===v.caret?c.seekPrevious.call(o,g):g,!1!==r&&(setTimeout((function(){s.onKeyValidation.call(p,m,v)}),0),d.writeOutBuffer&&!1!==v)){var _=c.getBuffer.call(o);(0,a.writeBuffer)(p,_,g,t,!0!==e)}if(t.preventDefault(),e)return!1!==v&&(v.forwardPosition=g),v}}else m===l.keys.Enter&&o.undoValue!==o._valueGet(!0)&&(o.undoValue=o._valueGet(!0),setTimeout((function(){f.trigger("change")}),0))},pasteEvent:(g=d().mark((function t(e){var r,i,n,o,l,u;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=function(t,r,i,n,s){var l=c.caret.call(t,r,void 0,void 0,!0),u=i.substr(0,l.begin),h=i.substr(l.end,i.length);if(u==(t.isRTL?c.getBufferTemplate.call(t).slice().reverse():c.getBufferTemplate.call(t)).slice(0,l.begin).join("")&&(u=""),h==(t.isRTL?c.getBufferTemplate.call(t).slice().reverse():c.getBufferTemplate.call(t)).slice(l.end).join("")&&(h=""),n=u+n+h,t.isRTL&&!0!==o.numericInput){n=n.split("");var d,f=p(c.getBufferTemplate.call(t));try{for(f.s();!(d=f.n()).done;){var m=d.value;n[0]===m&&n.shift()}}catch(t){f.e(t)}finally{f.f()}n=n.reverse().join("")}var g=n;if("function"==typeof s){if(!1===(g=s.call(t,g,o)))return!1;g||(g=i)}(0,a.checkVal)(r,!0,!1,g.toString().split(""),e)},i=this,n=this.inputmask,o=n.opts,l=n._valueGet(!0),n.skipInputEvent=!0,e.clipboardData&&e.clipboardData.getData?u=e.clipboardData.getData("text/plain"):s.default.clipboardData&&s.default.clipboardData.getData&&(u=s.default.clipboardData.getData("Text")),r(n,i,l,u,o.onBeforePaste),e.preventDefault();case 7:case"end":return t.stop()}}),t,this)})),y=function(){var t=this,e=arguments;return new Promise((function(r,i){var n=g.apply(t,e);function o(t){m(n,r,i,o,s,"next",t)}function s(t){m(n,r,i,o,s,"throw",t)}o(void 0)}))},function(t){return y.apply(this,arguments)}),inputFallBackEvent:function(t){var e,r=this.inputmask,i=r.opts,n=r.dependencyLib,s=this,u=s.inputmask._valueGet(!0),d=(r.isRTL?c.getBuffer.call(r).slice().reverse():c.getBuffer.call(r)).join(""),p=c.caret.call(r,s,void 0,void 0,!0);if(d!==u){if(e=function(t,e,n){for(var o,s,a,l=t.substr(0,n.begin).split(""),u=t.substr(n.begin).split(""),d=e.substr(0,n.begin).split(""),p=e.substr(n.begin).split(""),f=l.length>=d.length?l.length:d.length,m=u.length>=p.length?u.length:p.length,g="",y=[],v="~";l.length<f;)l.push(v);for(;d.length<f;)d.push(v);for(;u.length<m;)u.unshift(v);for(;p.length<m;)p.unshift(v);var _=l.concat(u),b=d.concat(p);for(s=0,o=_.length;s<o;s++)switch(a=h.getPlaceholder.call(r,c.translatePosition.call(r,s)),g){case"insertText":b[s-1]===_[s]&&n.begin==_.length-1&&y.push(_[s]),s=o;break;case"insertReplacementText":case"deleteContentBackward":_[s]===v?n.end++:s=o;break;default:_[s]!==b[s]&&(_[s+1]!==v&&_[s+1]!==a&&void 0!==_[s+1]||(b[s]!==a||b[s+1]!==v)&&b[s]!==v?b[s+1]===v&&b[s]===_[s+1]?(g="insertText",y.push(_[s]),n.begin--,n.end--):_[s]!==a&&_[s]!==v&&(_[s+1]===v||b[s]!==_[s]&&b[s+1]===_[s+1])?(g="insertReplacementText",y.push(_[s]),n.begin--):_[s]===v?(g="deleteContentBackward",(c.isMask.call(r,c.translatePosition.call(r,s),!0)||b[s]===i.radixPoint)&&n.end++):s=o:(g="insertText",y.push(_[s]),n.begin--,n.end--))}return{action:g,data:y,caret:n}}(u,d,p),(s.inputmask.shadowRoot||s.ownerDocument).activeElement!==s&&s.focus(),(0,a.writeBuffer)(s,c.getBuffer.call(r)),c.caret.call(r,s,p.begin,p.end,!0),!o.mobile&&r.skipNextInsert&&"insertText"===t.inputType&&"insertText"===e.action&&r.isComposing)return!1;switch("insertCompositionText"===t.inputType&&"insertText"===e.action&&r.isComposing?r.skipNextInsert=!0:r.skipNextInsert=!1,e.action){case"insertText":case"insertReplacementText":e.data.forEach((function(t,e){var i=new n.Event("keypress");i.key=t,r.ignorable=!1,v.keypressEvent.call(s,i)})),setTimeout((function(){r.$el.trigger("keyup")}),0);break;case"deleteContentBackward":var f=new n.Event("keydown");f.key=l.keys.Backspace,v.keyEvent.call(s,f);break;default:(0,a.applyInputValue)(s,u),c.caret.call(r,s,p.begin,p.end,!0)}t.preventDefault()}},setValueEvent:function(t){var e=this.inputmask,r=e.dependencyLib,i=this,n=t&&t.detail?t.detail[0]:arguments[1];void 0===n&&(n=i.inputmask._valueGet(!0)),(0,a.applyInputValue)(i,n,new r.Event("input")),(t.detail&&void 0!==t.detail[1]||void 0!==arguments[2])&&c.caret.call(e,i,t.detail?t.detail[1]:arguments[2])},focusEvent:function(t){var e=this.inputmask,r=e.opts,i=e&&e._valueGet();r.showMaskOnFocus&&i!==c.getBuffer.call(e).join("")&&(0,a.writeBuffer)(this,c.getBuffer.call(e),c.seekNext.call(e,c.getLastValidPosition.call(e))),!0!==r.positionCaretOnTab||!1!==e.mouseEnter||u.isComplete.call(e,c.getBuffer.call(e))&&-1!==c.getLastValidPosition.call(e)||v.clickEvent.apply(this,[t,!0]),e.undoValue=e&&e._valueGet(!0)},invalidEvent:function(t){this.inputmask.validationEvent=!0},mouseleaveEvent:function(){var t=this.inputmask,e=t.opts,r=this;t.mouseEnter=!1,e.clearMaskOnLostFocus&&(r.inputmask.shadowRoot||r.ownerDocument).activeElement!==r&&(0,a.HandleNativePlaceholder)(r,t.originalPlaceholder)},clickEvent:function(t,e){var r=this.inputmask;r.clicked++;var i=this;if((i.inputmask.shadowRoot||i.ownerDocument).activeElement===i){var n=c.determineNewCaretPosition.call(r,c.caret.call(r,i),e);void 0!==n&&c.caret.call(r,i,n)}},cutEvent:function(t){var e=this.inputmask,r=e.maskset,i=this,n=c.caret.call(e,i),o=e.isRTL?c.getBuffer.call(e).slice(n.end,n.begin):c.getBuffer.call(e).slice(n.begin,n.end),h=e.isRTL?o.reverse().join(""):o.join("");s.default.navigator&&s.default.navigator.clipboard?s.default.navigator.clipboard.writeText(h):s.default.clipboardData&&s.default.clipboardData.getData&&s.default.clipboardData.setData("Text",h),u.handleRemove.call(e,i,l.keys.Delete,n),(0,a.writeBuffer)(i,c.getBuffer.call(e),r.p,t,e.undoValue!==e._valueGet(!0))},blurEvent:function(t){var e=this.inputmask,r=e.opts,i=e.dependencyLib;e.clicked=0;var n=i(this),o=this;if(o.inputmask){(0,a.HandleNativePlaceholder)(o,e.originalPlaceholder);var s=o.inputmask._valueGet(),l=c.getBuffer.call(e).slice();""!==s&&(r.clearMaskOnLostFocus&&(-1===c.getLastValidPosition.call(e)&&s===c.getBufferTemplate.call(e).join("")?l=[]:a.clearOptionalTail.call(e,l)),!1===u.isComplete.call(e,l)&&(setTimeout((function(){n.trigger("incomplete")}),0),r.clearIncomplete&&(c.resetMaskSet.call(e,!1),l=r.clearMaskOnLostFocus?[]:c.getBufferTemplate.call(e).slice())),(0,a.writeBuffer)(o,l,void 0,t)),s=e._valueGet(!0),e.undoValue!==s&&(""!=s||e.undoValue!=c.getBufferTemplate.call(e).join("")||e.undoValue==c.getBufferTemplate.call(e).join("")&&e.maskset.validPositions.length>0)&&(e.undoValue=s,n.trigger("change"))}},mouseenterEvent:function(){var t=this.inputmask,e=t.opts.showMaskOnHover,r=this;if(t.mouseEnter=!0,(r.inputmask.shadowRoot||r.ownerDocument).activeElement!==r){var i=(t.isRTL?c.getBufferTemplate.call(t).slice().reverse():c.getBufferTemplate.call(t)).join("");e&&(0,a.HandleNativePlaceholder)(r,i)}},submitEvent:function(){var t=this.inputmask,e=t.opts;t.undoValue!==t._valueGet(!0)&&t.$el.trigger("change"),-1===c.getLastValidPosition.call(t)&&t._valueGet&&t._valueGet()===c.getBufferTemplate.call(t).join("")&&t._valueSet(""),e.clearIncomplete&&!1===u.isComplete.call(t,c.getBuffer.call(t))&&t._valueSet(""),e.removeMaskOnSubmit&&(t._valueSet(t.unmaskedvalue(),!0),setTimeout((function(){(0,a.writeBuffer)(t.el,c.getBuffer.call(t))}),0))},resetEvent:function(){var t=this.inputmask;t.refreshValue=!0,setTimeout((function(){(0,a.applyInputValue)(t.el,t._valueGet(!0))}),0)}}},9716:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.EventRuler=void 0;var i,n=r(7760),o=(i=r(2394))&&i.__esModule?i:{default:i},s=r(2839),a=r(8711);e.EventRuler={on:function(t,e,r){var i=t.inputmask.dependencyLib,l=function(e){e.originalEvent&&(e=e.originalEvent||e,arguments[0]=e);var l,c=this,u=c.inputmask,h=u?u.opts:void 0;if(void 0===u&&"FORM"!==this.nodeName){var d=i.data(c,"_inputmask_opts");i(c).off(),d&&new o.default(d).mask(c)}else{if(["submit","reset","setvalue"].includes(e.type)||"FORM"===this.nodeName||!(c.disabled||c.readOnly&&!("keydown"===e.type&&e.ctrlKey&&e.key===s.keys.c||!1===h.tabThrough&&e.key===s.keys.Tab))){switch(e.type){case"input":if(!0===u.skipInputEvent)return u.skipInputEvent=!1,e.preventDefault();break;case"click":case"focus":return u.validationEvent?(u.validationEvent=!1,t.blur(),(0,n.HandleNativePlaceholder)(t,(u.isRTL?a.getBufferTemplate.call(u).slice().reverse():a.getBufferTemplate.call(u)).join("")),setTimeout((function(){t.focus()}),h.validationEventTimeOut),!1):(l=arguments,void setTimeout((function(){t.inputmask&&r.apply(c,l)}),0))}var p=r.apply(c,arguments);return!1===p&&(e.preventDefault(),e.stopPropagation()),p}e.preventDefault()}};["submit","reset"].includes(e)?(l=l.bind(t),null!==t.form&&i(t.form).on(e,l)):i(t).on(e,l),t.inputmask.events[e]=t.inputmask.events[e]||[],t.inputmask.events[e].push(l)},off:function(t,e){if(t.inputmask&&t.inputmask.events){var r=t.inputmask.dependencyLib,i=t.inputmask.events;for(var n in e&&((i=[])[e]=t.inputmask.events[e]),i){for(var o=i[n];o.length>0;){var s=o.pop();["submit","reset"].includes(n)?null!==t.form&&r(t.form).off(n,s):r(t).off(n,s)}delete t.inputmask.events[n]}}}}},219:function(t,e,r){var i=d(r(7184)),n=d(r(2394)),o=r(2839),s=r(8711),a=r(4713);function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var i,n,o,s,a=[],l=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(i=o.call(r)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(t){c=!0,n=t}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function h(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(n=void 0,n=function(t,e){if("object"!==u(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!==u(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i.key,"string"),"symbol"===u(n)?n:String(n)),i)}var n}function d(t){return t&&t.__esModule?t:{default:t}}r(1313);var p=n.default.dependencyLib,f=function(){function t(e,r,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mask=e,this.format=r,this.opts=i,this.inputmask=n,this._date=new Date(1,0,1),this.initDateObject(e,this.opts,this.inputmask)}var e,r,i;return e=t,(r=[{key:"date",get:function(){return void 0===this._date&&(this._date=new Date(1,0,1),this.initDateObject(void 0,this.opts,this.inputmask)),this._date}},{key:"initDateObject",value:function(t,e,r){var i;for(T(e).lastIndex=0;i=T(e).exec(this.format);){var n=/\d+$/.exec(i[0]),o=n?i[0][0]+"x":i[0],s=void 0;if(void 0!==t){if(n){var l=T(e).lastIndex,c=M.call(r,i.index,e,r&&r.maskset);T(e).lastIndex=l,s=t.slice(0,t.indexOf(c.nextMatch[0]))}else{for(var u=i[0][0],h=i.index;r&&(e.placeholder[a.getTest.call(r,h).match.placeholder]||a.getTest.call(r,h).match.placeholder)===u;)h++;var d=h-i.index;s=t.slice(0,d||v[o]&&v[o][4]||o.length)}t=t.slice(s.length)}Object.prototype.hasOwnProperty.call(v,o)&&this.setValue(this,s,o,v[o][2],v[o][1])}}},{key:"setValue",value:function(t,e,r,i,n){if(void 0!==e)switch(i){case"ampm":t[i]=e,t["raw"+i]=e.replace(/\s/g,"_");break;case"month":if("mmm"===r||"mmmm"===r){t[i]=P("mmm"===r?g.monthNames.slice(0,12).findIndex((function(t){return e.toLowerCase()===t.toLowerCase()}))+1:g.monthNames.slice(12,24).findIndex((function(t){return e.toLowerCase()===t.toLowerCase()}))+1,2),t[i]="00"===t[i]?"":t[i].toString(),t["raw"+i]=t[i];break}default:t[i]=e.replace(/[^0-9]/g,"0"),t["raw"+i]=e.replace(/\s/g,"_")}if(void 0!==n){var o=t[i];("day"===i&&29===parseInt(o)||"month"===i&&2===parseInt(o))&&(29!==parseInt(t.day)||2!==parseInt(t.month)||""!==t.year&&void 0!==t.year||t._date.setFullYear(2012,1,29)),"day"===i&&(y=!0,0===parseInt(o)&&(o=1)),"month"===i&&(y=!0),"year"===i&&(y=!0,o.length<v[r][4]&&(o=P(o,v[r][4],!0))),(""!==o&&!isNaN(o)||"ampm"===i)&&n.call(t._date,o)}}},{key:"reset",value:function(){this._date=new Date(1,0,1)}},{key:"reInit",value:function(){this._date=void 0,this.date}}])&&h(e.prototype,r),i&&h(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}(),m=(new Date).getFullYear(),g=n.default.prototype.i18n,y=!1,v={d:["[1-9]|[12][0-9]|3[01]",Date.prototype.setDate,"day",Date.prototype.getDate],dd:["0[1-9]|[12][0-9]|3[01]",Date.prototype.setDate,"day",function(){return P(Date.prototype.getDate.call(this),2)}],ddd:[""],dddd:[""],m:["[1-9]|1[012]",function(t){var e=t?parseInt(t):0;return e>0&&e--,Date.prototype.setMonth.call(this,e)},"month",function(){return Date.prototype.getMonth.call(this)+1}],mm:["0[1-9]|1[012]",function(t){var e=t?parseInt(t):0;return e>0&&e--,Date.prototype.setMonth.call(this,e)},"month",function(){return P(Date.prototype.getMonth.call(this)+1,2)}],mmm:[g.monthNames.slice(0,12).join("|"),function(t){var e=g.monthNames.slice(0,12).findIndex((function(e){return t.toLowerCase()===e.toLowerCase()}));return-1!==e&&Date.prototype.setMonth.call(this,e)},"month",function(){return g.monthNames.slice(0,12)[Date.prototype.getMonth.call(this)]}],mmmm:[g.monthNames.slice(12,24).join("|"),function(t){var e=g.monthNames.slice(12,24).findIndex((function(e){return t.toLowerCase()===e.toLowerCase()}));return-1!==e&&Date.prototype.setMonth.call(this,e)},"month",function(){return g.monthNames.slice(12,24)[Date.prototype.getMonth.call(this)]}],yy:["[0-9]{2}",function(t){var e=(new Date).getFullYear().toString().slice(0,2);Date.prototype.setFullYear.call(this,"".concat(e).concat(t))},"year",function(){return P(Date.prototype.getFullYear.call(this),2)},2],yyyy:["[0-9]{4}",Date.prototype.setFullYear,"year",function(){return P(Date.prototype.getFullYear.call(this),4)},4],h:["[1-9]|1[0-2]",Date.prototype.setHours,"hours",Date.prototype.getHours],hh:["0[1-9]|1[0-2]",Date.prototype.setHours,"hours",function(){return P(Date.prototype.getHours.call(this),2)}],hx:[function(t){return"[0-9]{".concat(t,"}")},Date.prototype.setHours,"hours",function(t){return Date.prototype.getHours}],H:["1?[0-9]|2[0-3]",Date.prototype.setHours,"hours",Date.prototype.getHours],HH:["0[0-9]|1[0-9]|2[0-3]",Date.prototype.setHours,"hours",function(){return P(Date.prototype.getHours.call(this),2)}],Hx:[function(t){return"[0-9]{".concat(t,"}")},Date.prototype.setHours,"hours",function(t){return function(){return P(Date.prototype.getHours.call(this),t)}}],M:["[1-5]?[0-9]",Date.prototype.setMinutes,"minutes",Date.prototype.getMinutes],MM:["0[0-9]|1[0-9]|2[0-9]|3[0-9]|4[0-9]|5[0-9]",Date.prototype.setMinutes,"minutes",function(){return P(Date.prototype.getMinutes.call(this),2)}],s:["[1-5]?[0-9]",Date.prototype.setSeconds,"seconds",Date.prototype.getSeconds],ss:["0[0-9]|1[0-9]|2[0-9]|3[0-9]|4[0-9]|5[0-9]",Date.prototype.setSeconds,"seconds",function(){return P(Date.prototype.getSeconds.call(this),2)}],l:["[0-9]{3}",Date.prototype.setMilliseconds,"milliseconds",function(){return P(Date.prototype.getMilliseconds.call(this),3)},3],L:["[0-9]{2}",Date.prototype.setMilliseconds,"milliseconds",function(){return P(Date.prototype.getMilliseconds.call(this),2)},2],t:["[ap]",b,"ampm",x,1],tt:["[ap]m",b,"ampm",x,2],T:["[AP]",b,"ampm",x,1],TT:["[AP]M",b,"ampm",x,2],Z:[".*",void 0,"Z",function(){var t=this.toString().match(/\((.+)\)/)[1];return t.includes(" ")&&(t=(t=t.replace("-"," ").toUpperCase()).split(" ").map((function(t){return l(t,1)[0]})).join("")),t}],o:[""],S:[""]},_={isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};function b(t){var e=this.getHours();t.toLowerCase().includes("p")?this.setHours(e+12):t.toLowerCase().includes("a")&&e>=12&&this.setHours(e-12)}function x(){var t=this.getHours();return(t=t||12)>=12?"PM":"AM"}function w(t){var e=/\d+$/.exec(t[0]);if(e&&void 0!==e[0]){var r=v[t[0][0]+"x"].slice("");return r[0]=r[0](e[0]),r[3]=r[3](e[0]),r}if(v[t[0]])return v[t[0]]}function T(t){if(!t.tokenizer){var e=[],r=[];for(var i in v)if(/\.*x$/.test(i)){var n=i[0]+"\\d+";-1===r.indexOf(n)&&r.push(n)}else-1===e.indexOf(i[0])&&e.push(i[0]);t.tokenizer="("+(r.length>0?r.join("|")+"|":"")+e.join("+|")+")+?|.",t.tokenizer=new RegExp(t.tokenizer,"g")}return t.tokenizer}function E(t,e,r){if(!y)return!0;if(void 0===t.rawday||!isFinite(t.rawday)&&new Date(t.date.getFullYear(),isFinite(t.rawmonth)?t.month:t.date.getMonth()+1,0).getDate()>=t.day||"29"==t.day&&(!isFinite(t.rawyear)||void 0===t.rawyear||""===t.rawyear)||new Date(t.date.getFullYear(),isFinite(t.rawmonth)?t.month:t.date.getMonth()+1,0).getDate()>=t.day)return e;if("29"==t.day){var i=M.call(this,e.pos,r,this.maskset);if(i.targetMatch&&"yyyy"===i.targetMatch[0]&&e.pos-i.targetMatchIndex==2)return e.remove=e.pos+1,e}else if(2==t.date.getMonth()&&"30"==t.day&&void 0!==e.c)return t.day="03",t.date.setDate(3),t.date.setMonth(1),e.insert=[{pos:e.pos,c:"0"},{pos:e.pos+1,c:e.c}],e.caret=s.seekNext.call(this,e.pos+1),e;return!1}function S(t,e,r,n){var o,s,a="",l=0,c={};for(T(r).lastIndex=0;o=T(r).exec(t);){if(void 0===e)if(s=w(o))a+="("+s[0]+")",r.placeholder&&""!==r.placeholder?(c[l]=r.placeholder[o.index%r.placeholder.length],c[r.placeholder[o.index%r.placeholder.length]]=o[0].charAt(0)):c[l]=o[0].charAt(0);else switch(o[0]){case"[":a+="(";break;case"]":a+=")?";break;default:a+=(0,i.default)(o[0]),c[l]=o[0].charAt(0)}else(s=w(o))?!0!==n&&s[3]?a+=s[3].call(e.date):s[2]?a+=e["raw"+s[2]]:a+=o[0]:a+=o[0];l++}return void 0===e&&(r.placeholder=c),a}function P(t,e,r){for(t=String(t),e=e||2;t.length<e;)t=r?t+"0":"0"+t;return t}function k(t,e,r){return"string"==typeof t?new f(t,e,r,this):t&&"object"===u(t)&&Object.prototype.hasOwnProperty.call(t,"date")?t:void 0}function A(t,e){return S(e.inputFormat,{date:t},e)}function M(t,e,r){var i,n,o=this,s=r&&r.tests[t]?e.placeholder[r.tests[t][0].match.placeholder]||r.tests[t][0].match.placeholder:"",l=0,c=0;for(T(e).lastIndex=0;n=T(e).exec(e.inputFormat);){var u=/\d+$/.exec(n[0]);if(u)c=parseInt(u[0]);else{for(var h=n[0][0],d=l;o&&(e.placeholder[a.getTest.call(o,d).match.placeholder]||a.getTest.call(o,d).match.placeholder)===h;)d++;0==(c=d-l)&&(c=n[0].length)}if(l+=c,-1!=n[0].indexOf(s)||l>=t+1){i=n,n=T(e).exec(e.inputFormat);break}}return{targetMatchIndex:l-c,nextMatch:n,targetMatch:i}}n.default.extendAliases({datetime:{mask:function(t){return t.numericInput=!1,v.S=g.ordinalSuffix.join("|"),t.inputFormat=_[t.inputFormat]||t.inputFormat,t.displayFormat=_[t.displayFormat]||t.displayFormat||t.inputFormat,t.outputFormat=_[t.outputFormat]||t.outputFormat||t.inputFormat,t.regex=S(t.inputFormat,void 0,t),t.min=k(t.min,t.inputFormat,t),t.max=k(t.max,t.inputFormat,t),null},placeholder:"",inputFormat:"isoDateTime",displayFormat:null,outputFormat:null,min:null,max:null,skipOptionalPartCharacter:"",preValidation:function(t,e,r,i,n,o,s,a){if(a)return!0;if(isNaN(r)&&t[e]!==r){var l=M.call(this,e,n,o);if(l.nextMatch&&l.nextMatch[0]===r&&l.targetMatch[0].length>1){var c=w(l.targetMatch)[0];if(new RegExp(c).test("0"+t[e-1]))return t[e]=t[e-1],t[e-1]="0",{fuzzy:!0,buffer:t,refreshFromBuffer:{start:e-1,end:e+1},pos:e+1}}}return!0},postValidation:function(t,e,r,i,n,o,s,l){var c,u,h=this;if(s)return!0;if(!1===i&&(((c=M.call(h,e+1,n,o)).targetMatch&&c.targetMatchIndex===e&&c.targetMatch[0].length>1&&void 0!==v[c.targetMatch[0]]||(c=M.call(h,e+2,n,o)).targetMatch&&c.targetMatchIndex===e+1&&c.targetMatch[0].length>1&&void 0!==v[c.targetMatch[0]])&&(u=w(c.targetMatch)[0]),void 0!==u&&(void 0!==o.validPositions[e+1]&&new RegExp(u).test(r+"0")?(t[e]=r,t[e+1]="0",i={pos:e+2,caret:e}):new RegExp(u).test("0"+r)&&(t[e]="0",t[e+1]=r,i={pos:e+2})),!1===i))return i;if(i.fuzzy&&(t=i.buffer,e=i.pos),(c=M.call(h,e,n,o)).targetMatch&&c.targetMatch[0]&&void 0!==v[c.targetMatch[0]]){var d=w(c.targetMatch);u=d[0];var p=t.slice(c.targetMatchIndex,c.targetMatchIndex+c.targetMatch[0].length);if(!1===new RegExp(u).test(p.join(""))&&2===c.targetMatch[0].length&&o.validPositions[c.targetMatchIndex]&&o.validPositions[c.targetMatchIndex+1]&&(o.validPositions[c.targetMatchIndex+1].input="0"),"year"==d[2])for(var f=a.getMaskTemplate.call(h,!1,1,void 0,!0),g=e+1;g<t.length;g++)t[g]=f[g],o.validPositions.splice(e+1,1)}var y=i,_=k.call(h,t.join(""),n.inputFormat,n);return y&&!isNaN(_.date.getTime())&&(n.prefillYear&&(y=function(t,e,r){if(t.year!==t.rawyear){var i=m.toString(),n=t.rawyear.replace(/[^0-9]/g,""),o=i.slice(0,n.length),s=i.slice(n.length);if(2===n.length&&n===o){var a=new Date(m,t.month-1,t.day);t.day==a.getDate()&&(!r.max||r.max.date.getTime()>=a.getTime())&&(t.date.setFullYear(m),t.year=i,e.insert=[{pos:e.pos+1,c:s[0]},{pos:e.pos+2,c:s[1]}])}}return e}(_,y,n)),y=function(t,e,r,i,n){if(!e)return e;if(e&&r.min&&!isNaN(r.min.date.getTime())){var o;for(t.reset(),T(r).lastIndex=0;o=T(r).exec(r.inputFormat);){var s;if((s=w(o))&&s[3]){for(var a=s[1],l=t[s[2]],c=r.min[s[2]],u=r.max?r.max[s[2]]:c+1,h=[],d=!1,p=0;p<c.length;p++)void 0!==i.validPositions[p+o.index]||d?(h[p]=l[p],d=d||l[p]>c[p]):(p+o.index==0&&l[p]<c[p]?(h[p]=l[p],d=!0):h[p]=c[p],"year"===s[2]&&l.length-1==p&&c!=u&&(h=(parseInt(h.join(""))+1).toString().split("")),"ampm"===s[2]&&c!=u&&r.min.date.getTime()>t.date.getTime()&&(h[p]=u[p]));a.call(t._date,h.join(""))}}e=r.min.date.getTime()<=t.date.getTime(),t.reInit()}return e&&r.max&&(isNaN(r.max.date.getTime())||(e=r.max.date.getTime()>=t.date.getTime())),e}(_,y=E.call(h,_,y,n),n,o)),void 0!==e&&y&&i.pos!==e?{buffer:S(n.inputFormat,_,n).split(""),refreshFromBuffer:{start:e,end:i.pos},pos:i.caret||i.pos}:y},onKeyDown:function(t,e,r,i){t.ctrlKey&&t.key===o.keys.ArrowRight&&(this.inputmask._valueSet(A(new Date,i)),p(this).trigger("setvalue"))},onUnMask:function(t,e,r){return e?S(r.outputFormat,k.call(this,t,r.inputFormat,r),r,!0):e},casing:function(t,e,r,i){if(0==e.nativeDef.indexOf("[ap]"))return t.toLowerCase();if(0==e.nativeDef.indexOf("[AP]"))return t.toUpperCase();var n=a.getTest.call(this,[r-1]);return 0==n.match.def.indexOf("[AP]")||0===r||n&&n.input===String.fromCharCode(o.keyCode.Space)||n&&n.match.def===String.fromCharCode(o.keyCode.Space)?t.toUpperCase():t.toLowerCase()},onBeforeMask:function(t,e){return"[object Date]"===Object.prototype.toString.call(t)&&(t=A(t,e)),t},insertMode:!1,insertModeVisual:!1,shiftPositions:!1,keepStatic:!1,inputmode:"numeric",prefillYear:!0}})},1313:function(t,e,r){var i,n=(i=r(2394))&&i.__esModule?i:{default:i};n.default.dependencyLib.extend(!0,n.default.prototype.i18n,{dayNames:["Mon","Tue","Wed","Thu","Fri","Sat","Sun","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],ordinalSuffix:["st","nd","rd","th"]})},3851:function(t,e,r){var i,n=(i=r(2394))&&i.__esModule?i:{default:i},o=r(8711),s=r(4713);function a(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}n.default.extendDefinitions({A:{validator:"[A-Za-zА-яЁёÀ-ÿµ]",casing:"upper"},"&":{validator:"[0-9A-Za-zА-яЁёÀ-ÿµ]",casing:"upper"},"#":{validator:"[0-9A-Fa-f]",casing:"upper"}});var c=/25[0-5]|2[0-4][0-9]|[01][0-9][0-9]/;function u(t,e,r,i,n){if(r-1>-1&&"."!==e.buffer[r-1]?(t=e.buffer[r-1]+t,t=r-2>-1&&"."!==e.buffer[r-2]?e.buffer[r-2]+t:"0"+t):t="00"+t,n.greedy&&parseInt(t)>255&&c.test("00"+t.charAt(2))){var o=[].concat(a(e.buffer.slice(0,r)),[".",t.charAt(2)]);if(o.join("").match(/\./g).length<4)return{refreshFromBuffer:!0,buffer:o,caret:r+2}}return c.test(t)}n.default.extendAliases({cssunit:{regex:"[+-]?[0-9]+\\.?([0-9]+)?(px|em|rem|ex|%|in|cm|mm|pt|pc)"},url:{regex:"(https?|ftp)://.*",autoUnmask:!1,keepStatic:!1,tabThrough:!0},ip:{mask:"i{1,3}.j{1,3}.k{1,3}.l{1,3}",definitions:{i:{validator:u},j:{validator:u},k:{validator:u},l:{validator:u}},onUnMask:function(t,e,r){return t},inputmode:"decimal",substitutes:{",":"."}},email:{mask:function(t){var e=t.separator,r=t.quantifier,i="*{1,64}[.*{1,64}][.*{1,64}][.*{1,63}]@-{1,63}.-{1,63}[.-{1,63}][.-{1,63}]",n=i;if(e)for(var o=0;o<r;o++)n+="[".concat(e).concat(i,"]");return n},greedy:!1,casing:"lower",separator:null,quantifier:5,skipOptionalPartCharacter:"",onBeforePaste:function(t,e){return(t=t.toLowerCase()).replace("mailto:","")},definitions:{"*":{validator:"[0-9１-９A-Za-zА-яЁёÀ-ÿµ!#$%&'*+/=?^_`{|}~-]"},"-":{validator:"[0-9A-Za-z-]"}},onUnMask:function(t,e,r){return t},inputmode:"email"},mac:{mask:"##:##:##:##:##:##"},vin:{mask:"V{13}9{4}",definitions:{V:{validator:"[A-HJ-NPR-Za-hj-npr-z\\d]",casing:"upper"}},clearIncomplete:!0,autoUnmask:!0},ssn:{mask:"999-99-9999",postValidation:function(t,e,r,i,n,a,l){var c=s.getMaskTemplate.call(this,!0,o.getLastValidPosition.call(this),!0,!0);return/^(?!219-09-9999|078-05-1120)(?!666|000|9.{2}).{3}-(?!00).{2}-(?!0{4}).{4}$/.test(c.join(""))}}})},207:function(t,e,r){var i=a(r(7184)),n=a(r(2394)),o=r(2839),s=r(8711);function a(t){return t&&t.__esModule?t:{default:t}}var l=n.default.dependencyLib;function c(t,e){for(var r="",i=0;i<t.length;i++)n.default.prototype.definitions[t.charAt(i)]||e.definitions[t.charAt(i)]||e.optionalmarker[0]===t.charAt(i)||e.optionalmarker[1]===t.charAt(i)||e.quantifiermarker[0]===t.charAt(i)||e.quantifiermarker[1]===t.charAt(i)||e.groupmarker[0]===t.charAt(i)||e.groupmarker[1]===t.charAt(i)||e.alternatormarker===t.charAt(i)?r+="\\"+t.charAt(i):r+=t.charAt(i);return r}function u(t,e,r,i){if(t.length>0&&e>0&&(!r.digitsOptional||i)){var n=t.indexOf(r.radixPoint),o=!1;r.negationSymbol.back===t[t.length-1]&&(o=!0,t.length--),-1===n&&(t.push(r.radixPoint),n=t.length-1);for(var s=1;s<=e;s++)isFinite(t[n+s])||(t[n+s]="0")}return o&&t.push(r.negationSymbol.back),t}function h(t,e){var r=0;for(var i in"+"===t&&(r=s.seekNext.call(this,e.validPositions.length-1)),e.tests)if((i=parseInt(i))>=r)for(var n=0,o=e.tests[i].length;n<o;n++)if((void 0===e.validPositions[i]||"-"===t)&&e.tests[i][n].match.def===t)return i+(void 0!==e.validPositions[i]&&"-"!==t?1:0);return r}function d(t,e){for(var r=-1,i=0,n=e.validPositions.length;i<n;i++){var o=e.validPositions[i];if(o&&o.match.def===t){r=i;break}}return r}function p(t,e,r,i,n){var o=e.buffer?e.buffer.indexOf(n.radixPoint):-1,s=(-1!==o||i&&n.jitMasking)&&new RegExp(n.definitions[9].validator).test(t);return!i&&n._radixDance&&-1!==o&&s&&null==e.validPositions[o]?{insert:{pos:o===r?o+1:o,c:n.radixPoint},pos:r}:s}n.default.extendAliases({numeric:{mask:function(t){t.repeat=0,t.groupSeparator===t.radixPoint&&t.digits&&"0"!==t.digits&&("."===t.radixPoint?t.groupSeparator=",":","===t.radixPoint?t.groupSeparator=".":t.groupSeparator="")," "===t.groupSeparator&&(t.skipOptionalPartCharacter=void 0),t.placeholder.length>1&&(t.placeholder=t.placeholder.charAt(0)),"radixFocus"===t.positionCaretOnClick&&""===t.placeholder&&(t.positionCaretOnClick="lvp");var e="0",r=t.radixPoint;!0===t.numericInput&&void 0===t.__financeInput?(e="1",t.positionCaretOnClick="radixFocus"===t.positionCaretOnClick?"lvp":t.positionCaretOnClick,t.digitsOptional=!1,isNaN(t.digits)&&(t.digits=2),t._radixDance=!1,r=","===t.radixPoint?"?":"!",""!==t.radixPoint&&void 0===t.definitions[r]&&(t.definitions[r]={},t.definitions[r].validator="["+t.radixPoint+"]",t.definitions[r].placeholder=t.radixPoint,t.definitions[r].static=!0,t.definitions[r].generated=!0)):(t.__financeInput=!1,t.numericInput=!0);var n,o="[+]";if(o+=c(t.prefix,t),""!==t.groupSeparator?(void 0===t.definitions[t.groupSeparator]&&(t.definitions[t.groupSeparator]={},t.definitions[t.groupSeparator].validator="["+t.groupSeparator+"]",t.definitions[t.groupSeparator].placeholder=t.groupSeparator,t.definitions[t.groupSeparator].static=!0,t.definitions[t.groupSeparator].generated=!0),o+=t._mask(t)):o+="9{+}",void 0!==t.digits&&0!==t.digits){var s=t.digits.toString().split(",");isFinite(s[0])&&s[1]&&isFinite(s[1])?o+=r+e+"{"+t.digits+"}":(isNaN(t.digits)||parseInt(t.digits)>0)&&(t.digitsOptional||t.jitMasking?(n=o+r+e+"{0,"+t.digits+"}",t.keepStatic=!0):o+=r+e+"{"+t.digits+"}")}else t.inputmode="numeric";return o+=c(t.suffix,t),o+="[-]",n&&(o=[n+c(t.suffix,t)+"[-]",o]),t.greedy=!1,function(t){void 0===t.parseMinMaxOptions&&(null!==t.min&&(t.min=t.min.toString().replace(new RegExp((0,i.default)(t.groupSeparator),"g"),""),","===t.radixPoint&&(t.min=t.min.replace(t.radixPoint,".")),t.min=isFinite(t.min)?parseFloat(t.min):NaN,isNaN(t.min)&&(t.min=Number.MIN_VALUE)),null!==t.max&&(t.max=t.max.toString().replace(new RegExp((0,i.default)(t.groupSeparator),"g"),""),","===t.radixPoint&&(t.max=t.max.replace(t.radixPoint,".")),t.max=isFinite(t.max)?parseFloat(t.max):NaN,isNaN(t.max)&&(t.max=Number.MAX_VALUE)),t.parseMinMaxOptions="done")}(t),""!==t.radixPoint&&t.substituteRadixPoint&&(t.substitutes["."==t.radixPoint?",":"."]=t.radixPoint),o},_mask:function(t){return"("+t.groupSeparator+"999){+|1}"},digits:"*",digitsOptional:!0,enforceDigitsOnBlur:!1,radixPoint:".",positionCaretOnClick:"radixFocus",_radixDance:!0,groupSeparator:"",allowMinus:!0,negationSymbol:{front:"-",back:""},prefix:"",suffix:"",min:null,max:null,SetMaxOnOverflow:!1,step:1,inputType:"text",unmaskAsNumber:!1,roundingFN:Math.round,inputmode:"decimal",shortcuts:{k:"1000",m:"1000000"},placeholder:"0",greedy:!1,rightAlign:!0,insertMode:!0,autoUnmask:!1,skipOptionalPartCharacter:"",usePrototypeDefinitions:!1,stripLeadingZeroes:!0,substituteRadixPoint:!0,definitions:{0:{validator:p},1:{validator:p,definitionSymbol:"9"},9:{validator:"[0-9０-９٠-٩۰-۹]",definitionSymbol:"*"},"+":{validator:function(t,e,r,i,n){return n.allowMinus&&("-"===t||t===n.negationSymbol.front)}},"-":{validator:function(t,e,r,i,n){return n.allowMinus&&t===n.negationSymbol.back}}},preValidation:function(t,e,r,i,n,o,s,a){var l=this;if(!1!==n.__financeInput&&r===n.radixPoint)return!1;var c=t.indexOf(n.radixPoint),u=e;if(e=function(t,e,r,i,n){return n._radixDance&&n.numericInput&&e!==n.negationSymbol.back&&t<=r&&(r>0||e==n.radixPoint)&&(void 0===i.validPositions[t-1]||i.validPositions[t-1].input!==n.negationSymbol.back)&&(t-=1),t}(e,r,c,o,n),"-"===r||r===n.negationSymbol.front){if(!0!==n.allowMinus)return!1;var p=!1,f=d("+",o),m=d("-",o);return-1!==f&&(p=[f],-1!==m&&p.push(m)),!1!==p?{remove:p,caret:u-n.negationSymbol.back.length}:{insert:[{pos:h.call(l,"+",o),c:n.negationSymbol.front,fromIsValid:!0},{pos:h.call(l,"-",o),c:n.negationSymbol.back,fromIsValid:void 0}],caret:u+n.negationSymbol.back.length}}if(r===n.groupSeparator)return{caret:u};if(a)return!0;if(-1!==c&&!0===n._radixDance&&!1===i&&r===n.radixPoint&&void 0!==n.digits&&(isNaN(n.digits)||parseInt(n.digits)>0)&&c!==e){var g=h.call(l,n.radixPoint,o);return o.validPositions[g]&&(o.validPositions[g].generatedInput=o.validPositions[g].generated||!1),{caret:n._radixDance&&e===c-1?c+1:c}}if(!1===n.__financeInput)if(i){if(n.digitsOptional)return{rewritePosition:s.end};if(!n.digitsOptional){if(s.begin>c&&s.end<=c)return r===n.radixPoint?{insert:{pos:c+1,c:"0",fromIsValid:!0},rewritePosition:c}:{rewritePosition:c+1};if(s.begin<c)return{rewritePosition:s.begin-1}}}else if(!n.showMaskOnHover&&!n.showMaskOnFocus&&!n.digitsOptional&&n.digits>0&&""===this.__valueGet.call(this.el))return{rewritePosition:c};return{rewritePosition:e}},postValidation:function(t,e,r,i,n,o,s){if(!1===i)return i;if(s)return!0;if(null!==n.min||null!==n.max){var a=n.onUnMask(t.slice().reverse().join(""),void 0,l.extend({},n,{unmaskAsNumber:!0}));if(null!==n.min&&a<n.min&&(a.toString().length>n.min.toString().length||a<0))return!1;if(null!==n.max&&a>n.max)return!!n.SetMaxOnOverflow&&{refreshFromBuffer:!0,buffer:u(n.max.toString().replace(".",n.radixPoint).split(""),n.digits,n).reverse()}}return i},onUnMask:function(t,e,r){if(""===e&&!0===r.nullable)return e;var n=t.replace(r.prefix,"");return n=(n=n.replace(r.suffix,"")).replace(new RegExp((0,i.default)(r.groupSeparator),"g"),""),""!==r.placeholder.charAt(0)&&(n=n.replace(new RegExp(r.placeholder.charAt(0),"g"),"0")),r.unmaskAsNumber?(""!==r.radixPoint&&-1!==n.indexOf(r.radixPoint)&&(n=n.replace(i.default.call(this,r.radixPoint),".")),n=(n=n.replace(new RegExp("^"+(0,i.default)(r.negationSymbol.front)),"-")).replace(new RegExp((0,i.default)(r.negationSymbol.back)+"$"),""),Number(n)):n},isComplete:function(t,e){var r=(e.numericInput?t.slice().reverse():t).join("");return r=(r=(r=(r=(r=r.replace(new RegExp("^"+(0,i.default)(e.negationSymbol.front)),"-")).replace(new RegExp((0,i.default)(e.negationSymbol.back)+"$"),"")).replace(e.prefix,"")).replace(e.suffix,"")).replace(new RegExp((0,i.default)(e.groupSeparator)+"([0-9]{3})","g"),"$1"),","===e.radixPoint&&(r=r.replace((0,i.default)(e.radixPoint),".")),isFinite(r)},onBeforeMask:function(t,e){var r;t=null!==(r=t)&&void 0!==r?r:"";var n=e.radixPoint||",";isFinite(e.digits)&&(e.digits=parseInt(e.digits)),"number"!=typeof t&&"number"!==e.inputType||""===n||(t=t.toString().replace(".",n));var o="-"===t.charAt(0)||t.charAt(0)===e.negationSymbol.front,s=t.split(n),a=s[0].replace(/[^\-0-9]/g,""),l=s.length>1?s[1].replace(/[^0-9]/g,""):"",c=s.length>1;t=a+(""!==l?n+l:l);var h=0;if(""!==n&&(h=e.digitsOptional?e.digits<l.length?e.digits:l.length:e.digits,""!==l||!e.digitsOptional)){var d=Math.pow(10,h||1);t=t.replace((0,i.default)(n),"."),isNaN(parseFloat(t))||(t=(e.roundingFN(parseFloat(t)*d)/d).toFixed(h)),t=t.toString().replace(".",n)}if(0===e.digits&&-1!==t.indexOf(n)&&(t=t.substring(0,t.indexOf(n))),null!==e.min||null!==e.max){var p=t.toString().replace(n,".");null!==e.min&&p<e.min?t=e.min.toString().replace(".",n):null!==e.max&&p>e.max&&(t=e.max.toString().replace(".",n))}return o&&"-"!==t.charAt(0)&&(t="-"+t),u(t.toString().split(""),h,e,c).join("")},onBeforeWrite:function(t,e,r,n){function o(t,e){if(!1!==n.__financeInput||e){var r=t.indexOf(n.radixPoint);-1!==r&&t.splice(r,1)}if(""!==n.groupSeparator)for(;-1!==(r=t.indexOf(n.groupSeparator));)t.splice(r,1);return t}var s,a;if(n.stripLeadingZeroes&&(a=function(t,e){var r=new RegExp("(^"+(""!==e.negationSymbol.front?(0,i.default)(e.negationSymbol.front)+"?":"")+(0,i.default)(e.prefix)+")(.*)("+(0,i.default)(e.suffix)+(""!=e.negationSymbol.back?(0,i.default)(e.negationSymbol.back)+"?":"")+"$)").exec(t.slice().reverse().join("")),n=r?r[2]:"",o=!1;return n&&(n=n.split(e.radixPoint.charAt(0))[0],o=new RegExp("^[0"+e.groupSeparator+"]*").exec(n)),!(!o||!(o[0].length>1||o[0].length>0&&o[0].length<n.length))&&o}(e,n)))for(var c=e.join("").lastIndexOf(a[0].split("").reverse().join(""))-(a[0]==a.input?0:1),h=a[0]==a.input?1:0,d=a[0].length-h;d>0;d--)this.maskset.validPositions.splice(c+d,1),delete e[c+d];if(t)switch(t.type){case"blur":case"checkval":if(null!==n.min){var p=n.onUnMask(e.slice().reverse().join(""),void 0,l.extend({},n,{unmaskAsNumber:!0}));if(null!==n.min&&p<n.min)return{refreshFromBuffer:!0,buffer:u(n.min.toString().replace(".",n.radixPoint).split(""),n.digits,n).reverse()}}if(e[e.length-1]===n.negationSymbol.front){var f=new RegExp("(^"+(""!=n.negationSymbol.front?(0,i.default)(n.negationSymbol.front)+"?":"")+(0,i.default)(n.prefix)+")(.*)("+(0,i.default)(n.suffix)+(""!=n.negationSymbol.back?(0,i.default)(n.negationSymbol.back)+"?":"")+"$)").exec(o(e.slice(),!0).reverse().join(""));0==(f?f[2]:"")&&(s={refreshFromBuffer:!0,buffer:[0]})}else""!==n.radixPoint&&e.indexOf(n.radixPoint)===n.suffix.length&&(s&&s.buffer?s.buffer.splice(0,1+n.suffix.length):(e.splice(0,1+n.suffix.length),s={refreshFromBuffer:!0,buffer:o(e)}));if(n.enforceDigitsOnBlur){var m=(s=s||{})&&s.buffer||e.slice().reverse();s.refreshFromBuffer=!0,s.buffer=u(m,n.digits,n,!0).reverse()}}return s},onKeyDown:function(t,e,r,i){var n,s=l(this);if(3!=t.location){var a,c=t.key;if((a=i.shortcuts&&i.shortcuts[c])&&a.length>1)return this.inputmask.__valueSet.call(this,parseFloat(this.inputmask.unmaskedvalue())*parseInt(a)),s.trigger("setvalue"),!1}if(t.ctrlKey)switch(t.key){case o.keys.ArrowUp:return this.inputmask.__valueSet.call(this,parseFloat(this.inputmask.unmaskedvalue())+parseInt(i.step)),s.trigger("setvalue"),!1;case o.keys.ArrowDown:return this.inputmask.__valueSet.call(this,parseFloat(this.inputmask.unmaskedvalue())-parseInt(i.step)),s.trigger("setvalue"),!1}if(!t.shiftKey&&(t.key===o.keys.Delete||t.key===o.keys.Backspace||t.key===o.keys.BACKSPACE_SAFARI)&&r.begin!==e.length){if(e[t.key===o.keys.Delete?r.begin-1:r.end]===i.negationSymbol.front)return n=e.slice().reverse(),""!==i.negationSymbol.front&&n.shift(),""!==i.negationSymbol.back&&n.pop(),s.trigger("setvalue",[n.join(""),r.begin]),!1;if(!0===i._radixDance){var h,d=e.indexOf(i.radixPoint);if(i.digitsOptional){if(0===d)return(n=e.slice().reverse()).pop(),s.trigger("setvalue",[n.join(""),r.begin>=n.length?n.length:r.begin]),!1}else if(-1!==d&&(r.begin<d||r.end<d||t.key===o.keys.Delete&&(r.begin===d||r.begin-1===d)))return r.begin===r.end&&(t.key===o.keys.Backspace||t.key===o.keys.BACKSPACE_SAFARI?r.begin++:t.key===o.keys.Delete&&r.begin-1===d&&(h=l.extend({},r),r.begin--,r.end--)),(n=e.slice().reverse()).splice(n.length-r.begin,r.begin-r.end+1),n=u(n,i.digits,i).join(""),h&&(r=h),s.trigger("setvalue",[n,r.begin>=n.length?d+1:r.begin]),!1}}}},currency:{prefix:"",groupSeparator:",",alias:"numeric",digits:2,digitsOptional:!1},decimal:{alias:"numeric"},integer:{alias:"numeric",inputmode:"numeric",digits:0},percentage:{alias:"numeric",min:0,max:100,suffix:" %",digits:0,allowMinus:!1},indianns:{alias:"numeric",_mask:function(t){return"("+t.groupSeparator+"99){*|1}("+t.groupSeparator+"999){1|1}"},groupSeparator:",",radixPoint:".",placeholder:"0",digits:2,digitsOptional:!1}})},9380:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=!("undefined"==typeof window||!window.document||!window.document.createElement);e.default=r?window:{}},7760:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.HandleNativePlaceholder=function(t,e){var r=t?t.inputmask:this;if(i.ie){if(t.inputmask._valueGet()!==e&&(t.placeholder!==e||""===t.placeholder)){var n=s.getBuffer.call(r).slice(),o=t.inputmask._valueGet();if(o!==e){var a=s.getLastValidPosition.call(r);-1===a&&o===s.getBufferTemplate.call(r).join("")?n=[]:-1!==a&&u.call(r,n),d(t,n)}}}else t.placeholder!==e&&(t.placeholder=e,""===t.placeholder&&t.removeAttribute("placeholder"))},e.applyInputValue=c,e.checkVal=h,e.clearOptionalTail=u,e.unmaskedvalue=function(t){var e=t?t.inputmask:this,r=e.opts,i=e.maskset;if(t){if(void 0===t.inputmask)return t.value;t.inputmask&&t.inputmask.refreshValue&&c(t,t.inputmask._valueGet(!0))}for(var n=[],o=i.validPositions,a=0,l=o.length;a<l;a++)o[a]&&o[a].match&&(1!=o[a].match.static||Array.isArray(i.metadata)&&!0!==o[a].generatedInput)&&n.push(o[a].input);var u=0===n.length?"":(e.isRTL?n.reverse():n).join("");if("function"==typeof r.onUnMask){var h=(e.isRTL?s.getBuffer.call(e).slice().reverse():s.getBuffer.call(e)).join("");u=r.onUnMask.call(e,h,u,r)}return u},e.writeBuffer=d;var i=r(9845),n=r(6030),o=r(2839),s=r(8711),a=r(7215),l=r(4713);function c(t,e,r){var i=t?t.inputmask:this,n=i.opts;t.inputmask.refreshValue=!1,"function"==typeof n.onBeforeMask&&(e=n.onBeforeMask.call(i,e,n)||e),h(t,!0,!1,e=(e||"").toString().split(""),r),i.undoValue=i._valueGet(!0),(n.clearMaskOnLostFocus||n.clearIncomplete)&&t.inputmask._valueGet()===s.getBufferTemplate.call(i).join("")&&-1===s.getLastValidPosition.call(i)&&t.inputmask._valueSet("")}function u(t){t.length=0;for(var e,r=l.getMaskTemplate.call(this,!0,0,!0,void 0,!0);void 0!==(e=r.shift());)t.push(e);return t}function h(t,e,r,i,o){var c,u=t?t.inputmask:this,h=u.maskset,p=u.opts,f=u.dependencyLib,m=i.slice(),g="",y=-1,v=p.skipOptionalPartCharacter;p.skipOptionalPartCharacter="",s.resetMaskSet.call(u,!1),u.clicked=0,y=p.radixPoint?s.determineNewCaretPosition.call(u,{begin:0,end:0},!1,!1===p.__financeInput?"radixFocus":void 0).begin:0,h.p=y,u.caretPos={begin:y};var _=[],b=u.caretPos;if(m.forEach((function(t,e){if(void 0!==t){var i=new f.Event("_checkval");i.key=t,g+=t;var o=s.getLastValidPosition.call(u,void 0,!0);!function(t,e){for(var r=l.getMaskTemplate.call(u,!0,0).slice(t,s.seekNext.call(u,t,!1,!1)).join("").replace(/'/g,""),i=r.indexOf(e);i>0&&" "===r[i-1];)i--;var n=0===i&&!s.isMask.call(u,t)&&(l.getTest.call(u,t).match.nativeDef===e.charAt(0)||!0===l.getTest.call(u,t).match.static&&l.getTest.call(u,t).match.nativeDef==="'"+e.charAt(0)||" "===l.getTest.call(u,t).match.nativeDef&&(l.getTest.call(u,t+1).match.nativeDef===e.charAt(0)||!0===l.getTest.call(u,t+1).match.static&&l.getTest.call(u,t+1).match.nativeDef==="'"+e.charAt(0)));if(!n&&i>0&&!s.isMask.call(u,t,!1,!0)){var o=s.seekNext.call(u,t);u.caretPos.begin<o&&(u.caretPos={begin:o})}return n}(y,g)?(c=n.EventHandlers.keypressEvent.call(u,i,!0,!1,r,u.caretPos.begin))&&(y=u.caretPos.begin+1,g=""):c=n.EventHandlers.keypressEvent.call(u,i,!0,!1,r,o+1),c?(void 0!==c.pos&&h.validPositions[c.pos]&&!0===h.validPositions[c.pos].match.static&&void 0===h.validPositions[c.pos].alternation&&(_.push(c.pos),u.isRTL||(c.forwardPosition=c.pos+1)),d.call(u,void 0,s.getBuffer.call(u),c.forwardPosition,i,!1),u.caretPos={begin:c.forwardPosition,end:c.forwardPosition},b=u.caretPos):void 0===h.validPositions[e]&&m[e]===l.getPlaceholder.call(u,e)&&s.isMask.call(u,e,!0)?u.caretPos.begin++:u.caretPos=b}})),_.length>0){var x,w,T=s.seekNext.call(u,-1,void 0,!1);if(!a.isComplete.call(u,s.getBuffer.call(u))&&_.length<=T||a.isComplete.call(u,s.getBuffer.call(u))&&_.length>0&&_.length!==T&&0===_[0])for(var E=T;void 0!==(x=_.shift());)if(x<E){var S=new f.Event("_checkval");if((w=h.validPositions[x]).generatedInput=!0,S.key=w.input,(c=n.EventHandlers.keypressEvent.call(u,S,!0,!1,r,E))&&void 0!==c.pos&&c.pos!==x&&h.validPositions[c.pos]&&!0===h.validPositions[c.pos].match.static)_.push(c.pos);else if(!c)break;E++}}e&&d.call(u,t,s.getBuffer.call(u),c?c.forwardPosition:u.caretPos.begin,o||new f.Event("checkval"),o&&("input"===o.type&&u.undoValue!==s.getBuffer.call(u).join("")||"paste"===o.type)),p.skipOptionalPartCharacter=v}function d(t,e,r,i,n){var l=t?t.inputmask:this,c=l.opts,u=l.dependencyLib;if(i&&"function"==typeof c.onBeforeWrite){var h=c.onBeforeWrite.call(l,i,e,r,c);if(h){if(h.refreshFromBuffer){var d=h.refreshFromBuffer;a.refreshFromBuffer.call(l,!0===d?d:d.start,d.end,h.buffer||e),e=s.getBuffer.call(l,!0)}void 0!==r&&(r=void 0!==h.caret?h.caret:r)}}if(void 0!==t&&(t.inputmask._valueSet(e.join("")),void 0===r||void 0!==i&&"blur"===i.type||s.caret.call(l,t,r,void 0,void 0,void 0!==i&&"keydown"===i.type&&(i.key===o.keys.Delete||i.key===o.keys.Backspace)),void 0===t.inputmask.writeBufferHook||t.inputmask.writeBufferHook(r),!0===n)){var p=u(t),f=t.inputmask._valueGet();t.inputmask.skipInputEvent=!0,p.trigger("input"),setTimeout((function(){f===s.getBufferTemplate.call(l).join("")?p.trigger("cleared"):!0===a.isComplete.call(l,e)&&p.trigger("complete")}),0)}}},2394:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=m(r(3976)),n=m(r(7392)),o=m(r(4963)),s=r(9716),a=m(r(9380)),l=r(7760),c=r(157),u=r(2391),h=r(8711),d=r(7215),p=r(4713);function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function m(t){return t&&t.__esModule?t:{default:t}}var g=a.default.document,y="_inputmask_opts";function v(t,e,r){if(!(this instanceof v))return new v(t,e,r);this.dependencyLib=o.default,this.el=void 0,this.events={},this.maskset=void 0,!0!==r&&("[object Object]"===Object.prototype.toString.call(t)?e=t:(e=e||{},t&&(e.alias=t)),this.opts=o.default.extend(!0,{},this.defaults,e),this.noMasksCache=e&&void 0!==e.definitions,this.userOptions=e||{},_(this.opts.alias,e,this.opts)),this.refreshValue=!1,this.undoValue=void 0,this.$el=void 0,this.skipInputEvent=!1,this.validationEvent=!1,this.ignorable=!1,this.maxLength,this.mouseEnter=!1,this.clicked=0,this.originalPlaceholder=void 0,this.isComposing=!1,this.hasAlternator=!1}function _(t,e,r){var i=v.prototype.aliases[t];return i?(i.alias&&_(i.alias,void 0,r),o.default.extend(!0,r,i),o.default.extend(!0,r,e),!0):(null===r.mask&&(r.mask=t),!1)}v.prototype={dataAttribute:"data-inputmask",defaults:i.default,definitions:n.default,aliases:{},masksCache:{},i18n:{},get isRTL(){return this.opts.isRTL||this.opts.numericInput},mask:function(t){var e=this;return"string"==typeof t&&(t=g.getElementById(t)||g.querySelectorAll(t)),(t=t.nodeName?[t]:Array.isArray(t)?t:[].slice.call(t)).forEach((function(t,r){var i=o.default.extend(!0,{},e.opts);if(function(t,e,r,i){function n(e,n){var o=""===i?e:i+"-"+e;null!==(n=void 0!==n?n:t.getAttribute(o))&&("string"==typeof n&&(0===e.indexOf("on")?n=a.default[n]:"false"===n?n=!1:"true"===n&&(n=!0)),r[e]=n)}if(!0===e.importDataAttributes){var s,l,c,u,h=t.getAttribute(i);if(h&&""!==h&&(h=h.replace(/'/g,'"'),l=JSON.parse("{"+h+"}")),l)for(u in c=void 0,l)if("alias"===u.toLowerCase()){c=l[u];break}for(s in n("alias",c),r.alias&&_(r.alias,r,e),e){if(l)for(u in c=void 0,l)if(u.toLowerCase()===s.toLowerCase()){c=l[u];break}n(s,c)}}return o.default.extend(!0,e,r),("rtl"===t.dir||e.rightAlign)&&(t.style.textAlign="right"),("rtl"===t.dir||e.numericInput)&&(t.dir="ltr",t.removeAttribute("dir"),e.isRTL=!0),Object.keys(r).length}(t,i,o.default.extend(!0,{},e.userOptions),e.dataAttribute)){var n=(0,u.generateMaskSet)(i,e.noMasksCache);void 0!==n&&(void 0!==t.inputmask&&(t.inputmask.opts.autoUnmask=!0,t.inputmask.remove()),t.inputmask=new v(void 0,void 0,!0),t.inputmask.opts=i,t.inputmask.noMasksCache=e.noMasksCache,t.inputmask.userOptions=o.default.extend(!0,{},e.userOptions),t.inputmask.el=t,t.inputmask.$el=(0,o.default)(t),t.inputmask.maskset=n,o.default.data(t,y,e.userOptions),c.mask.call(t.inputmask))}})),t&&t[0]&&t[0].inputmask||this},option:function(t,e){return"string"==typeof t?this.opts[t]:"object"===f(t)?(o.default.extend(this.userOptions,t),this.el&&!0!==e&&this.mask(this.el),this):void 0},unmaskedvalue:function(t){if(this.maskset=this.maskset||(0,u.generateMaskSet)(this.opts,this.noMasksCache),void 0===this.el||void 0!==t){var e=("function"==typeof this.opts.onBeforeMask&&this.opts.onBeforeMask.call(this,t,this.opts)||t).split("");l.checkVal.call(this,void 0,!1,!1,e),"function"==typeof this.opts.onBeforeWrite&&this.opts.onBeforeWrite.call(this,void 0,h.getBuffer.call(this),0,this.opts)}return l.unmaskedvalue.call(this,this.el)},remove:function(){if(this.el){o.default.data(this.el,y,null);var t=this.opts.autoUnmask?(0,l.unmaskedvalue)(this.el):this._valueGet(this.opts.autoUnmask);t!==h.getBufferTemplate.call(this).join("")?this._valueSet(t,this.opts.autoUnmask):this._valueSet(""),s.EventRuler.off(this.el),Object.getOwnPropertyDescriptor&&Object.getPrototypeOf?Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.el),"value")&&this.__valueGet&&Object.defineProperty(this.el,"value",{get:this.__valueGet,set:this.__valueSet,configurable:!0}):g.__lookupGetter__&&this.el.__lookupGetter__("value")&&this.__valueGet&&(this.el.__defineGetter__("value",this.__valueGet),this.el.__defineSetter__("value",this.__valueSet)),this.el.inputmask=void 0}return this.el},getemptymask:function(){return this.maskset=this.maskset||(0,u.generateMaskSet)(this.opts,this.noMasksCache),(this.isRTL?h.getBufferTemplate.call(this).reverse():h.getBufferTemplate.call(this)).join("")},hasMaskedValue:function(){return!this.opts.autoUnmask},isComplete:function(){return this.maskset=this.maskset||(0,u.generateMaskSet)(this.opts,this.noMasksCache),d.isComplete.call(this,h.getBuffer.call(this))},getmetadata:function(){if(this.maskset=this.maskset||(0,u.generateMaskSet)(this.opts,this.noMasksCache),Array.isArray(this.maskset.metadata)){var t=p.getMaskTemplate.call(this,!0,0,!1).join("");return this.maskset.metadata.forEach((function(e){return e.mask!==t||(t=e,!1)})),t}return this.maskset.metadata},isValid:function(t){if(this.maskset=this.maskset||(0,u.generateMaskSet)(this.opts,this.noMasksCache),t){var e=("function"==typeof this.opts.onBeforeMask&&this.opts.onBeforeMask.call(this,t,this.opts)||t).split("");l.checkVal.call(this,void 0,!0,!1,e)}else t=this.isRTL?h.getBuffer.call(this).slice().reverse().join(""):h.getBuffer.call(this).join("");for(var r=h.getBuffer.call(this),i=h.determineLastRequiredPosition.call(this),n=r.length-1;n>i&&!h.isMask.call(this,n);n--);return r.splice(i,n+1-i),d.isComplete.call(this,r)&&t===(this.isRTL?h.getBuffer.call(this).slice().reverse().join(""):h.getBuffer.call(this).join(""))},format:function(t,e){this.maskset=this.maskset||(0,u.generateMaskSet)(this.opts,this.noMasksCache);var r=("function"==typeof this.opts.onBeforeMask&&this.opts.onBeforeMask.call(this,t,this.opts)||t).split("");l.checkVal.call(this,void 0,!0,!1,r);var i=this.isRTL?h.getBuffer.call(this).slice().reverse().join(""):h.getBuffer.call(this).join("");return e?{value:i,metadata:this.getmetadata()}:i},setValue:function(t){this.el&&(0,o.default)(this.el).trigger("setvalue",[t])},analyseMask:u.analyseMask},v.extendDefaults=function(t){o.default.extend(!0,v.prototype.defaults,t)},v.extendDefinitions=function(t){o.default.extend(!0,v.prototype.definitions,t)},v.extendAliases=function(t){o.default.extend(!0,v.prototype.aliases,t)},v.format=function(t,e,r){return v(e).format(t,r)},v.unmask=function(t,e){return v(e).unmaskedvalue(t)},v.isValid=function(t,e){return v(e).isValid(t)},v.remove=function(t){"string"==typeof t&&(t=g.getElementById(t)||g.querySelectorAll(t)),(t=t.nodeName?[t]:t).forEach((function(t){t.inputmask&&t.inputmask.remove()}))},v.setValue=function(t,e){"string"==typeof t&&(t=g.getElementById(t)||g.querySelectorAll(t)),(t=t.nodeName?[t]:t).forEach((function(t){t.inputmask?t.inputmask.setValue(e):(0,o.default)(t).trigger("setvalue",[e])}))},v.dependencyLib=o.default,a.default.Inputmask=v,e.default=v},5296:function(t,e,r){function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}var n=p(r(9380)),o=p(r(2394));function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=void 0,o=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(n.key,"string"),"symbol"===i(o)?o:String(o)),n)}var o}function a(t){var e=u();return function(){var r,n=d(t);if(e){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){var e="function"==typeof Map?new Map:void 0;return l=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return c(t,arguments,d(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),h(r,t)},l(t)}function c(t,e,r){return c=u()?Reflect.construct.bind():function(t,e,r){var i=[null];i.push.apply(i,e);var n=new(Function.bind.apply(t,i));return r&&h(n,r.prototype),n},c.apply(null,arguments)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function p(t){return t&&t.__esModule?t:{default:t}}var f=n.default.document;if(f&&f.head&&f.head.attachShadow&&n.default.customElements&&void 0===n.default.customElements.get("input-mask")){var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(l,t);var e,r,i,n=a(l);function l(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);var e=(t=n.call(this)).getAttributeNames(),r=t.attachShadow({mode:"closed"});for(var i in t.input=f.createElement("input"),t.input.type="text",r.appendChild(t.input),e)Object.prototype.hasOwnProperty.call(e,i)&&t.input.setAttribute(e[i],t.getAttribute(e[i]));var s=new o.default;return s.dataAttribute="",s.mask(t.input),t.input.inputmask.shadowRoot=r,t}return e=l,(r=[{key:"attributeChangedCallback",value:function(t,e,r){this.input.setAttribute(t,r)}},{key:"value",get:function(){return this.input.value},set:function(t){this.input.value=t}}])&&s(e.prototype,r),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),l}(l(HTMLElement));n.default.customElements.define("input-mask",m)}},2839:function(t,e){function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var i,n,o,s,a=[],l=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(i=o.call(r)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(t){c=!0,n=t}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function s(t,e,i){return(e=function(t){var e=function(t,e){if("object"!==r(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===r(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}Object.defineProperty(e,"__esModule",{value:!0}),e.keys=e.keyCode=void 0,e.toKey=function(t,e){return l[t]||(e?String.fromCharCode(t):String.fromCharCode(t).toLowerCase())},e.toKeyCode=function(t){return a[t]};var a=e.keyCode=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({c:67,x:88,z:90,BACKSPACE_SAFARI:127,Enter:13,Meta_LEFT:91,Meta_RIGHT:92,Space:32},{Alt:18,AltGraph:18,ArrowDown:40,ArrowLeft:37,ArrowRight:39,ArrowUp:38,Backspace:8,CapsLock:20,Control:17,ContextMenu:93,Dead:221,Delete:46,End:35,Escape:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,Home:36,Insert:45,NumLock:144,PageDown:34,PageUp:33,Pause:19,PrintScreen:44,Process:229,Shift:16,ScrollLock:145,Tab:9,Unidentified:229}),l=Object.entries(a).reduce((function(t,e){var r=i(e,2),n=r[0],o=r[1];return t[o]=void 0===t[o]?n:t[o],t}),{});e.keys=Object.entries(a).reduce((function(t,e){var r=i(e,2),n=r[0];return r[1],t[n]="Space"===n?" ":n,t}),{})},2391:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.analyseMask=function(t,e,r){var i,n,l,c,u,h,d=/(?:[?*+]|\{[0-9+*]+(?:,[0-9+*]*)?(?:\|[0-9+*]*)?\})|[^.?*+^${[]()|\\]+|./g,p=/\[\^?]?(?:[^\\\]]+|\\[\S\s]?)*]?|\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9][0-9]*|x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4}|c[A-Za-z]|[\S\s]?)|\((?:\?[:=!]?)?|(?:[?*+]|\{[0-9]+(?:,[0-9]*)?\})\??|[^.?*+^${[()|\\]+|./g,f=!1,m=new s.default,g=[],y=[],v=!1;function _(t,i,n){n=void 0!==n?n:t.matches.length;var s=t.matches[n-1];if(e){if(0===i.indexOf("[")||f&&/\\d|\\s|\\w|\\p/i.test(i)||"."===i){var l=r.casing?"i":"";/\\p\{.*}/i.test(i)&&(l+="u"),t.matches.splice(n++,0,{fn:new RegExp(i,l),static:!1,optionality:!1,newBlockMarker:void 0===s?"master":s.def!==i,casing:null,def:i,placeholder:"object"===a(r.placeholder)?r.placeholder[m.matches.length]:void 0,nativeDef:i})}else f&&(i=i[i.length-1]),i.split("").forEach((function(e,i){s=t.matches[n-1],t.matches.splice(n++,0,{fn:/[a-z]/i.test(r.staticDefinitionSymbol||e)?new RegExp("["+(r.staticDefinitionSymbol||e)+"]",r.casing?"i":""):null,static:!0,optionality:!1,newBlockMarker:void 0===s?"master":s.def!==e&&!0!==s.static,casing:null,def:r.staticDefinitionSymbol||e,placeholder:void 0!==r.staticDefinitionSymbol?e:"object"===a(r.placeholder)?r.placeholder[m.matches.length]:void 0,nativeDef:(f?"'":"")+e})}));f=!1}else{var c=r.definitions&&r.definitions[i]||r.usePrototypeDefinitions&&o.default.prototype.definitions[i];c&&!f?t.matches.splice(n++,0,{fn:c.validator?"string"==typeof c.validator?new RegExp(c.validator,r.casing?"i":""):new function(){this.test=c.validator}:/./,static:c.static||!1,optionality:c.optional||!1,defOptionality:c.optional||!1,newBlockMarker:void 0===s||c.optional?"master":s.def!==(c.definitionSymbol||i),casing:c.casing,def:c.definitionSymbol||i,placeholder:c.placeholder,nativeDef:i,generated:c.generated}):(t.matches.splice(n++,0,{fn:/[a-z]/i.test(r.staticDefinitionSymbol||i)?new RegExp("["+(r.staticDefinitionSymbol||i)+"]",r.casing?"i":""):null,static:!0,optionality:!1,newBlockMarker:void 0===s?"master":s.def!==i&&!0!==s.static,casing:null,def:r.staticDefinitionSymbol||i,placeholder:void 0!==r.staticDefinitionSymbol?i:void 0,nativeDef:(f?"'":"")+i}),f=!1)}}function b(){if(g.length>0){if(_(c=g[g.length-1],n),c.isAlternator){u=g.pop();for(var t=0;t<u.matches.length;t++)u.matches[t].isGroup&&(u.matches[t].isGroup=!1);g.length>0?(c=g[g.length-1]).matches.push(u):m.matches.push(u)}}else _(m,n)}function x(t){var e=new s.default(!0);return e.openGroup=!1,e.matches=t,e}function w(){if((l=g.pop()).openGroup=!1,void 0!==l)if(g.length>0){if((c=g[g.length-1]).matches.push(l),c.isAlternator){u=g.pop();for(var t=0;t<u.matches.length;t++)u.matches[t].isGroup=!1,u.matches[t].alternatorGroup=!1;g.length>0?(c=g[g.length-1]).matches.push(u):m.matches.push(u)}}else m.matches.push(l);else b()}function T(t){var e=t.pop();return e.isQuantifier&&(e=x([t.pop(),e])),e}for(e&&(r.optionalmarker[0]=void 0,r.optionalmarker[1]=void 0);i=e?p.exec(t):d.exec(t);){if(n=i[0],e){switch(n.charAt(0)){case"?":n="{0,1}";break;case"+":case"*":n="{"+n+"}";break;case"|":if(0===g.length){var E=x(m.matches);E.openGroup=!0,g.push(E),m.matches=[],v=!0}}switch(n){case"\\d":n="[0-9]";break;case"\\p":n+=p.exec(t)[0],n+=p.exec(t)[0]}}if(f)b();else switch(n.charAt(0)){case"$":case"^":e||b();break;case r.escapeChar:f=!0,e&&b();break;case r.optionalmarker[1]:case r.groupmarker[1]:w();break;case r.optionalmarker[0]:g.push(new s.default(!1,!0));break;case r.groupmarker[0]:g.push(new s.default(!0));break;case r.quantifiermarker[0]:var S=new s.default(!1,!1,!0),P=(n=n.replace(/[{}?]/g,"")).split("|"),k=P[0].split(","),A=isNaN(k[0])?k[0]:parseInt(k[0]),M=1===k.length?A:isNaN(k[1])?k[1]:parseInt(k[1]),C=isNaN(P[1])?P[1]:parseInt(P[1]);"*"!==A&&"+"!==A||(A="*"===M?0:1),S.quantifier={min:A,max:M,jit:C};var I=g.length>0?g[g.length-1].matches:m.matches;(i=I.pop()).isGroup||(i=x([i])),I.push(i),I.push(S);break;case r.alternatormarker:if(g.length>0){var O=(c=g[g.length-1]).matches[c.matches.length-1];h=c.openGroup&&(void 0===O.matches||!1===O.isGroup&&!1===O.isAlternator)?g.pop():T(c.matches)}else h=T(m.matches);if(h.isAlternator)g.push(h);else if(h.alternatorGroup?(u=g.pop(),h.alternatorGroup=!1):u=new s.default(!1,!1,!1,!0),u.matches.push(h),g.push(u),h.openGroup){h.openGroup=!1;var L=new s.default(!0);L.alternatorGroup=!0,g.push(L)}break;default:b()}}for(v&&w();g.length>0;)l=g.pop(),m.matches.push(l);return m.matches.length>0&&(function t(i){i&&i.matches&&i.matches.forEach((function(n,o){var s=i.matches[o+1];(void 0===s||void 0===s.matches||!1===s.isQuantifier)&&n&&n.isGroup&&(n.isGroup=!1,e||(_(n,r.groupmarker[0],0),!0!==n.openGroup&&_(n,r.groupmarker[1]))),t(n)}))}(m),y.push(m)),(r.numericInput||r.isRTL)&&function t(e){for(var i in e.matches=e.matches.reverse(),e.matches)if(Object.prototype.hasOwnProperty.call(e.matches,i)){var n=parseInt(i);if(e.matches[i].isQuantifier&&e.matches[n+1]&&e.matches[n+1].isGroup){var o=e.matches[i];e.matches.splice(i,1),e.matches.splice(n+1,0,o)}void 0!==e.matches[i].matches?e.matches[i]=t(e.matches[i]):e.matches[i]=((s=e.matches[i])===r.optionalmarker[0]?s=r.optionalmarker[1]:s===r.optionalmarker[1]?s=r.optionalmarker[0]:s===r.groupmarker[0]?s=r.groupmarker[1]:s===r.groupmarker[1]&&(s=r.groupmarker[0]),s)}var s;return e}(y[0]),y},e.generateMaskSet=function(t,e){var r;function s(t,e){var r=e.repeat,i=e.groupmarker,o=e.quantifiermarker,s=e.keepStatic;if(r>0||"*"===r||"+"===r){var a="*"===r?0:"+"===r?1:r;if(a!=r)t=i[0]+t+i[1]+o[0]+a+","+r+o[1];else for(var c=t,u=1;u<a;u++)t+=c}if(!0===s){var h=t.match(new RegExp("(.)\\[([^\\]]*)\\]","g"));h&&h.forEach((function(e,r){var i=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var i,n,o,s,a=[],l=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(i=o.call(r)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(t){c=!0,n=t}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.split("["),2),o=i[0],s=i[1];s=s.replace("]",""),t=t.replace(new RegExp("".concat((0,n.default)(o),"\\[").concat((0,n.default)(s),"\\]")),o.charAt(0)===s.charAt(0)?"(".concat(o,"|").concat(o).concat(s,")"):"".concat(o,"[").concat(s,"]"))}))}return t}function c(t,r,n){var l,c,u=!1;return null!==t&&""!==t||((u=null!==n.regex)?t=(t=n.regex).replace(/^(\^)(.*)(\$)$/,"$2"):(u=!0,t=".*")),1===t.length&&!1===n.greedy&&0!==n.repeat&&(n.placeholder=""),t=s(t,n),c=u?"regex_"+n.regex:n.numericInput?t.split("").reverse().join(""):t,null!==n.keepStatic&&(c="ks_"+n.keepStatic+c),"object"===a(n.placeholder)&&(c="ph_"+JSON.stringify(n.placeholder)+c),void 0===o.default.prototype.masksCache[c]||!0===e?(l={mask:t,maskToken:o.default.prototype.analyseMask(t,u,n),validPositions:[],_buffer:void 0,buffer:void 0,tests:{},excludes:{},metadata:r,maskLength:void 0,jitOffset:{}},!0!==e&&(o.default.prototype.masksCache[c]=l,l=i.default.extend(!0,{},o.default.prototype.masksCache[c]))):l=i.default.extend(!0,{},o.default.prototype.masksCache[c]),l}if("function"==typeof t.mask&&(t.mask=t.mask(t)),Array.isArray(t.mask)){if(t.mask.length>1){null===t.keepStatic&&(t.keepStatic=!0);var u=t.groupmarker[0];return(t.isRTL?t.mask.reverse():t.mask).forEach((function(e){u.length>1&&(u+=t.alternatormarker),void 0!==e.mask&&"function"!=typeof e.mask?u+=e.mask:u+=e})),c(u+=t.groupmarker[1],t.mask,t)}t.mask=t.mask.pop()}return r=t.mask&&void 0!==t.mask.mask&&"function"!=typeof t.mask.mask?c(t.mask.mask,t.mask,t):c(t.mask,t.mask,t),null===t.keepStatic&&(t.keepStatic=!1),r};var i=c(r(4963)),n=c(r(7184)),o=c(r(2394)),s=c(r(9695));function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function c(t){return t&&t.__esModule?t:{default:t}}},157:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.mask=function(){var t=this,e=this.opts,r=this.el,c=this.dependencyLib;o.EventRuler.off(r);var u=function(e,r){var i=e.getAttribute("type"),n="input"===e.tagName.toLowerCase()&&r.supportsInputType.includes(i)||e.isContentEditable||"textarea"===e.tagName.toLowerCase();if(!n)if("input"===e.tagName.toLowerCase()){var l=document.createElement("input");l.setAttribute("type",i),n="text"===l.type,l=null}else n="partial";return!1!==n?function(e){var i,n;function l(){return this.inputmask?this.inputmask.opts.autoUnmask?this.inputmask.unmaskedvalue():-1!==a.getLastValidPosition.call(t)||!0!==r.nullable?(this.inputmask.shadowRoot||this.ownerDocument).activeElement===this&&r.clearMaskOnLostFocus?(t.isRTL?s.clearOptionalTail.call(t,a.getBuffer.call(t).slice()).reverse():s.clearOptionalTail.call(t,a.getBuffer.call(t).slice())).join(""):i.call(this):"":i.call(this)}function u(t){n.call(this,t),this.inputmask&&(0,s.applyInputValue)(this,t)}if(!e.inputmask.__valueGet){if(!0!==r.noValuePatching){if(Object.getOwnPropertyDescriptor){var h=Object.getPrototypeOf?Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),"value"):void 0;h&&h.get&&h.set?(i=h.get,n=h.set,Object.defineProperty(e,"value",{get:l,set:u,configurable:!0})):"input"!==e.tagName.toLowerCase()&&(i=function(){return this.textContent},n=function(t){this.textContent=t},Object.defineProperty(e,"value",{get:l,set:u,configurable:!0}))}else document.__lookupGetter__&&e.__lookupGetter__("value")&&(i=e.__lookupGetter__("value"),n=e.__lookupSetter__("value"),e.__defineGetter__("value",l),e.__defineSetter__("value",u));e.inputmask.__valueGet=i,e.inputmask.__valueSet=n}e.inputmask._valueGet=function(e){return t.isRTL&&!0!==e?i.call(this.el).split("").reverse().join(""):i.call(this.el)},e.inputmask._valueSet=function(e,r){n.call(this.el,null==e?"":!0!==r&&t.isRTL?e.split("").reverse().join(""):e)},void 0===i&&(i=function(){return this.value},n=function(t){this.value=t},function(e){if(c.valHooks&&(void 0===c.valHooks[e]||!0!==c.valHooks[e].inputmaskpatch)){var i=c.valHooks[e]&&c.valHooks[e].get?c.valHooks[e].get:function(t){return t.value},n=c.valHooks[e]&&c.valHooks[e].set?c.valHooks[e].set:function(t,e){return t.value=e,t};c.valHooks[e]={get:function(e){if(e.inputmask){if(e.inputmask.opts.autoUnmask)return e.inputmask.unmaskedvalue();var n=i(e);return-1!==a.getLastValidPosition.call(t,void 0,void 0,e.inputmask.maskset.validPositions)||!0!==r.nullable?n:""}return i(e)},set:function(t,e){var r=n(t,e);return t.inputmask&&(0,s.applyInputValue)(t,e),r},inputmaskpatch:!0}}}(e.type),function(t){o.EventRuler.on(t,"mouseenter",(function(){var t=this,e=t.inputmask._valueGet(!0);e!=(t.inputmask.isRTL?a.getBuffer.call(t.inputmask).slice().reverse():a.getBuffer.call(t.inputmask)).join("")&&(0,s.applyInputValue)(t,e)}))}(e))}}(e):e.inputmask=void 0,n}(r,e);if(!1!==u){t.originalPlaceholder=r.placeholder,t.maxLength=void 0!==r?r.maxLength:void 0,-1===t.maxLength&&(t.maxLength=void 0),"inputMode"in r&&null===r.getAttribute("inputmode")&&(r.inputMode=e.inputmode,r.setAttribute("inputmode",e.inputmode)),!0===u&&(e.showMaskOnFocus=e.showMaskOnFocus&&-1===["cc-number","cc-exp"].indexOf(r.autocomplete),i.iphone&&(e.insertModeVisual=!1,r.setAttribute("autocorrect","off")),o.EventRuler.on(r,"submit",n.EventHandlers.submitEvent),o.EventRuler.on(r,"reset",n.EventHandlers.resetEvent),o.EventRuler.on(r,"blur",n.EventHandlers.blurEvent),o.EventRuler.on(r,"focus",n.EventHandlers.focusEvent),o.EventRuler.on(r,"invalid",n.EventHandlers.invalidEvent),o.EventRuler.on(r,"click",n.EventHandlers.clickEvent),o.EventRuler.on(r,"mouseleave",n.EventHandlers.mouseleaveEvent),o.EventRuler.on(r,"mouseenter",n.EventHandlers.mouseenterEvent),o.EventRuler.on(r,"paste",n.EventHandlers.pasteEvent),o.EventRuler.on(r,"cut",n.EventHandlers.cutEvent),o.EventRuler.on(r,"complete",e.oncomplete),o.EventRuler.on(r,"incomplete",e.onincomplete),o.EventRuler.on(r,"cleared",e.oncleared),!0!==e.inputEventOnly&&o.EventRuler.on(r,"keydown",n.EventHandlers.keyEvent),(i.mobile||e.inputEventOnly)&&r.removeAttribute("maxLength"),o.EventRuler.on(r,"input",n.EventHandlers.inputFallBackEvent)),o.EventRuler.on(r,"setvalue",n.EventHandlers.setValueEvent),void 0===t.applyMaskHook||t.applyMaskHook(),a.getBufferTemplate.call(t).join(""),t.undoValue=t._valueGet(!0);var h=(r.inputmask.shadowRoot||r.ownerDocument).activeElement;if(""!==r.inputmask._valueGet(!0)||!1===e.clearMaskOnLostFocus||h===r){(0,s.applyInputValue)(r,r.inputmask._valueGet(!0),e);var d=a.getBuffer.call(t).slice();!1===l.isComplete.call(t,d)&&e.clearIncomplete&&a.resetMaskSet.call(t,!1),e.clearMaskOnLostFocus&&h!==r&&(-1===a.getLastValidPosition.call(t)?d=[]:s.clearOptionalTail.call(t,d)),(!1===e.clearMaskOnLostFocus||e.showMaskOnFocus&&h===r||""!==r.inputmask._valueGet(!0))&&(0,s.writeBuffer)(r,d),h===r&&a.caret.call(t,r,a.seekNext.call(t,a.getLastValidPosition.call(t)))}}};var i=r(9845),n=r(6030),o=r(9716),s=r(7760),a=r(8711),l=r(7215)},9695:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r,i){this.matches=[],this.openGroup=t||!1,this.alternatorGroup=!1,this.isGroup=t||!1,this.isOptional=e||!1,this.isQuantifier=r||!1,this.isAlternator=i||!1,this.quantifier={min:1,max:1}}},3194:function(){Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),i=r.length>>>0;if(0===i)return!1;for(var n=0|e,o=Math.max(n>=0?n:i-Math.abs(n),0);o<i;){if(r[o]===t)return!0;o++}return!1}})},9302:function(){var t=Function.bind.call(Function.call,Array.prototype.reduce),e=Function.bind.call(Function.call,Object.prototype.propertyIsEnumerable),r=Function.bind.call(Function.call,Array.prototype.concat),i=Object.keys;Object.entries||(Object.entries=function(n){return t(i(n),(function(t,i){return r(t,"string"==typeof i&&e(n,i)?[[i,n[i]]]:[])}),[])})},7149:function(){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}"function"!=typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"===t("test".__proto__)?function(t){return t.__proto__}:function(t){return t.constructor.prototype})},4013:function(){String.prototype.includes||(String.prototype.includes=function(t,e){return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)})},8711:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.caret=function(t,e,r,i,o){var s,a=this,l=this.opts;if(void 0===e)return"selectionStart"in t&&"selectionEnd"in t?(e=t.selectionStart,r=t.selectionEnd):n.default.getSelection?(s=n.default.getSelection().getRangeAt(0)).commonAncestorContainer.parentNode!==t&&s.commonAncestorContainer!==t||(e=s.startOffset,r=s.endOffset):document.selection&&document.selection.createRange&&(r=(e=0-(s=document.selection.createRange()).duplicate().moveStart("character",-t.inputmask._valueGet().length))+s.text.length),{begin:i?e:h.call(a,e),end:i?r:h.call(a,r)};if(Array.isArray(e)&&(r=a.isRTL?e[0]:e[1],e=a.isRTL?e[1]:e[0]),void 0!==e.begin&&(r=a.isRTL?e.begin:e.end,e=a.isRTL?e.end:e.begin),"number"==typeof e){e=i?e:h.call(a,e),r="number"==typeof(r=i?r:h.call(a,r))?r:e;var c=parseInt(((t.ownerDocument.defaultView||n.default).getComputedStyle?(t.ownerDocument.defaultView||n.default).getComputedStyle(t,null):t.currentStyle).fontSize)*r;if(t.scrollLeft=c>t.scrollWidth?c:0,t.inputmask.caretPos={begin:e,end:r},l.insertModeVisual&&!1===l.insertMode&&e===r&&(o||r++),t===(t.inputmask.shadowRoot||t.ownerDocument).activeElement){if("setSelectionRange"in t)t.setSelectionRange(e,r);else if(n.default.getSelection){if(s=document.createRange(),void 0===t.firstChild||null===t.firstChild){var u=document.createTextNode("");t.appendChild(u)}s.setStart(t.firstChild,e<t.inputmask._valueGet().length?e:t.inputmask._valueGet().length),s.setEnd(t.firstChild,r<t.inputmask._valueGet().length?r:t.inputmask._valueGet().length),s.collapse(!0);var d=n.default.getSelection();d.removeAllRanges(),d.addRange(s)}else t.createTextRange&&((s=t.createTextRange()).collapse(!0),s.moveEnd("character",r),s.moveStart("character",e),s.select());void 0===t.inputmask.caretHook||t.inputmask.caretHook.call(a,{begin:e,end:r})}}},e.determineLastRequiredPosition=function(t){var e,r,i=this,n=i.maskset,a=i.dependencyLib,c=l.call(i),u={},h=n.validPositions[c],d=s.getMaskTemplate.call(i,!0,l.call(i),!0,!0),p=d.length,f=void 0!==h?h.locator.slice():void 0;for(e=c+1;e<d.length;e++)f=(r=s.getTestTemplate.call(i,e,f,e-1)).locator.slice(),u[e]=a.extend(!0,{},r);var m=h&&void 0!==h.alternation?h.locator[h.alternation]:void 0;for(e=p-1;e>c&&((r=u[e]).match.optionality||r.match.optionalQuantifier&&r.match.newBlockMarker||m&&(m!==u[e].locator[h.alternation]&&!0!==r.match.static||!0===r.match.static&&r.locator[h.alternation]&&o.checkAlternationMatch.call(i,r.locator[h.alternation].toString().split(","),m.toString().split(","))&&""!==s.getTests.call(i,e)[0].def))&&d[e]===s.getPlaceholder.call(i,e,r.match);e--)p--;return t?{l:p,def:u[p]?u[p].match:void 0}:p},e.determineNewCaretPosition=function(t,e,r){var i,n,o,h=this,d=h.maskset,p=h.opts;if(e&&(h.isRTL?t.end=t.begin:t.begin=t.end),t.begin===t.end){switch(r=r||p.positionCaretOnClick){case"none":break;case"select":t={begin:0,end:a.call(h).length};break;case"ignore":t.end=t.begin=u.call(h,l.call(h));break;case"radixFocus":if(h.clicked>1&&0===d.validPositions.length)break;if(function(t){if(""!==p.radixPoint&&0!==p.digits){var e=d.validPositions;if(void 0===e[t]||void 0===e[t].input){if(t<u.call(h,-1))return!0;var r=a.call(h).indexOf(p.radixPoint);if(-1!==r){for(var i=0,n=e.length;i<n;i++)if(e[i]&&r<i&&e[i].input!==s.getPlaceholder.call(h,i))return!1;return!0}}}return!1}(t.begin)){var f=a.call(h).join("").indexOf(p.radixPoint);t.end=t.begin=p.numericInput?u.call(h,f):f;break}default:if(i=t.begin,n=l.call(h,i,!0),i<=(o=u.call(h,-1!==n||c.call(h,0)?n:-1)))t.end=t.begin=c.call(h,i,!1,!0)?i:u.call(h,i);else{var m=d.validPositions[n],g=s.getTestTemplate.call(h,o,m?m.match.locator:void 0,m),y=s.getPlaceholder.call(h,o,g.match);if(""!==y&&a.call(h)[o]!==y&&!0!==g.match.optionalQuantifier&&!0!==g.match.newBlockMarker||!c.call(h,o,p.keepStatic,!0)&&g.match.def===y){var v=u.call(h,o);(i>=v||i===o)&&(o=v)}t.end=t.begin=o}}return t}},e.getBuffer=a,e.getBufferTemplate=function(){var t=this.maskset;return void 0===t._buffer&&(t._buffer=s.getMaskTemplate.call(this,!1,1),void 0===t.buffer&&(t.buffer=t._buffer.slice())),t._buffer},e.getLastValidPosition=l,e.isMask=c,e.resetMaskSet=function(t){var e=this.maskset;e.buffer=void 0,!0!==t&&(e.validPositions=[],e.p=0),!1===t&&(e.tests={},e.jitOffset={})},e.seekNext=u,e.seekPrevious=function(t,e){var r=this,i=t-1;if(t<=0)return 0;for(;i>0&&(!0===e&&(!0!==s.getTest.call(r,i).match.newBlockMarker||!c.call(r,i,void 0,!0))||!0!==e&&!c.call(r,i,void 0,!0));)i--;return i},e.translatePosition=h;var i,n=(i=r(9380))&&i.__esModule?i:{default:i},o=r(7215),s=r(4713);function a(t){var e=this,r=e.maskset;return void 0!==r.buffer&&!0!==t||(r.buffer=s.getMaskTemplate.call(e,!0,l.call(e),!0),void 0===r._buffer&&(r._buffer=r.buffer.slice())),r.buffer}function l(t,e,r){var i=this.maskset,n=-1,o=-1,s=r||i.validPositions;void 0===t&&(t=-1);for(var a=0,l=s.length;a<l;a++)s[a]&&(e||!0!==s[a].generatedInput)&&(a<=t&&(n=a),a>=t&&(o=a));return-1===n||n===t?o:-1===o||t-n<o-t?n:o}function c(t,e,r){var i=this,n=this.maskset,o=s.getTestTemplate.call(i,t).match;if(""===o.def&&(o=s.getTest.call(i,t).match),!0!==o.static)return o.fn;if(!0===r&&void 0!==n.validPositions[t]&&!0!==n.validPositions[t].generatedInput)return!0;if(!0!==e&&t>-1){if(r){var a=s.getTests.call(i,t);return a.length>1+(""===a[a.length-1].match.def?1:0)}var l=s.determineTestTemplate.call(i,t,s.getTests.call(i,t)),c=s.getPlaceholder.call(i,t,l.match);return l.match.def!==c}return!1}function u(t,e,r){var i=this;void 0===r&&(r=!0);for(var n=t+1;""!==s.getTest.call(i,n).match.def&&(!0===e&&(!0!==s.getTest.call(i,n).match.newBlockMarker||!c.call(i,n,void 0,!0))||!0!==e&&!c.call(i,n,void 0,r));)n++;return n}function h(t){var e=this.opts,r=this.el;return!this.isRTL||"number"!=typeof t||e.greedy&&""===e.placeholder||!r||(t=this._valueGet().length-t)<0&&(t=0),t}},4713:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.determineTestTemplate=h,e.getDecisionTaker=l,e.getMaskTemplate=function(t,e,r,i,n){var o=this,s=this.opts,a=this.maskset,l=s.greedy;n&&s.greedy&&(s.greedy=!1,o.maskset.tests={}),e=e||0;var d,p,m,g,y=[],v=0;do{if(!0===t&&a.validPositions[v])p=(m=n&&a.validPositions[v].match.optionality&&void 0===a.validPositions[v+1]&&(!0===a.validPositions[v].generatedInput||a.validPositions[v].input==s.skipOptionalPartCharacter&&v>0)?h.call(o,v,f.call(o,v,d,v-1)):a.validPositions[v]).match,d=m.locator.slice(),y.push(!0===r?m.input:!1===r?p.nativeDef:c.call(o,v,p));else{p=(m=u.call(o,v,d,v-1)).match,d=m.locator.slice();var _=!0!==i&&(!1!==s.jitMasking?s.jitMasking:p.jit);(g=(g||a.validPositions[v-1])&&p.static&&p.def!==s.groupSeparator&&null===p.fn)||!1===_||void 0===_||"number"==typeof _&&isFinite(_)&&_>v?y.push(!1===r?p.nativeDef:c.call(o,y.length,p)):g=!1}v++}while(!0!==p.static||""!==p.def||e>v);return""===y[y.length-1]&&y.pop(),!1===r&&void 0!==a.maskLength||(a.maskLength=v-1),s.greedy=l,y},e.getPlaceholder=c,e.getTest=d,e.getTestTemplate=u,e.getTests=f,e.isSubsetOf=p;var i,n=(i=r(2394))&&i.__esModule?i:{default:i},o=r(8711);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){var r=(null!=t.alternation?t.mloc[l(t)]:t.locator).join("");if(""!==r)for(r=r.split(":")[0];r.length<e;)r+="0";return r}function l(t){var e=t.locator[t.alternation];return"string"==typeof e&&e.length>0&&(e=e.split(",")[0]),void 0!==e?e.toString():""}function c(t,e,r){var i=this,n=this.opts,a=this.maskset;if(void 0!==(e=e||d.call(i,t).match).placeholder||!0===r){if(""!==e.placeholder&&!0===e.static&&!0!==e.generated){var l=o.getLastValidPosition.call(i,t),c=o.seekNext.call(i,l);return(r?t<=c:t<c)?n.staticDefinitionSymbol&&e.static?e.nativeDef:e.def:"function"==typeof e.placeholder?e.placeholder(n):e.placeholder}return"function"==typeof e.placeholder?e.placeholder(n):e.placeholder}if(!0===e.static){if(t>-1&&void 0===a.validPositions[t]){var u,h=f.call(i,t),p=[];if("string"==typeof n.placeholder&&h.length>1+(""===h[h.length-1].match.def?1:0))for(var m=0;m<h.length;m++)if(""!==h[m].match.def&&!0!==h[m].match.optionality&&!0!==h[m].match.optionalQuantifier&&(!0===h[m].match.static||void 0===u||!1!==h[m].match.fn.test(u.match.def,a,t,!0,n))&&(p.push(h[m]),!0===h[m].match.static&&(u=h[m]),p.length>1&&/[0-9a-bA-Z]/.test(p[0].match.def)))return n.placeholder.charAt(t%n.placeholder.length)}return e.def}return"object"===s(n.placeholder)?e.def:n.placeholder.charAt(t%n.placeholder.length)}function u(t,e,r){return this.maskset.validPositions[t]||h.call(this,t,f.call(this,t,e?e.slice():e,r))}function h(t,e){var r=this.opts,i=0,n=function(t,e){var r=0,i=!1;return e.forEach((function(t){t.match.optionality&&(0!==r&&r!==t.match.optionality&&(i=!0),(0===r||r>t.match.optionality)&&(r=t.match.optionality))})),r&&(0==t||1==e.length?r=0:i||(r=0)),r}(t,e);t=t>0?t-1:0;var o,s,l,c=a(d.call(this,t));r.greedy&&e.length>1&&""===e[e.length-1].match.def&&(i=1);for(var u=0;u<e.length-i;u++){var h=e[u];o=a(h,c.length);var p=Math.abs(o-c);(!0!==h.unMatchedAlternationStopped||e.filter((function(t){return!0!==t.unMatchedAlternationStopped})).length<=1)&&(void 0===s||""!==o&&p<s||l&&!r.greedy&&l.match.optionality&&l.match.optionality-n>0&&"master"===l.match.newBlockMarker&&(!h.match.optionality||h.match.optionality-n<1||!h.match.newBlockMarker)||l&&!r.greedy&&l.match.optionalQuantifier&&!h.match.optionalQuantifier)&&(s=p,l=h)}return l}function d(t,e){var r=this.maskset;return r.validPositions[t]?r.validPositions[t]:(e||f.call(this,t))[0]}function p(t,e,r){function i(t){for(var e,r=[],i=-1,n=0,o=t.length;n<o;n++)if("-"===t.charAt(n))for(e=t.charCodeAt(n+1);++i<e;)r.push(String.fromCharCode(i));else i=t.charCodeAt(n),r.push(t.charAt(n));return r.join("")}return t.match.def===e.match.nativeDef||!(!(r.regex||t.match.fn instanceof RegExp&&e.match.fn instanceof RegExp)||!0===t.match.static||!0===e.match.static)&&("."===e.match.fn.source||-1!==i(e.match.fn.source.replace(/[[\]/]/g,"")).indexOf(i(t.match.fn.source.replace(/[[\]/]/g,""))))}function f(t,e,r){var i,o,s=this,a=this.dependencyLib,l=this.maskset,c=this.opts,u=this.el,d=l.maskToken,f=e?r:0,m=e?e.slice():[0],g=[],y=!1,v=e?e.join(""):"",_=!1;function b(e,r,o,a){function h(o,a,d){function m(t,e){var r=0===e.matches.indexOf(t);return r||e.matches.every((function(i,n){return!0===i.isQuantifier?r=m(t,e.matches[n-1]):Object.prototype.hasOwnProperty.call(i,"matches")&&(r=m(t,i)),!r})),r}function w(t,e,r){var i,n;if((l.tests[t]||l.validPositions[t])&&(l.validPositions[t]?[l.validPositions[t]]:l.tests[t]).every((function(t,o){if(t.mloc[e])return i=t,!1;var s=void 0!==r?r:t.alternation,a=void 0!==t.locator[s]?t.locator[s].toString().indexOf(e):-1;return(void 0===n||a<n)&&-1!==a&&(i=t,n=a),!0})),i){var o=i.locator[i.alternation],s=i.mloc[e]||i.mloc[o]||i.locator;return-1!==s[s.length-1].toString().indexOf(":")&&s.pop(),s.slice((void 0!==r?r:i.alternation)+1)}return void 0!==r?w(t,e):void 0}function T(e,r){return!0===e.match.static&&!0!==r.match.static&&r.match.fn.test(e.match.def,l,t,!1,c,!1)}function E(t,e){var r=t.alternation,i=void 0===e||r<=e.alternation&&-1===t.locator[r].toString().indexOf(e.locator[r]);if(!i&&r>e.alternation)for(var n=0;n<r;n++)if(t.locator[n]!==e.locator[n]){r=n,i=!0;break}return!!i&&function(r){t.mloc=t.mloc||{};var i=t.locator[r];if(void 0!==i){if("string"==typeof i&&(i=i.split(",")[0]),void 0===t.mloc[i]&&(t.mloc[i]=t.locator.slice(),t.mloc[i].push(":".concat(t.alternation))),void 0!==e){for(var n in e.mloc)"string"==typeof n&&(n=parseInt(n.split(",")[0])),t.mloc[n+0]=e.mloc[n];t.locator[r]=Object.keys(t.mloc).join(",")}return t.alternation>r&&(t.alternation=r),!0}return t.alternation=void 0,!1}(r)}function S(t,e){if(t.locator.length!==e.locator.length)return!1;for(var r=t.alternation+1;r<t.locator.length;r++)if(t.locator[r]!==e.locator[r])return!1;return!0}if(f>t+c._maxTestPos)throw new Error("Inputmask: There is probably an error in your mask definition or in the code. Create an issue on github with an example of the mask you are using. ".concat(l.mask));if(f===t&&void 0===o.matches){if(g.push({match:o,locator:a.reverse(),cd:v,mloc:{}}),!o.optionality||void 0!==d||!(c.definitions&&c.definitions[o.nativeDef]&&c.definitions[o.nativeDef].optional||n.default.prototype.definitions[o.nativeDef]&&n.default.prototype.definitions[o.nativeDef].optional))return!0;y=!0,f=t}else if(void 0!==o.matches){if(o.isGroup&&d!==o)return function(){if(o=h(e.matches[e.matches.indexOf(o)+1],a,d))return!0}();if(o.isOptional)return function(){var e=o,n=g.length;if(o=b(o,r,a,d),g.length>0){if(g.forEach((function(t,e){e>=n&&(t.match.optionality=t.match.optionality?t.match.optionality+1:1)})),i=g[g.length-1].match,void 0!==d||!m(i,e))return o;y=!0,f=t}}();if(o.isAlternator)return function(){function i(t){for(var e,r=t.matches[0].matches?t.matches[0].matches.length:1,i=0;i<t.matches.length&&r===(e=t.matches[i].matches?t.matches[i].matches.length:1);i++);return r!==e}s.hasAlternator=!0;var n,m=o,v=[],b=g.slice(),x=a.length,P=r.length>0?r.shift():-1;if(-1===P||"string"==typeof P){var k,A=f,M=r.slice(),C=[];if("string"==typeof P)C=P.split(",");else for(k=0;k<m.matches.length;k++)C.push(k.toString());if(void 0!==l.excludes[t]){for(var I=C.slice(),O=0,L=l.excludes[t].length;O<L;O++){var D=l.excludes[t][O].toString().split(":");a.length==D[1]&&C.splice(C.indexOf(D[0]),1)}0===C.length&&(delete l.excludes[t],C=I)}(!0===c.keepStatic||isFinite(parseInt(c.keepStatic))&&A>=c.keepStatic)&&(C=C.slice(0,1));for(var R=0;R<C.length;R++){k=parseInt(C[R]),g=[],r="string"==typeof P&&w(f,k,x)||M.slice();var F=m.matches[k];if(F&&h(F,[k].concat(a),d))o=!0;else if(0===R&&(_=i(m)),F&&F.matches&&F.matches.length>m.matches[0].matches.length)break;n=g.slice(),f=A,g=[];for(var B=0;B<n.length;B++){var z=n[B],j=!1;z.alternation=z.alternation||x,E(z);for(var N=0;N<v.length;N++){var V=v[N];if("string"!=typeof P||void 0!==z.alternation&&C.includes(z.locator[z.alternation].toString())){if(z.match.nativeDef===V.match.nativeDef){j=!0,E(V,z);break}if(p(z,V,c)){E(z,V)&&(j=!0,v.splice(v.indexOf(V),0,z));break}if(p(V,z,c)){E(V,z);break}if(T(z,V)){S(z,V)||void 0!==u.inputmask.userOptions.keepStatic?E(z,V)&&(j=!0,v.splice(v.indexOf(V),0,z)):c.keepStatic=!0;break}if(T(V,z)){E(V,z);break}}}j||v.push(z)}}g=b.concat(v),f=t,y=g.length>0&&_,o=v.length>0&&!_,_&&y&&!o&&g.forEach((function(t,e){t.unMatchedAlternationStopped=!0})),r=M.slice()}else o=h(m.matches[P]||e.matches[P],[P].concat(a),d);if(o)return!0}();if(o.isQuantifier&&d!==e.matches[e.matches.indexOf(o)-1])return function(){for(var n=o,s=!1,u=r.length>0?r.shift():0;u<(isNaN(n.quantifier.max)?u+1:n.quantifier.max)&&f<=t;u++){var d=e.matches[e.matches.indexOf(n)-1];if(o=h(d,[u].concat(a),d)){if(g.forEach((function(e,r){(i=x(d,e.match)?e.match:g[g.length-1].match).optionalQuantifier=u>=n.quantifier.min,i.jit=(u+1)*(d.matches.indexOf(i)+1)>n.quantifier.jit,i.optionalQuantifier&&m(i,d)&&(y=!0,f=t,c.greedy&&null==l.validPositions[t-1]&&u>n.quantifier.min&&-1!=["*","+"].indexOf(n.quantifier.max)&&(g.pop(),v=void 0),s=!0,o=!1),!s&&i.jit&&(l.jitOffset[t]=d.matches.length-d.matches.indexOf(i))})),s)break;return!0}}}();if(o=b(o,r,a,d))return!0}else f++}for(var d=r.length>0?r.shift():0;d<e.matches.length;d++)if(!0!==e.matches[d].isQuantifier){var m=h(e.matches[d],[d].concat(o),a);if(m&&f===t)return m;if(f>t)break}}function x(t,e){var r=-1!=t.matches.indexOf(e);return r||t.matches.forEach((function(t,i){void 0===t.matches||r||(r=x(t,e))})),r}if(t>-1){if(void 0===e){for(var w,T=t-1;void 0===(w=l.validPositions[T]||l.tests[T])&&T>-1;)T--;void 0!==w&&T>-1&&(m=function(t,e){var r,i=[];return Array.isArray(e)||(e=[e]),e.length>0&&(void 0===e[0].alternation||!0===c.keepStatic?0===(i=h.call(s,t,e.slice()).locator.slice()).length&&(i=e[0].locator.slice()):e.forEach((function(t){""!==t.def&&(0===i.length?(r=t.alternation,i=t.locator.slice()):t.locator[r]&&-1===i[r].toString().indexOf(t.locator[r])&&(i[r]+=","+t.locator[r]))}))),i}(T,w),v=m.join(""),f=T)}if(l.tests[t]&&l.tests[t][0].cd===v)return l.tests[t];for(var E=m.shift();E<d.length&&!(b(d[E],m,[E])&&f===t||f>t);E++);}return(0===g.length||y)&&g.push({match:{fn:null,static:!0,optionality:!1,casing:null,def:"",placeholder:""},locator:_&&0===g.filter((function(t){return!0!==t.unMatchedAlternationStopped})).length?[0]:[],mloc:{},cd:v}),void 0!==e&&l.tests[t]?o=a.extend(!0,[],g):(l.tests[t]=a.extend(!0,[],g),o=l.tests[t]),g.forEach((function(t){t.match.optionality=t.match.defOptionality||!1})),o}},7215:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.alternate=a,e.checkAlternationMatch=function(t,e,r){for(var i,n=this.opts.greedy?e:e.slice(0,1),o=!1,s=void 0!==r?r.split(","):[],a=0;a<s.length;a++)-1!==(i=t.indexOf(s[a]))&&t.splice(i,1);for(var l=0;l<t.length;l++)if(n.includes(t[l])){o=!0;break}return o},e.handleRemove=function(t,e,r,i,l){var c=this,u=this.maskset,h=this.opts;if((h.numericInput||c.isRTL)&&(e===n.keys.Backspace?e=n.keys.Delete:e===n.keys.Delete&&(e=n.keys.Backspace),c.isRTL)){var d=r.end;r.end=r.begin,r.begin=d}var p,f=o.getLastValidPosition.call(c,void 0,!0);r.end>=o.getBuffer.call(c).length&&f>=r.end&&(r.end=f+1),e===n.keys.Backspace?r.end-r.begin<1&&(r.begin=o.seekPrevious.call(c,r.begin)):e===n.keys.Delete&&r.begin===r.end&&(r.end=o.isMask.call(c,r.end,!0,!0)?r.end+1:o.seekNext.call(c,r.end)+1),!1!==(p=m.call(c,r))&&((!0!==i&&!1!==h.keepStatic||null!==h.regex&&-1!==s.getTest.call(c,r.begin).match.def.indexOf("|"))&&a.call(c,!0),!0!==i&&(u.p=e===n.keys.Delete?r.begin+p:r.begin,u.p=o.determineNewCaretPosition.call(c,{begin:u.p,end:u.p},!1,!1===h.insertMode&&e===n.keys.Backspace?"none":void 0).begin))},e.isComplete=c,e.isSelection=u,e.isValid=h,e.refreshFromBuffer=p,e.revalidateMask=m;var i=r(6030),n=r(2839),o=r(8711),s=r(4713);function a(t,e,r,i,n,l){var c=this,u=this.dependencyLib,d=this.opts,p=c.maskset;if(!c.hasAlternator)return!1;var f,m,g,y,v,_,b,x,w,T,E,S=u.extend(!0,[],p.validPositions),P=u.extend(!0,{},p.tests),k=!1,A=!1,M=void 0!==n?n:o.getLastValidPosition.call(c);if(l&&(T=l.begin,E=l.end,l.begin>l.end&&(T=l.end,E=l.begin)),-1===M&&void 0===n)f=0,m=(y=s.getTest.call(c,f)).alternation;else for(;M>=0;M--)if((g=p.validPositions[M])&&void 0!==g.alternation){if(M<=(t||0)&&y&&y.locator[g.alternation]!==g.locator[g.alternation])break;f=M,m=p.validPositions[f].alternation,y=g}if(void 0!==m){b=parseInt(f),p.excludes[b]=p.excludes[b]||[],!0!==t&&p.excludes[b].push((0,s.getDecisionTaker)(y)+":"+y.alternation);var C=[],I=-1;for(v=b;b<o.getLastValidPosition.call(c,void 0,!0)+1;v++)-1===I&&t<=v&&void 0!==e&&(C.push(e),I=C.length-1),(_=p.validPositions[b])&&!0!==_.generatedInput&&(void 0===l||v<T||v>=E)&&C.push(_.input),p.validPositions.splice(b,1);for(-1===I&&void 0!==e&&(C.push(e),I=C.length-1);void 0!==p.excludes[b]&&p.excludes[b].length<10;){for(p.tests={},o.resetMaskSet.call(c,!0),k=!0,v=0;v<C.length&&(x=k.caret||0==d.insertMode&&null!=x?o.seekNext.call(c,x):o.getLastValidPosition.call(c,void 0,!0)+1,w=C[v],k=h.call(c,x,w,!1,i,!0));v++)v===I&&(A=k),1==t&&k&&(A={caretPos:v});if(k)break;if(o.resetMaskSet.call(c),y=s.getTest.call(c,b),p.validPositions=u.extend(!0,[],S),p.tests=u.extend(!0,{},P),!p.excludes[b]){A=a.call(c,t,e,r,i,b-1,l);break}if(null!=y.alternation){var O=(0,s.getDecisionTaker)(y);if(-1!==p.excludes[b].indexOf(O+":"+y.alternation)){A=a.call(c,t,e,r,i,b-1,l);break}for(p.excludes[b].push(O+":"+y.alternation),v=b;v<o.getLastValidPosition.call(c,void 0,!0)+1;v++)p.validPositions.splice(b)}else delete p.excludes[b]}}return A&&!1===d.keepStatic||delete p.excludes[b],A}function l(t,e,r){var i=this.opts,o=this.maskset;switch(i.casing||e.casing){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase();break;case"title":var s=o.validPositions[r-1];t=0===r||s&&s.input===String.fromCharCode(n.keyCode.Space)?t.toUpperCase():t.toLowerCase();break;default:if("function"==typeof i.casing){var a=Array.prototype.slice.call(arguments);a.push(o.validPositions),t=i.casing.apply(this,a)}}return t}function c(t){var e=this,r=this.opts,i=this.maskset;if("function"==typeof r.isComplete)return r.isComplete(t,r);if("*"!==r.repeat){var n=!1,a=o.determineLastRequiredPosition.call(e,!0),l=a.l;if(void 0===a.def||a.def.newBlockMarker||a.def.optionality||a.def.optionalQuantifier){n=!0;for(var c=0;c<=l;c++){var u=s.getTestTemplate.call(e,c).match;if(!0!==u.static&&void 0===i.validPositions[c]&&(!1===u.optionality||void 0===u.optionality||u.optionality&&0==u.newBlockMarker)&&(!1===u.optionalQuantifier||void 0===u.optionalQuantifier)||!0===u.static&&""!=u.def&&t[c]!==s.getPlaceholder.call(e,c,u)){n=!1;break}}}return n}}function u(t){var e=this.opts.insertMode?0:1;return this.isRTL?t.begin-t.end>e:t.end-t.begin>e}function h(t,e,r,i,n,d,g){var y=this,v=this.dependencyLib,_=this.opts,b=y.maskset;r=!0===r;var x=t;function w(t){if(void 0!==t){if(void 0!==t.remove&&(Array.isArray(t.remove)||(t.remove=[t.remove]),t.remove.sort((function(t,e){return y.isRTL?t.pos-e.pos:e.pos-t.pos})).forEach((function(t){m.call(y,{begin:t,end:t+1})})),t.remove=void 0),void 0!==t.insert&&(Array.isArray(t.insert)||(t.insert=[t.insert]),t.insert.sort((function(t,e){return y.isRTL?e.pos-t.pos:t.pos-e.pos})).forEach((function(t){""!==t.c&&h.call(y,t.pos,t.c,void 0===t.strict||t.strict,void 0!==t.fromIsValid?t.fromIsValid:i)})),t.insert=void 0),t.refreshFromBuffer&&t.buffer){var e=t.refreshFromBuffer;p.call(y,!0===e?e:e.start,e.end,t.buffer),t.refreshFromBuffer=void 0}void 0!==t.rewritePosition&&(x=t.rewritePosition,t=!0)}return t}function T(e,r,n){var a=!1;return s.getTests.call(y,e).every((function(c,h){var d=c.match;if(o.getBuffer.call(y,!0),!1!==(a=(!d.jit||void 0!==b.validPositions[o.seekPrevious.call(y,e)])&&(null!=d.fn?d.fn.test(r,b,e,n,_,u.call(y,t)):(r===d.def||r===_.skipOptionalPartCharacter)&&""!==d.def&&{c:s.getPlaceholder.call(y,e,d,!0)||d.def,pos:e}))){var p=void 0!==a.c?a.c:r,f=e;return p=p===_.skipOptionalPartCharacter&&!0===d.static?s.getPlaceholder.call(y,e,d,!0)||d.def:p,!0!==(a=w(a))&&void 0!==a.pos&&a.pos!==e&&(f=a.pos),!0!==a&&void 0===a.pos&&void 0===a.c||!1===m.call(y,t,v.extend({},c,{input:l.call(y,p,d,f)}),i,f)&&(a=!1),!1}return!0})),a}void 0!==t.begin&&(x=y.isRTL?t.end:t.begin);var E=!0,S=v.extend(!0,[],b.validPositions);if(!1===_.keepStatic&&void 0!==b.excludes[x]&&!0!==n&&!0!==i)for(var P=x;P<(y.isRTL?t.begin:t.end);P++)void 0!==b.excludes[P]&&(b.excludes[P]=void 0,delete b.tests[P]);if("function"==typeof _.preValidation&&!0!==i&&!0!==d&&(E=w(E=_.preValidation.call(y,o.getBuffer.call(y),x,e,u.call(y,t),_,b,t,r||n))),!0===E){if(E=T(x,e,r),(!r||!0===i)&&!1===E&&!0!==d){var k=b.validPositions[x];if(!k||!0!==k.match.static||k.match.def!==e&&e!==_.skipOptionalPartCharacter){if(_.insertMode||void 0===b.validPositions[o.seekNext.call(y,x)]||t.end>x){var A=!1;if(b.jitOffset[x]&&void 0===b.validPositions[o.seekNext.call(y,x)]&&!1!==(E=h.call(y,x+b.jitOffset[x],e,!0,!0))&&(!0!==n&&(E.caret=x),A=!0),t.end>x&&(b.validPositions[x]=void 0),!A&&!o.isMask.call(y,x,_.keepStatic&&0===x))for(var M=x+1,C=o.seekNext.call(y,x,!1,0!==x);M<=C;M++)if(!1!==(E=T(M,e,r))){E=f.call(y,x,void 0!==E.pos?E.pos:M)||E,x=M;break}}}else E={caret:o.seekNext.call(y,x)}}y.hasAlternator&&!0!==n&&!r&&(n=!0,!1===E&&_.keepStatic&&(c.call(y,o.getBuffer.call(y))||0===x)?E=a.call(y,x,e,r,i,void 0,t):(u.call(y,t)&&b.tests[x]&&b.tests[x].length>1&&_.keepStatic||1==E&&!0!==_.numericInput&&b.tests[x]&&b.tests[x].length>1&&o.getLastValidPosition.call(y,void 0,!0)>x)&&(E=a.call(y,!0))),!0===E&&(E={pos:x})}if("function"==typeof _.postValidation&&!0!==i&&!0!==d){var I=_.postValidation.call(y,o.getBuffer.call(y,!0),void 0!==t.begin?y.isRTL?t.end:t.begin:t,e,E,_,b,r,g);void 0!==I&&(E=!0===I?E:I)}E&&void 0===E.pos&&(E.pos=x),!1===E||!0===d?(o.resetMaskSet.call(y,!0),b.validPositions=v.extend(!0,[],S)):f.call(y,void 0,x,!0);var O=w(E);return void 0!==y.maxLength&&o.getBuffer.call(y).length>y.maxLength&&!i&&(o.resetMaskSet.call(y,!0),b.validPositions=v.extend(!0,[],S),O=!1),O}function d(t,e,r){for(var i=this.maskset,n=!1,o=s.getTests.call(this,t),a=0;a<o.length;a++){if(o[a].match&&(o[a].match.nativeDef===e.match[r.shiftPositions?"def":"nativeDef"]&&(!r.shiftPositions||!e.match.static)||o[a].match.nativeDef===e.match.nativeDef||r.regex&&!o[a].match.static&&o[a].match.fn.test(e.input,i,t,!1,r))){n=!0;break}if(o[a].match&&o[a].match.def===e.match.nativeDef){n=void 0;break}}return!1===n&&void 0!==i.jitOffset[t]&&(n=d.call(this,t+i.jitOffset[t],e,r)),n}function p(t,e,r){var n,s,a=this,l=this.maskset,c=this.opts,u=this.dependencyLib,h=c.skipOptionalPartCharacter,d=a.isRTL?r.slice().reverse():r;if(c.skipOptionalPartCharacter="",!0===t)o.resetMaskSet.call(a,!1),t=0,e=r.length,s=o.determineNewCaretPosition.call(a,{begin:0,end:0},!1).begin;else{for(n=t;n<e;n++)l.validPositions.splice(t,0);s=t}var p=new u.Event("keypress");for(n=t;n<e;n++){p.key=d[n].toString(),a.ignorable=!1;var f=i.EventHandlers.keypressEvent.call(a,p,!0,!1,!1,s);!1!==f&&void 0!==f&&(s=f.forwardPosition)}c.skipOptionalPartCharacter=h}function f(t,e,r){var i=this,n=this.maskset,a=this.dependencyLib;if(void 0===t)for(t=e-1;t>0&&!n.validPositions[t];t--);for(var l=t;l<e;l++)if(void 0===n.validPositions[l]&&!o.isMask.call(i,l,!1)&&(0==l?s.getTest.call(i,l):n.validPositions[l-1])){var c=s.getTests.call(i,l).slice();""===c[c.length-1].match.def&&c.pop();var u,d=s.determineTestTemplate.call(i,l,c);if(d&&(!0!==d.match.jit||"master"===d.match.newBlockMarker&&(u=n.validPositions[l+1])&&!0===u.match.optionalQuantifier)&&((d=a.extend({},d,{input:s.getPlaceholder.call(i,l,d.match,!0)||d.match.def})).generatedInput=!0,m.call(i,l,d,!0),!0!==r)){var p=n.validPositions[e].input;return n.validPositions[e]=void 0,h.call(i,e,p,!0,!0)}}}function m(t,e,r,i){var n=this,a=this.maskset,l=this.opts,c=this.dependencyLib;function p(t,e,r){var i=e[t];if(void 0!==i&&!0===i.match.static&&!0!==i.match.optionality&&(void 0===e[0]||void 0===e[0].alternation)){var n=r.begin<=t-1?e[t-1]&&!0===e[t-1].match.static&&e[t-1]:e[t-1],o=r.end>t+1?e[t+1]&&!0===e[t+1].match.static&&e[t+1]:e[t+1];return n&&o}return!1}var f=0,m=void 0!==t.begin?t.begin:t,g=void 0!==t.end?t.end:t,y=!0;if(t.begin>t.end&&(m=t.end,g=t.begin),i=void 0!==i?i:m,void 0===r&&(m!==g||l.insertMode&&void 0!==a.validPositions[i]||void 0===e||e.match.optionalQuantifier||e.match.optionality)){var v,_=c.extend(!0,[],a.validPositions),b=o.getLastValidPosition.call(n,void 0,!0);a.p=m;var x=u.call(n,t)?m:i;for(v=b;v>=x;v--)a.validPositions.splice(v,1),void 0===e&&delete a.tests[v+1];var w,T,E=i,S=E;for(e&&(a.validPositions[i]=c.extend(!0,{},e),S++,E++),null==_[g]&&a.jitOffset[g]&&(g+=a.jitOffset[g]+1),v=e?g:g-1;v<=b;v++){if(void 0!==(w=_[v])&&!0!==w.generatedInput&&(v>=g||v>=m&&p(v,_,{begin:m,end:g}))){for(;""!==s.getTest.call(n,S).match.def;){if(!1!==(T=d.call(n,S,w,l))||"+"===w.match.def){"+"===w.match.def&&o.getBuffer.call(n,!0);var P=h.call(n,S,w.input,"+"!==w.match.def,!0);if(y=!1!==P,E=(P.pos||S)+1,!y&&T)break}else y=!1;if(y){void 0===e&&w.match.static&&v===t.begin&&f++;break}if(!y&&o.getBuffer.call(n),S>a.maskLength)break;S++}""==s.getTest.call(n,S).match.def&&(y=!1),S=E}if(!y)break}if(!y)return a.validPositions=c.extend(!0,[],_),o.resetMaskSet.call(n,!0),!1}else e&&s.getTest.call(n,i).match.cd===e.match.cd&&(a.validPositions[i]=c.extend(!0,{},e));return o.resetMaskSet.call(n,!0),f}}},e={};function r(i){var n=e[i];if(void 0!==n)return n.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,r),o.exports}var i={};return function(){var t=i;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(7149),r(3194),r(9302),r(4013),r(3851),r(219),r(207),r(5296);var e,n=(e=r(2394))&&e.__esModule?e:{default:e};t.default=n.default}(),i}()},4692:function(t,e){var r;!function(e,r){"use strict";"object"==typeof t.exports?t.exports=e.document?r(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return r(t)}:r(e)}("undefined"!=typeof window?window:this,(function(i,n){"use strict";var o=[],s=Object.getPrototypeOf,a=o.slice,l=o.flat?function(t){return o.flat.call(t)}:function(t){return o.concat.apply([],t)},c=o.push,u=o.indexOf,h={},d=h.toString,p=h.hasOwnProperty,f=p.toString,m=f.call(Object),g={},y=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType&&"function"!=typeof t.item},v=function(t){return null!=t&&t===t.window},_=i.document,b={type:!0,src:!0,nonce:!0,noModule:!0};function x(t,e,r){var i,n,o=(r=r||_).createElement("script");if(o.text=t,e)for(i in b)(n=e[i]||e.getAttribute&&e.getAttribute(i))&&o.setAttribute(i,n);r.head.appendChild(o).parentNode.removeChild(o)}function w(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?h[d.call(t)]||"object":typeof t}var T="3.6.0",E=function(t,e){return new E.fn.init(t,e)};function S(t){var e=!!t&&"length"in t&&t.length,r=w(t);return!y(t)&&!v(t)&&("array"===r||0===e||"number"==typeof e&&e>0&&e-1 in t)}E.fn=E.prototype={jquery:T,constructor:E,length:0,toArray:function(){return a.call(this)},get:function(t){return null==t?a.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=E.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return E.each(this,t)},map:function(t){return this.pushStack(E.map(this,(function(e,r){return t.call(e,r,e)})))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(E.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(E.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,r=+t+(t<0?e:0);return this.pushStack(r>=0&&r<e?[this[r]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:o.sort,splice:o.splice},E.extend=E.fn.extend=function(){var t,e,r,i,n,o,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||y(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)i=t[e],"__proto__"!==e&&s!==i&&(c&&i&&(E.isPlainObject(i)||(n=Array.isArray(i)))?(r=s[e],o=n&&!Array.isArray(r)?[]:n||E.isPlainObject(r)?r:{},n=!1,s[e]=E.extend(c,o,i)):void 0!==i&&(s[e]=i));return s},E.extend({expando:"jQuery"+(T+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,r;return!(!t||"[object Object]"!==d.call(t))&&(!(e=s(t))||"function"==typeof(r=p.call(e,"constructor")&&e.constructor)&&f.call(r)===m)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,r){x(t,{nonce:e&&e.nonce},r)},each:function(t,e){var r,i=0;if(S(t))for(r=t.length;i<r&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},makeArray:function(t,e){var r=e||[];return null!=t&&(S(Object(t))?E.merge(r,"string"==typeof t?[t]:t):c.call(r,t)),r},inArray:function(t,e,r){return null==e?-1:u.call(e,t,r)},merge:function(t,e){for(var r=+e.length,i=0,n=t.length;i<r;i++)t[n++]=e[i];return t.length=n,t},grep:function(t,e,r){for(var i=[],n=0,o=t.length,s=!r;n<o;n++)!e(t[n],n)!==s&&i.push(t[n]);return i},map:function(t,e,r){var i,n,o=0,s=[];if(S(t))for(i=t.length;o<i;o++)null!=(n=e(t[o],o,r))&&s.push(n);else for(o in t)null!=(n=e(t[o],o,r))&&s.push(n);return l(s)},guid:1,support:g}),"function"==typeof Symbol&&(E.fn[Symbol.iterator]=o[Symbol.iterator]),E.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){h["[object "+e+"]"]=e.toLowerCase()}));var P=function(t){var e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y,v,_,b="sizzle"+1*new Date,x=t.document,w=0,T=0,E=lt(),S=lt(),P=lt(),k=lt(),A=function(t,e){return t===e&&(h=!0),0},M={}.hasOwnProperty,C=[],I=C.pop,O=C.push,L=C.push,D=C.slice,R=function(t,e){for(var r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",B="[\\x20\\t\\r\\n\\f]",z="(?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",j="\\[[\\x20\\t\\r\\n\\f]*("+z+")(?:"+B+"*([*^$|!~]?=)"+B+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+z+"))|)"+B+"*\\]",N=":("+z+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+j+")*)|.*)\\)|)",V=new RegExp(B+"+","g"),U=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),$=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),G=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),H=new RegExp(B+"|>"),q=new RegExp(N),W=new RegExp("^"+z+"$"),Z={ID:new RegExp("^#("+z+")"),CLASS:new RegExp("^\\.("+z+")"),TAG:new RegExp("^("+z+"|[*])"),ATTR:new RegExp("^"+j),PSEUDO:new RegExp("^"+N),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:new RegExp("^(?:"+F+")$","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},X=/HTML$/i,Y=/^(?:input|select|textarea|button)$/i,K=/^h\d$/i,J=/^[^{]+\{\s*\[native \w/,Q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\([^\\r\\n\\f])","g"),rt=function(t,e){var r="0x"+t.slice(1)-65536;return e||(r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320))},it=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,nt=function(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},ot=function(){d()},st=bt((function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{L.apply(C=D.call(x.childNodes),x.childNodes),C[x.childNodes.length].nodeType}catch(t){L={apply:C.length?function(t,e){O.apply(t,D.call(e))}:function(t,e){for(var r=t.length,i=0;t[r++]=e[i++];);t.length=r-1}}}function at(t,e,i,n){var o,a,c,u,h,f,y,v=e&&e.ownerDocument,x=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==x&&9!==x&&11!==x)return i;if(!n&&(d(e),e=e||p,m)){if(11!==x&&(h=Q.exec(t)))if(o=h[1]){if(9===x){if(!(c=e.getElementById(o)))return i;if(c.id===o)return i.push(c),i}else if(v&&(c=v.getElementById(o))&&_(e,c)&&c.id===o)return i.push(c),i}else{if(h[2])return L.apply(i,e.getElementsByTagName(t)),i;if((o=h[3])&&r.getElementsByClassName&&e.getElementsByClassName)return L.apply(i,e.getElementsByClassName(o)),i}if(r.qsa&&!k[t+" "]&&(!g||!g.test(t))&&(1!==x||"object"!==e.nodeName.toLowerCase())){if(y=t,v=e,1===x&&(H.test(t)||G.test(t))){for((v=tt.test(t)&&yt(e.parentNode)||e)===e&&r.scope||((u=e.getAttribute("id"))?u=u.replace(it,nt):e.setAttribute("id",u=b)),a=(f=s(t)).length;a--;)f[a]=(u?"#"+u:":scope")+" "+_t(f[a]);y=f.join(",")}try{return L.apply(i,v.querySelectorAll(y)),i}catch(e){k(t,!0)}finally{u===b&&e.removeAttribute("id")}}}return l(t.replace(U,"$1"),e,i,n)}function lt(){var t=[];return function e(r,n){return t.push(r+" ")>i.cacheLength&&delete e[t.shift()],e[r+" "]=n}}function ct(t){return t[b]=!0,t}function ut(t){var e=p.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ht(t,e){for(var r=t.split("|"),n=r.length;n--;)i.attrHandle[r[n]]=e}function dt(t,e){var r=e&&t,i=r&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(i)return i;if(r)for(;r=r.nextSibling;)if(r===e)return-1;return t?1:-1}function pt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ft(t){return function(e){var r=e.nodeName.toLowerCase();return("input"===r||"button"===r)&&e.type===t}}function mt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&st(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function gt(t){return ct((function(e){return e=+e,ct((function(r,i){for(var n,o=t([],r.length,e),s=o.length;s--;)r[n=o[s]]&&(r[n]=!(i[n]=r[n]))}))}))}function yt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in r=at.support={},o=at.isXML=function(t){var e=t&&t.namespaceURI,r=t&&(t.ownerDocument||t).documentElement;return!X.test(e||r&&r.nodeName||"HTML")},d=at.setDocument=function(t){var e,n,s=t?t.ownerDocument||t:x;return s!=p&&9===s.nodeType&&s.documentElement?(f=(p=s).documentElement,m=!o(p),x!=p&&(n=p.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",ot,!1):n.attachEvent&&n.attachEvent("onunload",ot)),r.scope=ut((function(t){return f.appendChild(t).appendChild(p.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length})),r.attributes=ut((function(t){return t.className="i",!t.getAttribute("className")})),r.getElementsByTagName=ut((function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length})),r.getElementsByClassName=J.test(p.getElementsByClassName),r.getById=ut((function(t){return f.appendChild(t).id=b,!p.getElementsByName||!p.getElementsByName(b).length})),r.getById?(i.filter.ID=function(t){var e=t.replace(et,rt);return function(t){return t.getAttribute("id")===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var r=e.getElementById(t);return r?[r]:[]}}):(i.filter.ID=function(t){var e=t.replace(et,rt);return function(t){var r=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return r&&r.value===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var r,i,n,o=e.getElementById(t);if(o){if((r=o.getAttributeNode("id"))&&r.value===t)return[o];for(n=e.getElementsByName(t),i=0;o=n[i++];)if((r=o.getAttributeNode("id"))&&r.value===t)return[o]}return[]}}),i.find.TAG=r.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):r.qsa?e.querySelectorAll(t):void 0}:function(t,e){var r,i=[],n=0,o=e.getElementsByTagName(t);if("*"===t){for(;r=o[n++];)1===r.nodeType&&i.push(r);return i}return o},i.find.CLASS=r.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&m)return e.getElementsByClassName(t)},y=[],g=[],(r.qsa=J.test(p.querySelectorAll))&&(ut((function(t){var e;f.appendChild(t).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll("[selected]").length||g.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+F+")"),t.querySelectorAll("[id~="+b+"-]").length||g.push("~="),(e=p.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||g.push("\\[[\\x20\\t\\r\\n\\f]*name[\\x20\\t\\r\\n\\f]*=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll(":checked").length||g.push(":checked"),t.querySelectorAll("a#"+b+"+*").length||g.push(".#.+[+~]"),t.querySelectorAll("\\\f"),g.push("[\\r\\n\\f]")})),ut((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&g.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),f.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),g.push(",.*:")}))),(r.matchesSelector=J.test(v=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ut((function(t){r.disconnectedMatch=v.call(t,"*"),v.call(t,"[s!='']:x"),y.push("!=",N)})),g=g.length&&new RegExp(g.join("|")),y=y.length&&new RegExp(y.join("|")),e=J.test(f.compareDocumentPosition),_=e||J.test(f.contains)?function(t,e){var r=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(r.contains?r.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},A=e?function(t,e){if(t===e)return h=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!r.sortDetached&&e.compareDocumentPosition(t)===i?t==p||t.ownerDocument==x&&_(x,t)?-1:e==p||e.ownerDocument==x&&_(x,e)?1:u?R(u,t)-R(u,e):0:4&i?-1:1)}:function(t,e){if(t===e)return h=!0,0;var r,i=0,n=t.parentNode,o=e.parentNode,s=[t],a=[e];if(!n||!o)return t==p?-1:e==p?1:n?-1:o?1:u?R(u,t)-R(u,e):0;if(n===o)return dt(t,e);for(r=t;r=r.parentNode;)s.unshift(r);for(r=e;r=r.parentNode;)a.unshift(r);for(;s[i]===a[i];)i++;return i?dt(s[i],a[i]):s[i]==x?-1:a[i]==x?1:0},p):p},at.matches=function(t,e){return at(t,null,null,e)},at.matchesSelector=function(t,e){if(d(t),r.matchesSelector&&m&&!k[e+" "]&&(!y||!y.test(e))&&(!g||!g.test(e)))try{var i=v.call(t,e);if(i||r.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){k(e,!0)}return at(e,p,null,[t]).length>0},at.contains=function(t,e){return(t.ownerDocument||t)!=p&&d(t),_(t,e)},at.attr=function(t,e){(t.ownerDocument||t)!=p&&d(t);var n=i.attrHandle[e.toLowerCase()],o=n&&M.call(i.attrHandle,e.toLowerCase())?n(t,e,!m):void 0;return void 0!==o?o:r.attributes||!m?t.getAttribute(e):(o=t.getAttributeNode(e))&&o.specified?o.value:null},at.escape=function(t){return(t+"").replace(it,nt)},at.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},at.uniqueSort=function(t){var e,i=[],n=0,o=0;if(h=!r.detectDuplicates,u=!r.sortStable&&t.slice(0),t.sort(A),h){for(;e=t[o++];)e===t[o]&&(n=i.push(o));for(;n--;)t.splice(i[n],1)}return u=null,t},n=at.getText=function(t){var e,r="",i=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)r+=n(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[i++];)r+=n(e);return r},i=at.selectors={cacheLength:50,createPseudo:ct,match:Z,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,rt),t[3]=(t[3]||t[4]||t[5]||"").replace(et,rt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||at.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&at.error(t[0]),t},PSEUDO:function(t){var e,r=!t[6]&&t[2];return Z.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":r&&q.test(r)&&(e=s(r,!0))&&(e=r.indexOf(")",r.length-e)-r.length)&&(t[0]=t[0].slice(0,e),t[2]=r.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,rt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=E[t+" "];return e||(e=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+t+"("+B+"|$)"))&&E(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,r){return function(i){var n=at.attr(i,t);return null==n?"!="===e:!e||(n+="","="===e?n===r:"!="===e?n!==r:"^="===e?r&&0===n.indexOf(r):"*="===e?r&&n.indexOf(r)>-1:"$="===e?r&&n.slice(-r.length)===r:"~="===e?(" "+n.replace(V," ")+" ").indexOf(r)>-1:"|="===e&&(n===r||n.slice(0,r.length+1)===r+"-"))}},CHILD:function(t,e,r,i,n){var o="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===i&&0===n?function(t){return!!t.parentNode}:function(e,r,l){var c,u,h,d,p,f,m=o!==s?"nextSibling":"previousSibling",g=e.parentNode,y=a&&e.nodeName.toLowerCase(),v=!l&&!a,_=!1;if(g){if(o){for(;m;){for(d=e;d=d[m];)if(a?d.nodeName.toLowerCase()===y:1===d.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[s?g.firstChild:g.lastChild],s&&v){for(_=(p=(c=(u=(h=(d=g)[b]||(d[b]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===w&&c[1])&&c[2],d=p&&g.childNodes[p];d=++p&&d&&d[m]||(_=p=0)||f.pop();)if(1===d.nodeType&&++_&&d===e){u[t]=[w,p,_];break}}else if(v&&(_=p=(c=(u=(h=(d=e)[b]||(d[b]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===w&&c[1]),!1===_)for(;(d=++p&&d&&d[m]||(_=p=0)||f.pop())&&((a?d.nodeName.toLowerCase()!==y:1!==d.nodeType)||!++_||(v&&((u=(h=d[b]||(d[b]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]=[w,_]),d!==e)););return(_-=n)===i||_%i==0&&_/i>=0}}},PSEUDO:function(t,e){var r,n=i.pseudos[t]||i.setFilters[t.toLowerCase()]||at.error("unsupported pseudo: "+t);return n[b]?n(e):n.length>1?(r=[t,t,"",e],i.setFilters.hasOwnProperty(t.toLowerCase())?ct((function(t,r){for(var i,o=n(t,e),s=o.length;s--;)t[i=R(t,o[s])]=!(r[i]=o[s])})):function(t){return n(t,0,r)}):n}},pseudos:{not:ct((function(t){var e=[],r=[],i=a(t.replace(U,"$1"));return i[b]?ct((function(t,e,r,n){for(var o,s=i(t,null,n,[]),a=t.length;a--;)(o=s[a])&&(t[a]=!(e[a]=o))})):function(t,n,o){return e[0]=t,i(e,null,o,r),e[0]=null,!r.pop()}})),has:ct((function(t){return function(e){return at(t,e).length>0}})),contains:ct((function(t){return t=t.replace(et,rt),function(e){return(e.textContent||n(e)).indexOf(t)>-1}})),lang:ct((function(t){return W.test(t||"")||at.error("unsupported lang: "+t),t=t.replace(et,rt).toLowerCase(),function(e){var r;do{if(r=m?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(r=r.toLowerCase())===t||0===r.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var r=t.location&&t.location.hash;return r&&r.slice(1)===e.id},root:function(t){return t===f},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:mt(!1),disabled:mt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!i.pseudos.empty(t)},header:function(t){return K.test(t.nodeName)},input:function(t){return Y.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:gt((function(){return[0]})),last:gt((function(t,e){return[e-1]})),eq:gt((function(t,e,r){return[r<0?r+e:r]})),even:gt((function(t,e){for(var r=0;r<e;r+=2)t.push(r);return t})),odd:gt((function(t,e){for(var r=1;r<e;r+=2)t.push(r);return t})),lt:gt((function(t,e,r){for(var i=r<0?r+e:r>e?e:r;--i>=0;)t.push(i);return t})),gt:gt((function(t,e,r){for(var i=r<0?r+e:r;++i<e;)t.push(i);return t}))}},i.pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=pt(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=ft(e);function vt(){}function _t(t){for(var e=0,r=t.length,i="";e<r;e++)i+=t[e].value;return i}function bt(t,e,r){var i=e.dir,n=e.next,o=n||i,s=r&&"parentNode"===o,a=T++;return e.first?function(e,r,n){for(;e=e[i];)if(1===e.nodeType||s)return t(e,r,n);return!1}:function(e,r,l){var c,u,h,d=[w,a];if(l){for(;e=e[i];)if((1===e.nodeType||s)&&t(e,r,l))return!0}else for(;e=e[i];)if(1===e.nodeType||s)if(u=(h=e[b]||(e[b]={}))[e.uniqueID]||(h[e.uniqueID]={}),n&&n===e.nodeName.toLowerCase())e=e[i]||e;else{if((c=u[o])&&c[0]===w&&c[1]===a)return d[2]=c[2];if(u[o]=d,d[2]=t(e,r,l))return!0}return!1}}function xt(t){return t.length>1?function(e,r,i){for(var n=t.length;n--;)if(!t[n](e,r,i))return!1;return!0}:t[0]}function wt(t,e,r,i,n){for(var o,s=[],a=0,l=t.length,c=null!=e;a<l;a++)(o=t[a])&&(r&&!r(o,i,n)||(s.push(o),c&&e.push(a)));return s}function Tt(t,e,r,i,n,o){return i&&!i[b]&&(i=Tt(i)),n&&!n[b]&&(n=Tt(n,o)),ct((function(o,s,a,l){var c,u,h,d=[],p=[],f=s.length,m=o||function(t,e,r){for(var i=0,n=e.length;i<n;i++)at(t,e[i],r);return r}(e||"*",a.nodeType?[a]:a,[]),g=!t||!o&&e?m:wt(m,d,t,a,l),y=r?n||(o?t:f||i)?[]:s:g;if(r&&r(g,y,a,l),i)for(c=wt(y,p),i(c,[],a,l),u=c.length;u--;)(h=c[u])&&(y[p[u]]=!(g[p[u]]=h));if(o){if(n||t){if(n){for(c=[],u=y.length;u--;)(h=y[u])&&c.push(g[u]=h);n(null,y=[],c,l)}for(u=y.length;u--;)(h=y[u])&&(c=n?R(o,h):d[u])>-1&&(o[c]=!(s[c]=h))}}else y=wt(y===s?y.splice(f,y.length):y),n?n(null,s,y,l):L.apply(s,y)}))}function Et(t){for(var e,r,n,o=t.length,s=i.relative[t[0].type],a=s||i.relative[" "],l=s?1:0,u=bt((function(t){return t===e}),a,!0),h=bt((function(t){return R(e,t)>-1}),a,!0),d=[function(t,r,i){var n=!s&&(i||r!==c)||((e=r).nodeType?u(t,r,i):h(t,r,i));return e=null,n}];l<o;l++)if(r=i.relative[t[l].type])d=[bt(xt(d),r)];else{if((r=i.filter[t[l].type].apply(null,t[l].matches))[b]){for(n=++l;n<o&&!i.relative[t[n].type];n++);return Tt(l>1&&xt(d),l>1&&_t(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(U,"$1"),r,l<n&&Et(t.slice(l,n)),n<o&&Et(t=t.slice(n)),n<o&&_t(t))}d.push(r)}return xt(d)}return vt.prototype=i.filters=i.pseudos,i.setFilters=new vt,s=at.tokenize=function(t,e){var r,n,o,s,a,l,c,u=S[t+" "];if(u)return e?0:u.slice(0);for(a=t,l=[],c=i.preFilter;a;){for(s in r&&!(n=$.exec(a))||(n&&(a=a.slice(n[0].length)||a),l.push(o=[])),r=!1,(n=G.exec(a))&&(r=n.shift(),o.push({value:r,type:n[0].replace(U," ")}),a=a.slice(r.length)),i.filter)!(n=Z[s].exec(a))||c[s]&&!(n=c[s](n))||(r=n.shift(),o.push({value:r,type:s,matches:n}),a=a.slice(r.length));if(!r)break}return e?a.length:a?at.error(t):S(t,l).slice(0)},a=at.compile=function(t,e){var r,n=[],o=[],a=P[t+" "];if(!a){for(e||(e=s(t)),r=e.length;r--;)(a=Et(e[r]))[b]?n.push(a):o.push(a);a=P(t,function(t,e){var r=e.length>0,n=t.length>0,o=function(o,s,a,l,u){var h,f,g,y=0,v="0",_=o&&[],b=[],x=c,T=o||n&&i.find.TAG("*",u),E=w+=null==x?1:Math.random()||.1,S=T.length;for(u&&(c=s==p||s||u);v!==S&&null!=(h=T[v]);v++){if(n&&h){for(f=0,s||h.ownerDocument==p||(d(h),a=!m);g=t[f++];)if(g(h,s||p,a)){l.push(h);break}u&&(w=E)}r&&((h=!g&&h)&&y--,o&&_.push(h))}if(y+=v,r&&v!==y){for(f=0;g=e[f++];)g(_,b,s,a);if(o){if(y>0)for(;v--;)_[v]||b[v]||(b[v]=I.call(l));b=wt(b)}L.apply(l,b),u&&!o&&b.length>0&&y+e.length>1&&at.uniqueSort(l)}return u&&(w=E,c=x),_};return r?ct(o):o}(o,n)),a.selector=t}return a},l=at.select=function(t,e,r,n){var o,l,c,u,h,d="function"==typeof t&&t,p=!n&&s(t=d.selector||t);if(r=r||[],1===p.length){if((l=p[0]=p[0].slice(0)).length>2&&"ID"===(c=l[0]).type&&9===e.nodeType&&m&&i.relative[l[1].type]){if(!(e=(i.find.ID(c.matches[0].replace(et,rt),e)||[])[0]))return r;d&&(e=e.parentNode),t=t.slice(l.shift().value.length)}for(o=Z.needsContext.test(t)?0:l.length;o--&&(c=l[o],!i.relative[u=c.type]);)if((h=i.find[u])&&(n=h(c.matches[0].replace(et,rt),tt.test(l[0].type)&&yt(e.parentNode)||e))){if(l.splice(o,1),!(t=n.length&&_t(l)))return L.apply(r,n),r;break}}return(d||a(t,p))(n,e,!m,r,!e||tt.test(t)&&yt(e.parentNode)||e),r},r.sortStable=b.split("").sort(A).join("")===b,r.detectDuplicates=!!h,d(),r.sortDetached=ut((function(t){return 1&t.compareDocumentPosition(p.createElement("fieldset"))})),ut((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||ht("type|href|height|width",(function(t,e,r){if(!r)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),r.attributes&&ut((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||ht("value",(function(t,e,r){if(!r&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),ut((function(t){return null==t.getAttribute("disabled")}))||ht(F,(function(t,e,r){var i;if(!r)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null})),at}(i);E.find=P,E.expr=P.selectors,E.expr[":"]=E.expr.pseudos,E.uniqueSort=E.unique=P.uniqueSort,E.text=P.getText,E.isXMLDoc=P.isXML,E.contains=P.contains,E.escapeSelector=P.escape;var k=function(t,e,r){for(var i=[],n=void 0!==r;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(n&&E(t).is(r))break;i.push(t)}return i},A=function(t,e){for(var r=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&r.push(t);return r},M=E.expr.match.needsContext;function C(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var I=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function O(t,e,r){return y(e)?E.grep(t,(function(t,i){return!!e.call(t,i,t)!==r})):e.nodeType?E.grep(t,(function(t){return t===e!==r})):"string"!=typeof e?E.grep(t,(function(t){return u.call(e,t)>-1!==r})):E.filter(e,t,r)}E.filter=function(t,e,r){var i=e[0];return r&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?E.find.matchesSelector(i,t)?[i]:[]:E.find.matches(t,E.grep(e,(function(t){return 1===t.nodeType})))},E.fn.extend({find:function(t){var e,r,i=this.length,n=this;if("string"!=typeof t)return this.pushStack(E(t).filter((function(){for(e=0;e<i;e++)if(E.contains(n[e],this))return!0})));for(r=this.pushStack([]),e=0;e<i;e++)E.find(t,n[e],r);return i>1?E.uniqueSort(r):r},filter:function(t){return this.pushStack(O(this,t||[],!1))},not:function(t){return this.pushStack(O(this,t||[],!0))},is:function(t){return!!O(this,"string"==typeof t&&M.test(t)?E(t):t||[],!1).length}});var L,D=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(E.fn.init=function(t,e,r){var i,n;if(!t)return this;if(r=r||L,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:D.exec(t))||!i[1]&&e)return!e||e.jquery?(e||r).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof E?e[0]:e,E.merge(this,E.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:_,!0)),I.test(i[1])&&E.isPlainObject(e))for(i in e)y(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(n=_.getElementById(i[2]))&&(this[0]=n,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):y(t)?void 0!==r.ready?r.ready(t):t(E):E.makeArray(t,this)}).prototype=E.fn,L=E(_);var R=/^(?:parents|prev(?:Until|All))/,F={children:!0,contents:!0,next:!0,prev:!0};function B(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}E.fn.extend({has:function(t){var e=E(t,this),r=e.length;return this.filter((function(){for(var t=0;t<r;t++)if(E.contains(this,e[t]))return!0}))},closest:function(t,e){var r,i=0,n=this.length,o=[],s="string"!=typeof t&&E(t);if(!M.test(t))for(;i<n;i++)for(r=this[i];r&&r!==e;r=r.parentNode)if(r.nodeType<11&&(s?s.index(r)>-1:1===r.nodeType&&E.find.matchesSelector(r,t))){o.push(r);break}return this.pushStack(o.length>1?E.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?u.call(E(t),this[0]):u.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(E.uniqueSort(E.merge(this.get(),E(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),E.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return k(t,"parentNode")},parentsUntil:function(t,e,r){return k(t,"parentNode",r)},next:function(t){return B(t,"nextSibling")},prev:function(t){return B(t,"previousSibling")},nextAll:function(t){return k(t,"nextSibling")},prevAll:function(t){return k(t,"previousSibling")},nextUntil:function(t,e,r){return k(t,"nextSibling",r)},prevUntil:function(t,e,r){return k(t,"previousSibling",r)},siblings:function(t){return A((t.parentNode||{}).firstChild,t)},children:function(t){return A(t.firstChild)},contents:function(t){return null!=t.contentDocument&&s(t.contentDocument)?t.contentDocument:(C(t,"template")&&(t=t.content||t),E.merge([],t.childNodes))}},(function(t,e){E.fn[t]=function(r,i){var n=E.map(this,e,r);return"Until"!==t.slice(-5)&&(i=r),i&&"string"==typeof i&&(n=E.filter(i,n)),this.length>1&&(F[t]||E.uniqueSort(n),R.test(t)&&n.reverse()),this.pushStack(n)}}));var z=/[^\x20\t\r\n\f]+/g;function j(t){return t}function N(t){throw t}function V(t,e,r,i){var n;try{t&&y(n=t.promise)?n.call(t).done(e).fail(r):t&&y(n=t.then)?n.call(t,e,r):e.apply(void 0,[t].slice(i))}catch(t){r.apply(void 0,[t])}}E.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return E.each(t.match(z)||[],(function(t,r){e[r]=!0})),e}(t):E.extend({},t);var e,r,i,n,o=[],s=[],a=-1,l=function(){for(n=n||t.once,i=e=!0;s.length;a=-1)for(r=s.shift();++a<o.length;)!1===o[a].apply(r[0],r[1])&&t.stopOnFalse&&(a=o.length,r=!1);t.memory||(r=!1),e=!1,n&&(o=r?[]:"")},c={add:function(){return o&&(r&&!e&&(a=o.length-1,s.push(r)),function e(r){E.each(r,(function(r,i){y(i)?t.unique&&c.has(i)||o.push(i):i&&i.length&&"string"!==w(i)&&e(i)}))}(arguments),r&&!e&&l()),this},remove:function(){return E.each(arguments,(function(t,e){for(var r;(r=E.inArray(e,o,r))>-1;)o.splice(r,1),r<=a&&a--})),this},has:function(t){return t?E.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return n=s=[],o=r="",this},disabled:function(){return!o},lock:function(){return n=s=[],r||e||(o=r=""),this},locked:function(){return!!n},fireWith:function(t,r){return n||(r=[t,(r=r||[]).slice?r.slice():r],s.push(r),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},E.extend({Deferred:function(t){var e=[["notify","progress",E.Callbacks("memory"),E.Callbacks("memory"),2],["resolve","done",E.Callbacks("once memory"),E.Callbacks("once memory"),0,"resolved"],["reject","fail",E.Callbacks("once memory"),E.Callbacks("once memory"),1,"rejected"]],r="pending",n={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},catch:function(t){return n.then(null,t)},pipe:function(){var t=arguments;return E.Deferred((function(r){E.each(e,(function(e,i){var n=y(t[i[4]])&&t[i[4]];o[i[1]]((function(){var t=n&&n.apply(this,arguments);t&&y(t.promise)?t.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[i[0]+"With"](this,n?[t]:arguments)}))})),t=null})).promise()},then:function(t,r,n){var o=0;function s(t,e,r,n){return function(){var a=this,l=arguments,c=function(){var i,c;if(!(t<o)){if((i=r.apply(a,l))===e.promise())throw new TypeError("Thenable self-resolution");c=i&&("object"==typeof i||"function"==typeof i)&&i.then,y(c)?n?c.call(i,s(o,e,j,n),s(o,e,N,n)):(o++,c.call(i,s(o,e,j,n),s(o,e,N,n),s(o,e,j,e.notifyWith))):(r!==j&&(a=void 0,l=[i]),(n||e.resolveWith)(a,l))}},u=n?c:function(){try{c()}catch(i){E.Deferred.exceptionHook&&E.Deferred.exceptionHook(i,u.stackTrace),t+1>=o&&(r!==N&&(a=void 0,l=[i]),e.rejectWith(a,l))}};t?u():(E.Deferred.getStackHook&&(u.stackTrace=E.Deferred.getStackHook()),i.setTimeout(u))}}return E.Deferred((function(i){e[0][3].add(s(0,i,y(n)?n:j,i.notifyWith)),e[1][3].add(s(0,i,y(t)?t:j)),e[2][3].add(s(0,i,y(r)?r:N))})).promise()},promise:function(t){return null!=t?E.extend(t,n):n}},o={};return E.each(e,(function(t,i){var s=i[2],a=i[5];n[i[1]]=s.add,a&&s.add((function(){r=a}),e[3-t][2].disable,e[3-t][3].disable,e[0][2].lock,e[0][3].lock),s.add(i[3].fire),o[i[0]]=function(){return o[i[0]+"With"](this===o?void 0:this,arguments),this},o[i[0]+"With"]=s.fireWith})),n.promise(o),t&&t.call(o,o),o},when:function(t){var e=arguments.length,r=e,i=Array(r),n=a.call(arguments),o=E.Deferred(),s=function(t){return function(r){i[t]=this,n[t]=arguments.length>1?a.call(arguments):r,--e||o.resolveWith(i,n)}};if(e<=1&&(V(t,o.done(s(r)).resolve,o.reject,!e),"pending"===o.state()||y(n[r]&&n[r].then)))return o.then();for(;r--;)V(n[r],s(r),o.reject);return o.promise()}});var U=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;E.Deferred.exceptionHook=function(t,e){i.console&&i.console.warn&&t&&U.test(t.name)&&i.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},E.readyException=function(t){i.setTimeout((function(){throw t}))};var $=E.Deferred();function G(){_.removeEventListener("DOMContentLoaded",G),i.removeEventListener("load",G),E.ready()}E.fn.ready=function(t){return $.then(t).catch((function(t){E.readyException(t)})),this},E.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--E.readyWait:E.isReady)||(E.isReady=!0,!0!==t&&--E.readyWait>0||$.resolveWith(_,[E]))}}),E.ready.then=$.then,"complete"===_.readyState||"loading"!==_.readyState&&!_.documentElement.doScroll?i.setTimeout(E.ready):(_.addEventListener("DOMContentLoaded",G),i.addEventListener("load",G));var H=function(t,e,r,i,n,o,s){var a=0,l=t.length,c=null==r;if("object"===w(r))for(a in n=!0,r)H(t,e,a,r[a],!0,o,s);else if(void 0!==i&&(n=!0,y(i)||(s=!0),c&&(s?(e.call(t,i),e=null):(c=e,e=function(t,e,r){return c.call(E(t),r)})),e))for(;a<l;a++)e(t[a],r,s?i:i.call(t[a],a,e(t[a],r)));return n?t:c?e.call(t):l?e(t[0],r):o},q=/^-ms-/,W=/-([a-z])/g;function Z(t,e){return e.toUpperCase()}function X(t){return t.replace(q,"ms-").replace(W,Z)}var Y=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function K(){this.expando=E.expando+K.uid++}K.uid=1,K.prototype={cache:function(t){var e=t[this.expando];return e||(e={},Y(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,r){var i,n=this.cache(t);if("string"==typeof e)n[X(e)]=r;else for(i in e)n[X(i)]=e[i];return n},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][X(e)]},access:function(t,e,r){return void 0===e||e&&"string"==typeof e&&void 0===r?this.get(t,e):(this.set(t,e,r),void 0!==r?r:e)},remove:function(t,e){var r,i=t[this.expando];if(void 0!==i){if(void 0!==e){r=(e=Array.isArray(e)?e.map(X):(e=X(e))in i?[e]:e.match(z)||[]).length;for(;r--;)delete i[e[r]]}(void 0===e||E.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!E.isEmptyObject(e)}};var J=new K,Q=new K,tt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,et=/[A-Z]/g;function rt(t,e,r){var i;if(void 0===r&&1===t.nodeType)if(i="data-"+e.replace(et,"-$&").toLowerCase(),"string"==typeof(r=t.getAttribute(i))){try{r=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:tt.test(t)?JSON.parse(t):t)}(r)}catch(t){}Q.set(t,e,r)}else r=void 0;return r}E.extend({hasData:function(t){return Q.hasData(t)||J.hasData(t)},data:function(t,e,r){return Q.access(t,e,r)},removeData:function(t,e){Q.remove(t,e)},_data:function(t,e,r){return J.access(t,e,r)},_removeData:function(t,e){J.remove(t,e)}}),E.fn.extend({data:function(t,e){var r,i,n,o=this[0],s=o&&o.attributes;if(void 0===t){if(this.length&&(n=Q.get(o),1===o.nodeType&&!J.get(o,"hasDataAttrs"))){for(r=s.length;r--;)s[r]&&0===(i=s[r].name).indexOf("data-")&&(i=X(i.slice(5)),rt(o,i,n[i]));J.set(o,"hasDataAttrs",!0)}return n}return"object"==typeof t?this.each((function(){Q.set(this,t)})):H(this,(function(e){var r;if(o&&void 0===e)return void 0!==(r=Q.get(o,t))||void 0!==(r=rt(o,t))?r:void 0;this.each((function(){Q.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){Q.remove(this,t)}))}}),E.extend({queue:function(t,e,r){var i;if(t)return e=(e||"fx")+"queue",i=J.get(t,e),r&&(!i||Array.isArray(r)?i=J.access(t,e,E.makeArray(r)):i.push(r)),i||[]},dequeue:function(t,e){e=e||"fx";var r=E.queue(t,e),i=r.length,n=r.shift(),o=E._queueHooks(t,e);"inprogress"===n&&(n=r.shift(),i--),n&&("fx"===e&&r.unshift("inprogress"),delete o.stop,n.call(t,(function(){E.dequeue(t,e)}),o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var r=e+"queueHooks";return J.get(t,r)||J.access(t,r,{empty:E.Callbacks("once memory").add((function(){J.remove(t,[e+"queue",r])}))})}}),E.fn.extend({queue:function(t,e){var r=2;return"string"!=typeof t&&(e=t,t="fx",r--),arguments.length<r?E.queue(this[0],t):void 0===e?this:this.each((function(){var r=E.queue(this,t,e);E._queueHooks(this,t),"fx"===t&&"inprogress"!==r[0]&&E.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){E.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var r,i=1,n=E.Deferred(),o=this,s=this.length,a=function(){--i||n.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(r=J.get(o[s],t+"queueHooks"))&&r.empty&&(i++,r.empty.add(a));return a(),n.promise(e)}});var it=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,nt=new RegExp("^(?:([+-])=|)("+it+")([a-z%]*)$","i"),ot=["Top","Right","Bottom","Left"],st=_.documentElement,at=function(t){return E.contains(t.ownerDocument,t)},lt={composed:!0};st.getRootNode&&(at=function(t){return E.contains(t.ownerDocument,t)||t.getRootNode(lt)===t.ownerDocument});var ct=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&at(t)&&"none"===E.css(t,"display")};function ut(t,e,r,i){var n,o,s=20,a=i?function(){return i.cur()}:function(){return E.css(t,e,"")},l=a(),c=r&&r[3]||(E.cssNumber[e]?"":"px"),u=t.nodeType&&(E.cssNumber[e]||"px"!==c&&+l)&&nt.exec(E.css(t,e));if(u&&u[3]!==c){for(l/=2,c=c||u[3],u=+l||1;s--;)E.style(t,e,u+c),(1-o)*(1-(o=a()/l||.5))<=0&&(s=0),u/=o;u*=2,E.style(t,e,u+c),r=r||[]}return r&&(u=+u||+l||0,n=r[1]?u+(r[1]+1)*r[2]:+r[2],i&&(i.unit=c,i.start=u,i.end=n)),n}var ht={};function dt(t){var e,r=t.ownerDocument,i=t.nodeName,n=ht[i];return n||(e=r.body.appendChild(r.createElement(i)),n=E.css(e,"display"),e.parentNode.removeChild(e),"none"===n&&(n="block"),ht[i]=n,n)}function pt(t,e){for(var r,i,n=[],o=0,s=t.length;o<s;o++)(i=t[o]).style&&(r=i.style.display,e?("none"===r&&(n[o]=J.get(i,"display")||null,n[o]||(i.style.display="")),""===i.style.display&&ct(i)&&(n[o]=dt(i))):"none"!==r&&(n[o]="none",J.set(i,"display",r)));for(o=0;o<s;o++)null!=n[o]&&(t[o].style.display=n[o]);return t}E.fn.extend({show:function(){return pt(this,!0)},hide:function(){return pt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){ct(this)?E(this).show():E(this).hide()}))}});var ft,mt,gt=/^(?:checkbox|radio)$/i,yt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,vt=/^$|^module$|\/(?:java|ecma)script/i;ft=_.createDocumentFragment().appendChild(_.createElement("div")),(mt=_.createElement("input")).setAttribute("type","radio"),mt.setAttribute("checked","checked"),mt.setAttribute("name","t"),ft.appendChild(mt),g.checkClone=ft.cloneNode(!0).cloneNode(!0).lastChild.checked,ft.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!ft.cloneNode(!0).lastChild.defaultValue,ft.innerHTML="<option></option>",g.option=!!ft.lastChild;var _t={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function bt(t,e){var r;return r=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&C(t,e)?E.merge([t],r):r}function xt(t,e){for(var r=0,i=t.length;r<i;r++)J.set(t[r],"globalEval",!e||J.get(e[r],"globalEval"))}_t.tbody=_t.tfoot=_t.colgroup=_t.caption=_t.thead,_t.th=_t.td,g.option||(_t.optgroup=_t.option=[1,"<select multiple='multiple'>","</select>"]);var wt=/<|&#?\w+;/;function Tt(t,e,r,i,n){for(var o,s,a,l,c,u,h=e.createDocumentFragment(),d=[],p=0,f=t.length;p<f;p++)if((o=t[p])||0===o)if("object"===w(o))E.merge(d,o.nodeType?[o]:o);else if(wt.test(o)){for(s=s||h.appendChild(e.createElement("div")),a=(yt.exec(o)||["",""])[1].toLowerCase(),l=_t[a]||_t._default,s.innerHTML=l[1]+E.htmlPrefilter(o)+l[2],u=l[0];u--;)s=s.lastChild;E.merge(d,s.childNodes),(s=h.firstChild).textContent=""}else d.push(e.createTextNode(o));for(h.textContent="",p=0;o=d[p++];)if(i&&E.inArray(o,i)>-1)n&&n.push(o);else if(c=at(o),s=bt(h.appendChild(o),"script"),c&&xt(s),r)for(u=0;o=s[u++];)vt.test(o.type||"")&&r.push(o);return h}var Et=/^([^.]*)(?:\.(.+)|)/;function St(){return!0}function Pt(){return!1}function kt(t,e){return t===function(){try{return _.activeElement}catch(t){}}()==("focus"===e)}function At(t,e,r,i,n,o){var s,a;if("object"==typeof e){for(a in"string"!=typeof r&&(i=i||r,r=void 0),e)At(t,a,r,i,e[a],o);return t}if(null==i&&null==n?(n=r,i=r=void 0):null==n&&("string"==typeof r?(n=i,i=void 0):(n=i,i=r,r=void 0)),!1===n)n=Pt;else if(!n)return t;return 1===o&&(s=n,n=function(t){return E().off(t),s.apply(this,arguments)},n.guid=s.guid||(s.guid=E.guid++)),t.each((function(){E.event.add(this,e,n,i,r)}))}function Mt(t,e,r){r?(J.set(t,e,!1),E.event.add(t,e,{namespace:!1,handler:function(t){var i,n,o=J.get(this,e);if(1&t.isTrigger&&this[e]){if(o.length)(E.event.special[e]||{}).delegateType&&t.stopPropagation();else if(o=a.call(arguments),J.set(this,e,o),i=r(this,e),this[e](),o!==(n=J.get(this,e))||i?J.set(this,e,!1):n={},o!==n)return t.stopImmediatePropagation(),t.preventDefault(),n&&n.value}else o.length&&(J.set(this,e,{value:E.event.trigger(E.extend(o[0],E.Event.prototype),o.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===J.get(t,e)&&E.event.add(t,e,St)}E.event={global:{},add:function(t,e,r,i,n){var o,s,a,l,c,u,h,d,p,f,m,g=J.get(t);if(Y(t))for(r.handler&&(r=(o=r).handler,n=o.selector),n&&E.find.matchesSelector(st,n),r.guid||(r.guid=E.guid++),(l=g.events)||(l=g.events=Object.create(null)),(s=g.handle)||(s=g.handle=function(e){return void 0!==E&&E.event.triggered!==e.type?E.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(z)||[""]).length;c--;)p=m=(a=Et.exec(e[c])||[])[1],f=(a[2]||"").split(".").sort(),p&&(h=E.event.special[p]||{},p=(n?h.delegateType:h.bindType)||p,h=E.event.special[p]||{},u=E.extend({type:p,origType:m,data:i,handler:r,guid:r.guid,selector:n,needsContext:n&&E.expr.match.needsContext.test(n),namespace:f.join(".")},o),(d=l[p])||((d=l[p]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,i,f,s)||t.addEventListener&&t.addEventListener(p,s)),h.add&&(h.add.call(t,u),u.handler.guid||(u.handler.guid=r.guid)),n?d.splice(d.delegateCount++,0,u):d.push(u),E.event.global[p]=!0)},remove:function(t,e,r,i,n){var o,s,a,l,c,u,h,d,p,f,m,g=J.hasData(t)&&J.get(t);if(g&&(l=g.events)){for(c=(e=(e||"").match(z)||[""]).length;c--;)if(p=m=(a=Et.exec(e[c])||[])[1],f=(a[2]||"").split(".").sort(),p){for(h=E.event.special[p]||{},d=l[p=(i?h.delegateType:h.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=d.length;o--;)u=d[o],!n&&m!==u.origType||r&&r.guid!==u.guid||a&&!a.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(d.splice(o,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(t,u));s&&!d.length&&(h.teardown&&!1!==h.teardown.call(t,f,g.handle)||E.removeEvent(t,p,g.handle),delete l[p])}else for(p in l)E.event.remove(t,p+e[c],r,i,!0);E.isEmptyObject(l)&&J.remove(t,"handle events")}},dispatch:function(t){var e,r,i,n,o,s,a=new Array(arguments.length),l=E.event.fix(t),c=(J.get(this,"events")||Object.create(null))[l.type]||[],u=E.event.special[l.type]||{};for(a[0]=l,e=1;e<arguments.length;e++)a[e]=arguments[e];if(l.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,l)){for(s=E.event.handlers.call(this,l,c),e=0;(n=s[e++])&&!l.isPropagationStopped();)for(l.currentTarget=n.elem,r=0;(o=n.handlers[r++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==o.namespace&&!l.rnamespace.test(o.namespace)||(l.handleObj=o,l.data=o.data,void 0!==(i=((E.event.special[o.origType]||{}).handle||o.handler).apply(n.elem,a))&&!1===(l.result=i)&&(l.preventDefault(),l.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,l),l.result}},handlers:function(t,e){var r,i,n,o,s,a=[],l=e.delegateCount,c=t.target;if(l&&c.nodeType&&!("click"===t.type&&t.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(o=[],s={},r=0;r<l;r++)void 0===s[n=(i=e[r]).selector+" "]&&(s[n]=i.needsContext?E(n,this).index(c)>-1:E.find(n,this,null,[c]).length),s[n]&&o.push(i);o.length&&a.push({elem:c,handlers:o})}return c=this,l<e.length&&a.push({elem:c,handlers:e.slice(l)}),a},addProp:function(t,e){Object.defineProperty(E.Event.prototype,t,{enumerable:!0,configurable:!0,get:y(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[E.expando]?t:new E.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return gt.test(e.type)&&e.click&&C(e,"input")&&Mt(e,"click",St),!1},trigger:function(t){var e=this||t;return gt.test(e.type)&&e.click&&C(e,"input")&&Mt(e,"click"),!0},_default:function(t){var e=t.target;return gt.test(e.type)&&e.click&&C(e,"input")&&J.get(e,"click")||C(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},E.removeEvent=function(t,e,r){t.removeEventListener&&t.removeEventListener(e,r)},E.Event=function(t,e){if(!(this instanceof E.Event))return new E.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?St:Pt,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&E.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[E.expando]=!0},E.Event.prototype={constructor:E.Event,isDefaultPrevented:Pt,isPropagationStopped:Pt,isImmediatePropagationStopped:Pt,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=St,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=St,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=St,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},E.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},E.event.addProp),E.each({focus:"focusin",blur:"focusout"},(function(t,e){E.event.special[t]={setup:function(){return Mt(this,t,kt),!1},trigger:function(){return Mt(this,t),!0},_default:function(){return!0},delegateType:e}})),E.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){E.event.special[t]={delegateType:e,bindType:e,handle:function(t){var r,i=this,n=t.relatedTarget,o=t.handleObj;return n&&(n===i||E.contains(i,n))||(t.type=o.origType,r=o.handler.apply(this,arguments),t.type=e),r}}})),E.fn.extend({on:function(t,e,r,i){return At(this,t,e,r,i)},one:function(t,e,r,i){return At(this,t,e,r,i,1)},off:function(t,e,r){var i,n;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,E(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(n in t)this.off(n,e,t[n]);return this}return!1!==e&&"function"!=typeof e||(r=e,e=void 0),!1===r&&(r=Pt),this.each((function(){E.event.remove(this,t,r,e)}))}});var Ct=/<script|<style|<link/i,It=/checked\s*(?:[^=]|=\s*.checked.)/i,Ot=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Lt(t,e){return C(t,"table")&&C(11!==e.nodeType?e:e.firstChild,"tr")&&E(t).children("tbody")[0]||t}function Dt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Rt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Ft(t,e){var r,i,n,o,s,a;if(1===e.nodeType){if(J.hasData(t)&&(a=J.get(t).events))for(n in J.remove(e,"handle events"),a)for(r=0,i=a[n].length;r<i;r++)E.event.add(e,n,a[n][r]);Q.hasData(t)&&(o=Q.access(t),s=E.extend({},o),Q.set(e,s))}}function Bt(t,e){var r=e.nodeName.toLowerCase();"input"===r&&gt.test(t.type)?e.checked=t.checked:"input"!==r&&"textarea"!==r||(e.defaultValue=t.defaultValue)}function zt(t,e,r,i){e=l(e);var n,o,s,a,c,u,h=0,d=t.length,p=d-1,f=e[0],m=y(f);if(m||d>1&&"string"==typeof f&&!g.checkClone&&It.test(f))return t.each((function(n){var o=t.eq(n);m&&(e[0]=f.call(this,n,o.html())),zt(o,e,r,i)}));if(d&&(o=(n=Tt(e,t[0].ownerDocument,!1,t,i)).firstChild,1===n.childNodes.length&&(n=o),o||i)){for(a=(s=E.map(bt(n,"script"),Dt)).length;h<d;h++)c=n,h!==p&&(c=E.clone(c,!0,!0),a&&E.merge(s,bt(c,"script"))),r.call(t[h],c,h);if(a)for(u=s[s.length-1].ownerDocument,E.map(s,Rt),h=0;h<a;h++)c=s[h],vt.test(c.type||"")&&!J.access(c,"globalEval")&&E.contains(u,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?E._evalUrl&&!c.noModule&&E._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},u):x(c.textContent.replace(Ot,""),c,u))}return t}function jt(t,e,r){for(var i,n=e?E.filter(e,t):t,o=0;null!=(i=n[o]);o++)r||1!==i.nodeType||E.cleanData(bt(i)),i.parentNode&&(r&&at(i)&&xt(bt(i,"script")),i.parentNode.removeChild(i));return t}E.extend({htmlPrefilter:function(t){return t},clone:function(t,e,r){var i,n,o,s,a=t.cloneNode(!0),l=at(t);if(!(g.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||E.isXMLDoc(t)))for(s=bt(a),i=0,n=(o=bt(t)).length;i<n;i++)Bt(o[i],s[i]);if(e)if(r)for(o=o||bt(t),s=s||bt(a),i=0,n=o.length;i<n;i++)Ft(o[i],s[i]);else Ft(t,a);return(s=bt(a,"script")).length>0&&xt(s,!l&&bt(t,"script")),a},cleanData:function(t){for(var e,r,i,n=E.event.special,o=0;void 0!==(r=t[o]);o++)if(Y(r)){if(e=r[J.expando]){if(e.events)for(i in e.events)n[i]?E.event.remove(r,i):E.removeEvent(r,i,e.handle);r[J.expando]=void 0}r[Q.expando]&&(r[Q.expando]=void 0)}}}),E.fn.extend({detach:function(t){return jt(this,t,!0)},remove:function(t){return jt(this,t)},text:function(t){return H(this,(function(t){return void 0===t?E.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return zt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Lt(this,t).appendChild(t)}))},prepend:function(){return zt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Lt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return zt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return zt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(E.cleanData(bt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return E.clone(this,t,e)}))},html:function(t){return H(this,(function(t){var e=this[0]||{},r=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Ct.test(t)&&!_t[(yt.exec(t)||["",""])[1].toLowerCase()]){t=E.htmlPrefilter(t);try{for(;r<i;r++)1===(e=this[r]||{}).nodeType&&(E.cleanData(bt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return zt(this,arguments,(function(e){var r=this.parentNode;E.inArray(this,t)<0&&(E.cleanData(bt(this)),r&&r.replaceChild(e,this))}),t)}}),E.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){E.fn[t]=function(t){for(var r,i=[],n=E(t),o=n.length-1,s=0;s<=o;s++)r=s===o?this:this.clone(!0),E(n[s])[e](r),c.apply(i,r.get());return this.pushStack(i)}}));var Nt=new RegExp("^("+it+")(?!px)[a-z%]+$","i"),Vt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=i),e.getComputedStyle(t)},Ut=function(t,e,r){var i,n,o={};for(n in e)o[n]=t.style[n],t.style[n]=e[n];for(n in i=r.call(t),e)t.style[n]=o[n];return i},$t=new RegExp(ot.join("|"),"i");function Gt(t,e,r){var i,n,o,s,a=t.style;return(r=r||Vt(t))&&(""!==(s=r.getPropertyValue(e)||r[e])||at(t)||(s=E.style(t,e)),!g.pixelBoxStyles()&&Nt.test(s)&&$t.test(e)&&(i=a.width,n=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=r.width,a.width=i,a.minWidth=n,a.maxWidth=o)),void 0!==s?s+"":s}function Ht(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function t(){if(u){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",st.appendChild(c).appendChild(u);var t=i.getComputedStyle(u);r="1%"!==t.top,l=12===e(t.marginLeft),u.style.right="60%",s=36===e(t.right),n=36===e(t.width),u.style.position="absolute",o=12===e(u.offsetWidth/3),st.removeChild(c),u=null}}function e(t){return Math.round(parseFloat(t))}var r,n,o,s,a,l,c=_.createElement("div"),u=_.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===u.style.backgroundClip,E.extend(g,{boxSizingReliable:function(){return t(),n},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),r},reliableMarginLeft:function(){return t(),l},scrollboxSize:function(){return t(),o},reliableTrDimensions:function(){var t,e,r,n;return null==a&&(t=_.createElement("table"),e=_.createElement("tr"),r=_.createElement("div"),t.style.cssText="position:absolute;left:-11111px;border-collapse:separate",e.style.cssText="border:1px solid",e.style.height="1px",r.style.height="9px",r.style.display="block",st.appendChild(t).appendChild(e).appendChild(r),n=i.getComputedStyle(e),a=parseInt(n.height,10)+parseInt(n.borderTopWidth,10)+parseInt(n.borderBottomWidth,10)===e.offsetHeight,st.removeChild(t)),a}}))}();var qt=["Webkit","Moz","ms"],Wt=_.createElement("div").style,Zt={};function Xt(t){var e=E.cssProps[t]||Zt[t];return e||(t in Wt?t:Zt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),r=qt.length;r--;)if((t=qt[r]+e)in Wt)return t}(t)||t)}var Yt=/^(none|table(?!-c[ea]).+)/,Kt=/^--/,Jt={position:"absolute",visibility:"hidden",display:"block"},Qt={letterSpacing:"0",fontWeight:"400"};function te(t,e,r){var i=nt.exec(e);return i?Math.max(0,i[2]-(r||0))+(i[3]||"px"):e}function ee(t,e,r,i,n,o){var s="width"===e?1:0,a=0,l=0;if(r===(i?"border":"content"))return 0;for(;s<4;s+=2)"margin"===r&&(l+=E.css(t,r+ot[s],!0,n)),i?("content"===r&&(l-=E.css(t,"padding"+ot[s],!0,n)),"margin"!==r&&(l-=E.css(t,"border"+ot[s]+"Width",!0,n))):(l+=E.css(t,"padding"+ot[s],!0,n),"padding"!==r?l+=E.css(t,"border"+ot[s]+"Width",!0,n):a+=E.css(t,"border"+ot[s]+"Width",!0,n));return!i&&o>=0&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-o-l-a-.5))||0),l}function re(t,e,r){var i=Vt(t),n=(!g.boxSizingReliable()||r)&&"border-box"===E.css(t,"boxSizing",!1,i),o=n,s=Gt(t,e,i),a="offset"+e[0].toUpperCase()+e.slice(1);if(Nt.test(s)){if(!r)return s;s="auto"}return(!g.boxSizingReliable()&&n||!g.reliableTrDimensions()&&C(t,"tr")||"auto"===s||!parseFloat(s)&&"inline"===E.css(t,"display",!1,i))&&t.getClientRects().length&&(n="border-box"===E.css(t,"boxSizing",!1,i),(o=a in t)&&(s=t[a])),(s=parseFloat(s)||0)+ee(t,e,r||(n?"border":"content"),o,i,s)+"px"}function ie(t,e,r,i,n){return new ie.prototype.init(t,e,r,i,n)}E.extend({cssHooks:{opacity:{get:function(t,e){if(e){var r=Gt(t,"opacity");return""===r?"1":r}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,r,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var n,o,s,a=X(e),l=Kt.test(e),c=t.style;if(l||(e=Xt(a)),s=E.cssHooks[e]||E.cssHooks[a],void 0===r)return s&&"get"in s&&void 0!==(n=s.get(t,!1,i))?n:c[e];"string"===(o=typeof r)&&(n=nt.exec(r))&&n[1]&&(r=ut(t,e,n),o="number"),null!=r&&r==r&&("number"!==o||l||(r+=n&&n[3]||(E.cssNumber[a]?"":"px")),g.clearCloneStyle||""!==r||0!==e.indexOf("background")||(c[e]="inherit"),s&&"set"in s&&void 0===(r=s.set(t,r,i))||(l?c.setProperty(e,r):c[e]=r))}},css:function(t,e,r,i){var n,o,s,a=X(e);return Kt.test(e)||(e=Xt(a)),(s=E.cssHooks[e]||E.cssHooks[a])&&"get"in s&&(n=s.get(t,!0,r)),void 0===n&&(n=Gt(t,e,i)),"normal"===n&&e in Qt&&(n=Qt[e]),""===r||r?(o=parseFloat(n),!0===r||isFinite(o)?o||0:n):n}}),E.each(["height","width"],(function(t,e){E.cssHooks[e]={get:function(t,r,i){if(r)return!Yt.test(E.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?re(t,e,i):Ut(t,Jt,(function(){return re(t,e,i)}))},set:function(t,r,i){var n,o=Vt(t),s=!g.scrollboxSize()&&"absolute"===o.position,a=(s||i)&&"border-box"===E.css(t,"boxSizing",!1,o),l=i?ee(t,e,i,a,o):0;return a&&s&&(l-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(o[e])-ee(t,e,"border",!1,o)-.5)),l&&(n=nt.exec(r))&&"px"!==(n[3]||"px")&&(t.style[e]=r,r=E.css(t,e)),te(0,r,l)}}})),E.cssHooks.marginLeft=Ht(g.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Gt(t,"marginLeft"))||t.getBoundingClientRect().left-Ut(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),E.each({margin:"",padding:"",border:"Width"},(function(t,e){E.cssHooks[t+e]={expand:function(r){for(var i=0,n={},o="string"==typeof r?r.split(" "):[r];i<4;i++)n[t+ot[i]+e]=o[i]||o[i-2]||o[0];return n}},"margin"!==t&&(E.cssHooks[t+e].set=te)})),E.fn.extend({css:function(t,e){return H(this,(function(t,e,r){var i,n,o={},s=0;if(Array.isArray(e)){for(i=Vt(t),n=e.length;s<n;s++)o[e[s]]=E.css(t,e[s],!1,i);return o}return void 0!==r?E.style(t,e,r):E.css(t,e)}),t,e,arguments.length>1)}}),E.Tween=ie,ie.prototype={constructor:ie,init:function(t,e,r,i,n,o){this.elem=t,this.prop=r,this.easing=n||E.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(E.cssNumber[r]?"":"px")},cur:function(){var t=ie.propHooks[this.prop];return t&&t.get?t.get(this):ie.propHooks._default.get(this)},run:function(t){var e,r=ie.propHooks[this.prop];return this.options.duration?this.pos=e=E.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),r&&r.set?r.set(this):ie.propHooks._default.set(this),this}},ie.prototype.init.prototype=ie.prototype,ie.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=E.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){E.fx.step[t.prop]?E.fx.step[t.prop](t):1!==t.elem.nodeType||!E.cssHooks[t.prop]&&null==t.elem.style[Xt(t.prop)]?t.elem[t.prop]=t.now:E.style(t.elem,t.prop,t.now+t.unit)}}},ie.propHooks.scrollTop=ie.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},E.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},E.fx=ie.prototype.init,E.fx.step={};var ne,oe,se=/^(?:toggle|show|hide)$/,ae=/queueHooks$/;function le(){oe&&(!1===_.hidden&&i.requestAnimationFrame?i.requestAnimationFrame(le):i.setTimeout(le,E.fx.interval),E.fx.tick())}function ce(){return i.setTimeout((function(){ne=void 0})),ne=Date.now()}function ue(t,e){var r,i=0,n={height:t};for(e=e?1:0;i<4;i+=2-e)n["margin"+(r=ot[i])]=n["padding"+r]=t;return e&&(n.opacity=n.width=t),n}function he(t,e,r){for(var i,n=(de.tweeners[e]||[]).concat(de.tweeners["*"]),o=0,s=n.length;o<s;o++)if(i=n[o].call(r,e,t))return i}function de(t,e,r){var i,n,o=0,s=de.prefilters.length,a=E.Deferred().always((function(){delete l.elem})),l=function(){if(n)return!1;for(var e=ne||ce(),r=Math.max(0,c.startTime+c.duration-e),i=1-(r/c.duration||0),o=0,s=c.tweens.length;o<s;o++)c.tweens[o].run(i);return a.notifyWith(t,[c,i,r]),i<1&&s?r:(s||a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:E.extend({},e),opts:E.extend(!0,{specialEasing:{},easing:E.easing._default},r),originalProperties:e,originalOptions:r,startTime:ne||ce(),duration:r.duration,tweens:[],createTween:function(e,r){var i=E.Tween(t,c.opts,e,r,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(i),i},stop:function(e){var r=0,i=e?c.tweens.length:0;if(n)return this;for(n=!0;r<i;r++)c.tweens[r].run(1);return e?(a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c,e])):a.rejectWith(t,[c,e]),this}}),u=c.props;for(!function(t,e){var r,i,n,o,s;for(r in t)if(n=e[i=X(r)],o=t[r],Array.isArray(o)&&(n=o[1],o=t[r]=o[0]),r!==i&&(t[i]=o,delete t[r]),(s=E.cssHooks[i])&&"expand"in s)for(r in o=s.expand(o),delete t[i],o)r in t||(t[r]=o[r],e[r]=n);else e[i]=n}(u,c.opts.specialEasing);o<s;o++)if(i=de.prefilters[o].call(c,t,u,c.opts))return y(i.stop)&&(E._queueHooks(c.elem,c.opts.queue).stop=i.stop.bind(i)),i;return E.map(u,he,c),y(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),E.fx.timer(E.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c}E.Animation=E.extend(de,{tweeners:{"*":[function(t,e){var r=this.createTween(t,e);return ut(r.elem,t,nt.exec(e),r),r}]},tweener:function(t,e){y(t)?(e=t,t=["*"]):t=t.match(z);for(var r,i=0,n=t.length;i<n;i++)r=t[i],de.tweeners[r]=de.tweeners[r]||[],de.tweeners[r].unshift(e)},prefilters:[function(t,e,r){var i,n,o,s,a,l,c,u,h="width"in e||"height"in e,d=this,p={},f=t.style,m=t.nodeType&&ct(t),g=J.get(t,"fxshow");for(i in r.queue||(null==(s=E._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always((function(){d.always((function(){s.unqueued--,E.queue(t,"fx").length||s.empty.fire()}))}))),e)if(n=e[i],se.test(n)){if(delete e[i],o=o||"toggle"===n,n===(m?"hide":"show")){if("show"!==n||!g||void 0===g[i])continue;m=!0}p[i]=g&&g[i]||E.style(t,i)}if((l=!E.isEmptyObject(e))||!E.isEmptyObject(p))for(i in h&&1===t.nodeType&&(r.overflow=[f.overflow,f.overflowX,f.overflowY],null==(c=g&&g.display)&&(c=J.get(t,"display")),"none"===(u=E.css(t,"display"))&&(c?u=c:(pt([t],!0),c=t.style.display||c,u=E.css(t,"display"),pt([t]))),("inline"===u||"inline-block"===u&&null!=c)&&"none"===E.css(t,"float")&&(l||(d.done((function(){f.display=c})),null==c&&(u=f.display,c="none"===u?"":u)),f.display="inline-block")),r.overflow&&(f.overflow="hidden",d.always((function(){f.overflow=r.overflow[0],f.overflowX=r.overflow[1],f.overflowY=r.overflow[2]}))),l=!1,p)l||(g?"hidden"in g&&(m=g.hidden):g=J.access(t,"fxshow",{display:c}),o&&(g.hidden=!m),m&&pt([t],!0),d.done((function(){for(i in m||pt([t]),J.remove(t,"fxshow"),p)E.style(t,i,p[i])}))),l=he(m?g[i]:0,i,d),i in g||(g[i]=l.start,m&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?de.prefilters.unshift(t):de.prefilters.push(t)}}),E.speed=function(t,e,r){var i=t&&"object"==typeof t?E.extend({},t):{complete:r||!r&&e||y(t)&&t,duration:t,easing:r&&e||e&&!y(e)&&e};return E.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in E.fx.speeds?i.duration=E.fx.speeds[i.duration]:i.duration=E.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){y(i.old)&&i.old.call(this),i.queue&&E.dequeue(this,i.queue)},i},E.fn.extend({fadeTo:function(t,e,r,i){return this.filter(ct).css("opacity",0).show().end().animate({opacity:e},t,r,i)},animate:function(t,e,r,i){var n=E.isEmptyObject(t),o=E.speed(e,r,i),s=function(){var e=de(this,E.extend({},t),o);(n||J.get(this,"finish"))&&e.stop(!0)};return s.finish=s,n||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(t,e,r){var i=function(t){var e=t.stop;delete t.stop,e(r)};return"string"!=typeof t&&(r=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each((function(){var e=!0,n=null!=t&&t+"queueHooks",o=E.timers,s=J.get(this);if(n)s[n]&&s[n].stop&&i(s[n]);else for(n in s)s[n]&&s[n].stop&&ae.test(n)&&i(s[n]);for(n=o.length;n--;)o[n].elem!==this||null!=t&&o[n].queue!==t||(o[n].anim.stop(r),e=!1,o.splice(n,1));!e&&r||E.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,r=J.get(this),i=r[t+"queue"],n=r[t+"queueHooks"],o=E.timers,s=i?i.length:0;for(r.finish=!0,E.queue(this,t,[]),n&&n.stop&&n.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<s;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete r.finish}))}}),E.each(["toggle","show","hide"],(function(t,e){var r=E.fn[e];E.fn[e]=function(t,i,n){return null==t||"boolean"==typeof t?r.apply(this,arguments):this.animate(ue(e,!0),t,i,n)}})),E.each({slideDown:ue("show"),slideUp:ue("hide"),slideToggle:ue("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){E.fn[t]=function(t,r,i){return this.animate(e,t,r,i)}})),E.timers=[],E.fx.tick=function(){var t,e=0,r=E.timers;for(ne=Date.now();e<r.length;e++)(t=r[e])()||r[e]!==t||r.splice(e--,1);r.length||E.fx.stop(),ne=void 0},E.fx.timer=function(t){E.timers.push(t),E.fx.start()},E.fx.interval=13,E.fx.start=function(){oe||(oe=!0,le())},E.fx.stop=function(){oe=null},E.fx.speeds={slow:600,fast:200,_default:400},E.fn.delay=function(t,e){return t=E.fx&&E.fx.speeds[t]||t,e=e||"fx",this.queue(e,(function(e,r){var n=i.setTimeout(e,t);r.stop=function(){i.clearTimeout(n)}}))},function(){var t=_.createElement("input"),e=_.createElement("select").appendChild(_.createElement("option"));t.type="checkbox",g.checkOn=""!==t.value,g.optSelected=e.selected,(t=_.createElement("input")).value="t",t.type="radio",g.radioValue="t"===t.value}();var pe,fe=E.expr.attrHandle;E.fn.extend({attr:function(t,e){return H(this,E.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){E.removeAttr(this,t)}))}}),E.extend({attr:function(t,e,r){var i,n,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?E.prop(t,e,r):(1===o&&E.isXMLDoc(t)||(n=E.attrHooks[e.toLowerCase()]||(E.expr.match.bool.test(e)?pe:void 0)),void 0!==r?null===r?void E.removeAttr(t,e):n&&"set"in n&&void 0!==(i=n.set(t,r,e))?i:(t.setAttribute(e,r+""),r):n&&"get"in n&&null!==(i=n.get(t,e))?i:null==(i=E.find.attr(t,e))?void 0:i)},attrHooks:{type:{set:function(t,e){if(!g.radioValue&&"radio"===e&&C(t,"input")){var r=t.value;return t.setAttribute("type",e),r&&(t.value=r),e}}}},removeAttr:function(t,e){var r,i=0,n=e&&e.match(z);if(n&&1===t.nodeType)for(;r=n[i++];)t.removeAttribute(r)}}),pe={set:function(t,e,r){return!1===e?E.removeAttr(t,r):t.setAttribute(r,r),r}},E.each(E.expr.match.bool.source.match(/\w+/g),(function(t,e){var r=fe[e]||E.find.attr;fe[e]=function(t,e,i){var n,o,s=e.toLowerCase();return i||(o=fe[s],fe[s]=n,n=null!=r(t,e,i)?s:null,fe[s]=o),n}}));var me=/^(?:input|select|textarea|button)$/i,ge=/^(?:a|area)$/i;function ye(t){return(t.match(z)||[]).join(" ")}function ve(t){return t.getAttribute&&t.getAttribute("class")||""}function _e(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(z)||[]}E.fn.extend({prop:function(t,e){return H(this,E.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[E.propFix[t]||t]}))}}),E.extend({prop:function(t,e,r){var i,n,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&E.isXMLDoc(t)||(e=E.propFix[e]||e,n=E.propHooks[e]),void 0!==r?n&&"set"in n&&void 0!==(i=n.set(t,r,e))?i:t[e]=r:n&&"get"in n&&null!==(i=n.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=E.find.attr(t,"tabindex");return e?parseInt(e,10):me.test(t.nodeName)||ge.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(E.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),E.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){E.propFix[this.toLowerCase()]=this})),E.fn.extend({addClass:function(t){var e,r,i,n,o,s,a,l=0;if(y(t))return this.each((function(e){E(this).addClass(t.call(this,e,ve(this)))}));if((e=_e(t)).length)for(;r=this[l++];)if(n=ve(r),i=1===r.nodeType&&" "+ye(n)+" "){for(s=0;o=e[s++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");n!==(a=ye(i))&&r.setAttribute("class",a)}return this},removeClass:function(t){var e,r,i,n,o,s,a,l=0;if(y(t))return this.each((function(e){E(this).removeClass(t.call(this,e,ve(this)))}));if(!arguments.length)return this.attr("class","");if((e=_e(t)).length)for(;r=this[l++];)if(n=ve(r),i=1===r.nodeType&&" "+ye(n)+" "){for(s=0;o=e[s++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");n!==(a=ye(i))&&r.setAttribute("class",a)}return this},toggleClass:function(t,e){var r=typeof t,i="string"===r||Array.isArray(t);return"boolean"==typeof e&&i?e?this.addClass(t):this.removeClass(t):y(t)?this.each((function(r){E(this).toggleClass(t.call(this,r,ve(this),e),e)})):this.each((function(){var e,n,o,s;if(i)for(n=0,o=E(this),s=_e(t);e=s[n++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else void 0!==t&&"boolean"!==r||((e=ve(this))&&J.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":J.get(this,"__className__")||""))}))},hasClass:function(t){var e,r,i=0;for(e=" "+t+" ";r=this[i++];)if(1===r.nodeType&&(" "+ye(ve(r))+" ").indexOf(e)>-1)return!0;return!1}});var be=/\r/g;E.fn.extend({val:function(t){var e,r,i,n=this[0];return arguments.length?(i=y(t),this.each((function(r){var n;1===this.nodeType&&(null==(n=i?t.call(this,r,E(this).val()):t)?n="":"number"==typeof n?n+="":Array.isArray(n)&&(n=E.map(n,(function(t){return null==t?"":t+""}))),(e=E.valHooks[this.type]||E.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,n,"value")||(this.value=n))}))):n?(e=E.valHooks[n.type]||E.valHooks[n.nodeName.toLowerCase()])&&"get"in e&&void 0!==(r=e.get(n,"value"))?r:"string"==typeof(r=n.value)?r.replace(be,""):null==r?"":r:void 0}}),E.extend({valHooks:{option:{get:function(t){var e=E.find.attr(t,"value");return null!=e?e:ye(E.text(t))}},select:{get:function(t){var e,r,i,n=t.options,o=t.selectedIndex,s="select-one"===t.type,a=s?null:[],l=s?o+1:n.length;for(i=o<0?l:s?o:0;i<l;i++)if(((r=n[i]).selected||i===o)&&!r.disabled&&(!r.parentNode.disabled||!C(r.parentNode,"optgroup"))){if(e=E(r).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var r,i,n=t.options,o=E.makeArray(e),s=n.length;s--;)((i=n[s]).selected=E.inArray(E.valHooks.option.get(i),o)>-1)&&(r=!0);return r||(t.selectedIndex=-1),o}}}}),E.each(["radio","checkbox"],(function(){E.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=E.inArray(E(t).val(),e)>-1}},g.checkOn||(E.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),g.focusin="onfocusin"in i;var xe=/^(?:focusinfocus|focusoutblur)$/,we=function(t){t.stopPropagation()};E.extend(E.event,{trigger:function(t,e,r,n){var o,s,a,l,c,u,h,d,f=[r||_],m=p.call(t,"type")?t.type:t,g=p.call(t,"namespace")?t.namespace.split("."):[];if(s=d=a=r=r||_,3!==r.nodeType&&8!==r.nodeType&&!xe.test(m+E.event.triggered)&&(m.indexOf(".")>-1&&(g=m.split("."),m=g.shift(),g.sort()),c=m.indexOf(":")<0&&"on"+m,(t=t[E.expando]?t:new E.Event(m,"object"==typeof t&&t)).isTrigger=n?2:3,t.namespace=g.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),e=null==e?[t]:E.makeArray(e,[t]),h=E.event.special[m]||{},n||!h.trigger||!1!==h.trigger.apply(r,e))){if(!n&&!h.noBubble&&!v(r)){for(l=h.delegateType||m,xe.test(l+m)||(s=s.parentNode);s;s=s.parentNode)f.push(s),a=s;a===(r.ownerDocument||_)&&f.push(a.defaultView||a.parentWindow||i)}for(o=0;(s=f[o++])&&!t.isPropagationStopped();)d=s,t.type=o>1?l:h.bindType||m,(u=(J.get(s,"events")||Object.create(null))[t.type]&&J.get(s,"handle"))&&u.apply(s,e),(u=c&&s[c])&&u.apply&&Y(s)&&(t.result=u.apply(s,e),!1===t.result&&t.preventDefault());return t.type=m,n||t.isDefaultPrevented()||h._default&&!1!==h._default.apply(f.pop(),e)||!Y(r)||c&&y(r[m])&&!v(r)&&((a=r[c])&&(r[c]=null),E.event.triggered=m,t.isPropagationStopped()&&d.addEventListener(m,we),r[m](),t.isPropagationStopped()&&d.removeEventListener(m,we),E.event.triggered=void 0,a&&(r[c]=a)),t.result}},simulate:function(t,e,r){var i=E.extend(new E.Event,r,{type:t,isSimulated:!0});E.event.trigger(i,null,e)}}),E.fn.extend({trigger:function(t,e){return this.each((function(){E.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var r=this[0];if(r)return E.event.trigger(t,e,r,!0)}}),g.focusin||E.each({focus:"focusin",blur:"focusout"},(function(t,e){var r=function(t){E.event.simulate(e,t.target,E.event.fix(t))};E.event.special[e]={setup:function(){var i=this.ownerDocument||this.document||this,n=J.access(i,e);n||i.addEventListener(t,r,!0),J.access(i,e,(n||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,n=J.access(i,e)-1;n?J.access(i,e,n):(i.removeEventListener(t,r,!0),J.remove(i,e))}}}));var Te=i.location,Ee={guid:Date.now()},Se=/\?/;E.parseXML=function(t){var e,r;if(!t||"string"!=typeof t)return null;try{e=(new i.DOMParser).parseFromString(t,"text/xml")}catch(t){}return r=e&&e.getElementsByTagName("parsererror")[0],e&&!r||E.error("Invalid XML: "+(r?E.map(r.childNodes,(function(t){return t.textContent})).join("\n"):t)),e};var Pe=/\[\]$/,ke=/\r?\n/g,Ae=/^(?:submit|button|image|reset|file)$/i,Me=/^(?:input|select|textarea|keygen)/i;function Ce(t,e,r,i){var n;if(Array.isArray(e))E.each(e,(function(e,n){r||Pe.test(t)?i(t,n):Ce(t+"["+("object"==typeof n&&null!=n?e:"")+"]",n,r,i)}));else if(r||"object"!==w(e))i(t,e);else for(n in e)Ce(t+"["+n+"]",e[n],r,i)}E.param=function(t,e){var r,i=[],n=function(t,e){var r=y(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==r?"":r)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!E.isPlainObject(t))E.each(t,(function(){n(this.name,this.value)}));else for(r in t)Ce(r,t[r],e,n);return i.join("&")},E.fn.extend({serialize:function(){return E.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=E.prop(this,"elements");return t?E.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!E(this).is(":disabled")&&Me.test(this.nodeName)&&!Ae.test(t)&&(this.checked||!gt.test(t))})).map((function(t,e){var r=E(this).val();return null==r?null:Array.isArray(r)?E.map(r,(function(t){return{name:e.name,value:t.replace(ke,"\r\n")}})):{name:e.name,value:r.replace(ke,"\r\n")}})).get()}});var Ie=/%20/g,Oe=/#.*$/,Le=/([?&])_=[^&]*/,De=/^(.*?):[ \t]*([^\r\n]*)$/gm,Re=/^(?:GET|HEAD)$/,Fe=/^\/\//,Be={},ze={},je="*/".concat("*"),Ne=_.createElement("a");function Ve(t){return function(e,r){"string"!=typeof e&&(r=e,e="*");var i,n=0,o=e.toLowerCase().match(z)||[];if(y(r))for(;i=o[n++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(r)):(t[i]=t[i]||[]).push(r)}}function Ue(t,e,r,i){var n={},o=t===ze;function s(a){var l;return n[a]=!0,E.each(t[a]||[],(function(t,a){var c=a(e,r,i);return"string"!=typeof c||o||n[c]?o?!(l=c):void 0:(e.dataTypes.unshift(c),s(c),!1)})),l}return s(e.dataTypes[0])||!n["*"]&&s("*")}function $e(t,e){var r,i,n=E.ajaxSettings.flatOptions||{};for(r in e)void 0!==e[r]&&((n[r]?t:i||(i={}))[r]=e[r]);return i&&E.extend(!0,t,i),t}Ne.href=Te.href,E.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Te.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Te.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":je,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":E.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?$e($e(t,E.ajaxSettings),e):$e(E.ajaxSettings,t)},ajaxPrefilter:Ve(Be),ajaxTransport:Ve(ze),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var r,n,o,s,a,l,c,u,h,d,p=E.ajaxSetup({},e),f=p.context||p,m=p.context&&(f.nodeType||f.jquery)?E(f):E.event,g=E.Deferred(),y=E.Callbacks("once memory"),v=p.statusCode||{},b={},x={},w="canceled",T={readyState:0,getResponseHeader:function(t){var e;if(c){if(!s)for(s={};e=De.exec(o);)s[e[1].toLowerCase()+" "]=(s[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=s[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return c?o:null},setRequestHeader:function(t,e){return null==c&&(t=x[t.toLowerCase()]=x[t.toLowerCase()]||t,b[t]=e),this},overrideMimeType:function(t){return null==c&&(p.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)T.always(t[T.status]);else for(e in t)v[e]=[v[e],t[e]];return this},abort:function(t){var e=t||w;return r&&r.abort(e),S(0,e),this}};if(g.promise(T),p.url=((t||p.url||Te.href)+"").replace(Fe,Te.protocol+"//"),p.type=e.method||e.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(z)||[""],null==p.crossDomain){l=_.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=Ne.protocol+"//"+Ne.host!=l.protocol+"//"+l.host}catch(t){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=E.param(p.data,p.traditional)),Ue(Be,p,e,T),c)return T;for(h in(u=E.event&&p.global)&&0==E.active++&&E.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Re.test(p.type),n=p.url.replace(Oe,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Ie,"+")):(d=p.url.slice(n.length),p.data&&(p.processData||"string"==typeof p.data)&&(n+=(Se.test(n)?"&":"?")+p.data,delete p.data),!1===p.cache&&(n=n.replace(Le,"$1"),d=(Se.test(n)?"&":"?")+"_="+Ee.guid+++d),p.url=n+d),p.ifModified&&(E.lastModified[n]&&T.setRequestHeader("If-Modified-Since",E.lastModified[n]),E.etag[n]&&T.setRequestHeader("If-None-Match",E.etag[n])),(p.data&&p.hasContent&&!1!==p.contentType||e.contentType)&&T.setRequestHeader("Content-Type",p.contentType),T.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+je+"; q=0.01":""):p.accepts["*"]),p.headers)T.setRequestHeader(h,p.headers[h]);if(p.beforeSend&&(!1===p.beforeSend.call(f,T,p)||c))return T.abort();if(w="abort",y.add(p.complete),T.done(p.success),T.fail(p.error),r=Ue(ze,p,e,T)){if(T.readyState=1,u&&m.trigger("ajaxSend",[T,p]),c)return T;p.async&&p.timeout>0&&(a=i.setTimeout((function(){T.abort("timeout")}),p.timeout));try{c=!1,r.send(b,S)}catch(t){if(c)throw t;S(-1,t)}}else S(-1,"No Transport");function S(t,e,s,l){var h,d,_,b,x,w=e;c||(c=!0,a&&i.clearTimeout(a),r=void 0,o=l||"",T.readyState=t>0?4:0,h=t>=200&&t<300||304===t,s&&(b=function(t,e,r){for(var i,n,o,s,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(n in a)if(a[n]&&a[n].test(i)){l.unshift(n);break}if(l[0]in r)o=l[0];else{for(n in r){if(!l[0]||t.converters[n+" "+l[0]]){o=n;break}s||(s=n)}o=o||s}if(o)return o!==l[0]&&l.unshift(o),r[o]}(p,T,s)),!h&&E.inArray("script",p.dataTypes)>-1&&E.inArray("json",p.dataTypes)<0&&(p.converters["text script"]=function(){}),b=function(t,e,r,i){var n,o,s,a,l,c={},u=t.dataTypes.slice();if(u[1])for(s in t.converters)c[s.toLowerCase()]=t.converters[s];for(o=u.shift();o;)if(t.responseFields[o]&&(r[t.responseFields[o]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(s=c[l+" "+o]||c["* "+o]))for(n in c)if((a=n.split(" "))[1]===o&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[n]:!0!==c[n]&&(o=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}(p,b,T,h),h?(p.ifModified&&((x=T.getResponseHeader("Last-Modified"))&&(E.lastModified[n]=x),(x=T.getResponseHeader("etag"))&&(E.etag[n]=x)),204===t||"HEAD"===p.type?w="nocontent":304===t?w="notmodified":(w=b.state,d=b.data,h=!(_=b.error))):(_=w,!t&&w||(w="error",t<0&&(t=0))),T.status=t,T.statusText=(e||w)+"",h?g.resolveWith(f,[d,w,T]):g.rejectWith(f,[T,w,_]),T.statusCode(v),v=void 0,u&&m.trigger(h?"ajaxSuccess":"ajaxError",[T,p,h?d:_]),y.fireWith(f,[T,w]),u&&(m.trigger("ajaxComplete",[T,p]),--E.active||E.event.trigger("ajaxStop")))}return T},getJSON:function(t,e,r){return E.get(t,e,r,"json")},getScript:function(t,e){return E.get(t,void 0,e,"script")}}),E.each(["get","post"],(function(t,e){E[e]=function(t,r,i,n){return y(r)&&(n=n||i,i=r,r=void 0),E.ajax(E.extend({url:t,type:e,dataType:n,data:r,success:i},E.isPlainObject(t)&&t))}})),E.ajaxPrefilter((function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")})),E._evalUrl=function(t,e,r){return E.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){E.globalEval(t,e,r)}})},E.fn.extend({wrapAll:function(t){var e;return this[0]&&(y(t)&&(t=t.call(this[0])),e=E(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return y(t)?this.each((function(e){E(this).wrapInner(t.call(this,e))})):this.each((function(){var e=E(this),r=e.contents();r.length?r.wrapAll(t):e.append(t)}))},wrap:function(t){var e=y(t);return this.each((function(r){E(this).wrapAll(e?t.call(this,r):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){E(this).replaceWith(this.childNodes)})),this}}),E.expr.pseudos.hidden=function(t){return!E.expr.pseudos.visible(t)},E.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},E.ajaxSettings.xhr=function(){try{return new i.XMLHttpRequest}catch(t){}};var Ge={0:200,1223:204},He=E.ajaxSettings.xhr();g.cors=!!He&&"withCredentials"in He,g.ajax=He=!!He,E.ajaxTransport((function(t){var e,r;if(g.cors||He&&!t.crossDomain)return{send:function(n,o){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];for(s in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),n)a.setRequestHeader(s,n[s]);e=function(t){return function(){e&&(e=r=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(Ge[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=e(),r=a.onerror=a.ontimeout=e("error"),void 0!==a.onabort?a.onabort=r:a.onreadystatechange=function(){4===a.readyState&&i.setTimeout((function(){e&&r()}))},e=e("abort");try{a.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}})),E.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),E.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return E.globalEval(t),t}}}),E.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),E.ajaxTransport("script",(function(t){var e,r;if(t.crossDomain||t.scriptAttrs)return{send:function(i,n){e=E("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",r=function(t){e.remove(),r=null,t&&n("error"===t.type?404:200,t.type)}),_.head.appendChild(e[0])},abort:function(){r&&r()}}}));var qe,We=[],Ze=/(=)\?(?=&|$)|\?\?/;E.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=We.pop()||E.expando+"_"+Ee.guid++;return this[t]=!0,t}}),E.ajaxPrefilter("json jsonp",(function(t,e,r){var n,o,s,a=!1!==t.jsonp&&(Ze.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ze.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return n=t.jsonpCallback=y(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Ze,"$1"+n):!1!==t.jsonp&&(t.url+=(Se.test(t.url)?"&":"?")+t.jsonp+"="+n),t.converters["script json"]=function(){return s||E.error(n+" was not called"),s[0]},t.dataTypes[0]="json",o=i[n],i[n]=function(){s=arguments},r.always((function(){void 0===o?E(i).removeProp(n):i[n]=o,t[n]&&(t.jsonpCallback=e.jsonpCallback,We.push(n)),s&&y(o)&&o(s[0]),s=o=void 0})),"script"})),g.createHTMLDocument=((qe=_.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===qe.childNodes.length),E.parseHTML=function(t,e,r){return"string"!=typeof t?[]:("boolean"==typeof e&&(r=e,e=!1),e||(g.createHTMLDocument?((i=(e=_.implementation.createHTMLDocument("")).createElement("base")).href=_.location.href,e.head.appendChild(i)):e=_),o=!r&&[],(n=I.exec(t))?[e.createElement(n[1])]:(n=Tt([t],e,o),o&&o.length&&E(o).remove(),E.merge([],n.childNodes)));var i,n,o},E.fn.load=function(t,e,r){var i,n,o,s=this,a=t.indexOf(" ");return a>-1&&(i=ye(t.slice(a)),t=t.slice(0,a)),y(e)?(r=e,e=void 0):e&&"object"==typeof e&&(n="POST"),s.length>0&&E.ajax({url:t,type:n||"GET",dataType:"html",data:e}).done((function(t){o=arguments,s.html(i?E("<div>").append(E.parseHTML(t)).find(i):t)})).always(r&&function(t,e){s.each((function(){r.apply(this,o||[t.responseText,e,t])}))}),this},E.expr.pseudos.animated=function(t){return E.grep(E.timers,(function(e){return t===e.elem})).length},E.offset={setOffset:function(t,e,r){var i,n,o,s,a,l,c=E.css(t,"position"),u=E(t),h={};"static"===c&&(t.style.position="relative"),a=u.offset(),o=E.css(t,"top"),l=E.css(t,"left"),("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1?(s=(i=u.position()).top,n=i.left):(s=parseFloat(o)||0,n=parseFloat(l)||0),y(e)&&(e=e.call(t,r,E.extend({},a))),null!=e.top&&(h.top=e.top-a.top+s),null!=e.left&&(h.left=e.left-a.left+n),"using"in e?e.using.call(t,h):u.css(h)}},E.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){E.offset.setOffset(this,t,e)}));var e,r,i=this[0];return i?i.getClientRects().length?(e=i.getBoundingClientRect(),r=i.ownerDocument.defaultView,{top:e.top+r.pageYOffset,left:e.left+r.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,r,i=this[0],n={top:0,left:0};if("fixed"===E.css(i,"position"))e=i.getBoundingClientRect();else{for(e=this.offset(),r=i.ownerDocument,t=i.offsetParent||r.documentElement;t&&(t===r.body||t===r.documentElement)&&"static"===E.css(t,"position");)t=t.parentNode;t&&t!==i&&1===t.nodeType&&((n=E(t).offset()).top+=E.css(t,"borderTopWidth",!0),n.left+=E.css(t,"borderLeftWidth",!0))}return{top:e.top-n.top-E.css(i,"marginTop",!0),left:e.left-n.left-E.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===E.css(t,"position");)t=t.offsetParent;return t||st}))}}),E.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var r="pageYOffset"===e;E.fn[t]=function(i){return H(this,(function(t,i,n){var o;if(v(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===n)return o?o[e]:t[i];o?o.scrollTo(r?o.pageXOffset:n,r?n:o.pageYOffset):t[i]=n}),t,i,arguments.length)}})),E.each(["top","left"],(function(t,e){E.cssHooks[e]=Ht(g.pixelPosition,(function(t,r){if(r)return r=Gt(t,e),Nt.test(r)?E(t).position()[e]+"px":r}))})),E.each({Height:"height",Width:"width"},(function(t,e){E.each({padding:"inner"+t,content:e,"":"outer"+t},(function(r,i){E.fn[i]=function(n,o){var s=arguments.length&&(r||"boolean"!=typeof n),a=r||(!0===n||!0===o?"margin":"border");return H(this,(function(e,r,n){var o;return v(e)?0===i.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===n?E.css(e,r,a):E.style(e,r,n,a)}),e,s?n:void 0,s)}}))})),E.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){E.fn[e]=function(t){return this.on(e,t)}})),E.fn.extend({bind:function(t,e,r){return this.on(t,null,e,r)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,r,i){return this.on(e,t,r,i)},undelegate:function(t,e,r){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",r)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),E.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){E.fn[e]=function(t,r){return arguments.length>0?this.on(e,null,t,r):this.trigger(e)}}));var Xe=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;E.proxy=function(t,e){var r,i,n;if("string"==typeof e&&(r=t[e],e=t,t=r),y(t))return i=a.call(arguments,2),n=function(){return t.apply(e||this,i.concat(a.call(arguments)))},n.guid=t.guid=t.guid||E.guid++,n},E.holdReady=function(t){t?E.readyWait++:E.ready(!0)},E.isArray=Array.isArray,E.parseJSON=JSON.parse,E.nodeName=C,E.isFunction=y,E.isWindow=v,E.camelCase=X,E.type=w,E.now=Date.now,E.isNumeric=function(t){var e=E.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},E.trim=function(t){return null==t?"":(t+"").replace(Xe,"")},void 0===(r=function(){return E}.apply(e,[]))||(t.exports=r);var Ye=i.jQuery,Ke=i.$;return E.noConflict=function(t){return i.$===E&&(i.$=Ke),t&&i.jQuery===E&&(i.jQuery=Ye),E},void 0===n&&(i.jQuery=i.$=E),E}))},842:function(t){t.exports=function(){"use strict";var t,e,r;function i(i,n){if(t)if(e){var o="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk); self.onerror = null;",s={};t(s),r=n(s),"undefined"!=typeof window&&window&&window.URL&&window.URL.createObjectURL&&(r.workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"})))}else e=n;else t=n}return i(["exports"],(function(t){var e="3.6.0";let r;const i={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==r){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{r=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):t}catch(e){r=t}}return r},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!i.API_URL)return null;try{const t=new URL(i.API_URL);return"api.mapbox.cn"===t.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===t.hostname?"https://events.mapbox.com/events/v2":null}catch(t){return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function n(t){return i.API_URL_REGEX.test(t)}function o(t){return 0===t.indexOf("mapbox:")}function s(t){return i.API_CDN_URL_REGEX.test(t)}function a(t){return i.API_SPRITE_REGEX.test(t)}function l(t){return i.API_STYLE_REGEX.test(t)&&!a(t)}const c={create:"create",load:"load",fullLoad:"fullLoad"},u={mark(t){performance.mark(t)},measure(t,e,r){performance.measure(t,e,r)}};function h(t){const e=t.name.split("?")[0];return s(e)&&e.includes("mapbox-gl.js")?"javascript":s(e)&&e.includes("mapbox-gl.css")?"css":function(t){return i.API_FONTS_REGEX.test(t)}(e)?"fontRange":a(e)?"sprite":l(e)?"style":function(t){return i.API_TILEJSON_REGEX.test(t)}(e)?"tilejson":"other"}function d(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var p={},f={};Object.defineProperty(f,"__esModule",{value:!0}),f.setMatrixArrayType=function(t){f.ARRAY_TYPE=g=t},f.toRadian=function(t){return t*v},f.equals=function(t,e){return Math.abs(t-e)<=m*Math.max(1,Math.abs(t),Math.abs(e))},f.RANDOM=f.ARRAY_TYPE=f.EPSILON=void 0;var m=1e-6;f.EPSILON=m;var g="undefined"!=typeof Float32Array?Float32Array:Array;f.ARRAY_TYPE=g;var y=Math.random;f.RANDOM=y;var v=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var _={};function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}Object.defineProperty(_,"__esModule",{value:!0}),_.create=function(){var t=new x.ARRAY_TYPE(4);return x.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},_.clone=function(t){var e=new x.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},_.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},_.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},_.fromValues=function(t,e,r,i){var n=new x.ARRAY_TYPE(4);return n[0]=t,n[1]=e,n[2]=r,n[3]=i,n},_.set=function(t,e,r,i,n){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t},_.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},_.invert=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=r*o-n*i;return s?(t[0]=o*(s=1/s),t[1]=-i*s,t[2]=-n*s,t[3]=r*s,t):null},_.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},_.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},_.multiply=T,_.rotate=function(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=Math.sin(r),l=Math.cos(r);return t[0]=i*l+o*a,t[1]=n*l+s*a,t[2]=i*-a+o*l,t[3]=n*-a+s*l,t},_.scale=function(t,e,r){var i=e[1],n=e[2],o=e[3],s=r[0],a=r[1];return t[0]=e[0]*s,t[1]=i*s,t[2]=n*a,t[3]=o*a,t},_.fromRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=-r,t[3]=i,t},_.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},_.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},_.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},_.LDU=function(t,e,r,i){return t[2]=i[2]/i[0],r[0]=i[0],r[1]=i[1],r[3]=i[3]-t[2]*r[1],[t,e,r]},_.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},_.subtract=E,_.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},_.equals=function(t,e){var r=t[0],i=t[1],n=t[2],o=t[3],s=e[0],a=e[1],l=e[2],c=e[3];return Math.abs(r-s)<=x.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-a)<=x.EPSILON*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(n-l)<=x.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(o-c)<=x.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},_.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},_.multiplyScalarAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t},_.sub=_.mul=void 0;var x=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==b(t)&&"function"!=typeof t)return{default:t};var r=w(void 0);if(r&&r.has(t))return r.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var s=n?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=t[o]}return i.default=t,r&&r.set(t,i),i}(f);function w(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(w=function(t){return t?r:e})(t)}function T(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=r[0],l=r[1],c=r[2],u=r[3];return t[0]=i*a+o*l,t[1]=n*a+s*l,t[2]=i*c+o*u,t[3]=n*c+s*u,t}function E(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}_.mul=T,_.sub=E;var S={};function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}Object.defineProperty(S,"__esModule",{value:!0}),S.create=function(){var t=new k.ARRAY_TYPE(6);return k.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t},S.clone=function(t){var e=new k.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},S.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},S.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},S.fromValues=function(t,e,r,i,n,o){var s=new k.ARRAY_TYPE(6);return s[0]=t,s[1]=e,s[2]=r,s[3]=i,s[4]=n,s[5]=o,s},S.set=function(t,e,r,i,n,o,s){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t[4]=o,t[5]=s,t},S.invert=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=e[4],a=e[5],l=r*o-i*n;return l?(t[0]=o*(l=1/l),t[1]=-i*l,t[2]=-n*l,t[3]=r*l,t[4]=(n*a-o*s)*l,t[5]=(i*s-r*a)*l,t):null},S.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},S.multiply=M,S.rotate=function(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=Math.sin(r),u=Math.cos(r);return t[0]=i*u+o*c,t[1]=n*u+s*c,t[2]=i*-c+o*u,t[3]=n*-c+s*u,t[4]=a,t[5]=l,t},S.scale=function(t,e,r){var i=e[1],n=e[2],o=e[3],s=e[4],a=e[5],l=r[0],c=r[1];return t[0]=e[0]*l,t[1]=i*l,t[2]=n*c,t[3]=o*c,t[4]=s,t[5]=a,t},S.translate=function(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=r[0],u=r[1];return t[0]=i,t[1]=n,t[2]=o,t[3]=s,t[4]=i*c+o*u+a,t[5]=n*c+s*u+l,t},S.fromRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=-r,t[3]=i,t[4]=0,t[5]=0,t},S.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},S.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},S.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},S.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)},S.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},S.subtract=C,S.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},S.multiplyScalarAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t},S.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},S.equals=function(t,e){var r=t[0],i=t[1],n=t[2],o=t[3],s=t[4],a=t[5],l=e[0],c=e[1],u=e[2],h=e[3],d=e[4],p=e[5];return Math.abs(r-l)<=k.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(i-c)<=k.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(n-u)<=k.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(o-h)<=k.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-d)<=k.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(a-p)<=k.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))},S.sub=S.mul=void 0;var k=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==P(t)&&"function"!=typeof t)return{default:t};var r=A(void 0);if(r&&r.has(t))return r.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var s=n?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=t[o]}return i.default=t,r&&r.set(t,i),i}(f);function A(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(A=function(t){return t?r:e})(t)}function M(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=r[0],u=r[1],h=r[2],d=r[3],p=r[4],f=r[5];return t[0]=i*c+o*u,t[1]=n*c+s*u,t[2]=i*h+o*d,t[3]=n*h+s*d,t[4]=i*p+o*f+a,t[5]=n*p+s*f+l,t}function C(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}S.mul=M,S.sub=C;var I={};function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}Object.defineProperty(I,"__esModule",{value:!0}),I.create=function(){var t=new L.ARRAY_TYPE(9);return L.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},I.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},I.clone=function(t){var e=new L.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},I.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},I.fromValues=function(t,e,r,i,n,o,s,a,l){var c=new L.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=i,c[4]=n,c[5]=o,c[6]=s,c[7]=a,c[8]=l,c},I.set=function(t,e,r,i,n,o,s,a,l,c){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t[4]=o,t[5]=s,t[6]=a,t[7]=l,t[8]=c,t},I.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},I.transpose=function(t,e){if(t===e){var r=e[1],i=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=i,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},I.invert=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*s-a*c,d=-u*o+a*l,p=c*o-s*l,f=r*h+i*d+n*p;return f?(t[0]=h*(f=1/f),t[1]=(-u*i+n*c)*f,t[2]=(a*i-n*s)*f,t[3]=d*f,t[4]=(u*r-n*l)*f,t[5]=(-a*r+n*o)*f,t[6]=p*f,t[7]=(-c*r+i*l)*f,t[8]=(s*r-i*o)*f,t):null},I.adjoint=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t[0]=s*u-a*c,t[1]=n*c-i*u,t[2]=i*a-n*s,t[3]=a*l-o*u,t[4]=r*u-n*l,t[5]=n*o-r*a,t[6]=o*c-s*l,t[7]=i*l-r*c,t[8]=r*s-i*o,t},I.determinant=function(t){var e=t[3],r=t[4],i=t[5],n=t[6],o=t[7],s=t[8];return t[0]*(s*r-i*o)+t[1]*(-s*e+i*n)+t[2]*(o*e-r*n)},I.multiply=R,I.translate=function(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=r[0],p=r[1];return t[0]=i,t[1]=n,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=d*i+p*s+c,t[7]=d*n+p*a+u,t[8]=d*o+p*l+h,t},I.rotate=function(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=Math.sin(r),p=Math.cos(r);return t[0]=p*i+d*s,t[1]=p*n+d*a,t[2]=p*o+d*l,t[3]=p*s-d*i,t[4]=p*a-d*n,t[5]=p*l-d*o,t[6]=c,t[7]=u,t[8]=h,t},I.scale=function(t,e,r){var i=r[0],n=r[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},I.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},I.fromRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=-r,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},I.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},I.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},I.fromQuat=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=r+r,a=i+i,l=n+n,c=r*s,u=i*s,h=i*a,d=n*s,p=n*a,f=n*l,m=o*s,g=o*a,y=o*l;return t[0]=1-h-f,t[3]=u-y,t[6]=d+g,t[1]=u+y,t[4]=1-c-f,t[7]=p-m,t[2]=d-g,t[5]=p+m,t[8]=1-c-h,t},I.normalFromMat4=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],y=e[15],v=r*a-i*s,_=r*l-n*s,b=r*c-o*s,x=i*l-n*a,w=i*c-o*a,T=n*c-o*l,E=u*m-h*f,S=u*g-d*f,P=u*y-p*f,k=h*g-d*m,A=h*y-p*m,M=d*y-p*g,C=v*M-_*A+b*k+x*P-w*S+T*E;return C?(t[0]=(a*M-l*A+c*k)*(C=1/C),t[1]=(l*P-s*M-c*S)*C,t[2]=(s*A-a*P+c*E)*C,t[3]=(n*A-i*M-o*k)*C,t[4]=(r*M-n*P+o*S)*C,t[5]=(i*P-r*A-o*E)*C,t[6]=(m*T-g*w+y*x)*C,t[7]=(g*b-f*T-y*_)*C,t[8]=(f*w-m*b+y*v)*C,t):null},I.projection=function(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},I.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},I.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},I.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},I.subtract=F,I.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},I.multiplyScalarAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t},I.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},I.equals=function(t,e){var r=t[0],i=t[1],n=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=e[0],d=e[1],p=e[2],f=e[3],m=e[4],g=e[5],y=e[6],v=e[7],_=e[8];return Math.abs(r-h)<=L.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-d)<=L.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(n-p)<=L.EPSILON*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(o-f)<=L.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(s-m)<=L.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(a-g)<=L.EPSILON*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(l-y)<=L.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(c-v)<=L.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(u-_)<=L.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))},I.sub=I.mul=void 0;var L=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==O(t)&&"function"!=typeof t)return{default:t};var r=D(void 0);if(r&&r.has(t))return r.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var s=n?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=t[o]}return i.default=t,r&&r.set(t,i),i}(f);function D(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(D=function(t){return t?r:e})(t)}function R(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=r[0],p=r[1],f=r[2],m=r[3],g=r[4],y=r[5],v=r[6],_=r[7],b=r[8];return t[0]=d*i+p*s+f*c,t[1]=d*n+p*a+f*u,t[2]=d*o+p*l+f*h,t[3]=m*i+g*s+y*c,t[4]=m*n+g*a+y*u,t[5]=m*o+g*l+y*h,t[6]=v*i+_*s+b*c,t[7]=v*n+_*a+b*u,t[8]=v*o+_*l+b*h,t}function F(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}I.mul=R,I.sub=F;var B={};function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}Object.defineProperty(B,"__esModule",{value:!0}),B.create=function(){var t=new j.ARRAY_TYPE(16);return j.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},B.clone=function(t){var e=new j.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},B.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},B.fromValues=function(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m){var g=new j.ARRAY_TYPE(16);return g[0]=t,g[1]=e,g[2]=r,g[3]=i,g[4]=n,g[5]=o,g[6]=s,g[7]=a,g[8]=l,g[9]=c,g[10]=u,g[11]=h,g[12]=d,g[13]=p,g[14]=f,g[15]=m,g},B.set=function(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t[4]=o,t[5]=s,t[6]=a,t[7]=l,t[8]=c,t[9]=u,t[10]=h,t[11]=d,t[12]=p,t[13]=f,t[14]=m,t[15]=g,t},B.identity=V,B.transpose=function(t,e){if(t===e){var r=e[1],i=e[2],n=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=n,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},B.invert=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],y=e[15],v=r*a-i*s,_=r*l-n*s,b=r*c-o*s,x=i*l-n*a,w=i*c-o*a,T=n*c-o*l,E=u*m-h*f,S=u*g-d*f,P=u*y-p*f,k=h*g-d*m,A=h*y-p*m,M=d*y-p*g,C=v*M-_*A+b*k+x*P-w*S+T*E;return C?(t[0]=(a*M-l*A+c*k)*(C=1/C),t[1]=(n*A-i*M-o*k)*C,t[2]=(m*T-g*w+y*x)*C,t[3]=(d*w-h*T-p*x)*C,t[4]=(l*P-s*M-c*S)*C,t[5]=(r*M-n*P+o*S)*C,t[6]=(g*b-f*T-y*_)*C,t[7]=(u*T-d*b+p*_)*C,t[8]=(s*A-a*P+c*E)*C,t[9]=(i*P-r*A-o*E)*C,t[10]=(f*w-m*b+y*v)*C,t[11]=(h*b-u*w-p*v)*C,t[12]=(a*S-s*k-l*E)*C,t[13]=(r*k-i*S+n*E)*C,t[14]=(m*_-f*x-g*v)*C,t[15]=(u*x-h*_+d*v)*C,t):null},B.adjoint=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],y=e[15];return t[0]=a*(d*y-p*g)-h*(l*y-c*g)+m*(l*p-c*d),t[1]=-(i*(d*y-p*g)-h*(n*y-o*g)+m*(n*p-o*d)),t[2]=i*(l*y-c*g)-a*(n*y-o*g)+m*(n*c-o*l),t[3]=-(i*(l*p-c*d)-a*(n*p-o*d)+h*(n*c-o*l)),t[4]=-(s*(d*y-p*g)-u*(l*y-c*g)+f*(l*p-c*d)),t[5]=r*(d*y-p*g)-u*(n*y-o*g)+f*(n*p-o*d),t[6]=-(r*(l*y-c*g)-s*(n*y-o*g)+f*(n*c-o*l)),t[7]=r*(l*p-c*d)-s*(n*p-o*d)+u*(n*c-o*l),t[8]=s*(h*y-p*m)-u*(a*y-c*m)+f*(a*p-c*h),t[9]=-(r*(h*y-p*m)-u*(i*y-o*m)+f*(i*p-o*h)),t[10]=r*(a*y-c*m)-s*(i*y-o*m)+f*(i*c-o*a),t[11]=-(r*(a*p-c*h)-s*(i*p-o*h)+u*(i*c-o*a)),t[12]=-(s*(h*g-d*m)-u*(a*g-l*m)+f*(a*d-l*h)),t[13]=r*(h*g-d*m)-u*(i*g-n*m)+f*(i*d-n*h),t[14]=-(r*(a*g-l*m)-s*(i*g-n*m)+f*(i*l-n*a)),t[15]=r*(a*d-l*h)-s*(i*d-n*h)+u*(i*l-n*a),t},B.determinant=function(t){var e=t[0],r=t[1],i=t[2],n=t[3],o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15];return(e*s-r*o)*(h*g-d*m)-(e*a-i*o)*(u*g-d*f)+(e*l-n*o)*(u*m-h*f)+(r*a-i*s)*(c*g-d*p)-(r*l-n*s)*(c*m-h*p)+(i*l-n*a)*(c*f-u*p)},B.multiply=U,B.translate=function(t,e,r){var i,n,o,s,a,l,c,u,h,d,p,f,m=r[0],g=r[1],y=r[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*y+e[12],t[13]=e[1]*m+e[5]*g+e[9]*y+e[13],t[14]=e[2]*m+e[6]*g+e[10]*y+e[14],t[15]=e[3]*m+e[7]*g+e[11]*y+e[15]):(n=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],t[0]=i=e[0],t[1]=n,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=d,t[10]=p,t[11]=f,t[12]=i*m+a*g+h*y+e[12],t[13]=n*m+l*g+d*y+e[13],t[14]=o*m+c*g+p*y+e[14],t[15]=s*m+u*g+f*y+e[15]),t},B.scale=function(t,e,r){var i=r[0],n=r[1],o=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},B.rotate=function(t,e,r,i){var n,o,s,a,l,c,u,h,d,p,f,m,g,y,v,_,b,x,w,T,E,S,P,k,A=i[0],M=i[1],C=i[2],I=Math.hypot(A,M,C);return I<j.EPSILON?null:(A*=I=1/I,M*=I,C*=I,n=Math.sin(r),o=Math.cos(r),l=e[1],c=e[2],u=e[3],d=e[5],p=e[6],f=e[7],g=e[9],y=e[10],v=e[11],_=A*A*(s=1-o)+o,w=A*M*s-C*n,T=M*M*s+o,E=C*M*s+A*n,S=A*C*s+M*n,P=M*C*s-A*n,k=C*C*s+o,t[0]=(a=e[0])*_+(h=e[4])*(b=M*A*s+C*n)+(m=e[8])*(x=C*A*s-M*n),t[1]=l*_+d*b+g*x,t[2]=c*_+p*b+y*x,t[3]=u*_+f*b+v*x,t[4]=a*w+h*T+m*E,t[5]=l*w+d*T+g*E,t[6]=c*w+p*T+y*E,t[7]=u*w+f*T+v*E,t[8]=a*S+h*P+m*k,t[9]=l*S+d*P+g*k,t[10]=c*S+p*P+y*k,t[11]=u*S+f*P+v*k,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},B.rotateX=function(t,e,r){var i=Math.sin(r),n=Math.cos(r),o=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*n+c*i,t[5]=s*n+u*i,t[6]=a*n+h*i,t[7]=l*n+d*i,t[8]=c*n-o*i,t[9]=u*n-s*i,t[10]=h*n-a*i,t[11]=d*n-l*i,t},B.rotateY=function(t,e,r){var i=Math.sin(r),n=Math.cos(r),o=e[0],s=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n-c*i,t[1]=s*n-u*i,t[2]=a*n-h*i,t[3]=l*n-d*i,t[8]=o*i+c*n,t[9]=s*i+u*n,t[10]=a*i+h*n,t[11]=l*i+d*n,t},B.rotateZ=function(t,e,r){var i=Math.sin(r),n=Math.cos(r),o=e[0],s=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n+c*i,t[1]=s*n+u*i,t[2]=a*n+h*i,t[3]=l*n+d*i,t[4]=c*n-o*i,t[5]=u*n-s*i,t[6]=h*n-a*i,t[7]=d*n-l*i,t},B.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},B.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},B.fromRotation=function(t,e,r){var i,n,o,s=r[0],a=r[1],l=r[2],c=Math.hypot(s,a,l);return c<j.EPSILON?null:(s*=c=1/c,a*=c,l*=c,i=Math.sin(e),n=Math.cos(e),t[0]=s*s*(o=1-n)+n,t[1]=a*s*o+l*i,t[2]=l*s*o-a*i,t[3]=0,t[4]=s*a*o-l*i,t[5]=a*a*o+n,t[6]=l*a*o+s*i,t[7]=0,t[8]=s*l*o+a*i,t[9]=a*l*o-s*i,t[10]=l*l*o+n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},B.fromXRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},B.fromYRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},B.fromZRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},B.fromRotationTranslation=$,B.fromQuat2=function(t,e){var r=new j.ARRAY_TYPE(3),i=-e[0],n=-e[1],o=-e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=i*i+n*n+o*o+s*s;return h>0?(r[0]=2*(a*s+u*i+l*o-c*n)/h,r[1]=2*(l*s+u*n+c*i-a*o)/h,r[2]=2*(c*s+u*o+a*n-l*i)/h):(r[0]=2*(a*s+u*i+l*o-c*n),r[1]=2*(l*s+u*n+c*i-a*o),r[2]=2*(c*s+u*o+a*n-l*i)),$(t,e,r),t},B.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},B.getScaling=G,B.getRotation=function(t,e){var r=new j.ARRAY_TYPE(3);G(r,e);var i=1/r[0],n=1/r[1],o=1/r[2],s=e[0]*i,a=e[1]*n,l=e[2]*o,c=e[4]*i,u=e[5]*n,h=e[6]*o,d=e[8]*i,p=e[9]*n,f=e[10]*o,m=s+u+f,g=0;return m>0?(g=2*Math.sqrt(m+1),t[3]=.25*g,t[0]=(h-p)/g,t[1]=(d-l)/g,t[2]=(a-c)/g):s>u&&s>f?(g=2*Math.sqrt(1+s-u-f),t[3]=(h-p)/g,t[0]=.25*g,t[1]=(a+c)/g,t[2]=(d+l)/g):u>f?(g=2*Math.sqrt(1+u-s-f),t[3]=(d-l)/g,t[0]=(a+c)/g,t[1]=.25*g,t[2]=(h+p)/g):(g=2*Math.sqrt(1+f-s-u),t[3]=(a-c)/g,t[0]=(d+l)/g,t[1]=(h+p)/g,t[2]=.25*g),t},B.fromRotationTranslationScale=function(t,e,r,i){var n=e[0],o=e[1],s=e[2],a=e[3],l=n+n,c=o+o,u=s+s,h=n*l,d=n*c,p=n*u,f=o*c,m=o*u,g=s*u,y=a*l,v=a*c,_=a*u,b=i[0],x=i[1],w=i[2];return t[0]=(1-(f+g))*b,t[1]=(d+_)*b,t[2]=(p-v)*b,t[3]=0,t[4]=(d-_)*x,t[5]=(1-(h+g))*x,t[6]=(m+y)*x,t[7]=0,t[8]=(p+v)*w,t[9]=(m-y)*w,t[10]=(1-(h+f))*w,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},B.fromRotationTranslationScaleOrigin=function(t,e,r,i,n){var o=e[0],s=e[1],a=e[2],l=e[3],c=o+o,u=s+s,h=a+a,d=o*c,p=o*u,f=o*h,m=s*u,g=s*h,y=a*h,v=l*c,_=l*u,b=l*h,x=i[0],w=i[1],T=i[2],E=n[0],S=n[1],P=n[2],k=(1-(m+y))*x,A=(p+b)*x,M=(f-_)*x,C=(p-b)*w,I=(1-(d+y))*w,O=(g+v)*w,L=(f+_)*T,D=(g-v)*T,R=(1-(d+m))*T;return t[0]=k,t[1]=A,t[2]=M,t[3]=0,t[4]=C,t[5]=I,t[6]=O,t[7]=0,t[8]=L,t[9]=D,t[10]=R,t[11]=0,t[12]=r[0]+E-(k*E+C*S+L*P),t[13]=r[1]+S-(A*E+I*S+D*P),t[14]=r[2]+P-(M*E+O*S+R*P),t[15]=1,t},B.fromQuat=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=r+r,a=i+i,l=n+n,c=r*s,u=i*s,h=i*a,d=n*s,p=n*a,f=n*l,m=o*s,g=o*a,y=o*l;return t[0]=1-h-f,t[1]=u+y,t[2]=d-g,t[3]=0,t[4]=u-y,t[5]=1-c-f,t[6]=p+m,t[7]=0,t[8]=d+g,t[9]=p-m,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},B.frustum=function(t,e,r,i,n,o,s){var a=1/(r-e),l=1/(n-i),c=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(r+e)*a,t[9]=(n+i)*l,t[10]=(s+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*c,t[15]=0,t},B.perspectiveNO=H,B.perspectiveZO=function(t,e,r,i,n){var o,s=1/Math.tan(e/2);return t[0]=s/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=n&&n!==1/0?(t[10]=n*(o=1/(i-n)),t[14]=n*i*o):(t[10]=-1,t[14]=-i),t},B.perspectiveFromFieldOfView=function(t,e,r,i){var n=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(s+a),c=2/(n+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(s-a)*l*.5,t[9]=(n-o)*c*.5,t[10]=i/(r-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*r/(r-i),t[15]=0,t},B.orthoNO=q,B.orthoZO=function(t,e,r,i,n,o,s){var a=1/(e-r),l=1/(i-n),c=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+r)*a,t[13]=(n+i)*l,t[14]=o*c,t[15]=1,t},B.lookAt=function(t,e,r,i){var n,o,s,a,l,c,u,h,d,p,f=e[0],m=e[1],g=e[2],y=i[0],v=i[1],_=i[2],b=r[0],x=r[1],w=r[2];return Math.abs(f-b)<j.EPSILON&&Math.abs(m-x)<j.EPSILON&&Math.abs(g-w)<j.EPSILON?V(t):(u=f-b,h=m-x,d=g-w,n=v*(d*=p=1/Math.hypot(u,h,d))-_*(h*=p),o=_*(u*=p)-y*d,s=y*h-v*u,(p=Math.hypot(n,o,s))?(n*=p=1/p,o*=p,s*=p):(n=0,o=0,s=0),a=h*s-d*o,l=d*n-u*s,c=u*o-h*n,(p=Math.hypot(a,l,c))?(a*=p=1/p,l*=p,c*=p):(a=0,l=0,c=0),t[0]=n,t[1]=a,t[2]=u,t[3]=0,t[4]=o,t[5]=l,t[6]=h,t[7]=0,t[8]=s,t[9]=c,t[10]=d,t[11]=0,t[12]=-(n*f+o*m+s*g),t[13]=-(a*f+l*m+c*g),t[14]=-(u*f+h*m+d*g),t[15]=1,t)},B.targetTo=function(t,e,r,i){var n=e[0],o=e[1],s=e[2],a=i[0],l=i[1],c=i[2],u=n-r[0],h=o-r[1],d=s-r[2],p=u*u+h*h+d*d;p>0&&(u*=p=1/Math.sqrt(p),h*=p,d*=p);var f=l*d-c*h,m=c*u-a*d,g=a*h-l*u;return(p=f*f+m*m+g*g)>0&&(f*=p=1/Math.sqrt(p),m*=p,g*=p),t[0]=f,t[1]=m,t[2]=g,t[3]=0,t[4]=h*g-d*m,t[5]=d*f-u*g,t[6]=u*m-h*f,t[7]=0,t[8]=u,t[9]=h,t[10]=d,t[11]=0,t[12]=n,t[13]=o,t[14]=s,t[15]=1,t},B.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},B.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},B.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},B.subtract=W,B.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},B.multiplyScalarAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t[9]=e[9]+r[9]*i,t[10]=e[10]+r[10]*i,t[11]=e[11]+r[11]*i,t[12]=e[12]+r[12]*i,t[13]=e[13]+r[13]*i,t[14]=e[14]+r[14]*i,t[15]=e[15]+r[15]*i,t},B.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},B.equals=function(t,e){var r=t[0],i=t[1],n=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],y=t[15],v=e[0],_=e[1],b=e[2],x=e[3],w=e[4],T=e[5],E=e[6],S=e[7],P=e[8],k=e[9],A=e[10],M=e[11],C=e[12],I=e[13],O=e[14],L=e[15];return Math.abs(r-v)<=j.EPSILON*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(i-_)<=j.EPSILON*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(n-b)<=j.EPSILON*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(o-x)<=j.EPSILON*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(s-w)<=j.EPSILON*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(a-T)<=j.EPSILON*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(l-E)<=j.EPSILON*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(c-S)<=j.EPSILON*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(u-P)<=j.EPSILON*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(h-k)<=j.EPSILON*Math.max(1,Math.abs(h),Math.abs(k))&&Math.abs(d-A)<=j.EPSILON*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(p-M)<=j.EPSILON*Math.max(1,Math.abs(p),Math.abs(M))&&Math.abs(f-C)<=j.EPSILON*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(m-I)<=j.EPSILON*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(g-O)<=j.EPSILON*Math.max(1,Math.abs(g),Math.abs(O))&&Math.abs(y-L)<=j.EPSILON*Math.max(1,Math.abs(y),Math.abs(L))},B.sub=B.mul=B.ortho=B.perspective=void 0;var j=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==z(t)&&"function"!=typeof t)return{default:t};var r=N(void 0);if(r&&r.has(t))return r.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var s=n?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=t[o]}return i.default=t,r&&r.set(t,i),i}(f);function N(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(N=function(t){return t?r:e})(t)}function V(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function U(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],y=e[14],v=e[15],_=r[0],b=r[1],x=r[2],w=r[3];return t[0]=_*i+b*a+x*h+w*m,t[1]=_*n+b*l+x*d+w*g,t[2]=_*o+b*c+x*p+w*y,t[3]=_*s+b*u+x*f+w*v,t[4]=(_=r[4])*i+(b=r[5])*a+(x=r[6])*h+(w=r[7])*m,t[5]=_*n+b*l+x*d+w*g,t[6]=_*o+b*c+x*p+w*y,t[7]=_*s+b*u+x*f+w*v,t[8]=(_=r[8])*i+(b=r[9])*a+(x=r[10])*h+(w=r[11])*m,t[9]=_*n+b*l+x*d+w*g,t[10]=_*o+b*c+x*p+w*y,t[11]=_*s+b*u+x*f+w*v,t[12]=(_=r[12])*i+(b=r[13])*a+(x=r[14])*h+(w=r[15])*m,t[13]=_*n+b*l+x*d+w*g,t[14]=_*o+b*c+x*p+w*y,t[15]=_*s+b*u+x*f+w*v,t}function $(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=i+i,l=n+n,c=o+o,u=i*a,h=i*l,d=i*c,p=n*l,f=n*c,m=o*c,g=s*a,y=s*l,v=s*c;return t[0]=1-(p+m),t[1]=h+v,t[2]=d-y,t[3]=0,t[4]=h-v,t[5]=1-(u+m),t[6]=f+g,t[7]=0,t[8]=d+y,t[9]=f-g,t[10]=1-(u+p),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function G(t,e){var r=e[4],i=e[5],n=e[6],o=e[8],s=e[9],a=e[10];return t[0]=Math.hypot(e[0],e[1],e[2]),t[1]=Math.hypot(r,i,n),t[2]=Math.hypot(o,s,a),t}function H(t,e,r,i,n){var o,s=1/Math.tan(e/2);return t[0]=s/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=n&&n!==1/0?(t[10]=(n+i)*(o=1/(i-n)),t[14]=2*n*i*o):(t[10]=-1,t[14]=-2*i),t}function q(t,e,r,i,n,o,s){var a=1/(e-r),l=1/(i-n),c=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*a,t[13]=(n+i)*l,t[14]=(s+o)*c,t[15]=1,t}function W(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}B.perspective=H,B.ortho=q,B.mul=U,B.sub=W;var Z={},X={};function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}Object.defineProperty(X,"__esModule",{value:!0}),X.create=Q,X.clone=function(t){var e=new K.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},X.length=tt,X.fromValues=function(t,e,r){var i=new K.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=r,i},X.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},X.set=function(t,e,r,i){return t[0]=e,t[1]=r,t[2]=i,t},X.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},X.subtract=et,X.multiply=rt,X.divide=it,X.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},X.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},X.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},X.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},X.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},X.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},X.scaleAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t},X.distance=nt,X.squaredDistance=ot,X.squaredLength=st,X.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},X.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},X.normalize=function(t,e){var r=e[0],i=e[1],n=e[2],o=r*r+i*i+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t},X.dot=at,X.cross=function(t,e,r){var i=e[0],n=e[1],o=e[2],s=r[0],a=r[1],l=r[2];return t[0]=n*l-o*a,t[1]=o*s-i*l,t[2]=i*a-n*s,t},X.lerp=function(t,e,r,i){var n=e[0],o=e[1],s=e[2];return t[0]=n+i*(r[0]-n),t[1]=o+i*(r[1]-o),t[2]=s+i*(r[2]-s),t},X.hermite=function(t,e,r,i,n,o){var s=o*o,a=s*(2*o-3)+1,l=s*(o-2)+o,c=s*(o-1),u=s*(3-2*o);return t[0]=e[0]*a+r[0]*l+i[0]*c+n[0]*u,t[1]=e[1]*a+r[1]*l+i[1]*c+n[1]*u,t[2]=e[2]*a+r[2]*l+i[2]*c+n[2]*u,t},X.bezier=function(t,e,r,i,n,o){var s=1-o,a=s*s,l=o*o,c=a*s,u=3*o*a,h=3*l*s,d=l*o;return t[0]=e[0]*c+r[0]*u+i[0]*h+n[0]*d,t[1]=e[1]*c+r[1]*u+i[1]*h+n[1]*d,t[2]=e[2]*c+r[2]*u+i[2]*h+n[2]*d,t},X.random=function(t,e){e=e||1;var r=2*K.RANDOM()*Math.PI,i=2*K.RANDOM()-1,n=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(r)*n,t[1]=Math.sin(r)*n,t[2]=i*e,t},X.transformMat4=function(t,e,r){var i=e[0],n=e[1],o=e[2],s=r[3]*i+r[7]*n+r[11]*o+r[15];return t[0]=(r[0]*i+r[4]*n+r[8]*o+r[12])/(s=s||1),t[1]=(r[1]*i+r[5]*n+r[9]*o+r[13])/s,t[2]=(r[2]*i+r[6]*n+r[10]*o+r[14])/s,t},X.transformMat3=function(t,e,r){var i=e[0],n=e[1],o=e[2];return t[0]=i*r[0]+n*r[3]+o*r[6],t[1]=i*r[1]+n*r[4]+o*r[7],t[2]=i*r[2]+n*r[5]+o*r[8],t},X.transformQuat=function(t,e,r){var i=r[0],n=r[1],o=r[2],s=e[0],a=e[1],l=e[2],c=n*l-o*a,u=o*s-i*l,h=i*a-n*s,d=n*h-o*u,p=o*c-i*h,f=i*u-n*c,m=2*r[3];return u*=m,h*=m,p*=2,f*=2,t[0]=s+(c*=m)+(d*=2),t[1]=a+u+p,t[2]=l+h+f,t},X.rotateX=function(t,e,r,i){var n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[0],o[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),o[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},X.rotateY=function(t,e,r,i){var n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),o[1]=n[1],o[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},X.rotateZ=function(t,e,r,i){var n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),o[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),o[2]=n[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},X.angle=function(t,e){var r=t[0],i=t[1],n=t[2],o=e[0],s=e[1],a=e[2],l=Math.sqrt(r*r+i*i+n*n)*Math.sqrt(o*o+s*s+a*a),c=l&&at(t,e)/l;return Math.acos(Math.min(Math.max(c,-1),1))},X.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t},X.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},X.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},X.equals=function(t,e){var r=t[0],i=t[1],n=t[2],o=e[0],s=e[1],a=e[2];return Math.abs(r-o)<=K.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=K.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(n-a)<=K.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))},X.forEach=X.sqrLen=X.len=X.sqrDist=X.dist=X.div=X.mul=X.sub=void 0;var K=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==Y(t)&&"function"!=typeof t)return{default:t};var r=J(void 0);if(r&&r.has(t))return r.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var s=n?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=t[o]}return i.default=t,r&&r.set(t,i),i}(f);function J(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(J=function(t){return t?r:e})(t)}function Q(){var t=new K.ARRAY_TYPE(3);return K.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function tt(t){return Math.hypot(t[0],t[1],t[2])}function et(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function rt(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function it(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function nt(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])}function ot(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return r*r+i*i+n*n}function st(t){var e=t[0],r=t[1],i=t[2];return e*e+r*r+i*i}function at(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}X.sub=et,X.mul=rt,X.div=it,X.dist=nt,X.sqrDist=ot,X.len=tt,X.sqrLen=st;var lt,ct=(lt=Q(),function(t,e,r,i,n,o){var s,a;for(e||(e=3),r||(r=0),a=i?Math.min(i*e+r,t.length):t.length,s=r;s<a;s+=e)lt[0]=t[s],lt[1]=t[s+1],lt[2]=t[s+2],n(lt,lt,o),t[s]=lt[0],t[s+1]=lt[1],t[s+2]=lt[2];return t});X.forEach=ct;var ut={};function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}Object.defineProperty(ut,"__esModule",{value:!0}),ut.create=ft,ut.clone=function(t){var e=new dt.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},ut.fromValues=function(t,e,r,i){var n=new dt.ARRAY_TYPE(4);return n[0]=t,n[1]=e,n[2]=r,n[3]=i,n},ut.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},ut.set=function(t,e,r,i,n){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t},ut.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},ut.subtract=mt,ut.multiply=gt,ut.divide=yt,ut.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},ut.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},ut.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},ut.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},ut.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},ut.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},ut.scaleAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t},ut.distance=vt,ut.squaredDistance=_t,ut.length=bt,ut.squaredLength=xt,ut.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},ut.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},ut.normalize=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=r*r+i*i+n*n+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=r*s,t[1]=i*s,t[2]=n*s,t[3]=o*s,t},ut.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},ut.cross=function(t,e,r,i){var n=r[0]*i[1]-r[1]*i[0],o=r[0]*i[2]-r[2]*i[0],s=r[0]*i[3]-r[3]*i[0],a=r[1]*i[2]-r[2]*i[1],l=r[1]*i[3]-r[3]*i[1],c=r[2]*i[3]-r[3]*i[2],u=e[0],h=e[1],d=e[2],p=e[3];return t[0]=h*c-d*l+p*a,t[1]=-u*c+d*s-p*o,t[2]=u*l-h*s+p*n,t[3]=-u*a+h*o-d*n,t},ut.lerp=function(t,e,r,i){var n=e[0],o=e[1],s=e[2],a=e[3];return t[0]=n+i*(r[0]-n),t[1]=o+i*(r[1]-o),t[2]=s+i*(r[2]-s),t[3]=a+i*(r[3]-a),t},ut.random=function(t,e){var r,i,n,o,s,a;e=e||1;do{s=(r=2*dt.RANDOM()-1)*r+(i=2*dt.RANDOM()-1)*i}while(s>=1);do{a=(n=2*dt.RANDOM()-1)*n+(o=2*dt.RANDOM()-1)*o}while(a>=1);var l=Math.sqrt((1-s)/a);return t[0]=e*r,t[1]=e*i,t[2]=e*n*l,t[3]=e*o*l,t},ut.transformMat4=function(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3];return t[0]=r[0]*i+r[4]*n+r[8]*o+r[12]*s,t[1]=r[1]*i+r[5]*n+r[9]*o+r[13]*s,t[2]=r[2]*i+r[6]*n+r[10]*o+r[14]*s,t[3]=r[3]*i+r[7]*n+r[11]*o+r[15]*s,t},ut.transformQuat=function(t,e,r){var i=e[0],n=e[1],o=e[2],s=r[0],a=r[1],l=r[2],c=r[3],u=c*i+a*o-l*n,h=c*n+l*i-s*o,d=c*o+s*n-a*i,p=-s*i-a*n-l*o;return t[0]=u*c+p*-s+h*-l-d*-a,t[1]=h*c+p*-a+d*-s-u*-l,t[2]=d*c+p*-l+u*-a-h*-s,t[3]=e[3],t},ut.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},ut.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},ut.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},ut.equals=function(t,e){var r=t[0],i=t[1],n=t[2],o=t[3],s=e[0],a=e[1],l=e[2],c=e[3];return Math.abs(r-s)<=dt.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-a)<=dt.EPSILON*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(n-l)<=dt.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(o-c)<=dt.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},ut.forEach=ut.sqrLen=ut.len=ut.sqrDist=ut.dist=ut.div=ut.mul=ut.sub=void 0;var dt=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==ht(t)&&"function"!=typeof t)return{default:t};var r=pt(void 0);if(r&&r.has(t))return r.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var s=n?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=t[o]}return i.default=t,r&&r.set(t,i),i}(f);function pt(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(pt=function(t){return t?r:e})(t)}function ft(){var t=new dt.ARRAY_TYPE(4);return dt.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function mt(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function gt(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function yt(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function vt(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2],e[3]-t[3])}function _t(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2],o=e[3]-t[3];return r*r+i*i+n*n+o*o}function bt(t){return Math.hypot(t[0],t[1],t[2],t[3])}function xt(t){var e=t[0],r=t[1],i=t[2],n=t[3];return e*e+r*r+i*i+n*n}ut.sub=mt,ut.mul=gt,ut.div=yt,ut.dist=vt,ut.sqrDist=_t,ut.len=bt,ut.sqrLen=xt;var wt=function(){var t=ft();return function(e,r,i,n,o,s){var a,l;for(r||(r=4),i||(i=0),l=n?Math.min(n*r+i,e.length):e.length,a=i;a<l;a+=r)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}();function Tt(t){return Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tt(t)}ut.forEach=wt,Object.defineProperty(Z,"__esModule",{value:!0}),Z.create=Ct,Z.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},Z.setAxisAngle=It,Z.getAxisAngle=function(t,e){var r=2*Math.acos(e[3]),i=Math.sin(r/2);return i>Et.EPSILON?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),r},Z.getAngle=function(t,e){var r=zt(t,e);return Math.acos(2*r*r-1)},Z.multiply=Ot,Z.rotateX=function(t,e,r){r*=.5;var i=e[0],n=e[1],o=e[2],s=e[3],a=Math.sin(r),l=Math.cos(r);return t[0]=i*l+s*a,t[1]=n*l+o*a,t[2]=o*l-n*a,t[3]=s*l-i*a,t},Z.rotateY=function(t,e,r){r*=.5;var i=e[0],n=e[1],o=e[2],s=e[3],a=Math.sin(r),l=Math.cos(r);return t[0]=i*l-o*a,t[1]=n*l+s*a,t[2]=o*l+i*a,t[3]=s*l-n*a,t},Z.rotateZ=function(t,e,r){r*=.5;var i=e[0],n=e[1],o=e[2],s=e[3],a=Math.sin(r),l=Math.cos(r);return t[0]=i*l+n*a,t[1]=n*l-i*a,t[2]=o*l+s*a,t[3]=s*l-o*a,t},Z.calculateW=function(t,e){var r=e[0],i=e[1],n=e[2];return t[0]=r,t[1]=i,t[2]=n,t[3]=Math.sqrt(Math.abs(1-r*r-i*i-n*n)),t},Z.exp=Lt,Z.ln=Dt,Z.pow=function(t,e,r){return Dt(t,e),Bt(t,t,r),Lt(t,t),t},Z.slerp=Rt,Z.random=function(t){var e=Et.RANDOM(),r=Et.RANDOM(),i=Et.RANDOM(),n=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=n*Math.sin(2*Math.PI*r),t[1]=n*Math.cos(2*Math.PI*r),t[2]=o*Math.sin(2*Math.PI*i),t[3]=o*Math.cos(2*Math.PI*i),t},Z.invert=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=r*r+i*i+n*n+o*o,a=s?1/s:0;return t[0]=-r*a,t[1]=-i*a,t[2]=-n*a,t[3]=o*a,t},Z.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},Z.fromMat3=Ft,Z.fromEuler=function(t,e,r,i){var n=.5*Math.PI/180;e*=n,r*=n,i*=n;var o=Math.sin(e),s=Math.cos(e),a=Math.sin(r),l=Math.cos(r),c=Math.sin(i),u=Math.cos(i);return t[0]=o*l*u-s*a*c,t[1]=s*a*u+o*l*c,t[2]=s*l*c-o*a*u,t[3]=s*l*u+o*a*c,t},Z.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},Z.setAxes=Z.sqlerp=Z.rotationTo=Z.equals=Z.exactEquals=Z.normalize=Z.sqrLen=Z.squaredLength=Z.len=Z.length=Z.lerp=Z.dot=Z.scale=Z.mul=Z.add=Z.set=Z.copy=Z.fromValues=Z.clone=void 0;var Et=Mt(f),St=Mt(I),Pt=Mt(X),kt=Mt(ut);function At(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(At=function(t){return t?r:e})(t)}function Mt(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==Tt(t)&&"function"!=typeof t)return{default:t};var r=At(e);if(r&&r.has(t))return r.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var s=n?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=t[o]}return i.default=t,r&&r.set(t,i),i}function Ct(){var t=new Et.ARRAY_TYPE(4);return Et.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function It(t,e,r){r*=.5;var i=Math.sin(r);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(r),t}function Ot(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=r[0],l=r[1],c=r[2],u=r[3];return t[0]=i*u+s*a+n*c-o*l,t[1]=n*u+s*l+o*a-i*c,t[2]=o*u+s*c+i*l-n*a,t[3]=s*u-i*a-n*l-o*c,t}function Lt(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=Math.sqrt(r*r+i*i+n*n),a=Math.exp(o),l=s>0?a*Math.sin(s)/s:0;return t[0]=r*l,t[1]=i*l,t[2]=n*l,t[3]=a*Math.cos(s),t}function Dt(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=Math.sqrt(r*r+i*i+n*n),a=s>0?Math.atan2(s,o)/s:0;return t[0]=r*a,t[1]=i*a,t[2]=n*a,t[3]=.5*Math.log(r*r+i*i+n*n+o*o),t}function Rt(t,e,r,i){var n,o,s,a,l,c=e[0],u=e[1],h=e[2],d=e[3],p=r[0],f=r[1],m=r[2],g=r[3];return(o=c*p+u*f+h*m+d*g)<0&&(o=-o,p=-p,f=-f,m=-m,g=-g),1-o>Et.EPSILON?(n=Math.acos(o),s=Math.sin(n),a=Math.sin((1-i)*n)/s,l=Math.sin(i*n)/s):(a=1-i,l=i),t[0]=a*c+l*p,t[1]=a*u+l*f,t[2]=a*h+l*m,t[3]=a*d+l*g,t}function Ft(t,e){var r,i=e[0]+e[4]+e[8];if(i>0)r=Math.sqrt(i+1),t[3]=.5*r,t[0]=(e[5]-e[7])*(r=.5/r),t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);var o=(n+1)%3,s=(n+2)%3;r=Math.sqrt(e[3*n+n]-e[3*o+o]-e[3*s+s]+1),t[n]=.5*r,t[3]=(e[3*o+s]-e[3*s+o])*(r=.5/r),t[o]=(e[3*o+n]+e[3*n+o])*r,t[s]=(e[3*s+n]+e[3*n+s])*r}return t}Z.clone=kt.clone,Z.fromValues=kt.fromValues,Z.copy=kt.copy,Z.set=kt.set,Z.add=kt.add,Z.mul=Ot;var Bt=kt.scale;Z.scale=Bt;var zt=kt.dot;Z.dot=zt,Z.lerp=kt.lerp;var jt=kt.length;Z.length=jt,Z.len=jt;var Nt=kt.squaredLength;Z.squaredLength=Nt,Z.sqrLen=Nt;var Vt=kt.normalize;Z.normalize=Vt,Z.exactEquals=kt.exactEquals,Z.equals=kt.equals;var Ut,$t,Gt,Ht=(Ut=Pt.create(),$t=Pt.fromValues(1,0,0),Gt=Pt.fromValues(0,1,0),function(t,e,r){var i=Pt.dot(e,r);return i<-.999999?(Pt.cross(Ut,$t,e),Pt.len(Ut)<1e-6&&Pt.cross(Ut,Gt,e),Pt.normalize(Ut,Ut),It(t,Ut,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Pt.cross(Ut,e,r),t[0]=Ut[0],t[1]=Ut[1],t[2]=Ut[2],t[3]=1+i,Vt(t,t))});Z.rotationTo=Ht;var qt,Wt,Zt=(qt=Ct(),Wt=Ct(),function(t,e,r,i,n,o){return Rt(qt,e,n,o),Rt(Wt,r,i,o),Rt(t,qt,Wt,2*o*(1-o)),t});Z.sqlerp=Zt;var Xt,Yt=(Xt=St.create(),function(t,e,r,i){return Xt[0]=r[0],Xt[3]=r[1],Xt[6]=r[2],Xt[1]=i[0],Xt[4]=i[1],Xt[7]=i[2],Xt[2]=-e[0],Xt[5]=-e[1],Xt[8]=-e[2],Vt(t,Ft(t,Xt))});Z.setAxes=Yt;var Kt={};function Jt(t){return Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jt(t)}Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.create=function(){var t=new Qt.ARRAY_TYPE(8);return Qt.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t},Kt.clone=function(t){var e=new Qt.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},Kt.fromValues=function(t,e,r,i,n,o,s,a){var l=new Qt.ARRAY_TYPE(8);return l[0]=t,l[1]=e,l[2]=r,l[3]=i,l[4]=n,l[5]=o,l[6]=s,l[7]=a,l},Kt.fromRotationTranslationValues=function(t,e,r,i,n,o,s){var a=new Qt.ARRAY_TYPE(8);a[0]=t,a[1]=e,a[2]=r,a[3]=i;var l=.5*n,c=.5*o,u=.5*s;return a[4]=l*i+c*r-u*e,a[5]=c*i+u*t-l*r,a[6]=u*i+l*e-c*t,a[7]=-l*t-c*e-u*r,a},Kt.fromRotationTranslation=ne,Kt.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},Kt.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},Kt.fromMat4=function(t,e){var r=te.create();ee.getRotation(r,e);var i=new Qt.ARRAY_TYPE(3);return ee.getTranslation(i,e),ne(t,r,i),t},Kt.copy=oe,Kt.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},Kt.set=function(t,e,r,i,n,o,s,a,l){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t[4]=o,t[5]=s,t[6]=a,t[7]=l,t},Kt.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},Kt.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},Kt.getTranslation=function(t,e){var r=e[4],i=e[5],n=e[6],o=e[7],s=-e[0],a=-e[1],l=-e[2],c=e[3];return t[0]=2*(r*c+o*s+i*l-n*a),t[1]=2*(i*c+o*a+n*s-r*l),t[2]=2*(n*c+o*l+r*a-i*s),t},Kt.translate=function(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=.5*r[0],l=.5*r[1],c=.5*r[2],u=e[4],h=e[5],d=e[6],p=e[7];return t[0]=i,t[1]=n,t[2]=o,t[3]=s,t[4]=s*a+n*c-o*l+u,t[5]=s*l+o*a-i*c+h,t[6]=s*c+i*l-n*a+d,t[7]=-i*a-n*l-o*c+p,t},Kt.rotateX=function(t,e,r){var i=-e[0],n=-e[1],o=-e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=a*s+u*i+l*o-c*n,d=l*s+u*n+c*i-a*o,p=c*s+u*o+a*n-l*i,f=u*s-a*i-l*n-c*o;return te.rotateX(t,e,r),t[4]=h*(s=t[3])+f*(i=t[0])+d*(o=t[2])-p*(n=t[1]),t[5]=d*s+f*n+p*i-h*o,t[6]=p*s+f*o+h*n-d*i,t[7]=f*s-h*i-d*n-p*o,t},Kt.rotateY=function(t,e,r){var i=-e[0],n=-e[1],o=-e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=a*s+u*i+l*o-c*n,d=l*s+u*n+c*i-a*o,p=c*s+u*o+a*n-l*i,f=u*s-a*i-l*n-c*o;return te.rotateY(t,e,r),t[4]=h*(s=t[3])+f*(i=t[0])+d*(o=t[2])-p*(n=t[1]),t[5]=d*s+f*n+p*i-h*o,t[6]=p*s+f*o+h*n-d*i,t[7]=f*s-h*i-d*n-p*o,t},Kt.rotateZ=function(t,e,r){var i=-e[0],n=-e[1],o=-e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=a*s+u*i+l*o-c*n,d=l*s+u*n+c*i-a*o,p=c*s+u*o+a*n-l*i,f=u*s-a*i-l*n-c*o;return te.rotateZ(t,e,r),t[4]=h*(s=t[3])+f*(i=t[0])+d*(o=t[2])-p*(n=t[1]),t[5]=d*s+f*n+p*i-h*o,t[6]=p*s+f*o+h*n-d*i,t[7]=f*s-h*i-d*n-p*o,t},Kt.rotateByQuatAppend=function(t,e,r){var i=r[0],n=r[1],o=r[2],s=r[3],a=e[0],l=e[1],c=e[2],u=e[3];return t[0]=a*s+u*i+l*o-c*n,t[1]=l*s+u*n+c*i-a*o,t[2]=c*s+u*o+a*n-l*i,t[3]=u*s-a*i-l*n-c*o,t[4]=(a=e[4])*s+(u=e[7])*i+(l=e[5])*o-(c=e[6])*n,t[5]=l*s+u*n+c*i-a*o,t[6]=c*s+u*o+a*n-l*i,t[7]=u*s-a*i-l*n-c*o,t},Kt.rotateByQuatPrepend=function(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=r[0],l=r[1],c=r[2],u=r[3];return t[0]=i*u+s*a+n*c-o*l,t[1]=n*u+s*l+o*a-i*c,t[2]=o*u+s*c+i*l-n*a,t[3]=s*u-i*a-n*l-o*c,t[4]=i*(u=r[7])+s*(a=r[4])+n*(c=r[6])-o*(l=r[5]),t[5]=n*u+s*l+o*a-i*c,t[6]=o*u+s*c+i*l-n*a,t[7]=s*u-i*a-n*l-o*c,t},Kt.rotateAroundAxis=function(t,e,r,i){if(Math.abs(i)<Qt.EPSILON)return oe(t,e);var n=Math.hypot(r[0],r[1],r[2]);i*=.5;var o=Math.sin(i),s=o*r[0]/n,a=o*r[1]/n,l=o*r[2]/n,c=Math.cos(i),u=e[0],h=e[1],d=e[2],p=e[3];t[0]=u*c+p*s+h*l-d*a,t[1]=h*c+p*a+d*s-u*l,t[2]=d*c+p*l+u*a-h*s,t[3]=p*c-u*s-h*a-d*l;var f=e[4],m=e[5],g=e[6],y=e[7];return t[4]=f*c+y*s+m*l-g*a,t[5]=m*c+y*a+g*s-f*l,t[6]=g*c+y*l+f*a-m*s,t[7]=y*c-f*s-m*a-g*l,t},Kt.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t},Kt.multiply=se,Kt.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t},Kt.lerp=function(t,e,r,i){var n=1-i;return ae(e,r)<0&&(i=-i),t[0]=e[0]*n+r[0]*i,t[1]=e[1]*n+r[1]*i,t[2]=e[2]*n+r[2]*i,t[3]=e[3]*n+r[3]*i,t[4]=e[4]*n+r[4]*i,t[5]=e[5]*n+r[5]*i,t[6]=e[6]*n+r[6]*i,t[7]=e[7]*n+r[7]*i,t},Kt.invert=function(t,e){var r=ce(e);return t[0]=-e[0]/r,t[1]=-e[1]/r,t[2]=-e[2]/r,t[3]=e[3]/r,t[4]=-e[4]/r,t[5]=-e[5]/r,t[6]=-e[6]/r,t[7]=e[7]/r,t},Kt.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},Kt.normalize=function(t,e){var r=ce(e);if(r>0){r=Math.sqrt(r);var i=e[0]/r,n=e[1]/r,o=e[2]/r,s=e[3]/r,a=e[4],l=e[5],c=e[6],u=e[7],h=i*a+n*l+o*c+s*u;t[0]=i,t[1]=n,t[2]=o,t[3]=s,t[4]=(a-i*h)/r,t[5]=(l-n*h)/r,t[6]=(c-o*h)/r,t[7]=(u-s*h)/r}return t},Kt.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},Kt.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},Kt.equals=function(t,e){var r=t[0],i=t[1],n=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=e[0],h=e[1],d=e[2],p=e[3],f=e[4],m=e[5],g=e[6],y=e[7];return Math.abs(r-u)<=Qt.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-h)<=Qt.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(n-d)<=Qt.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(o-p)<=Qt.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-f)<=Qt.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(a-m)<=Qt.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(l-g)<=Qt.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(c-y)<=Qt.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))},Kt.sqrLen=Kt.squaredLength=Kt.len=Kt.length=Kt.dot=Kt.mul=Kt.setReal=Kt.getReal=void 0;var Qt=ie(f),te=ie(Z),ee=ie(B);function re(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(re=function(t){return t?r:e})(t)}function ie(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==Jt(t)&&"function"!=typeof t)return{default:t};var r=re(e);if(r&&r.has(t))return r.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var s=n?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=t[o]}return i.default=t,r&&r.set(t,i),i}function ne(t,e,r){var i=.5*r[0],n=.5*r[1],o=.5*r[2],s=e[0],a=e[1],l=e[2],c=e[3];return t[0]=s,t[1]=a,t[2]=l,t[3]=c,t[4]=i*c+n*l-o*a,t[5]=n*c+o*s-i*l,t[6]=o*c+i*a-n*s,t[7]=-i*s-n*a-o*l,t}function oe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function se(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=r[4],l=r[5],c=r[6],u=r[7],h=e[4],d=e[5],p=e[6],f=e[7],m=r[0],g=r[1],y=r[2],v=r[3];return t[0]=i*v+s*m+n*y-o*g,t[1]=n*v+s*g+o*m-i*y,t[2]=o*v+s*y+i*g-n*m,t[3]=s*v-i*m-n*g-o*y,t[4]=i*u+s*a+n*c-o*l+h*v+f*m+d*y-p*g,t[5]=n*u+s*l+o*a-i*c+d*v+f*g+p*m-h*y,t[6]=o*u+s*c+i*l-n*a+p*v+f*y+h*g-d*m,t[7]=s*u-i*a-n*l-o*c+f*v-h*m-d*g-p*y,t}Kt.getReal=te.copy,Kt.setReal=te.copy,Kt.mul=se;var ae=te.dot;Kt.dot=ae;var le=te.length;Kt.length=le,Kt.len=le;var ce=te.squaredLength;Kt.squaredLength=ce,Kt.sqrLen=ce;var ue={};function he(t){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},he(t)}Object.defineProperty(ue,"__esModule",{value:!0}),ue.create=fe,ue.clone=function(t){var e=new de.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},ue.fromValues=function(t,e){var r=new de.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},ue.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},ue.set=function(t,e,r){return t[0]=e,t[1]=r,t},ue.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},ue.subtract=me,ue.multiply=ge,ue.divide=ye,ue.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},ue.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},ue.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},ue.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},ue.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},ue.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},ue.scaleAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t},ue.distance=ve,ue.squaredDistance=_e,ue.length=be,ue.squaredLength=xe,ue.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},ue.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},ue.normalize=function(t,e){var r=e[0],i=e[1],n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n)),t[0]=e[0]*n,t[1]=e[1]*n,t},ue.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},ue.cross=function(t,e,r){var i=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=i,t},ue.lerp=function(t,e,r,i){var n=e[0],o=e[1];return t[0]=n+i*(r[0]-n),t[1]=o+i*(r[1]-o),t},ue.random=function(t,e){e=e||1;var r=2*de.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},ue.transformMat2=function(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n,t[1]=r[1]*i+r[3]*n,t},ue.transformMat2d=function(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n+r[4],t[1]=r[1]*i+r[3]*n+r[5],t},ue.transformMat3=function(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[3]*n+r[6],t[1]=r[1]*i+r[4]*n+r[7],t},ue.transformMat4=function(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[4]*n+r[12],t[1]=r[1]*i+r[5]*n+r[13],t},ue.rotate=function(t,e,r,i){var n=e[0]-r[0],o=e[1]-r[1],s=Math.sin(i),a=Math.cos(i);return t[0]=n*a-o*s+r[0],t[1]=n*s+o*a+r[1],t},ue.angle=function(t,e){var r=t[0],i=t[1],n=e[0],o=e[1],s=Math.sqrt(r*r+i*i)*Math.sqrt(n*n+o*o);return Math.acos(Math.min(Math.max(s&&(r*n+i*o)/s,-1),1))},ue.zero=function(t){return t[0]=0,t[1]=0,t},ue.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},ue.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},ue.equals=function(t,e){var r=t[0],i=t[1],n=e[0],o=e[1];return Math.abs(r-n)<=de.EPSILON*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-o)<=de.EPSILON*Math.max(1,Math.abs(i),Math.abs(o))},ue.forEach=ue.sqrLen=ue.sqrDist=ue.dist=ue.div=ue.mul=ue.sub=ue.len=void 0;var de=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==he(t)&&"function"!=typeof t)return{default:t};var r=pe(void 0);if(r&&r.has(t))return r.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var s=n?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=t[o]}return i.default=t,r&&r.set(t,i),i}(f);function pe(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(pe=function(t){return t?r:e})(t)}function fe(){var t=new de.ARRAY_TYPE(2);return de.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function me(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function ge(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function ye(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function ve(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1])}function _e(t,e){var r=e[0]-t[0],i=e[1]-t[1];return r*r+i*i}function be(t){return Math.hypot(t[0],t[1])}function xe(t){var e=t[0],r=t[1];return e*e+r*r}ue.len=be,ue.sub=me,ue.mul=ge,ue.div=ye,ue.dist=ve,ue.sqrDist=_e,ue.sqrLen=xe;var we=function(){var t=fe();return function(e,r,i,n,o,s){var a,l;for(r||(r=2),i||(i=0),l=n?Math.min(n*r+i,e.length):e.length,a=i;a<l;a+=r)t[0]=e[a],t[1]=e[a+1],o(t,t,s),e[a]=t[0],e[a+1]=t[1];return e}}();function Te(t){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Te(t)}ue.forEach=we,Object.defineProperty(p,"__esModule",{value:!0}),t.aB=p.vec4=t.$=p.vec3=p.vec2=p.quat2=t.aw=p.quat=t.ae=p.mat4=t.bE=p.mat3=p.mat2d=t.aD=p.mat2=p.glMatrix=void 0;var Ee=Re(f);p.glMatrix=Ee;var Se=Re(_);t.aD=p.mat2=Se;var Pe=Re(S);p.mat2d=Pe;var ke=Re(I);t.bE=p.mat3=ke;var Ae=Re(B);t.ae=p.mat4=Ae;var Me=Re(Z);t.aw=p.quat=Me;var Ce=Re(Kt);p.quat2=Ce;var Ie=Re(ue);p.vec2=Ie;var Oe=Re(X);t.$=p.vec3=Oe;var Le=Re(ut);function De(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(De=function(t){return t?r:e})(t)}function Re(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==Te(t)&&"function"!=typeof t)return{default:t};var r=De(e);if(r&&r.has(t))return r.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var s=n?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=t[o]}return i.default=t,r&&r.set(t,i),i}t.aB=p.vec4=Le;var Fe=Be;function Be(t,e,r,i){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=r,this.p2y=i}Be.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var r=t,i=0;i<8;i++){var n=this.sampleCurveX(r)-t;if(Math.abs(n)<e)return r;var o=this.sampleCurveDerivativeX(r);if(Math.abs(o)<1e-6)break;r-=n/o}var s=0,a=1;for(r=t,i=0;i<20&&(n=this.sampleCurveX(r),!(Math.abs(n-t)<e));i++)t>n?s=r:a=r,r=.5*(a-s)+s;return r},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var ze=d(Fe),je=Ne;function Ne(t,e){this.x=t,this.y=e}Ne.prototype={clone:function(){return new Ne(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),i=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=i,this},_rotateAround:function(t,e){var r=Math.cos(t),i=Math.sin(t),n=e.y+i*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-i*(this.y-e.y),this.y=n,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ne.convert=function(t){return t instanceof Ne?t:Array.isArray(t)?new Ne(t[0],t[1]):t};var Ve=d(je);function Ue(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Ue(t[r],e[r]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(!Ue(t[r],e[r]))return!1;return!0}return t===e}const $e=Math.PI/180,Ge=180/Math.PI;function He(t){return t*$e}function qe(t){return t*Ge}const We=[[0,0],[1,0],[1,1],[0,1]];function Ze(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}function Xe(t,e,r,i){const n=new ze(t,e,r,i);return function(t){return n.solve(t)}}const Ye=Xe(.25,.1,.25,1);function Ke(t,e,r){return Math.min(r,Math.max(e,t))}function Je(t,e,r){return(r=Ke((r-t)/(e-t),0,1))*r*(3-2*r)}function Qe(t,e,r){const i=r-e,n=((t-e)%i+i)%i+e;return n===e?r:n}function tr(t,e,r){if(!t.length)return r(null,[]);let i=t.length;const n=new Array(t.length);let o=null;t.forEach(((t,s)=>{e(t,((t,e)=>{t&&(o=t),n[s]=e,0==--i&&r(o,n)}))}))}function er(t){const e=[];for(const r in t)e.push(t[r]);return e}function rr(t,...e){for(const r of e)for(const e in r)t[e]=r[e];return t}let ir=1;function nr(){return ir++}function or(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function sr(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function ar(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function lr(t,e){t.forEach((t=>{e[t]&&(e[t]=e[t].bind(e))}))}function cr(t,e){return-1!==t.indexOf(e,t.length-e.length)}function ur(t,e,r){const i={};for(const r in t)i[r]=e.call(this,t[r],r,t);return i}function hr(t,e,r){const i={};for(const r in t)e.call(this,t[r],r,t)&&(i[r]=t[r]);return i}function dr(t){return Array.isArray(t)?t.map(dr):"object"==typeof t&&t?ur(t,dr):t}const pr={};function fr(t){pr[t]||("undefined"!=typeof console&&console.warn(t),pr[t]=!0)}function mr(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function gr(t){let e=0;for(let r,i,n=0,o=t.length,s=o-1;n<o;s=n++)r=t[n],i=t[s],e+=(i.x-r.x)*(r.y+i.y);return e}function yr([t,e,r]){const i=He(e+90),n=He(r);return{x:t*Math.cos(i)*Math.sin(n),y:t*Math.sin(i)*Math.sin(n),z:t*Math.cos(n),azimuthal:e,polar:r}}function vr(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function _r(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((t,r,i,n)=>{const o=i||n;return e[r]=!o||o.toLowerCase(),""})),e["max-age"]){const t=parseInt(e["max-age"],10);isNaN(t)?delete e["max-age"]:e["max-age"]=t}return e}let br,xr,wr,Tr,Er,Sr,Pr=null;function kr(t){try{const e=self[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}}function Ar(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}function Mr(t,e,r,i){for(;e<r;){const n=e+r>>1;t[n]<i?e=n+1:r=n}return e}function Cr(t,e,r,i){for(;e<r;){const n=e+r>>1;t[n]<=i?e=n+1:r=n}return e}function Ir(t){return t>0?1/(1.001-t):1+t}function Or(t){return t>0?1-1/(1.001-t):-t}function Lr(){return null==br&&(br=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),br}const Dr={now:()=>void 0!==Tr?Tr:performance.now(),setNow(t){Tr=t},restoreNow(){Tr=void 0},frame(t){const e=requestAnimationFrame(t);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(t,e=0){const{width:r,height:i}=t;Er||(Er=document.createElement("canvas"));const n=Er.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return(r>Er.width||i>Er.height)&&(Er.width=r,Er.height=i),n.clearRect(-e,-e,r+2*e,i+2*e),n.drawImage(t,0,0,r,i),n.getImageData(-e,-e,r+2*e,i+2*e)},resolveURL:t=>(xr||(xr=document.createElement("a")),xr.href=t,xr.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(null==wr&&(wr=window.matchMedia("(prefers-reduced-motion: reduce)")),wr.matches)},hasCanvasFingerprintNoise(){if(void 0!==Sr)return Sr;if(!Lr())return Sr=!1,!1;const t=new OffscreenCanvas(85,1),e=t.getContext("2d",{willReadFrequently:!0});let r=0;for(let i=0;i<t.width;++i)e.fillStyle=`rgba(${r++},${r++},${r++}, 255)`,e.fillRect(i,0,1,1);const i=e.getImageData(0,0,t.width,t.height);r=0;for(let t=0;t<i.data.length;++t)if(t%4!=3&&r++!==i.data[t])return Sr=!0,!0;return Sr=!1,!1}};function Rr(t,e){const r=t.indexOf("?");if(r<0)return`${t}?${new URLSearchParams(e).toString()}`;const i=new URLSearchParams(t.slice(r));for(const t in e)i.set(t,e[t]);return`${t.slice(0,r)}?${i.toString()}`}function Fr(t,e={persistentParams:[]}){const r=t.indexOf("?");if(r<0)return t;const i=new URLSearchParams,n=new URLSearchParams(t.slice(r));for(const t of e.persistentParams){const e=n.get(t);e&&i.set(t,e)}const o=i.toString();return`${t.slice(0,r)}${o.length>0?`?${o}`:""}`}const Br="mapbox-tiles";let zr=500,jr=50;const Nr=["language","worldview","jobid"];let Vr,Ur;function $r(){try{return caches}catch(t){}}function Gr(){const t=$r();t&&!Vr&&(Vr=t.open(Br))}let Hr=1/0;const qr={supported:!1,testSupport:function(t){!Xr&&Zr&&(Yr?Jr(t):Wr=t)}};let Wr,Zr,Xr=!1,Yr=!1;const Kr="undefined"!=typeof self?self:{};function Jr(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,Zr),t.isContextLost())return;qr.supported=!0}catch(t){}t.deleteTexture(e),Xr=!0}Kr.document&&(Zr=Kr.document.createElement("img"),Zr.onload=function(){Wr&&Jr(Wr),Wr=null,Yr=!0},Zr.onerror=function(){Xr=!0,Wr=null},Zr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Qr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};"function"==typeof Object.freeze&&Object.freeze(Qr);class ti extends Error{constructor(t,e,r){401===e&&n(r)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=e,this.url=r}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ei=vr()?()=>self.worker&&self.worker.referrer:()=>("blob:"===location.protocol?parent:self).location.href,ri=function(t,e){if(!(/^file:/.test(r=t.url)||/^file:/.test(ei())&&!/^\w+:/.test(r))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(t,e){const r=new AbortController,i=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:ei(),referrerPolicy:t.referrerPolicy,signal:r.signal});let o=!1,s=!1;const a=(l=i.url).indexOf("sku=")>0&&n(l);var l;"json"===t.type&&i.headers.set("Accept","application/json");const c=(r,n,o)=>{if(s)return;if(r&&"SecurityError"!==r.message&&fr(r.toString()),n&&o)return u(n);const l=Date.now();fetch(i).then((r=>{if(r.ok){const t=a?r.clone():null;return u(r,t,l)}return e(new ti(r.statusText,r.status,t.url))})).catch((r=>{"AbortError"!==r.name&&e(new Error(`${r.message} ${t.url}`))}))},u=(r,n,a)=>{("arrayBuffer"===t.type?r.arrayBuffer():"json"===t.type?r.json():r.text()).then((t=>{s||(n&&a&&function(t,e,r){if(Gr(),!Vr)return;const i=_r(e.headers.get("Cache-Control")||"");if(i["no-store"])return;const n={status:e.status,statusText:e.statusText,headers:new Headers};e.headers.forEach(((t,e)=>n.headers.set(e,t))),i["max-age"]&&n.headers.set("Expires",new Date(r+1e3*i["max-age"]).toUTCString());const o=n.headers.get("Expires");if(!o)return;if(new Date(o).getTime()-r<42e4)return;let s=Fr(t.url,{persistentParams:Nr});if(206===e.status){const e=t.headers.get("Range");if(!e)return;n.status=200,s=Rr(s,{range:e})}!function(t,e){if(void 0===Ur)try{new Response(new ReadableStream),Ur=!0}catch(t){Ur=!1}Ur?e(t.body):t.blob().then(e)}(e,(t=>{const r=new Response(200!==(i=e.status)&&404!==i&&[101,103,204,205,304].includes(i)?null:t,n);var i;Gr(),Vr&&Vr.then((t=>t.put(s,r))).catch((t=>fr(t.message)))}))}(i,n,a),o=!0,e(null,t,r.headers.get("Cache-Control"),r.headers.get("Expires")))})).catch((t=>{s||e(new Error(t.message))}))};return a?function(t,e){if(Gr(),!Vr)return e(null);Vr.then((r=>{let i=Fr(t.url,{persistentParams:Nr});const n=t.headers.get("Range");n&&(i=Rr(i,{range:n})),r.match(i).then((t=>{const n=function(t){if(!t)return!1;const e=new Date(t.headers.get("Expires")||0),r=_r(t.headers.get("Cache-Control")||"");return e>Date.now()&&!r["no-cache"]}(t);r.delete(i),n&&r.put(i,t.clone()),e(null,t,n)})).catch(e)})).catch(e)}(i,c):c(null,null),{cancel:()=>{s=!0,o||r.abort()}}}(t,e);if(vr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var r;return function(t,e){const r=new XMLHttpRequest;r.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(r.responseType="arraybuffer");for(const e in t.headers)r.setRequestHeader(e,t.headers[e]);return"json"===t.type&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials="include"===t.credentials,r.onerror=()=>{e(new Error(r.statusText))},r.onload=()=>{if((r.status>=200&&r.status<300||0===r.status)&&null!==r.response){let i=r.response;if("json"===t.type)try{i=JSON.parse(r.response)}catch(t){return e(t)}e(null,i,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"))}else e(new ti(r.statusText,r.status,t.url))},r.send(t.body),{cancel:()=>r.abort()}}(t,e)},ii=function(t,e){return ri(rr(t,{type:"arrayBuffer"}),e)};function ni(t){const e=document.createElement("a");return e.href=t,e.protocol===location.protocol&&e.host===location.host}const oi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let si,ai;si=[],ai=0;const li=function(t,e){if(qr.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),ai>=i.MAX_PARALLEL_IMAGE_REQUESTS){const r={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return si.push(r),r}ai++;let r=!1;const n=()=>{if(!r)for(r=!0,ai--;si.length&&ai<i.MAX_PARALLEL_IMAGE_REQUESTS;){const t=si.shift(),{requestParameters:e,callback:r,cancelled:i}=t;i||(t.cancel=li(e,r).cancel)}},o=ii(t,((t,r,i,o)=>{n(),t?e(t):r&&(self.createImageBitmap?function(t,e){const r=new Blob([new Uint8Array(t)],{type:"image/png"});createImageBitmap(r).then((t=>{e(null,t)})).catch((t=>{e(new Error(`Could not load image because of ${t.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))}(r,((t,r)=>e(t,r,i,o))):function(t,e){const r=new Image;r.onload=()=>{e(null,r),URL.revokeObjectURL(r.src),r.onload=null,requestAnimationFrame((()=>{r.src=oi}))},r.onerror=()=>e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const i=new Blob([new Uint8Array(t)],{type:"image/png"});r.src=t.byteLength?URL.createObjectURL(i):oi}(r,((t,r)=>e(t,r,i,o))))}));return{cancel:()=>{o.cancel(),n()}}},ci="01",ui="NO_ACCESS_TOKEN",hi=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function di(t){const e=t.match(hi);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function pi(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}const fi="mapbox.eventData";function mi(t){if(!t)return null;const e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(atob(e[1]).split("").map((t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2))).join("")))}catch(t){return null}}class gi{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const e=mi(i.ACCESS_TOKEN);let r="";return r=e&&e.u?btoa(encodeURIComponent(e.u).replace(/%([0-9A-F]{2})/g,((t,e)=>String.fromCharCode(Number("0x"+e))))):i.ACCESS_TOKEN||"",t?`${fi}.${t}:${r}`:`${fi}:${r}`}fetchEventData(){const t=kr("localStorage"),e=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{const t=localStorage.getItem(e);t&&(this.eventData=JSON.parse(t));const i=localStorage.getItem(r);i&&(this.anonId=i)}catch(t){fr("Unable to read from LocalStorage")}}saveEventData(){const t=kr("localStorage"),e=this.getStorageKey(),r=this.getStorageKey("uuid"),i=this.anonId;if(t&&i)try{localStorage.setItem(r,i),Object.keys(this.eventData).length>=1&&localStorage.setItem(e,JSON.stringify(this.eventData))}catch(t){fr("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,e,r,n){if(!i.EVENTS_URL)return;const o=di(i.EVENTS_URL);o.params.push(`access_token=${n||i.ACCESS_TOKEN||""}`);const s={event:this.type,created:new Date(t).toISOString()},a=e?rr(s,e):s,l={url:pi(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([a])};this.pendingRequest=function(t,e){return ri(rr(t,{method:"POST"}),e)}(l,(t=>{this.pendingRequest=null,r(t),this.saveEventData(),this.processRequests(n)}))}queueRequest(t,e){this.queue.push(t),this.processRequests(e)}}const yi=new class extends gi{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){i.EVENTS_URL&&i.ACCESS_TOKEN&&Array.isArray(t)&&t.some((t=>o(t)||n(t)))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=mi(i.ACCESS_TOKEN),n=r?r.u:i.ACCESS_TOKEN;let o=n!==this.eventData.tokenU;ar(this.anonId)||(this.anonId=or(),o=!0);const s=this.queue.shift();if(this.eventData.lastSuccess){const t=new Date(this.eventData.lastSuccess),e=new Date(s),r=(s-this.eventData.lastSuccess)/864e5;o=o||r>=1||r<-1||t.getDate()!==e.getDate()}else o=!0;o?this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:e,skuId:ci,"enabled.telemetry":!1,userId:this.anonId},(t=>{t||(this.eventData.lastSuccess=s,this.eventData.tokenU=n)}),t):this.processRequests()}},vi=yi.postTurnstileEvent.bind(yi),_i=new class extends gi{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,r,n){this.skuToken=e,this.errorCb=n,i.EVENTS_URL&&(r||i.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},r):this.errorCb(new Error(ui)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:r,timestamp:i}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),ar(this.anonId)||(this.anonId=or()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:e,skuId:ci,skuToken:this.skuToken,userId:this.anonId},(t=>{t?this.errorCb(t):r&&(this.success[r]=!0)}),t))}remove(){this.errorCb=null}},bi=_i.postMapLoadEvent.bind(_i),xi=new class extends gi{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(t){let e=this.mapInstanceIdMap.get(t);return e||(e=or(),this.mapInstanceIdMap.set(t,e)),e}getEventId(t){const e=this.eventIdPerMapInstanceMap.get(t)||0;return this.eventIdPerMapInstanceMap.set(t,e+1),e}postStyleLoadEvent(t,e){const{map:r,style:n,importedStyles:o}=e;if(!i.EVENTS_URL||!t&&!i.ACCESS_TOKEN)return;const s=this.getMapInstanceId(r),a={mapInstanceId:s,eventId:this.getEventId(s),style:n};o.length&&(a.importedStyles=o),this.queueRequest({timestamp:Date.now(),payload:a},t)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:e,payload:r}=this.queue.shift();this.postEvent(e,r,(()=>{}),t)}},wi=xi.postStyleLoadEvent.bind(xi),Ti=new class extends gi{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){i.EVENTS_URL&&(t||i.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:r,performanceData:i}=this.queue.shift(),n=function(t){const r=performance.getEntriesByType("resource"),i=performance.getEntriesByType("mark"),n=function(t){const e={};if(t)for(const r in t)if("other"!==r)for(const i of t[r]){const t=`${r}ResolveRangeMin`,n=`${r}ResolveRangeMax`,o=`${r}RequestCount`,s=`${r}RequestCachedCount`;e[t]=Math.min(e[t]||1/0,i.startTime),e[n]=Math.max(e[n]||-1/0,i.responseEnd);const a=t=>{void 0===e[t]&&(e[t]=0),++e[t]};void 0!==i.transferSize&&0===i.transferSize&&a(s),a(o)}return e}(function(t,e){const r={};if(t)for(const i of t){const t=e(i);void 0===r[t]&&(r[t]=[]),r[t].push(i)}return r}(r,h)),o=window.devicePixelRatio,s=navigator.connection||navigator.mozConnection||navigator.webkitConnection,a=s?s.effectiveType:void 0,u={counters:[],metadata:[],attributes:[]},d=(t,e,r)=>{null!=r&&t.push({name:e,value:r.toString()})};for(const t in n)d(u.counters,t,n[t]);if(t.interactionRange[0]!==1/0&&t.interactionRange[1]!==-1/0&&(d(u.counters,"interactionRangeMin",t.interactionRange[0]),d(u.counters,"interactionRangeMax",t.interactionRange[1])),i)for(const t of Object.keys(c)){const e=c[t],r=i.find((t=>t.name===e));r&&d(u.counters,e,r.startTime)}return d(u.counters,"visibilityHidden",t.visibilityHidden),d(u.attributes,"style",function(t){if(t)for(const e of t){const t=e.name.split("?")[0];if(l(t)){const e=t.split("/").slice(-2);if(2===e.length)return`mapbox://styles/${e[0]}/${e[1]}`}}}(r)),d(u.attributes,"terrainEnabled",t.terrainEnabled?"true":"false"),d(u.attributes,"fogEnabled",t.fogEnabled?"true":"false"),d(u.attributes,"projection",t.projection),d(u.attributes,"zoom",t.zoom),d(u.metadata,"devicePixelRatio",o),d(u.metadata,"connectionEffectiveType",a),d(u.metadata,"navigatorUserAgent",navigator.userAgent),d(u.metadata,"screenWidth",window.screen.width),d(u.metadata,"screenHeight",window.screen.height),d(u.metadata,"windowWidth",window.innerWidth),d(u.metadata,"windowHeight",window.innerHeight),d(u.metadata,"mapWidth",t.width/o),d(u.metadata,"mapHeight",t.height/o),d(u.metadata,"webglRenderer",t.renderer),d(u.metadata,"webglVendor",t.vendor),d(u.metadata,"sdkVersion",e),d(u.metadata,"sdkIdentifier","mapbox-gl-js"),u}(i);for(const t of n.metadata);for(const t of n.counters);for(const t of n.attributes);this.postEvent(r,n,(()=>{}),t)}},Ei=Ti.postPerformanceEvent.bind(Ti),Si=new class extends gi{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,r,n){if(!i.API_URL||!i.SESSION_PATH)return;const o=di(i.API_URL+i.SESSION_PATH);o.params.push(`sku=${e||""}`),o.params.push(`access_token=${n||i.ACCESS_TOKEN||""}`);const s={url:pi(o),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(t,e){return ri(rr(t,{method:"GET"}),e)}(s,(t=>{this.pendingRequest=null,r(t),this.saveEventData(),this.processRequests(n)}))}getSessionAPI(t,e,r,n){this.skuToken=e,this.errorCb=n,i.SESSION_PATH&&i.API_URL&&(r||i.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},r):this.errorCb(new Error(ui)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||this.getSession(r,this.skuToken,(t=>{t?this.errorCb(t):e&&(this.success[e]=!0)}),t)}remove(){this.errorCb=null}},Pi=Si.getSessionAPI.bind(Si),ki=new Set;var Ai={exports:{}},Mi={exports:function(t,e){var r,i,n,o,s,a,l,c;for(i=t.length-(r=3&t.length),n=e,s=3432918353,a=461845907,c=0;c<i;)l=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,n=27492+(65535&(o=5*(65535&(n=(n^=l=(65535&(l=(l=(65535&l)*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<13|n>>>19))+((5*(n>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(l=0,r){case 3:l^=(255&t.charCodeAt(c+2))<<16;case 2:l^=(255&t.charCodeAt(c+1))<<8;case 1:n^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(c)))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295}return n^=t.length,n=2246822507*(65535&(n^=n>>>16))+((2246822507*(n>>>16)&65535)<<16)&4294967295,n=3266489909*(65535&(n^=n>>>13))+((3266489909*(n>>>16)&65535)<<16)&4294967295,(n^=n>>>16)>>>0}},Ci={exports:function(t,e){for(var r,i=t.length,n=e^i,o=0;i>=4;)r=1540483477*(65535&(r=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(r>>>16)&65535)<<16),n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),i-=4,++o;switch(i){case 3:n^=(255&t.charCodeAt(o+2))<<16;case 2:n^=(255&t.charCodeAt(o+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(o)))+((1540483477*(n>>>16)&65535)<<16)}return n=1540483477*(65535&(n^=n>>>13))+((1540483477*(n>>>16)&65535)<<16),(n^=n>>>15)>>>0}},Ii=Mi.exports,Oi=Ci.exports;Ai.exports=Ii,Ai.exports.murmur3=Ii,Ai.exports.murmur2=Oi;var Li=d(Ai.exports);class Di{constructor(t,...e){rr(this,e[0]||{}),this.type=t}}class Ri extends Di{constructor(t,e={}){super("error",rr({error:t},e))}}function Fi(t,e,r){r[t]&&-1!==r[t].indexOf(e)||(r[t]=r[t]||[],r[t].push(e))}function Bi(t,e,r){if(r&&r[t]){const i=r[t].indexOf(e);-1!==i&&r[t].splice(i,1)}}class zi{on(t,e){return this._listeners=this._listeners||{},Fi(t,e,this._listeners),this}off(t,e){return Bi(t,e,this._listeners),Bi(t,e,this._oneTimeListeners),this}once(t,e){return e?(this._oneTimeListeners=this._oneTimeListeners||{},Fi(t,e,this._oneTimeListeners),this):new Promise((e=>this.once(t,e)))}fire(t,e){const r="string"==typeof t?new Di(t,e):t,i=r.type;if(this.listens(i)){r.target=this;const t=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];for(const e of t)e.call(this,r);const e=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];for(const t of e)Bi(i,t,this._oneTimeListeners),t.call(this,r);const n=this._eventedParent;n&&(rr(r,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),n.fire(r))}else r instanceof Ri&&console.error(r.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}t.G=void 0;var ji={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ni(t){return(t=Math.round(t))<0?0:t>255?255:t}function Vi(t){return Ni("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function Ui(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function $i(t,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}try{t.G={}.parseCSSColor=function(t){var e,r=t.replace(/ /g,"").toLowerCase();if(r in ji)return ji[r].slice();if("#"===r[0])return 4===r.length?(e=parseInt(r.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===r.length&&(e=parseInt(r.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var i=r.indexOf("("),n=r.indexOf(")");if(-1!==i&&n+1===r.length){var o=r.substr(0,i),s=r.substr(i+1,n-(i+1)).split(","),a=1;switch(o){case"rgba":if(4!==s.length)return null;a=Ui(s.pop());case"rgb":return 3!==s.length?null:[Vi(s[0]),Vi(s[1]),Vi(s[2]),a];case"hsla":if(4!==s.length)return null;a=Ui(s.pop());case"hsl":if(3!==s.length)return null;var l=(parseFloat(s[0])%360+360)%360/360,c=Ui(s[1]),u=Ui(s[2]),h=u<=.5?u*(c+1):u+c-u*c,d=2*u-h;return[Ni(255*$i(d,h,l+1/3)),Ni(255*$i(d,h,l)),Ni(255*$i(d,h,l-1/3)),a];default:return null}}return null}}catch(t){}class Gi{constructor(t,e,r,i=1){this.r=t,this.g=e,this.b=r,this.a=i}static parse(e){if(!e)return;if(e instanceof Gi)return e;if("string"!=typeof e)return;const r=t.G(e);return r?new Gi(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){const[t,e,r,i]=0===this.a?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(t)},${Math.round(e)},${Math.round(r)},${i})`}toRenderColor(t){const{r:e,g:r,b:i,a:n}=this;return new Hi(t,e,r,i,n)}}class Hi{constructor(t,e,r,i,n){if(t){const o=t.image.height,s=o*o;e=0===n?0:e/n*(o-1),r=0===n?0:r/n*(o-1),i=0===n?0:i/n*(o-1);const a=Math.floor(e),l=Math.floor(r),c=Math.floor(i),u=Math.ceil(e),h=Math.ceil(r),d=Math.ceil(i),p=e-a,f=r-l,m=i-c,g=t.image.data,y=4*(a+l*s+c*o),v=4*(a+l*s+d*o),_=4*(a+h*s+c*o),b=4*(a+h*s+d*o),x=4*(u+l*s+c*o),w=4*(u+l*s+d*o),T=4*(u+h*s+c*o),E=4*(u+h*s+d*o);if(y<0||E>=g.length)throw new Error("out of range");this.r=qi(qi(qi(g[y],g[v],m),qi(g[_],g[b],m),f),qi(qi(g[x],g[w],m),qi(g[T],g[E],m),f),p)/255*n,this.g=qi(qi(qi(g[y+1],g[v+1],m),qi(g[_+1],g[b+1],m),f),qi(qi(g[x+1],g[w+1],m),qi(g[T+1],g[E+1],m),f),p)/255*n,this.b=qi(qi(qi(g[y+2],g[v+2],m),qi(g[_+2],g[b+2],m),f),qi(qi(g[x+2],g[w+2],m),qi(g[T+2],g[E+2],m),f),p)/255*n,this.a=n}else this.r=e,this.g=r,this.b=i,this.a=n}toArray(){const{r:t,g:e,b:r,a:i}=this;return 0===i?[0,0,0,0]:[255*t/i,255*e/i,255*r/i,i]}toArray01(){const{r:t,g:e,b:r,a:i}=this;return 0===i?[0,0,0,0]:[t/i,e/i,r/i,i]}toArray01Scaled(t){const{r:e,g:r,b:i,a:n}=this;return 0===n?[0,0,0]:[e/n*t,r/n*t,i/n*t]}toArray01PremultipliedAlpha(){const{r:t,g:e,b:r,a:i}=this;return[t,e,r,i]}toArray01Linear(){const{r:t,g:e,b:r,a:i}=this;return 0===i?[0,0,0,0]:[Math.pow(t/i,2.2),Math.pow(e/i,2.2),Math.pow(r/i,2.2),i]}}function qi(t,e,r){return t*(1-r)+e*r}function Wi(t,e,r){return t.map(((t,i)=>qi(t,e[i],r)))}Gi.black=new Gi(0,0,0,1),Gi.white=new Gi(1,1,1,1),Gi.transparent=new Gi(0,0,0,0),Gi.red=new Gi(1,0,0,1),Gi.blue=new Gi(0,0,1,1);var Zi=Object.freeze({__proto__:null,array:Wi,color:function(t,e,r){return new Gi(qi(t.r,e.r,r),qi(t.g,e.g,r),qi(t.b,e.b,r),qi(t.a,e.a,r))},number:qi});function Xi(t,...e){for(const r of e)for(const e in r)t[e]=r[e];return t}class Yi extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}class Ki{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[t,r]of e)this.bindings[t]=r}concat(t){return new Ki(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Ji={kind:"null"},Qi={kind:"number"},tn={kind:"string"},en={kind:"boolean"},rn={kind:"color"},nn={kind:"object"},on={kind:"value"},sn={kind:"collator"},an={kind:"formatted"},ln={kind:"resolvedImage"};function cn(t,e){return{kind:"array",itemType:t,N:e}}function un(t){if("array"===t.kind){const e=un(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const hn=[Ji,Qi,tn,en,rn,an,nn,cn(on),ln];function dn(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!dn(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of hn)if(!dn(t,e))return null}return`Expected ${un(t)} but found ${un(e)} instead.`}function pn(t,e){return e.some((e=>e.kind===t.kind))}function fn(t,e){return e.some((e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t))}class mn{constructor(t,e,r){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class gn{constructor(t,e,r,i,n){this.text=t.normalize?t.normalize():t,this.image=e,this.scale=r,this.fontStack=i,this.textColor=n}}class yn{constructor(t){this.sections=t}static fromString(t){return new yn([new gn(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((t=>0!==t.text.length||t.image&&0!==t.image.namePrimary.length))}static factory(t){return t instanceof yn?t:yn.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map((t=>t.text)).join("")}serialize(){const t=["format"];for(const e of this.sections){if(e.image){t.push(["image",e.image.namePrimary]);continue}t.push(e.text);const r={};e.fontStack&&(r["text-font"]=["literal",e.fontStack.split(",")]),e.scale&&(r["font-scale"]=e.scale),e.textColor&&(r["text-color"]=["rgba"].concat(e.textColor.toRenderColor(null).toArray())),t.push(r)}return t}}class vn{constructor(t){this.namePrimary=t.namePrimary,t.nameSecondary&&(this.nameSecondary=t.nameSecondary),this.available=t.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(t,e){return t?new vn({namePrimary:t,nameSecondary:e,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function _n(t,e,r,i){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:`Invalid rgba value [${[t,e,r,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof i?[t,e,r,i]:[t,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function bn(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof Gi)return!0;if(t instanceof mn)return!0;if(t instanceof yn)return!0;if(t instanceof vn)return!0;if(Array.isArray(t)){for(const e of t)if(!bn(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!bn(t[e]))return!1;return!0}return!1}function xn(t){if(null===t)return Ji;if("string"==typeof t)return tn;if("boolean"==typeof t)return en;if("number"==typeof t)return Qi;if(t instanceof Gi)return rn;if(t instanceof mn)return sn;if(t instanceof yn)return an;if(t instanceof vn)return ln;if(Array.isArray(t)){const e=t.length;let r;for(const e of t){const t=xn(e);if(r){if(r===t)continue;r=on;break}r=t}return cn(r||on,e)}return nn}function wn(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof Gi||t instanceof yn||t instanceof vn?t.toString():JSON.stringify(t)}class Tn{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!bn(t[1]))return e.error("invalid value");const r=t[1];let i=xn(r);const n=e.expectedType;return"array"!==i.kind||0!==i.N||!n||"array"!==n.kind||"number"==typeof n.N&&0!==n.N||(i=n),new Tn(i,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Gi?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof yn?this.value.serialize():this.value}}class En{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Sn={string:tn,number:Qi,boolean:en,object:nn};class Pn{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let r,i=1;const n=t[0];if("array"===n){let n,o;if(t.length>2){const r=t[1];if("string"!=typeof r||!(r in Sn)||"object"===r)return e.error('The item type argument of "array" must be one of string, number, boolean',1);n=Sn[r],i++}else n=on;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);o=t[2],i++}r=cn(n,o)}else r=Sn[n];const o=[];for(;i<t.length;i++){const r=e.parse(t[i],i,on);if(!r)return null;o.push(r)}return new Pn(r,o)}evaluate(t){for(let e=0;e<this.args.length;e++){const r=this.args[e].evaluate(t);if(!dn(this.type,xn(r)))return r;if(e===this.args.length-1)throw new En(`The expression ${JSON.stringify(this.args[e].serialize())} evaluated to ${un(xn(r))} but was expected to be of type ${un(this.type)}.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=this.type,e=[t.kind];if("array"===t.kind){const r=t.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){e.push(r.kind);const i=t.N;("number"==typeof i||this.args.length>1)&&e.push(i)}}return e.concat(this.args.map((t=>t.serialize())))}}class kn{constructor(t){this.type=an,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const r=t[1];if(!Array.isArray(r)&&"object"==typeof r)return e.error("First argument must be an image or text section.");const i=[];let n=!1;for(let r=1;r<=t.length-1;++r){const o=t[r];if(n&&"object"==typeof o&&!Array.isArray(o)){n=!1;let t=null;if(o["font-scale"]&&(t=e.parse(o["font-scale"],1,Qi),!t))return null;let r=null;if(o["text-font"]&&(r=e.parse(o["text-font"],1,cn(tn)),!r))return null;let s=null;if(o["text-color"]&&(s=e.parse(o["text-color"],1,rn),!s))return null;const a=i[i.length-1];a.scale=t,a.font=r,a.textColor=s}else{const o=e.parse(t[r],1,on);if(!o)return null;const s=o.type.kind;if("string"!==s&&"value"!==s&&"null"!==s&&"resolvedImage"!==s)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");n=!0,i.push({content:o,scale:null,font:null,textColor:null})}}return new kn(i)}evaluate(t){return new yn(this.sections.map((e=>{const r=e.content.evaluate(t);return xn(r)===ln?new gn("",r,null,null,null):new gn(wn(r),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const e of this.sections){t.push(e.content.serialize());const r={};e.scale&&(r["font-scale"]=e.scale.serialize()),e.font&&(r["text-font"]=e.font.serialize()),e.textColor&&(r["text-color"]=e.textColor.serialize()),t.push(r)}return t}}class An{constructor(t,e){this.type=ln,this.inputPrimary=t,this.inputSecondary=e}static parse(t,e){if(t.length<2)return e.error("Expected two or more arguments.");const r=e.parse(t[1],1,tn);if(!r)return e.error("No image name provided.");if(2===t.length)return new An(r);const i=e.parse(t[2],1,tn);return i?new An(r,i):e.error("Secondary image variant is not a string.")}evaluate(t){const e=vn.fromString(this.inputPrimary.evaluate(t),this.inputSecondary?this.inputSecondary.evaluate(t):void 0);return e&&t.availableImages&&(e.available=t.availableImages.indexOf(e.namePrimary)>-1,e.nameSecondary&&e.available&&t.availableImages&&(e.available=t.availableImages.indexOf(e.nameSecondary)>-1)),e}eachChild(t){t(this.inputPrimary),this.inputSecondary&&t(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Mn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}const Cn={"to-boolean":en,"to-color":rn,"to-number":Qi,"to-string":tn};class In{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const r=t[0],i=[];let n=Ji;if("to-array"===r){if(!Array.isArray(t[1]))return null;const r=t[1].length;if(e.expectedType){if("array"!==e.expectedType.kind)return e.error(`Expected ${e.expectedType.kind} but found array.`);n=cn(e.expectedType.itemType,r)}else{if(!(r>0&&bn(t[1][0])))return null;n=cn(xn(t[1][0]),r)}for(let o=0;o<r;o++){const r=t[1][o];let s;if("array"===Mn(r))s=e.parse(r,void 0,n.itemType);else{const t=Mn(r);if(t!==n.itemType.kind)return e.error(`Expected ${n.itemType.kind} but found ${t}.`);s=e.registry.literal.parse(["literal",void 0===r?null:r],e)}if(!s)return null;i.push(s)}}else{if(("to-boolean"===r||"to-string"===r)&&2!==t.length)return e.error("Expected one argument.");n=Cn[r];for(let r=1;r<t.length;r++){const n=e.parse(t[r],r,on);if(!n)return null;i.push(n)}}return new In(n,i)}evaluate(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){let e,r;for(const i of this.args){if(e=i.evaluate(t),r=null,e instanceof Gi)return e;if("string"==typeof e){const r=t.parseColor(e);if(r)return r}else if(Array.isArray(e)&&(r=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:_n(e[0],e[1],e[2],e[3]),!r))return new Gi(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new En(r||`Could not parse color from value '${"string"==typeof e?e:String(JSON.stringify(e))}'`)}if("number"===this.type.kind){let e=null;for(const r of this.args){if(e=r.evaluate(t),null===e)return 0;const i=Number(e);if(!isNaN(i))return i}throw new En(`Could not convert ${JSON.stringify(e)} to number.`)}return"formatted"===this.type.kind?yn.fromString(wn(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?vn.fromString(wn(this.args[0].evaluate(t))):"array"===this.type.kind?this.args.map((e=>e.evaluate(t))):wn(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){if("formatted"===this.type.kind)return new kn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new An(this.args[0]).serialize();const t="array"===this.type.kind?[]:[`to-${this.type.kind}`];return this.eachChild((e=>{t.push(e.serialize())})),t}}const On=["Unknown","Point","LineString","Polygon"];class Ln{constructor(t,e){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=t,this.options=e}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?On[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(t){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:r,y:i}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(r*e-t[0])+this.featureDistanceData.bearing[1]*(i*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Gi.parse(t)),e}getConfig(t){return this.options?this.options.get(t):null}}class Dn{constructor(t,e,r,i,n){this.name=t,this.type=e,this._evaluate=r,this.args=i,this._overloadIndex=n}evaluate(t){if(!this._evaluate){const t=Dn.definitions[this.name];this._evaluate=Array.isArray(t)?t[2]:t.overloads[this._overloadIndex][1]}return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((t=>t.serialize())))}static parse(t,e){const r=t[0],i=Dn.definitions[r];if(!i)return e.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);const n=Array.isArray(i)?i[0]:i.type,o=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=[];let a=null,l=-1;for(const[i,c]of o){if(Array.isArray(i)&&i.length!==t.length-1)continue;s.push(i),l++,a=new es(e.registry,e.path,null,e.scope,void 0,e._scope,e.options);const o=[];let u=!1;for(let e=1;e<t.length;e++){const r=t[e],n=Array.isArray(i)?i[e-1]:i.type,s=a.parse(r,1+o.length,n);if(!s){u=!0;break}o.push(s)}if(!u)if(Array.isArray(i)&&i.length!==o.length)a.error(`Expected ${i.length} arguments, but found ${o.length} instead.`);else{for(let t=0;t<o.length;t++){const e=Array.isArray(i)?i[t]:i.type,r=o[t];a.concat(t+1).checkSubtype(e,r.type)}if(0===a.errors.length)return new Dn(r,n,c,o,l)}}if(1===s.length)e.errors.push(...a.errors);else{const r=(s.length?s:o.map((([t])=>t))).map(Rn).join(" | "),i=[];for(let r=1;r<t.length;r++){const n=e.parse(t[r],1+i.length);if(!n)return null;i.push(un(n.type))}e.error(`Expected arguments of type ${r}, but found (${i.join(", ")}) instead.`)}return null}static register(t,e){Dn.definitions=e;for(const r in e)t[r]=Dn}}function Rn(t){return Array.isArray(t)?`(${t.map(un).join(", ")})`:`(${un(t.type)}...)`}class Fn{constructor(t,e,r){this.type=sn,this.locale=r,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const r=t[1];if("object"!=typeof r||Array.isArray(r))return e.error("Collator options argument must be an object.");const i=e.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,en);if(!i)return null;const n=e.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,en);if(!n)return null;let o=null;return r.locale&&(o=e.parse(r.locale,1,tn),!o)?null:new Fn(i,n,o)}evaluate(t){return new mn(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}function Bn(t,e,r=0,i=t.length-1,n=jn){for(;i>r;){if(i-r>600){const o=i-r+1,s=e-r+1,a=Math.log(o),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(o-l)/o)*(s-o/2<0?-1:1);Bn(t,e,Math.max(r,Math.floor(e-s*l/o+c)),Math.min(i,Math.floor(e+(o-s)*l/o+c)),n)}const o=t[e];let s=r,a=i;for(zn(t,r,e),n(t[i],o)>0&&zn(t,r,i);s<a;){for(zn(t,s,a),s++,a--;n(t[s],o)<0;)s++;for(;n(t[a],o)>0;)a--}0===n(t[r],o)?zn(t,r,a):(a++,zn(t,a,i)),a<=e&&(r=a+1),e<=a&&(i=a-1)}}function zn(t,e,r){const i=t[e];t[e]=t[r],t[r]=i}function jn(t,e){return t<e?-1:t>e?1:0}function Nn(t){let e=0;for(let r,i,n=0,o=t.length,s=o-1;n<o;s=n++)r=t[n],i=t[s],e+=(i.x-r.x)*(r.y+i.y);return e}function Vn(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Un(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function $n(t,e,r){const i=t[0]-e[0],n=t[1]-e[1],o=t[0]-r[0],s=t[1]-r[1];return i*s-o*n==0&&i*o<=0&&n*s<=0}function Gn(t,e,r=!1){let i=!1;for(let a=0,l=e.length;a<l;a++){const l=e[a];for(let e=0,a=l.length,c=a-1;e<a;c=e++){const a=l[c],u=l[e];if($n(t,a,u))return r;(o=a)[1]>(n=t)[1]!=(s=u)[1]>n[1]&&n[0]<(s[0]-o[0])*(n[1]-o[1])/(s[1]-o[1])+o[0]&&(i=!i)}}var n,o,s;return i}function Hn(t,e,r,i){const n=i[0]-r[0],o=i[1]-r[1],s=(t[0]-r[0])*o-n*(t[1]-r[1]),a=(e[0]-r[0])*o-n*(e[1]-r[1]);return s>0&&a<0||s<0&&a>0}function qn(t,e,r,i){return 0!=(n=[i[0]-r[0],i[1]-r[1]])[0]*(o=[e[0]-t[0],e[1]-t[1]])[1]-n[1]*o[0]&&!(!Hn(t,e,r,i)||!Hn(r,i,t,e));var n,o}const Wn=8192;function Zn(t,e){const r=(180+t[0])/360,i=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,n=Math.pow(2,e.z);return[Math.round(r*n*Wn),Math.round(i*n*Wn)]}function Xn(t,e){for(let r=0;r<e.length;r++)if(Gn(t,e[r]))return!0;return!1}function Yn(t,e,r){for(const i of r)for(let r=0,n=i.length,o=n-1;r<n;o=r++)if(qn(t,e,i[o],i[r]))return!0;return!1}function Kn(t,e){for(let r=0;r<t.length;++r)if(!Gn(t[r],e))return!1;for(let r=0;r<t.length-1;++r)if(Yn(t[r],t[r+1],e))return!1;return!0}function Jn(t,e){for(let r=0;r<e.length;r++)if(Kn(t,e[r]))return!0;return!1}function Qn(t,e,r){const i=[];for(let n=0;n<t.length;n++){const o=[];for(let i=0;i<t[n].length;i++){const s=Zn(t[n][i],r);Vn(e,s),o.push(s)}i.push(o)}return i}function to(t,e,r){const i=[];for(let n=0;n<t.length;n++){const o=Qn(t[n],e,r);i.push(o)}return i}function eo(t,e,r,i){if(t[0]<r[0]||t[0]>r[2]){const e=.5*i;let n=t[0]-r[0]>e?-i:r[0]-t[0]>e?i:0;0===n&&(n=t[0]-r[2]>e?-i:r[2]-t[0]>e?i:0),t[0]+=n}Vn(e,t)}function ro(t,e,r,i){const n=Math.pow(2,i.z)*Wn,o=[i.x*Wn,i.y*Wn],s=[];if(!t)return s;for(const i of t)for(const t of i){const i=[t.x+o[0],t.y+o[1]];eo(i,e,r,n),s.push(i)}return s}function io(t,e,r,i){const n=Math.pow(2,i.z)*Wn,o=[i.x*Wn,i.y*Wn],s=[];if(!t)return s;for(const r of t){const t=[];for(const i of r){const r=[i.x+o[0],i.y+o[1]];Vn(e,r),t.push(r)}s.push(t)}if(e[2]-e[0]<=n/2){(a=e)[0]=a[1]=1/0,a[2]=a[3]=-1/0;for(const t of s)for(const i of t)eo(i,e,r,n)}var a;return s}class no{constructor(t,e){this.type=en,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(bn(t[1])){const e=t[1];if("FeatureCollection"===e.type)for(let t=0;t<e.features.length;++t){const r=e.features[t].geometry.type;if("Polygon"===r||"MultiPolygon"===r)return new no(e,e.features[t].geometry)}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new no(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new no(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const r=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],n=t.canonicalID();if(!n)return!1;if("Polygon"===e.type){const o=Qn(e.coordinates,i,n),s=ro(t.geometry(),r,i,n);if(!Un(r,i))return!1;for(const t of s)if(!Gn(t,o))return!1}if("MultiPolygon"===e.type){const o=to(e.coordinates,i,n),s=ro(t.geometry(),r,i,n);if(!Un(r,i))return!1;for(const t of s)if(!Xn(t,o))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const r=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],n=t.canonicalID();if(!n)return!1;if("Polygon"===e.type){const o=Qn(e.coordinates,i,n),s=io(t.geometry(),r,i,n);if(!Un(r,i))return!1;for(const t of s)if(!Kn(t,o))return!1}if("MultiPolygon"===e.type){const o=to(e.coordinates,i,n),s=io(t.geometry(),r,i,n);if(!Un(r,i))return!1;for(const t of s)if(!Jn(t,o))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const oo={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},so=1/298.257223563,ao=so*(2-so),lo=Math.PI/180;class co{static fromTile(t,e,r){const i=Math.PI*(1-2*(t+.5)/Math.pow(2,e)),n=Math.atan(.5*(Math.exp(i)-Math.exp(-i)))/lo;return new co(n,r)}static get units(){return oo}constructor(t,e){if(void 0===t)throw new Error("No latitude given.");if(e&&!oo[e])throw new Error(`Unknown unit ${e}. Use one of: ${Object.keys(oo).join(", ")}`);const r=6378.137*lo*(e?oo[e]:1),i=Math.cos(t*lo),n=1/(1-ao*(1-i*i)),o=Math.sqrt(n);this.kx=r*o*i,this.ky=r*o*n*(1-ao)}distance(t,e){const r=po(t[0]-e[0])*this.kx,i=(t[1]-e[1])*this.ky;return Math.sqrt(r*r+i*i)}bearing(t,e){const r=po(e[0]-t[0])*this.kx;return Math.atan2(r,(e[1]-t[1])*this.ky)/lo}destination(t,e,r){const i=r*lo;return this.offset(t,Math.sin(i)*e,Math.cos(i)*e)}offset(t,e,r){return[t[0]+e/this.kx,t[1]+r/this.ky]}lineDistance(t){let e=0;for(let r=0;r<t.length-1;r++)e+=this.distance(t[r],t[r+1]);return e}area(t){let e=0;for(let r=0;r<t.length;r++){const i=t[r];for(let t=0,n=i.length,o=n-1;t<n;o=t++)e+=po(i[t][0]-i[o][0])*(i[t][1]+i[o][1])*(r?-1:1)}return Math.abs(e)/2*this.kx*this.ky}along(t,e){let r=0;if(e<=0)return t[0];for(let i=0;i<t.length-1;i++){const n=t[i],o=t[i+1],s=this.distance(n,o);if(r+=s,r>e)return ho(n,o,(e-(r-s))/s)}return t[t.length-1]}pointToSegmentDistance(t,e,r){let[i,n]=e,o=po(r[0]-i)*this.kx,s=(r[1]-n)*this.ky;if(0!==o||0!==s){const e=(po(t[0]-i)*this.kx*o+(t[1]-n)*this.ky*s)/(o*o+s*s);e>1?(i=r[0],n=r[1]):e>0&&(i+=o/this.kx*e,n+=s/this.ky*e)}return o=po(t[0]-i)*this.kx,s=(t[1]-n)*this.ky,Math.sqrt(o*o+s*s)}pointOnLine(t,e){let r=1/0,i=t[0][0],n=t[0][1],o=0,s=0;for(let a=0;a<t.length-1;a++){let l=t[a][0],c=t[a][1],u=po(t[a+1][0]-l)*this.kx,h=(t[a+1][1]-c)*this.ky,d=0;0===u&&0===h||(d=(po(e[0]-l)*this.kx*u+(e[1]-c)*this.ky*h)/(u*u+h*h),d>1?(l=t[a+1][0],c=t[a+1][1]):d>0&&(l+=u/this.kx*d,c+=h/this.ky*d)),u=po(e[0]-l)*this.kx,h=(e[1]-c)*this.ky;const p=u*u+h*h;p<r&&(r=p,i=l,n=c,o=a,s=d)}return{point:[i,n],index:o,t:Math.max(0,Math.min(1,s))}}lineSlice(t,e,r){let i=this.pointOnLine(r,t),n=this.pointOnLine(r,e);if(i.index>n.index||i.index===n.index&&i.t>n.t){const t=i;i=n,n=t}const o=[i.point],s=i.index+1,a=n.index;!uo(r[s],o[0])&&s<=a&&o.push(r[s]);for(let t=s+1;t<=a;t++)o.push(r[t]);return uo(r[a],n.point)||o.push(n.point),o}lineSliceAlong(t,e,r){let i=0;const n=[];for(let o=0;o<r.length-1;o++){const s=r[o],a=r[o+1],l=this.distance(s,a);if(i+=l,i>t&&0===n.length&&n.push(ho(s,a,(t-(i-l))/l)),i>=e)return n.push(ho(s,a,(e-(i-l))/l)),n;i>t&&n.push(a)}return n}bufferPoint(t,e){const r=e/this.ky,i=e/this.kx;return[t[0]-i,t[1]-r,t[0]+i,t[1]+r]}bufferBBox(t,e){const r=e/this.ky,i=e/this.kx;return[t[0]-i,t[1]-r,t[2]+i,t[3]+r]}insideBBox(t,e){return po(t[0]-e[0])>=0&&po(t[0]-e[2])<=0&&t[1]>=e[1]&&t[1]<=e[3]}}function uo(t,e){return t[0]===e[0]&&t[1]===e[1]}function ho(t,e,r){const i=po(e[0]-t[0]);return[t[0]+i*r,t[1]+(e[1]-t[1])*r]}function po(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}class fo{constructor(t=[],e=((t,e)=>t<e?-1:t>e?1:0)){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:r}=this,i=e[t];for(;t>0;){const n=t-1>>1,o=e[n];if(r(i,o)>=0)break;e[t]=o,t=n}e[t]=i}_down(t){const{data:e,compare:r}=this,i=this.length>>1,n=e[t];for(;t<i;){let i=1+(t<<1);const o=i+1;if(o<this.length&&r(e[o],e[i])<0&&(i=o),r(e[i],n)>=0)break;e[t]=e[i],t=i}e[t]=n}}var mo=8192;function go(t,e){return e.dist-t.dist}const yo=100,vo=50;function _o(t){const e=[1/0,1/0,-1/0,-1/0];if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function bo(t){return t[1]-t[0]+1}function xo(t,e){const r=t[1]>=t[0]&&t[1]<e;return r||console.warn("Distance Expression: Index is out of range"),r}function wo(t,e){if(t[0]>t[1])return[null,null];const r=bo(t);if(e){if(2===r)return[t,null];const e=Math.floor(r/2);return[[t[0],t[0]+e],[t[0]+e,t[1]]]}{if(1===r)return[t,null];const e=Math.floor(r/2)-1;return[[t[0],t[0]+e],[t[0]+e+1,t[1]]]}}function To(t,e){const r=[1/0,1/0,-1/0,-1/0];if(!xo(e,t.length))return r;for(let i=e[0];i<=e[1];++i)Vn(r,t[i]);return r}function Eo(t){const e=[1/0,1/0,-1/0,-1/0];for(let r=0;r<t.length;++r)for(let i=0;i<t[r].length;++i)Vn(e,t[r][i]);return e}function So(t,e,r){if(_o(t)||_o(e))return NaN;let i=0,n=0;return t[2]<e[0]&&(i=e[0]-t[2]),t[0]>e[2]&&(i=t[0]-e[2]),t[1]>e[3]&&(n=t[1]-e[3]),t[3]<e[1]&&(n=e[1]-t[3]),r.distance([0,0],[i,n])}function Po(t){return 360*t-180}function ko(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Ao(t,e){const r=Math.pow(2,e.z),i=(t.y/mo+e.y)/r;return[Po((t.x/mo+e.x)/r),ko(i)]}function Mo(t,e){const r=[];for(let i=0;i<t.length;++i)r.push(Ao(t[i],e));return r}function Co(t,e,r){const i=r.pointOnLine(e,t).point;return r.distance(t,i)}function Io(t,e,r,i,n){const o=r.slice(i[0],i[1]+1);let s=1/0;for(let r=e[0];r<=e[1];++r)if(0===(s=Math.min(s,Co(t[r],o,n))))return 0;return s}function Oo(t,e,r,i,n){const o=Math.min(n.pointToSegmentDistance(t,r,i),n.pointToSegmentDistance(e,r,i)),s=Math.min(n.pointToSegmentDistance(r,t,e),n.pointToSegmentDistance(i,t,e));return Math.min(o,s)}function Lo(t,e,r,i,n){if(!xo(e,t.length)||!xo(i,r.length))return NaN;let o=1/0;for(let s=e[0];s<e[1];++s)for(let e=i[0];e<i[1];++e){if(qn(t[s],t[s+1],r[e],r[e+1]))return 0;o=Math.min(o,Oo(t[s],t[s+1],r[e],r[e+1],n))}return o}function Do(t,e,r,i,n){if(!xo(e,t.length)||!xo(i,r.length))return NaN;let o=1/0;for(let s=e[0];s<=e[1];++s)for(let e=i[0];e<=i[1];++e)if(0===(o=Math.min(o,n.distance(t[s],r[e]))))return o;return o}function Ro(t,e,r){if(Gn(t,e,!0))return 0;let i=1/0;for(const n of e){const e=n.length;if(e<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(n[0]!==n[e-1]&&0===(i=Math.min(i,r.pointToSegmentDistance(t,n[e-1],n[0]))))return i;if(0===(i=Math.min(i,Co(t,n,r))))return i}return i}function Fo(t,e,r,i){if(!xo(e,t.length))return NaN;for(let i=e[0];i<=e[1];++i)if(Gn(t[i],r,!0))return 0;let n=1/0;for(let o=e[0];o<e[1];++o)for(const e of r)for(let r=0,s=e.length,a=s-1;r<s;a=r++){if(qn(t[o],t[o+1],e[a],e[r]))return 0;n=Math.min(n,Oo(t[o],t[o+1],e[a],e[r],i))}return n}function Bo(t,e){for(const r of t)for(let t=0;t<=r.length-1;++t)if(Gn(r[t],e,!0))return!0;return!1}function zo(t,e,r,i=1/0){const n=Eo(t),o=Eo(e);if(i!==1/0&&So(n,o,r)>=i)return i;if(Un(n,o)){if(Bo(t,e))return 0}else if(Bo(e,t))return 0;let s=i;for(const i of t)for(let t=0,n=i.length,o=n-1;t<n;o=t++)for(const n of e)for(let e=0,a=n.length,l=a-1;e<a;l=e++){if(qn(i[o],i[t],n[l],n[e]))return 0;s=Math.min(s,Oo(i[o],i[t],n[l],n[e],r))}return s}function jo(t,e,r,i,n,o,s){if(null===o||null===s)return;const a=So(To(i,o),To(n,s),r);a<e&&t.push({dist:a,range1:o,range2:s})}function No(t,e,r,i,n=1/0){let o=Math.min(i.distance(t[0],r[0][0]),n);if(0===o)return o;const s=new fo([{dist:0,range1:[0,t.length-1],range2:[0,0]}],go),a=e?vo:yo,l=Eo(r);for(;s.length;){const n=s.pop();if(n.dist>=o)continue;const c=n.range1;if(bo(c)<=a){if(!xo(c,t.length))return NaN;if(e){const e=Fo(t,c,r,i);if(0===(o=Math.min(o,e)))return o}else for(let e=c[0];e<=c[1];++e){const n=Ro(t[e],r,i);if(0===(o=Math.min(o,n)))return o}}else{const r=wo(c,e);if(null!==r[0]){const e=So(To(t,r[0]),l,i);e<o&&s.push({dist:e,range1:r[0],range2:[0,0]})}if(null!==r[1]){const e=So(To(t,r[1]),l,i);e<o&&s.push({dist:e,range1:r[1],range2:[0,0]})}}}return o}function Vo(t,e,r,i,n,o=1/0){let s=Math.min(o,n.distance(t[0],r[0]));if(0===s)return s;const a=new fo([{dist:0,range1:[0,t.length-1],range2:[0,r.length-1]}],go),l=e?vo:yo,c=i?vo:yo;for(;a.length;){const o=a.pop();if(o.dist>=s)continue;const u=o.range1,h=o.range2;if(bo(u)<=l&&bo(h)<=c){if(!xo(u,t.length)||!xo(h,r.length))return NaN;if(e&&i?s=Math.min(s,Lo(t,u,r,h,n)):e||i?e&&!i?s=Math.min(s,Io(r,h,t,u,n)):!e&&i&&(s=Math.min(s,Io(t,u,r,h,n))):s=Math.min(s,Do(t,u,r,h,n)),0===s)return s}else{const o=wo(u,e),l=wo(h,i);jo(a,s,n,t,r,o[0],l[0]),jo(a,s,n,t,r,o[0],l[1]),jo(a,s,n,t,r,o[1],l[0]),jo(a,s,n,t,r,o[1],l[1])}}return s}function Uo(t,e,r,i,n=1/0){let o=n;const s=To(t,[0,t.length-1]);for(const n of r)if(!(o!==1/0&&So(s,To(n,[0,n.length-1]),i)>=o)&&(o=Math.min(o,Vo(t,e,n,!0,i,o)),0===o))return o;return o}function $o(t,e,r,i,n=1/0){let o=n;const s=To(t,[0,t.length-1]);for(const n of r){if(o!==1/0&&So(s,Eo(n),i)>=o)continue;const r=No(t,e,n,i,o);if(isNaN(r))return r;if(0===(o=Math.min(o,r)))return o}return o}function Go(t){return"Point"===t||"MultiPoint"===t||"LineString"===t||"MultiLineString"===t||"Polygon"===t||"MultiPolygon"===t}class Ho{constructor(t,e){this.type=Qi,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(bn(t[1])){const e=t[1];if("FeatureCollection"===e.type){for(let t=0;t<e.features.length;++t)if(Go(e.features[t].geometry.type))return new Ho(e,e.features[t].geometry)}else if("Feature"===e.type){if(Go(e.geometry.type))return new Ho(e,e.geometry)}else if(Go(e.type))return new Ho(e,e)}return e.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const e=t.geometry(),r=t.canonicalID();if(null!=e&&null!=r){if("Point"===t.geometryType())return function(t,e,r){const i=[];for(const r of t)for(const t of r)i.push(Ao(t,e));const n=new co(i[0][1],"meters");return"Point"===r.type||"MultiPoint"===r.type||"LineString"===r.type?Vo(i,!1,"Point"===r.type?[r.coordinates]:r.coordinates,"LineString"===r.type,n):"MultiLineString"===r.type?Uo(i,!1,r.coordinates,n):"Polygon"===r.type||"MultiPolygon"===r.type?$o(i,!1,"Polygon"===r.type?[r.coordinates]:r.coordinates,n):null}(e,r,this.geometries);if("LineString"===t.geometryType())return function(t,e,r){const i=[];for(const r of t){const t=[];for(const i of r)t.push(Ao(i,e));i.push(t)}const n=new co(i[0][0][1],"meters");if("Point"===r.type||"MultiPoint"===r.type||"LineString"===r.type)return Uo("Point"===r.type?[r.coordinates]:r.coordinates,"LineString"===r.type,i,n);if("MultiLineString"===r.type){let t=1/0;for(let e=0;e<r.coordinates.length;e++){const o=Uo(r.coordinates[e],!0,i,n,t);if(isNaN(o))return o;if(0===(t=Math.min(t,o)))return t}return t}if("Polygon"===r.type||"MultiPolygon"===r.type){let t=1/0;for(let e=0;e<i.length;e++){const o=$o(i[e],!0,"Polygon"===r.type?[r.coordinates]:r.coordinates,n,t);if(isNaN(o))return o;if(0===(t=Math.min(t,o)))return t}return t}return null}(e,r,this.geometries);if("Polygon"===t.geometryType())return function(t,e,r){const i=[];for(const r of function(t,e){const r=t.length;if(r<=1)return[t];const i=[];let n,o;for(let e=0;e<r;e++){const r=Nn(t[e]);0!==r&&(t[e].area=Math.abs(r),void 0===o&&(o=r<0),o===r<0?(n&&i.push(n),n=[t[e]]):n.push(t[e]))}return n&&i.push(n),i}(t)){const t=[];for(let i=0;i<r.length;++i)t.push(Mo(r[i],e));i.push(t)}const n=new co(i[0][0][0][1],"meters");if("Point"===r.type||"MultiPoint"===r.type||"LineString"===r.type)return $o("Point"===r.type?[r.coordinates]:r.coordinates,"LineString"===r.type,i,n);if("MultiLineString"===r.type){let t=1/0;for(let e=0;e<r.coordinates.length;e++){const o=$o(r.coordinates[e],!0,i,n,t);if(isNaN(o))return o;if(0===(t=Math.min(t,o)))return t}return t}return"Polygon"===r.type||"MultiPolygon"===r.type?function(t,e,r){let i=1/0;for(const n of t)for(const t of e){const e=zo(n,t,r,i);if(isNaN(e))return e;if(0===(i=Math.min(i,e)))return i}return i}("Polygon"===r.type?[r.coordinates]:r.coordinates,i,n):null}(e,r,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function qo(t,e){switch(t){case"string":return wn(e);case"number":return+e;case"boolean":return!!e;case"color":return Gi.parse(e);case"formatted":return yn.fromString(wn(e));case"resolvedImage":return vn.fromString(wn(e))}return e}function Wo(t,e,r,i){return void 0!==i&&(t=i*Math.round(t/i)),void 0!==e&&t<e&&(t=e),void 0!==r&&t>r&&(t=r),t}class Zo{constructor(t,e,r){this.type=t,this.key=e,this.scope=r}static parse(t,e){let r=e.expectedType;if(null==r&&(r=on),t.length<2||t.length>3)return e.error("Invalid number of arguments for 'config' expression.");const i=e.parse(t[1],1);if(!(i instanceof Tn))return e.error("Key name of 'config' expression must be a string literal.");if(t.length>=3){const n=e.parse(t[2],2);return n instanceof Tn?new Zo(r,wn(i.value),wn(n.value)):e.error("Scope of 'config' expression must be a string literal.")}return new Zo(r,wn(i.value))}evaluate(t){const e=[this.key,this.scope,t.scope].filter(Boolean).join(""),r=t.getConfig(e);if(!r)return null;const{type:i,value:n,values:o,minValue:s,maxValue:a,stepValue:l}=r,c=r.default.evaluate(t);let u=c;if(n){const e=t.scope;t.scope=(e||"").split("").slice(1).join(""),u=n.evaluate(t),t.scope=e}return i&&(u=qo(i,u)),void 0===u||void 0===s&&void 0===a&&void 0===l||("number"==typeof u?u=Wo(u,s,a,l):Array.isArray(u)&&(u=u.map((t=>"number"==typeof t?Wo(t,s,a,l):t)))),void 0!==n&&void 0!==u&&o&&!o.includes(u)&&(u=c,i&&(u=qo(i,u))),(i&&i!==this.type||void 0!==u&&xn(u)!==this.type)&&(u=qo(this.type.kind,u)),u}eachChild(){}outputDefined(){return!1}serialize(){const t=["config",this.key];return this.scope&&t.concat(this.key),t}}function Xo(t){if(t instanceof Dn){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof no)return!1;if(t instanceof Ho)return!1;let e=!0;return t.eachChild((t=>{e&&!Xo(t)&&(e=!1)})),e}function Yo(t){if(t instanceof Dn&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild((t=>{e&&!Yo(t)&&(e=!1)})),e}function Ko(t){if(t instanceof Zo)return new Set([t.key]);let e=new Set;return t.eachChild((t=>{e=new Set([...e,...Ko(t)])})),e}function Jo(t,e){if(t instanceof Dn&&e.indexOf(t.name)>=0)return!1;let r=!0;return t.eachChild((t=>{r&&!Jo(t,e)&&(r=!1)})),r}class Qo{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const r=t[1];return e.scope.has(r)?new Qo(r,e.scope.get(r)):e.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class ts{constructor(t,e=[],r,i=new Ki,n=[],o,s){this.registry=t,this.path=e,this.key=e.map((t=>`[${t}]`)).join(""),this.scope=i,this.errors=n,this.expectedType=r,this._scope=o,this.options=s}parse(t,e,r,i,n={}){return e||r?this.concat(e,r,i)._parse(t,n):this._parse(t,n)}_parse(t,e){function r(t,e,r){return"assert"===r?new Pn(e,[t]):"coerce"===r?new In(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const i="string"==typeof t[0]?this.registry[t[0]]:void 0;if(i){let n=i.parse(t,this);if(!n)return null;if(this.expectedType){const t=this.expectedType,i=n.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==i.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==i.kind&&"string"!==i.kind){if(this.checkSubtype(t,i))return null}else n=r(n,t,e.typeAnnotation||"coerce");else n=r(n,t,e.typeAnnotation||"assert")}if(!(n instanceof Tn)&&"resolvedImage"!==n.type.kind&&rs(n)){const e=new Ln(this._scope,this.options);try{n=new Tn(n.type,n.evaluate(e))}catch(t){return this.error(t.message),null}}return n}return In.parse(["to-array",t],this)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,e,r){const i="number"==typeof t?this.path.concat(t):this.path,n=r?this.scope.concat(r):this.scope;return new ts(this.registry,i,e||null,n,this.errors,this._scope,this.options)}error(t,...e){const r=`${this.key}${e.map((t=>`[${t}]`)).join("")}`;this.errors.push(new Yi(r,t))}checkSubtype(t,e){const r=dn(t,e);return r&&this.error(r),r}}var es=ts;function rs(t){if(t instanceof Qo)return rs(t.boundExpression);if(t instanceof Dn&&"error"===t.name)return!1;if(t instanceof Fn)return!1;if(t instanceof no)return!1;if(t instanceof Ho)return!1;if(t instanceof Zo)return!1;const e=t instanceof In||t instanceof Pn;let r=!0;return t.eachChild((t=>{r=e?r&&rs(t):r&&t instanceof Tn})),!!r&&Xo(t)&&Jo(t,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function is(t,e){const r=t.length-1;let i,n,o=0,s=r,a=0;for(;o<=s;)if(a=Math.floor((o+s)/2),i=t[a],n=t[a+1],i<=e){if(a===r||e<n)return a;o=a+1}else{if(!(i>e))throw new En("Input is not a number.");s=a-1}return 0}class ns{constructor(t,e,r){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[t,e]of r)this.labels.push(t),this.outputs.push(e)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const r=e.parse(t[1],1,Qi);if(!r)return null;const i=[];let n=null;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(let r=1;r<t.length;r+=2){const o=1===r?-1/0:t[r],s=t[r+1],a=r,l=r+1;if("number"!=typeof o)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(i.length&&i[i.length-1][0]>=o)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);const c=e.parse(s,l,n);if(!c)return null;n=n||c.type,i.push([o,c])}return new ns(n,r,i)}evaluate(t){const e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);const i=this.input.evaluate(t);if(i<=e[0])return r[0].evaluate(t);const n=e.length;return i>=e[n-1]?r[n-1].evaluate(t):r[is(e,i)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){const t=["step",this.input.serialize()];for(let e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t}}const os=.95047,ss=1.08883,as=4/29,ls=6/29,cs=3*ls*ls,us=ls*ls*ls,hs=Math.PI/180,ds=180/Math.PI;function ps(t){return t>us?Math.pow(t,1/3):t/cs+as}function fs(t){return t>ls?t*t*t:cs*(t-as)}function ms(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function gs(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ys(t){const e=gs(t.r),r=gs(t.g),i=gs(t.b),n=ps((.4124564*e+.3575761*r+.1804375*i)/os),o=ps((.2126729*e+.7151522*r+.072175*i)/1);return{l:116*o-16,a:500*(n-o),b:200*(o-ps((.0193339*e+.119192*r+.9503041*i)/ss)),alpha:t.a}}function vs(t){let e=(t.l+16)/116,r=isNaN(t.a)?e:e+t.a/500,i=isNaN(t.b)?e:e-t.b/200;return e=1*fs(e),r=os*fs(r),i=ss*fs(i),new Gi(ms(3.2404542*r-1.5371385*e-.4985314*i),ms(-.969266*r+1.8760108*e+.041556*i),ms(.0556434*r-.2040259*e+1.0572252*i),t.alpha)}function _s(t,e,r){const i=e-t;return t+r*(i>180||i<-180?i-360*Math.round(i/360):i)}const bs={forward:ys,reverse:vs,interpolate:function(t,e,r){return{l:qi(t.l,e.l,r),a:qi(t.a,e.a,r),b:qi(t.b,e.b,r),alpha:qi(t.alpha,e.alpha,r)}}},xs={forward:function(t){const{l:e,a:r,b:i}=ys(t),n=Math.atan2(i,r)*ds;return{h:n<0?n+360:n,c:Math.sqrt(r*r+i*i),l:e,alpha:t.a}},reverse:function(t){const e=t.h*hs,r=t.c;return vs({l:t.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:t.alpha})},interpolate:function(t,e,r){return{h:_s(t.h,e.h,r),c:qi(t.c,e.c,r),l:qi(t.l,e.l,r),alpha:qi(t.alpha,e.alpha,r)}}};var ws=Object.freeze({__proto__:null,hcl:xs,lab:bs});class Ts{constructor(t,e,r,i,n){this.type=t,this.operator=e,this.interpolation=r,this.input=i,this.labels=[],this.outputs=[];for(const[t,e]of n)this.labels.push(t),this.outputs.push(e)}static interpolationFactor(t,e,r,i){let n=0;if("exponential"===t.name)n=Es(e,t.base,r,i);else if("linear"===t.name)n=Es(e,1,r,i);else if("cubic-bezier"===t.name){const o=t.controlPoints;n=new ze(o[0],o[1],o[2],o[3]).solve(Es(e,1,r,i))}return n}static parse(t,e){let[r,i,n,...o]=t;if(!Array.isArray(i)||0===i.length)return e.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){const t=i[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:t}}else{if("cubic-bezier"!==i[0])return e.error(`Unknown interpolation type ${String(i[0])}`,1,0);{const t=i.slice(1);if(4!==t.length||t.some((t=>"number"!=typeof t||t<0||t>1)))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(n=e.parse(n,2,Qi),!n)return null;const s=[];let a=null;"interpolate-hcl"===r||"interpolate-lab"===r?a=rn:e.expectedType&&"value"!==e.expectedType.kind&&(a=e.expectedType);for(let t=0;t<o.length;t+=2){const r=o[t],i=o[t+1],n=t+3,l=t+4;if("number"!=typeof r)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',n);if(s.length&&s[s.length-1][0]>=r)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',n);const c=e.parse(i,l,a);if(!c)return null;a=a||c.type,s.push([r,c])}return"number"===a.kind||"color"===a.kind||"array"===a.kind&&"number"===a.itemType.kind&&"number"==typeof a.N?new Ts(a,r,i,n,s):e.error(`Type ${un(a)} is not interpolatable.`)}evaluate(t){const e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);const i=this.input.evaluate(t);if(i<=e[0])return r[0].evaluate(t);const n=e.length;if(i>=e[n-1])return r[n-1].evaluate(t);const o=is(e,i),s=Ts.interpolationFactor(this.interpolation,i,e[o],e[o+1]),a=r[o].evaluate(t),l=r[o+1].evaluate(t);return"interpolate"===this.operator?Zi[this.type.kind.toLowerCase()](a,l,s):"interpolate-hcl"===this.operator?xs.reverse(xs.interpolate(xs.forward(a),xs.forward(l),s)):bs.reverse(bs.interpolate(bs.forward(a),bs.forward(l),s))}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){let t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const e=[this.operator,t,this.input.serialize()];for(let t=0;t<this.labels.length;t++)e.push(this.labels[t],this.outputs[t].serialize());return e}}function Es(t,e,r,i){const n=i-r,o=t-r;return 0===n?0:1===e?o/n:(Math.pow(e,o)-1)/(Math.pow(e,n)-1)}class Ss{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let r=null;const i=e.expectedType;i&&"value"!==i.kind&&(r=i);const n=[];for(const i of t.slice(1)){const t=e.parse(i,1+n.length,r,void 0,{typeAnnotation:"omit"});if(!t)return null;r=r||t.type,n.push(t)}const o=i&&n.some((t=>dn(i,t.type)));return new Ss(o?on:r,n)}evaluate(t){let e,r=null,i=0;for(const n of this.args){if(i++,r=n.evaluate(t),r&&r instanceof vn&&!r.available&&(e||(e=r),r=null,i===this.args.length))return e;if(null!==r)break}return r}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=["coalesce"];return this.eachChild((e=>{t.push(e.serialize())})),t}}class Ps{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const r=[];for(let i=1;i<t.length-1;i+=2){const n=t[i];if("string"!=typeof n)return e.error(`Expected string, but found ${typeof n} instead.`,i);if(/[^a-zA-Z0-9_]/.test(n))return e.error("Variable names must contain only alphanumeric characters or '_'.",i);const o=e.parse(t[i+1],i+1);if(!o)return null;r.push([n,o])}const i=e.parse(t[t.length-1],t.length-1,e.expectedType,r);return i?new Ps(r,i):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[e,r]of this.bindings)t.push(e,r.serialize());return t.push(this.result.serialize()),t}}class ks{constructor(t,e,r){this.type=t,this.index=e,this.input=r}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const r=e.parse(t[1],1,Qi),i=e.parse(t[2],2,cn(e.expectedType||on));return r&&i?new ks(i.type.itemType,r,i):null}evaluate(t){const e=this.index.evaluate(t),r=this.input.evaluate(t);if(e<0)throw new En(`Array index out of bounds: ${e} < 0.`);if(e>=r.length)throw new En(`Array index out of bounds: ${e} > ${r.length-1}.`);if(e!==Math.floor(e))throw new En(`Array index must be an integer, but found ${e} instead.`);return r[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class As{constructor(t,e){this.type=en,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const r=e.parse(t[1],1,on),i=e.parse(t[2],2,on);return r&&i?pn(r.type,[en,tn,Qi,Ji,on])?new As(r,i):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${un(r.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(null==r)return!1;if(!fn(e,["boolean","string","number","null"]))throw new En(`Expected first argument to be of type boolean, string, number or null, but found ${un(xn(e))} instead.`);if(!fn(r,["string","array"]))throw new En(`Expected second argument to be of type array or string, but found ${un(xn(r))} instead.`);return r.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Ms{constructor(t,e,r){this.type=Qi,this.needle=t,this.haystack=e,this.fromIndex=r}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const r=e.parse(t[1],1,on),i=e.parse(t[2],2,on);if(!r||!i)return null;if(!pn(r.type,[en,tn,Qi,Ji,on]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${un(r.type)} instead`);if(4===t.length){const n=e.parse(t[3],3,Qi);return n?new Ms(r,i,n):null}return new Ms(r,i)}evaluate(t){const e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!fn(e,["boolean","string","number","null"]))throw new En(`Expected first argument to be of type boolean, string, number or null, but found ${un(xn(e))} instead.`);if(!fn(r,["string","array"]))throw new En(`Expected second argument to be of type array or string, but found ${un(xn(r))} instead.`);if(this.fromIndex){const i=this.fromIndex.evaluate(t);return r.indexOf(e,i)}return r.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Cs{constructor(t,e,r,i,n,o){this.inputType=t,this.type=e,this.input=r,this.cases=i,this.outputs=n,this.otherwise=o}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let r,i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);const n={},o=[];for(let s=2;s<t.length-1;s+=2){let a=t[s];const l=t[s+1];Array.isArray(a)||(a=[a]);const c=e.concat(s);if(0===a.length)return c.error("Expected at least one branch label.");for(const t of a){if("number"!=typeof t&&"string"!=typeof t)return c.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof t&&Math.floor(t)!==t)return c.error("Numeric branch labels must be integer values.");if(r){if(c.checkSubtype(r,xn(t)))return null}else r=xn(t);if(void 0!==n[String(t)])return c.error("Branch labels must be unique.");n[String(t)]=o.length}const u=e.parse(l,s,i);if(!u)return null;i=i||u.type,o.push(u)}const s=e.parse(t[1],1,on);if(!s)return null;const a=e.parse(t[t.length-1],t.length-1,i);return a?"value"!==s.type.kind&&e.concat(1).checkSubtype(r,s.type)?null:new Cs(r,i,s,n,o,a):null}evaluate(t){const e=this.input.evaluate(t);return(xn(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],e=Object.keys(this.cases).sort(),r=[],i={};for(const t of e){const e=i[this.cases[t]];void 0===e?(i[this.cases[t]]=r.length,r.push([this.cases[t],[t]])):r[e][1].push(t)}const n=t=>"number"===this.inputType.kind?Number(t):t;for(const[e,i]of r)t.push(1===i.length?n(i[0]):i.map(n)),t.push(this.outputs[e].serialize());return t.push(this.otherwise.serialize()),t}}class Is{constructor(t,e,r){this.type=t,this.branches=e,this.otherwise=r}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);const i=[];for(let n=1;n<t.length-1;n+=2){const o=e.parse(t[n],n,en);if(!o)return null;const s=e.parse(t[n+1],n+1,r);if(!s)return null;i.push([o,s]),r=r||s.type}const n=e.parse(t[t.length-1],t.length-1,r);return n?new Is(r,i,n):null}evaluate(t){for(const[e,r]of this.branches)if(e.evaluate(t))return r.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,r]of this.branches)t(e),t(r);t(this.otherwise)}outputDefined(){return this.branches.every((([t,e])=>e.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild((e=>{t.push(e.serialize())})),t}}class Os{constructor(t,e,r,i){this.type=t,this.input=e,this.beginIndex=r,this.endIndex=i}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const r=e.parse(t[1],1,on),i=e.parse(t[2],2,Qi);if(!r||!i)return null;if(!pn(r.type,[cn(on),tn,on]))return e.error(`Expected first argument to be of type array or string, but found ${un(r.type)} instead`);if(4===t.length){const n=e.parse(t[3],3,Qi);return n?new Os(r.type,r,i,n):null}return new Os(r.type,r,i)}evaluate(t){const e=this.input.evaluate(t),r=this.beginIndex.evaluate(t);if(!fn(e,["string","array"]))throw new En(`Expected first argument to be of type array or string, but found ${un(xn(e))} instead.`);if(this.endIndex){const i=this.endIndex.evaluate(t);return e.slice(r,i)}return e.slice(r)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Ls(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Ds(t,e,r,i){return 0===i.compare(e,r)}function Rs(t,e,r){const i="=="!==t&&"!="!==t;return class n{constructor(t,e,r){this.type=en,this.lhs=t,this.rhs=e,this.collator=r,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const r=t[0];let o=e.parse(t[1],1,on);if(!o)return null;if(!Ls(r,o.type))return e.concat(1).error(`"${r}" comparisons are not supported for type '${un(o.type)}'.`);let s=e.parse(t[2],2,on);if(!s)return null;if(!Ls(r,s.type))return e.concat(2).error(`"${r}" comparisons are not supported for type '${un(s.type)}'.`);if(o.type.kind!==s.type.kind&&"value"!==o.type.kind&&"value"!==s.type.kind)return e.error(`Cannot compare types '${un(o.type)}' and '${un(s.type)}'.`);i&&("value"===o.type.kind&&"value"!==s.type.kind?o=new Pn(s.type,[o]):"value"!==o.type.kind&&"value"===s.type.kind&&(s=new Pn(o.type,[s])));let a=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==s.type.kind&&"value"!==o.type.kind&&"value"!==s.type.kind)return e.error("Cannot use collator to compare non-string types.");if(a=e.parse(t[3],3,sn),!a)return null}return new n(o,s,a)}evaluate(n){const o=this.lhs.evaluate(n),s=this.rhs.evaluate(n);if(i&&this.hasUntypedArgument){const e=xn(o),r=xn(s);if(e.kind!==r.kind||"string"!==e.kind&&"number"!==e.kind)throw new En(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${e.kind}, ${r.kind}) instead.`)}if(this.collator&&!i&&this.hasUntypedArgument){const t=xn(o),r=xn(s);if("string"!==t.kind||"string"!==r.kind)return e(n,o,s)}return this.collator?r(n,o,s,this.collator.evaluate(n)):e(n,o,s)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}serialize(){const e=[t];return this.eachChild((t=>{e.push(t.serialize())})),e}}}const Fs=Rs("==",(function(t,e,r){return e===r}),Ds),Bs=Rs("!=",(function(t,e,r){return e!==r}),(function(t,e,r,i){return!Ds(0,e,r,i)})),zs=Rs("<",(function(t,e,r){return e<r}),(function(t,e,r,i){return i.compare(e,r)<0})),js=Rs(">",(function(t,e,r){return e>r}),(function(t,e,r,i){return i.compare(e,r)>0})),Ns=Rs("<=",(function(t,e,r){return e<=r}),(function(t,e,r,i){return i.compare(e,r)<=0})),Vs=Rs(">=",(function(t,e,r){return e>=r}),(function(t,e,r,i){return i.compare(e,r)>=0}));class Us{constructor(t,e,r,i,n,o){this.type=tn,this.number=t,this.locale=e,this.currency=r,this.unit=i,this.minFractionDigits=n,this.maxFractionDigits=o}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const r=e.parse(t[1],1,Qi);if(!r)return null;const i=t[2];if("object"!=typeof i||Array.isArray(i))return e.error("NumberFormat options argument must be an object.");let n=null;if(i.locale&&(n=e.parse(i.locale,1,tn),!n))return null;let o=null;if(i.currency&&(o=e.parse(i.currency,1,tn),!o))return null;let s=null;if(i.unit&&(s=e.parse(i.unit,1,tn),!s))return null;let a=null;if(i["min-fraction-digits"]&&(a=e.parse(i["min-fraction-digits"],1,Qi),!a))return null;let l=null;return i["max-fraction-digits"]&&(l=e.parse(i["max-fraction-digits"],1,Qi),!l)?null:new Us(r,n,o,s,a,l)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class $s{constructor(t){this.type=Qi,this.input=t}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const r=e.parse(t[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?e.error(`Expected argument of type string or array, but found ${un(r.type)} instead.`):new $s(r):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new En(`Expected value to be of type string or array, but found ${un(xn(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild((e=>{t.push(e.serialize())})),t}}function Gs(t){return function(){t=1831565813+(t|=0)|0;let e=Math.imul(t^t>>>15,1|t);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296}}const Hs={"==":Fs,"!=":Bs,">":js,"<":zs,">=":Vs,"<=":Ns,array:Pn,at:ks,boolean:Pn,case:Is,coalesce:Ss,collator:Fn,format:kn,image:An,in:As,"index-of":Ms,interpolate:Ts,"interpolate-hcl":Ts,"interpolate-lab":Ts,length:$s,let:Ps,literal:Tn,match:Cs,number:Pn,"number-format":Us,object:Pn,slice:Os,step:ns,string:Pn,"to-boolean":In,"to-color":In,"to-number":In,"to-string":In,var:Qo,within:no,distance:Ho,config:Zo};function qs(t,[e,r,i,n]){e=e.evaluate(t),r=r.evaluate(t),i=i.evaluate(t);const o=n?n.evaluate(t):1,s=_n(e,r,i,o);if(s)throw new En(s);return new Gi(e/255*o,r/255*o,i/255*o,o)}function Ws(t,[e,r,i,n]){e=e.evaluate(t),r=r.evaluate(t),i=i.evaluate(t);const o=n?n.evaluate(t):1,s=function(t,e,r,i){return"number"==typeof t&&t>=0&&t<=360?"number"==typeof e&&e>=0&&e<=100&&"number"==typeof r&&r>=0&&r<=100?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:`Invalid hsla value [${[t,e,r,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${("number"==typeof i?[t,e,r,i]:[t,e,r]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${("number"==typeof i?[t,e,r,i]:[t,e,r]).join(", ")}]: 'h' must be between 0 and 360.`}(e,r,i,o);if(s)throw new En(s);const a=`hsla(${e}, ${r}%, ${i}%, ${o})`,l=Gi.parse(a);if(!l)throw new En(`Failed to parse HSLA color: ${a}`);return l}function Zs(t,e){return t in e}function Xs(t,e){const r=e[t];return void 0===r?null:r}function Ys(t){return{type:t}}function Ks(t){return{result:"success",value:t}}function Js(t){return{result:"error",value:t}}function Qs(t,e){return!!t&&!!t.parameters&&t.parameters.indexOf(e)>-1}function ta(t){return"data-driven"===t["property-type"]}function ea(t){return Qs(t.expression,"measure-light")}function ra(t){return Qs(t.expression,"zoom")}function ia(t){return!!t.expression&&t.expression.interpolated}function na(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function oa(t){return t}function sa(t,e){const r="color"===e.type,i=t.stops&&"object"==typeof t.stops[0][0],n=i||!(i||void 0!==t.property),o=t.type||(ia(e)?"exponential":"interval");if(r&&((t=Xi({},t)).stops&&(t.stops=t.stops.map((t=>[t[0],Gi.parse(t[1])]))),t.default=Gi.parse(t.default?t.default:e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!ws[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let s,a,l;if("exponential"===o)s=ua;else if("interval"===o)s=ca;else if("categorical"===o){s=la,a=Object.create(null);for(const e of t.stops)a[e[0]]=e[1];l=typeof t.stops[0][0]}else{if("identity"!==o)throw new Error(`Unknown function type "${o}"`);s=ha}if(i){const r={},i=[];for(let e=0;e<t.stops.length;e++){const n=t.stops[e],o=n[0].zoom;void 0===r[o]&&(r[o]={zoom:o,type:t.type,property:t.property,default:t.default,stops:[]},i.push(o)),r[o].stops.push([n[0].value,n[1]])}const n=[];for(const t of i)n.push([r[t].zoom,sa(r[t],e)]);const o={name:"linear"};return{kind:"composite",interpolationType:o,interpolationFactor:Ts.interpolationFactor.bind(void 0,o),zoomStops:n.map((t=>t[0])),evaluate:({zoom:r},i)=>ua({stops:n,base:t.base},e,r).evaluate(r,i)}}if(n){const r="exponential"===o?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:r,interpolationFactor:Ts.interpolationFactor.bind(void 0,r),zoomStops:t.stops.map((t=>t[0])),evaluate:({zoom:r})=>s(t,e,r,a,l)}}return{kind:"source",evaluate(r,i){const n=i&&i.properties?i.properties[t.property]:void 0;return void 0===n?aa(t.default,e.default):s(t,e,n,a,l)}}}function aa(t,e,r){return void 0!==t?t:void 0!==e?e:void 0!==r?r:void 0}function la(t,e,r,i,n){return aa(typeof r===n?i[r]:void 0,t.default,e.default)}function ca(t,e,r){if("number"!==Mn(r))return aa(t.default,e.default);const i=t.stops.length;if(1===i)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];const n=is(t.stops.map((t=>t[0])),r);return t.stops[n][1]}function ua(t,e,r){const i=void 0!==t.base?t.base:1;if("number"!==Mn(r))return aa(t.default,e.default);const n=t.stops.length;if(1===n)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];const o=is(t.stops.map((t=>t[0])),r),s=function(t,e,r,i){const n=i-r,o=t-r;return 0===n?0:1===e?o/n:(Math.pow(e,o)-1)/(Math.pow(e,n)-1)}(r,i,t.stops[o][0],t.stops[o+1][0]),a=t.stops[o][1],l=t.stops[o+1][1];let c=Zi[e.type]||oa;if(t.colorSpace&&"rgb"!==t.colorSpace){const e=ws[t.colorSpace];c=(t,r)=>e.reverse(e.interpolate(e.forward(t),e.forward(r),s))}return"function"==typeof a.evaluate?{evaluate(...t){const e=a.evaluate.apply(void 0,t),r=l.evaluate.apply(void 0,t);if(void 0!==e&&void 0!==r)return c(e,r,s)}}:c(a,l,s)}function ha(t,e,r){return"color"===e.type?r=Gi.parse(r):"formatted"===e.type?r=yn.fromString(r.toString()):"resolvedImage"===e.type?r=vn.fromString(r.toString()):Mn(r)===e.type||"enum"===e.type&&e.values[r]||(r=void 0),aa(r,t.default,e.default)}Dn.register(Hs,{error:[{kind:"error"},[tn],(t,[e])=>{throw new En(e.evaluate(t))}],typeof:[tn,[on],(t,[e])=>un(xn(e.evaluate(t)))],"to-rgba":[cn(Qi,4),[rn],(t,[e])=>e.evaluate(t).toRenderColor(null).toArray()],rgb:[rn,[Qi,Qi,Qi],qs],rgba:[rn,[Qi,Qi,Qi,Qi],qs],hsl:[rn,[Qi,Qi,Qi],Ws],hsla:[rn,[Qi,Qi,Qi,Qi],Ws],has:{type:en,overloads:[[[tn],(t,[e])=>Zs(e.evaluate(t),t.properties())],[[tn,nn],(t,[e,r])=>Zs(e.evaluate(t),r.evaluate(t))]]},get:{type:on,overloads:[[[tn],(t,[e])=>Xs(e.evaluate(t),t.properties())],[[tn,nn],(t,[e,r])=>Xs(e.evaluate(t),r.evaluate(t))]]},"feature-state":[on,[tn],(t,[e])=>Xs(e.evaluate(t),t.featureState||{})],properties:[nn,[],t=>t.properties()],"geometry-type":[tn,[],t=>t.geometryType()],id:[on,[],t=>t.id()],zoom:[Qi,[],t=>t.globals.zoom],pitch:[Qi,[],t=>t.globals.pitch||0],"distance-from-center":[Qi,[],t=>t.distanceFromCenter()],"measure-light":[Qi,[tn],(t,[e])=>t.measureLight(e.evaluate(t))],"heatmap-density":[Qi,[],t=>t.globals.heatmapDensity||0],"line-progress":[Qi,[],t=>t.globals.lineProgress||0],"raster-value":[Qi,[],t=>t.globals.rasterValue||0],"raster-particle-speed":[Qi,[],t=>t.globals.rasterParticleSpeed||0],"sky-radial-progress":[Qi,[],t=>t.globals.skyRadialProgress||0],accumulated:[on,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[Qi,Ys(Qi),(t,e)=>{let r=0;for(const i of e)r+=i.evaluate(t);return r}],"*":[Qi,Ys(Qi),(t,e)=>{let r=1;for(const i of e)r*=i.evaluate(t);return r}],"-":{type:Qi,overloads:[[[Qi,Qi],(t,[e,r])=>e.evaluate(t)-r.evaluate(t)],[[Qi],(t,[e])=>-e.evaluate(t)]]},"/":[Qi,[Qi,Qi],(t,[e,r])=>e.evaluate(t)/r.evaluate(t)],"%":[Qi,[Qi,Qi],(t,[e,r])=>e.evaluate(t)%r.evaluate(t)],ln2:[Qi,[],()=>Math.LN2],pi:[Qi,[],()=>Math.PI],e:[Qi,[],()=>Math.E],"^":[Qi,[Qi,Qi],(t,[e,r])=>Math.pow(e.evaluate(t),r.evaluate(t))],sqrt:[Qi,[Qi],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[Qi,[Qi],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[Qi,[Qi],(t,[e])=>Math.log(e.evaluate(t))],log2:[Qi,[Qi],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[Qi,[Qi],(t,[e])=>Math.sin(e.evaluate(t))],cos:[Qi,[Qi],(t,[e])=>Math.cos(e.evaluate(t))],tan:[Qi,[Qi],(t,[e])=>Math.tan(e.evaluate(t))],asin:[Qi,[Qi],(t,[e])=>Math.asin(e.evaluate(t))],acos:[Qi,[Qi],(t,[e])=>Math.acos(e.evaluate(t))],atan:[Qi,[Qi],(t,[e])=>Math.atan(e.evaluate(t))],min:[Qi,Ys(Qi),(t,e)=>Math.min(...e.map((e=>e.evaluate(t))))],max:[Qi,Ys(Qi),(t,e)=>Math.max(...e.map((e=>e.evaluate(t))))],abs:[Qi,[Qi],(t,[e])=>Math.abs(e.evaluate(t))],round:[Qi,[Qi],(t,[e])=>{const r=e.evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[Qi,[Qi],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[Qi,[Qi],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[en,[tn,on],(t,[e,r])=>t.properties()[e.value]===r.value],"filter-id-==":[en,[on],(t,[e])=>t.id()===e.value],"filter-type-==":[en,[tn],(t,[e])=>t.geometryType()===e.value],"filter-<":[en,[tn,on],(t,[e,r])=>{const i=t.properties()[e.value],n=r.value;return typeof i==typeof n&&i<n}],"filter-id-<":[en,[on],(t,[e])=>{const r=t.id(),i=e.value;return typeof r==typeof i&&r<i}],"filter->":[en,[tn,on],(t,[e,r])=>{const i=t.properties()[e.value],n=r.value;return typeof i==typeof n&&i>n}],"filter-id->":[en,[on],(t,[e])=>{const r=t.id(),i=e.value;return typeof r==typeof i&&r>i}],"filter-<=":[en,[tn,on],(t,[e,r])=>{const i=t.properties()[e.value],n=r.value;return typeof i==typeof n&&i<=n}],"filter-id-<=":[en,[on],(t,[e])=>{const r=t.id(),i=e.value;return typeof r==typeof i&&r<=i}],"filter->=":[en,[tn,on],(t,[e,r])=>{const i=t.properties()[e.value],n=r.value;return typeof i==typeof n&&i>=n}],"filter-id->=":[en,[on],(t,[e])=>{const r=t.id(),i=e.value;return typeof r==typeof i&&r>=i}],"filter-has":[en,[on],(t,[e])=>e.value in t.properties()],"filter-has-id":[en,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[en,[cn(tn)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[en,[cn(on)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[en,[tn,cn(on)],(t,[e,r])=>r.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[en,[tn,cn(on)],(t,[e,r])=>function(t,e,r,i){for(;r<=i;){const n=r+i>>1;if(e[n]===t)return!0;e[n]>t?i=n-1:r=n+1}return!1}(t.properties()[e.value],r.value,0,r.value.length-1)],all:{type:en,overloads:[[[en,en],(t,[e,r])=>e.evaluate(t)&&r.evaluate(t)],[Ys(en),(t,e)=>{for(const r of e)if(!r.evaluate(t))return!1;return!0}]]},any:{type:en,overloads:[[[en,en],(t,[e,r])=>e.evaluate(t)||r.evaluate(t)],[Ys(en),(t,e)=>{for(const r of e)if(r.evaluate(t))return!0;return!1}]]},"!":[en,[en],(t,[e])=>!e.evaluate(t)],"is-supported-script":[en,[tn],(t,[e])=>{const r=t.globals&&t.globals.isSupportedScript;return!r||r(e.evaluate(t))}],upcase:[tn,[tn],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[tn,[tn],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[tn,Ys(on),(t,e)=>e.map((e=>wn(e.evaluate(t)))).join("")],"resolved-locale":[tn,[sn],(t,[e])=>e.evaluate(t).resolvedLocale()],random:[Qi,[Qi,Qi,on],(t,e)=>{const[r,i,n]=e.map((e=>e.evaluate(t)));if(r>i)return r;if(r===i)return r;let o;if("string"==typeof n)o=function(t){let e=0;if(0===t.length)return e;for(let r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r),e|=0;return e}(n);else{if("number"!=typeof n)throw new En(`Invalid seed input: ${n}`);o=n}return r+Gs(o)()*(i-r)}]});class da{constructor(t,e,r,i){this.expression=t,this._warningHistory={},this._evaluator=new Ln(r,i),this._defaultValue=e?function(t){return"color"===t.type&&(na(t.default)||Array.isArray(t.default))?new Gi(0,0,0,0):"color"===t.type?Gi.parse(t.default)||null:void 0===t.default?null:t.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,r,i,n,o,s,a){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=r,this._evaluator.canonical=i||null,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=o,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=a||null,this.expression.evaluate(this._evaluator)}evaluate(t,e,r,i,n,o,s,a){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=r||null,this._evaluator.canonical=i||null,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=o||null,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=a||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new En(`Expected value to be one of ${Object.keys(this._enumValues).map((t=>JSON.stringify(t))).join(", ")}, but found ${JSON.stringify(t)} instead.`);return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${t.message}`)),this._defaultValue}}}function pa(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Hs}function fa(t,e,r,i){const n=new es(Hs,[],e?function(t){const e={color:rn,string:tn,number:Qi,enum:tn,boolean:en,formatted:an,resolvedImage:ln};return"array"===t.type?cn(e[t.value]||on,t.length):e[t.type]}(e):void 0,void 0,void 0,r,i),o=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return o?Ks(new da(o,e,r,i)):Js(n.errors)}class ma{constructor(t,e,r){this.kind=t,this._styleExpression=e,this.isLightConstant=r,this.isStateDependent="constant"!==t&&!Yo(e.expression),this.configDependencies=Ko(e.expression)}evaluateWithoutErrorHandling(t,e,r,i,n,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,i,n,o)}evaluate(t,e,r,i,n,o){return this._styleExpression.evaluate(t,e,r,i,n,o)}}class ga{constructor(t,e,r,i,n){this.kind=t,this.zoomStops=r,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Yo(e.expression),this.isLightConstant=n,this.configDependencies=Ko(e.expression),this.interpolationType=i}evaluateWithoutErrorHandling(t,e,r,i,n,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,i,n,o)}evaluate(t,e,r,i,n,o){return this._styleExpression.evaluate(t,e,r,i,n,o)}interpolationFactor(t,e,r){return this.interpolationType?Ts.interpolationFactor(this.interpolationType,t,e,r):0}}function ya(t,e,r,i){if("error"===(t=fa(t,e,r,i)).result)return t;const n=t.value.expression,o=Xo(n);if(!o&&!ta(e))return Js([new Yi("","data expressions not supported")]);const s=Jo(n,["zoom","pitch","distance-from-center"]);if(!s&&!ra(e))return Js([new Yi("","zoom expressions not supported")]);const a=Jo(n,["measure-light"]);if(!a&&!ea(e))return Js([new Yi("","measure-light expression not supported")]);const l=e.expression&&e.expression.relaxZoomRestriction,c=_a(n);return c||s||l?c instanceof Yi?Js([c]):c instanceof Ts&&!ia(e)?Js([new Yi("",'"interpolate" expressions cannot be used with this property')]):Ks(c?new ga(o?"camera":"composite",t.value,c.labels,c instanceof Ts?c.interpolation:void 0,a):new ma(o?"constant":"source",t.value,a)):Js([new Yi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class va{constructor(t,e){this._parameters=t,this._specification=e,Xi(this,sa(this._parameters,this._specification))}static deserialize(t){return new va(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function _a(t){let e=null;if(t instanceof Ps)e=_a(t.result);else if(t instanceof Ss){for(const r of t.args)if(e=_a(r),e)break}else(t instanceof ns||t instanceof Ts)&&t.input instanceof Dn&&"zoom"===t.input.name&&(e=t);return e instanceof Yi||t.eachChild((t=>{const r=_a(t);r instanceof Yi?e=r:e&&r&&e!==r&&(e=new Yi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}var ba=wa,xa=3;function wa(t,e,r){var i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var n=new Int32Array(this.arrayBuffer);t=n[0],this.d=(e=n[1])+2*(r=n[2]);for(var o=0;o<this.d*this.d;o++){var s=n[xa+o],a=n[xa+o+1];i.push(s===a?null:n.subarray(s,a))}var l=n[xa+i.length+1];this.keys=n.subarray(n[xa+i.length],l),this.bboxes=n.subarray(l),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var c=0;c<this.d*this.d;c++)i.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=r,this.scale=e/t,this.uid=0;var u=r/e*t;this.min=-u,this.max=t+u}wa.prototype.insert=function(t,e,r,i,n){this._forEachCell(e,r,i,n,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(n)},wa.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},wa.prototype._insertCell=function(t,e,r,i,n,o){this.cells[n].push(o)},wa.prototype.query=function(t,e,r,i,n){var o=this.min,s=this.max;if(t<=o&&e<=o&&s<=r&&s<=i&&!n)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(t,e,r,i,this._queryCell,a,{},n),a},wa.prototype._queryCell=function(t,e,r,i,n,o,s,a){var l=this.cells[n];if(null!==l)for(var c=this.keys,u=this.bboxes,h=0;h<l.length;h++){var d=l[h];if(void 0===s[d]){var p=4*d;(a?a(u[p+0],u[p+1],u[p+2],u[p+3]):t<=u[p+2]&&e<=u[p+3]&&r>=u[p+0]&&i>=u[p+1])?(s[d]=!0,o.push(c[d])):s[d]=!1}}},wa.prototype._forEachCell=function(t,e,r,i,n,o,s,a){for(var l=this._convertToCellCoord(t),c=this._convertToCellCoord(e),u=this._convertToCellCoord(r),h=this._convertToCellCoord(i),d=l;d<=u;d++)for(var p=c;p<=h;p++){var f=this.d*p+d;if((!a||a(this._convertFromCellCoord(d),this._convertFromCellCoord(p),this._convertFromCellCoord(d+1),this._convertFromCellCoord(p+1)))&&n.call(this,t,e,r,i,f,o,s,a))return}},wa.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},wa.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},wa.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=xa+this.cells.length+1+1,r=0,i=0;i<this.cells.length;i++)r+=this.cells[i].length;var n=new Int32Array(e+r+this.keys.length+this.bboxes.length);n[0]=this.extent,n[1]=this.n,n[2]=this.padding;for(var o=e,s=0;s<t.length;s++){var a=t[s];n[xa+s]=o,n.set(a,o),o+=a.length}return n[xa+t.length]=o,n.set(this.keys,o),n[xa+t.length+1]=o+=this.keys.length,n.set(this.bboxes,o),o+=this.bboxes.length,n.buffer};var Ta=d(ba);const Ea={};function Sa(t,e,r={}){Object.defineProperty(t,"_classRegistryKey",{value:e,writable:!1}),Ea[e]={klass:t,omit:r.omit||[]}}Sa(Object,"Object"),Ta.serialize=function(t,e){const r=t.toArrayBuffer();return e&&e.add(r),{buffer:r}},Ta.deserialize=function(t){return new Ta(t.buffer)},Object.defineProperty(Ta,"name",{value:"Grid"}),Sa(Ta,"Grid"),Sa(Gi,"Color"),Sa(Error,"Error"),Sa(yn,"Formatted"),Sa(gn,"FormattedSection"),Sa(ti,"AJAXError"),Sa(vn,"ResolvedImage"),Sa(va,"StylePropertyFunction"),Sa(da,"StyleExpression",{omit:["_evaluator"]}),Sa(ga,"ZoomDependentExpression"),Sa(ma,"ZoomConstantExpression"),Sa(Dn,"CompoundExpression",{omit:["_evaluate"]});for(const t in Hs)Ea[Hs[t]._classRegistryKey]||Sa(Hs[t],`Expression${t}`);function Pa(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function ka(t){return self.ImageBitmap&&t instanceof ImageBitmap}function Aa(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Pa(t)||ka(t))return e&&e.add(t),t;if(ArrayBuffer.isView(t)){const r=t;return e&&e.add(r.buffer),r}if(t instanceof ImageData)return e&&e.add(t.data.buffer),t;if(Array.isArray(t)){const r=[];for(const i of t)r.push(Aa(i,e));return r}if(t instanceof Map){const e={$name:"Map"};for(const[r,i]of t.entries())e[r]=Aa(i);return e}if(t instanceof Set){const e={$name:"Set"};let r=0;for(const i of t.values())e[++r]=Aa(i);return e}if("object"==typeof t){const r=t.constructor,i=r._classRegistryKey;if(!i)throw new Error(`can't serialize object of unregistered class ${i}`);const n=r.serialize?r.serialize(t,e):{};if(!r.serialize){for(const r in t)t.hasOwnProperty(r)&&(Ea[i].omit.indexOf(r)>=0||(n[r]=Aa(t[r],e)));t instanceof Error&&(n.message=t.message)}if(n.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==i&&(n.$name=i),n}throw new Error("can't serialize object of type "+typeof t)}function Ma(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Pa(t)||ka(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(Ma);if("object"==typeof t){const e=t.$name||"Object";if("Map"===e){const e=new Map;for(const r of Object.keys(t))"$name"!==r&&e.set(r,Ma(t[r]));return e}if("Set"===e){const e=new Set;for(const r of Object.keys(t))"$name"!==r&&e.add(Ma(t[r]));return e}const{klass:r}=Ea[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(t);const i=Object.create(r.prototype);for(const e of Object.keys(t))"$name"!==e&&(i[e]=Ma(t[e]));return i}throw new Error("can't deserialize object of type "+typeof t)}const Ca={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519,"CJK Unified Ideographs Extension B":t=>t>=131072&&t<=173791};function Ia(t){for(const e of t)if(Da(e.charCodeAt(0)))return!0;return!1}function Oa(t){for(const e of t)if(!La(e.charCodeAt(0)))return!1;return!0}function La(t){return!(Ca.Arabic(t)||Ca["Arabic Supplement"](t)||Ca["Arabic Extended-A"](t)||Ca["Arabic Presentation Forms-A"](t)||Ca["Arabic Presentation Forms-B"](t))}function Da(t){return!(746!==t&&747!==t&&(t<4352||!(Ca["Bopomofo Extended"](t)||Ca.Bopomofo(t)||Ca["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Ca["CJK Compatibility Ideographs"](t)||Ca["CJK Compatibility"](t)||Ca["CJK Radicals Supplement"](t)||Ca["CJK Strokes"](t)||!(!Ca["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Ca["CJK Unified Ideographs Extension A"](t)||Ca["CJK Unified Ideographs"](t)||Ca["Enclosed CJK Letters and Months"](t)||Ca["Hangul Compatibility Jamo"](t)||Ca["Hangul Jamo Extended-A"](t)||Ca["Hangul Jamo Extended-B"](t)||Ca["Hangul Jamo"](t)||Ca["Hangul Syllables"](t)||Ca.Hiragana(t)||Ca["Ideographic Description Characters"](t)||Ca.Kanbun(t)||Ca["Kangxi Radicals"](t)||Ca["Katakana Phonetic Extensions"](t)||Ca.Katakana(t)&&12540!==t||!(!Ca["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Ca["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Ca["Unified Canadian Aboriginal Syllabics"](t)||Ca["Unified Canadian Aboriginal Syllabics Extended"](t)||Ca["Vertical Forms"](t)||Ca["Yijing Hexagram Symbols"](t)||Ca["Yi Syllables"](t)||Ca["Yi Radicals"](t))))}function Ra(t){return!(Da(t)||function(t){return!!(Ca["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||Ca["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||Ca["Letterlike Symbols"](t)||Ca["Number Forms"](t)||Ca["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||Ca["Control Pictures"](t)&&9251!==t||Ca["Optical Character Recognition"](t)||Ca["Enclosed Alphanumerics"](t)||Ca["Geometric Shapes"](t)||Ca["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Ca["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Ca["CJK Symbols and Punctuation"](t)||Ca.Katakana(t)||Ca["Private Use Area"](t)||Ca["CJK Compatibility Forms"](t)||Ca["Small Form Variants"](t)||Ca["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function Fa(t){return t>=1424&&t<=2303||Ca["Arabic Presentation Forms-A"](t)||Ca["Arabic Presentation Forms-B"](t)}function Ba(t,e){return!(!e&&Fa(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Ca.Khmer(t))}function za(t){for(const e of t)if(Fa(e.charCodeAt(0)))return!0;return!1}const ja="deferred",Na="loading",Va="loaded";let Ua=null,$a="unavailable",Ga=null;const Ha=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&($a="error"),Ua&&Ua(t)};function qa(){Wa.fire(new Di("pluginStateChange",{pluginStatus:$a,pluginURL:Ga}))}const Wa=new zi,Za=function(){return $a},Xa=function(){if($a!==ja||!Ga)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");$a=Na,qa(),Ga&&ii({url:Ga},(t=>{t?Ha(t):($a=Va,qa())}))},Ya={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>$a===Va||null!=Ya.applyArabicShaping,isLoading:()=>$a===Na,setState(t){$a=t.pluginStatus,Ga=t.pluginURL},isParsed:()=>null!=Ya.applyArabicShaping&&null!=Ya.processBidirectionalText&&null!=Ya.processStyledBidirectionalText,getPluginURL:()=>Ga};class Ka{constructor(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.transition=e.transition,this.pitch=e.pitch,this.brightness=e.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return function(t,e){for(const r of t)if(!Ba(r.charCodeAt(0),e))return!1;return!0}(t,Ya.isLoaded())}}class Ja{constructor(t,e,r,i){this.property=t,this.value=e,this.expression=function(t,e,r,i){if(na(t))return new va(t,e);if(pa(t)||Array.isArray(t)&&t.length>0){const n=ya(t,e,r,i);if("error"===n.result)throw new Error(n.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return n.value}{let r=t;return"string"==typeof t&&"color"===e.type&&(r=Gi.parse(t)),{kind:"constant",configDependencies:new Set,evaluate:()=>r}}}(void 0===e?t.specification.default:e,t.specification,r,i)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,e,r){return this.property.possiblyEvaluate(this,t,e,r)}}class Qa{constructor(t,e,r){this.property=t,this.value=new Ja(t,void 0,e,r)}transitioned(t,e){return new el(this.property,this.value,e,rr({},t.transition,this.transition),t.now)}untransitioned(){return new el(this.property,this.value,null,{},0)}}class tl{constructor(t,e,r){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._scope=e,this._options=r,this.configDependencies=new Set}getValue(t){return dr(this._values[t].value.value)}setValue(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Qa(this._values[t].property,this._scope,this._options)),this._values[t].value=new Ja(this._values[t].property,null===e?void 0:dr(e),this._scope,this._options),this._values[t].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[t].value.expression.configDependencies]))}setTransitionOrValue(t,e){e&&(this._options=e);const r=this._properties.properties;if(t)for(const e in t){const i=t[e];if(cr(e,"-transition")){const t=e.slice(0,-11);r[t]&&this.setTransition(t,i)}else r.hasOwnProperty(e)&&this.setValue(e,i)}}getTransition(t){return dr(this._values[t].transition)}setTransition(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Qa(this._values[t].property)),this._values[t].transition=dr(e)||void 0}serialize(){const t={};for(const e of Object.keys(this._values)){const r=this.getValue(e);void 0!==r&&(t[e]=r);const i=this.getTransition(e);void 0!==i&&(t[`${e}-transition`]=i)}return t}transitioned(t,e){const r=new rl(this._properties);for(const i of Object.keys(this._values))r._values[i]=this._values[i].transitioned(t,e._values[i]);return r}untransitioned(){const t=new rl(this._properties);for(const e of Object.keys(this._values))t._values[e]=this._values[e].untransitioned();return t}}class el{constructor(t,e,r,i,n){const o=i.delay||0,s=i.duration||0;n=n||0,this.property=t,this.value=e,this.begin=n+o,this.end=this.begin+s,t.specification.transition&&(i.delay||i.duration)&&(this.prior=r)}possiblyEvaluate(t,e,r){const i=t.now||0,n=this.value.possiblyEvaluate(t,e,r),o=this.prior;if(o){if(i>this.end)return this.prior=null,n;if(this.value.isDataDriven())return this.prior=null,n;if(i<this.begin)return o.possiblyEvaluate(t,e,r);{const s=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(t,e,r),n,Ze(s))}}return n}}class rl{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,e,r){const i=new ol(this._properties);for(const n of Object.keys(this._values))i._values[n]=this._values[n].possiblyEvaluate(t,e,r);return i}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class il{constructor(t,e,r){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._scope=e,this._options=r,this.configDependencies=new Set}getValue(t){return dr(this._values[t].value)}setValue(t,e){this._values[t]=new Ja(this._values[t].property,null===e?void 0:dr(e),this._scope,this._options),this._values[t].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[t].expression.configDependencies]))}serialize(){const t={};for(const e of Object.keys(this._values)){const r=this.getValue(e);void 0!==r&&(t[e]=r)}return t}possiblyEvaluate(t,e,r){const i=new ol(this._properties);for(const n of Object.keys(this._values))i._values[n]=this._values[n].possiblyEvaluate(t,e,r);return i}}class nl{constructor(t,e,r){this.property=t,this.value=e,this.parameters=r}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,e,r,i){return this.property.evaluate(this.value,this.parameters,t,e,r,i)}}class ol{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class sl{constructor(t){this.specification=t}possiblyEvaluate(t,e){return t.expression.evaluate(e)}interpolate(t,e,r){const i=Zi[this.specification.type];return i?i(t,e,r):t}}class al{constructor(t,e){this.specification=t,this.overrides=e}possiblyEvaluate(t,e,r,i){return new nl(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},r,i)}:t.expression,e)}interpolate(t,e,r){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new nl(this,{kind:"constant",value:void 0},t.parameters);const i=Zi[this.specification.type];return i?new nl(this,{kind:"constant",value:i(t.value.value,e.value.value,r)},t.parameters):t}evaluate(t,e,r,i,n,o){return"constant"===t.kind?t.value:t.evaluate(e,r,i,n,o)}}class ll{constructor(t){this.specification=t}possiblyEvaluate(t,e,r,i){return!!t.expression.evaluate(e,null,{},r,i)}interpolate(){return!1}}class cl{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const e=new Ka(0,{});for(const r in t){const i=t[r];i.specification.overridable&&this.overridableProperties.push(r);const n=this.defaultPropertyValues[r]=new Ja(i,void 0),o=this.defaultTransitionablePropertyValues[r]=new Qa(i);this.defaultTransitioningPropertyValues[r]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=n.possiblyEvaluate(e)}}}Sa(al,"DataDrivenProperty"),Sa(sl,"DataConstantProperty"),Sa(ll,"ColorRampProperty");var ul=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{"experimental":true}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-line-alignment":{"type":"enum","values":{"inside":1,"outside":1,"center":1},"default":"center","property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function hl(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function dl(t){if(Array.isArray(t))return t.map(dl);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const r in t)e[r]=dl(t[r]);return e}return hl(t)}function pl(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!pl(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function fl(t,e="fill"){if(null==t)return{filter:()=>!0,needGeometry:!1,needFeature:!1};pl(t)||(t=xl(t));const r=t;let i=!0;try{i=function(t){if(!yl(t))return t;let e=dl(t);return gl(e),e=ml(e),e}(r)}catch(t){console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(r,null,2)}\n        `)}const n=ul[`filter_${e}`],o=fa(i,n);let s=null;if("error"===o.result)throw new Error(o.value.map((t=>`${t.key}: ${t.message}`)).join(", "));s=(t,e,r)=>o.value.evaluate(t,e,{},r);let a=null,l=null;if(i!==r){const t=fa(r,n);if("error"===t.result)throw new Error(t.value.map((t=>`${t.key}: ${t.message}`)).join(", "));a=(e,r,i,n,o)=>t.value.evaluate(e,r,{},i,void 0,void 0,n,o),l=!Xo(t.value.expression)}return{filter:s,dynamicFilter:a||void 0,needGeometry:bl(i),needFeature:!!l}}function ml(t){if(!Array.isArray(t))return t;const e=function(t){if(vl.has(t[0]))for(let e=1;e<t.length;e++)if(yl(t[e]))return!0;return t}(t);return!0===e?e:e.map((t=>ml(t)))}function gl(t){let e=!1;const r=[];if("case"===t[0]){for(let i=1;i<t.length-1;i+=2)e=e||yl(t[i]),r.push(t[i+1]);r.push(t[t.length-1])}else if("match"===t[0]){e=e||yl(t[1]);for(let e=2;e<t.length-1;e+=2)r.push(t[e+1]);r.push(t[t.length-1])}else if("step"===t[0]){e=e||yl(t[1]);for(let e=1;e<t.length-1;e+=2)r.push(t[e+1])}e&&(t.length=0,t.push("any",...r));for(let e=1;e<t.length;e++)gl(t[e])}function yl(t){if(!Array.isArray(t))return!1;if("pitch"===(e=t[0])||"distance-from-center"===e)return!0;var e;for(let e=1;e<t.length;e++)if(yl(t[e]))return!0;return!1}const vl=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function _l(t,e){return t<e?-1:t>e?1:0}function bl(t){if(!Array.isArray(t))return!1;if("within"===t[0]||"distance"===t[0])return!0;for(let e=1;e<t.length;e++)if(bl(t[e]))return!0;return!1}function xl(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?wl(t[1],t[2],"=="):"!="===e?Sl(wl(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?wl(t[1],t[2],e):"any"===e?(r=t.slice(1),["any"].concat(r.map(xl))):"all"===e?["all"].concat(t.slice(1).map(xl)):"none"===e?["all"].concat(t.slice(1).map(xl).map(Sl)):"in"===e?Tl(t[1],t.slice(2)):"!in"===e?Sl(Tl(t[1],t.slice(2))):"has"===e?El(t[1]):"!has"!==e||Sl(El(t[1]));var r}function wl(t,e,r){switch(t){case"$type":return[`filter-type-${r}`,e];case"$id":return[`filter-id-${r}`,e];default:return[`filter-${r}`,t,e]}}function Tl(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((t=>typeof t!=typeof e[0]))?["filter-in-large",t,["literal",e.sort(_l)]]:["filter-in-small",t,["literal",e]]}}function El(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Sl(t){return["!",t]}const Pl="";function kl(t,e){return e?`${t}${Pl}${e}`:t}const Al="-transition",Ml=new Set(["fill","line","background","hillshade","raster"]);class Cl extends zi{constructor(t,e,r,i,n){if(super(),this.id=t.id,this.fqid=kl(this.id,r),this.type=t.type,this.scope=r,this.lut=i,this.options=n,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,"custom"!==t.type&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&"sky"!==t.type&&"slot"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),t.slot&&(this.slot=t.slot),e.layout&&(this._unevaluatedLayout=new il(e.layout,this.scope,n),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),e.paint)){this._transitionablePaint=new tl(e.paint,this.scope,n);for(const e in t.paint)this.setPaintProperty(e,t.paint[e]);for(const e in t.layout)this.setLayoutProperty(e,t.layout[e]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ol(e.paint)}}onAdd(t){}onRemove(t){}isDraped(t){return Ml.has(this.type)}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,e){if("custom"===this.type&&"visibility"===t)return void(this.visibility=e);const r=this._unevaluatedLayout;r._properties.properties[t]&&(r.setValue(t,e),this.configDependencies=new Set([...this.configDependencies,...r.configDependencies]),"visibility"===t&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(t){return cr(t,Al)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,e){const r=this._transitionablePaint,i=r._properties.properties;if(cr(t,Al)){const n=t.slice(0,-11);return i[n]&&r.setTransition(n,e||void 0),!1}if(!i[t])return!1;const n=r._values[t],o=n.value.isDataDriven(),s=n.value;r.setValue(t,e),this.configDependencies=new Set([...this.configDependencies,...r.configDependencies]),this._handleSpecialPaintPropertyUpdate(t);const a=r._values[t].value,l=a.isDataDriven(),c=cr(t,"pattern")||"line-dasharray"===t;return l||o||c||this._handleOverridablePaintPropertyUpdate(t,s,a)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,e,r){return null}_handleOverridablePaintPropertyUpdate(t,e,r){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,e){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)}serialize(){return hr({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},((t,e)=>!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const t in this.paint._values){const e=this.paint.get(t);if(e instanceof nl&&ta(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=fl(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(t){this._stats&&("shadow"===t.renderPass?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(t){}queryIntersectsFeature(t,e,r,i,n,o,s,a,l){}queryIntersectsMatchingFeature(t,e,r,i){}}const Il={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ol{constructor(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ll{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,e){return t._trim(),e&&(t.isTransferred=!0,e.add(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...t){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...t){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Dl(t,e=1){let r=0,i=0;return{members:t.map((t=>{const n=Il[t.type].BYTES_PER_ELEMENT,o=r=Rl(r,Math.max(e,n)),s=t.components||1;return i=Math.max(i,n),r+=n*s,{name:t.name,type:t.type,components:s,offset:o}})),size:Rl(r,Math.max(i,e)),alignment:e}}function Rl(t,e){return Math.ceil(t/e)*e}class Fl extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e){const r=this.length;return this.resize(r+1),this.emplace(r,t,e)}emplace(t,e,r){const i=2*t;return this.int16[i+0]=e,this.int16[i+1]=r,t}}Fl.prototype.bytesPerElement=4,Sa(Fl,"StructArrayLayout2i4");class Bl extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,r){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,r)}emplace(t,e,r,i){const n=3*t;return this.int16[n+0]=e,this.int16[n+1]=r,this.int16[n+2]=i,t}}Bl.prototype.bytesPerElement=6,Sa(Bl,"StructArrayLayout3i6");class zl extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,r,i){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,r,i)}emplace(t,e,r,i,n){const o=4*t;return this.int16[o+0]=e,this.int16[o+1]=r,this.int16[o+2]=i,this.int16[o+3]=n,t}}zl.prototype.bytesPerElement=8,Sa(zl,"StructArrayLayout4i8");class jl extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,r,i,n){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,r,i,n)}emplace(t,e,r,i,n,o){const s=5*t;return this.int16[s+0]=e,this.int16[s+1]=r,this.int16[s+2]=i,this.int16[s+3]=n,this.int16[s+4]=o,t}}jl.prototype.bytesPerElement=10,Sa(jl,"StructArrayLayout5i10");class Nl extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,r,i,n,o,s){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,r,i,n,o,s)}emplace(t,e,r,i,n,o,s,a){const l=6*t,c=12*t,u=3*t;return this.int16[l+0]=e,this.int16[l+1]=r,this.uint8[c+4]=i,this.uint8[c+5]=n,this.uint8[c+6]=o,this.uint8[c+7]=s,this.float32[u+2]=a,t}}Nl.prototype.bytesPerElement=12,Sa(Nl,"StructArrayLayout2i4ub1f12");class Vl extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,r,i){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,r,i)}emplace(t,e,r,i,n){const o=4*t;return this.float32[o+0]=e,this.float32[o+1]=r,this.float32[o+2]=i,this.float32[o+3]=n,t}}Vl.prototype.bytesPerElement=16,Sa(Vl,"StructArrayLayout4f16");class Ul extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,r){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,r)}emplace(t,e,r,i){const n=3*t;return this.float32[n+0]=e,this.float32[n+1]=r,this.float32[n+2]=i,t}}Ul.prototype.bytesPerElement=12,Sa(Ul,"StructArrayLayout3f12");class $l extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,r,i,n){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,r,i,n)}emplace(t,e,r,i,n,o){const s=6*t,a=3*t;return this.uint16[s+0]=e,this.uint16[s+1]=r,this.uint16[s+2]=i,this.uint16[s+3]=n,this.float32[a+2]=o,t}}$l.prototype.bytesPerElement=12,Sa($l,"StructArrayLayout4ui1f12");class Gl extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,r,i){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,r,i)}emplace(t,e,r,i,n){const o=4*t;return this.uint16[o+0]=e,this.uint16[o+1]=r,this.uint16[o+2]=i,this.uint16[o+3]=n,t}}Gl.prototype.bytesPerElement=8,Sa(Gl,"StructArrayLayout4ui8");class Hl extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,r,i,n,o){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,r,i,n,o)}emplace(t,e,r,i,n,o,s){const a=6*t;return this.int16[a+0]=e,this.int16[a+1]=r,this.int16[a+2]=i,this.int16[a+3]=n,this.int16[a+4]=o,this.int16[a+5]=s,t}}Hl.prototype.bytesPerElement=12,Sa(Hl,"StructArrayLayout6i12");class ql extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,r,i,n,o,s,a,l,c,u,h){const d=this.length;return this.resize(d+1),this.emplace(d,t,e,r,i,n,o,s,a,l,c,u,h)}emplace(t,e,r,i,n,o,s,a,l,c,u,h,d){const p=12*t;return this.int16[p+0]=e,this.int16[p+1]=r,this.int16[p+2]=i,this.int16[p+3]=n,this.uint16[p+4]=o,this.uint16[p+5]=s,this.uint16[p+6]=a,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=u,this.int16[p+10]=h,this.int16[p+11]=d,t}}ql.prototype.bytesPerElement=24,Sa(ql,"StructArrayLayout4i4ui4i24");class Wl extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,r,i,n,o){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,r,i,n,o)}emplace(t,e,r,i,n,o,s){const a=10*t,l=5*t;return this.int16[a+0]=e,this.int16[a+1]=r,this.int16[a+2]=i,this.float32[l+2]=n,this.float32[l+3]=o,this.float32[l+4]=s,t}}Wl.prototype.bytesPerElement=20,Sa(Wl,"StructArrayLayout3i3f20");class Zl extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint32[1*t+0]=e,t}}Zl.prototype.bytesPerElement=4,Sa(Zl,"StructArrayLayout1ul4");class Xl extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e){const r=this.length;return this.resize(r+1),this.emplace(r,t,e)}emplace(t,e,r){const i=2*t;return this.uint16[i+0]=e,this.uint16[i+1]=r,t}}Xl.prototype.bytesPerElement=4,Sa(Xl,"StructArrayLayout2ui4");class Yl extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,r,i,n,o,s,a,l,c,u,h,d){const p=this.length;return this.resize(p+1),this.emplace(p,t,e,r,i,n,o,s,a,l,c,u,h,d)}emplace(t,e,r,i,n,o,s,a,l,c,u,h,d,p){const f=20*t,m=10*t;return this.int16[f+0]=e,this.int16[f+1]=r,this.int16[f+2]=i,this.int16[f+3]=n,this.int16[f+4]=o,this.float32[m+3]=s,this.float32[m+4]=a,this.float32[m+5]=l,this.float32[m+6]=c,this.int16[f+14]=u,this.uint32[m+8]=h,this.uint16[f+18]=d,this.uint16[f+19]=p,t}}Yl.prototype.bytesPerElement=40,Sa(Yl,"StructArrayLayout5i4f1i1ul2ui40");class Kl extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,r,i,n,o,s){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,r,i,n,o,s)}emplace(t,e,r,i,n,o,s,a){const l=8*t;return this.int16[l+0]=e,this.int16[l+1]=r,this.int16[l+2]=i,this.int16[l+4]=n,this.int16[l+5]=o,this.int16[l+6]=s,this.int16[l+7]=a,t}}Kl.prototype.bytesPerElement=16,Sa(Kl,"StructArrayLayout3i2i2i16");class Jl extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,r,i,n){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,r,i,n)}emplace(t,e,r,i,n,o){const s=4*t,a=8*t;return this.float32[s+0]=e,this.float32[s+1]=r,this.float32[s+2]=i,this.int16[a+6]=n,this.int16[a+7]=o,t}}Jl.prototype.bytesPerElement=16,Sa(Jl,"StructArrayLayout2f1f2i16");class Ql extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,r,i){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,r,i)}emplace(t,e,r,i,n){const o=12*t,s=3*t;return this.uint8[o+0]=e,this.uint8[o+1]=r,this.float32[s+1]=i,this.float32[s+2]=n,t}}Ql.prototype.bytesPerElement=12,Sa(Ql,"StructArrayLayout2ub2f12");class tc extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,r){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,r)}emplace(t,e,r,i){const n=3*t;return this.uint16[n+0]=e,this.uint16[n+1]=r,this.uint16[n+2]=i,t}}tc.prototype.bytesPerElement=6,Sa(tc,"StructArrayLayout3ui6");class ec extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y,v,_,b){const x=this.length;return this.resize(x+1),this.emplace(x,t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y,v,_,b)}emplace(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y,v,_,b,x){const w=30*t,T=15*t,E=60*t;return this.int16[w+0]=e,this.int16[w+1]=r,this.int16[w+2]=i,this.float32[T+2]=n,this.float32[T+3]=o,this.uint16[w+8]=s,this.uint16[w+9]=a,this.uint32[T+5]=l,this.uint32[T+6]=c,this.uint32[T+7]=u,this.uint16[w+16]=h,this.uint16[w+17]=d,this.uint16[w+18]=p,this.float32[T+10]=f,this.float32[T+11]=m,this.uint8[E+48]=g,this.uint8[E+49]=y,this.uint8[E+50]=v,this.uint32[T+13]=_,this.int16[w+28]=b,this.uint8[E+58]=x,t}}ec.prototype.bytesPerElement=60,Sa(ec,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class rc extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y,v,_,b,x,w,T,E,S,P,k,A,M,C,I){const O=this.length;return this.resize(O+1),this.emplace(O,t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y,v,_,b,x,w,T,E,S,P,k,A,M,C,I)}emplace(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y,v,_,b,x,w,T,E,S,P,k,A,M,C,I,O){const L=20*t,D=40*t,R=80*t;return this.float32[L+0]=e,this.float32[L+1]=r,this.int16[D+4]=i,this.int16[D+5]=n,this.int16[D+6]=o,this.int16[D+7]=s,this.int16[D+8]=a,this.int16[D+9]=l,this.int16[D+10]=c,this.int16[D+11]=u,this.int16[D+12]=h,this.uint16[D+13]=d,this.uint16[D+14]=p,this.uint16[D+15]=f,this.uint16[D+16]=m,this.uint16[D+17]=g,this.uint16[D+18]=y,this.uint16[D+19]=v,this.uint16[D+20]=_,this.uint16[D+21]=b,this.uint16[D+22]=x,this.uint16[D+23]=w,this.uint16[D+24]=T,this.uint16[D+25]=E,this.uint16[D+26]=S,this.uint16[D+27]=P,this.uint32[L+14]=k,this.float32[L+15]=A,this.float32[L+16]=M,this.float32[L+17]=C,this.float32[L+18]=I,this.uint8[R+76]=O,t}}rc.prototype.bytesPerElement=80,Sa(rc,"StructArrayLayout2f9i15ui1ul4f1ub80");class ic extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.float32[1*t+0]=e,t}}ic.prototype.bytesPerElement=4,Sa(ic,"StructArrayLayout1f4");class nc extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,r,i,n){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,r,i,n)}emplace(t,e,r,i,n,o){const s=5*t;return this.float32[s+0]=e,this.float32[s+1]=r,this.float32[s+2]=i,this.float32[s+3]=n,this.float32[s+4]=o,t}}nc.prototype.bytesPerElement=20,Sa(nc,"StructArrayLayout5f20");class oc extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,r,i,n,o,s){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,r,i,n,o,s)}emplace(t,e,r,i,n,o,s,a){const l=7*t;return this.float32[l+0]=e,this.float32[l+1]=r,this.float32[l+2]=i,this.float32[l+3]=n,this.float32[l+4]=o,this.float32[l+5]=s,this.float32[l+6]=a,t}}oc.prototype.bytesPerElement=28,Sa(oc,"StructArrayLayout7f28");class sc extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,r,i){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,r,i)}emplace(t,e,r,i,n){const o=6*t;return this.uint32[3*t+0]=e,this.uint16[o+2]=r,this.uint16[o+3]=i,this.uint16[o+4]=n,t}}sc.prototype.bytesPerElement=12,Sa(sc,"StructArrayLayout1ul3ui12");class ac extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint16[1*t+0]=e,t}}ac.prototype.bytesPerElement=2,Sa(ac,"StructArrayLayout1ui2");class lc extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e){const r=this.length;return this.resize(r+1),this.emplace(r,t,e)}emplace(t,e,r){const i=2*t;return this.float32[i+0]=e,this.float32[i+1]=r,t}}lc.prototype.bytesPerElement=8,Sa(lc,"StructArrayLayout2f8");class cc extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m)}emplace(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g){const y=16*t;return this.float32[y+0]=e,this.float32[y+1]=r,this.float32[y+2]=i,this.float32[y+3]=n,this.float32[y+4]=o,this.float32[y+5]=s,this.float32[y+6]=a,this.float32[y+7]=l,this.float32[y+8]=c,this.float32[y+9]=u,this.float32[y+10]=h,this.float32[y+11]=d,this.float32[y+12]=p,this.float32[y+13]=f,this.float32[y+14]=m,this.float32[y+15]=g,t}}cc.prototype.bytesPerElement=64,Sa(cc,"StructArrayLayout16f64");class uc extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,r,i,n,o,s){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,r,i,n,o,s)}emplace(t,e,r,i,n,o,s,a){const l=10*t,c=5*t;return this.uint16[l+0]=e,this.uint16[l+1]=r,this.uint16[l+2]=i,this.uint16[l+3]=n,this.float32[c+2]=o,this.float32[c+3]=s,this.float32[c+4]=a,t}}uc.prototype.bytesPerElement=20,Sa(uc,"StructArrayLayout4ui3f20");class hc extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.int16[1*t+0]=e,t}}hc.prototype.bytesPerElement=2,Sa(hc,"StructArrayLayout1i2");class dc extends Ll{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint8[1*t+0]=e,t}}dc.prototype.bytesPerElement=1,Sa(dc,"StructArrayLayout1ub1");class pc extends Ol{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}pc.prototype.size=40;class fc extends Yl{get(t){return new pc(this,t)}}Sa(fc,"CollisionBoxArray");class mc extends Ol{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}mc.prototype.size=60;class gc extends ec{get(t){return new mc(this,t)}}Sa(gc,"PlacedSymbolArray");class yc extends Ol{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}yc.prototype.size=80;class vc extends rc{get(t){return new yc(this,t)}}Sa(vc,"SymbolInstanceArray");class _c extends ic{getoffsetX(t){return this.float32[1*t+0]}}Sa(_c,"GlyphOffsetArray");class bc extends Fl{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}Sa(bc,"SymbolLineVertexArray");class xc extends Ol{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}xc.prototype.size=12;class wc extends sc{get(t){return new xc(this,t)}}Sa(wc,"FeatureIndexArray");class Tc extends Xl{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}Sa(Tc,"FillExtrusionCentroidArray");class Ec extends Ol{get a_join_normal_inside_polygon0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside_polygon1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside_polygon2(){return this._structArray.int16[this._pos2+2]}get a_join_normal_inside_polygon3(){return this._structArray.int16[this._pos2+3]}}Ec.prototype.size=8;class Sc extends zl{get(t){return new Ec(this,t)}}Sa(Sc,"FillExtrusionWallArray");const Pc=Dl([{name:"a_pos",components:2,type:"Int16"}],4),kc=Dl([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Ac{constructor(t=[]){this.segments=t}_prepareSegment(t,e,r,i){let n=this.segments[this.segments.length-1];return t>Ac.MAX_VERTEX_ARRAY_LENGTH&&fr(`Max vertices per segment is ${Ac.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!n||n.vertexLength+t>Ac.MAX_VERTEX_ARRAY_LENGTH||n.sortKey!==i)&&(n={vertexOffset:e,primitiveOffset:r,vertexLength:0,primitiveLength:0},void 0!==i&&(n.sortKey=i),this.segments.push(n)),n}prepareSegment(t,e,r,i){return this._prepareSegment(t,e.length,r.length,i)}get(){return this.segments}destroy(){for(const t of this.segments)for(const e in t.vaos)t.vaos[e].destroy()}static simpleSegment(t,e,r,i){return new Ac([{vertexOffset:t,primitiveOffset:e,vertexLength:r,primitiveLength:i,vaos:{},sortKey:0}])}}function Mc(t,e){return 256*(t=Ke(Math.floor(t),0,255))+Ke(Math.floor(e),0,255)}Ac.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Sa(Ac,"SegmentVector");const Cc=Dl([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Ic=Dl([{name:"a_dash",components:4,type:"Uint16"}]);class Oc{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,e,r,i){this.ids.push(Lc(t)),this.positions.push(e,r,i)}eachPosition(t,e){const r=Lc(t);let i=0,n=this.ids.length-1;for(;i<n;){const t=i+n>>1;this.ids[t]>=r?n=t:i=t+1}for(;this.ids[i]===r;)e(this.positions[3*i],this.positions[3*i+1],this.positions[3*i+2]),i++}static serialize(t,e){const r=new Float64Array(t.ids),i=new Uint32Array(t.positions);return Dc(r,i,0,r.length-1),e&&(e.add(r.buffer),e.add(i.buffer)),{ids:r,positions:i}}static deserialize(t){const e=new Oc;let r;e.ids=t.ids,e.positions=t.positions;for(const t of e.ids)t!==r&&e.uniqueIds.push(t),r=t;return e.indexed=!0,e}}function Lc(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Li(String(t))}function Dc(t,e,r,i){for(;r<i;){const n=t[r+i>>1];let o=r-1,s=i+1;for(;;){do{o++}while(t[o]<n);do{s--}while(t[s]>n);if(o>=s)break;Rc(t,o,s),Rc(e,3*o,3*s),Rc(e,3*o+1,3*s+1),Rc(e,3*o+2,3*s+2)}s-r<i-s?(Dc(t,e,r,s),r=s+1):(Dc(t,e,s+1,i),i=s)}}function Rc(t,e,r){const i=t[e];t[e]=t[r],t[r]=i}Sa(Oc,"FeaturePositionMap");class Fc{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,e){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,e),this.initialized=!0),!!this.location}set(t,e,r){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Bc extends Fc{constructor(t){super(t),this.current=0}set(t,e,r){this.fetchUniformLocation(t,e)&&this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}}class zc extends Fc{constructor(t){super(t),this.current=0}set(t,e,r){this.fetchUniformLocation(t,e)&&this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class jc extends Fc{constructor(t){super(t),this.current=[0,0]}set(t,e,r){this.fetchUniformLocation(t,e)&&(r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1])))}}class Nc extends Fc{constructor(t){super(t),this.current=[0,0,0]}set(t,e,r){this.fetchUniformLocation(t,e)&&(r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2])))}}class Vc extends Fc{constructor(t){super(t),this.current=[0,0,0,0]}set(t,e,r){this.fetchUniformLocation(t,e)&&(r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3])))}}class Uc extends Fc{constructor(t){super(t),this.current=Gi.transparent.toRenderColor(null)}set(t,e,r){this.fetchUniformLocation(t,e)&&(r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a)))}}const $c=new Float32Array(16);class Gc extends Fc{constructor(t){super(t),this.current=$c}set(t,e,r){if(this.fetchUniformLocation(t,e)){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let t=1;t<16;t++)if(r[t]!==this.current[t]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}}}const Hc=new Float32Array(9),qc=new Float32Array(4);class Wc extends Fc{constructor(t){super(t),this.current=qc}set(t,e,r){if(this.fetchUniformLocation(t,e))for(let t=0;t<4;t++)if(r[t]!==this.current[t]){this.current=r,this.gl.uniformMatrix2fv(this.location,!1,r);break}}}function Zc(t){return[Mc(255*t.r,255*t.g),Mc(255*t.b,255*t.a)]}class Xc{constructor(t,e,r,i){this.value=t,this.uniformNames=e.map((t=>`u_${t}`)),this.type=r,this.context=i}setUniform(t,e,r,i,n){const o=i.constantOr(this.value);e.set(t,n,o instanceof Gi?o.toRenderColor(this.context.lut):o)}getBinding(t,e){return"color"===this.type?new Uc(t):new zc(t)}}class Yc{constructor(t,e){this.uniformNames=e.map((t=>`u_${t}`)),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,e,r,i,n){const o="u_pattern"===n||"u_dash"===n?this.pattern:"u_pixel_ratio"===n?this.pixelRatio:null;o&&e.set(t,n,o)}getBinding(t,e){return"u_pattern"===e||"u_dash"===e?new Vc(t):new zc(t)}}class Kc{constructor(t,e,r,i){this.expression=t,this.type=r,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===r?2:1,offset:0}))),this.paintVertexArray=new i}populatePaintArray(t,e,r,i,n,o,s){const a=this.paintVertexArray.length,l=this.expression.evaluate(new Ka(0,{brightness:o}),e,{},n,i,s);this.paintVertexArray.resize(t),this._setPaintValue(a,t,l,this.context)}updatePaintArray(t,e,r,i,n,o,s){const a=this.expression.evaluate({zoom:0,brightness:s},r,i,void 0,n);this._setPaintValue(t,e,a,this.context)}_setPaintValue(t,e,r,i){if("color"===this.type){const n=Zc(r.toRenderColor(i.lut));for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,n[0],n[1])}else{for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Jc{constructor(t,e,r,i,n,o){this.expression=t,this.uniformNames=e.map((t=>`u_${t}_t`)),this.type=r,this.useIntegerZoom=i,this.context=n,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===r?4:2,offset:0}))),this.paintVertexArray=new o}populatePaintArray(t,e,r,i,n,o,s){const a=this.expression.evaluate(new Ka(this.context.zoom,{brightness:o}),e,{},n,i,s),l=this.expression.evaluate(new Ka(this.context.zoom+1,{brightness:o}),e,{},n,i,s),c=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(c,t,a,l,this.context)}updatePaintArray(t,e,r,i,n,o,s){const a=this.expression.evaluate({zoom:this.context.zoom,brightness:s},r,i,void 0,n),l=this.expression.evaluate({zoom:this.context.zoom+1,brightness:s},r,i,void 0,n);this._setPaintValue(t,e,a,l,this.context)}_setPaintValue(t,e,r,i,n){if("color"===this.type){const i=Zc(r.toRenderColor(n.lut)),o=Zc(r.toRenderColor(n.lut));for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,i[0],i[1],o[0],o[1])}else{for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,r,i);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(i))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,e,r,i,n){const o=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,s=Ke(this.expression.interpolationFactor(o,this.context.zoom,this.context.zoom+1),0,1);e.set(t,n,s)}getBinding(t,e){return new zc(t)}}class Qc{constructor(t,e,r,i,n){this.expression=t,this.layerId=n,this.paintVertexAttributes=("array"===r?Ic:Cc).members;for(let t=0;t<e.length;++t);this.paintVertexArray=new i}populatePaintArray(t,e,r,i){const n=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(n,t,e.patterns&&e.patterns[this.layerId],r)}updatePaintArray(t,e,r,i,n,o,s){this._setPaintValues(t,e,r.patterns&&r.patterns[this.layerId],o)}_setPaintValues(t,e,r,i){if(!i||!r)return;const n=i[r];if(!n)return;const{tl:o,br:s,pixelRatio:a}=n;for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,o[0],o[1],s[0],s[1],a)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class tu{constructor(t,e,r=(()=>!0)){this.binders={},this._buffers=[],this.context=e;const i=[];for(const n in t.paint._values){const o=t.paint.get(n);if(!r(n))continue;if(!(o instanceof nl&&ta(o.property.specification)))continue;const s=iu(n,t.type),a=o.value,l=o.property.specification.type,c=!!o.property.useIntegerZoom,u="line-dasharray"===n||n.endsWith("pattern"),h="line-dasharray"===n&&"constant"!==t.layout.get("line-cap").value.kind;if("constant"!==a.kind||h)if("source"===a.kind||h||u){const e=su(n,l,"source");this.binders[n]=u?new Qc(a,s,l,e,t.id):new Kc(a,s,l,e),i.push(`/a_${n}`)}else{const t=su(n,l,"composite");this.binders[n]=new Jc(a,s,l,c,e,t),i.push(`/z_${n}`)}else this.binders[n]=u?new Yc(a.value,s):new Xc(a.value,s,l,e),i.push(`/u_${n}`)}this.cacheKey=i.sort().join("")}getMaxValue(t){const e=this.binders[t];return e instanceof Kc||e instanceof Jc?e.maxValue:0}populatePaintArrays(t,e,r,i,n,o,s){for(const a in this.binders){const l=this.binders[a];l.context=this.context,(l instanceof Kc||l instanceof Jc||l instanceof Qc)&&l.populatePaintArray(t,e,r,i,n,o,s)}}setConstantPatternPositions(t){for(const e in this.binders){const r=this.binders[e];r instanceof Yc&&r.setConstantPatternPositions(t)}}updatePaintArrays(t,e,r,i,n,o,s,a){let l=!1;const c=Object.keys(t),u=0!==c.length,h=u?c:e.uniqueIds;this.context.lut=n.lut;for(const c in this.binders){const d=this.binders[c];if(d.context=this.context,(d instanceof Kc||d instanceof Jc||d instanceof Qc)&&(!0===d.expression.isStateDependent||!1===d.expression.isLightConstant)){const p=n.paint.get(c);d.expression=p.value;for(const r of h){const n=t[r.toString()];e.eachPosition(r,((t,e,r)=>{const l=i.feature(t);d.updatePaintArray(e,r,l,n,o,s,a)}))}if(!u)for(const e of r.uniqueIds){const n=t[e.toString()];r.eachPosition(e,((t,e,r)=>{const l=i.feature(t);d.updatePaintArray(e,r,l,n,o,s,a)}))}l=!0}}return l}defines(){const t=[];for(const e in this.binders){const r=this.binders[e];(r instanceof Xc||r instanceof Yc)&&t.push(...r.uniformNames.map((t=>`#define HAS_UNIFORM_${t}`)))}return t}getBinderAttributes(){const t=[];for(const e in this.binders){const r=this.binders[e];if(r instanceof Kc||r instanceof Jc||r instanceof Qc)for(let e=0;e<r.paintVertexAttributes.length;e++)t.push(r.paintVertexAttributes[e].name)}return t}getBinderUniforms(){const t=[];for(const e in this.binders){const r=this.binders[e];if(r instanceof Xc||r instanceof Yc||r instanceof Jc)for(const e of r.uniformNames)t.push(e)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const e=[];for(const r in this.binders){const i=this.binders[r];if(i instanceof Xc||i instanceof Yc||i instanceof Jc)for(const n of i.uniformNames)e.push({name:n,property:r,binding:i.getBinding(t,n)})}return e}setUniforms(t,e,r,i,n){for(const{name:e,property:o,binding:s}of r)this.binders[o].setUniform(t,s,n,i.get(o),e)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const e=this.binders[t];(e instanceof Kc||e instanceof Jc||e instanceof Qc)&&e.paintVertexBuffer&&this._buffers.push(e.paintVertexBuffer)}}upload(t){for(const e in this.binders){const r=this.binders[e];(r instanceof Kc||r instanceof Jc||r instanceof Qc)&&r.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const e=this.binders[t];(e instanceof Kc||e instanceof Jc||e instanceof Qc)&&e.destroy()}}}class eu{constructor(t,e,r=(()=>!0)){this.programConfigurations={};for(const i of t)this.programConfigurations[i.id]=new tu(i,e,r);this.needsUpload=!1,this._featureMap=new Oc,this._featureMapWithoutIds=new Oc,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,e,r,i,n,o,s,a){for(const r in this.programConfigurations)this.programConfigurations[r].populatePaintArrays(t,e,i,n,o,s,a);void 0!==e.id?this._featureMap.add(e.id,r,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,r,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,e,r,i,n,o){for(const s of r)this.needsUpload=this.programConfigurations[s.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,e,s,i,n,o||0)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const ru={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function iu(t,e){return ru[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const nu={"line-pattern":{source:$l,composite:$l},"fill-pattern":{source:$l,composite:$l},"fill-extrusion-pattern":{source:$l,composite:$l},"line-dasharray":{source:Gl,composite:Gl}},ou={color:{source:lc,composite:Vl},number:{source:ic,composite:lc}};function su(t,e,r){const i=nu[t];return i&&i[r]||ou[e][r]}Sa(Xc,"ConstantBinder"),Sa(Yc,"PatternConstantBinder"),Sa(Kc,"SourceExpressionBinder"),Sa(Qc,"PatternCompositeBinder"),Sa(Jc,"CompositeExpressionBinder"),Sa(tu,"ProgramConfiguration",{omit:["_buffers"]}),Sa(eu,"ProgramConfigurationSet");const au=mo/Math.PI/2,lu=5,cu=6,uu=16383,hu=64,du=[hu,32,16],pu=-au,fu=au;function mu(t,e,r,i=au){return r=He(r),[t*Math.sin(r)*i,-e*i,t*Math.cos(r)*i]}function gu(t,e,r){return mu(Math.cos(He(t)),Math.sin(He(t)),e,r)}const yu=6371008.8,vu=2*Math.PI*yu;class _u{constructor(t,e){if(isNaN(t)||isNaN(e))throw new Error(`Invalid LngLat object: (${t}, ${e})`);if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new _u(Qe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const e=Math.PI/180,r=this.lat*e,i=t.lat*e,n=Math.sin(r)*Math.sin(i)+Math.cos(r)*Math.cos(i)*Math.cos((t.lng-this.lng)*e);return yu*Math.acos(Math.min(n,1))}toBounds(t=0){const e=360*t/40075017,r=e/Math.cos(Math.PI/180*this.lat);return new bu({lng:this.lng-r,lat:this.lat-e},{lng:this.lng+r,lat:this.lat+e})}toEcef(t){return gu(this.lat,this.lng,au+t*au/yu)}static convert(t){if(t instanceof _u)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new _u(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new _u(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class bu{constructor(t,e){if(t)if(e)this.setSouthWest(t).setNorthEast(e);else if(4===t.length){const e=t;this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]])}else{const e=t;this.setSouthWest(e[0]).setNorthEast(e[1])}}setNorthEast(t){return this._ne=t instanceof _u?new _u(t.lng,t.lat):_u.convert(t),this}setSouthWest(t){return this._sw=t instanceof _u?new _u(t.lng,t.lat):_u.convert(t),this}extend(t){const e=this._sw,r=this._ne;let i,n;if(t instanceof _u)i=t,n=t;else{if(!(t instanceof bu))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(bu.convert(t)):this.extend(_u.convert(t)):"object"==typeof t&&null!==t&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(_u.convert(t)):this;if(i=t._sw,n=t._ne,!i||!n)return this}return e||r?(e.lng=Math.min(i.lng,e.lng),e.lat=Math.min(i.lat,e.lat),r.lng=Math.max(n.lng,r.lng),r.lat=Math.max(n.lat,r.lat)):(this._sw=new _u(i.lng,i.lat),this._ne=new _u(n.lng,n.lat)),this}getCenter(){return new _u((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new _u(this.getWest(),this.getNorth())}getSouthEast(){return new _u(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:e,lat:r}=_u.convert(t);let i=this._sw.lng<=e&&e<=this._ne.lng;return this._sw.lng>this._ne.lng&&(i=this._sw.lng>=e&&e>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&i}static convert(t){return!t||t instanceof bu?t:new bu(t)}}var xu={};!function(t,e){!function(t){function e(t,e,i){var n=r(256*t,256*(e=Math.pow(2,i)-e-1),i),o=r(256*(t+1),256*(e+1),i);return n[0]+","+n[1]+","+o[0]+","+o[1]}function r(t,e,r){var i=2*Math.PI*6378137/256/Math.pow(2,r);return[t*i-2*Math.PI*6378137/2,e*i-2*Math.PI*6378137/2]}t.getURL=function(t,r,i,n,o,s){return s=s||{},t+"?"+["bbox="+e(i,n,o),"format="+(s.format||"image/png"),"service="+(s.service||"WMS"),"version="+(s.version||"1.1.1"),"request="+(s.request||"GetMap"),"srs="+(s.srs||"EPSG:3857"),"width="+(s.width||256),"height="+(s.height||256),"layers="+r].join("&")},t.getTileBBox=e,t.getMercCoords=r,Object.defineProperty(t,"__esModule",{value:!0})}(e)}(0,xu);var wu=xu;class Tu{constructor(t,e,r){this.z=t,this.x=e,this.y=r,this.key=Pu(0,t,t,e,r)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,e){const r=wu.getTileBBox(this.x,this.y,this.z),i=function(t,e,r){let i,n="";for(let o=t;o>0;o--)i=1<<o-1,n+=(e&i?1:0)+(r&i?2:0);return n}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",i).replace("{bbox-epsg-3857}",r)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Eu{constructor(t,e){this.wrap=t,this.canonical=e,this.key=Pu(t,e.z,e.z,e.x,e.y)}}class Su{constructor(t,e,r,i,n){this.overscaledZ=t,this.wrap=e,this.canonical=new Tu(r,+i,+n),this.key=0===e&&t===r?this.canonical.key:Pu(e,t,r,i,n)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const e=this.canonical.z-t;return t>this.canonical.z?new Su(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Su(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)}calculateScaledKey(t,e=!0){if(this.overscaledZ===t&&e)return this.key;if(t>this.canonical.z)return Pu(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y);{const r=this.canonical.z-t;return Pu(this.wrap*+e,t,t,this.canonical.x>>r,this.canonical.y>>r)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}children(t){if(this.overscaledZ>=t)return[new Su(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const e=this.canonical.z+1,r=2*this.canonical.x,i=2*this.canonical.y;return[new Su(e,this.wrap,e,r,i),new Su(e,this.wrap,e,r+1,i),new Su(e,this.wrap,e,r,i+1),new Su(e,this.wrap,e,r+1,i+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Su(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Su(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Eu(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Pu(t,e,r,i,n){const o=1<<Math.min(r,22);let s=o*(n%o)+i%o;return t&&r<22&&(s+=o*o*((t<0?-2*t-1:2*t)%(1<<2*(22-r)))),16*(32*s+r)+(e-r)}const ku=[t=>{let e=t.canonical.x-1,r=t.wrap;return e<0&&(e=(1<<t.canonical.z)-1,r--),new Su(t.overscaledZ,r,t.canonical.z,e,t.canonical.y)},t=>{let e=t.canonical.x+1,r=t.wrap;return e===1<<t.canonical.z&&(e=0,r++),new Su(t.overscaledZ,r,t.canonical.z,e,t.canonical.y)},t=>new Su(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,(0===t.canonical.y?1<<t.canonical.z:t.canonical.y)-1),t=>new Su(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y===(1<<t.canonical.z)-1?0:t.canonical.y+1)];Sa(Tu,"CanonicalTileID"),Sa(Su,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Au=0,Mu=25.5;function Cu(t){return vu*Math.cos(t*Math.PI/180)}function Iu(t){return(180+t)/360}function Ou(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Lu(t,e){return t/Cu(e)}function Du(t){return 360*t-180}function Ru(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Fu(t,e){return t*Cu(Ru(e))}const Bu=85.051129;function zu(t){return Math.cos(He(Ke(t,-Bu,Bu)))}function ju(t,e){const r=Ke(e,Au,Mu),i=Math.pow(2,r);return zu(t)*vu/(512*i)}function Nu(t){return 1/Math.cos(t*Math.PI/180)}function Vu(t,e=0){const r=Math.exp(Math.PI*(1-(t.y+e/mo)/(1<<t.z)*2));return 80150034*r/(r*r+1)/mo/(1<<t.z)}class Uu{constructor(t,e,r=0){this.x=+t,this.y=+e,this.z=+r}static fromLngLat(t,e=0){const r=_u.convert(t);return new Uu(Iu(r.lng),Ou(r.lat),Lu(e,r.lat))}toLngLat(){return new _u(Du(this.x),Ru(this.y))}toAltitude(){return Fu(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/vu*Nu(Ru(this.y))}}function $u(t,e,r,i,n,o,s,a,l){const c=(e+i)/2,u=(r+n)/2,h=new Ve(c,u);a(h),function(t,e,r,i,n,o){const s=r-n,a=i-o;return Math.abs((i-e)*s-(r-t)*a)/Math.hypot(s,a)}(h.x,h.y,o.x,o.y,s.x,s.y)>=l?($u(t,e,r,c,u,o,h,a,l),$u(t,c,u,i,n,h,s,a,l)):t.push(s)}function Gu(t,e,r){let i=t[0],n=i.x,o=i.y;e(i);const s=[i];for(let a=1;a<t.length;a++){const l=t[a],{x:c,y:u}=l;e(l),$u(s,n,o,c,u,i,l,e,r),n=c,o=u,i=l}return s}function Hu(t,e,r,i){if(i(e,r)){const n=e.add(r)._mult(.5);Hu(t,e,n,i),Hu(t,n,r,i)}else t.push(r)}function qu(t,e){let r=t[0];const i=[r];for(let n=1;n<t.length;n++){const o=t[n];Hu(i,r,o,e),r=o}return i}const Wu=Math.pow(2,14)-1,Zu=-Wu-1;function Xu(t,e){const r=Math.round(t.x*e),i=Math.round(t.y*e);return t.x=Ke(r,Zu,Wu),t.y=Ke(i,Zu,Wu),(r<t.x||r>t.x+1||i<t.y||i>t.y+1)&&fr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function Yu(t,e,r){const i=t.loadGeometry(),n=t.extent,o=mo/n;if(e&&r&&r.projection.isReprojectedInTileSpace){const o=1<<e.z,{scale:s,x:a,y:l,projection:c}=r,u=t=>{const r=Du((e.x+t.x/n)/o),i=Ru((e.y+t.y/n)/o),u=c.project(r,i);t.x=(u.x*s-a)*n,t.y=(u.y*s-l)*n};for(let e=0;e<i.length;e++)if(1!==t.type)i[e]=Gu(i[e],u,1);else{const t=[];for(const r of i[e])r.x<0||r.x>=n||r.y<0||r.y>=n||(u(r),t.push(r));i[e]=t}}for(const t of i)for(const e of t)Xu(e,o);return i}function Ku(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Yu(t):[]}}function Ju(t,e,r,i,n){t.emplaceBack(2*e+(i+1)/2,2*r+(n+1)/2)}function Qu(t,e,r){const i=16384;t.emplaceBack(e.x,e.y,e.z,r[0]*i,r[1]*i,r[2]*i)}class th{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.fqid)),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new Fl,this.indexArray=new tc,this.segments=new Ac,this.programConfigurations=new eu(t.layers,{zoom:t.zoom,lut:t.lut}),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}updateFootprints(t,e){}populate(t,e,r,i){const n=this.layers[0],o=[];let s=null;"circle"===n.type&&(s=n.layout.get("circle-sort-key"));for(const{feature:e,id:n,index:a,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,c=Ku(e,t);if(!this.layers[0]._featureFilter.filter(new Ka(this.zoom),c,r))continue;const u=s?s.evaluate(c,{},r):void 0,h={id:n,properties:e.properties,type:e.type,sourceLayerIndex:l,index:a,geometry:t?c.geometry:Yu(e,r,i),patterns:{},sortKey:u};o.push(h)}s&&o.sort(((t,e)=>t.sortKey-e.sortKey));let a=null;"globe"===i.projection.name&&(this.globeExtVertexArray=new Hl,a=i.projection);for(const i of o){const{geometry:n,index:o,sourceLayerIndex:s}=i,l=t[o].feature;this.addFeature(i,n,o,e.availableImages,r,a,e.brightness),e.featureIndex.insert(l,n,o,s,this.index)}}update(t,e,r,i,n){const o=0!==Object.keys(t).length;o&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,e,o?this.stateDependentLayers:this.layers,r,i,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Pc.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,kc.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,e,r,i,n,o,s){for(const r of e)for(const e of r){const r=e.x,i=e.y;if(r<0||r>=mo||i<0||i>=mo)continue;if(o){const t=o.projectTilePoint(r,i,n),e=o.upVector(n,r,i),s=this.globeExtVertexArray;Qu(s,t,e),Qu(s,t,e),Qu(s,t,e),Qu(s,t,e)}const s=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),a=s.vertexLength;Ju(this.layoutVertexArray,r,i,-1,-1),Ju(this.layoutVertexArray,r,i,1,-1),Ju(this.layoutVertexArray,r,i,1,1),Ju(this.layoutVertexArray,r,i,-1,1),this.indexArray.emplaceBack(a,a+1,a+2),this.indexArray.emplaceBack(a,a+2,a+3),s.vertexLength+=4,s.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,{},i,n,s)}}function eh(t,e){for(let r=0;r<t.length;r++)if(uh(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(uh(t,e[r]))return!0;return!!oh(t,e)}function rh(t,e,r){return!!uh(t,e)||!!ah(e,t,r)}function ih(t,e){if(1===t.length)return ch(e,t[0]);for(let r=0;r<e.length;r++){const i=e[r];for(let e=0;e<i.length;e++)if(uh(t,i[e]))return!0}for(let r=0;r<t.length;r++)if(ch(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(oh(t,e[r]))return!0;return!1}function nh(t,e,r){if(t.length>1){if(oh(t,e))return!0;for(let i=0;i<e.length;i++)if(ah(e[i],t,r))return!0}for(let i=0;i<t.length;i++)if(ah(t[i],e,r))return!0;return!1}function oh(t,e){if(0===t.length||0===e.length)return!1;for(let r=0;r<t.length-1;r++){const i=t[r],n=t[r+1];for(let t=0;t<e.length-1;t++)if(sh(i,n,e[t],e[t+1]))return!0}return!1}function sh(t,e,r,i){return mr(t,r,i)!==mr(e,r,i)&&mr(t,e,r)!==mr(t,e,i)}function ah(t,e,r){const i=r*r;if(1===e.length)return t.distSqr(e[0])<i;for(let r=1;r<e.length;r++)if(lh(t,e[r-1],e[r])<i)return!0;return!1}function lh(t,e,r){const i=e.distSqr(r);if(0===i)return t.distSqr(e);const n=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/i;return t.distSqr(n<0?e:n>1?r:r.sub(e)._mult(n)._add(e))}function ch(t,e){let r,i,n,o=!1;for(let s=0;s<t.length;s++){r=t[s];for(let t=0,s=r.length-1;t<r.length;s=t++)i=r[t],n=r[s],i.y>e.y!=n.y>e.y&&e.x<(n.x-i.x)*(e.y-i.y)/(n.y-i.y)+i.x&&(o=!o)}return o}function uh(t,e){let r=!1;for(let i=0,n=t.length-1;i<t.length;n=i++){const o=t[i],s=t[n];o.y>e.y!=s.y>e.y&&e.x<(s.x-o.x)*(e.y-o.y)/(s.y-o.y)+o.x&&(r=!r)}return r}function hh(t,e,r,i,n){for(const o of t)if(e<=o.x&&r<=o.y&&i>=o.x&&n>=o.y)return!0;const o=[new Ve(e,r),new Ve(e,n),new Ve(i,n),new Ve(i,r)];if(t.length>2)for(const e of o)if(uh(t,e))return!0;for(let e=0;e<t.length-1;e++)if(dh(t[e],t[e+1],o))return!0;return!1}function dh(t,e,r){const i=r[0],n=r[2];if(t.x<i.x&&e.x<i.x||t.x>n.x&&e.x>n.x||t.y<i.y&&e.y<i.y||t.y>n.y&&e.y>n.y)return!1;const o=mr(t,e,r[0]);return o!==mr(t,e,r[1])||o!==mr(t,e,r[2])||o!==mr(t,e,r[3])}function ph(t,e,r,i,n,o){let s=e.y-t.y,a=t.x-e.x;if(o=o||0){const t=s*s+a*a;if(0===t)return!0;const e=Math.sqrt(t);s/=e,a/=e}return!((r.x-t.x)*s+(r.y-t.y)*a-o<0||(i.x-t.x)*s+(i.y-t.y)*a-o<0||(n.x-t.x)*s+(n.y-t.y)*a-o<0)}function fh(t,e,r,i,n,o,s){return!(ph(t,e,i,n,o,s)||ph(e,r,i,n,o,s)||ph(r,t,i,n,o,s)||ph(i,n,t,e,r,s)||ph(n,o,t,e,r,s)||ph(o,i,t,e,r,s))}function mh(t,e,r){const i=e.paint.get(t).value;return"constant"===i.kind?i.value:r.programConfigurations.get(e.id).getMaxValue(t)}function gh(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function yh(t,e,r,i,n){if(!e[0]&&!e[1])return t;const o=Ve.convert(e)._mult(n);"viewport"===r&&o._rotate(-i);const s=[];for(let e=0;e<t.length;e++)s.push(t[e].sub(o));return s}function vh(t,e,r,i){const n=Ve.convert(t)._mult(i);return"viewport"===e&&n._rotate(-r),n}let _h,bh;Sa(th,"CircleBucket",{omit:["layers"]});class xh{constructor(t,e){this.pos=t,this.dir=e}intersectsPlane(e,r,i){const n=t.$.dot(r,this.dir);if(Math.abs(n)<1e-6)return!1;const o=((e[0]-this.pos[0])*r[0]+(e[1]-this.pos[1])*r[1]+(e[2]-this.pos[2])*r[2])/n;return i[0]=this.pos[0]+this.dir[0]*o,i[1]=this.pos[1]+this.dir[1]*o,i[2]=this.pos[2]+this.dir[2]*o,!0}closestPointOnSphere(e,r,i){if(t.$.equals(this.pos,e)||0===r)return i[0]=i[1]=i[2]=0,!1;const[n,o,s]=this.dir,a=this.pos[0]-e[0],l=this.pos[1]-e[1],c=this.pos[2]-e[2],u=n*n+o*o+s*s,h=2*(a*n+l*o+c*s),d=h*h-4*u*(a*a+l*l+c*c-r*r);if(d<0){const t=Math.max(-h/2,0),e=a+n*t,u=l+o*t,d=c+s*t,p=Math.hypot(e,u,d);return i[0]=e*r/p,i[1]=u*r/p,i[2]=d*r/p,!1}{const t=(-h-Math.sqrt(d))/(2*u);if(t<0){const t=Math.hypot(a,l,c);return i[0]=a*r/t,i[1]=l*r/t,i[2]=c*r/t,!1}return i[0]=a+n*t,i[1]=l+o*t,i[2]=c+s*t,!0}}}class wh{constructor(t,e,r,i,n){this.TL=t,this.TR=e,this.BR=r,this.BL=i,this.horizon=n}static fromInvProjectionMatrix(e,r,i){const n=[-1,1,1],o=[1,1,1],s=[1,-1,1],a=[-1,-1,1],l=t.$.transformMat4(n,n,e),c=t.$.transformMat4(o,o,e),u=t.$.transformMat4(s,s,e),h=t.$.transformMat4(a,a,e);return new wh(l,c,u,h,r/i)}}function Th(e,r,i){let n=1/0,o=-1/0;const s=[];for(const a of e){t.$.sub(s,a,r);const e=t.$.dot(s,i);n=Math.min(n,e),o=Math.max(o,e)}return[n,o]}function Eh(e,r){let i=!0;for(let n=0;n<e.planes.length;n++){const o=e.planes[n];let s=0;for(let e=0;e<r.length;e++)s+=t.$.dot(o,r[e])+o[3]>=0;if(0===s)return 0;s!==r.length&&(i=!1)}return i?2:1}function Sh(t,e){for(const r of t.projections){const i=Th(e,t.points[0],r.axis);if(r.projection[1]<i[0]||r.projection[0]>i[1])return 0}return 1}function Ph(e,r){let i=0;const n=[0,0,0,0];for(let o=0;o<e.length;o++)n[0]=e[o][0],n[1]=e[o][1],n[2]=e[o][2],n[3]=1,t.aB.dot(n,r)>=0&&i++;return i}class kh{constructor(e,r){this.points=e||new Array(8).fill([0,0,0]),this.planes=r||new Array(6).fill([0,0,0,0]),this.bounds=Ah.fromPoints(this.points),this.projections=[],this.frustumEdges=[t.$.sub([],this.points[2],this.points[3]),t.$.sub([],this.points[0],this.points[3]),t.$.sub([],this.points[4],this.points[0]),t.$.sub([],this.points[5],this.points[1]),t.$.sub([],this.points[6],this.points[2]),t.$.sub([],this.points[7],this.points[3])];for(const t of this.frustumEdges){const e=[0,-t[2],t[1]],r=[t[2],0,-t[0]];this.projections.push({axis:e,projection:Th(this.points,this.points[0],e)}),this.projections.push({axis:r,projection:Th(this.points,this.points[0],r)})}}static fromInvProjectionMatrix(e,r,i,n){const o=Math.pow(2,i),s=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((i=>{const s=t.aB.transformMat4([],i,e),a=1/s[3]/r*o;return t.aB.mul(s,s,[a,a,n?1/s[3]:a,a])})),a=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((e=>{const r=t.$.sub([],s[e[0]],s[e[1]]),i=t.$.sub([],s[e[2]],s[e[1]]),n=t.$.normalize([],t.$.cross([],r,i)),o=-t.$.dot(n,s[e[1]]);return n.concat(o)})),l=[];for(let t=0;t<s.length;t++)l.push([s[t][0],s[t][1],s[t][2]]);return new kh(l,a)}intersectsPrecise(e,r,i){for(let t=0;t<r.length;t++)if(!Ph(e,r[t]))return 0;for(let t=0;t<this.planes.length;t++)if(!Ph(e,this.planes[t]))return 0;for(const r of i)for(const i of this.frustumEdges){const n=t.$.cross([],r,i),o=t.$.length(n);if(0===o)continue;t.$.scale(n,n,1/o);const s=Th(this.points,this.points[0],n),a=Th(e,this.points[0],n);if(s[0]>a[1]||a[0]>s[1])return 0}return 1}containsPoint(e){for(const r of this.planes){const i=r[3];if(t.$.dot([r[0],r[1],r[2]],e)+i<0)return!1}return!0}}class Ah{static fromPoints(e){const r=[1/0,1/0,1/0],i=[-1/0,-1/0,-1/0];for(const n of e)t.$.min(r,r,n),t.$.max(i,i,n);return new Ah(r,i)}static fromTileIdAndHeight(t,e,r){const i=1<<t.canonical.z,n=t.canonical.x,o=t.canonical.y;return new Ah([n/i,o/i,e],[(n+1)/i,(o+1)/i,r])}static applyTransform(e,r){const i=e.getCorners();for(let e=0;e<i.length;++e)t.$.transformMat4(i[e],i[e],r);return Ah.fromPoints(i)}static applyTransformFast(t,e){const r=[e[12],e[13],e[14]],i=[...r];for(let n=0;n<3;n++)for(let o=0;o<3;o++){const s=e[4*o+n],a=s*t.min[o],l=s*t.max[o];r[n]+=Math.min(a,l),i[n]+=Math.max(a,l)}return new Ah(r,i)}static projectAabbCorners(e,r){const i=e.getCorners();for(let e=0;e<i.length;++e)t.$.transformMat4(i[e],i[e],r);return i}constructor(e,r){this.min=e,this.max=r,this.center=t.$.scale([],t.$.add([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],i=t.$.clone(this.min),n=t.$.clone(this.max);for(let t=0;t<r.length;t++)i[t]=r[t]?this.min[t]:this.center[t],n[t]=r[t]?this.center[t]:this.max[t];return n[2]=this.max[2],new Ah(i,n)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,e=this.max;return[[t[0],t[1],t[2]],[e[0],t[1],t[2]],[e[0],e[1],t[2]],[t[0],e[1],t[2]],[t[0],t[1],e[2]],[e[0],t[1],e[2]],[e[0],e[1],e[2]],[t[0],e[1],e[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?Eh(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?Eh(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,e){return e||this.intersects(t)?Sh(t,this.getCorners()):0}intersectsPreciseFlat(t,e){return e||this.intersectsFlat(t)?Sh(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let e=0;e<3;++e)if(this.min[e]>t.max[e]||t.min[e]>this.max[e])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let e=0;e<3;e++)this.min[e]=Math.min(this.min[e],t.min[e]),this.max[e]=Math.max(this.max[e],t.max[e])}encapsulatePoint(t){for(let e=0;e<3;e++)this.min[e]=Math.min(this.min[e],t[e]),this.max[e]=Math.max(this.max[e],t[e])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}Sa(Ah,"Aabb");const Mh=Dl([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Ch}=Mh,Ih=Dl([{name:"a_pos_3",components:3,type:"Int16"}]);var Oh=Dl([{name:"a_pos",type:"Int16",components:2}]);function Lh(t){return t*au/yu}const Dh=[new Ah([pu,pu,pu],[fu,fu,fu]),new Ah([pu,pu,pu],[0,0,fu]),new Ah([0,pu,pu],[fu,0,fu]),new Ah([pu,0,pu],[0,fu,fu]),new Ah([0,0,pu],[fu,fu,fu])];function Rh(e,r,i,n=!0){const o=t.$.scale([],e._camera.position,e.worldSize),s=[r,i,1,1];t.aB.transformMat4(s,s,e.pixelMatrixInverse),t.aB.scale(s,s,1/s[3]);const a=t.$.sub([],s,o),l=t.$.normalize([],a),c=e.globeMatrix,u=[c[12],c[13],c[14]],h=t.$.sub([],u,o),d=t.$.length(h),p=t.$.normalize([],h),f=e.worldSize/(2*Math.PI),m=t.$.dot(p,l),g=Math.asin(f/d);if(g<Math.acos(m)){if(!n)return null;const e=[],r=[];t.$.scale(e,l,d/m),t.$.normalize(r,t.$.sub(r,e,h)),t.$.normalize(l,t.$.add(l,h,t.$.scale(l,r,Math.tan(g)*d)))}const y=[];new xh(o,l).closestPointOnSphere(u,f,y);const v=t.$.normalize([],Ar(c,0)),_=t.$.normalize([],Ar(c,1)),b=t.$.normalize([],Ar(c,2)),x=t.$.dot(v,y),w=t.$.dot(_,y),T=t.$.dot(b,y),E=qe(Math.asin(-w/f));let S=qe(Math.atan2(x,T));S=e.center.lng+function(t,e){const r=(e-t+180)%360-180;return r<-180?r+360:r}(e.center.lng,S);const P=Iu(S),k=Ke(Ou(E),0,1);return new Uu(P,k)}class Fh{constructor(e,r,i){this.a=t.$.sub([],e,i),this.b=t.$.sub([],r,i),this.center=i;const n=t.$.normalize([],this.a),o=t.$.normalize([],this.b);this.angle=Math.acos(t.$.dot(n,o))}}function Bh(t,e){if(0===t.angle)return null;let r;return r=0===t.a[e]?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),r<0||r>1?null:function(t,e,r,i){const n=Math.sin(r);return t*(Math.sin((1-i)*r)/n)+e*(Math.sin(i*r)/n)}(t.a[e],t.b[e],t.angle,Ke(r,0,1))+t.center[e]}function zh(t){if(t.z<=1)return Dh[t.z+2*t.y+t.x];const e=Gh($h(t));return Ah.fromPoints(e)}function jh(e,r,i){return t.$.scale(e,e,1-i),t.$.scaleAndAdd(e,e,r,i)}function Nh(e,r){const i=Qh(r.zoom);if(0===i)return zh(e);const n=$h(e),o=Gh(n),s=Iu(n.getWest())*r.worldSize,a=Iu(n.getEast())*r.worldSize,l=Ou(n.getNorth())*r.worldSize,c=Ou(n.getSouth())*r.worldSize,u=[s,l,0],h=[a,l,0],d=[s,c,0],p=[a,c,0],f=t.ae.invert([],r.globeMatrix);return t.$.transformMat4(u,u,f),t.$.transformMat4(h,h,f),t.$.transformMat4(d,d,f),t.$.transformMat4(p,p,f),o[0]=jh(o[0],d,i),o[1]=jh(o[1],p,i),o[2]=jh(o[2],h,i),o[3]=jh(o[3],u,i),Ah.fromPoints(o)}function Vh(e,r,i){for(const n of e)t.$.transformMat4(n,n,r),t.$.scale(n,n,i)}function Uh(e,r,i,n){const o=r/e.worldSize,s=e.globeMatrix;if(i.z<=1){const t=zh(i).getCorners();return Vh(t,s,o),Ah.fromPoints(t)}const a=$h(i,n),l=Gh(a,au+Lh(e._tileCoverLift));Vh(l,s,o);const c=Number.MAX_VALUE,u=[-c,-c,-c],h=[c,c,c];if(a.contains(e.center)){for(const e of l)t.$.min(h,h,e),t.$.max(u,u,e);u[2]=0;const r=e.point,i=[r.x*o,r.y*o,0];return t.$.min(h,h,i),t.$.max(u,u,i),new Ah(h,u)}if(e._tileCoverLift>0){for(const e of l)t.$.min(h,h,e),t.$.max(u,u,e);return new Ah(h,u)}const d=[s[12]*o,s[13]*o,s[14]*o],p=a.getCenter(),f=Ke(e.center.lat,-Bu,Bu),m=Ke(p.lat,-Bu,Bu),g=Iu(e.center.lng),y=Ou(f);let v=g-Iu(p.lng);const _=y-Ou(m);v>.5?v-=1:v<-.5&&(v+=1);let b=0;if(Math.abs(v)>Math.abs(_))b=v>=0?1:3;else{b=_>=0?0:2;const e=[s[4]*o,s[5]*o,s[6]*o],r=-Math.sin(He(_>=0?a.getSouth():a.getNorth()))*au;t.$.scaleAndAdd(d,d,e,r)}const x=l[b],w=l[(b+1)%4],T=new Fh(x,w,d),E=[Bh(T,0)||x[0],Bh(T,1)||x[1],Bh(T,2)||x[2]],S=Qh(e.zoom);if(S>0){const n=function({x:t,y:e,z:r},i,n,o,s){const a=1/(1<<r);let l=t*a,c=l+a,u=e*a,h=u+a,d=0;const p=(l+c)/2-o;return p>.5?d=-1:p<-.5&&(d=1),l=((l+d)*i-(o*=i))*n+o,c=((c+d)*i-o)*n+o,u=(u*i-(s*=i))*n+s,h=(h*i-s)*n+s,[[l,h,0],[c,h,0],[c,u,0],[l,u,0]]}(i,r,e._pixelsPerMercatorPixel,g,y);for(let t=0;t<l.length;t++)jh(l[t],n[t],S);const o=t.$.add([],n[b],n[(b+1)%4]);t.$.scale(o,o,.5),jh(E,o,S)}for(const e of l)t.$.min(h,h,e),t.$.max(u,u,e);return h[2]=Math.min(x[2],w[2]),t.$.min(h,h,E),t.$.max(u,u,E),new Ah(h,u)}function $h({x:t,y:e,z:r},i=!1){const n=1/(1<<r),o=new _u(Du(t*n),e===(1<<r)-1&&i?-90:Ru((e+1)*n)),s=new _u(Du((t+1)*n),0===e&&i?90:Ru(e*n));return new bu(o,s)}function Gh(t,e=au){const r=He(t.getNorth()),i=He(t.getSouth()),n=Math.cos(r),o=Math.cos(i),s=Math.sin(r),a=Math.sin(i),l=t.getWest(),c=t.getEast();return[mu(o,a,l,e),mu(o,a,c,e),mu(n,s,c,e),mu(n,s,l,e)]}function Hh(t,e,r,i){const n=1<<r.z,o=(t/mo+r.x)/n;return gu(Ru((e/mo+r.y)/n),Du(o),i)}function qh({min:t,max:e}){return uu/Math.max(e[0]-t[0],e[1]-t[1],e[2]-t[2])}const Wh=new Float64Array(16);function Zh(e){const r=qh(e),i=t.ae.fromScaling(Wh,[r,r,r]);return t.ae.translate(i,i,t.$.negate([],e.min))}function Xh(e){const r=t.ae.fromTranslation(Wh,e.min),i=1/qh(e);return t.ae.scale(r,r,[i,i,i])}function Yh(t){const e=mo/(2*Math.PI);return t/(2*Math.PI)/e}function Kh(t,e){return mo/(512*Math.pow(2,t))*qh(zh(e))}function Jh(e,r,i,n,o){const s=Yh(i),a=[e,r,-i/(2*Math.PI)],l=t.ae.identity(new Float64Array(16));return t.ae.translate(l,l,a),t.ae.scale(l,l,[s,s,s]),t.ae.rotateX(l,l,He(-o)),t.ae.rotateY(l,l,He(-n)),l}function Qh(t){return Je(lu,cu,t)}function td(e,r){const i=gu(r.lat,r.lng),n=function(e){const r=gu(e._center.lat,e._center.lng),i=t.$.fromValues(0,1,0);let n=t.$.cross([],i,r);const o=t.ae.fromRotation([],-e.angle,r);n=t.$.transformMat4(n,n,o),t.ae.fromRotation(o,-e._pitch,n);const s=t.$.normalize([],r);return t.$.scale(s,s,Lh(e.cameraToCenterDistance/e.pixelsPerMeter)),t.$.transformMat4(s,s,o),t.$.add([],r,s)}(e),o=t.$.subtract([],n,i);return t.$.angle(o,i)}function ed(t,e){return td(t,e)>Math.PI/2*1.01}const rd=He(85),id=Math.cos(rd),nd=Math.sin(rd),od=t.ae.create(),sd=t=>{const e=[];return"map"===t.paint.get("circle-pitch-alignment")&&e.push("PITCH_WITH_MAP"),"map"===t.paint.get("circle-pitch-scale")&&e.push("SCALE_WITH_MAP"),e};function ad(e,r,i,n,o,s,a,l,c){if(s&&e.queryGeometry.isAboveHorizon)return!1;s&&(c*=e.pixelToTileUnitsFactor);const u=e.tileID.canonical,h=i.projection.upVectorScale(u,i.center.lat,i.worldSize).metersToTile;for(const d of r)for(const r of d){const d=r.add(l),p=o&&i.elevation?i.elevation.exaggeration()*o.getElevationAt(d.x,d.y,!0):0,f=i.projection.projectTilePoint(d.x,d.y,u);if(p>0){const t=i.projection.upVector(u,d.x,d.y);f.x+=t[0]*h*p,f.y+=t[1]*h*p,f.z+=t[2]*h*p}const m=s?d:ld(f.x,f.y,f.z,n),g=s?e.tilespaceRays.map((t=>hd(t,p))):e.queryGeometry.screenGeometry,y=t.aB.transformMat4([],[f.x,f.y,f.z,1],n);if(!a&&s?c*=y[3]/i.cameraToCenterDistance:a&&!s&&(c*=i.cameraToCenterDistance/y[3]),s){const t=Ru((r.y/mo+u.y)/(1<<u.z));c/=i.projection.pixelsPerMeter(t,1)/Lu(1,t)}if(rh(g,m,c))return!0}return!1}function ld(e,r,i,n){const o=t.aB.transformMat4([],[e,r,i,1],n);return new Ve(o[0]/o[3],o[1]/o[3])}const cd=t.$.fromValues(0,0,0),ud=t.$.fromValues(0,0,1);function hd(e,r){const i=t.$.create();return cd[2]=r,e.intersectsPlane(cd,ud,i),new Ve(i[0],i[1])}class dd extends th{}function pd(t,{width:e,height:r},i,n){if(n){if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==e*r*i)throw new RangeError("mismatched image size")}else n=new Uint8Array(e*r*i);return t.width=e,t.height=r,t.data=n,t}function fd(t,e,r){const{width:i,height:n}=e;i===t.width&&n===t.height||(md(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,i),height:Math.min(t.height,n)},r,null),t.width=i,t.height=n,t.data=e.data)}function md(t,e,r,i,n,o,s,a){if(0===n.width||0===n.height)return e;if(n.width>t.width||n.height>t.height||r.x>t.width-n.width||r.y>t.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>e.width||n.height>e.height||i.x>e.width-n.width||i.y>e.height-n.height)throw new RangeError("out of range destination coordinates for image copy");const l=t.data,c=e.data,u=4===o&&a;for(let a=0;a<n.height;a++){const h=((r.y+a)*t.width+r.x)*o,d=((i.y+a)*e.width+i.x)*o;if(u)for(let t=0;t<n.width;t++){const e=h+t*o+3,r=d+t*o;c[r+0]=255,c[r+1]=255,c[r+2]=255,c[r+3]=l[e]}else if(s)for(let t=0;t<n.width;t++){const e=h+t*o,r=d+t*o,i=l[e+3],n=new Gi(l[e+0]/255*i,l[e+1]/255*i,l[e+2]/255*i,i).toRenderColor(s).toArray();c[r+0]=n[0],c[r+1]=n[1],c[r+2]=n[2],c[r+3]=n[3]}else for(let t=0;t<n.width*o;t++)c[d+t]=l[h+t]}return e}Sa(dd,"HeatmapBucket",{omit:["layers"]});class gd{constructor(t,e){pd(this,t,1,e)}resize(t){fd(this,new gd(t),1)}clone(){return new gd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,r,i,n){md(t,e,r,i,n,1,null)}}class yd{constructor(t,e){pd(this,t,4,e)}resize(t){fd(this,new yd(t),4)}replace(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new yd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,r,i,n,o,s){md(t,e,r,i,n,4,o,s)}}class vd{constructor(t,e){this.width=t.width,this.height=t.height,this.data=e instanceof Uint8Array?new Float32Array(e.buffer):e}}let _d,bd,xd,wd;function Td(t){const e={},r=t.resolution||256,i=t.clips?t.clips.length:1,n=t.image||new yd({width:r,height:i}),o=(r,i,o)=>{e[t.evaluationKey]=o;const s=t.expression.evaluate(e);s&&(n.data[r+i+0]=Math.floor(255*s.r/s.a),n.data[r+i+1]=Math.floor(255*s.g/s.a),n.data[r+i+2]=Math.floor(255*s.b/s.a),n.data[r+i+3]=Math.floor(255*s.a))};if(t.clips)for(let e=0,n=0;e<i;++e,n+=4*r)for(let i=0,s=0;i<r;i++,s+=4){const a=i/(r-1),{start:l,end:c}=t.clips[e];o(n,s,l*(1-a)+c*a)}else for(let t=0,e=0;t<r;t++,e+=4)o(0,e,t/(r-1));return n}Sa(gd,"AlphaImage"),Sa(yd,"RGBAImage");const Ed=Dl([{name:"a_pos",components:2,type:"Int16"}],4),{members:Sd}=Ed;function Pd(t,e,r=2){const i=e&&e.length,n=i?e[0]*r:t.length;let o=kd(t,0,n,r,!0);const s=[];if(!o||o.next===o.prev)return s;let a,l,c;if(i&&(o=function(t,e,r,i){const n=[];for(let r=0,o=e.length;r<o;r++){const s=kd(t,e[r]*i,r<o-1?e[r+1]*i:t.length,i,!1);s===s.next&&(s.steiner=!0),n.push(zd(s))}n.sort(Dd);for(let t=0;t<n.length;t++)r=Rd(n[t],r);return r}(t,e,o,r)),t.length>80*r){a=1/0,l=1/0;let e=-1/0,i=-1/0;for(let o=r;o<n;o+=r){const r=t[o],n=t[o+1];r<a&&(a=r),n<l&&(l=n),r>e&&(e=r),n>i&&(i=n)}c=Math.max(e-a,i-l),c=0!==c?32767/c:0}return Md(o,s,r,a,l,c,0),s}function kd(t,e,r,i,n){let o;if(n===function(t,e,r,i){let n=0;for(let o=e,s=r-i;o<r;o+=i)n+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return n}(t,e,r,i)>0)for(let n=e;n<r;n+=i)o=Zd(n/i|0,t[n],t[n+1],o);else for(let n=r-i;n>=e;n-=i)o=Zd(n/i|0,t[n],t[n+1],o);return o&&Ud(o,o.next)&&(Xd(o),o=o.next),o}function Ad(t,e){if(!t)return t;e||(e=t);let r,i=t;do{if(r=!1,i.steiner||!Ud(i,i.next)&&0!==Vd(i.prev,i,i.next))i=i.next;else{if(Xd(i),i=e=i.prev,i===i.next)break;r=!0}}while(r||i!==e);return e}function Md(t,e,r,i,n,o,s){if(!t)return;!s&&o&&function(t,e,r,i){let n=t;do{0===n.z&&(n.z=Bd(n.x,n.y,e,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){let e,r=1;do{let i,n=t;t=null;let o=null;for(e=0;n;){e++;let s=n,a=0;for(let t=0;t<r&&(a++,s=s.nextZ,s);t++);let l=r;for(;a>0||l>0&&s;)0!==a&&(0===l||!s||n.z<=s.z)?(i=n,n=n.nextZ,a--):(i=s,s=s.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=s}o.nextZ=null,r*=2}while(e>1)}(n)}(t,i,n,o);let a=t;for(;t.prev!==t.next;){const l=t.prev,c=t.next;if(o?Id(t,i,n,o):Cd(t))e.push(l.i,t.i,c.i),Xd(t),t=c.next,a=c.next;else if((t=c)===a){s?1===s?Md(t=Od(Ad(t),e),e,r,i,n,o,2):2===s&&Ld(t,e,r,i,n,o):Md(Ad(t),e,r,i,n,o,1);break}}}function Cd(t){const e=t.prev,r=t,i=t.next;if(Vd(e,r,i)>=0)return!1;const n=e.x,o=r.x,s=i.x,a=e.y,l=r.y,c=i.y,u=n<o?n<s?n:s:o<s?o:s,h=a<l?a<c?a:c:l<c?l:c,d=n>o?n>s?n:s:o>s?o:s,p=a>l?a>c?a:c:l>c?l:c;let f=i.next;for(;f!==e;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&jd(n,a,o,l,s,c,f.x,f.y)&&Vd(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Id(t,e,r,i){const n=t.prev,o=t,s=t.next;if(Vd(n,o,s)>=0)return!1;const a=n.x,l=o.x,c=s.x,u=n.y,h=o.y,d=s.y,p=a<l?a<c?a:c:l<c?l:c,f=u<h?u<d?u:d:h<d?h:d,m=a>l?a>c?a:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,y=Bd(p,f,e,r,i),v=Bd(m,g,e,r,i);let _=t.prevZ,b=t.nextZ;for(;_&&_.z>=y&&b&&b.z<=v;){if(_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==n&&_!==s&&jd(a,u,l,h,c,d,_.x,_.y)&&Vd(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==n&&b!==s&&jd(a,u,l,h,c,d,b.x,b.y)&&Vd(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;_&&_.z>=y;){if(_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==n&&_!==s&&jd(a,u,l,h,c,d,_.x,_.y)&&Vd(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;b&&b.z<=v;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==n&&b!==s&&jd(a,u,l,h,c,d,b.x,b.y)&&Vd(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Od(t,e){let r=t;do{const i=r.prev,n=r.next.next;!Ud(i,n)&&$d(i,r,r.next,n)&&qd(i,n)&&qd(n,i)&&(e.push(i.i,r.i,n.i),Xd(r),Xd(r.next),r=t=n),r=r.next}while(r!==t);return Ad(r)}function Ld(t,e,r,i,n,o){let s=t;do{let t=s.next.next;for(;t!==s.prev;){if(s.i!==t.i&&Nd(s,t)){let a=Wd(s,t);return s=Ad(s,s.next),a=Ad(a,a.next),Md(s,e,r,i,n,o,0),void Md(a,e,r,i,n,o,0)}t=t.next}s=s.next}while(s!==t)}function Dd(t,e){return t.x-e.x}function Rd(t,e){const r=function(t,e){let r=e;const i=t.x,n=t.y;let o,s=-1/0;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){const t=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(t<=i&&t>s&&(s=t,o=r.x<r.next.x?r:r.next,t===i))return o}r=r.next}while(r!==e);if(!o)return null;const a=o,l=o.x,c=o.y;let u=1/0;r=o;do{if(i>=r.x&&r.x>=l&&i!==r.x&&jd(n<c?i:s,n,l,c,n<c?s:i,n,r.x,r.y)){const e=Math.abs(n-r.y)/(i-r.x);qd(r,t)&&(e<u||e===u&&(r.x>o.x||r.x===o.x&&Fd(o,r)))&&(o=r,u=e)}r=r.next}while(r!==a);return o}(t,e);if(!r)return e;const i=Wd(r,t);return Ad(i,i.next),Ad(r,r.next)}function Fd(t,e){return Vd(t.prev,t,e.prev)<0&&Vd(e.next,t,t.next)<0}function Bd(t,e,r,i,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*n|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*n|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function zd(t){let e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function jd(t,e,r,i,n,o,s,a){return(n-s)*(e-a)>=(t-s)*(o-a)&&(t-s)*(i-a)>=(r-s)*(e-a)&&(r-s)*(o-a)>=(n-s)*(i-a)}function Nd(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&$d(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(qd(t,e)&&qd(e,t)&&function(t,e){let r=t,i=!1;const n=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==t);return i}(t,e)&&(Vd(t.prev,t,e.prev)||Vd(t,e.prev,e))||Ud(t,e)&&Vd(t.prev,t,t.next)>0&&Vd(e.prev,e,e.next)>0)}function Vd(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Ud(t,e){return t.x===e.x&&t.y===e.y}function $d(t,e,r,i){const n=Hd(Vd(t,e,r)),o=Hd(Vd(t,e,i)),s=Hd(Vd(r,i,t)),a=Hd(Vd(r,i,e));return n!==o&&s!==a||!(0!==n||!Gd(t,r,e))||!(0!==o||!Gd(t,i,e))||!(0!==s||!Gd(r,t,i))||!(0!==a||!Gd(r,e,i))}function Gd(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Hd(t){return t>0?1:t<0?-1:0}function qd(t,e){return Vd(t.prev,t,t.next)<0?Vd(t,e,t.next)>=0&&Vd(t,t.prev,e)>=0:Vd(t,e,t.prev)<0||Vd(t,t.next,e)<0}function Wd(t,e){const r=Yd(t.i,t.x,t.y),i=Yd(e.i,e.x,e.y),n=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=n,n.prev=r,i.next=r,r.prev=i,o.next=i,i.prev=o,i}function Zd(t,e,r,i){const n=Yd(t,e,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function Xd(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Yd(t,e,r){return{i:t,x:e,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Kd(t,e){const r=t.length;if(r<=1)return[t];const i=[];let n,o;for(let e=0;e<r;e++){const r=gr(t[e]);0!==r&&(t[e].area=Math.abs(r),void 0===o&&(o=r<0),o===r<0?(n&&i.push(n),n=[t[e]]):n.push(t[e]))}if(n&&i.push(n),e>1)for(let t=0;t<i.length;t++)i[t].length<=e||(Bn(i[t],e,1,i[t].length-1,Jd),i[t]=i[t].slice(0,e));return i}function Jd(t,e){return e.area-t.area}function Qd(t,e,r){const i=r.patternDependencies;let n=!1;for(const r of e){const e=r.paint.get(`${t}-pattern`);e.isConstant()||(n=!0);const o=e.constantOr(null);o&&(n=!0,i[o]=!0)}return n}function tp(t,e,r,i,n){const o=n.patternDependencies;for(const s of e){const e=s.paint.get(`${t}-pattern`).value;if("constant"!==e.kind){let t=e.evaluate({zoom:i},r,{},n.availableImages);t=t&&t.name?t.name:t,o[t]=!0,r.patterns[s.id]=t}}return r}class ep{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.fqid)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Fl,this.indexArray=new tc,this.indexArray2=new Xl,this.programConfigurations=new eu(t.layers,{zoom:t.zoom,lut:t.lut}),this.segments=new Ac,this.segments2=new Ac,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.projection=t.projection}updateFootprints(t,e){}populate(t,e,r,i){this.hasPattern=Qd("fill",this.layers,e);const n=this.layers[0].layout.get("fill-sort-key"),o=[];for(const{feature:s,id:a,index:l,sourceLayerIndex:c}of t){const t=this.layers[0]._featureFilter.needGeometry,u=Ku(s,t);if(!this.layers[0]._featureFilter.filter(new Ka(this.zoom),u,r))continue;const h=n?n.evaluate(u,{},r,e.availableImages):void 0,d={id:a,properties:s.properties,type:s.type,sourceLayerIndex:c,index:l,geometry:t?u.geometry:Yu(s,r,i),patterns:{},sortKey:h};o.push(d)}n&&o.sort(((t,e)=>t.sortKey-e.sortKey));for(const i of o){const{geometry:n,index:o,sourceLayerIndex:s}=i;if(this.hasPattern){const t=tp("fill",this.layers,i,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(i,n,o,r,{},e.availableImages,e.brightness);e.featureIndex.insert(t[o].feature,n,o,s,this.index)}}update(t,e,r,i,n){const o=0!==Object.keys(t).length;o&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,e,o?this.stateDependentLayers:this.layers,r,i,n)}addFeatures(t,e,r,i,n,o){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,r,i,o)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Sd),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,e,r,i,n,o=[],s){for(const t of Kd(e,500)){let e=0;for(const r of t)e+=r.length;const r=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),i=r.vertexLength,n=[],o=[];for(const e of t){if(0===e.length)continue;e!==t[0]&&o.push(n.length/2);const r=this.segments2.prepareSegment(e.length,this.layoutVertexArray,this.indexArray2),i=r.vertexLength;this.layoutVertexArray.emplaceBack(e[0].x,e[0].y),this.indexArray2.emplaceBack(i+e.length-1,i),n.push(e[0].x),n.push(e[0].y);for(let t=1;t<e.length;t++)this.layoutVertexArray.emplaceBack(e[t].x,e[t].y),this.indexArray2.emplaceBack(i+t-1,i+t),n.push(e[t].x),n.push(e[t].y);r.vertexLength+=e.length,r.primitiveLength+=e.length}const s=Pd(n,o);for(let t=0;t<s.length;t+=3)this.indexArray.emplaceBack(i+s[t],i+s[t+1],i+s[t+2]);r.vertexLength+=e,r.primitiveLength+=s.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,n,o,i,s)}}let rp,ip,np,op;Sa(ep,"FillBucket",{omit:["layers","patternFeatures"]});class sp{constructor(t,e,r,i){if(this.triangleCount=e.length/3,this.min=new Ve(0,0),this.max=new Ve(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],0===this.triangleCount||0===t.length)return;const[n,o]=[t[0].clone(),t[0].clone()];for(let e=1;e<t.length;++e){const r=t[e];n.x=Math.min(n.x,r.x),n.y=Math.min(n.y,r.y),o.x=Math.max(o.x,r.x),o.y=Math.max(o.y,r.y)}if(i){const t=Math.ceil(Math.max(o.x-n.x,o.y-n.y)/i);r=Math.max(r,t)}if(0===r)return;this.min=n,this.max=o;const s=this.max.sub(this.min);s.x=Math.max(s.x,1),s.y=Math.max(s.y,1);const a=Math.max(s.x,s.y)/r;this.cellsX=Math.max(1,Math.ceil(s.x/a)),this.cellsY=Math.max(1,Math.ceil(s.y/a)),this.xScale=1/a,this.yScale=1/a;const l=[];for(let r=0;r<this.triangleCount;r++){const i=t[e[3*r+0]].sub(this.min),n=t[e[3*r+1]].sub(this.min),o=t[e[3*r+2]].sub(this.min),s=ap(Math.floor(Math.min(i.x,n.x,o.x)),this.xScale,this.cellsX),c=ap(Math.floor(Math.max(i.x,n.x,o.x)),this.xScale,this.cellsX),u=ap(Math.floor(Math.min(i.y,n.y,o.y)),this.yScale,this.cellsY),h=ap(Math.floor(Math.max(i.y,n.y,o.y)),this.yScale,this.cellsY),d=new Ve(0,0),p=new Ve(0,0),f=new Ve(0,0),m=new Ve(0,0);for(let t=u;t<=h;++t){d.y=p.y=t*a,f.y=m.y=(t+1)*a;for(let e=s;e<=c;++e)d.x=f.x=e*a,p.x=m.x=(e+1)*a,(fh(i,n,o,d,p,m)||fh(i,n,o,d,m,f))&&l.push({cellIdx:t*this.cellsX+e,triIdx:r})}}if(0===l.length)return;l.sort(((t,e)=>t.cellIdx-e.cellIdx||t.triIdx-e.triIdx));let c=0;for(;c<l.length;){const t=l[c].cellIdx,e={start:this.payload.length,len:0};for(;c<l.length&&l[c].cellIdx===t;)++e.len,this.payload.push(l[c++].triIdx);this.cells[t]=e}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(t,e){if(0===this.triangleCount||0===this.cells.length)return;if(t.x>this.max.x||this.min.x>t.x||t.y>this.max.y||this.min.y>t.y)return;const r=ap(t.x-this.min.x,this.xScale,this.cellsX),i=ap(t.y-this.min.y,this.yScale,this.cellsY),n=this.cells[i*this.cellsX+r];if(n){this._lazyInitLookup();for(let t=0;t<n.len;t++){const r=this.payload[n.start+t],i=Math.floor(r/8),o=1<<r%8;if(!(this.lookup[i]&o)&&(this.lookup[i]|=o,e.push(r),e.length===this.triangleCount))return}}}query(t,e,r){if(0===this.triangleCount||0===this.cells.length)return;if(t.x>this.max.x||this.min.x>e.x)return;if(t.y>this.max.y||this.min.y>e.y)return;this._lazyInitLookup();const i=ap(t.x-this.min.x,this.xScale,this.cellsX),n=ap(e.x-this.min.x,this.xScale,this.cellsX),o=ap(t.y-this.min.y,this.yScale,this.cellsY),s=ap(e.y-this.min.y,this.yScale,this.cellsY);for(let t=o;t<=s;t++)for(let e=i;e<=n;e++){const i=this.cells[t*this.cellsX+e];if(i)for(let t=0;t<i.len;t++){const e=this.payload[i.start+t],n=Math.floor(e/8),o=1<<e%8;if(!(this.lookup[n]&o)&&(this.lookup[n]|=o,r.push(e),r.length===this.triangleCount))return}}}}function ap(t,e,r){return Math.max(0,Math.min(r-1,Math.floor(t*e)))}Sa(sp,"TriangleGridIndex");class lp{constructor(t){this.zoom=t.zoom,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.fqid)),this.index=t.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.footprints=[]}updateFootprints(t,e){for(const r of this.footprints)e.push({footprint:r,id:t})}populate(t,e,r,i){const n=[];for(const{feature:e,id:o,index:s,sourceLayerIndex:a}of t){const t=this.layers[0]._featureFilter.needGeometry,l=Ku(e,t);if(!this.layers[0]._featureFilter.filter(new Ka(this.zoom),l,r))continue;const c={id:o,properties:e.properties,type:e.type,sourceLayerIndex:a,index:s,geometry:t?l.geometry:Yu(e,r,i),patterns:{}};n.push(c)}for(const i of n){const{geometry:n,index:o,sourceLayerIndex:s}=i;this.addFeature(i,n,o,r,{},e.availableImages,e.brightness),e.featureIndex.insert(t[o].feature,n,o,s,this.index)}}isEmpty(){return 0===this.footprints.length}uploadPending(){return!1}upload(t){}update(t,e,r,i,n){}destroy(){}addFeature(t,e,r,i,n,o=[],s){for(const t of Kd(e,2)){const e=[],r=[],i=[],n=new Ve(1/0,1/0),o=new Ve(-1/0,-1/0);for(const s of t)if(0!==s.length){s!==t[0]&&i.push(r.length/2);for(let t=0;t<s.length;t++)r.push(s[t].x),r.push(s[t].y),e.push(s[t]),n.x=Math.min(n.x,s[t].x),n.y=Math.min(n.y,s[t].y),o.x=Math.max(o.x,s[t].x),o.y=Math.max(o.y,s[t].y)}const s=Pd(r,i),a=new sp(e,s,8,256);this.footprints.push({vertices:e,indices:s,grid:a,min:n,max:o})}}}Sa(lp,"ClipBucket",{omit:["layers"]});const cp=Dl([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),up=Dl([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),hp=Dl([{name:"a_centroid_pos",components:2,type:"Uint16"}]),dp=Dl([{name:"a_join_normal_inside_polygon",components:4,type:"Int16"}]),pp=Dl([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),fp=Dl([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:mp}=cp;var gp={},yp=je,vp=_p;function _p(t,e,r,i,n){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=n,t.readFields(bp,this,e)}function bp(t,e,r){1==t?e.id=r.readVarint():2==t?function(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var i=e._keys[t.readVarint()],n=e._values[t.readVarint()];e.properties[i]=n}}(r,e):3==t?e.type=r.readVarint():4==t&&(e._geometry=r.pos)}function xp(t){for(var e,r,i=0,n=0,o=t.length,s=o-1;n<o;s=n++)i+=((r=t[s]).x-(e=t[n]).x)*(e.y+r.y);return i}_p.types=["Unknown","Point","LineString","Polygon"],_p.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,i=1,n=0,o=0,s=0,a=[];t.pos<r;){if(n<=0){var l=t.readVarint();i=7&l,n=l>>3}if(n--,1===i||2===i)o+=t.readSVarint(),s+=t.readSVarint(),1===i&&(e&&a.push(e),e=[]),e.push(new yp(o,s));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&a.push(e),a},_p.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,i=0,n=0,o=0,s=1/0,a=-1/0,l=1/0,c=-1/0;t.pos<e;){if(i<=0){var u=t.readVarint();r=7&u,i=u>>3}if(i--,1===r||2===r)(n+=t.readSVarint())<s&&(s=n),n>a&&(a=n),(o+=t.readSVarint())<l&&(l=o),o>c&&(c=o);else if(7!==r)throw new Error("unknown command "+r)}return[s,l,a,c]},_p.prototype.toGeoJSON=function(t,e,r){var i,n,o=this.extent*Math.pow(2,r),s=this.extent*t,a=this.extent*e,l=this.loadGeometry(),c=_p.types[this.type];function u(t){for(var e=0;e<t.length;e++){var r=t[e];t[e]=[360*(r.x+s)/o-180,360/Math.PI*Math.atan(Math.exp((180-360*(r.y+a)/o)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(i=0;i<l.length;i++)h[i]=l[i][0];u(l=h);break;case 2:for(i=0;i<l.length;i++)u(l[i]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var r,i,n=[],o=0;o<e;o++){var s=xp(t[o]);0!==s&&(void 0===i&&(i=s<0),i===s<0?(r&&n.push(r),r=[t[o]]):r.push(t[o]))}return r&&n.push(r),n}(l),i=0;i<l.length;i++)for(n=0;n<l[i].length;n++)u(l[i][n])}1===l.length?l=l[0]:c="Multi"+c;var d={type:"Feature",geometry:{type:c,coordinates:l},properties:this.properties};return"id"in this&&(d.id=this.id),d};var wp=vp,Tp=Ep;function Ep(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Sp,this,e),this.length=this._features.length}function Sp(t,e,r){15===t?e.version=r.readVarint():1===t?e.name=r.readString():5===t?e.extent=r.readVarint():2===t?e._features.push(r.pos):3===t?e._keys.push(r.readString()):4===t&&e._values.push(function(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var i=t.readVarint()>>3;e=1===i?t.readString():2===i?t.readFloat():3===i?t.readDouble():4===i?t.readVarint64():5===i?t.readVarint():6===i?t.readSVarint():7===i?t.readBoolean():null}return e}(r))}Ep.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new wp(this._pbf,e,this.extent,this._keys,this._values)};var Pp=Tp;function kp(t,e,r){if(3===t){var i=new Pp(r,r.readVarint()+r.pos);i.length&&(e[i.name]=i)}}var Ap=gp.VectorTile=function(t,e){this.layers=t.readFields(kp,{},e)},Mp=gp.VectorTileFeature=vp;gp.VectorTileLayer=Tp;class Cp extends Ve{constructor(t,e,r){super(t,e),this.z=r}}class Ip extends Cp{constructor(t,e,r,i){super(t,e,r),this.w=i}}function Op(t,e,r,i){const n=[],o=0===i?(t,e,r,i,n,o)=>{t.push(new Ve(o,r+(o-e)/(i-e)*(n-r)))}:(t,e,r,i,n,o)=>{t.push(new Ve(e+(o-r)/(n-r)*(i-e),o))};for(const s of t){const t=[];for(const n of s){if(n.length<=2)continue;const s=[];for(let t=0;t<n.length-1;t++){const a=n[t].x,l=n[t].y,c=n[t+1].x,u=n[t+1].y,h=0===i?a:l,d=0===i?c:u;h<e?d>e&&o(s,a,l,c,u,e):h>r?d<r&&o(s,a,l,c,u,r):s.push(n[t]),d<e&&h>=e&&o(s,a,l,c,u,e),d>r&&h<=r&&o(s,a,l,c,u,r)}let a=n[n.length-1];const l=0===i?a.x:a.y;l>=e&&l<=r&&s.push(a),s.length&&(a=s[s.length-1],s[0].x===a.x&&s[0].y===a.y||s.push(s[0]),t.push(s))}t.length&&n.push(t)}return n}function Lp(t,e,r,i){const n="x"===r?"y":"x",o=(i-t[r])/(e[r]-t[r]);t[n]=t[n]+(e[n]-t[n])*o,t[r]=i,t.hasOwnProperty("z")&&(t.z=qi(t.z,e.z,o)),t.hasOwnProperty("w")&&(t.w=qi(t.w,e.w,o))}function Dp(t,e,r,i){const n=r,o=i;for(const r of["x","y"]){let i=t,s=e;i[r]>=s[r]&&(i=e,s=t),i[r]<n&&s[r]>n&&Lp(i,s,r,n),i[r]<o&&s[r]>o&&Lp(s,i,r,o)}}const Rp=Number.MAX_SAFE_INTEGER;function Fp(t,e,r,i){return t.order<e||t.order===Rp||!(t.clipMask&r)||function(t,e){return 0!==e.length&&void 0===e.find((e=>e===t))}(i,t.clipScope)}function Bp(t,e){return t.x-e.x||t.y-e.y}function zp(t,e){return 0===Bp(t.min,e.min)&&0===Bp(t.max,e.max)}function jp(t,e){return!(t.min.x>e.max.x||t.max.x<e.min.x||t.min.y>e.max.y||t.max.y<e.min.y)}function Np(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r].sourceId!==e[r].sourceId||!zp(t[r],e[r])||t[r].order!==e[r].order||t[r].clipMask!==e[r].clipMask||!Ue(t[r].clipScope,e[r].clipScope))return!1;return!0}function Vp(t,e,r){const i=1/mo,n=1/(1<<r.canonical.z),o=(e.x*i+r.canonical.x)*n+r.wrap,s=(e.y*i+r.canonical.y)*n;return{min:new Ve((t.x*i+r.canonical.x)*n+r.wrap,(t.y*i+r.canonical.y)*n),max:new Ve(o,s)}}function Up(t,e,r){const i=1<<r.canonical.z,n=((e.x-r.wrap)*i-r.canonical.x)*mo,o=(e.y*i-r.canonical.y)*mo;return{min:new Ve(((t.x-r.wrap)*i-r.canonical.x)*mo,(t.y*i-r.canonical.y)*mo),max:new Ve(n,o)}}function $p(t,e,r,i,n,o,s){const a=t.indices,l=t.vertices,c=[];for(let u=i;u<i+n;u+=3){const i=e[r[u+0]+o],n=e[r[u+1]+o],h=e[r[u+2]+o],d=Math.min(i.x,n.x,h.x),p=Math.max(i.x,n.x,h.x),f=Math.min(i.y,n.y,h.y),m=Math.max(i.y,n.y,h.y);c.length=0,t.grid.query(new Ve(d,f),new Ve(p,m),c);for(let t=0;t<c.length;t++){const e=c[t];if(fh(l[a[3*e+0]],l[a[3*e+1]],l[a[3*e+2]],i,n,h,s))return!0}}return!1}function Gp(t,e,r,i){if(!t||!r)return!1;let n=t.vertices;if(!e.canonical.equals(i.canonical)||e.wrap!==i.wrap){if(r.vertices.length<t.vertices.length)return Gp(r,i,t,e);const o=e.canonical,s=i.canonical,a=Math.pow(2,s.z-o.z);n=t.vertices.map((t=>new Ve((t.x+o.x*mo)*a-s.x*mo,(t.y+o.y*mo)*a-s.y*mo)))}return $p(r,n,t.indices,0,t.indices.length,0,0)}function Hp(t,e,r,i){const n=Math.pow(2,i.z-r.z);return new Ve((t+r.x*mo)*n-i.x*mo,(e+r.y*mo)*n-i.y*mo)}function qp(t,e){const r=[];e.footprint.grid.queryPoint(t,r);const i=e.footprint.indices,n=e.footprint.vertices;for(let e=0;e<r.length;e++){const o=r[e];if(uh([n[i[3*o+0]],n[i[3*o+1]],n[i[3*o+2]]],t))return!0}return!1}class Wp{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,e){const r=this.toIdx(t,e);return{min:this.minimums[r],max:this.maximums[r]}}isLeaf(t,e){return this.leaves[this.toIdx(t,e)]}toIdx(t,e){return e*this.size+t}}function Zp(t,e,r,i){let n=0,o=Number.MAX_VALUE;for(let s=0;s<3;s++)if(Math.abs(i[s])<1e-15){if(r[s]<t[s]||r[s]>e[s])return null}else{const a=1/i[s];let l=(t[s]-r[s])*a,c=(e[s]-r[s])*a;if(l>c){const t=l;l=c,c=t}if(l>n&&(n=l),c<o&&(o=c),n>o)return null}return n}function Xp(t,e,r,i,n,o,s,a,l,c,u){const h=i-t,d=n-e,p=o-r,f=s-t,m=a-e,g=l-r,y=u[1]*g-u[2]*m,v=u[2]*f-u[0]*g,_=u[0]*m-u[1]*f,b=h*y+d*v+p*_;if(Math.abs(b)<1e-15)return null;const x=1/b,w=c[0]-t,T=c[1]-e,E=c[2]-r,S=(w*y+T*v+E*_)*x;if(S<0||S>1)return null;const P=T*p-E*d,k=E*h-w*p,A=w*d-T*h,M=(u[0]*P+u[1]*k+u[2]*A)*x;return M<0||S+M>1?null:(f*P+m*k+g*A)*x}function Yp(t,e,r){return(t-e)/(r-e)}function Kp(t,e,r,i,n,o,s,a,l){const c=1<<r,u=o-i,h=s-n,d=(t+1)/c*u+i,p=(e+0)/c*h+n,f=(e+1)/c*h+n;a[0]=(t+0)/c*u+i,a[1]=p,l[0]=d,l[1]=f}class Jp{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const e=function(t){const e=Math.ceil(Math.log2(t.dim/8)),r=[];let i=Math.ceil(Math.pow(2,e));const n=1/i,o=(t,e,r,i,n)=>{const o=i?1:0,s=(t+1)*r-o,a=e*r,l=(e+1)*r-o;n[0]=t*r,n[1]=a,n[2]=s,n[3]=l};let s=new Wp(i);const a=[];for(let e=0;e<i*i;e++){o(e%i,Math.floor(e/i),n,!1,a);const r=tf(a[0],a[1],t),l=tf(a[2],a[1],t),c=tf(a[2],a[3],t),u=tf(a[0],a[3],t);s.minimums.push(Math.min(r,l,c,u)),s.maximums.push(Math.max(r,l,c,u)),s.leaves.push(1)}for(r.push(s),i/=2;i>=1;i/=2){const t=r[r.length-1];s=new Wp(i);for(let e=0;e<i*i;e++){o(e%i,Math.floor(e/i),2,!0,a);const r=t.getElevation(a[0],a[1]),n=t.getElevation(a[2],a[1]),l=t.getElevation(a[2],a[3]),c=t.getElevation(a[0],a[3]),u=t.isLeaf(a[0],a[1]),h=t.isLeaf(a[2],a[1]),d=t.isLeaf(a[2],a[3]),p=t.isLeaf(a[0],a[3]),f=Math.min(r.min,n.min,l.min,c.min),m=Math.max(r.max,n.max,l.max,c.max),g=u&&h&&d&&p;s.maximums.push(m),s.minimums.push(f),s.leaves.push(m-f<=5&&g?1:0)}r.push(s)}return r}(this.dem),r=e.length-1,i=e[r];this._addNode(i.minimums[0],i.maximums[0],i.leaves[0]),this._construct(e,0,0,r,0)}raycastRoot(t,e,r,i,n,o,s=1){return Zp([t,e,-100],[r,i,this.maximums[0]*s],n,o)}raycast(e,r,i,n,o,s,a=1){if(!this.nodeCount)return null;const l=this.raycastRoot(e,r,i,n,o,s,a);if(null==l)return null;const c=[],u=[],h=[],d=[],p=[{idx:0,t:l,nodex:0,nodey:0,depth:0}];for(;p.length>0;){const{idx:l,t:f,nodex:m,nodey:g,depth:y}=p.pop();if(this.leaves[l]){Kp(m,g,y,e,r,i,n,h,d);const l=1<<y,c=(m+0)/l,u=(m+1)/l,p=(g+0)/l,v=(g+1)/l,_=tf(c,p,this.dem)*a,b=tf(u,p,this.dem)*a,x=tf(u,v,this.dem)*a,w=tf(c,v,this.dem)*a,T=Xp(h[0],h[1],_,d[0],h[1],b,d[0],d[1],x,o,s),E=Xp(d[0],d[1],x,h[0],d[1],w,h[0],h[1],_,o,s),S=Math.min(null!==T?T:Number.MAX_VALUE,null!==E?E:Number.MAX_VALUE);if(S!==Number.MAX_VALUE)return S;{const e=t.$.scaleAndAdd([],o,s,f);if(Qp(_,b,w,x,Yp(e[0],h[0],d[0]),Yp(e[1],h[1],d[1]))>=e[2])return f}continue}let v=0;for(let t=0;t<this._siblingOffset.length;t++){Kp((m<<1)+this._siblingOffset[t][0],(g<<1)+this._siblingOffset[t][1],y+1,e,r,i,n,h,d),h[2]=-100,d[2]=this.maximums[this.childOffsets[l]+t]*a;const p=Zp(h,d,o,s);if(null!=p){const e=p;c[t]=e;let r=!1;for(let i=0;i<v&&!r;i++)e>=c[u[i]]&&(u.splice(i,0,t),r=!0);r||(u[v]=t),v++}}for(let t=0;t<v;t++){const e=u[t];p.push({idx:this.childOffsets[l]+e,t:c[e],nodex:(m<<1)+this._siblingOffset[e][0],nodey:(g<<1)+this._siblingOffset[e][1],depth:y+1})}}return null}_addNode(t,e,r){return this.minimums.push(t),this.maximums.push(e),this.leaves.push(r),this.childOffsets.push(0),this.nodeCount++}_construct(t,e,r,i,n){if(1===t[i].isLeaf(e,r))return;this.childOffsets[n]||(this.childOffsets[n]=this.nodeCount);const o=i-1,s=t[o];let a=0,l=0;for(let t=0;t<this._siblingOffset.length;t++){const i=2*e+this._siblingOffset[t][0],n=2*r+this._siblingOffset[t][1],o=s.getElevation(i,n),c=s.isLeaf(i,n),u=this._addNode(o.min,o.max,c);c&&(a|=1<<t),l||(l=u)}for(let i=0;i<this._siblingOffset.length;i++)a&1<<i||this._construct(t,2*e+this._siblingOffset[i][0],2*r+this._siblingOffset[i][1],o,l+i)}}function Qp(t,e,r,i,n,o){return qi(qi(t,r,o),qi(e,i,o),n)}function tf(t,e,r){const i=r.dim,n=Ke(t*i-.5,0,i-1),o=Ke(e*i-.5,0,i-1),s=Math.floor(n),a=Math.floor(o),l=Math.min(s+1,i-1),c=Math.min(a+1,i-1);return Qp(r.get(s,a),r.get(l,a),r.get(s,c),r.get(l,c),n-s,o-a)}const ef={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function rf(t,e,r){return(256*t*256+256*e+r)/10-1e4}function nf(t,e,r){return 256*t+e+r/256-32768}class of{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,e,r,i=!1){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)return fr(`"${r}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=e.height;const n=this.dim=e.height-2,o=new Uint32Array(e.data.buffer);if(this.pixels=new Uint8Array(e.data.buffer),this.floatView=new Float32Array(e.data.buffer),this.borderReady=i,this._modifiedForSources={},!i){for(let t=0;t<n;t++)o[this._idx(-1,t)]=o[this._idx(0,t)],o[this._idx(n,t)]=o[this._idx(n-1,t)],o[this._idx(t,-1)]=o[this._idx(t,0)],o[this._idx(t,n)]=o[this._idx(t,n-1)];o[this._idx(-1,-1)]=o[this._idx(0,0)],o[this._idx(n,-1)]=o[this._idx(n-1,0)],o[this._idx(-1,n)]=o[this._idx(0,n-1)],o[this._idx(n,n)]=o[this._idx(n-1,n-1)]}const s="terrarium"===r?nf:rf;for(let t=0;t<o.length;++t){const e=4*t;this.floatView[t]=s(this.pixels[e],this.pixels[e+1],this.pixels[e+2])}this._timestamp=Dr.now()}_buildQuadTree(){this._tree=new Jp(this)}get(t,e,r=!1){r&&(t=Ke(t,-1,this.dim),e=Ke(e,-1,this.dim));const i=this._idx(t,e);return this.floatView[i]}set(t,e,r){const i=this._idx(t,e),n=this.floatView[i];return this.floatView[i]=r,r-n}static getUnpackVector(t){return ef[t]}_idx(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)}static pack(t,e){const r=[0,0,0,0],i=of.getUnpackVector(e);let n=Math.floor((t+i[3])/i[2]);return r[2]=n%256,n=Math.floor(n/256),r[1]=n%256,n=Math.floor(n/256),r[0]=n,r}getPixels(){return new vd({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,e,r){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let i=e*this.dim,n=e*this.dim+this.dim,o=r*this.dim,s=r*this.dim+this.dim;switch(e){case-1:i=n-1;break;case 1:n=i+1}switch(r){case-1:o=s-1;break;case 1:s=o+1}const a=-e*this.dim,l=-r*this.dim;for(let e=o;e<s;e++)for(let r=i;r<n;r++){const i=4*this._idx(r,e),n=4*this._idx(r+a,e+l);this.pixels[i+0]=t.pixels[n+0],this.pixels[i+1]=t.pixels[n+1],this.pixels[i+2]=t.pixels[n+2],this.pixels[i+3]=t.pixels[n+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Sa(of,"DEMData"),Sa(Jp,"DemMinMaxQuadTree",{omit:["dem"]});class sf{constructor(t,e,r){this._demTile=t,this._dem=this._demTile.dem,this._scale=e,this._offset=r}static create(t,e,r){const i=r||t.findDEMTileFor(e);if(!i||!i.dem)return;const n=i.dem,o=i.tileID,s=1<<e.canonical.z-o.canonical.z;return new sf(i,n.dim/mo/s,[(e.canonical.x/s-o.canonical.x)*n.dim,(e.canonical.y/s-o.canonical.y)*n.dim])}tileCoordToPixel(t,e){const r=e*this._scale+this._offset[1],i=Math.floor(t*this._scale+this._offset[0]),n=Math.floor(r);return new Ve(i,n)}getElevationAt(t,e,r,i){const n=t*this._scale+this._offset[0],o=e*this._scale+this._offset[1],s=Math.floor(n),a=Math.floor(o),l=this._dem;return i=!!i,r?qi(qi(l.get(s,a,i),l.get(s,a+1,i),o-a),qi(l.get(s+1,a,i),l.get(s+1,a+1,i),o-a),n-s):l.get(s,a,i)}getElevationAtPixel(t,e,r){return this._dem.get(t,e,!!r)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*Lu(1,t)*this._dem.stride}}const af={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7},lf=Mp.types,cf=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-line-alignment"],uf=["fill-extrusion-flood-light-ground-radius"],hf=Math.pow(2,13),df=Math.pow(2,15)-1,pf=new Ve(0,1),ff=2147483648;function mf(t,e,r,i,n,o,s,a){t.emplaceBack((e<<1)+s,(r<<1)+o,(Math.floor(i*hf)<<1)+n,Math.round(a))}function gf(t,e,r,i){t.emplaceBack(e.x*mo,e.y*mo,r?0:1,i?1:0)}function yf(t,e,r,i,n,o){t.emplaceBack(e.x,e.y,(r.x<<1)+i,(r.y<<1)+n,o)}function vf(t,e,r){const i=16384;t.emplaceBack(e.x,e.y,e.z,r[0]*i,r[1]*i,r[2]*i)}class _f{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class bf{constructor(){this.centroidXY=new Ve(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Ve(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Ve(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Ve(this.max.x-this.min.x,this.max.y-this.min.y)}}class xf{constructor(){this.acc=new Ve(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,e){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=e.x,t.min.y=t.max.y=e.y)}appendEdge(t,e,r){this.accCount++,this.acc._add(e);let i=!!this.borders;e.x<t.min.x?(t.min.x=e.x,i=!0):e.x>t.max.x&&(t.max.x=e.x,i=!0),e.y<t.min.y?(t.min.y=e.y,i=!0):e.y>t.max.y&&(t.max.y=e.y,i=!0),((0===e.x||e.x===mo)&&e.x===r.x)!=((0===e.y||e.y===mo)&&e.y===r.y)&&this.processBorderOverlap(e,r),i&&this.checkBorderIntersection(e,r)}checkBorderIntersection(t,e){e.x<0!=t.x<0&&this.addBorderIntersection(0,qi(e.y,t.y,(0-e.x)/(t.x-e.x))),e.x>mo!=t.x>mo&&this.addBorderIntersection(1,qi(e.y,t.y,(mo-e.x)/(t.x-e.x))),e.y<0!=t.y<0&&this.addBorderIntersection(2,qi(e.x,t.x,(0-e.y)/(t.y-e.y))),e.y>mo!=t.y>mo&&this.addBorderIntersection(3,qi(e.x,t.x,(mo-e.y)/(t.y-e.y)))}addBorderIntersection(t,e){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const r=this.borders[t];e<r[0]&&(r[0]=e),e>r[1]&&(r[1]=e)}processBorderOverlap(t,e){if(t.x===e.x){if(t.y===e.y)return;const r=0===t.x?0:1;this.addBorderIntersection(r,e.y),this.addBorderIntersection(r,t.y)}else{const r=0===t.y?2:3;this.addBorderIntersection(r,e.x),this.addBorderIntersection(r,t.x)}}centroid(){return 0===this.accCount?new Ve(0,0):new Ve(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce(((t,e)=>t+ +(e[0]!==Number.MAX_VALUE)),0):0}}function wf(t,e){const r=t.add(e)._unit(),i=Ke(t.x*r.x+t.y*r.y,-1,1);var n,o,s;return n=Math.acos(i),Math.min(4,Math.max(-4,Math.tan(n)))/4*df*((o=t).x*(s=e).y-o.y*s.x<0?-1:1)}const Tf=[t=>t.x<0,t=>t.x>mo,t=>t.y<0,t=>t.y>mo];function Ef(t,e,r,i){const n=[4];if(0===i)return n;r._mult(i);const o=t.sub(r),s=e.sub(r),a=[t,e,o,s];for(let t=0;t<4;t++)for(const e of a)if(Tf[t](e)){n.push(t);break}return n}class Sf{constructor(t){this.vertexArray=new jl,this.indexArray=new tc,this.programConfigurations=new eu(t.layers,{zoom:t.zoom,lut:t.lut},(t=>uf.includes(t))),this._segments=new Ac,this.hiddenByLandmarkVertexArray=new dc,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Ac}getDefaultSegment(){return this.regionSegments[4]}hasData(){return 0!==this.vertexArray.length}addData(t,e,r,i=!1){const n=t.length;if(n>2){let o=Math.max(0,this._segments.get().length-1);const s=this._segments._prepareSegment(4*n,this.vertexArray.length,2*this._segmentToGroundQuads[o].length);let a;o!==this._segments.get().length-1&&(o++,this._segmentToGroundQuads[o]=[],this._segmentToRegionTriCounts[o]=[0,0,0,0,0]);{const e=t[0],r=t[1];a=wf(e.sub(t[n-1])._perp()._unit(),r.sub(e)._perp()._unit())}for(let l=0;l<n;l++){const c=l===n-1?0:l+1,u=t[l],h=t[c],d=t[c===n-1?0:c+1],p=h.sub(u)._perp()._unit(),f=wf(p,d.sub(h)._perp()._unit()),m=a,g=f;if(Cf(u,h,e)||i&&If(u,e)&&If(h,e)){a=f;continue}const y=s.vertexLength;yf(this.vertexArray,u,h,1,1,m),yf(this.vertexArray,u,h,1,0,m),yf(this.vertexArray,u,h,0,1,g),yf(this.vertexArray,u,h,0,0,g),s.vertexLength+=4;const v=Ef(u,h,p,r);for(const t of v)this._segmentToGroundQuads[o].push({id:y,region:t}),this._segmentToRegionTriCounts[o][t]+=2,s.primitiveLength+=2;a=f}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),e=t.length;for(let t=0;t<e;t++)this._segmentToGroundQuads[t].sort(((t,e)=>t.region-e.region));for(let r=0;r<e;r++){const e=this._segmentToGroundQuads[r],i=t[r],n=this._segmentToRegionTriCounts[r];n.reduce(((t,e)=>t+e),0);let o=0;for(let t=0;t<=4;t++){const e=n[t];if(0!==e){let r=this.regionSegments[t];r||(r=this.regionSegments[t]=new Ac);const n={vertexOffset:i.vertexOffset,primitiveOffset:i.primitiveOffset+o,vertexLength:i.vertexLength,primitiveLength:e};r.get().push(n)}o+=e}for(let t=0;t<e.length;t++){const r=e[t].id;this.indexArray.emplaceBack(r,r+1,r+3),this.indexArray.emplaceBack(r,r+3,r+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,e,r,i,n,o){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,e,r,i,n,o)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,up.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,e,r,i,n,o){this.hasData()&&this.programConfigurations.updatePaintArrays(t,e,r,i,n,o)}updateHiddenByLandmark(t){if(!this.hasData())return;const e=t.groundVertexCount+t.groundVertexArrayOffset;if(0===t.groundVertexCount)return;const r=t.flags&ff?1:0;for(let i=t.groundVertexArrayOffset;i<e;++i)this.hiddenByLandmarkVertexArray.emplace(i,r);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,pp.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const e=this.regionSegments[t];e&&e.destroy()}}}}class Pf{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.fqid)),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new tc,this.footprintVertices=new Fl,this.footprintSegments=[],this.layoutVertexArray=new zl,this.centroidVertexArray=new Tc,this.wallVertexArray=new Sc,this.indexArray=new tc,this.programConfigurations=new eu(t.layers,{zoom:t.zoom,lut:t.lut},(t=>cf.includes(t))),this.segments=new Ac,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.groundEffect=new Sf(t),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(t,e){}populate(t,e,r,i){this.features=[],this.hasPattern=Qd("fill-extrusion",this.layers,e),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=Vu(r),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=0!==this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1);for(const{feature:n,id:o,index:s,sourceLayerIndex:a}of t){const t=this.layers[0]._featureFilter.needGeometry,l=Ku(n,t);if(!this.layers[0]._featureFilter.filter(new Ka(this.zoom),l,r))continue;const c={id:o,sourceLayerIndex:a,index:s,geometry:t?l.geometry:Yu(n,r,i),properties:n.properties,type:n.type,patterns:{}},u=this.layoutVertexArray.length;if(this.hasPattern)this.features.push(tp("fill-extrusion",this.layers,c,this.zoom,e));else if(this.wallMode)for(const t of c.geometry)this.addFeature(c,[t],s,r,{},e.availableImages,i,e.brightness);else this.addFeature(c,c.geometry,s,r,{},e.availableImages,i,e.brightness);e.featureIndex.insert(n,c.geometry,s,a,this.index,u)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(t,e,r,i,n,o){for(const t of this.features){const{geometry:s}=t;if(this.wallMode)for(const a of s)this.addFeature(t,[a],t.index,e,r,i,n,o);else this.addFeature(t,s,t.index,e,r,i,n,o)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles()}update(t,e,r,i,n){const o=0!==Object.keys(t).length;if(o&&!this.stateDependentLayers.length)return;const s=o?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(t,e,s,r,i,n),this.groundEffect.update(t,e,s,r,i,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,mp),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.wallVertexBuffer=t.createVertexBuffer(this.wallVertexArray,dp.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,fp.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,hp.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,r,i,n,o,s,a){const l=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(t,{})/this.tileToMeter,c=[new Ve(0,0),new Ve(mo,mo)],u=s.projection,h="globe"===u.name,d=this.wallMode||"Polygon"===lf[t.type],p=new xf;p.centroidDataIndex=this.centroidData.length;const f=new bf,m=this.layers[0].paint.get("fill-extrusion-base").evaluate(t,{},i)<=0,g=this.layers[0].paint.get("fill-extrusion-height").evaluate(t,{},i);let y;if(f.height=g,f.vertexArrayOffset=this.layoutVertexArray.length,f.groundVertexArrayOffset=this.groundEffect.vertexArray.length,h&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Hl),this.wallMode){if(h)return void fr("Non zero fill-extrusion-line-width is not yet supported on globe.");if(1!==e.length)return;y=function(t){const e=t[0].x===t[t.length-1].x&&t[0].y===t[t.length-1].y,r=function(t){let e=0;const r=t.length;for(let i=0;i<r;i++)e+=(t[(i+1)%r].x-t[i].x)*(t[(i+1)%r].y+t[i].y);return e>=0}(t);r||(t=t.reverse());const i={isPolygon:e,geometry:[],joinNormals:[]},n=[],o=[],s=[];let a=t.length;if(a<(e?3:2))return i;for(;a>=2&&t[a-1].equals(t[a-2]);)a--;let l,c,u,h,d,p=0;for(;p<a-1&&t[p].equals(t[p+1]);)p++;e&&(l=t[a-2],d=t[p].sub(l)._unit()._perp());for(let r=p;r<a;r++){if(u=r===a-1?e?t[p+1]:void 0:t[r+1],u&&t[r].equals(u))continue;d&&(h=d),l&&(c=l),l=t[r],d=u?u.sub(l)._unit()._perp():h,h=h||d;const i=h.add(d);0===i.x&&0===i.y||i._unit();const f=i.x*d.x+i.y*d.y,m=0!==f?1/f:1/0,g=h.x*d.y-h.y*d.x>0;let y="miter";"miter"===y&&m>2&&(y="bevel");const v=(t,e,r,i)=>{const a=new Ve(t.x,t.y),l=new Ve(t.x,t.y);a.x-=e.x*i,a.y-=e.y*i,l.x-=e.x*Math.max(r,1),l.y-=e.y*Math.max(r,1),s.push(e),n.push(a),o.push(l)};if("miter"===y)i._mult(m),v(l,i,1,0);else{const t=-Math.sqrt(m*m-1),e=g?t:0,r=g?0:t;c&&v(l,h,e,r),u&&v(l,d,e,r)}}return i.geometry=[...n,...o.reverse(),n[0]],i.joinNormals=[...s,...s.reverse(),s[s.length-1]],i}(e[0]),e=[y.geometry]}const v=(t,e)=>t<(e.length-1)/2||t===e.length-1,_=this.wallMode?[e]:Kd(e,500);for(let t=_.length-1;t>=0;t--){const e=_[t];(0===e.length||(b=e[0]).every((t=>t.x<=0))||b.every((t=>t.x>=mo))||b.every((t=>t.y<=0))||b.every((t=>t.y>=mo)))&&_.splice(t,1)}var b;let x;if(h)x=Rf(_,c,i);else{x=[];for(const t of _)x.push({polygon:t,bounds:c})}const w=d?this.edgeRadius:0,T=w>0&&this.zoom<17,E=(t,e)=>{if(0===t.length)return!1;const r=t[t.length-1];return e.x===r.x&&e.y===r.y};for(const{polygon:t,bounds:e}of x){let r=0,n=0;for(const e of t)d&&!e[0].equals(e[e.length-1])&&e.push(e[0]),n+=d?e.length-1:e.length;const o=this.segments.prepareSegment((d?5:4)*n,this.layoutVertexArray,this.indexArray);f.footprintSegIdx<0&&(f.footprintSegIdx=this.footprintSegments.length),f.polygonSegIdx<0&&(f.polygonSegIdx=this.polygonSegments.length);const s={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},a=new _f;if(a.vertexOffset=this.footprintVertices.length,a.indexOffset=3*this.footprintIndices.length,a.ringIndices=[],d){const n=[],s=[];r=o.vertexLength;for(let r=0;r<t.length;r++){const c=t[r];c.length&&0!==r&&s.push(n.length/2);const d=[];let p,f;p=c[1].sub(c[0])._perp()._unit(),a.ringIndices.push(c.length-1);for(let t=1;t<c.length;t++){const e=c[t],r=c[t===c.length-1?1:t+1],s=e.clone();if(w){f=r.sub(e)._perp()._unit();const t=p.add(f)._unit(),i=w*Math.min(4,1/(p.x*t.x+p.y*t.y));s.x+=i*t.x,s.y+=i*t.y,s.x=Math.round(s.x),s.y=Math.round(s.y),p=f}if(!m||0!==w&&!T||E(d,s)||d.push(s),mf(this.layoutVertexArray,s.x,s.y,0,0,1,1,0),this.wallMode){const e=v(t,c);gf(this.wallVertexArray,y.joinNormals[t],e,y.isPolygon)}o.vertexLength++,this.footprintVertices.emplaceBack(e.x,e.y),n.push(e.x,e.y),h&&vf(this.layoutVertexExtArray,u.projectTilePoint(s.x,s.y,i),u.upVector(i,s.x,s.y))}m&&(0===w||T)&&(0!==d.length&&E(d,d[0])&&d.pop(),this.groundEffect.addData(d,e,l))}const c=Pd(n,s);for(let t=0;t<c.length;t+=3)this.footprintIndices.emplaceBack(a.vertexOffset+c[t+0],a.vertexOffset+c[t+1],a.vertexOffset+c[t+2]),this.indexArray.emplaceBack(r+c[t],r+c[t+2],r+c[t+1]),o.primitiveLength++;a.indexCount+=c.length,a.vertexCount+=this.footprintVertices.length-a.vertexOffset}for(let n=0;n<t.length;n++){const s=t[n];p.startRing(f,s[0]);let a=s.length>4&&Of(s[s.length-2],s[0],s[1]),c=w?Af(s[s.length-2],s[0],s[1],w):0;const g=[];let _,b,x;b=s[1].sub(s[0])._perp()._unit();let T=!0;for(let t=1,n=0;t<s.length;t++){let l=s[t-1],d=s[t];const S=s[t===s.length-1?1:t+1];if(p.appendEdge(f,d,l),Cf(d,l,e)){w&&(b=S.sub(d)._perp()._unit(),T=!T);continue}const P=d.sub(l)._perp(),k=P.x/(Math.abs(P.x)+Math.abs(P.y)),A=P.y>0?1:0,M=l.dist(d);if(n+M>32768&&(n=0),w){x=S.sub(d)._perp()._unit();let t=Mf(l,d,S,kf(b,x),w);isNaN(t)&&(t=0);const e=d.sub(l)._unit();l=l.add(e.mult(c))._round(),d=d.add(e.mult(-t))._round(),c=t,b=x,m&&this.zoom>=17&&(E(g,l)||g.push(l),E(g,d)||g.push(d))}const C=o.vertexLength,I=s.length>4&&Of(l,d,S);let O=Lf(n,a,T);if(mf(this.layoutVertexArray,l.x,l.y,k,A,0,0,O),mf(this.layoutVertexArray,l.x,l.y,k,A,0,1,O),this.wallMode){const e=v(t-1,s),r=y.joinNormals[t-1];gf(this.wallVertexArray,r,!e,y.isPolygon),gf(this.wallVertexArray,r,!e,y.isPolygon)}if(n+=M,O=Lf(n,I,!T),a=I,mf(this.layoutVertexArray,d.x,d.y,k,A,0,0,O),mf(this.layoutVertexArray,d.x,d.y,k,A,0,1,O),this.wallMode){const e=v(t,s),r=y.joinNormals[t];gf(this.wallVertexArray,r,!e,y.isPolygon),gf(this.wallVertexArray,r,!e,y.isPolygon)}if(o.vertexLength+=4,this.indexArray.emplaceBack(C+0,C+1,C+2),this.indexArray.emplaceBack(C+1,C+3,C+2),o.primitiveLength+=2,w){const i=r+(1===t?s.length-2:t-2),n=1===t?r:i+1;if(this.indexArray.emplaceBack(C+1,i,C+3),this.indexArray.emplaceBack(i,n,C+3),o.primitiveLength+=2,void 0===_&&(_=C),!Cf(S,s[t],e)){const e=t===s.length-1?_:o.vertexLength;this.indexArray.emplaceBack(C+2,C+3,e),this.indexArray.emplaceBack(C+3,e+1,e),this.indexArray.emplaceBack(C+3,n,e+1),o.primitiveLength+=3}T=!T}if(h){const t=this.layoutVertexExtArray,e=u.projectTilePoint(l.x,l.y,i),r=u.projectTilePoint(d.x,d.y,i),n=u.upVector(i,l.x,l.y),o=u.upVector(i,d.x,d.y);vf(t,e,n),vf(t,e,n),vf(t,r,o),vf(t,r,o)}}d&&(r+=s.length-1),m&&w&&this.zoom>=17&&(0!==g.length&&E(g,g[0])&&g.pop(),this.groundEffect.addData(g,e,l,w>0))}this.footprintSegments.push(a),s.triangleCount=this.indexArray.length-s.triangleArrayOffset,this.polygonSegments.push(s),++f.footprintSegLen,++f.polygonSegLen}if(f.vertexCount=this.layoutVertexArray.length-f.vertexArrayOffset,f.groundVertexCount=this.groundEffect.vertexArray.length-f.groundVertexArrayOffset,0!==f.vertexCount){if(f.centroidXY=p.borders?pf:this.encodeCentroid(p,f),this.centroidData.push(f),p.borders){this.featuresOnBorder.push(p);const t=this.featuresOnBorder.length-1;for(let e=0;e<p.borders.length;e++)p.borders[e][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[e].push(t)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,n,o,i,a),this.groundEffect.addPaintPropertiesData(t,r,n,o,i,a),this.maxHeight=Math.max(this.maxHeight,g)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort(((e,r)=>this.featuresOnBorder[e].borders[t][0]-this.featuresOnBorder[r].borders[t][0]))}splitToSubtiles(){const t=[];for(let e=0;e<this.centroidData.length;e++){const r=this.centroidData[e],i=+(r.min.y+r.max.y>mo),n=2*i+(+(r.min.x+r.max.x>mo)^i);for(let i=0;i<r.polygonSegLen;i++){const o=r.polygonSegIdx+i;t.push({centroidIdx:e,subtile:n,polygonSegmentIdx:o,triangleSegmentIdx:this.polygonSegments[o].triangleSegIdx})}}const e=new tc;t.sort(((t,e)=>t.triangleSegmentIdx===e.triangleSegmentIdx?t.subtile-e.subtile:t.triangleSegmentIdx-e.triangleSegmentIdx));let r=0,i=0,n=0;for(const e of t){if(e.triangleSegmentIdx!==r)break;n++}const o=t.length;for(;i!==t.length;){r=t[i].triangleSegmentIdx;let s=0,a=i,l=i;for(let e=a;e<n&&t[e].subtile===s;e++)l++;for(;a!==n;){const i=t[a];s=i.subtile;const o=this.centroidData[i.centroidIdx].min.clone(),c=this.centroidData[i.centroidIdx].max.clone(),u={vertexOffset:this.segments.segments[r].vertexOffset,primitiveOffset:e.length,vertexLength:this.segments.segments[r].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let r=a;r<l;r++){const i=t[r],n=this.polygonSegments[i.polygonSegmentIdx],s=this.centroidData[i.centroidIdx].min,a=this.centroidData[i.centroidIdx].max,l=this.indexArray.uint16;for(let t=n.triangleArrayOffset;t<n.triangleArrayOffset+n.triangleCount;t++)e.emplaceBack(l[3*t],l[3*t+1],l[3*t+2]);u.primitiveLength+=n.triangleCount,o.x=Math.min(o.x,s.x),o.y=Math.min(o.y,s.y),c.x=Math.max(c.x,a.x),c.y=Math.max(c.y,a.y)}u.primitiveLength>0&&this.triangleSubSegments.push({segment:u,min:o,max:c}),a=l;for(let e=a;e<n&&t[e].subtile===t[a].subtile;e++)l++}i=n;for(let e=i;e<o&&t[e].triangleSegmentIdx===t[i].triangleSegmentIdx;e++)n++}e._trim(),this.indexArray=e}getVisibleSegments(t,e,r){const i=new Ac;if(this.wallMode){for(const t of this.triangleSubSegments)i.segments.push(t.segment);return i}let n=0,o=0;const s=1<<t.canonical.z;if(e){const r=e.getMinMaxForTile(t);r&&(n=r.min,o=r.max)}o+=this.maxHeight;const a=t.toUnwrapped();let l;const c=[a.canonical.x/s+a.wrap,a.canonical.y/s],u=[(a.canonical.x+1)/s+a.wrap,(a.canonical.y+1)/s],h=(t,e,r)=>[t[0]*(1-r[0])+e[0]*r[0],t[1]*(1-r[1])+e[1]*r[1]],d=[],p=[];for(const t of this.triangleSubSegments){d[0]=t.min.x/mo,d[1]=t.min.y/mo,p[0]=t.max.x/mo,p[1]=t.max.y/mo;const e=h(c,u,d),s=h(c,u,p);if(0===new Ah([e[0],e[1],n],[s[0],s[1],o]).intersectsPrecise(r)){l&&(i.segments.push(l),l=void 0);continue}const a=t.segment;l&&l.vertexOffset!==a.vertexOffset&&(i.segments.push(l),l=void 0),l?(l.vertexLength+=a.vertexLength,l.primitiveLength+=a.primitiveLength):l={vertexOffset:a.vertexOffset,primitiveLength:a.primitiveLength,vertexLength:a.vertexLength,primitiveOffset:a.primitiveOffset,sortKey:void 0,vaos:{}}}return l&&i.segments.push(l),i}encodeCentroid(t,e){const r=t.centroid(),i=e.span(),n=Math.min(7,Math.round(i.x*this.tileToMeter/10)),o=Math.min(7,Math.round(i.y*this.tileToMeter/10));return new Ve(Ke(r.x,1,mo-1)<<3|n,Ke(r.y,1,mo-1)<<3|o)}encodeBorderCentroid(t){if(!t.borders)return new Ve(0,0);const e=t.borders,r=Number.MAX_VALUE;if(e[0][0]!==r||e[1][0]!==r){const t=e[0][0]!==r?0:1;return new Ve(6|(e[0][0]!==r?0:65528),(e[t][0]+e[t][1])/2<<3|6)}{const t=e[2][0]!==r?2:3;return new Ve((e[t][0]+e[t][1])/2<<3|6,6|(e[2][0]!==r?0:65528))}}showCentroid(t){const e=this.centroidData[t.centroidDataIndex];e.flags&=ff,e.centroidXY.x=0,e.centroidXY.y=0,this.writeCentroidToBuffer(e)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const e=t.vertexArrayOffset,r=t.vertexCount+t.vertexArrayOffset,i=t.flags&ff?pf:t.centroidXY,n=this.centroidVertexArray.geta_centroid_pos0(e);if(this.centroidVertexArray.geta_centroid_pos1(e)!==i.y||n!==i.x){for(let t=e;t<r;++t)this.centroidVertexArray.emplace(t,i.x,i.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,e,r){if(e.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=e.updateTime;const i=e.getReplacementRegionsForTile(t.toUnwrapped());if(Np(this.activeReplacements,i))return;if(this.activeReplacements=i,0===this.centroidVertexArray.length)this.createCentroidsBuffer();else for(const t of this.centroidData)t.flags&=2147483647;const n=[];for(const e of this.activeReplacements){if(e.order<r)continue;const i=Math.pow(2,e.footprintTileId.canonical.z-t.canonical.z);for(const r of this.centroidData)if(!(r.flags&ff||e.min.x>r.max.x||r.min.x>e.max.x||e.min.y>r.max.y||r.min.y>e.max.y))for(let o=0;o<r.footprintSegLen;o++){const s=this.footprintSegments[r.footprintSegIdx+o];if(n.length=0,Ff(this.footprintVertices,s.vertexOffset,s.vertexCount,e.footprintTileId.canonical,t.canonical,n),$p(e.footprint,n,this.footprintIndices.uint16,s.indexOffset,s.indexCount,-s.vertexOffset,-i)){r.flags|=ff;break}}}for(const t of this.centroidData)this.writeCentroidToBuffer(t);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,e,r){let i=!1;for(let n=0;n<r.footprintSegLen;n++){const o=this.footprintSegments[r.footprintSegIdx+n];let s=0;for(const r of o.ringIndices){for(let n=s,a=r+s-1;n<r+s;a=n++){const r=this.footprintVertices.int16[2*(n+o.vertexOffset)+0],s=this.footprintVertices.int16[2*(n+o.vertexOffset)+1],l=this.footprintVertices.int16[2*(a+o.vertexOffset)+1];s>e!=l>e&&t<(this.footprintVertices.int16[2*(a+o.vertexOffset)+0]-r)*(e-s)/(l-s)+r&&(i=!i)}s=r}}return i}getHeightAtTileCoord(t,e){let r=Number.NEGATIVE_INFINITY,i=!0;const n=4*(t+mo)*mo+(e+mo);if(this.partLookup.hasOwnProperty(n)){const t=this.partLookup[n];return t?{height:t.height,hidden:!!(t.flags&ff)}:void 0}for(const o of this.centroidData)t>o.max.x||o.min.x>t||e>o.max.y||o.min.y>e||this.footprintContainsPoint(t,e,o)&&o&&o.height>r&&(r=o.height,this.partLookup[n]=o,i=!!(o.flags&ff));if(r!==Number.NEGATIVE_INFINITY)return{height:r,hidden:i};this.partLookup[n]=void 0}}function kf(t,e){const r=t.add(e)._unit();return t.x*r.x+t.y*r.y}function Af(t,e,r,i){const n=e.sub(t)._perp()._unit(),o=r.sub(e)._perp()._unit();return Mf(t,e,r,kf(n,o),i)}function Mf(t,e,r,i,n){const o=Math.sqrt(1-i*i);return Math.min(t.dist(e)/3,e.dist(r)/3,n*o/i)}function Cf(t,e,r){return t.x<r[0].x&&e.x<r[0].x||t.x>r[1].x&&e.x>r[1].x||t.y<r[0].y&&e.y<r[0].y||t.y>r[1].y&&e.y>r[1].y}function If(t,e){return t.x<e[0].x||t.x>e[1].x||t.y<e[0].y||t.y>e[1].y}function Of(t,e,r){if(t.x<0||t.x>=mo||e.x<0||e.x>=mo||r.x<0||r.x>=mo)return!1;const i=r.sub(e),n=i.perp(),o=t.sub(e);return(i.x*o.x+i.y*o.y)/Math.sqrt((i.x*i.x+i.y*i.y)*(o.x*o.x+o.y*o.y))>-.866&&n.x*o.x+n.y*o.y<0}function Lf(t,e,r){const i=e?2|t:-3&t;return r?1|i:-2&i}function Df(){const t=Math.PI/32,e=Math.tan(t),r=yu;return r*Math.sqrt(1+2*e*e)-r}function Rf(t,e,r){const i=1<<r.z,n=Du(r.x/i),o=Du((r.x+1)/i),s=Ru(r.y/i),a=Ru((r.y+1)/i);return function(t,e,r,i,n=0,o){const s=[];if(!t.length||!r||!i)return s;const a=(t,e)=>{for(const r of t)s.push({polygon:r,bounds:e})},l=Math.ceil(Math.log2(r)),c=Math.ceil(Math.log2(i)),u=l-c,h=[];for(let t=0;t<Math.abs(u);t++)h.push(u>0?0:1);for(let t=0;t<Math.min(l,c);t++)h.push(0),h.push(1);let d=t;if(d=Op(d,e[0].y-n,e[1].y+n,1),d=Op(d,e[0].x-n,e[1].x+n,0),!d.length)return s;const p=[];for(h.length?p.push({polygons:d,bounds:e,depth:0}):a(d,e);p.length;){const t=p.pop(),e=t.depth,r=h[e],i=t.bounds[0],s=t.bounds[1],l=0===r?i.x:i.y,c=0===r?s.x:s.y,u=o?o(r,l,c):.5*(l+c),d=Op(t.polygons,l-n,u+n,r),f=Op(t.polygons,u-n,c+n,r);if(d.length){const t=[i,new Ve(0===r?u:s.x,1===r?u:s.y)];h.length>e+1?p.push({polygons:d,bounds:t,depth:e+1}):a(d,t)}if(f.length){const t=[new Ve(0===r?u:i.x,1===r?u:i.y),s];h.length>e+1?p.push({polygons:f,bounds:t,depth:e+1}):a(f,t)}}return s}(t,e,Math.ceil((o-n)/11.25),Math.ceil((s-a)/11.25),1,((t,e,n)=>{if(0===t)return.5*(e+n);{const t=Ru((r.y+e/mo)/i);return(Ou(.5*(Ru((r.y+n/mo)/i)+t))*i-r.y)*mo}}))}function Ff(t,e,r,i,n,o){const s=Math.pow(2,i.z-n.z);for(let a=0;a<r;a++){let r=t.int16[2*(a+e)+0],l=t.int16[2*(a+e)+1];r=(r+n.x*mo)*s-i.x*mo,l=(l+n.y*mo)*s-i.y*mo,o.push(new Ve(r,l))}}let Bf,zf;function jf(t,e){return t.x*e.x+t.y*e.y}function Nf(t,e){if(1===t.length){let r=0;const i=e[r++];let n;for(;!n||i.equals(n);)if(n=e[r++],!n)return 1/0;for(;r<e.length;r++){const o=e[r],s=t[0],a=n.sub(i),l=o.sub(i),c=s.sub(i),u=jf(a,a),h=jf(a,l),d=jf(l,l),p=jf(c,a),f=jf(c,l),m=u*d-h*h,g=(d*p-h*f)/m,y=(u*f-h*p)/m,v=i.z*(1-g-y)+n.z*g+o.z*y;if(isFinite(v))return v}return 1/0}{let t=1/0;for(const r of e)t=Math.min(t,r.z);return t}}function Vf(t,e,r,i,n,o,s,a){const l=s*n.getElevationAt(t,e,!0,!0),c=0!==o[0],u=c?0===o[1]?s*(o[0]/7-450):s*function(t,e,r){const i=Math.floor(e[0]/8),n=Math.floor(e[1]/8),o=10*(e[0]-8*i),s=10*(e[1]-8*n),a=t.getElevationAt(i,n,!0,!0),l=t.getMeterToDEM(r),c=Math.floor(.5*(o*l-1)),u=Math.floor(.5*(s*l-1)),h=t.tileCoordToPixel(i,n),d=2*c+1,p=2*u+1,f=function(t,e,r,i,n){return[t.getElevationAtPixel(e,r,!0),t.getElevationAtPixel(e+n,r,!0),t.getElevationAtPixel(e,r+n,!0),t.getElevationAtPixel(e+i,r+n,!0)]}(t,h.x-c,h.y-u,d,p),m=Math.abs(f[0]-f[1]),g=Math.abs(f[2]-f[3]),y=Math.abs(f[0]-f[2])+Math.abs(f[1]-f[3]),v=Math.min(.25,.5*l*(m+g)/d),_=Math.min(.25,.5*l*y/p);return a+Math.max(v*o,_*s)}(n,o,a):l;return{base:l+(0===r)?-1:r,top:c?Math.max(u+i,l+r+2):l+i}}Sa(Pf,"FillExtrusionBucket",{omit:["layers","features"]}),Sa(bf,"PartData"),Sa(_f,"FootprintSegment"),Sa(xf,"BorderCentroidData"),Sa(Sf,"GroundEffect");const Uf=Dl([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:$f}=Uf,Gf=Dl([{name:"a_packed",components:4,type:"Float32"}]),{members:Hf}=Gf,qf=Dl([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Wf}=qf,Zf=Dl([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Xf=Dl([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Yf=Dl([{name:"a_projected_pos",components:4,type:"Float32"}],4);Dl([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Kf=Dl([{name:"a_z_offset",components:1,type:"Float32"}],4),Jf=Dl([{name:"a_texb",components:2,type:"Uint16"}]),Qf=Dl([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),tm=Dl([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);Dl([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const em=Dl([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),rm=Dl([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Dl([{name:"triangle",components:3,type:"Uint16"}]),Dl([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Dl([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Dl([{type:"Float32",name:"offsetX"}]),Dl([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);class im{constructor(t,e){this.width=t,this.height=e,this.nextRow=0,this.image=new gd({width:t,height:e}),this.positions={},this.uploaded=!1}getDash(t,e){const r=this.getKey(t,e);return this.positions[r]}trim(){const t=this.width,e=this.height=sr(this.nextRow);this.image.resize({width:t,height:e})}getKey(t,e){return t.join(",")+e}getDashRanges(t,e,r){const i=[];let n=t.length%2==1?-t[t.length-1]*r:0,o=t[0]*r,s=!0;i.push({left:n,right:o,isDash:s,zeroLength:0===t[0]});let a=t[0];for(let e=1;e<t.length;e++){s=!s;const l=t[e];n=a*r,a+=l,o=a*r,i.push({left:n,right:o,isDash:s,zeroLength:0===l})}return i}addRoundDash(t,e,r){const i=e/2;for(let e=-r;e<=r;e++){const n=this.width*(this.nextRow+r+e);let o=0,s=t[o];for(let a=0;a<this.width;a++){a/s.right>1&&(s=t[++o]);const l=Math.abs(a-s.left),c=Math.abs(a-s.right),u=Math.min(l,c);let h;const d=e/r*(i+1);if(s.isDash){const t=i-Math.abs(d);h=Math.sqrt(u*u+t*t)}else h=i-Math.sqrt(u*u+d*d);this.image.data[n+a]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(t,e){for(let e=t.length-1;e>=0;--e){const r=t[e],i=t[e+1];r.zeroLength?t.splice(e,1):i&&i.isDash===r.isDash&&(i.left=r.left,t.splice(e,1))}const r=t[0],i=t[t.length-1];r.isDash===i.isDash&&(r.left=i.left-this.width,i.right=r.right+this.width);const n=this.width*this.nextRow;let o=0,s=t[o];for(let r=0;r<this.width;r++){r/s.right>1&&(s=t[++o]);const i=Math.abs(r-s.left),a=Math.abs(r-s.right),l=Math.min(i,a);this.image.data[n+r]=Math.max(0,Math.min(255,(s.isDash?l:-l)+e+128))}}addDash(t,e){const r=this.getKey(t,e);if(this.positions[r])return this.positions[r];const i="round"===e,n=i?7:0,o=2*n+1;if(this.nextRow+o>this.height)return fr("LineAtlas out of space"),null;0===t.length&&t.push(1);let s=0;for(let e=0;e<t.length;e++)t[e]<0&&(fr("Negative value is found in line dasharray, replacing values with 0"),t[e]=0),s+=t[e];if(0!==s){const r=this.width/s,o=this.getDashRanges(t,this.width,r);i?this.addRoundDash(o,r,n):this.addRegularDash(o,"square"===e?.5*r:0)}const a=this.nextRow+n;this.nextRow+=o;const l={tl:[a,n],br:[s,0]};return this.positions[r]=l,l}}Sa(im,"LineAtlas");const nm=Mp.types,om=Math.cos(Math.PI/180*37.5),sm=Math.cos(Math.PI/180*5);class am{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.fqid)),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.hasZOffset=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((t=>{this.gradients[t.id]={}})),this.layoutVertexArray=new Nl,this.layoutVertexArray2=new Vl,this.patternVertexArray=new Ul,this.indexArray=new tc,this.programConfigurations=new eu(t.layers,{zoom:t.zoom,lut:t.lut}),this.segments=new Ac,this.maxLineLength=0,this.zOffsetVertexArray=new ic,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.tessellationStep=t.tessellationStep?t.tessellationStep:mo/64}updateFootprints(t,e){}populate(t,e,r,i){this.hasPattern=Qd("line",this.layers,e);const n=this.layers[0].layout.get("line-sort-key"),o=this.layers[0].layout.get("line-z-offset");this.hasZOffset=!o.isConstant()||!!o.constantOr(0);const s=[];for(const{feature:e,id:o,index:a,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,c=Ku(e,t);if(!this.layers[0]._featureFilter.filter(new Ka(this.zoom),c,r))continue;const u=n?n.evaluate(c,{},r):void 0,h={id:o,properties:e.properties,type:e.type,sourceLayerIndex:l,index:a,geometry:t?c.geometry:Yu(e,r,i),patterns:{},sortKey:u};s.push(h)}n&&s.sort(((t,e)=>t.sortKey-e.sortKey));const{lineAtlas:a,featureIndex:l}=e,c=this.addConstantDashes(a);for(const i of s){const{geometry:n,index:o,sourceLayerIndex:s}=i;if(c&&this.addFeatureDashes(i,a),this.hasPattern){const t=tp("line",this.layers,i,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(i,n,o,r,a.positions,e.availableImages,e.brightness);l.insert(t[o].feature,n,o,s,this.index)}}addConstantDashes(t){let e=!1;for(const r of this.layers){const i=r.paint.get("line-dasharray").value,n=r.layout.get("line-cap").value;if("constant"!==i.kind||"constant"!==n.kind)e=!0;else{const e=n.value,r=i.value;if(!r)continue;t.addDash(r,e)}}return e}addFeatureDashes(t,e){const r=this.zoom;for(const i of this.layers){const n=i.paint.get("line-dasharray").value,o=i.layout.get("line-cap").value;if("constant"===n.kind&&"constant"===o.kind)continue;let s,a;if("constant"===n.kind){if(s=n.value,!s)continue}else s=n.evaluate({zoom:r},t);a="constant"===o.kind?o.value:o.evaluate({zoom:r},t),e.addDash(s,a),t.patterns[i.id]=e.getKey(s,a)}}update(t,e,r,i,n){const o=0!==Object.keys(t).length;o&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,e,o?this.stateDependentLayers:this.layers,r,i,n)}addFeatures(t,e,r,i,n,o){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,r,i,o)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Hf)),0!==this.patternVertexArray.length&&(this.patternVertexBuffer=t.createVertexBuffer(this.patternVertexArray,Wf)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,Kf.members,!0)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,$f),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,e,r,i,n,o,s){const a=this.layers[0].layout,l=a.get("line-join").evaluate(t,{}),c=a.get("line-cap").evaluate(t,{}),u=a.get("line-miter-limit"),h=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const r of e)this.addLine(r,t,i,l,c,u,h);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,n,o,i,s)}addLine(t,e,r,i,n,o,s){this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.currentVertex=void 0;const a={zoom:this.zoom,lineProgress:void 0},l=this.layers[0].layout,c="none"===i;if(this.patternJoinNone=this.hasPattern&&c,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let e=0;e<t.length-1;e++)this.totalDistance+=t[e].dist(t[e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const u="Polygon"===nm[e.type];let h=t.length;for(;h>=2&&t[h-1].equals(t[h-2]);)h--;let d=0;for(;d<h-1&&t[d].equals(t[d+1]);)d++;if(h<(u?3:2))return;"bevel"===i&&(o=1.05);const p=this.overscaling<=16?15*mo/(512*this.overscaling):0,f=this.segments.prepareSegment(10*h,this.layoutVertexArray,this.indexArray);let m,g,y,v,_,b;this.e1=this.e2=-1,u&&(m=t[h-2],_=t[d].sub(m)._unit()._perp());for(let r=d;r<h;r++){if(y=r===h-1?u?t[d+1]:void 0:t[r+1],y&&t[r].equals(y))continue;if(_&&(v=_),m&&(g=m),m=t[r],this.hasZOffset){const t=l.get("line-z-offset").value;if("constant"===t.kind)b=t.value;else{if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);a.lineProgress=(t*this.lineClips.start+this.distance+(g?g.dist(m):0))/t}else fr(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),a.lineProgress=0;b=t.evaluate(a,e)}b=b||0}_=y?y.sub(m)._unit()._perp():v,v=v||_;const x=g&&y;let w=x?i:u||c?"butt":n;const T=v.x*_.x+v.y*_.y;if(c){const t=function(t){if(t.patternJoinNone){const e=t.segmentPoints.length/2,r=t.lineSoFar-t.segmentStart;for(let i=0;i<e;++i){const e=t.segmentPoints[2*i+1],n=Math.round(t.segmentPoints[2*i])+.5+.25*e;t.patternVertexArray.emplaceBack(n,r,t.segmentStart),t.patternVertexArray.emplaceBack(n,r,t.segmentStart)}t.segmentPoints.length=0}t.e1=t.e2=-1};if(x&&T<sm){this.updateDistance(g,m),this.addCurrentVertex(m,v,1,1,f,b),t(this),this.addCurrentVertex(m,_,-1,-1,f,b);continue}if(g){if(!y){this.updateDistance(g,m),this.addCurrentVertex(m,v,1,1,f,b),t(this);continue}w="miter"}}let E=v.add(_);0===E.x&&0===E.y||E._unit();const S=E.x*_.x+E.y*_.y,P=0!==S?1/S:1/0,k=2*Math.sqrt(2-2*S),A=S<om&&g&&y,M=v.x*_.y-v.y*_.x>0;if(A&&r>d){const t=m.dist(g);if(t>2*p){const e=m.sub(m.sub(g)._mult(p/t)._round());this.updateDistance(g,e),this.addCurrentVertex(e,v,0,0,f,b),g=e}}if(x&&"round"===w&&(P<s?w="miter":P<=2&&(w="fakeround")),"miter"===w&&P>o&&(w="bevel"),"bevel"===w&&(P>2&&(w="flipbevel"),P<o&&(w="miter")),g&&this.updateDistance(g,m),"miter"===w)E._mult(P),this.addCurrentVertex(m,E,0,0,f,b);else if("flipbevel"===w){if(P>100)E=_.mult(-1);else{const t=P*v.add(_).mag()/v.sub(_).mag();E._perp()._mult(t*(M?-1:1))}this.addCurrentVertex(m,E,0,0,f,b),this.addCurrentVertex(m,E.mult(-1),0,0,f,b)}else if("bevel"===w||"fakeround"===w){const t=-Math.sqrt(P*P-1),e=M?t:0,r=M?0:t;if(g&&this.addCurrentVertex(m,v,e,r,f,b),"fakeround"===w){const t=Math.round(180*k/Math.PI/20);for(let e=1;e<t;e++){let r=e/t;if(.5!==r){const t=r-.5;r+=r*t*(r-1)*((1.0904+T*(T*(3.55645-1.43519*T)-3.2452))*t*t+(.848013+T*(.215638*T-1.06021)))}const i=_.sub(v)._mult(r)._add(v)._unit()._mult(M?-1:1);this.addHalfVertex(m,i.x,i.y,!1,M,0,f,b)}}y&&this.addCurrentVertex(m,_,-e,-r,f,b)}else"butt"===w?this.addCurrentVertex(m,E,0,0,f,b):"square"===w?(g||this.addCurrentVertex(m,E,-1,-1,f,b),this.addCurrentVertex(m,E,0,0,f,b),g&&this.addCurrentVertex(m,E,1,1,f,b)):"round"===w&&(g&&(this.addCurrentVertex(m,v,0,0,f,b),this.addCurrentVertex(m,v,1,1,f,b,!0)),y&&(this.addCurrentVertex(m,_,-1,-1,f,b,!0),this.addCurrentVertex(m,_,0,0,f,b)));if(A&&r<h-1){const t=m.dist(y);if(t>2*p){const e=m.add(y.sub(m)._mult(p/t)._round());this.updateDistance(m,e),this.addCurrentVertex(e,_,0,0,f,b),m=e}}}}addVerticesTo(t,e,r,i,n,o,s,a,l,c){const u=(e.w-t.w)/this.tessellationStep|0;if(u>1){this.lineSoFar=t.w;const h=(e.x-t.x)/u,d=(e.y-t.y)/u,p=(e.z-t.z)/u,f=(e.w-t.w)/u;for(let e=1;e<u;++e)t.x+=h,t.y+=d,t.z+=p,this.lineSoFar+=f,this.addHalfVertex(t,r,i,c,!1,s,l,t.z),this.addHalfVertex(t,n,o,c,!0,-a,l,t.z)}this.lineSoFar=e.w,this.addHalfVertex(e,r,i,c,!1,s,l,e.z),this.addHalfVertex(e,n,o,c,!0,-a,l,e.z)}addCurrentVertex(t,e,r,i,n,o,s=!1){const a=e.x+e.y*r,l=e.y-e.x*r,c=e.y*i-e.x,u=-e.y-e.x*i;if(null!=o){const e=-10,h=mo+10,d=o,p=new Ip(t.x,t.y,d,this.lineSoFar),f=lm(t,e,h),m=this.lineSoFar;if(this.currentVertex)if(f){const o=this.currentVertexIsOutside,p=this.currentVertex,f=new Ip(t.x,t.y,d,this.lineSoFar);Dp(p,f,e,h),lm(f,e,h)||(o&&(this.e1=this.e2=-1,this.lineSoFar=p.w,this.addHalfVertex(p,a,l,s,!1,r,n,p.z),this.addHalfVertex(p,c,u,s,!0,-i,n,p.z)),this.addVerticesTo(p,f,a,l,c,u,r,i,n,s))}else{const t=this.currentVertex;this.currentVertexIsOutside&&(Dp(t,p,e,h),this.e1=this.e2=-1,this.lineSoFar=t.w,this.addHalfVertex(t,a,l,s,!1,r,n,t.z),this.addHalfVertex(t,c,u,s,!0,-i,n,t.z)),this.addVerticesTo(t,p,a,l,c,u,r,i,n,s)}else f||(this.addHalfVertex(t,a,l,s,!1,r,n,o),this.addHalfVertex(t,c,u,s,!0,-i,n,o));this.currentVertex=p,this.currentVertexIsOutside=f,this.lineSoFar=m}else this.addHalfVertex(t,a,l,s,!1,r,n,o),this.addHalfVertex(t,c,u,s,!0,-i,n,o)}addHalfVertex({x:t,y:e},r,i,n,o,s,a,l){this.patternJoinNone&&(0===this.segmentPoints.length&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),o||this.segmentPoints.push(this.lineSoFar-this.segmentStart,s)),this.layoutVertexArray.emplaceBack((t<<1)+(n?1:0),(e<<1)+(o?1:0),Math.round(63*r)+128,Math.round(63*i)+128,1+(0===s?0:s<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const c=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,c),a.primitiveLength++),o?this.e2=c:this.e1=c,null!=l&&this.zOffsetVertexArray.emplaceBack(l)}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,e){this.distance+=t.dist(e),this.updateScaledDistance()}}function lm(t,e,r){return t.x<e||t.x>r||t.y<e||t.y>r}let cm,um;function hm(t,e,r){return e*(mo/(t.tileSize*Math.pow(2,r-t.tileID.overscaledZ)))}function dm(t,e){return 1/hm(t,1,e.tileZoom)}function pm(t,e,r,i){return t.translatePosMatrix(i||e.tileID.projMatrix,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}Sa(am,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const fm=t=>{const e=[];mm(t)&&e.push("RENDER_LINE_DASH"),t.paint.get("line-gradient")&&e.push("RENDER_LINE_GRADIENT");const r=t.paint.get("line-trim-offset");0===r[0]&&0===r[1]||e.push("RENDER_LINE_TRIM_OFFSET"),0!==t.paint.get("line-border-width").constantOr(1)&&e.push("RENDER_LINE_BORDER");const i="none"===t.layout.get("line-join").constantOr("miter"),n=!!t.paint.get("line-pattern").constantOr(1);return i&&n&&e.push("LINE_JOIN_NONE"),e};function mm(t){const e=t.paint.get("line-dasharray").value;return e.value||"constant"!==e.kind}class gm{constructor(t){this._stringToNumber={},this._numberToString=[];for(let e=0;e<t.length;e++){const r=t[e];this._stringToNumber[r]=e,this._numberToString[e]=r}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}var ym={read:function(t,e,r,i,n){var o,s,a=8*n-i-1,l=(1<<a)-1,c=l>>1,u=-7,h=r?n-1:0,d=r?-1:1,p=t[e+h];for(h+=d,o=p&(1<<-u)-1,p>>=-u,u+=a;u>0;o=256*o+t[e+h],h+=d,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=i;u>0;s=256*s+t[e+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,i),o-=c}return(p?-1:1)*s*Math.pow(2,o-i)},write:function(t,e,r,i,n,o){var s,a,l,c=8*o-n-1,u=(1<<c)-1,h=u>>1,d=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,f=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(e*l-1)*Math.pow(2,n),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,n),s=0));n>=8;t[r+p]=255&a,p+=f,a/=256,n-=8);for(s=s<<n|a,c+=n;c>0;t[r+p]=255&s,p+=f,s/=256,c-=8);t[r+p-f]|=128*m}},vm=bm,_m=ym;function bm(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}bm.Varint=0,bm.Fixed64=1,bm.Bytes=2,bm.Fixed32=5;var xm=4294967296,wm=1/xm,Tm="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Em(t){return t.type===bm.Bytes?t.readVarint()+t.pos:t.pos+1}function Sm(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Pm(t,e,r){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(i);for(var n=r.pos-1;n>=t;n--)r.buf[n+i]=r.buf[n]}function km(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function Am(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function Mm(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function Cm(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function Im(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function Om(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function Lm(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function Dm(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function Rm(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function Fm(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Bm(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function zm(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}bm.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var i=this.readVarint(),n=i>>3,o=this.pos;this.type=7&i,t(n,e,this),this.pos===o&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Fm(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=zm(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Fm(this.buf,this.pos)+Fm(this.buf,this.pos+4)*xm;return this.pos+=8,t},readSFixed64:function(){var t=Fm(this.buf,this.pos)+zm(this.buf,this.pos+4)*xm;return this.pos+=8,t},readFloat:function(){var t=_m.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=_m.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,i=this.buf;return e=127&(r=i[this.pos++]),r<128?e:(e|=(127&(r=i[this.pos++]))<<7,r<128?e:(e|=(127&(r=i[this.pos++]))<<14,r<128?e:(e|=(127&(r=i[this.pos++]))<<21,r<128?e:function(t,e,r){var i,n,o=r.buf;if(i=(112&(n=o[r.pos++]))>>4,n<128)return Sm(t,i,e);if(i|=(127&(n=o[r.pos++]))<<3,n<128)return Sm(t,i,e);if(i|=(127&(n=o[r.pos++]))<<10,n<128)return Sm(t,i,e);if(i|=(127&(n=o[r.pos++]))<<17,n<128)return Sm(t,i,e);if(i|=(127&(n=o[r.pos++]))<<24,n<128)return Sm(t,i,e);if(i|=(1&(n=o[r.pos++]))<<31,n<128)return Sm(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Tm?function(t,e,r){return Tm.decode(t.subarray(e,r))}(this.buf,e,t):function(t,e,r){for(var i="",n=e;n<r;){var o,s,a,l=t[n],c=null,u=l>239?4:l>223?3:l>191?2:1;if(n+u>r)break;1===u?l<128&&(c=l):2===u?128==(192&(o=t[n+1]))&&(c=(31&l)<<6|63&o)<=127&&(c=null):3===u?(s=t[n+2],128==(192&(o=t[n+1]))&&128==(192&s)&&((c=(15&l)<<12|(63&o)<<6|63&s)<=2047||c>=55296&&c<=57343)&&(c=null)):4===u&&(s=t[n+2],a=t[n+3],128==(192&(o=t[n+1]))&&128==(192&s)&&128==(192&a)&&((c=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,u=1):c>65535&&(c-=65536,i+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),i+=String.fromCharCode(c),n+=u}return i}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==bm.Bytes)return t.push(this.readVarint(e));var r=Em(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==bm.Bytes)return t.push(this.readSVarint());var e=Em(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==bm.Bytes)return t.push(this.readBoolean());var e=Em(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==bm.Bytes)return t.push(this.readFloat());var e=Em(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==bm.Bytes)return t.push(this.readDouble());var e=Em(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==bm.Bytes)return t.push(this.readFixed32());var e=Em(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==bm.Bytes)return t.push(this.readSFixed32());var e=Em(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==bm.Bytes)return t.push(this.readFixed64());var e=Em(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==bm.Bytes)return t.push(this.readSFixed64());var e=Em(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===bm.Varint)for(;this.buf[this.pos++]>127;);else if(e===bm.Bytes)this.pos=this.readVarint()+this.pos;else if(e===bm.Fixed32)this.pos+=4;else{if(e!==bm.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Bm(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Bm(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Bm(this.buf,-1&t,this.pos),Bm(this.buf,Math.floor(t*wm),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Bm(this.buf,-1&t,this.pos),Bm(this.buf,Math.floor(t*wm),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var r,i;if(t>=0?(r=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:(r=0,i=i+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,r){r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,r.buf[r.pos]=127&(t>>>=7)}(r,0,e),function(t,e){var r=(7&t)<<4;e.buf[e.pos++]|=r|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(i,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,r){for(var i,n,o=0;o<e.length;o++){if((i=e.charCodeAt(o))>55295&&i<57344){if(!n){i>56319||o+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):n=i;continue}if(i<56320){t[r++]=239,t[r++]=191,t[r++]=189,n=i;continue}i=n-55296<<10|i-56320|65536,n=null}else n&&(t[r++]=239,t[r++]=191,t[r++]=189,n=null);i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:(i<65536?t[r++]=i>>12|224:(t[r++]=i>>18|240,t[r++]=i>>12&63|128),t[r++]=i>>6&63|128),t[r++]=63&i|128)}return r}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&Pm(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),_m.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),_m.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var i=this.pos-r;i>=128&&Pm(r,i,this),this.pos=r-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,r){this.writeTag(t,bm.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,km,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Am,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Im,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Mm,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Cm,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Om,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Lm,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Dm,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Rm,e)},writeBytesField:function(t,e){this.writeTag(t,bm.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,bm.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,bm.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,bm.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,bm.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,bm.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,bm.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,bm.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,bm.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,bm.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var jm=d(vm);const Nm=["id","tile","layer","source","sourceLayer","state"];class Vm{constructor(t,e,r,i,n){this.type="Feature",this._vectorTileFeature=t,this._z=e,this._x=r,this._y=i,this.properties=t.properties,this.id=n}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const e of Nm)void 0!==this[e]&&(t[e]=this[e]);return t}}class Um{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,e,r){const i=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][i]=this.stateChanges[t][i]||{},rr(this.stateChanges[t][i],r),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==i&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][i]){this.deletedStates[t][i]={};for(const e in this.state[t][i])r[e]||(this.deletedStates[t][i][e]=null)}else for(const e in r)this.deletedStates[t]&&this.deletedStates[t][i]&&null===this.deletedStates[t][i][e]&&delete this.deletedStates[t][i][e]}removeFeatureState(t,e,r){if(null===this.deletedStates[t])return;const i=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},r&&void 0!==e)null!==this.deletedStates[t][i]&&(this.deletedStates[t][i]=this.deletedStates[t][i]||{},this.deletedStates[t][i][r]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][i])for(r in this.deletedStates[t][i]={},this.stateChanges[t][i])this.deletedStates[t][i][r]=null;else this.deletedStates[t][i]=null;else this.deletedStates[t]=null}getState(t,e){const r=String(e),i=rr({},(this.state[t]||{})[r],(this.stateChanges[t]||{})[r]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const r=this.deletedStates[t][e];if(null===r)return{};for(const t in r)delete i[t]}return i}initializeTileState(t,e){t.setFeatureState(this.state,e)}coalesceChanges(t,e){const r={};for(const t in this.stateChanges){this.state[t]=this.state[t]||{};const e={};for(const r in this.stateChanges[t])this.state[t][r]||(this.state[t][r]={}),rr(this.state[t][r],this.stateChanges[t][r]),e[r]=this.state[t][r];r[t]=e}for(const t in this.deletedStates){this.state[t]=this.state[t]||{};const e={};if(null===this.deletedStates[t])for(const r in this.state[t])e[r]={},this.state[t][r]={};else for(const r in this.deletedStates[t]){if(null===this.deletedStates[t][r])this.state[t][r]={};else if(this.state[t][r])for(const e of Object.keys(this.deletedStates[t][r]))delete this.state[t][r][e];e[r]=this.state[t][r]}r[t]=r[t]||{},rr(r[t],e)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(const i in t)t[i].setFeatureState(r,e)}}class $m{constructor(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Ta(mo,16,0),this.featureIndexArray=new wc,this.promoteId=e,this.is3DTile=!1}insert(t,e,r,i,n,o=0,s=0){const a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,i,n,o);const l=this.grid;for(let t=0;t<e.length;t++){const r=e[t],i=[1/0,1/0,-1/0,-1/0];for(let t=0;t<r.length;t++){const e=r[t];i[0]=Math.min(i[0],e.x),i[1]=Math.min(i[1],e.y),i[2]=Math.max(i[2],e.x),i[3]=Math.max(i[3],e.y)}0!==s&&(i[0]-=s,i[1]-=s,i[2]+=s,i[3]+=s),i[0]<mo&&i[1]<mo&&i[2]>=0&&i[3]>=0&&l.insert(a,i[0],i[1],i[2],i[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Ap(new jm(this.rawTileData)).layers,this.sourceLayerCoder=new gm(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,e,r,i){this.loadVTLayers();const n=t.params||{},o=fl(n.filter),s=t.tileResult,a=t.transform,l=s.bufferedTilespaceBounds,c=this.grid.query(l.min.x,l.min.y,l.max.x,l.max.y,((t,e,r,i)=>hh(s.bufferedTilespaceGeometry,t,e,r,i)));c.sort(Hm);let u=null;a.elevation&&c.length>0&&(u=sf.create(a.elevation,this.tileID));const h={};let d;for(let l=0;l<c.length;l++){const p=c[l];if(p===d)continue;d=p;const f=this.featureIndexArray.get(p);let m=null;if(this.is3DTile){const t=this.bucketLayerIDs[0][0],r=e[t];if("model"!==r.type)continue;const{queryFeature:i,intersectionZ:n}=r.queryIntersectsMatchingFeature(s,f.featureIndex,o,a);i&&this.appendToResult(h,t,f.featureIndex,i,n)}else this.loadMatchingFeature(h,f,o,n.layers,n.availableImages,e,r,i,((e,r,i,n=0)=>(m||(m=Yu(e,this.tileID.canonical,t.tileTransform)),r.queryIntersectsFeature(s,e,i,m,this.z,t.transform,t.pixelPosMatrix,u,n))))}return h}loadMatchingFeature(t,e,r,i,n,o,s,a,l){const{featureIndex:c,bucketIndex:u,sourceLayerIndex:h,layoutVertexArrayOffset:d}=e,p=this.bucketLayerIDs[u];if(i&&!function(t,e){for(let r=0;r<t.length;r++)if(e.indexOf(t[r])>=0)return!0;return!1}(i,p))return;const f=this.sourceLayerCoder.decode(h),m=this.vtLayers[f].feature(c);if(r.needGeometry){const t=Ku(m,!0);if(!r.filter(new Ka(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!r.filter(new Ka(this.tileID.overscaledZ),m))return;const g=this.getId(m,f);for(let e=0;e<p.length;e++){const r=p[e];if(i&&i.indexOf(r)<0)continue;const u=o[r];if(!u)continue;let h={};void 0!==g&&a&&(h=a.getState(u.sourceLayer||"_geojsonTileLayer",g));const f=!l||l(m,u,h,d);if(!f)continue;const y=new Vm(m,this.z,this.x,this.y,g),v=rr({},s[r]);v.paint=Gm(v.paint,u.paint,m,h,n),v.layout=Gm(v.layout,u.layout,m,h,n),y.layer=v,this.appendToResult(t,r,c,y,f)}}appendToResult(t,e,r,i,n){let o=t[e];void 0===o&&(o=t[e]=[]),o.push({featureIndex:r,feature:i,intersectionZ:n})}lookupSymbolFeatures(t,e,r,i,n,o,s,a){const l={};this.loadVTLayers();const c=fl(n);for(const n of t)this.loadMatchingFeature(l,{bucketIndex:r,sourceLayerIndex:i,featureIndex:n,layoutVertexArrayOffset:0},c,o,s,a,e);return l}loadFeature(t){const{featureIndex:e,sourceLayerIndex:r}=t;this.loadVTLayers();const i=this.sourceLayerCoder.decode(r),n=this.vtFeatures[i];if(n[e])return n[e];const o=this.vtLayers[i].feature(e);return n[e]=o,o}hasLayer(t){for(const e of this.bucketLayerIDs)for(const r of e)if(t===r)return!0;return!1}getId(t,e){let r=t.id;if(this.promoteId){const i="string"==typeof this.promoteId?this.promoteId:this.promoteId[e];null!=i&&(r=t.properties[i]),"boolean"==typeof r&&(r=Number(r))}return r}}function Gm(t,e,r,i,n){return ur(t,((t,o)=>{const s=e instanceof ol?e.get(o):null;return s&&s.evaluate?s.evaluate(r,i,n):s}))}function Hm(t,e){return e-t}Sa($m,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});var qm=24;const Wm=128;function Zm(t,e){const{expression:r}=e;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new Ka(t+1))};if("source"===r.kind)return{kind:"source"};{const{zoomStops:e,interpolationType:i}=r;let n=0;for(;n<e.length&&e[n]<=t;)n++;n=Math.max(0,n-1);let o=n;for(;o<e.length&&e[o]<t+1;)o++;o=Math.min(e.length-1,o);const s=e[n],a=e[o];return"composite"===r.kind?{kind:"composite",minZoom:s,maxZoom:a,interpolationType:i}:{kind:"camera",minZoom:s,maxZoom:a,minSize:r.evaluate(new Ka(s)),maxSize:r.evaluate(new Ka(a)),interpolationType:i}}}function Xm(t,{uSize:e,uSizeT:r},{lowerSize:i,upperSize:n}){return"source"===t.kind?i/Wm:"composite"===t.kind?qi(i/Wm,n/Wm,r):e}function Ym(t,e){let r=0,i=0;if("constant"===t.kind)i=t.layoutSize;else if("source"!==t.kind){const{interpolationType:n,minZoom:o,maxZoom:s}=t,a=n?Ke(Ts.interpolationFactor(n,e,o,s),0,1):0;"camera"===t.kind?i=qi(t.minSize,t.maxSize,a):r=a}return{uSizeT:r,uSize:i}}var Km=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Wm,evaluateSizeForFeature:Xm,evaluateSizeForZoom:Ym,getSizeData:Zm});function Jm(t,e,r){return t.sections.forEach((t=>{t.text=function(t,e,r){const i=e.layout.get("text-transform").evaluate(r,{});return"uppercase"===i?t=t.toLocaleUpperCase():"lowercase"===i&&(t=t.toLocaleLowerCase()),Ya.applyArabicShaping&&(t=Ya.applyArabicShaping(t)),t}(t.text,e,r)})),t}const Qm={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function tg(t){return"︶"===t||"﹈"===t||"︸"===t||"﹄"===t||"﹂"===t||"︾"===t||"︼"===t||"︺"===t||"︘"===t||"﹀"===t||"︐"===t||"︓"===t||"︔"===t||"｀"===t||"￣"===t||"︑"===t||"︒"===t}function eg(t){return"︵"===t||"﹇"===t||"︷"===t||"﹃"===t||"﹁"===t||"︽"===t||"︻"===t||"︹"===t||"︗"===t||"︿"===t}const rg=3;function ig(t,e,r){e.glyphs=[],1===t&&r.readMessage(ng,e)}function ng(t,e,r){if(3===t){const{id:t,bitmap:i,width:n,height:o,left:s,top:a,advance:l}=r.readMessage(og,{});e.glyphs.push({id:t,bitmap:new gd({width:n+2*rg,height:o+2*rg},i),metrics:{width:n,height:o,left:s,top:a,advance:l}})}else 4===t?e.ascender=r.readSVarint():5===t&&(e.descender=r.readSVarint())}function og(t,e,r){1===t?e.id=r.readVarint():2===t?e.bitmap=r.readBytes():3===t?e.width=r.readVarint():4===t?e.height=r.readVarint():5===t?e.left=r.readSVarint():6===t?e.top=r.readSVarint():7===t&&(e.advance=r.readVarint())}const sg=rg,ag={horizontal:1,vertical:2,horizontalOnly:3};class lg{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,e){const r=new lg;return r.scale=t||1,r.fontStack=e,r}static forImage(t){const e=new lg;return e.imageName=t,e}}class cg{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,e){const r=new cg;for(let i=0;i<t.sections.length;i++){const n=t.sections[i];n.image?r.addImageSection(n):r.addTextSection(n,e)}return r}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=function(t,e){let r="";for(let i=0;i<t.length;i++){const n=t.charCodeAt(i+1)||null,o=t.charCodeAt(i-1)||null;r+=!e&&(n&&Ra(n)&&!Qm[t[i+1]]||o&&Ra(o)&&!Qm[t[i-1]])||!Qm[t[i]]?t[i]:Qm[t[i]]}return r}(this.text,t)}trim(){let t=0;for(let e=0;e<this.text.length&&hg[this.text.charCodeAt(e)];e++)t++;let e=this.text.length;for(let r=this.text.length-1;r>=0&&r>=t&&hg[this.text.charCodeAt(r)];r--)e--;this.text=this.text.substring(t,e),this.sectionIndex=this.sectionIndex.slice(t,e)}substring(t,e){const r=new cg;return r.text=this.text.substring(t,e),r.sectionIndex=this.sectionIndex.slice(t,e),r.sections=this.sections,r}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,e)=>Math.max(t,this.sections[e].scale)),0)}addTextSection(t,e){this.text+=t.text,this.sections.push(lg.forText(t.scale,t.fontStack||e));const r=this.sections.length-1;for(let e=0;e<t.text.length;++e)this.sectionIndex.push(r)}addImageSection(t){const e=t.image?t.image.namePrimary:"";if(0===e.length)return void fr("Can't add FormattedSection with an empty image.");const r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCodePoint(r),this.sections.push(lg.forImage(e)),this.sectionIndex.push(this.sections.length-1)):fr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ug(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f){const m=cg.fromFeature(t,n);h===ag.vertical&&m.verticalizePunctuation(d);let g=[];const y=function(t,e,r,i,n,o){if(!t)return[];const s=[],a=function(t,e,r,i,n,o){let s=0;for(let r=0;r<t.length();r++){const a=t.getSection(r);s+=pg(t.getCodePoint(r),a,i,n,e,o)}return s/Math.max(1,Math.ceil(s/r))}(t,e,r,i,n,o),l=t.text.indexOf("​")>=0;let c=0;for(let r=0;r<t.length();r++){const h=t.getSection(r),d=t.getCodePoint(r);if(hg[d]||(c+=pg(d,h,i,n,e,o)),r<t.length()-1){const e=!((u=d)<11904||!(Ca["Bopomofo Extended"](u)||Ca.Bopomofo(u)||Ca["CJK Compatibility Forms"](u)||Ca["CJK Compatibility Ideographs"](u)||Ca["CJK Compatibility"](u)||Ca["CJK Radicals Supplement"](u)||Ca["CJK Strokes"](u)||Ca["CJK Symbols and Punctuation"](u)||Ca["CJK Unified Ideographs Extension A"](u)||Ca["CJK Unified Ideographs"](u)||Ca["Enclosed CJK Letters and Months"](u)||Ca["Halfwidth and Fullwidth Forms"](u)||Ca.Hiragana(u)||Ca["Ideographic Description Characters"](u)||Ca["Kangxi Radicals"](u)||Ca["Katakana Phonetic Extensions"](u)||Ca.Katakana(u)||Ca["Vertical Forms"](u)||Ca["Yi Radicals"](u)||Ca["Yi Syllables"](u)));(dg[d]||e||h.imageName)&&s.push(gg(r+1,c,a,s,mg(d,t.getCodePoint(r+1),e&&l),!1))}}var u;return yg(gg(t.length(),c,a,s,0,!0))}(m,c,o,e,i,p),{processBidirectionalText:v,processStyledBidirectionalText:_}=Ya;if(v&&1===m.sections.length){const t=v(m.toString(),y);for(const e of t){const t=new cg;t.text=e,t.sections=m.sections;for(let r=0;r<e.length;r++)t.sectionIndex.push(0);g.push(t)}}else if(_){const t=_(m.text,m.sectionIndex,y);for(const e of t){const t=new cg;t.text=e[0],t.sectionIndex=e[1],t.sections=m.sections,g.push(t)}}else g=function(t,e){const r=[],i=t.text;let n=0;for(const i of e)r.push(t.substring(n,i)),n=i;return n<i.length&&r.push(t.substring(n,i.length)),r}(m,y);const b=[],x={positionedLines:b,text:m.toString(),top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:h,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(t,e,r,i,n,o,s,a,l,c,u,h){let d=0,p=0,f=0;const m="right"===a?1:"left"===a?0:.5;let g=!1;for(const t of n){const r=t.getSections();for(const t of r){if(t.imageName)continue;const r=e[t.fontStack];if(r&&(g=void 0!==r.ascender&&void 0!==r.descender,!g))break}if(!g)break}let y=0;for(const s of n){s.trim();const n=s.getMaxScale(),a=(n-1)*qm,_={positionedGlyphs:[],lineOffset:0};t.positionedLines[y]=_;const b=_.positionedGlyphs;let x=0;if(!s.length()){p+=o,++y;continue}let w=0,T=0;for(let o=0;o<s.length();o++){const a=s.getSection(o),f=s.getSectionIndex(o),m=s.getCodePoint(o);let y=a.scale,_=null,E=null,S=null,P=qm,k=0;const A=!(l===ag.horizontal||!u&&!Da(m)||u&&(hg[m]||(v=m,Ca.Arabic(v)||Ca["Arabic Supplement"](v)||Ca["Arabic Extended-A"](v)||Ca["Arabic Presentation Forms-A"](v)||Ca["Arabic Presentation Forms-B"](v))));if(a.imageName){const e=i[a.imageName];if(!e)continue;S=a.imageName,t.iconsInText=t.iconsInText||!0,E=e.paddedRect;const r=e.displaySize;y=y*qm/h,_={width:r[0],height:r[1],left:0,top:-sg,advance:A?r[1]:r[0],localGlyph:!1},k=g?-_.height*y:n*qm-17-r[1]*y,P=_.advance;const o=(A?r[0]:r[1])*y-qm*n;o>0&&o>x&&(x=o)}else{const t=r[a.fontStack];if(!t)continue;t[m]&&(E=t[m]);const i=e[a.fontStack];if(!i)continue;const o=i.glyphs[m];if(!o)continue;if(_=o.metrics,P=8203!==m?qm:0,g){const t=void 0!==i.ascender?Math.abs(i.ascender):0,e=void 0!==i.descender?Math.abs(i.descender):0,r=(t+e)*y;w<r&&(w=r,T=(t-e)/2*y),k=-t*y}else k=(n-y)*qm-17}A?(t.verticalizable=!0,b.push({glyph:m,imageName:S,x:d,y:p+k,vertical:A,scale:y,localGlyph:_.localGlyph,fontStack:a.fontStack,sectionIndex:f,metrics:_,rect:E}),d+=P*y+c):(b.push({glyph:m,imageName:S,x:d,y:p+k,vertical:A,scale:y,localGlyph:_.localGlyph,fontStack:a.fontStack,sectionIndex:f,metrics:_,rect:E}),d+=_.advance*y+c)}0!==b.length&&(f=Math.max(d-c,f),g?_g(b,m,x,T,o*n/2):_g(b,m,x,0,o/2)),d=0;const E=o*n+x;_.lineOffset=Math.max(x,a),p+=E,++y}var v;const _=p,{horizontalAlign:b,verticalAlign:x}=vg(s);(function(t,e,r,i,n,o){const s=(e-r)*n,a=-o*i;for(const e of t)for(const t of e.positionedGlyphs)t.x+=s,t.y+=a})(t.positionedLines,m,b,x,f,_),t.top+=-x*_,t.bottom=t.top+_,t.left+=-b*f,t.right=t.left+f,t.hasBaseline=g}(x,e,r,i,g,s,a,l,h,c,d,f),!function(t){for(const e of t)if(0!==e.positionedGlyphs.length)return!1;return!0}(b)&&x}const hg={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},dg={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function pg(t,e,r,i,n,o){if(e.imageName){const t=i[e.imageName];return t?t.displaySize[0]*e.scale*qm/o+n:0}{const i=r[e.fontStack],o=i&&i.glyphs[t];return o?o.metrics.advance*e.scale+n:0}}function fg(t,e,r,i){const n=Math.pow(t-e,2);return i?t<e?n/2:2*n:n+Math.abs(r)*r}function mg(t,e,r){let i=0;return 10===t&&(i-=1e4),r&&(i+=150),40!==t&&65288!==t||(i+=50),41!==e&&65289!==e||(i+=50),i}function gg(t,e,r,i,n,o){let s=null,a=fg(e,r,n,o);for(const t of i){const i=fg(e-t.x,r,n,o)+t.badness;i<=a&&(s=t,a=i)}return{index:t,x:e,priorBreak:s,badness:a}}function yg(t){return t?yg(t.priorBreak).concat(t.index):[]}function vg(t){let e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function _g(t,e,r,i,n){if(!(e||r||i||n))return;const o=t.length-1,s=t[o],a=(s.x+s.metrics.advance*s.scale)*e;for(let e=0;e<=o;e++)t[e].x-=a,t[e].y+=r+i+n}function bg(t,e,r,i){const{horizontalAlign:n,verticalAlign:o}=vg(i),s=r[0]-t.displaySize[0]*n,a=r[1]-t.displaySize[1]*o;return{imagePrimary:t,imageSecondary:e,top:a,bottom:a+t.displaySize[1],left:s,right:s+t.displaySize[0]}}function xg(t,e,r,i,n,o){const s=t.imagePrimary;let a;if(s.content){const t=s.content,e=s.pixelRatio||1;a=[t[0]/e,t[1]/e,s.displaySize[0]-t[2]/e,s.displaySize[1]-t[3]/e]}const l=e.left*o,c=e.right*o;let u,h,d,p;"width"===r||"both"===r?(p=n[0]+l-i[3],h=n[0]+c+i[1]):(p=n[0]+(l+c-s.displaySize[0])/2,h=p+s.displaySize[0]);const f=e.top*o,m=e.bottom*o;return"height"===r||"both"===r?(u=n[1]+f-i[0],d=n[1]+m+i[2]):(u=n[1]+(f+m-s.displaySize[1])/2,d=u+s.displaySize[1]),{imagePrimary:s,imageSecondary:void 0,top:u,right:h,bottom:d,left:p,collisionPadding:a}}class wg extends Ve{constructor(t,e,r,i,n){super(t,e),this.angle=i,this.z=r,void 0!==n&&(this.segment=n)}clone(){return new wg(this.x,this.y,this.z,this.angle,this.segment)}}function Tg(t,e,r,i,n){if(void 0===e.segment)return!0;let o=e,s=e.segment+1,a=0;for(;a>-r/2;){if(s--,s<0)return!1;a-=t[s].dist(o),o=t[s]}a+=t[s].dist(t[s+1]),s++;const l=[];let c=0;for(;a<r/2;){const e=t[s],r=t[s+1];if(!r)return!1;let o=t[s-1].angleTo(e)-e.angleTo(r);for(o=Math.abs((o+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:a,angleDelta:o}),c+=o;a-l[0].distance>i;)c-=l.shift().angleDelta;if(c>n)return!1;s++,a+=e.dist(r)}return!0}function Eg(t){let e=0;for(let r=0;r<t.length-1;r++)e+=t[r].dist(t[r+1]);return e}function Sg(t,e,r){return t?.6*e*r:0}function Pg(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function kg(t,e,r,i,n,o){const s=Sg(r,n,o),a=Pg(r,i)*o;let l=0;const c=Eg(t)/2;for(let r=0;r<t.length-1;r++){const i=t[r],n=t[r+1],o=i.dist(n);if(l+o>c){const u=(c-l)/o,h=qi(i.x,n.x,u),d=qi(i.y,n.y,u),p=new wg(h,d,0,n.angleTo(i),r);return!s||Tg(t,p,a,s,e)?p:void 0}l+=o}}function Ag(t,e,r,i,n,o,s,a,l){const c=Sg(i,o,s),u=Pg(i,n),h=u*s,d=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-h<e/4&&(e=h+e/4),Mg(t,d?e/2*a%e:(u/2+2*o)*s*a%e,e,c,r,h,d,!1,l)}function Mg(t,e,r,i,n,o,s,a,l){const c=o/2,u=Eg(t);let h=0,d=e-r,p=[];for(let e=0;e<t.length-1;e++){const s=t[e],a=t[e+1],f=s.dist(a),m=a.angleTo(s);for(;d+r<h+f;){d+=r;const g=(d-h)/f,y=qi(s.x,a.x,g),v=qi(s.y,a.y,g);if(y>=0&&y<l&&v>=0&&v<l&&d-c>=0&&d+c<=u){const r=new wg(y,v,0,m,e);i&&!Tg(t,r,o,i,n)||p.push(r)}}h+=f}return a||p.length||s||(p=Mg(t,h/2,r,i,n,o,s,!0,l)),p}function Cg(t,e,r,i,n){const o=[];for(let s=0;s<t.length;s++){const a=t[s];let l;for(let t=0;t<a.length-1;t++){let s=a[t],c=a[t+1];s.x<e&&c.x<e||(s.x<e?s=new Ve(e,s.y+(e-s.x)/(c.x-s.x)*(c.y-s.y))._round():c.x<e&&(c=new Ve(e,s.y+(e-s.x)/(c.x-s.x)*(c.y-s.y))._round()),s.y<r&&c.y<r||(s.y<r?s=new Ve(s.x+(r-s.y)/(c.y-s.y)*(c.x-s.x),r)._round():c.y<r&&(c=new Ve(s.x+(r-s.y)/(c.y-s.y)*(c.x-s.x),r)._round()),s.x>=i&&c.x>=i||(s.x>=i?s=new Ve(i,s.y+(i-s.x)/(c.x-s.x)*(c.y-s.y))._round():c.x>=i&&(c=new Ve(i,s.y+(i-s.x)/(c.x-s.x)*(c.y-s.y))._round()),s.y>=n&&c.y>=n||(s.y>=n?s=new Ve(s.x+(n-s.y)/(c.y-s.y)*(c.x-s.x),n)._round():c.y>=n&&(c=new Ve(s.x+(n-s.y)/(c.y-s.y)*(c.x-s.x),n)._round()),l&&s.equals(l[l.length-1])||(l=[s],o.push(l)),l.push(c)))))}}return o}function Ig(t){let e=0,r=0;for(const i of t)e+=i.w*i.h,r=Math.max(r,i.w);t.sort(((t,e)=>e.h-t.h));const i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}];let n=0,o=0;for(const e of t)for(let t=i.length-1;t>=0;t--){const r=i[t];if(!(e.w>r.w||e.h>r.h)){if(e.x=r.x,e.y=r.y,o=Math.max(o,e.y+e.h),n=Math.max(n,e.x+e.w),e.w===r.w&&e.h===r.h){const e=i.pop();t<i.length&&(i[t]=e)}else e.h===r.h?(r.x+=e.w,r.w-=e.w):e.w===r.w?(r.y+=e.h,r.h-=e.h):(i.push({x:r.x+e.w,y:r.y,w:r.w-e.w,h:e.h}),r.y+=e.h,r.h-=e.h);break}}return{w:n,h:o,fill:e/(n*o)||0}}Sa(wg,"Anchor");const Og=1;class Lg{constructor(t,{pixelRatio:e,version:r,stretchX:i,stretchY:n,content:o}){this.paddedRect=t,this.pixelRatio=e,this.stretchX=i,this.stretchY=n,this.content=o,this.version=r}get tl(){return[this.paddedRect.x+Og,this.paddedRect.y+Og]}get br(){return[this.paddedRect.x+this.paddedRect.w-Og,this.paddedRect.y+this.paddedRect.h-Og]}get displaySize(){return[(this.paddedRect.w-2*Og)/this.pixelRatio,(this.paddedRect.h-2*Og)/this.pixelRatio]}}class Dg{constructor(t,e,r){const i={},n={};this.haveRenderCallbacks=[];const o=[];this.addImages(t,i,o),this.addImages(e,n,o);const{w:s,h:a}=Ig(o),l=new yd({width:s||1,height:a||1});for(const e in t){const n=t[e],o=i[e].paddedRect;yd.copy(n.data,l,{x:0,y:0},{x:o.x+Og,y:o.y+Og},n.data,r,n.sdf)}for(const t in e){const i=e[t],o=n[t].paddedRect,s=o.x+Og,a=o.y+Og,c=i.data.width,u=i.data.height;yd.copy(i.data,l,{x:0,y:0},{x:s,y:a},i.data,r),yd.copy(i.data,l,{x:0,y:u-1},{x:s,y:a-1},{width:c,height:1},r),yd.copy(i.data,l,{x:0,y:0},{x:s,y:a+u},{width:c,height:1},r),yd.copy(i.data,l,{x:c-1,y:0},{x:s-1,y:a},{width:1,height:u},r),yd.copy(i.data,l,{x:0,y:0},{x:s+c,y:a},{width:1,height:u},r)}this.image=l,this.iconPositions=i,this.patternPositions=n}addImages(t,e,r){for(const i in t){const n=t[i],o={x:0,y:0,w:n.data.width+2*Og,h:n.data.height+2*Og};r.push(o),e[i]=new Lg(o,n),n.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(t,e,r){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((e=>t.hasImage(e,r))),t.dispatchRenderCallbacks(this.haveRenderCallbacks,r);for(const i in t.getUpdatedImages(r))this.patchUpdatedImage(this.iconPositions[i],t.getImage(i,r),e),this.patchUpdatedImage(this.patternPositions[i],t.getImage(i,r),e)}patchUpdatedImage(t,e,r){if(!t||!e)return;if(t.version===e.version)return;t.version=e.version;const[i,n]=t.tl,o=!!Object.keys(this.patternPositions).length;r.update(e.data,{useMipmap:o},{x:i,y:n})}}Sa(Lg,"ImagePosition"),Sa(Dg,"ImageAtlas");const Rg=1e20;function Fg(t,e,r,i,n,o,s,a,l){for(let c=e;c<e+i;c++)Bg(t,r*o+c,o,n,s,a,l);for(let c=r;c<r+n;c++)Bg(t,c*o+e,1,i,s,a,l)}function Bg(t,e,r,i,n,o,s){o[0]=0,s[0]=-Rg,s[1]=Rg,n[0]=t[e];for(let a=1,l=0,c=0;a<i;a++){n[a]=t[e+a*r];const i=a*a;do{const t=o[l];c=(n[a]-n[t]+i-t*t)/(a-t)/2}while(c<=s[l]&&--l>-1);l++,o[l]=a,s[l]=c,s[l+1]=Rg}for(let a=0,l=0;a<i;a++){for(;s[l+1]<a;)l++;const i=o[l],c=a-i;t[e+a*r]=n[i]+c*c}}const zg=2,jg={none:0,ideographs:1,all:2};class Ng{constructor(t,e,r){this.requestManager=t,this.localGlyphMode=e,this.localFontFamily=r,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t,e){this.urls[e]=t}getGlyphs(t,e,r){const n=[],o=this.urls[e]||i.GLYPHS_URL;for(const e in t)for(const r of t[e])n.push({stack:e,id:r});tr(n,(({stack:t,id:e},r)=>{let i=this.entries[t];i||(i=this.entries[t]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let n=i.glyphs[e];if(void 0!==n)return void r(null,{stack:t,id:e,glyph:n});if(n=this._tinySDF(i,t,e),n)return i.glyphs[e]=n,void r(null,{stack:t,id:e,glyph:n});const s=Math.floor(e/256);if(256*s>65535)return void r(new Error("glyphs > 65535 not supported"));if(i.ranges[s])return void r(null,{stack:t,id:e,glyph:n});let a=i.requests[s];a||(a=i.requests[s]=[],Ng.loadGlyphRange(t,s,o,this.requestManager,((t,e)=>{if(e){i.ascender=e.ascender,i.descender=e.descender;for(const t in e.glyphs)this._doesCharSupportLocalGlyph(+t)||(i.glyphs[+t]=e.glyphs[+t]);i.ranges[s]=!0}for(const r of a)r(t,e);delete i.requests[s]}))),a.push(((i,n)=>{i?r(i):n&&r(null,{stack:t,id:e,glyph:n.glyphs[e]||null})}))}),((t,e)=>{if(t)r(t);else if(e){const t={};for(const{stack:r,id:i,glyph:n}of e)void 0===t[r]&&(t[r]={}),void 0===t[r].glyphs&&(t[r].glyphs={}),t[r].glyphs[i]=n&&{id:n.id,bitmap:n.bitmap.clone(),metrics:n.metrics},t[r].ascender=this.entries[r].ascender,t[r].descender=this.entries[r].descender;r(null,t)}}))}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==jg.none&&(this.localGlyphMode===jg.all?!!this.localFontFamily:!!this.localFontFamily&&(Ca["CJK Unified Ideographs"](t)||Ca["Hangul Syllables"](t)||Ca.Hiragana(t)||Ca.Katakana(t)||Ca["CJK Symbols and Punctuation"](t)||Ca["CJK Unified Ideographs Extension A"](t)||Ca["CJK Unified Ideographs Extension B"](t)))}_tinySDF(t,e,r){const i=this.localFontFamily;if(!i||!this._doesCharSupportLocalGlyph(r))return;let n=t.tinySDF;if(!n){let r="400";/bold/i.test(e)?r="900":/medium/i.test(e)?r="500":/light/i.test(e)&&(r="200"),n=t.tinySDF=new Ng.TinySDF({fontFamily:i,fontWeight:r,fontSize:24*zg,buffer:3*zg,radius:8*zg}),n.fontWeight=r}if(this.localGlyphs[n.fontWeight][r])return this.localGlyphs[n.fontWeight][r];const o=String.fromCodePoint(r),{data:s,width:a,height:l,glyphWidth:c,glyphHeight:u,glyphLeft:h,glyphTop:d,glyphAdvance:p}=n.draw(o);return this.localGlyphs[n.fontWeight][r]={id:r,bitmap:new gd({width:a,height:l},s),metrics:{width:c/zg,height:u/zg,left:h/zg,top:d/zg-27,advance:p/zg,localGlyph:!0}}}}Ng.loadGlyphRange=function(t,e,r,i,n){const o=256*e,s=o+255,a=i.transformRequest(i.normalizeGlyphsURL(r).replace("{fontstack}",t).replace("{range}",`${o}-${s}`),Qr.Glyphs);ii(a,((t,e)=>{if(t)n(t);else if(e){const t={},r=function(t){return new jm(t).readFields(ig,{})}(e);for(const e of r.glyphs)t[e.id]=e;n(null,{glyphs:t,ascender:r.ascender,descender:r.descender})}}))},Ng.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:r=8,cutoff:i=.25,fontFamily:n="sans-serif",fontWeight:o="normal",fontStyle:s="normal"}={}){this.buffer=e,this.cutoff=i,this.radius=r;const a=this.size=t+4*e,l=this._createCanvas(a),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font=`${s} ${o} ${t}px ${n}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:n,actualBoundingBoxRight:o}=this.ctx.measureText(t),s=Math.ceil(r),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-n))),l=Math.min(this.size-this.buffer,s+Math.ceil(i)),c=a+2*this.buffer,u=l+2*this.buffer,h=Math.max(c*u,0),d=new Uint8ClampedArray(h),p={data:d,width:c,height:u,glyphWidth:a,glyphHeight:l,glyphTop:s,glyphLeft:0,glyphAdvance:e};if(0===a||0===l)return p;const{ctx:f,buffer:m,gridInner:g,gridOuter:y}=this;f.clearRect(m,m,a,l),f.fillText(t,m,m+s);const v=f.getImageData(m,m,a,l);y.fill(Rg,0,h),g.fill(0,0,h);for(let t=0;t<l;t++)for(let e=0;e<a;e++){const r=v.data[4*(t*a+e)+3]/255;if(0===r)continue;const i=(t+m)*c+e+m;if(1===r)y[i]=0,g[i]=Rg;else{const t=.5-r;y[i]=t>0?t*t:0,g[i]=t<0?t*t:0}}Fg(y,0,0,c,u,c,this.f,this.v,this.z),Fg(g,m,m,a,l,c,this.f,this.v,this.z);for(let t=0;t<h;t++){const e=Math.sqrt(y[t])-Math.sqrt(g[t]);d[t]=Math.round(255-255*(e/this.radius+this.cutoff))}return p}};const Vg=Og;function Ug(t,e,r,i){const n=[],o=t.imagePrimary,s=o.pixelRatio,a=o.paddedRect.w-2*Vg,l=o.paddedRect.h-2*Vg,c=t.right-t.left,u=t.bottom-t.top,h=o.stretchX||[[0,a]],d=o.stretchY||[[0,l]],p=(t,e)=>t+e[1]-e[0],f=h.reduce(p,0),m=d.reduce(p,0),g=a-f,y=l-m;let v=0,_=f,b=0,x=m,w=0,T=g,E=0,S=y;if(o.content&&i){const t=o.content;v=$g(h,0,t[0]),b=$g(d,0,t[1]),_=$g(h,t[0],t[2]),x=$g(d,t[1],t[3]),w=t[0]-v,E=t[1]-b,T=t[2]-t[0]-_,S=t[3]-t[1]-x}const P=(i,n,a,l)=>{const h=Hg(i.stretch-v,_,c,t.left),d=qg(i.fixed-w,T,i.stretch,f),p=Hg(n.stretch-b,x,u,t.top),g=qg(n.fixed-E,S,n.stretch,m),y=Hg(a.stretch-v,_,c,t.left),P=qg(a.fixed-w,T,a.stretch,f),k=Hg(l.stretch-b,x,u,t.top),A=qg(l.fixed-E,S,l.stretch,m),M=new Ve(h,p),C=new Ve(y,p),I=new Ve(y,k),O=new Ve(h,k),L=new Ve(d/s,g/s),D=new Ve(P/s,A/s),R=e*Math.PI/180;if(R){const t=Math.sin(R),e=Math.cos(R),r=[e,-t,t,e];M._matMult(r),C._matMult(r),O._matMult(r),I._matMult(r)}const F=i.stretch+i.fixed,B=a.stretch+a.fixed,z=n.stretch+n.fixed,j=l.stretch+l.fixed,N=t.imageSecondary;return{tl:M,tr:C,bl:O,br:I,texPrimary:{x:o.paddedRect.x+Vg+F,y:o.paddedRect.y+Vg+z,w:B-F,h:j-z},texSecondary:N?{x:N.paddedRect.x+Vg+F,y:N.paddedRect.y+Vg+z,w:B-F,h:j-z}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:L,pixelOffsetBR:D,minFontScaleX:T/s/c,minFontScaleY:S/s/u,isSDF:r}};if(i&&(o.stretchX||o.stretchY)){const t=Gg(h,g,f),e=Gg(d,y,m);for(let r=0;r<t.length-1;r++){const i=t[r],o=t[r+1];for(let t=0;t<e.length-1;t++)n.push(P(i,e[t],o,e[t+1]))}}else n.push(P({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:a+1},{fixed:0,stretch:l+1}));return n}function $g(t,e,r){let i=0;for(const n of t)i+=Math.max(e,Math.min(r,n[1]))-Math.max(e,Math.min(r,n[0]));return i}function Gg(t,e,r){const i=[{fixed:-Vg,stretch:0}];for(const[e,r]of t){const t=i[i.length-1];i.push({fixed:e-t.stretch,stretch:t.stretch}),i.push({fixed:e-t.stretch,stretch:t.stretch+(r-e)})}return i.push({fixed:e+Vg,stretch:r}),i}function Hg(t,e,r,i){return t/e*r+i}function qg(t,e,r,i){return t-e*r/i}function Wg(t,e,r,i){const n=e+t.positionedLines[i].lineOffset;return 0===i?r+n/2:r+(n+(e+t.positionedLines[i-1].lineOffset))/2}function Zg(t,e=1,r=!1){let i=1/0,n=1/0,o=-1/0,s=-1/0;const a=t[0];for(let t=0;t<a.length;t++){const e=a[t];(!t||e.x<i)&&(i=e.x),(!t||e.y<n)&&(n=e.y),(!t||e.x>o)&&(o=e.x),(!t||e.y>s)&&(s=e.y)}const l=Math.min(o-i,s-n);let c=l/2;const u=new fo([],Xg);if(0===l)return new Ve(i,n);for(let e=i;e<o;e+=l)for(let r=n;r<s;r+=l)u.push(new Yg(e+c,r+c,c,t));let h=function(t){let e=0,r=0,i=0;const n=t[0];for(let t=0,o=n.length,s=o-1;t<o;s=t++){const o=n[t],a=n[s],l=o.x*a.y-a.x*o.y;r+=(o.x+a.x)*l,i+=(o.y+a.y)*l,e+=3*l}return new Yg(r/e,i/e,0,t)}(t),d=u.length;for(;u.length;){const i=u.pop();(i.d>h.d||!h.d)&&(h=i,r&&console.log("found best %d after %d probes",Math.round(1e4*i.d)/1e4,d)),i.max-h.d<=e||(c=i.h/2,u.push(new Yg(i.p.x-c,i.p.y-c,c,t)),u.push(new Yg(i.p.x+c,i.p.y-c,c,t)),u.push(new Yg(i.p.x-c,i.p.y+c,c,t)),u.push(new Yg(i.p.x+c,i.p.y+c,c,t)),d+=4)}return r&&(console.log(`num probes: ${d}`),console.log(`best distance: ${h.d}`)),h.p}function Xg(t,e){return e.max-t.max}class Yg{constructor(t,e,r,i){this.p=new Ve(t,e),this.h=r,this.d=function(t,e){let r=!1,i=1/0;for(let n=0;n<e.length;n++){const o=e[n];for(let e=0,n=o.length,s=n-1;e<n;s=e++){const n=o[e],a=o[s];n.y>t.y!=a.y>t.y&&t.x<(a.x-n.x)*(t.y-n.y)/(a.y-n.y)+n.x&&(r=!r),i=Math.min(i,lh(t,n,a))}}return(r?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}}const Kg=Number.POSITIVE_INFINITY,Jg=Math.sqrt(2);function Qg(t,[e,r]){let i=0,n=0;if(r===Kg){e<0&&(e=0);const r=e/Jg;switch(t){case"top-right":case"top-left":n=r-7;break;case"bottom-right":case"bottom-left":n=7-r;break;case"bottom":n=7-e;break;case"top":n=e-7}switch(t){case"top-right":case"bottom-right":i=-r;break;case"top-left":case"bottom-left":i=r;break;case"left":i=e;break;case"right":i=-e}}else{switch(e=Math.abs(e),r=Math.abs(r),t){case"top-right":case"top-left":case"top":n=r-7;break;case"bottom-right":case"bottom-left":case"bottom":n=7-r}switch(t){case"top-right":case"bottom-right":case"right":i=-e;break;case"top-left":case"bottom-left":case"left":i=e}}return[i,n]}function ty(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ey(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f){let m=o.textMaxSize.evaluate(e,{},h);void 0===m&&(m=s);const g=t.layers[0].layout,y=g.get("icon-offset").evaluate(e,{},h),v=oy(r.horizontal)||r.vertical,_="globe"===d.name,b=qm,x=s/b,w=t.tilePixelRatio*m/b,T=(I=t.overscaling,t.zoom>18&&I>2&&(I>>=1),Math.max(mo/(512*I),1)*g.get("symbol-spacing")),E=g.get("text-padding")*t.tilePixelRatio,S=g.get("icon-padding")*t.tilePixelRatio,P=He(g.get("text-max-angle")),k="map"===g.get("text-rotation-alignment")&&"point"!==g.get("symbol-placement"),A="map"===g.get("icon-rotation-alignment")&&"point"!==g.get("symbol-placement"),M=g.get("symbol-placement"),C=T/2;var I;const O=g.get("icon-text-fit").evaluate(e,{},h),L=g.get("icon-text-fit-padding").evaluate(e,{},h),D="none"!==O;let R;!1===t.hasAnyIconTextFit&&D&&(t.hasAnyIconTextFit=!0),i&&D&&(t.allowVerticalPlacement&&r.vertical&&(R=xg(i,r.vertical,O,L,y,x)),v&&(i=xg(i,v,O,L,y,x)));const F=(s,a,m)=>{if(a.x<0||a.x>=mo||a.y<0||a.y>=mo)return;let g=null;if(_){const{x:t,y:e,z:r}=d.projectTilePoint(a.x,a.y,m);g={anchor:new wg(t,e,r,0,void 0),up:d.upVector(m,a.x,a.y)}}!function(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y,v,_,b,x,w,T,E,S,P){const k=t.addToLineVertexArray(e,i);let A,M,C,I,O,L,D,R=0,F=0,B=0,z=0,j=-1,N=-1;const V={};let U=Li("");const $=r?r.anchor:e,G="none"!==l.layout.get("icon-text-fit").evaluate(b,{},E);let H=0,q=0;if(void 0===l._unevaluatedLayout.getValue("text-radial-offset")?[H,q]=l.layout.get("text-offset").evaluate(b,{},E).map((t=>t*qm)):(H=l.layout.get("text-radial-offset").evaluate(b,{},E)*qm,q=Kg),t.allowVerticalPlacement&&n.vertical){const t=n.vertical;if(f)L=ay(t),a&&(D=ay(a));else{const r=l.layout.get("text-rotate").evaluate(b,{},E)+90;C=sy(c,$,e,u,h,d,t,p,r,m),a&&(I=sy(c,$,e,u,h,d,a,y,r))}}if(o){const i=l.layout.get("icon-rotate").evaluate(b,{},E),n=Ug(o,i,w,G),s=a?Ug(a,i,w,G):void 0;M=sy(c,$,e,u,h,d,o,y,i),R=4*n.length;const p=t.iconSizeData;let f=null;"source"===p.kind?(f=[Wm*l.layout.get("icon-size").evaluate(b,{},E)],f[0]>iy&&fr(`${t.layerIds[0]}: Value for "icon-size" is >= ${ry}. Reduce your "icon-size".`)):"composite"===p.kind&&(f=[Wm*x.compositeIconSizes[0].evaluate(b,{},E),Wm*x.compositeIconSizes[1].evaluate(b,{},E)],(f[0]>iy||f[1]>iy)&&fr(`${t.layerIds[0]}: Value for "icon-size" is >= ${ry}. Reduce your "icon-size".`)),t.addSymbols(t.icon,n,f,_,v,b,!1,r,e,k.lineStartIndex,k.lineLength,-1,T,E,S,P),j=t.icon.placedSymbolArray.length-1,s&&(F=4*s.length,t.addSymbols(t.icon,s,f,_,v,b,ag.vertical,r,e,k.lineStartIndex,k.lineLength,-1,T,E,S,P),N=t.icon.placedSymbolArray.length-1)}for(const i in n.horizontal){const o=n.horizontal[i];A||(U=Li(o.text),f?O=ay(o):A=sy(c,$,e,u,h,d,o,p,l.layout.get("text-rotate").evaluate(b,{},E),m));const a=1===o.positionedLines.length;if(B+=ny(t,r,e,o,s,l,f,b,m,k,n.vertical?ag.horizontal:ag.horizontalOnly,a?Object.keys(n.horizontal):[i],V,j,x,T,E,S),a)break}n.vertical&&(z+=ny(t,r,e,n.vertical,s,l,f,b,m,k,ag.vertical,["vertical"],V,N,x,T,E,S));let W=-1;const Z=(t,e)=>t?Math.max(t,e):e;W=Z(O,W),W=Z(L,W),W=Z(D,W);const X=W>-1?1:0;t.glyphOffsetArray.length>=65535&&fr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,b.sortKey),t.symbolInstances.emplaceBack(e.x,e.y,$.x,$.y,$.z,V.right>=0?V.right:-1,V.center>=0?V.center:-1,V.left>=0?V.left:-1,V.vertical>=0?V.vertical:-1,j,N,U,void 0!==A?A:t.collisionBoxArray.length,void 0!==A?A+1:t.collisionBoxArray.length,void 0!==C?C:t.collisionBoxArray.length,void 0!==C?C+1:t.collisionBoxArray.length,void 0!==M?M:t.collisionBoxArray.length,void 0!==M?M+1:t.collisionBoxArray.length,I||t.collisionBoxArray.length,I?I+1:t.collisionBoxArray.length,u,B,z,R,F,X,0,H,q,W,0,G?1:0)}(t,a,g,s,r,i,n,R,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,E,k,l,0,S,A,y,e,o,c,u,h,p,f)};if("line"===M)for(const n of Cg(e.geometry,0,0,mo,mo)){const e=Ag(n,T,P,r.vertical||v,i,b,w,t.overscaling,mo);for(const r of e)v&&ly(t,v.text,C,r)||F(n,r,h)}else if("line-center"===M){for(const t of e.geometry)if(t.length>1){const e=kg(t,P,r.vertical||v,i,b,w);e&&F(t,e,h)}}else if("Polygon"===e.type)for(const t of Kd(e.geometry,0)){const e=Zg(t,16);F(t[0],new wg(e.x,e.y,0,0,void 0),h)}else if("LineString"===e.type)for(const t of e.geometry)F(t,new wg(t[0].x,t[0].y,0,0,void 0),h);else if("Point"===e.type)for(const t of e.geometry)for(const e of t)F([e],new wg(e.x,e.y,0,0,void 0),h)}const ry=255,iy=ry*Wm;function ny(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y){const v=function(t,e,r,i,n,o,s,a){const l=[];if(0===e.positionedLines.length)return l;const c=i.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=function(t){const e=t[0],r=t[1],i=e*r;return i>0?[e,-r]:i<0?[-e,r]:0===e?[r,e]:[r,-e]}(r);let h=Math.abs(e.top-e.bottom);for(const t of e.positionedLines)h-=t.lineOffset;const d=e.positionedLines.length,p=h/d;let f=e.top-r[1];for(let t=0;t<d;++t){const i=e.positionedLines[t];f=Wg(e,p,f,t);for(const t of i.positionedGlyphs){if(!t.rect)continue;const i=t.rect||{};let o=sg+1,h=!0,d=1,p=0;if(t.imageName){const e=s[t.imageName];if(!e)continue;if(e.sdf){fr("SDF images are not supported in formatted text and will be ignored.");continue}h=!1,d=e.pixelRatio,o=Og/d}const m=(n||a)&&t.vertical,g=t.metrics.advance*t.scale/2,y=t.metrics,v=t.rect;if(null===v)continue;a&&e.verticalizable&&(p=t.imageName?g-t.metrics.width*t.scale/2:0);const _=n?[t.x+g,t.y]:[0,0];let b=[0,0],x=[0,0],w=!1;n||(m?(x=[t.x+g+u[0],t.y+u[1]-p],w=!0):b=[t.x+g+r[0],t.y+r[1]-p]);const T=v.w*t.scale/(d*(t.localGlyph?zg:1)),E=v.h*t.scale/(d*(t.localGlyph?zg:1));let S,P,k,A;if(m){const e=t.y-f,r=new Ve(-g,g-e),i=-Math.PI/2,n=new Ve(...x);S=new Ve(-g+b[0],b[1]),S._rotateAround(i,r)._add(n),S.x+=-e+g,S.y-=(y.left-o)*t.scale;const s=t.imageName?y.advance*t.scale:qm*t.scale,a=String.fromCodePoint(t.glyph);tg(a)?S.x+=(1-o)*t.scale:eg(a)?S.x+=s-y.height*t.scale+(-o-1)*t.scale:S.x+=t.imageName||y.width+2*o===v.w&&y.height+2*o===v.h?(s-E)/2:(s-(y.height+2*o)*t.scale)/2,P=new Ve(S.x,S.y-T),k=new Ve(S.x+E,S.y),A=new Ve(S.x+E,S.y-T)}else{const e=(y.left-o)*t.scale-g+b[0],r=(-y.top-o)*t.scale+b[1],i=e+T,n=r+E;S=new Ve(e,r),P=new Ve(i,r),k=new Ve(e,n),A=new Ve(i,n)}if(c){let t;t=n?new Ve(0,0):w?new Ve(u[0],u[1]):new Ve(r[0],r[1]),S._rotateAround(c,t),P._rotateAround(c,t),k._rotateAround(c,t),A._rotateAround(c,t)}const M=new Ve(0,0),C=new Ve(0,0);l.push({tl:S,tr:P,bl:k,br:A,texPrimary:i,texSecondary:void 0,writingMode:e.writingMode,glyphOffset:_,sectionIndex:t.sectionIndex,isSDF:h,pixelOffsetTL:M,pixelOffsetBR:C,minFontScaleX:0,minFontScaleY:0})}}return l}(0,i,l,o,s,a,n,t.allowVerticalPlacement),_=t.textSizeData;let b=null;"source"===_.kind?(b=[Wm*o.layout.get("text-size").evaluate(a,{},g)],b[0]>iy&&fr(`${t.layerIds[0]}: Value for "text-size" is >= ${ry}. Reduce your "text-size".`)):"composite"===_.kind&&(b=[Wm*f.compositeTextSizes[0].evaluate(a,{},g),Wm*f.compositeTextSizes[1].evaluate(a,{},g)],(b[0]>iy||b[1]>iy)&&fr(`${t.layerIds[0]}: Value for "text-size" is >= ${ry}. Reduce your "text-size".`)),t.addSymbols(t.text,v,b,l,s,a,u,e,r,c.lineStartIndex,c.lineLength,p,m,g,y,!1);for(const e of h)d[e]=t.text.placedSymbolArray.length-1;return 4*v.length}function oy(t){for(const e in t)return t[e];return null}function sy(t,e,r,i,n,o,s,a,l,c){let u=s.top,h=s.bottom,d=s.left,p=s.right;const f=s.collisionPadding;if(f&&(d-=f[0],u-=f[1],p+=f[2],h+=f[3]),l){const t=new Ve(d,u),e=new Ve(p,u),r=new Ve(d,h),i=new Ve(p,h),n=He(l);let o=new Ve(0,0);c&&(o=new Ve(c[0],c[1])),t._rotateAround(n,o),e._rotateAround(n,o),r._rotateAround(n,o),i._rotateAround(n,o),d=Math.min(t.x,e.x,r.x,i.x),p=Math.max(t.x,e.x,r.x,i.x),u=Math.min(t.y,e.y,r.y,i.y),h=Math.max(t.y,e.y,r.y,i.y)}return t.emplaceBack(e.x,e.y,e.z,r.x,r.y,d,u,p,h,a,i,n,o),t.length-1}function ay(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function ly(t,e,r,i){const n=t.compareText;if(e in n){const t=n[e];for(let e=t.length-1;e>=0;e--)if(i.dist(t[e])<r)return!0}else n[e]=[];return n[e].push(i),!1}function cy(t,e){const r=t.fovAboveCenter,i=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,n=(t._camera.position[2]*t.worldSize-i)/Math.cos(t._pitch),o=Math.sin(r)*n/Math.sin(Math.max(Math.PI/2-t._pitch-r,.01)),s=Math.sin(t._pitch)*o+n;return Math.min(1.01*s,n*(1/t._horizonShift))}function uy(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const r=Math.pow(2,-t.z),i=t.x*r,n=(t.x+1)*r,o=t.y*r,s=(t.y+1)*r,a=Du(i),l=Du(n),c=Ru(o),u=Ru(s),h=e.project(a,c),d=e.project(l,c),p=e.project(l,u),f=e.project(a,u);let m=Math.min(h.x,d.x,p.x,f.x),g=Math.min(h.y,d.y,p.y,f.y),y=Math.max(h.x,d.x,p.x,f.x),v=Math.max(h.y,d.y,p.y,f.y);const _=r/16;function b(t,r,i,n,o,s){const a=(i+o)/2,l=(n+s)/2,c=e.project(Du(a),Ru(l)),u=Math.max(0,m-c.x,g-c.y,c.x-y,c.y-v);m=Math.min(m,c.x),y=Math.max(y,c.x),g=Math.min(g,c.y),v=Math.max(v,c.y),u>_&&(b(t,c,i,n,a,l),b(c,r,a,l,o,s))}b(h,d,i,o,n,o),b(d,p,n,o,n,s),b(p,f,n,s,i,s),b(f,h,i,s,i,o),m-=_,g-=_,y+=_,v+=_;const x=1/Math.max(y-m,v-g);return{scale:x,x:m*x,y:g*x,x2:y*x,y2:v*x,projection:e}}function hy(t,{x:e,y:r},i=0){return new Ve(((e-i)*t.scale-t.x)*mo,(r*t.scale-t.y)*mo)}const dy=t.ae.identity(new Float32Array(16));class py{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,e){return{x:0,y:0,z:0}}unproject(t,e){return new _u(0,0)}projectTilePoint(t,e,r){return{x:t,y:e,z:0}}locationPoint(t,e,r=!0){return t._coordinatePoint(t.locationCoordinate(e),r)}pixelsPerMeter(t,e){return Lu(1,t)*e}pixelSpaceConversion(t,e,r){return 1}farthestPixelDistance(t){return cy(t,t.pixelsPerMeter)}pointCoordinate(t,e,r,i){const n=t.horizonLineFromTop(!1),o=new Ve(e,Math.max(n,r));return t.rayIntersectionCoordinate(t.pointRayIntersection(o,i))}pointCoordinate3D(t,e,r){const i=new Ve(e,r);if(t.elevation)return t.elevation.pointCoordinate(i);{const e=this.pointCoordinate(t,i.x,i.y,0);return[e.x,e.y,e.z]}}isPointAboveHorizon(t,e){if(t.elevation&&t.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(t,e.x,e.y);const r=t.horizonLineFromTop();return e.y<r}createInversionMatrix(t,e){return dy}createTileMatrix(e,r,i){let n,o,s;const a=i.canonical,l=t.ae.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const c=uy(a,this);n=1,o=c.x+i.wrap*c.scale,s=c.y,t.ae.scale(l,l,[n/c.scale,n/c.scale,e.pixelsPerMeter/r])}else n=r/e.zoomScale(a.z),o=(a.x+Math.pow(2,a.z)*i.wrap)*n,s=a.y*n;return t.ae.translate(l,l,[o,s,0]),t.ae.scale(l,l,[n/mo,n/mo,1]),l}upVector(t,e,r){return[0,0,1]}upVectorScale(t,e,r){return{metersToTile:1}}}class fy extends py{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[e,r]=this.parallels=t.parallels||[29.5,45.5],i=Math.sin(He(e));this.n=(i+Math.sin(He(r)))/2,this.c=1+i*(2*this.n-i),this.r0=Math.sqrt(this.c)/this.n}project(t,e){const{n:r,c:i,r0:n}=this,o=He(t-this.center[0]),s=He(e),a=Math.sqrt(i-2*r*Math.sin(s))/r;return{x:a*Math.sin(o*r),y:a*Math.cos(o*r)-n,z:0}}unproject(t,e){const{n:r,c:i,r0:n}=this,o=n+e;let s=Math.atan2(t,Math.abs(o))*Math.sign(o);o*r<0&&(s-=Math.PI*Math.sign(t)*Math.sign(o));const a=He(this.center[0])*r;s=Qe(s,-Math.PI-a,Math.PI-a);const l=Ke(qe(s/r)+this.center[0],-180,180),c=Math.asin(Ke((i-(t*t+o*o)*r*r)/(2*r),-1,1)),u=Ke(qe(c),-Bu,Bu);return new _u(l,u)}}const my=1.340264,gy=-.081106,yy=893e-6,vy=.003796,_y=Math.sqrt(3)/2;class by extends py{project(t,e){e=e/180*Math.PI,t=t/180*Math.PI;const r=Math.asin(_y*Math.sin(e)),i=r*r,n=i*i*i;return{x:.5*(t*Math.cos(r)/(_y*(my+3*gy*i+n*(7*yy+9*vy*i)))/Math.PI+.5),y:1-.5*(r*(my+gy*i+n*(yy+vy*i))/Math.PI+1),z:0}}unproject(t,e){t=(2*t-.5)*Math.PI;let r=e=(2*(1-e)-1)*Math.PI,i=r*r,n=i*i*i;for(let t,o,s,a=0;a<12&&(o=r*(my+gy*i+n*(yy+vy*i))-e,s=my+3*gy*i+n*(7*yy+9*vy*i),t=o/s,r=Ke(r-t,-Math.PI/3,Math.PI/3),i=r*r,n=i*i*i,!(Math.abs(t)<1e-12));++a);const o=_y*t*(my+3*gy*i+n*(7*yy+9*vy*i))/Math.cos(r),s=Math.asin(Math.sin(r)/_y),a=Ke(180*o/Math.PI,-180,180),l=Ke(180*s/Math.PI,-Bu,Bu);return new _u(a,l)}}class xy extends py{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,e){return{x:.5+t/360,y:.5-e/360,z:0}}unproject(t,e){const r=360*(t-.5),i=Ke(360*(.5-e),-Bu,Bu);return new _u(r,i)}}const wy=Math.PI/2;function Ty(t){return Math.tan((wy+t)/2)}class Ey extends py{constructor(t){super(t),this.center=t.center||[0,30];const[e,r]=this.parallels=t.parallels||[30,30];let i=He(e),n=He(r);this.southernCenter=i+n<0,this.southernCenter&&(i=-i,n=-n);const o=Math.cos(i),s=Ty(i);this.n=i===n?Math.sin(i):Math.log(o/Math.cos(n))/Math.log(Ty(n)/s),this.f=o*Math.pow(Ty(i),this.n)/this.n}project(t,e){e=He(e),this.southernCenter&&(e=-e),t=He(t-this.center[0]);const r=1e-6,{n:i,f:n}=this;n>0?e<-wy+r&&(e=-wy+r):e>wy-r&&(e=wy-r);const o=n/Math.pow(Ty(e),i);let s=o*Math.sin(i*t),a=n-o*Math.cos(i*t);return s=.5*(s/Math.PI+.5),a=.5*(a/Math.PI+.5),{x:s,y:this.southernCenter?a:1-a,z:0}}unproject(t,e){t=(2*t-.5)*Math.PI,this.southernCenter&&(e=1-e),e=(2*(1-e)-.5)*Math.PI;const{n:r,f:i}=this,n=i-e,o=Math.sign(n),s=Math.sign(r)*Math.sqrt(t*t+n*n);let a=Math.atan2(t,Math.abs(n))*o;n*r<0&&(a-=Math.PI*Math.sign(t)*o);const l=Ke(qe(a/r)+this.center[0],-180,180),c=Ke(qe(2*Math.atan(Math.pow(i/s,1/r))-wy),-Bu,Bu);return new _u(l,this.southernCenter?-c:c)}}class Sy extends py{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,e){return{x:Iu(t),y:Ou(e),z:0}}unproject(t,e){const r=Du(t),i=Ru(e);return new _u(r,i)}}const Py=He(Bu);class ky extends py{project(t,e){const r=(e=He(e))*e,i=r*r;return{x:.5*((t=He(t))*(.8707-.131979*r+i*(i*(.003971*r-.001529*i)-.013791))/Math.PI+.5),y:1-.5*(e*(1.007226+r*(.015085+i*(.028874*r-.044475-.005916*i)))/Math.PI+1),z:0}}unproject(t,e){t=(2*t-.5)*Math.PI;let r=e=(2*(1-e)-1)*Math.PI,i=25,n=0,o=r*r;do{o=r*r;const t=o*o;n=(r*(1.007226+o*(.015085+t*(.028874*o-.044475-.005916*t)))-e)/(1.007226+o*(.045255+t*(.259866*o-.311325-.005916*11*t))),r=Ke(r-n,-Py,Py)}while(Math.abs(n)>1e-6&&--i>0);o=r*r;const s=Ke(qe(t/(.8707+o*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979))),-180,180),a=qe(r);return new _u(s,a)}}const Ay=He(Bu);class My extends py{project(t,e){e=He(e),t=He(t);const r=Math.cos(e),i=2/Math.PI,n=Math.acos(r*Math.cos(t/2)),o=Math.sin(n)/n,s=.5*(t*i+2*r*Math.sin(t/2)/o)||0,a=.5*(e+Math.sin(e)/o)||0;return{x:.5*(s/Math.PI+.5),y:1-.5*(a/Math.PI+1),z:0}}unproject(t,e){let r=t=(2*t-.5)*Math.PI,i=e=(2*(1-e)-1)*Math.PI,n=25;const o=1e-6;let s=0,a=0;do{const n=Math.cos(i),o=Math.sin(i),l=2*o*n,c=o*o,u=n*n,h=Math.cos(r/2),d=Math.sin(r/2),p=2*h*d,f=d*d,m=1-u*h*h,g=m?1/m:0,y=m?Math.acos(n*h)*Math.sqrt(1/m):0,v=.5*(2*y*n*d+2*r/Math.PI)-t,_=.5*(y*o+i)-e,b=.5*g*(u*f+y*n*h*c)+1/Math.PI,x=g*(p*l/4-y*o*d),w=.125*g*(l*d-y*o*u*p),T=.5*g*(c*h+y*f*n)+.5,E=x*w-T*b;s=(_*x-v*T)/E,a=(v*w-_*b)/E,r=Ke(r-s,-Math.PI,Math.PI),i=Ke(i-a,-Ay,Ay)}while((Math.abs(s)>o||Math.abs(a)>o)&&--n>0);return new _u(qe(r),qe(i))}}class Cy extends py{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(He(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,e){const{scale:r,cosPhi:i}=this;return{x:He(t)*i*r+.5,y:-Math.sin(He(e))/i*r+.5,z:0}}unproject(t,e){const{scale:r,cosPhi:i}=this,n=-(e-.5)/r,o=Ke(qe((t-.5)/r)/i,-180,180),s=Math.asin(Ke(n*i,-1,1)),a=Ke(qe(s),-Bu,Bu);return new _u(o,a)}}class Iy extends Sy{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,r,i){const n=Hh(e,r,i),o=Zh(zh(i));return t.$.transformMat4(n,n,o),{x:n[0],y:n[1],z:n[2]}}locationPoint(e,r){const i=gu(r.lat,r.lng),n=t.$.normalize([],i),o=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(r),e._centerAltitude):e._centerAltitude,s=Lu(1,0)*mo*o;t.$.scaleAndAdd(i,i,n,s);const a=t.ae.identity(new Float64Array(16));return t.ae.multiply(a,e.pixelMatrix,e.globeMatrix),t.$.transformMat4(i,i,a),new Ve(i[0],i[1])}pixelsPerMeter(t,e){return Lu(1,0)*e}pixelSpaceConversion(t,e,r){const i=Lu(1,t)*e,n=qi(Lu(1,45)*e,i,r);return this.pixelsPerMeter(t,e)/n}createTileMatrix(e,r,i){const n=Xh(zh(i.canonical));return t.ae.multiply(new Float64Array(16),e.globeMatrix,n)}createInversionMatrix(e,r){const{center:i}=e,n=Zh(zh(r));return t.ae.rotateY(n,n,He(i.lng)),t.ae.rotateX(n,n,He(i.lat)),t.ae.scale(n,n,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(n)}pointCoordinate(t,e,r,i){return Rh(t,e,r,!0)||new Uu(0,0)}pointCoordinate3D(t,e,r){const i=this.pointCoordinate(t,e,r,0);return[i.x,i.y,i.z]}isPointAboveHorizon(t,e){return!Rh(t,e.x,e.y,!1)}farthestPixelDistance(e){const r=function(e,r){const i=e.cameraToCenterDistance,n=e._centerAltitude*r,o=e._camera,s=e._camera.forward(),a=t.$.add([],t.$.scale([],s,-i),[0,0,n]),l=e.worldSize/(2*Math.PI),c=[0,0,-l],u=e.width/e.height,h=Math.tan(e.fovAboveCenter),d=t.$.scale([],o.up(),h),p=t.$.scale([],o.right(),h*u),f=t.$.normalize([],t.$.add([],t.$.add([],s,d),p)),m=[];let g;if(new xh(a,f).closestPointOnSphere(c,l,m)){const r=t.$.add([],m,c),i=t.$.sub([],r,a);g=Math.cos(e.fovAboveCenter)*t.$.length(i)}else{const e=t.$.sub([],a,c),r=t.$.sub([],c,a);t.$.normalize(r,r);const i=t.$.length(e)-l;g=Math.sqrt(i*(i+2*l));const n=Math.acos(g/(l+i))-Math.acos(t.$.dot(s,r));g*=Math.cos(n)}return 1.01*g}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),i=Qh(e.zoom);if(i>0){const t=cy(e,Lu(1,e.center.lat)*e.worldSize),n=e.worldSize/(2*Math.PI),o=Math.max(e.width,e.height)/e.worldSize*Math.PI;return qi(r,t+n*(1-Math.cos(o)),Math.pow(i,10))}return r}upVector(t,e,r){return Hh(e,r,t,1)}upVectorScale(t){return{metersToTile:Lh(qh(zh(t)))}}}function Oy(t){const e=t.parallels,r=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new Sy(t);case"equirectangular":return new xy(t);case"naturalEarth":return new ky(t);case"equalEarth":return new by(t);case"winkelTripel":return new My(t);case"albers":return r?new Cy(t):new fy(t);case"lambertConformalConic":return r?new Cy(t):new Ey(t);case"globe":return new Iy(t)}throw new Error(`Invalid projection name: ${t.name}`)}const Ly=Mp.types,Dy=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ry(t,e,r,i,n,o,s,a,l,c,u,h,d){const p=a?Math.min(iy,Math.round(a[0])):0,f=a?Math.min(iy,Math.round(a[1])):0;t.emplaceBack(e,r,Math.round(32*i),Math.round(32*n),o,s,(p<<1)+(l?1:0),f,16*c,16*u,256*h,256*d)}function Fy(t,e,r){t.emplaceBack(e,r)}function By(t,e,r,i,n,o,s){t.emplaceBack(e,r,i,n,o,s)}function zy(t,e,r,i,n){t.emplaceBack(e,r,i,n),t.emplaceBack(e,r,i,n),t.emplaceBack(e,r,i,n),t.emplaceBack(e,r,i,n)}function jy(t){for(const e of t.sections)if(za(e.text))return!0;return!1}class Ny{constructor(t){this.layoutVertexArray=new ql,this.indexArray=new tc,this.programConfigurations=t,this.segments=new Ac,this.dynamicLayoutVertexArray=new Vl,this.opacityVertexArray=new Zl,this.placedSymbolArray=new gc,this.iconTransitioningVertexArray=new Xl,this.globeExtVertexArray=new Wl,this.zOffsetVertexArray=new ic}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length&&0===this.iconTransitioningVertexArray.length}upload(t,e,r,i,n){this.isEmpty()||(r&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Zf.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Yf.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Dy,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,Jf.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,Xf.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||n)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,Kf.members,!0)),this.opacityVertexBuffer.itemSize=1),(r||i)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Sa(Ny,"SymbolBuffers");class Vy{constructor(t,e,r){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new r,this.segments=new Ac,this.collisionVertexArray=new Ql,this.collisionVertexArrayExt=new Vl}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Qf.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,tm.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Sa(Vy,"CollisionBuffers");class Uy{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.lut=e.lut,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((t=>t.fqid)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=t.ae.identity([]),this.placementViewportMatrix=t.ae.identity([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Zm(this.zoom,r["text-size"]),this.iconSizeData=Zm(this.zoom,r["icon-size"]);const i=this.layers[0].layout,n=i.get("symbol-sort-key"),o=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==o&&void 0!==n.constantOr(1),this.sortFeaturesByY=("viewport-y"===o||"auto"===o&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=i.get("text-writing-mode").map((t=>ag[t])),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.sourceID=e.sourceID,this.projection=e.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=i.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new Ny(new eu(this.layers,{zoom:this.zoom,lut:this.lut},(t=>/^text/.test(t)))),this.icon=new Ny(new eu(this.layers,{zoom:this.zoom,lut:this.lut},(t=>/^icon/.test(t)))),this.glyphOffsetArray=new _c,this.lineVertexArray=new bc,this.symbolInstances=new vc}calculateGlyphDependencies(t,e,r,i,n){for(let r=0;r<t.length;r++){const o=t.codePointAt(r);if(void 0===o)break;if(e[o]=!0,i&&n&&o<=65535){const i=Qm[t.charAt(r)];i&&(e[i.charCodeAt(0)]=!0)}}}updateFootprints(t,e){}updateReplacement(t,e){if(e.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=e.updateTime;const r=e.getReplacementRegionsForTile(t.toUnwrapped(),!0);return!Np(this.activeReplacements,r)&&(this.activeReplacements=r,!0)}populate(e,r,i,n){const o=this.layers[0],s=o.layout,a="globe"===this.projection.name,l=s.get("text-font"),c=s.get("text-field"),u=s.get("icon-image"),h=("constant"!==c.value.kind||c.value.value instanceof yn&&!c.value.value.isEmpty()||c.value.value.toString().length>0)&&("constant"!==l.value.kind||l.value.value.length>0),d="constant"!==u.value.kind||!!u.value.value||Object.keys(u.parameters).length>0,p=s.get("symbol-sort-key");if(this.features=[],!h&&!d)return;const f=r.iconDependencies,m=r.glyphDependencies,g=r.availableImages,y=new Ka(this.zoom);for(const{feature:r,id:c,index:u,sourceLayerIndex:v}of e){const e=o._featureFilter.needGeometry,_=Ku(r,e);if(!o._featureFilter.filter(y,_,i))continue;if(e||(_.geometry=Yu(r,i,n)),a&&1!==r.type&&i.z<=5){const e=_.geometry,r=.98078528056,n=(e,n)=>{const o=Hh(e.x,e.y,i,1),s=Hh(n.x,n.y,i,1);return t.$.dot(o,s)<r};for(let t=0;t<e.length;t++)e[t]=qu(e[t],n)}let b,x;if(h){const t=o.getValueAndResolveTokens("text-field",_,i,g),e=yn.factory(t);jy(e)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Za()||this.hasRTLText&&Ya.isParsed())&&(b=Jm(e,o,_))}if(d){const t=o.getValueAndResolveTokens("icon-image",_,i,g);x=t instanceof vn?t:vn.fromString(t)}if(!b&&!x)continue;const w=this.sortFeaturesByKey?p.evaluate(_,{},i):void 0;if(this.features.push({id:c,text:b,icon:x,index:u,sourceLayerIndex:v,geometry:_.geometry,properties:r.properties,type:Ly[r.type],sortKey:w}),x&&(f[x.namePrimary]=!0,x.nameSecondary&&(f[x.nameSecondary]=!0)),b){const t=l.evaluate(_,{},i).join(","),e="map"===s.get("text-rotation-alignment")&&"point"!==s.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ag.vertical)>=0;for(const r of b.sections)if(r.image)f[r.image.namePrimary]=!0;else{const i=Ia(b.toString()),n=r.fontStack||t,o=m[n]=m[n]||{};this.calculateGlyphDependencies(r.text,o,e,this.allowVerticalPlacement,i)}}}"line"===s.get("symbol-placement")&&(this.features=function(t){const e={},r={},i=[];let n=0;function o(e){i.push(t[e]),n++}function s(t,e,n){const o=r[t];return delete r[t],r[e]=o,i[o].geometry[0].pop(),i[o].geometry[0]=i[o].geometry[0].concat(n[0]),o}function a(t,r,n){const o=e[r];return delete e[r],e[t]=o,i[o].geometry[0].shift(),i[o].geometry[0]=n[0].concat(i[o].geometry[0]),o}function l(t,e,r){const i=r?e[0][e[0].length-1]:e[0][0];return`${t}:${i.x}:${i.y}`}for(let c=0;c<t.length;c++){const u=t[c],h=u.geometry,d=u.text?u.text.toString():null;if(!d){o(c);continue}const p=l(d,h),f=l(d,h,!0);if(p in r&&f in e&&r[p]!==e[f]){const t=a(p,f,h),n=s(p,f,i[t].geometry);delete e[p],delete r[f],r[l(d,i[n].geometry,!0)]=n,i[t].geometry=null}else p in r?s(p,f,h):f in e?a(p,f,h):(o(c),e[p]=n-1,r[f]=n-1)}return i.filter((t=>t.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((t,e)=>t.sortKey-e.sortKey))}update(t,e,r,i,n){const o=0!==Object.keys(t).length;if(o&&!this.stateDependentLayers.length)return;const s=o?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(t,e,s,r,i,n),this.icon.programConfigurations.updatePaintArrays(t,e,s,r,i,n)}updateZOffset(){const t=(t,e,i)=>{r+=e,r>t.length&&t.resize(r);for(let n=-e;n<0;n++)t.emplace(n+r,i)},e=(t,e,r)=>{i+=e,i>t.length&&t.resize(i);for(let n=-e;n<0;n++)t.emplace(n+i,r)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let r=0,i=0;for(let r=0;r<this.symbolInstances.length;r++){const i=this.symbolInstances.get(r),{numHorizontalGlyphVertices:n,numVerticalGlyphVertices:o,numIconVertices:s}=i,a=i.zOffset,l=s>0;if((n>0||o>0)&&(t(this.text.zOffsetVertexArray,n,a),t(this.text.zOffsetVertexArray,o,a)),l){const{placedIconSymbolIndex:t,verticalPlacedIconSymbolIndex:r}=i;t>=0&&e(this.icon.zOffsetVertexArray,s,a),r>=0&&e(this.icon.zOffsetVertexArray,i.numVerticalIconVertices,a)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Oy(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,e){const r=this.lineVertexArray.length;if(void 0!==t.segment)for(const{x:t,y:r}of e)this.lineVertexArray.emplaceBack(t,r);return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}addSymbols(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m){const g=t.indexArray,y=t.layoutVertexArray,v=t.globeExtVertexArray,_=t.segments.prepareSegment(4*e.length,y,g,this.canOverlap?o.sortKey:void 0),b=this.glyphOffsetArray.length,x=_.vertexLength,w=this.allowVerticalPlacement&&s===ag.vertical?Math.PI/2:0,T=o.text&&o.text.sections;for(let i=0;i<e.length;i++){const{tl:n,tr:s,bl:c,br:u,texPrimary:h,texSecondary:b,pixelOffsetTL:x,pixelOffsetBR:E,minFontScaleX:S,minFontScaleY:P,glyphOffset:k,isSDF:A,sectionIndex:M}=e[i],C=_.vertexLength,I=k[1];if(Ry(y,l.x,l.y,n.x,I+n.y,h.x,h.y,r,A,x.x,x.y,S,P),Ry(y,l.x,l.y,s.x,I+s.y,h.x+h.w,h.y,r,A,E.x,x.y,S,P),Ry(y,l.x,l.y,c.x,I+c.y,h.x,h.y+h.h,r,A,x.x,E.y,S,P),Ry(y,l.x,l.y,u.x,I+u.y,h.x+h.w,h.y+h.h,r,A,E.x,E.y,S,P),a){const{x:e,y:r,z:i}=a.anchor,[n,o,s]=a.up;By(v,e,r,i,n,o,s),By(v,e,r,i,n,o,s),By(v,e,r,i,n,o,s),By(v,e,r,i,n,o,s),zy(t.dynamicLayoutVertexArray,e,r,i,w)}else zy(t.dynamicLayoutVertexArray,l.x,l.y,l.z,w);if(m){const e=b||h;Fy(t.iconTransitioningVertexArray,e.x,e.y),Fy(t.iconTransitioningVertexArray,e.x+e.w,e.y),Fy(t.iconTransitioningVertexArray,e.x,e.y+e.h),Fy(t.iconTransitioningVertexArray,e.x+e.w,e.y+e.h)}g.emplaceBack(C,C+1,C+2),g.emplaceBack(C+1,C+2,C+3),_.vertexLength+=4,_.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(k[0]),i!==e.length-1&&M===e[i+1].sectionIndex||t.programConfigurations.populatePaintArrays(y.length,o,o.index,{},d,p,f,T&&T[M])}const E=a?a.anchor:l;t.placedSymbolArray.emplaceBack(E.x,E.y,E.z,l.x,l.y,b,this.glyphOffsetArray.length-b,x,c,u,l.segment,r?r[0]:0,r?r[1]:0,i[0],i[1],s,0,!1,0,h,0)}_commitLayoutVertex(t,e,r,i,n,o,s){t.emplaceBack(e,r,i,n,o,Math.round(s.x),Math.round(s.y))}_addCollisionDebugVertices(t,e,r,i,n,o,s){const a=r.segments.prepareSegment(4,r.layoutVertexArray,r.indexArray),l=a.vertexLength,c=s.tileAnchorX,u=s.tileAnchorY;for(let t=0;t<4;t++)r.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(r.collisionVertexArrayExt,e,t.padding,s.zOffset),this._commitLayoutVertex(r.layoutVertexArray,i,n,o,c,u,new Ve(t.x1,t.y1)),this._commitLayoutVertex(r.layoutVertexArray,i,n,o,c,u,new Ve(t.x2,t.y1)),this._commitLayoutVertex(r.layoutVertexArray,i,n,o,c,u,new Ve(t.x2,t.y2)),this._commitLayoutVertex(r.layoutVertexArray,i,n,o,c,u,new Ve(t.x1,t.y2)),a.vertexLength+=4;const h=r.indexArray;h.emplaceBack(l,l+1),h.emplaceBack(l+1,l+2),h.emplaceBack(l+2,l+3),h.emplaceBack(l+3,l),a.primitiveLength+=4}_addTextDebugCollisionBoxes(t,e,r,i,n,o){for(let s=i;s<n;s++){const i=r.get(s),n=this.getSymbolInstanceTextSize(t,o,e,s);this._addCollisionDebugVertices(i,n,this.textCollisionBox,i.projectedAnchorX,i.projectedAnchorY,i.projectedAnchorZ,o)}}_addIconDebugCollisionBoxes(t,e,r,i,n,o){for(let s=i;s<n;s++){const i=r.get(s),n=this.getSymbolInstanceIconSize(t,e,o.placedIconSymbolIndex);this._addCollisionDebugVertices(i,n,this.iconCollisionBox,i.projectedAnchorX,i.projectedAnchorY,i.projectedAnchorZ,o)}}generateCollisionDebugBuffers(t,e){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Vy(Kl,em.members,Xl),this.iconCollisionBox=new Vy(Kl,em.members,Xl);const r=Ym(this.iconSizeData,t),i=Ym(this.textSizeData,t);for(let n=0;n<this.symbolInstances.length;n++){const o=this.symbolInstances.get(n);this._addTextDebugCollisionBoxes(i,t,e,o.textBoxStartIndex,o.textBoxEndIndex,o),this._addTextDebugCollisionBoxes(i,t,e,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o),this._addIconDebugCollisionBoxes(r,t,e,o.iconBoxStartIndex,o.iconBoxEndIndex,o),this._addIconDebugCollisionBoxes(r,t,e,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o)}}getSymbolInstanceTextSize(t,e,r,i){const n=this.text.placedSymbolArray.get(e.rightJustifiedTextSymbolIndex>=0?e.rightJustifiedTextSymbolIndex:e.centerJustifiedTextSymbolIndex>=0?e.centerJustifiedTextSymbolIndex:e.leftJustifiedTextSymbolIndex>=0?e.leftJustifiedTextSymbolIndex:e.verticalPlacedTextSymbolIndex>=0?e.verticalPlacedTextSymbolIndex:i),o=Xm(this.textSizeData,t,n)/qm;return this.tilePixelRatio*o}getSymbolInstanceIconSize(t,e,r){const i=this.icon.placedSymbolArray.get(r),n=Xm(this.iconSizeData,t,i);return this.tilePixelRatio*n}_commitDebugCollisionVertexUpdate(t,e,r,i){t.emplaceBack(e,-r,-r,i),t.emplaceBack(e,r,-r,i),t.emplaceBack(e,r,r,i),t.emplaceBack(e,-r,r,i)}_updateTextDebugCollisionBoxes(t,e,r,i,n,o){for(let s=i;s<n;s++){const i=r.get(s),n=this.getSymbolInstanceTextSize(t,o,e,s);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,n,i.padding,o.zOffset)}}_updateIconDebugCollisionBoxes(t,e,r,i,n,o){for(let s=i;s<n;s++){const i=r.get(s),n=this.getSymbolInstanceIconSize(t,e,o.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,n,i.padding,o.zOffset)}}updateCollisionDebugBuffers(t,e){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const r=Ym(this.iconSizeData,t),i=Ym(this.textSizeData,t);for(let n=0;n<this.symbolInstances.length;n++){const o=this.symbolInstances.get(n);this._updateTextDebugCollisionBoxes(i,t,e,o.textBoxStartIndex,o.textBoxEndIndex,o),this._updateTextDebugCollisionBoxes(i,t,e,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o),this._updateIconDebugCollisionBoxes(r,t,e,o.iconBoxStartIndex,o.iconBoxEndIndex,o),this._updateIconDebugCollisionBoxes(r,t,e,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,e,r,i,n,o,s,a,l){const c={};if(e<r){const{x1:r,y1:i,x2:n,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=t.get(e);c.textBox={x1:r,y1:i,x2:n,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.textFeatureIndex=p}if(i<n){const{x1:e,y1:r,x2:n,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=t.get(i);c.verticalTextBox={x1:e,y1:r,x2:n,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.verticalTextFeatureIndex=p}if(o<s){const{x1:e,y1:r,x2:i,y2:n,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=t.get(o);c.iconBox={x1:e,y1:r,x2:i,y2:n,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.iconFeatureIndex=p}if(a<l){const{x1:e,y1:r,x2:i,y2:n,padding:o,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=t.get(a);c.verticalIconBox={x1:e,y1:r,x2:i,y2:n,padding:o,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.verticalIconFeatureIndex=p}return c}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let e=0;e<this.symbolInstances.length;e++){const r=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,e){const r=t.placedSymbolArray.get(e),i=r.vertexStartIndex+4*r.numGlyphs;for(let e=r.vertexStartIndex;e<i;e+=4)t.indexArray.emplaceBack(e,e+1,e+2),t.indexArray.emplaceBack(e+1,e+2,e+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const e=Math.sin(t),r=Math.cos(t),i=[],n=[],o=[];for(let t=0;t<this.symbolInstances.length;++t){o.push(t);const s=this.symbolInstances.get(t);i.push(0|Math.round(e*s.tileAnchorX+r*s.tileAnchorY)),n.push(s.featureIndex)}return o.sort(((t,e)=>i[t]-i[e]||n[e]-n[t])),o}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort(((t,e)=>this.symbolInstances.get(e).zOffset-this.symbolInstances.get(t).zOffset))}addToSortKeyRanges(t,e){const r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===e?r.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const t of this.symbolInstanceIndexes){const e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex);const{rightJustifiedTextSymbolIndex:r,centerJustifiedTextSymbolIndex:i,leftJustifiedTextSymbolIndex:n,verticalPlacedTextSymbolIndex:o,placedIconSymbolIndex:s,verticalPlacedIconSymbolIndex:a}=e;r>=0&&this.addIndicesForPlacedSymbol(this.text,r),i>=0&&i!==r&&this.addIndicesForPlacedSymbol(this.text,i),n>=0&&n!==i&&n!==r&&this.addIndicesForPlacedSymbol(this.text,n),o>=0&&this.addIndicesForPlacedSymbol(this.text,o),s>=0&&this.addIndicesForPlacedSymbol(this.icon,s),a>=0&&this.addIndicesForPlacedSymbol(this.icon,a)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Sa(Uy,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Uy.addDynamicAttributes=zy;class $y{constructor(t,e,r,i){this.context=t,this.format=r,this.texture=t.gl.createTexture(),this.update(e,i)}update(t,e,r){const{width:i,height:n}=t,{context:o}=this,{gl:s}=o;if(s.bindTexture(s.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!e||!1!==e.premultiply)),this.useMipmap=Boolean(e&&e.useMipmap),r||this.size&&this.size[0]===i&&this.size[1]===n){const{x:e,y:o}=r||{x:0,y:0};if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||ImageBitmap&&t instanceof ImageBitmap)s.texSubImage2D(s.TEXTURE_2D,0,e,o,s.RGBA,s.UNSIGNED_BYTE,t);else{let r=this.format,a=s.UNSIGNED_BYTE;this.format===s.R32F&&(r=s.RED,a=s.FLOAT),s.texSubImage2D(s.TEXTURE_2D,0,e,o,i,n,r,a,t.data)}}else if(this.size=[i,n],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||ImageBitmap&&t instanceof ImageBitmap){let e=this.format;this.format===s.R8&&(e=s.RED),s.texImage2D(s.TEXTURE_2D,0,this.format,e,s.UNSIGNED_BYTE,t)}else{let e=this.format,r=this.format,o=s.UNSIGNED_BYTE,a=!1;this.format===s.DEPTH_COMPONENT&&(e=s.DEPTH_COMPONENT16,o=s.UNSIGNED_SHORT),this.format===s.DEPTH_STENCIL&&(e=s.DEPTH24_STENCIL8,o=s.UNSIGNED_INT_24_8,a=!0),this.format===s.R8&&(r=s.RED),this.format===s.R32F&&(o=s.FLOAT,r=s.RED),!this.useMipmap&&a?s.texStorage2D(s.TEXTURE_2D,1,e,i,n):s.texImage2D(s.TEXTURE_2D,0,e,i,n,0,r,o,t.data)}this.useMipmap&&s.generateMipmap(s.TEXTURE_2D)}bind(t,e,r=!1){const{context:i}=this,{gl:n}=i;n.bindTexture(n.TEXTURE_2D,this.texture),t!==this.minFilter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,this.useMipmap&&!r?t===n.NEAREST?n.NEAREST_MIPMAP_NEAREST:n.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),e!==this.wrapS&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,e),this.wrapS=e)}bindExtraParam(t,e,r,i){const{context:n}=this,{gl:o}=n;o.bindTexture(o.TEXTURE_2D,this.texture),e!==this.magFilter&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,e),this.magFilter=e),t!==this.minFilter&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,this.useMipmap?t===o.NEAREST?o.NEAREST_MIPMAP_NEAREST:o.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),r!==this.wrapS&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,r),this.wrapS=r),i!==this.wrapT&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,i),this.wrapT=i)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class Gy{constructor(t,e){this.context=t,this.texture=e}bind(t,e){const{context:r}=this,{gl:i}=r;i.bindTexture(i.TEXTURE_2D,this.texture),t!==this.minFilter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t),this.minFilter=t),e!==this.wrapS&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e),this.wrapS=e)}}const Hy=32,qy=33,Wy=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,r=0,i=0,n=0,o=0,s=0,a=0;for(1&e?n=o=s=Hy:r=i=a=Hy;(e>>=1)>1;){const t=r+n>>1,l=i+o>>1;1&e?(n=r,o=i,r=s,i=a):(r=n,i=o,n=s,o=a),s=t,a=l}const l=4*t;Wy[l+0]=r,Wy[l+1]=i,Wy[l+2]=n,Wy[l+3]=o}const Zy=new Uint16Array(2178),Xy=new Uint8Array(1089),Yy=new Uint16Array(1089);function Ky(t){return 0===t?-.03125:32===t?.03125:0}var Jy=Dl([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Qy{constructor(t,e,r,i){this.id=Qy.uniqueIdxCounter,Qy.uniqueIdxCounter++,this.context=t;const n=t.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(r),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||i||e.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){this.id=Qy.uniqueIdxCounter,Qy.uniqueIdxCounter++;const e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Qy.uniqueIdxCounter=0;class tv{constructor(t,e,r){this.func=t,this.mask=e,this.range=r}}tv.ReadOnly=!1,tv.ReadWrite=!0,tv.disabled=new tv(519,tv.ReadOnly,[0,1]);const ev=7680;class rv{constructor(t,e,r,i,n,o){this.test=t,this.ref=e,this.mask=r,this.fail=i,this.depthFail=n,this.pass=o}}rv.disabled=new rv({func:519,mask:0},0,0,ev,ev,ev);const iv=771;class nv{constructor(t,e,r,i){this.blendFunction=t,this.blendColor=e,this.mask=r,this.blendEquation=i}}nv.Replace=[1,0,1,0],nv.disabled=new nv(nv.Replace,Gi.transparent,[!1,!1,!1,!1]),nv.unblended=new nv(nv.Replace,Gi.transparent,[!0,!0,!0,!0]),nv.alphaBlended=new nv([1,iv,1,iv],Gi.transparent,[!0,!0,!0,!0]),nv.alphaBlendedNonPremultiplied=new nv([770,iv,770,iv],Gi.transparent,[!0,!0,!0,!0]),nv.multiply=new nv([774,0,774,0],Gi.transparent,[!0,!0,!0,!0]);const ov=1029,sv=2305;class av{constructor(t,e,r){this.enable=t,this.mode=e,this.frontFace=r}}av.disabled=new av(!1,ov,sv),av.backCCW=new av(!0,ov,sv),av.backCW=new av(!0,ov,2304),av.frontCW=new av(!0,1028,2304),av.frontCCW=new av(!0,1028,sv);var lv=Dl([{name:"a_index",type:"Int16",components:1}]);const cv={type:2,extent:mo,loadGeometry:()=>[[new Ve(0,0),new Ve(mo+1,0),new Ve(mo+1,mo+1),new Ve(0,mo+1),new Ve(0,0)]]};class uv{constructor(t,e,r,i,n){this.tileID=t,this.uid=nr(),this.uses=0,this.tileSize=e,this.tileZoom=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=n,i&&i.style&&(this._lastUpdatedBrightness=i.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",i&&i.transform&&(this.projection=i.transform.projection)}registerFadeDuration(t){const e=t+this.timeAdded;e<Dr.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=uy(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,e,r){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){const r={};if(!e)return r;for(const i of t){const t=i.layerIds.map((t=>e.getLayer(t))).filter(Boolean);if(0!==t.length){i.layers=t,i.stateDependentLayerIds&&(i.stateDependentLayers=i.stateDependentLayerIds.map((e=>t.filter((t=>t.id===e))[0])));for(const e of t)r[e.fqid]=i}}return r}(t.buckets,e.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const e=this.buckets[t];if(e instanceof Uy){if(this.hasSymbolBuckets=!0,!r)break;e.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const e=this.buckets[t];if(e instanceof Uy&&e.hasRTLText){this.hasRTLText=!0,Ya.isLoading()||Ya.isLoaded()||"deferred"!==Za()||Xa();break}}this.queryPadding=0;for(const t in this.buckets){const r=this.buckets[t],i=e.style.getOwnLayer(t);if(!i)continue;const n=i.queryRadius(r);this.queryPadding=Math.max(this.queryPadding,n)}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas),this._lastUpdatedBrightness=t.brightness}else this.collisionBoxArray=new fc}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.fqid]}upload(t){for(const e in this.buckets){const r=this.buckets[e];r.uploadPending()&&r.upload(t)}const e=t.gl,r=this.imageAtlas;if(r&&!r.uploaded){const i=!!Object.keys(r.patternPositions).length;this.imageAtlasTexture=new $y(t,r.image,e.RGBA,{useMipmap:i}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new $y(t,this.glyphAtlasImage,e.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new $y(t,this.lineAtlas.image,e.R8),this.lineAtlas.uploaded=!0)}prepare(t,e,r){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture,r),!e||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const i=e.style.getBrightness();(this._lastUpdatedBrightness||i)&&(this._lastUpdatedBrightness&&i&&Math.abs(this._lastUpdatedBrightness-i)<.001||(this._lastUpdatedBrightness=i,this.updateBuckets(void 0,e)))}queryRenderedFeatures(t,e,r,i,n,o,s,a){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:i,pixelPosMatrix:s,transform:o,params:n,tileTransform:this.tileTransform},t,e,r):{}}querySourceFeatures(t,e){const r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;const i=r.loadVTLayers(),n=e?e.sourceLayer:"",o=i._geojsonTileLayer||i[n];if(!o)return;const s=fl(e&&e.filter),{z:a,x:l,y:c}=this.tileID.canonical,u={z:a,x:l,y:c};for(let e=0;e<o.length;e++){const i=o.feature(e);if(s.needGeometry){const t=Ku(i,!0);if(!s.filter(new Ka(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!s.filter(new Ka(this.tileID.overscaledZ),i))continue;const h=r.getId(i,n),d=new Vm(i,a,l,c,h);d.tile=u,t.push(d)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const e=this.expirationTime;if(t.cacheControl){const e=_r(t.cacheControl);e["max-age"]&&(this.expirationTime=Date.now()+1e3*e["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const t=Date.now();let r=!1;if(this.expirationTime>t)r=!1;else if(e)if(this.expirationTime<e)r=!0;else{const i=this.expirationTime-e;i?this.expirationTime=t+Math.max(i,3e4):r=!0}else r=!0;r?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,e){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length&&e&&this.updateBuckets(t,e)}updateBuckets(t,e){if(!this.latestFeatureIndex)return;const r=this.latestFeatureIndex.loadVTLayers(),i=e.style.listImages(),n=e.style.getBrightness();for(const o in this.buckets){if(!e.style.hasLayer(o))continue;const s=this.buckets[o],a=s.layers[0].sourceLayer||"_geojsonTileLayer",l=r[a];let c={};if(t&&(c=t[a],!l||!c||0===Object.keys(c).length))continue;if(s.update(c,l,i,this.imageAtlas&&this.imageAtlas.patternPositions||{},n),s instanceof am||s instanceof ep){const t=e.style.getOwnSourceCache(s.layers[0].source);e._terrain&&e._terrain.enabled&&t&&s.programConfigurations.needsUpload&&e._terrain._clearRenderCacheForTile(t.id,this.tileID)}const u=e&&e.style&&e.style.getOwnLayer(o);u&&(this.queryPadding=Math.max(this.queryPadding,u.queryRadius(s)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Dr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Dr.now()+t}setTexture(t,e){const r=e.context,i=r.gl;this.texture=this.texture||e.getTileTexture(t.width),this.texture&&this.texture instanceof $y?this.texture.update(t,{useMipmap:!0}):(this.texture=new $y(r,t,i.RGBA,{useMipmap:!0}),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE))}setDependencies(t,e){const r={};for(const t of e)r[t]=!0;this.dependencies[t]=r}hasDependency(t,e){for(const r of t){const t=this.dependencies[r];if(t)for(const r of e)if(t[r])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,e){if(!e||"mercator"===e.name||this._tileDebugBuffer)return;const r=Yu(cv,this.tileID.canonical,this.tileTransform)[0],i=new Fl,n=new ac;for(let t=0;t<r.length;t++){const{x:e,y:o}=r[t];i.emplaceBack(e,o),n.emplaceBack(t)}n.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(n),this._tileDebugBuffer=t.createVertexBuffer(i,Oh.members),this._tileDebugSegments=Ac.simpleSegment(0,0,i.length,n.length)}_makeTileBoundsBuffers(t,e){if(this._tileBoundsBuffer||!e||"mercator"===e.name)return;const r=Yu(cv,this.tileID.canonical,this.tileTransform)[0];let i,n;if(this.isRaster){const t=function(t,e){const r=uy(t,e),i=Math.pow(2,t.z);for(let n=0;n<qy;n++)for(let o=0;o<qy;o++){const s=Du((t.x+(o+Ky(o))/Hy)/i),a=Ru((t.y+(n+Ky(n))/Hy)/i),l=e.project(s,a),c=n*qy+o;Zy[2*c+0]=Math.round((l.x*r.scale-r.x)*mo),Zy[2*c+1]=Math.round((l.y*r.scale-r.y)*mo)}Xy.fill(0),Yy.fill(0);for(let t=2045;t>=0;t--){const e=4*t,r=Wy[e+0],i=Wy[e+1],n=Wy[e+2],o=Wy[e+3],s=r+n>>1,a=i+o>>1,l=s+a-i,c=a+r-s,u=i*qy+r,h=o*qy+n,d=a*qy+s,p=Math.hypot((Zy[2*u+0]+Zy[2*h+0])/2-Zy[2*d+0],(Zy[2*u+1]+Zy[2*h+1])/2-Zy[2*d+1])>=16;Xy[d]=Xy[d]||(p?1:0),t<1022&&(Xy[d]=Xy[d]||Xy[(i+c>>1)*qy+(r+l>>1)]||Xy[(o+c>>1)*qy+(n+l>>1)])}const n=new zl,o=new tc;let s=0;function a(t,e){const r=e*qy+t;return 0===Yy[r]&&(n.emplaceBack(Zy[2*r+0],Zy[2*r+1],t*mo/Hy,e*mo/Hy),Yy[r]=++s),Yy[r]-1}function l(t,e,r,i,n,s){const c=t+r>>1,u=e+i>>1;if(Math.abs(t-n)+Math.abs(e-s)>1&&Xy[u*qy+c])l(n,s,t,e,c,u),l(r,i,n,s,c,u);else{const l=a(t,e),c=a(r,i),u=a(n,s);o.emplaceBack(l,c,u)}}return l(0,0,Hy,Hy,Hy,0),l(Hy,Hy,0,0,0,Hy),{vertices:n,indices:o}}(this.tileID.canonical,e);i=t.vertices,n=t.indices}else{i=new zl,n=new tc;for(const{x:t,y:e}of r)i.emplaceBack(t,e,0,0);const t=Pd(i.int16,void 0,4);for(let e=0;e<t.length;e+=3)n.emplaceBack(t[e],t[e+1],t[e+2])}this._tileBoundsBuffer=t.createVertexBuffer(i,Jy.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(n),this._tileBoundsSegments=Ac.simpleSegment(0,0,i.length,n.length)}_makeGlobeTileDebugBuffers(e,r){const i=r.projection;if(!i||"globe"!==i.name||r.freezeTileCoverage)return;const n=this.tileID.canonical,o=Zh(Nh(n,r)),s=Qh(r.zoom);let a;s>0&&(a=t.ae.invert(new Float64Array(16),r.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,n,r,o,a,s),this._makeGlobeTileDebugTextBuffer(e,n,r,o,a,s)}_globePoint(e,r,i,n,o,s,a){let l=Hh(e,r,i);if(s){const o=1<<i.z,c=Iu(n.center.lng),u=Ou(n.center.lat),h=(i.x+.5)/o-c;let d=0;h>.5?d=-1:h<-.5&&(d=1);let p=(e/mo+i.x)/o+d,f=(r/mo+i.y)/o;p=(p-c)*n._pixelsPerMercatorPixel+c,f=(f-u)*n._pixelsPerMercatorPixel+u;const m=[p*n.worldSize,f*n.worldSize,0];t.$.transformMat4(m,m,s),l=jh(l,m,a)}return t.$.transformMat4(l,l,o)}_makeGlobeTileDebugBorderBuffer(t,e,r,i,n,o){const s=new Fl,a=new ac,l=new Bl,c=(t,c,u,h,d)=>{const p=(u-t)/(d-1),f=(h-c)/(d-1),m=s.length;for(let u=0;u<d;u++){const h=t+u*p,d=c+u*f;s.emplaceBack(h,d);const g=this._globePoint(h,d,e,r,i,n,o);l.emplaceBack(g[0],g[1],g[2]),a.emplaceBack(m+u)}},u=mo;c(0,0,u,0,16),c(u,0,u,u,16),c(u,u,0,u,16),c(0,u,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(a),this._tileDebugBuffer=t.createVertexBuffer(s,Oh.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(l,Ih.members),this._tileDebugSegments=Ac.simpleSegment(0,0,s.length,a.length)}_makeGlobeTileDebugTextBuffer(t,e,r,i,n,o){const s=mo/4,a=new Fl,l=new tc,c=new Bl,u=25;l.reserve(32),a.reserve(u),c.reserve(u);const h=(t,e)=>u*t+e;for(let t=0;t<u;t++){const l=t*s;for(let t=0;t<u;t++){const u=t*s;a.emplaceBack(u,l);const h=this._globePoint(u,l,e,r,i,n,o);c.emplaceBack(h[0],h[1],h[2])}}for(let t=0;t<4;t++)for(let e=0;e<4;e++){const r=h(t,e),i=h(t,e+1),n=h(t+1,e),o=h(t+1,e+1);l.emplaceBack(r,i,n),l.emplaceBack(n,i,o)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(l),this._tileDebugTextBuffer=t.createVertexBuffer(a,Oh.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(c,Ih.members),this._tileDebugTextSegments=Ac.simpleSegment(0,0,u,32)}destroy(t=!1){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!t&&this.texture&&this.texture instanceof $y&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}function hv(t,e,r){1===t?e.header_length=r.readFixed32():2===t?e.x=r.readVarint():3===t?e.y=r.readVarint():4===t?e.z=r.readVarint():5===t&&e.layers.push(function(t,e){return t.readFields(gv,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},e)}(r,r.readVarint()+r.pos))}function dv(t,e,r){1===t?(e.delta_filter=function(t,e){return t.readFields(pv,{block_size:0},e)}(r,r.readVarint()+r.pos),e.filter="delta_filter"):2===t?(r.readVarint(),e.filter="zigzag_filter"):3===t?(r.readVarint(),e.filter="bitshuffle_filter"):4===t&&(r.readVarint(),e.filter="byteshuffle_filter")}function pv(t,e,r){1===t&&(e.block_size=r.readVarint())}function fv(t,e,r){1===t?(r.readVarint(),e.codec="gzip_data"):2===t?(r.readVarint(),e.codec="jpeg_image"):3===t?(r.readVarint(),e.codec="webp_image"):4===t&&(r.readVarint(),e.codec="png_image")}function mv(t,e,r){1===t?e.first_byte=r.readFixed64():2===t?e.last_byte=r.readFixed64():3===t?e.filters.push(function(t,e){return t.readFields(dv,{},e)}(r,r.readVarint()+r.pos)):4===t?e.codec=function(t,e){return t.readFields(fv,{},e)}(r,r.readVarint()+r.pos):5===t?e.deprecated_offset=r.readFloat():6===t?e.deprecated_scale=r.readFloat():7===t?e.bands.push(r.readString()):8===t?e.offset=r.readDouble():9===t&&(e.scale=r.readDouble())}function gv(t,e,r){1===t?e.version=r.readVarint():2===t?e.name=r.readString():3===t?e.units=r.readString():4===t?e.tilesize=r.readVarint():5===t?e.buffer=r.readVarint():6===t?e.pixel_format=r.readVarint():7===t&&e.data_index.push(function(t,e){return t.readFields(mv,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,deprecated_offset:0,deprecated_scale:0,bands:[]},e)}(r,r.readVarint()+r.pos))}function yv(t,e,r){if(2===t)!function(t,e,r){t.readFields(vv,r,e)}(r,r.readVarint()+r.pos,e);else if(3===t)throw new Error("Not implemented")}function vv(t,e,r){if(1===t){let t=0;const i=r.readVarint()+r.pos;for(;r.pos<i;)e[t++]=r.readVarint()}}class _v{constructor(t){this.capacity=t,this.cache=new Map}get(t){if(!this.cache.has(t))return;const e=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,e),e}put(t,e){this.cache.has(t)?this.cache.delete(t):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(t,e)}}function bv(t,e){if(4!==e.length)throw new Error(`Expected data of dimension 4 but got ${e.length}.`);let r=e[3];for(let i=2;i>=1;i--){const n=1===i?1:0,o=2===i?1:0;for(let i=0;i<e[0];i++){const s=e[1]*i;for(let i=n;i<e[1];i++){const n=e[2]*(i+s);for(let i=o;i<e[2];i++){const o=e[3]*(i+n);for(let i=0;i<e[3];i++){const e=o+i;t[e]+=t[e-r]}}}}r*=e[i]}return t}function xv(t){for(let e=0,r=t.length;e<r;e++)t[e]=t[e]>>>1^-(1&t[e]);return t}function wv(t,e){switch(e){case"uint32":return t;case"uint16":for(let e=0;e<t.length;e+=2){const r=t[e],i=t[e+1];t[e]=(240&r)>>4|(61440&r)>>8|(240&i)<<4|61440&i,t[e+1]=15&r|(3840&r)>>4|(15&i)<<8|(3840&i)<<4}return t;case"uint8":for(let e=0;e<t.length;e+=4){const r=t[e],i=t[e+1],n=t[e+2],o=t[e+3];t[e+0]=(192&r)>>6|(192&i)>>4|(192&n)>>2|192&o,t[e+1]=(48&r)>>4|(48&i)>>2|48&n|(48&o)<<2,t[e+2]=(12&r)>>2|12&i|(12&n)<<2|(12&o)<<4,t[e+3]=3&r|(3&i)<<2|(3&n)<<4|(3&o)<<6}return t;default:throw new Error(`Invalid pixel format, "${e}"`)}}var Tv=Uint8Array,Ev=Uint16Array,Sv=Int32Array,Pv=new Tv([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),kv=new Tv([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Av=new Tv([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Mv=function(t,e){for(var r=new Ev(31),i=0;i<31;++i)r[i]=e+=1<<t[i-1];var n=new Sv(r[30]);for(i=1;i<30;++i)for(var o=r[i];o<r[i+1];++o)n[o]=o-r[i]<<5|i;return{b:r,r:n}},Cv=Mv(Pv,2),Iv=Cv.b,Ov=Cv.r;Iv[28]=258,Ov[258]=28;for(var Lv=Mv(kv,0).b,Dv=new Ev(32768),Rv=0;Rv<32768;++Rv){var Fv=(43690&Rv)>>1|(21845&Rv)<<1;Dv[Rv]=((65280&(Fv=(61680&(Fv=(52428&Fv)>>2|(13107&Fv)<<2))>>4|(3855&Fv)<<4))>>8|(255&Fv)<<8)>>1}var Bv=function(t,e,r){for(var i=t.length,n=0,o=new Ev(e);n<i;++n)t[n]&&++o[t[n]-1];var s,a=new Ev(e);for(n=1;n<e;++n)a[n]=a[n-1]+o[n-1]<<1;s=new Ev(1<<e);var l=15-e;for(n=0;n<i;++n)if(t[n])for(var c=n<<4|t[n],u=e-t[n],h=a[t[n]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)s[Dv[h]>>l]=c;return s},zv=new Tv(288);for(Rv=0;Rv<144;++Rv)zv[Rv]=8;for(Rv=144;Rv<256;++Rv)zv[Rv]=9;for(Rv=256;Rv<280;++Rv)zv[Rv]=7;for(Rv=280;Rv<288;++Rv)zv[Rv]=8;var jv=new Tv(32);for(Rv=0;Rv<32;++Rv)jv[Rv]=5;var Nv=Bv(zv,9),Vv=Bv(jv,5),Uv=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},$v=function(t,e,r){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(7&e)&r},Gv=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(7&e)},Hv=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],qv=function(t,e,r){var i=new Error(e||Hv[t]);if(i.code=t,Error.captureStackTrace&&Error.captureStackTrace(i,qv),!r)throw i;return i},Wv=new Tv(0),Zv="undefined"!=typeof TextDecoder&&new TextDecoder;try{Zv.decode(Wv,{stream:!0})}catch(t){}const Xv={gzip_data:"gzip"};class Yv extends Error{constructor(t){super(t),this.name="MRTError"}}const Kv={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},Jv={uint32:1,uint16:2,uint8:4},Qv={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let t_,e_;class r_{constructor(t=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=t}getLayer(t){const e=this.layers[t];if(!e)throw new Yv(`Layer '${t}' not found`);return e}getHeaderLength(t){const e=new Uint8Array(t),r=new DataView(t);if(13!==e[0])throw new Yv("File is not a valid MRT.");return r.getUint32(1,!0)}parseHeader(t){const e=new Uint8Array(t),r=this.getHeaderLength(t);if(e.length<r)throw new Yv(`Expected header with length >= ${r} but got buffer of length ${e.length}`);const i=function(t,e){return t.readFields(hv,{header_length:0,x:0,y:0,z:0,layers:[]},void 0)}(new t_(e.subarray(0,r)));if(!isNaN(this.x)&&(this.x!==i.x||this.y!==i.y||this.z!==i.z))throw new Yv(`Invalid attempt to parse header ${i.z}/${i.x}/${i.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=i.x,this.y=i.y,this.z=i.z;for(const t of i.layers)this.layers[t.name]=new i_(t,{cacheSize:this._cacheSize});return this}createDecodingTask(t){const e=[],r=this.getLayer(t.layerName);for(let i of t.blockIndices){const n=r.dataIndex[i],o=n.first_byte-t.firstByte,s=n.last_byte-t.firstByte;if(r._blocksInProgress.has(i))continue;const a={layerName:r.name,firstByte:o,lastByte:s,pixelFormat:r.pixelFormat,blockIndex:i,blockShape:[n.bands.length].concat(r.bandShape),buffer:r.buffer,codec:n.codec.codec,filters:n.filters.map((t=>t.filter))};r._blocksInProgress.add(i),e.push(a)}return new n_(e,(()=>{e.forEach((t=>r._blocksInProgress.delete(t.blockIndex)))}),((t,i)=>{if(e.forEach((t=>r._blocksInProgress.delete(t.blockIndex))),t)throw t;i.forEach((t=>{this.getLayer(t.layerName).processDecodedData(t)}))}))}}class i_{constructor({version:t,name:e,units:r,tilesize:i,pixel_format:n,buffer:o,data_index:s},a){if(this.version=t,1!==this.version)throw new Yv(`Cannot parse raster layer encoded with MRT version ${t}`);this.name=e,this.units=r,this.tileSize=i,this.buffer=o,this.pixelFormat=Kv[n],this.dataIndex=s,this.bandShape=[i+2*o,i+2*o,Jv[this.pixelFormat]],this._decodedBlocks=new _v(a?a.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return Jv[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map((({bands:t})=>t)).flat()}processDecodedData(t){const e=t.blockIndex.toString();this._decodedBlocks.get(e)||this._decodedBlocks.put(e,t.data)}getBlockForBand(t){let e=0;switch(typeof t){case"string":for(const[r,i]of this.dataIndex.entries()){for(const[n,o]of i.bands.entries())if(o===t)return{bandIndex:e+n,blockIndex:r,blockBandIndex:n};e+=i.bands.length}break;case"number":for(const[r,i]of this.dataIndex.entries()){if(t>=e&&t<e+i.bands.length)return{bandIndex:t,blockIndex:r,blockBandIndex:t-e};e+=i.bands.length}break;default:throw new Yv(`Invalid band \`${JSON.stringify(t)}\`. Expected string or integer.`)}throw new Yv(`Band not found: ${JSON.stringify(t)}`)}getDataRange(t){let e=1/0,r=-1/0;const i=[],n=new Set;for(const o of t){const{blockIndex:t}=this.getBlockForBand(o);if(t<0)throw new Yv(`Invalid band: ${JSON.stringify(o)}`);const s=this.dataIndex[t];i.includes(t)||i.push(t),n.add(t),e=Math.min(e,s.first_byte),r=Math.max(r,s.last_byte)}if(n.size>this.cacheSize)throw new Yv(`Number of blocks to decode (${n.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:e,lastByte:r,blockIndices:i}}hasBand(t){const{blockIndex:e}=this.getBlockForBand(t);return e>=0}hasDataForBand(t){const{blockIndex:e}=this.getBlockForBand(t);return e>=0&&!!this._decodedBlocks.get(e.toString())}getBandView(t){const{blockIndex:e,blockBandIndex:r}=this.getBlockForBand(t),i=this._decodedBlocks.get(e.toString());if(!i)throw new Yv(`Data for band ${JSON.stringify(t)} of layer "${this.name}" not decoded.`);const n=this.dataIndex[e],o=this.bandShape.reduce(((t,e)=>t*e),1),s=r*o,a=i.subarray(s,s+o);return{data:a,bytes:new Uint8Array(a.buffer).subarray(a.byteOffset,a.byteOffset+a.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:0!==n.offset?n.offset:n.deprecated_offset,scale:0!==n.scale?n.scale:n.deprecated_scale}}}r_.setPbf=function(t){t_=t};class n_{constructor(t,e,r){this.tasks=t,this._onCancel=e,this._onComplete=r,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(t,e){this._finalized||(this._onComplete(t,e),this._finalized=!0)}}r_.performDecoding=function(t,e){const r=new Uint8Array(t);return Promise.all(e.tasks.map((t=>{const{layerName:e,firstByte:i,lastByte:n,pixelFormat:o,blockShape:s,blockIndex:a,filters:l,codec:c}=t,u=r.subarray(i,n+1),h=new Uint32Array(s[0]*s[1]*s[2]);let d;if("gzip_data"!==c)throw new Yv(`Unhandled codec: ${c}`);return d=function(t,e){if(!globalThis.DecompressionStream&&"gzip_data"===e)return Promise.resolve(((o=function(t){31==t[0]&&139==t[1]&&8==t[2]||qv(6,"invalid gzip data");var e=t[3],r=10;4&e&&(r+=2+(t[10]|t[11]<<8));for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!t[r++]);return r+(2&e)}(n=t))+8>n.length&&qv(6,"invalid gzip data"),function(t,e,r,i){var n=t.length;if(!n||e.f&&!e.l)return r||new Tv(0);var o=!r,s=o||2!=e.i,a=e.i;o&&(r=new Tv(3*n));var l,c,u=function(t){var e=r.length;if(t>e){var i=new Tv(Math.max(2*e,t));i.set(r),r=i}},h=e.f||0,d=e.p||0,p=e.b||0,f=e.l,m=e.d,g=e.m,y=e.n,v=8*n;do{if(!f){h=$v(t,d,1);var _=$v(t,d+1,3);if(d+=3,!_){var b=t[(I=4+((d+7)/8|0))-4]|t[I-3]<<8,x=I+b;if(x>n){a&&qv(0);break}s&&u(p+b),r.set(t.subarray(I,x),p),e.b=p+=b,e.p=d=8*x,e.f=h;continue}if(1==_)f=Nv,m=Vv,g=9,y=5;else if(2==_){var w=$v(t,d,31)+257,T=$v(t,d+10,15)+4,E=w+$v(t,d+5,31)+1;d+=14;for(var S=new Tv(E),P=new Tv(19),k=0;k<T;++k)P[Av[k]]=$v(t,d+3*k,7);d+=3*T;var A=Uv(P),M=(1<<A)-1,C=Bv(P,A);for(k=0;k<E;){var I,O=C[$v(t,d,M)];if(d+=15&O,(I=O>>4)<16)S[k++]=I;else{var L=0,D=0;for(16==I?(D=3+$v(t,d,3),d+=2,L=S[k-1]):17==I?(D=3+$v(t,d,7),d+=3):18==I&&(D=11+$v(t,d,127),d+=7);D--;)S[k++]=L}}var R=S.subarray(0,w),F=S.subarray(w);g=Uv(R),y=Uv(F),f=Bv(R,g),m=Bv(F,y)}else qv(1);if(d>v){a&&qv(0);break}}s&&u(p+131072);for(var B=(1<<g)-1,z=(1<<y)-1,j=d;;j=d){var N=(L=f[Gv(t,d)&B])>>4;if((d+=15&L)>v){a&&qv(0);break}if(L||qv(2),N<256)r[p++]=N;else{if(256==N){j=d,f=null;break}var V=N-254;N>264&&(V=$v(t,d,(1<<(G=Pv[k=N-257]))-1)+Iv[k],d+=G);var U=m[Gv(t,d)&z],$=U>>4;if(U||qv(3),d+=15&U,F=Lv[$],$>3){var G=kv[$];F+=Gv(t,d)&(1<<G)-1,d+=G}if(d>v){a&&qv(0);break}s&&u(p+131072);var H=p+V;if(p<F){var q=0-F,W=Math.min(F,H);for(q+p<0&&qv(3);p<W;++p)r[p]=(void 0)[q+p]}for(;p<H;++p)r[p]=r[p-F]}}e.l=f,e.p=j,e.b=p,e.f=h,f&&(h=1,e.m=g,e.d=m,e.n=y)}while(!h);return p!=r.length&&o?(l=r,(null==(c=p)||c>l.length)&&(c=l.length),new Tv(l.subarray(0,c))):r.subarray(0,p)}(n.subarray(o,-8),{i:2},new Tv(((r=n)[(i=r.length)-4]|r[i-3]<<8|r[i-2]<<16|r[i-1]<<24)>>>0))));var r,i,n,o;const s=Xv[e];if(!s)throw new Error(`Unhandled codec: ${e}`);const a=new globalThis.DecompressionStream(s);return new Response(new Blob([t]).stream().pipeThrough(a)).arrayBuffer().then((t=>new Uint8Array(t)))}(u,c).then((t=>(function(t,e){t.readFields(yv,e)}(new t_(t),h),new(0,Qv[o])(h.buffer)))),d.then((t=>{for(let e=l.length-1;e>=0;e--)switch(l[e]){case"delta_filter":bv(t,s);break;case"zigzag_filter":xv(t);break;case"bitshuffle_filter":wv(t,o);break;default:throw new Yv(`Unhandled filter "${l[e]}"`)}return{layerName:e,blockIndex:a,data:t}})).catch((t=>{throw t}))})))},r_.setPbf(jm);class o_ extends uv{constructor(t,e,r,i,n){super(t,e,r,i,n),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(t,e){const r=e.context,i=r.gl;this.texture=this.texture||e.getTileTexture(t.width),this.texture&&this.texture instanceof $y?this.texture.update(t,{useMipmap:!1,premultiply:!1}):this.texture=new $y(r,t,i.RGBA,{useMipmap:!1,premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(t=16384,e){const r=this._mrt=new r_(30),i=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(t-1)}});return this.entireBuffer=null,this.request=ii(i,((i,n,o,s)=>{if(i)e(i);else try{const i=r.getHeaderLength(n);if(i>t)return void(this.request=this.fetchHeader(i,e));r.parseHeader(n),this._isHeaderLoaded=!0;let a=0;for(const t of Object.values(r.layers))a=Math.max(a,t.dataIndex[t.dataIndex.length-1].last_byte);n.byteLength>=a&&(this.entireBuffer=n),e(null,this.entireBuffer||n,o,s)}catch(t){e(t)}})),this.request}fetchBand(t,e,r){const i=this._mrt;if(!this._isHeaderLoaded||!i)return void r(new Error("Tile header is not ready"));const n=this.actor;if(!n)return void r(new Error("Can't fetch tile band without an actor"));let o;const s=(i,n)=>{o.complete(i,n),i?r(i):(this.updateTextureDescriptor(t,e),r(null,this.textureDescriptor&&this.textureDescriptor.img))},a=(t,e)=>{if(t)return r(t);const i=n.send("decodeRasterArray",{buffer:e,task:o},s,void 0,!0);this._workQueue.push((()=>{i&&i.cancel(),o.cancel()}))},l=i.getLayer(t);if(!l)return void r(new Error(`Unknown sourceLayer "${t}"`));if(l.hasDataForBand(e))return this.updateTextureDescriptor(t,e),void r(null,this.textureDescriptor?this.textureDescriptor.img:null);const c=l.getDataRange([e]);if(o=i.createDecodingTask(c),!o||o.tasks.length)if(this.flushQueues(),this.entireBuffer)a(null,this.entireBuffer.slice(c.firstByte,c.lastByte+1));else{const t=Object.assign({},this.requestParams,{headers:{Range:`bytes=${c.firstByte}-${c.lastByte}`}}),e=ii(t,a);this._fetchQueue.push((()=>{e.cancel(),o.cancel()}))}else r(null)}updateNeeded(t,e){return(!this.textureDescriptor||this.textureDescriptor.band!==e||this.textureDescriptor.layer!==t)&&"errored"!==this.state}updateTextureDescriptor(t,e){if(!this._mrt)return;const r=this._mrt.getLayer(t);if(!r||!r.hasBand(e)||!r.hasDataForBand(e))return;const{bytes:i,tileSize:n,buffer:o,offset:s,scale:a}=r.getBandView(e),l=n+2*o,c={data:i,width:l,height:l},u=this.texture;u&&u instanceof $y&&u.update(c,{useMipmap:!1,premultiply:!1}),this.textureDescriptor={layer:t,band:e,img:c,buffer:o,offset:s,tileSize:n,format:r.pixelFormat,mix:[a,256*a,65536*a,16777216*a]}}}class s_{constructor(t,e){this.max=t,this.onRemove=e,this.reset()}reset(){for(const t in this.data)for(const e of this.data[t])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(t,e,r){const i=t.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);const n={value:e,timeout:void 0};if(void 0!==r&&(n.timeout=setTimeout((()=>{this.remove(t,n)}),r)),this.data[i].push(n),this.order.push(i),this.order.length>this.max){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}getByKey(t){const e=this.data[t];return e?e[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,e){if(!this.has(t))return this;const r=t.wrapped().key,i=void 0===e?0:this.data[r].indexOf(e),n=this.data[r][i];return this.data[r].splice(i,1),n.timeout&&clearTimeout(n.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(n.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(t){const e=[];for(const r in this.data)for(const i of this.data[r])t(i.value)||e.push(i);for(const t of e)this.remove(t.value.tileID,t)}}class a_ extends zi{constructor(t,e,r){super(),this.id=t,this._onlySymbols=r,e.on("data",(t=>{"source"===t.dataType&&"metadata"===t.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))})),e.on("error",(()=>{this._sourceErrored=!0})),this._source=e,this._tiles={},this._cache=new s_(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=e.minTileCacheSize,this._maxTileCacheSize=e.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Um,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"raster-array"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(t){this.map=t,this._minTileCacheSize=void 0===this._minTileCacheSize&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const t in this._tiles){const e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,e){return t.isSymbolTile=this._onlySymbols,t.isExtraShadowCaster=this._shadowCasterTiles[t.tileID.key],this._source.loadTile(t,e)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t)}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t)}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const e in this._tiles){const r=this._tiles[e];r.upload(t),r.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return er(this._tiles).map((t=>t.tileID)).sort(l_).map((t=>t.key))}getRenderableIds(t,e){const r=[];for(const i in this._tiles)this._isIdRenderable(+i,t,e)&&r.push(this._tiles[i]);return t?r.sort(((t,e)=>{const r=t.tileID,i=e.tileID,n=new Ve(r.canonical.x,r.canonical.y)._rotate(this.transform.angle),o=new Ve(i.canonical.x,i.canonical.y)._rotate(this.transform.angle);return r.overscaledZ-i.overscaledZ||o.y-n.y||o.x-n.x})).map((t=>t.tileID.key)):r.map((t=>t.tileID)).sort(l_).map((t=>t.key))}hasRenderableParent(t){const e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(t,e,r){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())&&(r||!this._shadowCasterTiles[t])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(+t,"reloading")}}_reloadTile(t,e){const r=this._tiles[t];r&&("loading"!==r.state&&(r.state=e),this._loadTile(r,this._tileLoaded.bind(this,r,t,e)))}_tileLoaded(t,e,r,i){if(i)if(t.state="errored",404!==i.status)this._source.fire(new Ri(i,{tile:t}));else{if(this._source.fire(new Di("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:t})),!(t.tileID.key in this._loadedParentTiles))return;if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const t=this.map.painter.terrain;this.update(this.transform,t.getScaledDemTileSize(),!0),t.resetTileLookupCache(this.id)}else this.update(this.transform)}else t.timeAdded=Dr.now(),"expired"===r&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),"raster-dem"===this._source.type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new Di("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const e=this.getRenderableIds();for(let i=0;i<e.length;i++){const n=e[i];if(t.neighboringTiles&&t.neighboringTiles[n]){const e=this.getTileByID(n);r(t,e),r(e,t)}}function r(t,e){if(!t.dem||t.dem.borderReady)return;t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0;let r=e.tileID.canonical.x-t.tileID.canonical.x;const i=e.tileID.canonical.y-t.tileID.canonical.y,n=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===r&&0===i||Math.abs(i)>1||(Math.abs(r)>1&&(1===Math.abs(r+n)?r+=n:1===Math.abs(r-n)&&(r-=n)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,r,i),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,e,r,i){for(const n in this._tiles){let o=this._tiles[n];if(i[n]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>r)continue;let s=o.tileID;for(;o&&o.tileID.overscaledZ>e+1;){const t=o.tileID.scaledTo(o.tileID.overscaledZ-1);o=this._tiles[t.key],o&&o.hasData()&&(s=t)}let a=s;for(;a.overscaledZ>e;)if(a=a.scaledTo(a.overscaledZ-1),t[a.key]){i[s.key]=s;break}}}findLoadedParent(t,e){if(t.key in this._loadedParentTiles){const r=this._loadedParentTiles[t.key];return r&&r.tileID.overscaledZ>=e?r:null}for(let r=t.overscaledZ-1;r>=e;r--){const e=t.scaledTo(r),i=this._getLoadedTile(e);if(i)return i}}_getLoadedTile(t){const e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,e){e=e||this._source.tileSize;const r=Math.ceil(t.width/e)+1,i=Math.ceil(t.height/e)+1,n=Math.floor(r*i*5),o="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,n):n,s="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,o):o;this._cache.setMaxSize(s)}handleWrapJump(t){const e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){const t={};for(const r in this._tiles){const i=this._tiles[r];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+e),t[i.tileID.key]=i}this._tiles=t;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(+t,this._tiles[t])}}update(t,e,r,i){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage)return;if(this.usedForTerrain&&!r)return;this.updateCacheSize(t,e),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const n="batched-model"===this._source.type;let o;if(this.used||this.usedForTerrain){if(this._source.tileID)o=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((t=>new Su(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)));else if(0!==this.tileCoverLift){const i=t.clone();i.tileCoverLift=this.tileCoverLift,o=i.coveringTiles({tileSize:e||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!r,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:n}),this._source.minzoom<=1&&"globe"===t.projection.name&&(o.push(new Su(1,0,1,0,0)),o.push(new Su(1,0,1,1,0)),o.push(new Su(1,0,1,0,1)),o.push(new Su(1,0,1,1,1)))}else if(o=t.coveringTiles({tileSize:e||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!r,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:n}),this._source.hasTile){const t=this._source.hasTile.bind(this._source);o=o.filter((e=>t(e)))}}else o=[];if(o.length>0&&this.castsShadows&&i&&"globe"!==this.transform.projection.name&&!this.usedForTerrain&&!c_(this._source.type)){const s=t.coveringZoomLevel({tileSize:e||this._source.tileSize,roundZoom:this._source.roundZoom&&!r}),a=Math.min(s,this._source.maxzoom);if(n){const e=t.extendTileCover(o,a);for(const t of e)o.push(t)}else{const e=t.extendTileCover(o,a,i);for(const t of e)this._shadowCasterTiles[t.key]=!0,o.push(t)}}const s=this._updateRetainedTiles(o);if(c_(this._source.type)&&0!==o.length){const t={},e={},r=Object.keys(s);for(const i of r){const r=s[i],n=this._tiles[i];if(!n||n.fadeEndTime&&n.fadeEndTime<=Dr.now())continue;const o=this.findLoadedParent(r,Math.max(r.overscaledZ-a_.maxOverzooming,this._source.minzoom));o&&(this._addTile(o.tileID),t[o.tileID.key]=o.tileID),e[i]=r}const i=o[o.length-1].overscaledZ;for(const t in this._tiles){const r=this._tiles[t];if(s[t]||!r.hasData())continue;let n=r.tileID;for(;n.overscaledZ>i;){n=n.scaledTo(n.overscaledZ-1);const i=this._tiles[n.key];if(i&&i.hasData()&&e[n.key]){s[t]=r.tileID;break}}}for(const e in t)s[e]||(this._coveredTiles[e]=!0,s[e]=t[e])}for(const t in s)this._tiles[t].clearFadeHold();const a=function(t,e){const r=[];for(const i in t)i in e||r.push(i);return r}(this._tiles,s);for(const t of a){const e=this._tiles[t];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(+t)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const e={};if(0===t.length)return e;const r={},i=t.reduce(((t,e)=>Math.min(t,e.overscaledZ)),1/0),n=t[0].overscaledZ,o=Math.max(n-a_.maxOverzooming,this._source.minzoom),s=Math.max(n+a_.maxUnderzooming,this._source.minzoom),a={};for(const r of t){const t=this._addTile(r);e[r.key]=r,t.hasData()||i<this._source.maxzoom&&(a[r.key]=r)}this._retainLoadedChildren(a,i,s,e);for(const i of t){let t=this._tiles[i.key];if(t.hasData())continue;if(i.canonical.z>=this._source.maxzoom){const t=i.children(this._source.maxzoom)[0],r=this.getTile(t);if(r&&r.hasData()){e[t.key]=t;continue}}else{const t=i.children(this._source.maxzoom);if(e[t[0].key]&&e[t[1].key]&&e[t[2].key]&&e[t[3].key])continue}let n=t.wasRequested();for(let s=i.overscaledZ-1;s>=o;--s){const o=i.scaledTo(s);if(r[o.key])break;if(r[o.key]=!0,t=this.getTile(o),!t&&n&&(t=this._addTile(o)),t&&(e[o.key]=o,n=t.wasRequested(),t.hasData()))break}}return e}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const e=[];let r,i=this._tiles[t].tileID;for(;i.overscaledZ>0;){if(i.key in this._loadedParentTiles){r=this._loadedParentTiles[i.key];break}e.push(i.key);const t=i.scaledTo(i.overscaledZ-1);if(r=this._getLoadedTile(t),r)break;i=t}for(const t of e)this._loadedParentTiles[t]=r}}_addTile(t){let e=this._tiles[t.key];if(e)return!0!==e.isExtraShadowCaster||!!this._shadowCasterTiles[t.key]||this._reloadTile(t.key,"reloading"),e;e=this._cache.getAndRemove(t),e&&(this._setTileReloadTimer(t.key,e),e.tileID=t,this._state.initializeTileState(e,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,e)));const r=Boolean(e);if(!r){const r=this.map?this.map.painter:null,i=this._source.tileSize*t.overscaleFactor();e="raster-array"===this._source.type?new o_(t,i,this.transform.tileZoom,r,this._isRaster):new uv(t,i,this.transform.tileZoom,r,this._isRaster),this._loadTile(e,this._tileLoaded.bind(this,e,t.key,e.state))}return e?(e.uses++,this._tiles[t.key]=e,r||this._source.fire(new Di("dataloading",{tile:e,coord:e.tileID,dataType:"source"})),e):null}_setTileReloadTimer(t,e){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const r=e.getExpiryTimeout();r&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),r))}_removeTile(t){const e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state||"empty"===e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,e,r){const i=[],n=this.transform;if(!n)return i;const o="globe"===n.projection.name,s=Iu(n.center.lng);for(const a in this._tiles){const l=this._tiles[a];if(r&&l.clearQueryDebugViz(),l.holdingForFade())continue;let c;if(o){const t=l.tileID.canonical;if(0===t.z){const e=[Math.abs(Ke(s,...u_(t,-1))-s),Math.abs(Ke(s,...u_(t,1))-s)];c=[0,2*e.indexOf(Math.min(...e))-1]}else{const e=[Math.abs(Ke(s,...u_(t,-1))-s),Math.abs(Ke(s,...u_(t,0))-s),Math.abs(Ke(s,...u_(t,1))-s)];c=[e.indexOf(Math.min(...e))-1]}}else c=[0];for(const r of c){const o=t.containsTile(l,n,e,r);o&&i.push(o)}}return i}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(t){return this._getRenderableCoordinates(t)}_getRenderableCoordinates(t,e){const r=this.getRenderableIds(t,e).map((t=>this._tiles[t].tileID)),i="globe"===this.transform.projection.name;for(const t of r)t.projMatrix=this.transform.calculateProjMatrix(t.toUnwrapped()),t.expandedProjMatrix=i?this.transform.calculateProjMatrix(t.toUnwrapped(),!1,!0):t.projMatrix;return r}sortCoordinatesByDistance(t){const e=t.slice(),r=this.transform._camera.position,i=this.transform._camera.forward(),n={};for(const t of e){const e=1/(1<<t.canonical.z);n[t.key]=((t.canonical.x+.5)*e+t.wrap-r[0])*i[0]+((t.canonical.y+.5)*e-r[1])*i[1]-r[2]*i[2]}return e.sort(((t,e)=>n[t.key]-n[e.key])),e}hasTransition(){if(this._source.hasTransition())return!0;if(c_(this._source.type))for(const t in this._tiles){const e=this._tiles[t];if(void 0!==e.fadeEndTime&&e.fadeEndTime>=Dr.now())return!0}return!1}setFeatureState(t,e,r){this._state.updateState(t=t||"_geojsonTileLayer",e,r)}removeFeatureState(t,e,r){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,r)}getFeatureState(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}setDependencies(t,e,r){const i=this._tiles[t];i&&i.setDependencies(e,r)}reloadTilesForDependencies(t,e){for(const r in this._tiles)this._tiles[r].hasDependency(t,e)&&this._reloadTile(+r,"reloading");this._cache.filter((r=>!r.hasDependency(t,e)))}_preloadTiles(t,e){if(!this._sourceLoaded){const r=()=>{this._sourceLoaded&&(this._source.off("data",r),this._preloadTiles(t,e))};return void this._source.on("data",r)}const r=new Map,i=Array.isArray(t)?t:[t],n=this.map.painter.terrain,o=this.usedForTerrain&&n?n.getScaledDemTileSize():this._source.tileSize;for(const t of i){const e=t.coveringTiles({tileSize:o,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const t of e)r.set(t.key,t);this.usedForTerrain&&t.updateElevation(!1)}tr(Array.from(r.values()),((t,e)=>{const r=new uv(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(r,(t=>{"raster-dem"===this._source.type&&r.dem&&this._backfillDEM(r),e(t,r)}))}),e)}}function l_(t,e){const r=Math.abs(2*t.wrap)-+(t.wrap<0),i=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||i-r||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function c_(t){return"raster"===t||"image"===t||"video"===t||"custom"===t}function u_(t,e){const r=1<<t.z;return[t.x/r+e,(t.x+1)/r+e]}a_.maxOverzooming=10,a_.maxUnderzooming=3;const h_=()=>e_||(e_={layout:cm||(cm=new cl({"line-cap":new al(ul.layout_line["line-cap"]),"line-join":new al(ul.layout_line["line-join"]),"line-miter-limit":new sl(ul.layout_line["line-miter-limit"]),"line-round-limit":new sl(ul.layout_line["line-round-limit"]),"line-sort-key":new al(ul.layout_line["line-sort-key"]),"line-z-offset":new al(ul.layout_line["line-z-offset"]),visibility:new sl(ul.layout_line.visibility)})),paint:um||(um=new cl({"line-opacity":new al(ul.paint_line["line-opacity"]),"line-color":new al(ul.paint_line["line-color"]),"line-translate":new sl(ul.paint_line["line-translate"]),"line-translate-anchor":new sl(ul.paint_line["line-translate-anchor"]),"line-width":new al(ul.paint_line["line-width"]),"line-gap-width":new al(ul.paint_line["line-gap-width"]),"line-offset":new al(ul.paint_line["line-offset"]),"line-blur":new al(ul.paint_line["line-blur"]),"line-dasharray":new al(ul.paint_line["line-dasharray"]),"line-pattern":new al(ul.paint_line["line-pattern"]),"line-gradient":new ll(ul.paint_line["line-gradient"]),"line-trim-offset":new sl(ul.paint_line["line-trim-offset"]),"line-trim-fade-range":new sl(ul.paint_line["line-trim-fade-range"]),"line-trim-color":new sl(ul.paint_line["line-trim-color"]),"line-emissive-strength":new sl(ul.paint_line["line-emissive-strength"]),"line-border-width":new al(ul.paint_line["line-border-width"]),"line-border-color":new al(ul.paint_line["line-border-color"]),"line-occlusion-opacity":new sl(ul.paint_line["line-occlusion-opacity"])}))},e_);class d_ extends al{possiblyEvaluate(t,e){return e=new Ka(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,r,i){return e=rr({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,r,i)}}let p_,f_,m_,g_;function y_(t,e){return e>0?e+2*t:t}class v_{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Ji,this.defaultValue=t}evaluate(t){if(t.formattedSection){const e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Sa(v_,"FormatSectionOverride",{omit:["defaultValue"]});const __=()=>g_||(g_={layout:f_||(f_=new cl({"symbol-placement":new sl(ul.layout_symbol["symbol-placement"]),"symbol-spacing":new sl(ul.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new sl(ul.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new al(ul.layout_symbol["symbol-sort-key"]),"symbol-z-order":new sl(ul.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new sl(ul.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new sl(ul.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new sl(ul.layout_symbol["icon-ignore-placement"]),"icon-optional":new sl(ul.layout_symbol["icon-optional"]),"icon-rotation-alignment":new sl(ul.layout_symbol["icon-rotation-alignment"]),"icon-size":new al(ul.layout_symbol["icon-size"]),"icon-text-fit":new al(ul.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new al(ul.layout_symbol["icon-text-fit-padding"]),"icon-image":new al(ul.layout_symbol["icon-image"]),"icon-rotate":new al(ul.layout_symbol["icon-rotate"]),"icon-padding":new sl(ul.layout_symbol["icon-padding"]),"icon-keep-upright":new sl(ul.layout_symbol["icon-keep-upright"]),"icon-offset":new al(ul.layout_symbol["icon-offset"]),"icon-anchor":new al(ul.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new sl(ul.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new sl(ul.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new sl(ul.layout_symbol["text-rotation-alignment"]),"text-field":new al(ul.layout_symbol["text-field"]),"text-font":new al(ul.layout_symbol["text-font"]),"text-size":new al(ul.layout_symbol["text-size"]),"text-max-width":new al(ul.layout_symbol["text-max-width"]),"text-line-height":new al(ul.layout_symbol["text-line-height"]),"text-letter-spacing":new al(ul.layout_symbol["text-letter-spacing"]),"text-justify":new al(ul.layout_symbol["text-justify"]),"text-radial-offset":new al(ul.layout_symbol["text-radial-offset"]),"text-variable-anchor":new sl(ul.layout_symbol["text-variable-anchor"]),"text-anchor":new al(ul.layout_symbol["text-anchor"]),"text-max-angle":new sl(ul.layout_symbol["text-max-angle"]),"text-writing-mode":new sl(ul.layout_symbol["text-writing-mode"]),"text-rotate":new al(ul.layout_symbol["text-rotate"]),"text-padding":new sl(ul.layout_symbol["text-padding"]),"text-keep-upright":new sl(ul.layout_symbol["text-keep-upright"]),"text-transform":new al(ul.layout_symbol["text-transform"]),"text-offset":new al(ul.layout_symbol["text-offset"]),"text-allow-overlap":new sl(ul.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new sl(ul.layout_symbol["text-ignore-placement"]),"text-optional":new sl(ul.layout_symbol["text-optional"]),visibility:new sl(ul.layout_symbol.visibility)})),paint:m_||(m_=new cl({"icon-opacity":new al(ul.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new al(ul.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new al(ul.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new al(ul.paint_symbol["text-emissive-strength"]),"icon-color":new al(ul.paint_symbol["icon-color"]),"icon-halo-color":new al(ul.paint_symbol["icon-halo-color"]),"icon-halo-width":new al(ul.paint_symbol["icon-halo-width"]),"icon-halo-blur":new al(ul.paint_symbol["icon-halo-blur"]),"icon-translate":new sl(ul.paint_symbol["icon-translate"]),"icon-translate-anchor":new sl(ul.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new al(ul.paint_symbol["icon-image-cross-fade"]),"text-opacity":new al(ul.paint_symbol["text-opacity"]),"text-occlusion-opacity":new al(ul.paint_symbol["text-occlusion-opacity"]),"text-color":new al(ul.paint_symbol["text-color"],{runtimeType:rn,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new al(ul.paint_symbol["text-halo-color"]),"text-halo-width":new al(ul.paint_symbol["text-halo-width"]),"text-halo-blur":new al(ul.paint_symbol["text-halo-blur"]),"text-translate":new sl(ul.paint_symbol["text-translate"]),"text-translate-anchor":new sl(ul.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new sl(ul.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new sl(ul.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new sl(ul.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new sl(ul.paint_symbol["icon-color-brightness-max"])}))},g_);class b_ extends Cl{constructor(e,r,i,n){super(e,__(),r,i,n),this._colorAdjustmentMatrix=t.ae.identity([]),this.hasInitialOcclusionOpacityProperties=void 0!==e.paint&&("icon-occlusion-opacity"in e.paint||"text-occlusion-opacity"in e.paint)}recalculate(t,e){super.recalculate(t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const r=this.layout.get("text-writing-mode");if(r){const t=[];for(const e of r)t.indexOf(e)<0&&t.push(e);this.layout._values["text-writing-mode"]=t}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(e,r,i,n){return this._saturation===e&&this._contrast===r&&this._brightnessMin===i&&this._brightnessMax===n||(this._colorAdjustmentMatrix=function(e,r,i,n){e=Or(e),r=Ir(r);const o=t.ae.create(),s=e/3,a=1-2*s,l=[a,s,s,0,s,a,s,0,s,s,a,0,0,0,0,1],c=.5-.5*r,u=n-i;return t.ae.multiply(o,[u,0,0,0,0,u,0,0,0,0,u,0,i,i,i,1],[r,0,0,0,0,r,0,0,0,0,r,0,c,c,c,1]),t.ae.multiply(o,o,l),o}(e,r,i,n),this._saturation=e,this._contrast=r,this._brightnessMin=i,this._brightnessMax=n),this._colorAdjustmentMatrix}getValueAndResolveTokens(t,e,r,i){const n=this.layout.get(t).evaluate(e,{},r,i),o=this._unevaluatedLayout._values[t];return o.isDataDriven()||pa(o.value)||!n?n:function(t,e){return e.replace(/{([^{}]+)}/g,((e,r)=>r in t?String(t[r]):""))}(e.properties,n)}createBucket(t){return new Uy(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of __().paint.overridableProperties){if(!b_.hasPaintOverride(this.layout,t))continue;const e=this.paint.get(t),r=new v_(e),i=new da(r,e.property.specification,this.scope,this.options);let n=null;n="constant"===e.value.kind||"source"===e.value.kind?new ma("source",i):new ga("composite",i,e.value.zoomStops,e.value._interpolationType),this.paint._values[t]=new nl(e.property,n,e.parameters)}}_handleOverridablePaintPropertyUpdate(t,e,r){return!(!this.layout||e.isDataDriven()||r.isDataDriven())&&b_.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,e){const r=t.get("text-field"),i=__().paint.properties[e];let n=!1;const o=t=>{for(const e of t)if(i.overrides&&i.overrides.hasOverride(e))return void(n=!0)};if("constant"===r.value.kind&&r.value.value instanceof yn)o(r.value.value.sections);else if("source"===r.value.kind){const t=e=>{n||(e instanceof Tn&&xn(e.value)===an?o(e.value.sections):e instanceof kn?o(e.sections):e.eachChild(t))},e=r.value;e._styleExpression&&t(e._styleExpression.expression)}return n}getProgramIds(){const t=0!==this.paint.get("icon-opacity").constantOr(1),e=0!==this.paint.get("text-opacity").constantOr(1),r=[];return t&&r.push("symbolIcon"),e&&r.push("symbolSDF"),r}getDefaultProgramParams(t,e,r){return{config:new tu(this,{zoom:e,lut:r}),overrideFog:!1}}}let x_,w_,T_,E_;function S_(e,r,i,n,o,s,a,l){const c=[e,r,1,i,n,1,o,s,1],u=[a,l,1],h=t.bE.adjoint([],c),[d,p,f]=t.$.transformMat3(u,u,h);return t.bE.multiply(c,c,[d,0,0,0,p,0,0,0,f])}function P_(e,r,i,n,o,s,a,l){const c=function(e,r,i,n,o,s,a,l){const c=S_(0,0,1,0,1,1,0,1),u=S_(e,r,i,n,o,s,a,l),h=t.bE.adjoint([],c);return t.bE.multiply(u,u,h)}(e,r,i,n,o,s,a,l);return[c[2]/c[8]/mo,c[5]/c[8]/mo]}function k_(t){return[t[0],Math.min(Math.max(t[1],-Bu),Bu)]}class A_ extends zi{constructor(t,e,r,i){super(),this.id=t,this.dispatcher=r,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(i),this.options=e,this._dirty=!1}load(t,e){if(this._loaded=e||!1,this.fire(new Di("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=li(this.map._requestManager.transformRequest(this.url,Qr.Image),((e,r)=>{this._imageRequest=null,this._loaded=!0,e?this.fire(new Ri(e)):r&&(this.image=r instanceof HTMLImageElement?Dr.getImageData(r):r,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading())}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new Gy(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Di("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(t){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof Gy||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,this._unsupportedCoords=!1,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let e=t[0][1],r=t[0][1];for(const i of t)i[1]>r&&(r=i[1]),i[1]<e&&(e=i[1]);const i=(r+e)/2;if(i>Bu?this.onNorthPole=!0:i<-Bu&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const e=t.map(Uu.fromLngLat);this.tileID=function(t){let e=1/0,r=1/0,i=-1/0,n=-1/0;for(const o of t)e=Math.min(e,o.x),r=Math.min(r,o.y),i=Math.max(i,o.x),n=Math.max(n,o.y);const o=Math.max(i-e,n-r),s=Math.max(0,Math.floor(-Math.log(o)/Math.LN2)),a=Math.pow(2,s);let l=Math.floor((e+i)/2*a);return l>1&&(l-=1),new Tu(s,l,Math.floor((r+n)/2*a))}(e),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Di("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(e){for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const r=uy(new Tu(0,0,0),this.map.transform.projection),i=[r.projection.project(this.coordinates[0][0],this.coordinates[0][1]),r.projection.project(this.coordinates[1][0],this.coordinates[1][1]),r.projection.project(this.coordinates[2][0],this.coordinates[2][1]),r.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(t){const e=t[1].x-t[0].x,r=t[1].y-t[0].y,i=t[2].x-t[1].x,n=t[2].y-t[1].y,o=t[3].x-t[2].x,s=t[3].y-t[2].y,a=t[0].x-t[3].x,l=t[0].y-t[3].y,c=e*n-i*r,u=i*s-o*n,h=o*l-a*s,d=a*r-e*l;return c>0&&u>0&&h>0&&d>0||c<0&&u<0&&h<0&&d<0}(i))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const n=uy(this.tileID,this.map.transform.projection),[o,s,a,l]=this.coordinates.map((t=>{const e=n.projection.project(t[0],t[1]);return hy(n,e)._round()}));this.perspectiveTransform=P_(o.x,o.y,s.x,s.y,a.x,a.y,l.x,l.y);const c=this._boundsArray=new zl;c.emplaceBack(o.x,o.y,0,0),c.emplaceBack(s.x,s.y,mo,0),c.emplaceBack(l.x,l.y,0,mo),c.emplaceBack(a.x,a.y,mo,mo),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=e.createVertexBuffer(c,Jy.members),this.boundsSegments=Ac.simpleSegment(0,0,4,2);const u=[],h=function(t){return[k_(t[0]),k_(t[1]),k_(t[2]),k_(t[3])]}(this.coordinates),[d,p,f,m]=function(t){let e=t[0][0],r=e,i=t[0][1],n=i;for(let o=1;o<t.length;o++)t[o][0]<e?e=t[o][0]:t[o][0]>r&&(r=t[o][0]),t[o][1]<i?i=t[o][1]:t[o][1]>n&&(n=t[o][1]);return[e,i,r-e,n-i]}(h);{const n=new zl,[o,s,a,l]=function(t){let e=t[0].x,r=e,i=t[0].y,n=i;for(let o=1;o<t.length;o++)t[o].x<e?e=t[o].x:t[o].x>r&&(r=t[o].x),t[o].y<i?i=t[o].y:t[o].y>n&&(n=t[o].y);return[e,i,r-e,n-i]}(i),c=t=>[(t.x-o)/a,(t.y-s)/l],[h,g,y,v]=i.map(c),_=function(e,r,i,n,o,s,a,l){const c=S_(0,0,1,0,1,1,0,1),u=S_(e,r,i,n,o,s,a,l),h=t.bE.adjoint([],u);return t.bE.multiply(c,c,h)}(h[0],h[1],g[0],g[1],y[0],y[1],v[0],v[1]);this.elevatedGlobePerspectiveTransform=P_(h[0],h[1],g[0],g[1],y[0],y[1],v[0],v[1]);const b=(e,r)=>{u.push(e.lng);const i=Math.round((e.lng-d)/f*mo),o=Math.round((e.lat-p)/m*mo),s=c(r),a=t.$.transformMat3([],[s[0],s[1],1],_),l=Math.round(a[0]/a[2]*mo),h=Math.round(a[1]/a[2]*mo);n.emplaceBack(i,o,l,h)},x=i[3].x-i[0].x,w=i[3].y-i[0].y,T=i[2].x-i[1].x,E=i[2].y-i[1].y;for(let t=0;t<65;t++){const e=t/64,n=[i[0].x+e*x,i[0].y+e*w],o=[i[1].x+e*T,i[1].y+e*E],s=o[0]-n[0],a=o[1]-n[1];for(let t=0;t<65;t++){const e=t/64,i={x:n[0]+s*e,y:n[1]+a*e,z:0};b(r.projection.unproject(i.x,i.y),i)}}this.elevatedGlobeVertexBuffer=e.createVertexBuffer(n,Jy.members)}{this.maxLongitudeTriangleSize=0;let t=[],r=new tc;const i=(e,i,n)=>{r.emplaceBack(e,i,n);const o=u[e],s=u[i],a=u[n],l=Math.min(Math.min(o,s),a),c=Math.max(Math.max(o,s),a)-l;c>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=c),t.push(l+c/2)};for(let t=0;t<64;t++)for(let e=0;e<64;e++){const r=65*t+e,n=r+1,o=r+65,s=o+1;i(r,o,n),i(n,o,s)}[t,r]=function(t,e){const r=Array.from({length:t.length},((t,e)=>e));r.sort(((e,r)=>t[e]-t[r]));const i=[],n=new tc;for(let o=0;o<r.length;o++){const s=r[o];i.push(t[s]);const a=3*s,l=a+1;n.emplaceBack(e.uint16[a],e.uint16[l],e.uint16[l+1])}return[i,n]}(t,r),this.elevatedGlobeTrianglesCenterLongitudes=t,this.elevatedGlobeIndexBuffer=e.createIndexBuffer(r)}this.elevatedGlobeSegments=Ac.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,f/mo,0,m/mo,0,0,p,d,0])}prepare(){const t=0!==Object.keys(this.tiles).length;if(this.tileID&&!t)return;const e=this.map.painter.context,r=e.gl;!this._dirty||this.texture instanceof Gy||(this.texture?this.texture.update(this.image):(this.texture=new $y(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(e)}loadTile(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(t){const e=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!e)return null;const r=this.elevatedGlobeTrianglesCenterLongitudes;let i=(n=t+180)+360*Math.round((r[0]-n)/360);var n;const o=new Ac,s=(t,r)=>{o.segments.push({vertexOffset:0,primitiveOffset:t,vertexLength:e.segments[0].vertexLength,primitiveLength:r,sortKey:void 0,vaos:{}})},a=.51*this.maxLongitudeTriangleSize;if(Math.abs(r[0]-i)<=a){const t=Cr(r,0,r.length,i+a);return t===r.length||s(t,Mr(r,t+1,r.length,i+360-a)-t),o}i<r[0]&&(i+=360);const l=Mr(r,0,r.length,i-a);if(l===r.length)return s(0,r.length),o;s(0,l-0);const c=Cr(r,l+1,r.length,i+a);return c!==r.length&&s(c,r.length-c),o}}const M_=(Math.pow(256,2)-1)/16907520;class C_ extends Cl{constructor(t,e,r,i){super(t,{layout:T_||(T_=new cl({visibility:new sl(ul.layout_raster.visibility)})),paint:E_||(E_=new cl({"raster-opacity":new sl(ul.paint_raster["raster-opacity"]),"raster-color":new ll(ul.paint_raster["raster-color"]),"raster-color-mix":new sl(ul.paint_raster["raster-color-mix"]),"raster-color-range":new sl(ul.paint_raster["raster-color-range"]),"raster-hue-rotate":new sl(ul.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new sl(ul.paint_raster["raster-brightness-min"]),"raster-brightness-max":new sl(ul.paint_raster["raster-brightness-max"]),"raster-saturation":new sl(ul.paint_raster["raster-saturation"]),"raster-contrast":new sl(ul.paint_raster["raster-contrast"]),"raster-resampling":new sl(ul.paint_raster["raster-resampling"]),"raster-fade-duration":new sl(ul.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new sl(ul.paint_raster["raster-emissive-strength"]),"raster-array-band":new sl(ul.paint_raster["raster-array-band"]),"raster-elevation":new sl(ul.paint_raster["raster-elevation"])}))},e,r,i),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(t){return!(t&&t._source instanceof A_&&(t._source.onNorthPole||t._source.onSouthPole))&&0===this.paint.get("raster-elevation")}_handleSpecialPaintPropertyUpdate(t){"raster-color"!==t&&"raster-color-range"!==t||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(t){if(!this.hasColorMap())return;if(!this._curRampRange)return;const e=this._transitionablePaint._values["raster-color"].value.expression,[r,i]=t||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(r)&&isNaN(i)||r===this._curRampRange[0]&&i===this._curRampRange[1]||(this.colorRamp=Td({expression:e,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:r,end:i}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[r,i])}}let I_,O_,L_,D_,R_;class F_ extends Cl{constructor(t,e,r,i){super(t,{layout:I_||(I_=new cl({visibility:new sl(ul["layout_raster-particle"].visibility)})),paint:O_||(O_=new cl({"raster-particle-array-band":new sl(ul["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new sl(ul["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new ll(ul["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new sl(ul["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new sl(ul["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new sl(ul["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new sl(ul["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new sl(ul["paint_raster-particle"]["raster-particle-elevation"])}))},e,r,i),this._updateColorRamp(),this.lastInvalidatedAt=Dr.now()}onRemove(t){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return"none"!==this.visibility}isDraped(t){return!1}_handleSpecialPaintPropertyUpdate(t){"raster-particle-color"!==t&&"raster-particle-max-speed"!==t||(this._updateColorRamp(),this._invalidateAnimationState()),"raster-particle-count"===t&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const t=this._transitionablePaint._values["raster-particle-color"].value.expression,e=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Td({expression:t,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:e}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Dr.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class B_ extends Cl{constructor(t,e){super(t,{},e,null),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isDraped(t){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}function z_(e,r,i){const n=[0,0,1],o=t.aw.identity([]);return t.aw.rotateY(o,o,i?-He(e)+Math.PI:He(e)),t.aw.rotateX(o,o,-He(r)),t.$.transformQuat(n,n,o),t.$.normalize(n,n)}function j_(e,r){const i=V_(e.projection,e.zoom,e.width,e.height),n=function(e,r,i,n,o){const s=new _u(i.lng-180*U_,i.lat),a=new _u(i.lng+180*U_,i.lat),l=e.project(s.lng,s.lat),c=e.project(a.lng,a.lat),u=-Math.atan2(c.y-l.y,c.x-l.x),h=Uu.fromLngLat(i);h.y=Ke(h.y,-1+U_,1-U_);const d=h.toLngLat(),p=e.project(d.lng,d.lat),f=Uu.fromLngLat(d);f.x+=U_;const m=f.toLngLat(),g=e.project(m.lng,m.lat),y=G_(g.x-p.x,g.y-p.y,u),v=Uu.fromLngLat(d);v.y+=U_;const _=v.toLngLat(),b=e.project(_.lng,_.lat),x=G_(b.x-p.x,b.y-p.y,u),w=Math.abs(y.x)/Math.abs(x.y),T=t.ae.identity([]);t.ae.rotateZ(T,T,-u*(1-(o?0:n)));const E=t.ae.identity([]);return t.ae.scale(E,E,[1,1-(1-w)*n,1]),E[4]=-x.x/x.y*n,t.ae.rotateZ(E,E,u),t.ae.multiply(E,T,E),E}(e.projection,0,e.center,i,r),o=N_(e);return t.ae.scale(n,n,[o,o,1]),n}function N_(t){const e=t.projection,r=V_(t.projection,t.zoom,t.width,t.height),i=$_(e,t.center),n=$_(e,_u.convert(e.center));return Math.pow(2,i*r+(1-r)*n)}function V_(t,e,r,i,n=1/0){const o=t.range;if(!o)return 0;const s=Math.min(n,Math.max(r,i)),a=Math.log(s/1024)/Math.LN2;return Je(o[0]+a,o[1]+a,e)}const U_=1/4e4;function $_(t,e){const r=Ke(e.lat,-Bu,Bu),i=new _u(e.lng-180*U_,r),n=new _u(e.lng+180*U_,r),o=t.project(i.lng,r),s=t.project(n.lng,r),a=Uu.fromLngLat(i),l=Uu.fromLngLat(n),c=s.x-o.x,u=s.y-o.y,h=l.x-a.x,d=l.y-a.y,p=Math.sqrt((h*h+d*d)/(c*c+u*u));return Math.log(p)/Math.LN2}function G_(t,e,r){const i=Math.cos(r),n=Math.sin(r);return{x:t*i-e*n,y:t*n+e*i}}function H_(e,r,i){t.ae.identity(e),t.ae.rotateZ(e,e,He(r[2])),t.ae.rotateX(e,e,He(r[0])),t.ae.rotateY(e,e,He(r[1])),t.ae.scale(e,e,i),t.ae.multiply(e,e,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function q_(e,r,i,n,o,s,a,l){const c=[i[0]-r[0],i[1]-r[1],0],u=[n[0]-r[0],n[1]-r[1],0];if(t.$.length(c)<1e-12||t.$.length(u)<1e-12)return t.aw.identity(e);const h=t.$.cross([],c,u);t.$.normalize(h,h),t.$.subtract(u,n,r),c[2]=(s-o)*l,u[2]=(a-o)*l;const d=c;return t.$.cross(d,c,u),t.$.normalize(d,d),t.aw.rotationTo(e,h,d)}function W_(e,r,i=!1){const n=Qh(r.zoom),o=function(e,r,i){const n=r.worldSize,o=[e[12],e[13],e[14]],s=Ru(o[1]/n),a=Du(o[0]/n),l=t.ae.identity([]),c=Lu(1,s)*n,u=Lu(1,0)*n*ju(s,r.zoom),h=1/Yh(n);let d=u*h;if(i){const t=V_(r.projection,r.zoom,r.width,r.height,1024);d=h*r.projection.pixelSpaceConversion(r.center.lat,n,t)}const p=gu(s,a);t.$.add(p,p,t.$.scale([],t.$.normalize([],p),c*d*o[2]));const f=function(e){const r=[e[0],e[1],e[2]];let i=[0,1,0];const n=t.$.cross([],i,r);return t.$.cross(i,r,n),0===t.$.squaredLength(i)&&(i=[0,1,0],t.$.cross(n,r,i)),t.$.normalize(n,n),t.$.normalize(i,i),t.$.normalize(r,r),[n[0],n[1],n[2],0,i[0],i[1],i[2],0,r[0],r[1],r[2],0,e[0],e[1],e[2],1]}(p);t.ae.scale(l,l,[d,d,d*c]),t.ae.translate(l,l,[-o[0],-o[1],-o[2]]);const m=t.ae.multiply([],r.globeMatrix,f);return t.ae.multiply(m,m,l),t.ae.multiply(m,m,e),m}(e,r,i);if(n>0){const i=function(e,r){const i=r.worldSize,n=Lu(1,0)*i*ju(r.center.lat,r.zoom)/Yh(i),o=Lu(1,r.center.lat)*i,s=t.ae.identity([]);return t.ae.rotateY(s,s,He(r.center.lng)),t.ae.rotateX(s,s,He(r.center.lat)),t.ae.translate(s,s,[0,0,au]),t.ae.scale(s,s,[n,n,n*o]),t.ae.translate(s,s,[r.point.x-.5*i,r.point.y-.5*i,0]),t.ae.multiply(s,s,e),t.ae.multiply(s,r.globeMatrix,s)}(e,r);return function(e,r,i){const n=(e,r,i)=>{const n=t.$.length(e),o=t.$.length(r),s=jh(e,r,i);return t.$.scale(s,s,1/t.$.length(s)*qi(n,o,i))},o=n([e[0],e[1],e[2]],[r[0],r[1],r[2]],i),s=n([e[4],e[5],e[6]],[r[4],r[5],r[6]],i),a=n([e[8],e[9],e[10]],[r[8],r[9],r[10]],i),l=jh([e[12],e[13],e[14]],[r[12],r[13],r[14]],i);return[o[0],o[1],o[2],0,s[0],s[1],s[2],0,a[0],a[1],a[2],0,l[0],l[1],l[2],1]}(o,i,n)}return o}function Z_(t,e,r,i){const n=Ah.projectAabbCorners(i,r);let o=Number.MAX_VALUE,s=-1;for(let t=0;t<n.length;++t){const r=n[t];r[0]=(.5*r[0]+.5)*e.width,r[1]=(.5-.5*r[1])*e.height,r[2]<o&&(s=t,o=r[2])}const a=t=>new Ve(n[t][0],n[t][1]);let l;switch(s){case 0:case 6:l=[a(1),a(5),a(4),a(7),a(3),a(2),a(1)];break;case 1:case 7:l=[a(0),a(4),a(5),a(6),a(2),a(3),a(0)];break;case 3:case 5:l=[a(1),a(0),a(4),a(7),a(6),a(2),a(1)];break;default:l=[a(1),a(5),a(6),a(7),a(3),a(0),a(1)]}if(eh(t,l))return o}const X_=Dl([{name:"a_pos_3f",components:3,type:"Float32"}]),Y_=Dl([{name:"a_color_3f",components:3,type:"Float32"}]),K_=Dl([{name:"a_color_4f",components:4,type:"Float32"}]),J_=Dl([{name:"a_uv_2f",components:2,type:"Float32"}]),Q_=Dl([{name:"a_normal_3f",components:3,type:"Float32"}]),tb=Dl([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),eb=Dl([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class rb{constructor(t,e,r,i){this.message=(t?`${t}: `:"")+r,i&&(this.identifier=i),null!=e&&e.__line__&&(this.line=e.__line__)}}function ib(t,e){const r=-1===t.indexOf("://");try{return new URL(t,r&&e?"http://example.com":void 0),!0}catch(t){return!1}}class nb{constructor(t,e){this.feature=t,this.instancedDataOffset=e,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class ob{constructor(){this.instancedDataArray=new cc,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class sb{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.fqid)),this.projection=t.projection,this.index=t.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(t,e){}populate(t,e,r,i){this.tileToMeter=Vu(r);const n=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:o,id:s,index:a,sourceLayerIndex:l}of t){const t=null!=s?s:o.properties&&o.properties.hasOwnProperty("id")?o.properties.id:void 0,c=Ku(o,n);if(!this.layers[0]._featureFilter.filter(new Ka(this.zoom),c,r))continue;const u={id:t,sourceLayerIndex:l,index:a,geometry:n?c.geometry:Yu(o,r,i),properties:o.properties,type:o.type,patterns:{}},h=this.addFeature(u,u.geometry,c);h&&e.featureIndex.insert(o,u.geometry,a,l,this.index,this.instancesPerModel[h].instancedDataArray.length,mo/32)}this.lookup=null}update(t,e,r,i){for(const e in this.instancesPerModel){const r=this.instancesPerModel[e];for(const e in t)r.idToFeaturesIndex.hasOwnProperty(e)&&(this.evaluate(r.features[r.idToFeaturesIndex[e]],t[e],r,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let e=!1;for(const r in this.instancesPerModel){const i=this.instancesPerModel[r];for(const r of i.features){const n=this.layers[0],o=r.feature,s=this.canonical,a=n.paint.get("model-rotation").evaluate(o,{},s),l=n.paint.get("model-scale").evaluate(o,{},s),c=n.paint.get("model-translation").evaluate(o,{},s);t.$.exactEquals(r.rotation,a)&&t.$.exactEquals(r.scale,l)&&t.$.exactEquals(r.translation,c)||(this.evaluate(r,r.featureStates,i,!0),e=!0)}}return e}updateReplacement(t,e,r,i){if(e.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=e.updateTime;const n=e.getReplacementRegionsForTile(t.toUnwrapped(),!0);if(Np(this.activeReplacements,n))return!1;this.activeReplacements=n;let o=!1;for(const e in this.instancesPerModel){const n=this.instancesPerModel[e],s=n.instancedDataArray;for(const e of n.features){const n=e.instancedDataOffset,a=e.instancedDataCount;for(let e=0;e<a;e++){const a=16*(e+n);let l=s.float32[a+0];l=l>mo?l-mo:l;const c=Math.floor(l),u=s.float32[a+1];let h=!1;for(const e of this.activeReplacements)if(!Fp(e,r,af.Model,i)&&!(e.min.x>c||c>e.max.x||e.min.y>u||u>e.max.y)&&(h=qp(Hp(c,u,t.canonical,e.footprintTileId.canonical),e),h))break;s.float32[a]=h?l+mo:l,o=o||h}}}return o}isEmpty(){for(const t in this.instancesPerModel)if(0!==this.instancesPerModel[t].instancedDataArray.length)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const e in this.instancesPerModel){const r=this.instancesPerModel[e];r.instancedDataArray.length<0||0===r.instancedDataArray.length||(r.instancedDataBuffer?r.instancedDataBuffer.updateData(r.instancedDataArray):r.instancedDataBuffer=t.createVertexBuffer(r.instancedDataArray,tb.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const t in this.instancesPerModel){const e=this.instancesPerModel[t];0!==e.instancedDataArray.length&&e.instancedDataBuffer&&e.instancedDataBuffer.destroy()}const t=this.layers[0].modelManager;if(t&&this.modelUris)for(const e of this.modelUris)t.removeModel(e,"")}addFeature(t,e,r){const i=this.layers[0],n=i.layout.get("model-id").evaluate(r,{},this.canonical);if(!n)return fr(`modelId is not evaluated for layer ${i.id} and it is not going to get rendered.`),n;ib(n,!1)&&(this.modelUris.includes(n)||this.modelUris.push(n)),this.instancesPerModel[n]||(this.instancesPerModel[n]=new ob);const o=this.instancesPerModel[n],s=o.instancedDataArray,a=new nb(r,s.length);for(const t of e)for(const e of t){if(e.x<0||e.x>=mo||e.y<0||e.y>=mo)continue;const t=(this.lookupDim-1)/mo,r=this.lookupDim*(e.y*t|0)+e.x*t|0;if(this.lookup){if(0!==this.lookup[r])continue;this.lookup[r]=1}this.instanceCount++;const i=s.length;s.resize(i+1),o.instancesEvaluatedElevation.push(0),s.float32[16*i]=e.x,s.float32[16*i+1]=e.y}return a.instancedDataCount=o.instancedDataArray.length-a.instancedDataOffset,a.instancedDataCount>0&&(t.id&&(o.idToFeaturesIndex[t.id]=o.features.length),o.features.push(a),this.evaluate(a,{},o,!1)),n}getModelUris(){return this.modelUris}evaluate(t,e,r,i){const n=this.layers[0],o=t.feature,s=this.canonical,a=t.rotation=n.paint.get("model-rotation").evaluate(o,e,s),l=t.scale=n.paint.get("model-scale").evaluate(o,e,s),c=t.translation=n.paint.get("model-translation").evaluate(o,e,s),u=n.paint.get("model-color").evaluate(o,e,s);u.a=n.paint.get("model-color-mix-intensity").evaluate(o,e,s);const h=[];this.maxVerticalOffset<c[2]&&(this.maxVerticalOffset=c[2]),this.maxScale=Math.max(Math.max(this.maxScale,l[0]),Math.max(l[1],l[2])),H_(h,a,l);const d=Math.round(100*u.a)+u.b/1.05;for(let e=0;e<t.instancedDataCount;++e){const n=t.instancedDataOffset+e,o=16*n,a=r.instancedDataArray.float32;let l=0;i&&(l=a[o+6]-r.instancesEvaluatedElevation[n]);const p=0|a[o+1];a[o]=(0|a[o])+u.r/1.05,a[o+1]=p+u.g/1.05,a[o+2]=d,a[o+3]=1/(s.z>10?this.tileToMeter:Vu(s,p)),a[o+4]=c[0],a[o+5]=c[1],a[o+6]=c[2]+l,a[o+7]=h[0],a[o+8]=h[1],a[o+9]=h[2],a[o+10]=h[4],a[o+11]=h[5],a[o+12]=h[6],a[o+13]=h[8],a[o+14]=h[9],a[o+15]=h[10],r.instancesEvaluatedElevation[n]=c[2]}}}let ab,lb;Sa(sb,"ModelBucket",{omit:["layers"]}),Sa(ob,"PerModelAttributes"),Sa(nb,"ModelFeature");const cb=64,ub={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function hb(e,r,i,n,o,s,a,l,c,u=!1){const h=i.zoom,d=i.project(n),p=ju(n.lat,h),f=1/p;t.ae.identity(e),t.ae.translate(e,e,[d.x+a[0]*f,d.y+a[1]*f,a[2]]);let m=1,g=1;const y=i.worldSize;if(u){if("mercator"===i.projection.name){let e=0;i.elevation&&(e=i.elevation.getAtPointOrZero(new Uu(d.x/y,d.y/y),0));const r=t.aB.transformMat4([],[d.x,d.y,e,1],i.projMatrix)[3]/i.cameraToCenterDistance;m=r,g=r*ju(i.center.lat,h)}else if("globe"===i.projection.name){const r=W_(e,i),o=t.ae.multiply([],i.projMatrix,r),s=[0,0,0,1];t.aB.transformMat4(s,s,o);const a=s[3]/i.cameraToCenterDistance,l=Qh(h),c=i.projection.pixelsPerMeter(n.lat,y)*ju(n.lat,h),u=i.projection.pixelsPerMeter(i.center.lat,y)*ju(i.center.lat,h);m=a/qi(c,zu(i.center.lat),l),g=a*p/c,m*=u,g*=u}}else m=f;t.ae.scale(e,e,[m,m,g]);const v=[...e],_=r.orientation,b=[];if(H_(b,[_[0]+o[0],_[1]+o[1],_[2]+o[2]],s),t.ae.multiply(e,v,b),l&&i.elevation){let o=0;const s=[];if(c&&i.elevation){o=function(e,r,i,n,o){const s=r.elevation;if(!s)return 0;const a=Ah.projectAabbCorners(i,n),l=Lu(1,o.lat)*r.worldSize,c=function(e,r){const i=[0,0,1],n=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const o of n){const n=e[o.corners[0]],s=e[o.corners[1]],a=e[o.corners[2]],l=[s[0]-n[0],s[1]-n[1],r*(s[2]-n[2])],c=t.$.cross(l,l,[a[0]-n[0],a[1]-n[1],r*(a[2]-n[2])]);t.$.normalize(c,c),o.dotProductWithUp=t.$.dot(c,i)}return n.sort(((t,e)=>t.dotProductWithUp-e.dotProductWithUp)),n[0].corners}(a,l),u=a[c[0]],h=a[c[1]],d=a[c[2]],p=a[c[3]],f=s.getAtPointOrZero(new Uu(u[0]/r.worldSize,u[1]/r.worldSize),0),m=s.getAtPointOrZero(new Uu(h[0]/r.worldSize,h[1]/r.worldSize),0),g=s.getAtPointOrZero(new Uu(d[0]/r.worldSize,d[1]/r.worldSize),0),y=s.getAtPointOrZero(new Uu(p[0]/r.worldSize,p[1]/r.worldSize),0),v=(f+y)/2,_=(m+g)/2;return v>_?m<g?q_(e,h,p,u,m,y,f,l):q_(e,d,u,p,g,f,y,l):f<y?q_(e,u,h,d,f,m,g,l):q_(e,p,d,h,y,g,m,l),Math.max(v,_)}(s,i,r.aabb,e,n);const a=t.ae.fromQuat([],s),l=t.ae.multiply([],a,b);t.ae.multiply(e,v,l)}else o=i.elevation.getAtPointOrZero(new Uu(d.x/y,d.y/y),0);0!==o&&(e[14]+=o)}}function db(t,e,r=!1){t.uploaded||(t.gfxTexture=new $y(e,t.image,r?e.gl.R8:e.gl.RGBA,{useMipmap:t.sampler.minFilter>=e.gl.NEAREST_MIPMAP_NEAREST}),t.uploaded=!0,t.image=null)}function pb(t,e,r){t.indexBuffer=e.createIndexBuffer(t.indexArray,!1,!0),t.vertexBuffer=e.createVertexBuffer(t.vertexArray,X_.members,!1,!0),t.normalArray&&(t.normalBuffer=e.createVertexBuffer(t.normalArray,Q_.members,!1,!0)),t.texcoordArray&&(t.texcoordBuffer=e.createVertexBuffer(t.texcoordArray,J_.members,!1,!0)),t.colorArray&&(t.colorBuffer=e.createVertexBuffer(t.colorArray,(12===t.colorArray.bytesPerElement?Y_:K_).members,!1,!0)),t.featureArray&&(t.pbrBuffer=e.createVertexBuffer(t.featureArray,eb.members,!0)),t.segments=Ac.simpleSegment(0,0,t.vertexArray.length,t.indexArray.length);const i=t.material;i.pbrMetallicRoughness.baseColorTexture&&db(i.pbrMetallicRoughness.baseColorTexture,e),i.pbrMetallicRoughness.metallicRoughnessTexture&&db(i.pbrMetallicRoughness.metallicRoughnessTexture,e),i.normalTexture&&db(i.normalTexture,e),i.occlusionTexture&&db(i.occlusionTexture,e,r),i.emissionTexture&&db(i.emissionTexture,e)}function fb(t,e,r){if(t.meshes)for(const i of t.meshes)pb(i,e,r);if(t.children)for(const i of t.children)fb(i,e,r)}function mb(t){if(t.meshes)for(const e of t.meshes)e.indexArray.destroy(),e.vertexArray.destroy(),e.colorArray&&e.colorArray.destroy(),e.normalArray&&e.normalArray.destroy(),e.texcoordArray&&e.texcoordArray.destroy(),e.featureArray&&e.featureArray.destroy();if(t.children)for(const e of t.children)mb(e)}function gb(t){if(t.meshes)for(const r of t.meshes)r.vertexBuffer&&(r.vertexBuffer.destroy(),r.indexBuffer.destroy(),r.normalBuffer&&r.normalBuffer.destroy(),r.texcoordBuffer&&r.texcoordBuffer.destroy(),r.colorBuffer&&r.colorBuffer.destroy(),r.pbrBuffer&&r.pbrBuffer.destroy(),r.segments.destroy(),r.material&&((e=r.material).pbrMetallicRoughness.baseColorTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),e.pbrMetallicRoughness.metallicRoughnessTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),e.normalTexture&&e.normalTexture.gfxTexture&&e.normalTexture.gfxTexture.destroy(),e.emissionTexture&&e.emissionTexture.gfxTexture&&e.emissionTexture.gfxTexture.destroy(),e.occlusionTexture&&e.occlusionTexture.gfxTexture&&e.occlusionTexture.gfxTexture.destroy()));var e;if(t.children)for(const e of t.children)gb(e)}class yb{constructor(t){this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class vb{constructor(){this.tasks={},this.taskQueue=[],lr(["process"],this),this.invoker=new yb(this.process),this.nextId=0}add(t,e){const r=this.nextId++,i=function({type:t,isSymbolTile:e,zoom:r}){return r=r||0,"message"===t?0:"maybePrepare"!==t||e?"parseTile"!==t||e?"parseTile"===t&&e?300-r:"maybePrepare"===t&&e?400-r:500:200-r:100-r}(e);if(0===i){try{t()}finally{}return null}return this.tasks[r]={fn:t,metadata:e,priority:i,id:r},this.taskQueue.push(r),this.invoker.trigger(),{cancel:()=>{delete this.tasks[r]}}}process(){try{if(this.taskQueue=this.taskQueue.filter((t=>!!this.tasks[t])),!this.taskQueue.length)return;const t=this.pick();if(null===t)return;const e=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!e)return;e.fn()}finally{}}pick(){let t=null,e=1/0;for(let r=0;r<this.taskQueue.length;r++){const i=this.tasks[this.taskQueue[r]];i.priority<e&&(e=i.priority,t=r)}if(null===t)return null;const r=this.taskQueue[t];return this.taskQueue.splice(t,1),r}remove(){this.invoker.remove()}}class _b{constructor(t,e,r){this.target=t,this.parent=e,this.mapId=r,this.callbacks={},this.cancelCallbacks={},lr(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new vb}send(t,e,r,i,n=!1,o){const s=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(r.metadata=o,this.callbacks[s]=r);const a=new Set;return this.target.postMessage({id:s,type:t,hasCallback:!!r,targetMapId:i,mustQueue:n,sourceMapId:this.mapId,data:Aa(e,a)},a),{cancel:()=>{r&&delete this.callbacks[s],this.target.postMessage({id:s,type:"<cancel>",targetMapId:i,sourceMapId:this.mapId})}}}receive(t){const e=t.data,r=e.id;if(r&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const t=this.cancelCallbacks[r];delete this.cancelCallbacks[r],t&&t.cancel()}else if(e.mustQueue||vr()){const t=this.callbacks[r],i=this.scheduler.add((()=>this.processTask(r,e)),t&&t.metadata||{type:"message"});i&&(this.cancelCallbacks[r]=i)}else this.processTask(r,e)}processTask(t,e){if(delete this.cancelCallbacks[t],"<response>"===e.type){const r=this.callbacks[t];delete this.callbacks[t],r&&(e.error?r(Ma(e.error)):r(null,Ma(e.data)))}else{const r=new Set,i=e.hasCallback?(e,i)=>{this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:e?Aa(e):null,data:Aa(i,r)},r)}:t=>{},n=Ma(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,n,i);else if(this.parent.getWorkerSource){const t=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,t[0],n.source,n.scope)[t[1]](n,i)}else i(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class bb{constructor(t,e){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=nr();const r=this.workerPool.acquire(this.id);for(let t=0;t<r.length;t++){const i=new bb.Actor(r[t],e,this.id);i.name=`Worker ${t}`,this.actors.push(i)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(t,e,r){tr(this.actors,((r,i)=>{r.send(t,e,i)}),r=r||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((t=>{t.remove()})),this.actors=[],this.workerPool.release(this.id)}}bb.Actor=_b;var xb={workerUrl:"",workerClass:null,workerParams:void 0};function wb(){return null!=xb.workerClass?new xb.workerClass:new self.Worker(xb.workerUrl,xb.workerParams)}const Tb="mapboxgl_preloaded_worker_pool";class Eb{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Eb.workerCount;)this.workers.push(new wb);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&0===this.numActive()&&(this.workers.forEach((t=>{t.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Tb]}numActive(){return Object.keys(this.active).length}}let Sb;function Pb(){return Sb||(Sb=new Eb),Sb}Eb.workerCount=2;let kb,Ab,Mb,Cb,Ib,Ob=null;function Lb(){return vr()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:Ab||i.DRACO_URL}function Db(){if(vr()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Cb)return Cb;const t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if("object"!=typeof WebAssembly)throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Cb=WebAssembly.validate(t)?i.MESHOPT_SIMD_URL:i.MESHOPT_URL,Cb}const Rb={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Fb={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Bb={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function zb(t,e,r){const i=r.json.bufferViews.length,n=r.buffers.length;e.bufferView=i,r.json.bufferViews[i]={buffer:n,byteLength:t.byteLength},r.buffers[n]=t}const jb="KHR_draco_mesh_compression";function Nb(t,e){const r=t.extensions&&t.extensions[jb];if(!r)return;const i=new Mb.Decoder,n=Wb(e,r.bufferView),o=new Mb.Mesh;if(!i.DecodeArrayToMesh(n,n.byteLength,o))throw new Error("Failed to decode Draco mesh");const s=e.json.accessors[t.indices],a=Rb[s.componentType],l=s.count*a.BYTES_PER_ELEMENT,c=Mb._malloc(l);a===Uint16Array?i.GetTrianglesUInt16Array(o,l,c):i.GetTrianglesUInt32Array(o,l,c),zb(Mb.memory.buffer.slice(c,c+l),s,e),Mb._free(c);for(const n of Object.keys(r.attributes)){const s=i.GetAttributeByUniqueId(o,r.attributes[n]),a=e.json.accessors[t.attributes[n]],l=Fb[a.componentType],c=a.count*Bb[a.type]*Rb[a.componentType].BYTES_PER_ELEMENT,u=Mb._malloc(c);i.GetAttributeDataArrayForAllPoints(o,s,Mb[l],c,u),zb(Mb.memory.buffer.slice(u,u+c),a,e),Mb._free(u)}i.destroy(),o.destroy(),delete t.extensions[jb]}const Vb="EXT_meshopt_compression";function Ub(t,e){if(!t.extensions||!t.extensions[Vb])return;const r=t.extensions[Vb],i=new Uint8Array(e.buffers[r.buffer],r.byteOffset||0,r.byteLength||0),n=new Uint8Array(r.count*r.byteStride);Ib.decodeGltfBuffer(n,r.count,r.byteStride,i,r.mode,r.filter),t.buffer=e.buffers.length,t.byteOffset=0,e.buffers[t.buffer]=n.buffer,delete t.extensions[Vb]}const $b=1179937895,Gb=new TextDecoder("utf8");function Hb(t,e){return new URL(t,e).href}function qb(t,e,r,i){return fetch(Hb(t.uri,i)).then((t=>t.arrayBuffer())).then((t=>{e.buffers[r]=t}))}function Wb(t,e){const r=t.json.bufferViews[e];return new Uint8Array(t.buffers[r.buffer],r.byteOffset||0,r.byteLength)}function Zb(t,e,r,i){if(t.uri){const n=Hb(t.uri,i);return fetch(n).then((t=>t.blob())).then((t=>createImageBitmap(t))).then((t=>{e.images[r]=t}))}if(void 0!==t.bufferView){const i=Wb(e,t.bufferView),n=new Blob([i],{type:t.mimeType});return createImageBitmap(n).then((t=>{e.images[r]=t}))}}function Xb(t,e=0,r){const i={json:null,images:[],buffers:[]};if(new Uint32Array(t,e,1)[0]===$b){const r=new Uint32Array(t,e);let n=2;const o=(r[n++]>>2)-3,s=r[n++]>>2;if(n++,i.json=JSON.parse(Gb.decode(r.subarray(n,n+s))),n+=s,n<o){const o=r[n++];n++;const s=e+(n<<2);i.buffers[0]=t.slice(s,s+o)}}else i.json=JSON.parse(Gb.decode(new Uint8Array(t,e)));const{buffers:n,images:o,meshes:s,extensionsUsed:a,bufferViews:l}=i.json;let c=Promise.resolve();if(n){const t=[];for(let e=0;e<n.length;e++){const o=n[e];o.uri?t.push(qb(o,i,e,r)):i.buffers[e]||(i.buffers[e]=null)}c=Promise.all(t)}return c.then((()=>{const t=[],e=a&&a.includes(jb),n=a&&a.includes(Vb);if(e&&t.push(function(){if(!Mb)return kb||(kb=function(t){let e,r=null;function i(){e=new Uint8Array(r.buffer)}function n(){throw new Error("Unexpected Draco error.")}const o={a:{a:n,d:function(t,r,i){return e.copyWithin(t,r,r+i)},c:function(t){const n=e.length,o=Math.max(t>>>0,Math.ceil(1.2*n)),s=Math.ceil((o-n)/65536);try{return r.grow(s),i(),!0}catch(t){return!1}},b:n}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(t,o):t.then((t=>t.arrayBuffer())).then((t=>WebAssembly.instantiate(t,o)))).then((t=>{const{Rb:n,Qb:o,P:s,T:a,X:l,Ja:c,La:u,Qa:h,Va:d,Wa:p,eb:f,jb:m,f:g,e:y,yb:v,zb:_,Ab:b,Bb:x,Db:w,Gb:T}=t.instance.exports;r=y;const E=(()=>{let t=0,r=0,i=0,s=0;return a=>{i&&(n(s),n(t),r+=i,i=t=0),t||(r+=128,t=o(r));const l=a.length+7&-8;let c=t;l>=r&&(i=l,c=s=o(l));for(let t=0;t<a.length;t++)e[c+t]=a[t];return c}})();return i(),g(),{memory:y,_free:n,_malloc:o,Mesh:class{constructor(){this.ptr=s()}destroy(){a(this.ptr)}},Decoder:class{constructor(){this.ptr=c()}destroy(){m(this.ptr)}DecodeArrayToMesh(t,e,r){const i=E(t),n=u(this.ptr,i,e,r.ptr);return!!l(n)}GetAttributeByUniqueId(t,e){return{ptr:h(this.ptr,t.ptr,e)}}GetTrianglesUInt16Array(t,e,r){d(this.ptr,t.ptr,e,r)}GetTrianglesUInt32Array(t,e,r){p(this.ptr,t.ptr,e,r)}GetAttributeDataArrayForAllPoints(t,e,r,i,n){f(this.ptr,t.ptr,e.ptr,r,i,n)}},DT_INT8:v(),DT_UINT8:_(),DT_INT16:b(),DT_UINT16:x(),DT_UINT32:w(),DT_FLOAT32:T()}}))}(fetch(Lb())),kb.then((t=>{Mb=t,kb=void 0})))}()),n&&t.push(function(){if(Ib)return;const t=function(t){let e;const r=WebAssembly.instantiateStreaming(t,{}).then((t=>{e=t.instance,e.exports.__wasm_call_ctors()})),i={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},n={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:r,supported:!0,decodeGltfBuffer(t,r,o,s,a,l){!function(t,e,r,i,n,o,s){const a=t.exports.sbrk,l=i+3&-4,c=a(l*n),u=a(o.length),h=new Uint8Array(t.exports.memory.buffer);h.set(o,u);const d=e(c,i,n,u,o.length);if(0===d&&s&&s(c,l,n),r.set(h.subarray(c,c+i*n)),a(c-a(0)),0!==d)throw new Error(`Malformed buffer data: ${d}`)}(e,e.exports[n[a]],t,r,o,s,e.exports[i[l]])}}}(fetch(Db()));return t.ready.then((()=>{Ib=t}))}()),o)for(let e=0;e<o.length;e++)t.push(Zb(o[e],i,e,r));return(t.length?Promise.all(t):Promise.resolve()).then((()=>{if(e&&s)for(const{primitives:t}of s)for(const e of t)Nb(e,i);if(n&&s&&l)for(const t of l)Ub(t,i);return i}))}))}function Yb(t,e){const r=t.json.bufferViews[e.bufferView],i=Rb[e.componentType];return new i(t.buffers[r.buffer],(e.byteOffset||0)+(r.byteOffset||0),e.count*(r.byteStride&&r.byteStride!==Bb[e.type]*i.BYTES_PER_ELEMENT?r.byteStride/i.BYTES_PER_ELEMENT:Bb[e.type]))}function Kb(t,e,r,i){const n=Rb[e.componentType],o=function(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(n),s=t.json.bufferViews[e.bufferView],a=s.byteStride?s.byteStride/n.BYTES_PER_ELEMENT:Bb[e.type],l=r.float32,c=l.length/r.capacity;for(let t=0,r=0;t<e.count*a;t+=a,r+=c)for(let e=0;e<c;e++)l[r+e]=i[t+e]*o;r._trim()}function Jb(t,e,r){const i=t.indices,n=t.attributes,o={};o.indexArray=new tc;const s=e.json.accessors[i],a=s.count/3;o.indexArray.reserve(a);const l=Yb(e,s);for(let t=0;t<a;t++)o.indexArray.emplaceBack(l[3*t],l[3*t+1],l[3*t+2]);o.indexArray._trim(),o.vertexArray=new Ul;const c=e.json.accessors[n.POSITION];o.vertexArray.reserve(c.count);const u=Yb(e,c);for(let t=0;t<c.count;t++)o.vertexArray.emplaceBack(u[3*t],u[3*t+1],u[3*t+2]);if(o.vertexArray._trim(),o.aabb=new Ah(c.min,c.max),o.centroid=function(t,e){const r=[0,0,0],i=t.length;if(i>0){for(let n=0;n<i;n++){const i=3*t[n];r[0]+=e[i],r[1]+=e[i+1],r[2]+=e[i+2]}r[0]/=i,r[1]/=i,r[2]/=i}return r}(l,u),void 0!==n.COLOR_0){const t=e.json.accessors[n.COLOR_0],r=Bb[t.type],i=Yb(e,t);o.colorArray=3===r?new Ul:new Vl,o.colorArray.resize(t.count),Kb(e,t,o.colorArray,i)}if(void 0!==n.NORMAL){o.normalArray=new Ul;const t=e.json.accessors[n.NORMAL];o.normalArray.resize(t.count);const r=Yb(e,t);Kb(e,t,o.normalArray,r)}if(void 0!==n.TEXCOORD_0&&r.length>0){o.texcoordArray=new lc;const t=e.json.accessors[n.TEXCOORD_0];o.texcoordArray.resize(t.count);const r=Yb(e,t);Kb(e,t,o.texcoordArray,r)}if(void 0!==n._FEATURE_ID_RGBA4444){const t=e.json.accessors[n._FEATURE_ID_RGBA4444];e.json.extensionsUsed&&e.json.extensionsUsed.includes("EXT_meshopt_compression")&&(o.featureData=Yb(e,t))}void 0!==n._FEATURE_RGBA4444&&(o.featureData=new Uint32Array(Yb(e,e.json.accessors[n._FEATURE_RGBA4444]).buffer));const h=t.material;return o.material=function(t,e){const{emissiveFactor:r=[0,0,0],alphaMode:i="OPAQUE",alphaCutoff:n=.5,normalTexture:o,occlusionTexture:s,emissiveTexture:a,doubleSided:l}=t,{baseColorFactor:c=[1,1,1,1],metallicFactor:u=1,roughnessFactor:h=1,baseColorTexture:d,metallicRoughnessTexture:p}=t.pbrMetallicRoughness||{},f=s?e[s.index]:void 0;if(s&&s.extensions&&s.extensions.KHR_texture_transform&&f){const t=s.extensions.KHR_texture_transform;f.offsetScale=[t.offset[0],t.offset[1],t.scale[0],t.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Gi(...c),metallicFactor:u,roughnessFactor:h,baseColorTexture:d?e[d.index]:void 0,metallicRoughnessTexture:p?e[p.index]:void 0},doubleSided:l,emissiveFactor:r,alphaMode:i,alphaCutoff:n,normalTexture:o?e[o.index]:void 0,occlusionTexture:f,emissionTexture:a?e[a.index]:void 0,defined:void 0===t.defined}}(void 0!==h?e.json.materials[h]:{defined:!1},r),o}function Qb(e,r,i){const{matrix:n,rotation:o,translation:s,scale:a,mesh:l,extras:c,children:u}=e,h={};if(h.matrix=n||t.ae.fromRotationTranslationScale([],o||[0,0,0,1],s||[0,0,0],a||[1,1,1]),void 0!==l){h.meshes=i[l];const t=h.anchor=[0,0];for(const e of h.meshes){const{min:r,max:i}=e.aabb;t[0]+=r[0]+i[0],t[1]+=r[1]+i[1]}t[0]=Math.floor(t[0]/h.meshes.length/2),t[1]=Math.floor(t[1]/h.meshes.length/2)}if(c&&(c.id&&(h.id=c.id),c.lights&&(h.lights=function(t){if(!t.length)return[];const e=function(t){const e=atob(t),r=new Uint8Array(e.length);for(let t=0;t<e.length;t++)r[t]=e.codePointAt(t);return r}(t),r=[],i=e.length/24,n=new Uint16Array(e.buffer),o=new Float32Array(e.buffer);for(let t=0;t<i;t++){const e=n[2*t*6]/30,i=n[2*t*6+1]/30,s=n[2*t*6+10]/100,a=o[6*t+1],l=o[6*t+2],c=o[6*t+3],u=o[6*t+4],h=c-a,d=u-l,p=Math.hypot(h,d);r.push({pos:[a+.5*h,l+.5*d,i],normal:[d/p,-h/p,0],width:p,height:e,depth:s,points:[a,l,c,u]})}return r}(c.lights))),u){const t=[];for(const e of u)t.push(Qb(r.json.nodes[e],r,i));h.children=t}return h}function tx(t){if(0===t.vertices.length||0===t.indices.length)return null;const e=new sp(t.vertices,t.indices,8,256),[r,i]=[e.min.clone(),e.max.clone()];return{vertices:t.vertices,indices:t.indices,grid:e,min:r,max:i}}function ex(t){if(!t.extras||!t.extras.ground)return null;const e=t.extras.ground;if(!e||!Array.isArray(e)||0===e.length)return null;const r=e[0];if(!r||!Array.isArray(r)||0===r.length)return null;const i=[];for(const t of r){if(!Array.isArray(t)||2!==t.length)continue;const e=t[0],r=t[1];"number"==typeof e&&"number"==typeof r&&i.push(new Ve(e,r))}if(i.length<3)return null;i.length>1&&i[i.length-1].equals(i[0])&&i.pop();let n=0;for(let t=0;t<i.length;t++){const e=i[t],r=i[(t+1)%i.length],o=i[(t+2)%i.length];n+=(e.x-r.x)*(o.y-r.y)-(o.x-r.x)*(e.y-r.y)}n>0&&i.reverse();const o=Pd(i.flatMap((t=>[t.x,t.y])),[]);return 0===o.length?null:{vertices:i,indices:o}}function rx(e,r){const i=[],n=[];let o=0;const s=[];for(const a of e){o=i.length;const e=a.vertexArray.float32,l=a.indexArray.uint16;for(let n=0;n<a.vertexArray.length;n++)s[0]=e[3*n+0],s[1]=e[3*n+1],s[2]=e[3*n+2],t.$.transformMat4(s,s,r),i.push(new Ve(s[0],s[1]));for(let t=0;t<3*a.indexArray.length;t++)n.push(l[t]+o)}if(n.length%3!=0)return null;for(let t=0;t<n.length;t+=3){const e=i[n[t+0]],r=i[n[t+1]],o=i[n[t+2]];(e.x-r.x)*(o.y-r.y)-(o.x-r.x)*(e.y-r.y)>0&&([n[t+1],n[t+2]]=[n[t+2],n[t+1]])}return{vertices:i,indices:n}}function ix(t){const e=function(t,e){const r=[],i=WebGL2RenderingContext;if(t.json.textures)for(const n of t.json.textures){const o={magFilter:i.LINEAR,minFilter:i.NEAREST,wrapS:i.REPEAT,wrapT:i.REPEAT};void 0!==n.sampler&&Object.assign(o,t.json.samplers[n.sampler]),r.push({image:e[n.source],sampler:o,uploaded:!1})}return r}(t,t.images),r=function(t,e){const r=[];for(const i of t.json.meshes){const n=[];for(const r of i.primitives)n.push(Jb(r,t,e));r.push(n)}return r}(t,e),{scenes:i,scene:n,nodes:o}=t.json,s=i?i[n||0].nodes:o,a=[];for(const e of s)a.push(Qb(o[e],t,r));return function(t,e,r){const i={},n=new Set;for(let o=0;o<t.length;o++){const t=r[e[o]];if(!t.extras)continue;const s=t.extras["mapbox:footprint:version"],a=t.extras["mapbox:footprint:id"];(s||a)&&n.add(o),"1.0.0"===s&&a&&(i[a]=o)}for(let o=0;o<t.length;o++){if(n.has(o))continue;const s=t[o],a=r[e[o]];if(!a.extras)continue;let l=null;s.id in i&&(l=rx(t[i[s.id]].meshes,s.matrix)),l||(l=ex(a)),l&&(s.footprint=tx(l))}if(n.size>0){const e=Array.from(n.values()).sort(((t,e)=>t-e));for(let r=e.length-1;r>=0;r--)t.splice(e[r],1)}}(a,s,t.json.nodes),a}function nx(t){t.heightmap=new Float32Array(4096),t.heightmap.fill(-1);const e=t.vertexArray.float32,r=t.aabb.min[0]-1,i=t.aabb.min[1]-1,n=cb/(t.aabb.max[0]-r+2),o=cb/(t.aabb.max[1]-i+2);for(let s=0;s<e.length;s+=3){const a=e[s+2],l=(e[s+0]-r)*n|0,c=(e[s+1]-i)*o|0;a>t.heightmap[c*cb+l]&&(t.heightmap[c*cb+l]=a)}}function ox(e,r){const i={};i.indexArray=new tc,i.indexArray.reserve(4*e.length),i.vertexArray=new Ul,i.vertexArray.reserve(10*e.length),i.colorArray=new Vl,i.vertexArray.reserve(10*e.length);let n=0;for(const o of e){const e=Math.min(10,Math.max(4,1.3*o.height))*r,s=[-o.normal[1],o.normal[0],0],a=Math.min(.29,.1*o.width/o.depth),l=o.width-2*o.depth*r*(a+.01),c=t.$.scaleAndAdd([],o.pos,s,l/2),u=t.$.scaleAndAdd([],o.pos,s,-l/2),h=[c[0],c[1],c[2]+o.height],d=[u[0],u[1],u[2]+o.height],p=t.$.scaleAndAdd([],o.normal,s,a);t.$.scale(p,p,e);const f=t.$.scaleAndAdd([],o.normal,s,-a);t.$.scale(f,f,e),t.$.add(p,c,p),t.$.add(f,u,f),c[2]+=.1,u[2]+=.1,i.vertexArray.emplaceBack(p[0],p[1],p[2]),i.vertexArray.emplaceBack(f[0],f[1],f[2]),i.vertexArray.emplaceBack(c[0],c[1],c[2]),i.vertexArray.emplaceBack(u[0],u[1],u[2]),i.vertexArray.emplaceBack(h[0],h[1],h[2]),i.vertexArray.emplaceBack(d[0],d[1],d[2]),i.vertexArray.emplaceBack(c[0],c[1],c[2]),i.vertexArray.emplaceBack(u[0],u[1],u[2]),i.vertexArray.emplaceBack(p[0],p[1],p[2]),i.vertexArray.emplaceBack(f[0],f[1],f[2]);const m=l/e/2;i.colorArray.emplaceBack(-m-a,-1,m,.8),i.colorArray.emplaceBack(m+a,-1,m,.8),i.colorArray.emplaceBack(-m,0,m,1.3),i.colorArray.emplaceBack(m,0,m,1.3),i.colorArray.emplaceBack(m+a,-.8,m,.7),i.colorArray.emplaceBack(m+a,-.8,m,.7),i.colorArray.emplaceBack(0,0,m,1.3),i.colorArray.emplaceBack(0,0,m,1.3),i.colorArray.emplaceBack(m+a,-1.2,m,.8),i.colorArray.emplaceBack(m+a,-1.2,m,.8),i.indexArray.emplaceBack(6+n,4+n,8+n),i.indexArray.emplaceBack(7+n,9+n,5+n),i.indexArray.emplaceBack(0+n,1+n,2+n),i.indexArray.emplaceBack(1+n,3+n,2+n),n+=10}const o={defined:!0,emissiveFactor:[0,0,0]},s={};return s.baseColorFactor=Gi.white,o.pbrMetallicRoughness=s,i.material=o,i.aabb=new Ah([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),i}const sx=new Float32Array(262144),ax=new Uint8Array(262144);function lx(t){let e=0;if(t.meshes)for(const r of t.meshes)e=Math.max(e,r.aabb.max[2]);if(t.children)for(const r of t.children)e=Math.max(e,lx(r));return e}function cx(t,e,r){if(t.meshes)for(const i of t.meshes)i.aabb.min[0]!==1/0&&r.insert(e,i.aabb.min[0],i.aabb.min[1],i.aabb.max[0],i.aabb.max[1]);if(t.children)for(const i of t.children)cx(i,e,r)}const ux=["","wall","door","roof","window","lamp","logo"];class hx{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:t.id,geometry:[],properties:{height:lx(t)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new Ah([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let t=0;const e=new Ah([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const r of this.node.meshes)this.node.lightMeshIndex!==t&&(r.transformedAabb=Ah.applyTransformFast(r.aabb,this.node.matrix),e.encapsulate(r.transformedAabb)),t++;this.aabb=e}return this.aabb}}class dx{constructor(t,e,r,i,n,o){this.id=e,this.modelTraits|=ub.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,r&&(this.modelTraits|=ub.HasMapboxMeshFeatures),i&&(this.modelTraits|=ub.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=n,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const e of t)this.nodesInfo.push(new hx(e)),cx(e,o.featureIndexArray.length,o.grid),o.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,o.bucketLayerIDs.length-1,0)}updateFootprints(t,e){for(const r of this.getNodesInfo()){const i=r.node;i.footprint&&e.push({footprint:i.footprint,id:t})}}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const e=this.getNodesInfo();for(const r of e){const e=r.node;this.uploaded?this.updatePbrBuffer(e):fb(e,t,!0)}for(const t of e)mb(t.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let e=!1;if(!t.meshes)return e;for(const r of t.meshes)r.pbrBuffer&&(r.pbrBuffer.updateData(r.featureArray),e=!0);return e}needsReEvaluation(t,e,r){const i=t.transform.projectionOptions,n=t.style.getBrightness(),o=this.brightness!==n;return!!(!this.uploaded||this.dirty||i.name!==this.projection.name||px(r.paint.get("model-color").value,o)||px(r.paint.get("model-color-mix-intensity").value,o)||px(r.paint.get("model-roughness").value,o)||px(r.paint.get("model-emissive-strength").value,o)||px(r.paint.get("model-height-based-emissive-strength-multiplier").value,o))&&(this.projection=i,this.brightness=n,!0)}evaluateScale(t,e){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const r=this.getNodesInfo(),i=this.id.canonical;for(const t of r){const r=t.feature;t.evaluatedScale=e.paint.get("model-scale").evaluate(r,{},i)}}evaluate(t){const e=this.getNodesInfo();for(const r of e){if(!r.node.meshes)continue;const e=r.feature,i=r.node.meshes&&r.node.meshes[0].featureData,n=r.evaluatedColor[2],o=r.evaluatedRMEA[2],s=this.id.canonical;if(r.hasTranslucentParts=!1,i){for(let i=0;i<ux.length;i++){const n=ux[i];n.length&&(e.properties.part=n);const o=t.paint.get("model-color").evaluate(e,{},s).toRenderColor(null),a=t.paint.get("model-color-mix-intensity").evaluate(e,{},s);r.evaluatedColor[i]=[o.r,o.g,o.b,a],r.evaluatedRMEA[i][0]=t.paint.get("model-roughness").evaluate(e,{},s),r.evaluatedRMEA[i][2]=t.paint.get("model-emissive-strength").evaluate(e,{},s),r.evaluatedRMEA[i][3]=o.a,r.emissionHeightBasedParams[i]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(e,{},s),!r.hasTranslucentParts&&o.a<1&&(r.hasTranslucentParts=!0)}delete e.properties.part,mx(r,n!==r.evaluatedColor[2]||o!==r.evaluatedRMEA[2],this.modelTraits)}else r.evaluatedRMEA[0][2]=t.paint.get("model-emissive-strength").evaluate(e,{},s);r.evaluatedScale=t.paint.get("model-scale").evaluate(e,{},s),this.updatePbrBuffer(r.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,e,r,i){const n=t.findDEMTileFor(r);if(n&&(n.tileID.canonical!==this.terrainTile||e!==this.terrainExaggeration)){if(n.dem&&n.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=n.tileID.overscaledZ;const e=sf.create(t,r,n);if(!e)return;this.modelTraits&ub.HasMapboxMeshFeatures&&this.updateDEM(t,e,r,i);for(const t of this.getNodesInfo()){const r=t.node;if(!r.footprint||!r.footprint.vertices||!r.footprint.vertices.length)continue;const i=r.footprint.vertices;let n=e.getElevationAt(i[0].x,i[0].y,!0,!0);for(let t=1;t<i.length;t++)n=Math.min(n,e.getElevationAt(i[t].x,i[t].y,!0,!0));r.elevation=n}}this.terrainTile=n.tileID.canonical,this.terrainExaggeration=e}}updateDEM(t,e,r,i){let n=e._dem._modifiedForSources[i];if(void 0===n&&(e._dem._modifiedForSources[i]=[],n=e._dem._modifiedForSources[i]),n.includes(r.canonical))return;const o=e._dem.dim;n.push(r.canonical);let s=!1;for(const t of this.getNodesInfo()){const r=t.node;if(!r.footprint||!r.footprint.grid)continue;const i=r.footprint.grid,n=e.tileCoordToPixel(i.min.x,i.min.y),a=e.tileCoordToPixel(i.max.x,i.max.y),l=Math.min(Math.min(o-a.y,n.x),Math.min(n.y,o-a.x));if(l<0)continue;const c=Ke(l,2,5);let u=Math.max(0,n.x-c),h=Math.max(0,n.y-c),d=Math.min(a.x+c,o-1),p=Math.min(a.y+c,o-1);for(let t=h;t<=p;++t)for(let e=u;e<=d;++e)ax[t*o+e]=255;let f=0,m=0;for(let t=0;t<i.cellsY;++t)for(let r=0;r<i.cellsX;++r){if(!i.cells[t*i.cellsX+r])continue;const n=e.tileCoordToPixel(i.min.x+r/i.xScale,i.min.y+t/i.yScale),s=e.tileCoordToPixel(i.min.x+(r+1)/i.xScale,i.min.y+(t+1)/i.yScale);for(let t=n.y;t<=Math.min(s.y+1,o-1);++t)for(let r=n.x;r<=Math.min(s.x+1,o-1);++r)255===ax[t*o+r]&&(ax[t*o+r]=0,f+=e.getElevationAtPixel(r,t),m++)}const g=f/m;u=Math.max(1,n.x-c),h=Math.max(1,n.y-c),d=Math.min(a.x+c,o-2),p=Math.min(a.y+c,o-2),s=!0;for(let t=h;t<=p;++t)for(let r=u;r<=d;++r)0===ax[t*o+r]&&(sx[t*o+r]=e._dem.set(r,t,g));for(let t=1;t<c;++t){u=Math.max(1,n.x-t),h=Math.max(1,n.y-t),d=Math.min(a.x+t,o-2),p=Math.min(a.y+t,o-2);for(let r=h;r<=p;++r)for(let i=u;i<=d;++i){const n=r*o+i;if(255===ax[n]){let s=0,a=0,l=-1,u=-1;for(let e=-1;e<=1;++e)for(let n=-1;n<=1;++n){const c=(r+e)*o+i+n;if(ax[c]>=t)continue;const h=sx[c],d=Math.abs(h);d>a&&(s=h,a=d,l=n,u=e)}if(a>.1){const o=1-(t+.5*Math.abs(l*u))/c;let a=e._dem.get(i,r)+s*o;const h=e._dem.get(i+l,r+u),d=e._dem.get(i-l,r-u,!0);(a-h)*(a-d)>0&&(a=(h+d)/2),sx[n]=e._dem.set(i,r,a),ax[n]=t}}}}}s&&(e._demTile.needsDEMTextureUpload=!0,e._dem._timestamp=Dr.now())}getNodesInfo(){return this.nodesInfo}destroy(){const t=this.getNodesInfo();for(const e of t)mb(e.node),gb(e.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(t,e){if(e.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=e.updateTime;const r=e.getReplacementRegionsForTile(t.toUnwrapped()),i=this.getNodesInfo();for(let t=0;t<this.nodesInfo.length;t++){const e=i[t].node;i[t].hiddenByReplacement=!!e.footprint&&!r.find((t=>t.footprint===e.footprint))}}getHeightAtTileCoord(e,r){const i=this.getNodesInfo(),n=[],o=[0,0,0],s=t.ae.identity([]);for(let a=0;a<this.nodesInfo.length;a++){const l=i[a],c=l.node.meshes[0],u=c.transformedAabb;if(e<u.min[0]||r<u.min[1]||e>u.max[0]||r>u.max[1])continue;if(!0===l.node.hidden)return{height:0,maxHeight:l.feature.properties.height,hidden:!1,verticalScale:l.evaluatedScale[2]};t.ae.invert(s,l.node.matrix),o[0]=e,o[1]=r,t.$.transformMat4(o,o,s);const h=(o[0]-c.aabb.min[0])/(c.aabb.max[0]-c.aabb.min[0])*cb|0,d=Math.min(63,(o[1]-c.aabb.min[1])/(c.aabb.max[1]-c.aabb.min[1])*cb|0)*cb+Math.min(63,h),p=c.heightmap[d];if(!(p<0&&l.node.footprint)){if(l.hiddenByReplacement)return;return{height:p,maxHeight:l.feature.properties.height,hidden:!1,verticalScale:l.evaluatedScale[2]}}if(l.node.footprint.grid.query(new Ve(e,r),new Ve(e,r),n),n.length>0)return{height:void 0,maxHeight:l.feature.properties.height,hidden:l.hiddenByReplacement,verticalScale:l.evaluatedScale[2]}}}}function px(t,e){return!t.isLightConstant&&e}function fx(t,e,r,i,n,o,s,a){let l=(61440&e|(61440&e)>>4)>>8,c=(3840&e|(3840&e)>>4)>>4,u=240&e|(240&e)>>4;r[3]>0&&(l=qi(l,255*r[0],r[3]),c=qi(c,255*r[1],r[3]),u=qi(u,255*r[2],r[3]));const h=l<<8|c,d=u<<8|Math.floor(255*i[3]),p=function(t){const e=Ke(t,0,2);return Math.min(Math.round(.5*e*255),255)}(i[2])<<8|15*i[0]<<4|15*i[1],f=Ke(n[0],0,1),m=Ke(n[1],0,1),g=Ke(n[2],0,1),y=Ke(n[3],0,1);let v,_,b,x;if(f!==m&&s!==o&&m!==f){const t=s-o;_=1/(t*(m-f)),b=-(o+t*f)/(t*(m-f));const e=Ke(n[4],-1,1);x=Math.pow(10,e),v=255*g<<8|255*y}else v=65535,_=0,b=1,x=1;if(t.emplaceBack(h,d,p,v,_,b,x),a){const t=a.length;a.clear();for(let e=0;e<t;e++)a.emplaceBack(h,d,p,v,_,b,x)}}function mx(t,e,r){const i=t.node;let n=0;const o=r&ub.HasMeshoptCompression;for(const r of i.meshes){if(i.lights&&i.lightMeshIndex===n)continue;if(!r.featureData)continue;r.featureArray=new uc,r.featureArray.reserve(r.featureData.length);let s=e;for(const e of r.featureData){const n=o?65535&e:e>>16&65535,a=o?e>>16&65535:65535&e,l=(15&a)<8?15&a:0,c=t.evaluatedRMEA[l],u=t.evaluatedColor[l],h=t.emissionHeightBasedParams[l];let d;if(s&&2===l&&i.lights&&(d=new uc,d.resize(10*i.lights.length)),fx(r.featureArray,n,u,c,h,r.aabb.min[2],r.aabb.max[2],d),d&&s){s=!1;const t=i.meshes[i.lightMeshIndex];t.featureArray=d,t.featureArray._trim()}}r.featureArray._trim(),n++}}function gx(t,e,r,i){const n=1<<t.z;e.lat=Ru((i/mo+t.y)/n),e.lng=Du((r/mo+t.x)/n)}Sa(dx,"Tiled3dModelBucket",{omit:["layers"]}),Sa(hx,"Tiled3dModelFeature");const yx={circle:class extends Cl{constructor(t,e,r,i){super(t,{layout:_h||(_h=new cl({"circle-sort-key":new al(ul.layout_circle["circle-sort-key"]),visibility:new sl(ul.layout_circle.visibility)})),paint:bh||(bh=new cl({"circle-radius":new al(ul.paint_circle["circle-radius"]),"circle-color":new al(ul.paint_circle["circle-color"]),"circle-blur":new al(ul.paint_circle["circle-blur"]),"circle-opacity":new al(ul.paint_circle["circle-opacity"]),"circle-translate":new sl(ul.paint_circle["circle-translate"]),"circle-translate-anchor":new sl(ul.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new sl(ul.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new sl(ul.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new al(ul.paint_circle["circle-stroke-width"]),"circle-stroke-color":new al(ul.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new al(ul.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new sl(ul.paint_circle["circle-emissive-strength"])}))},e,r,i)}createBucket(t){return new th(t)}queryRadius(t){const e=t;return mh("circle-radius",this,e)+mh("circle-stroke-width",this,e)+gh(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,r,i,n,o,s,a){const l=vh(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,t.pixelToTileUnitsFactor),c=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r);return ad(t,i,o,s,a,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),l,c)}getProgramIds(){return["circle"]}getDefaultProgramParams(t,e,r){const i=sd(this);return{config:new tu(this,{zoom:e,lut:r}),defines:i,overrideFog:!1}}},heatmap:class extends Cl{createBucket(t){return new dd(t)}constructor(t,e,r,i){super(t,{layout:_d||(_d=new cl({visibility:new sl(ul.layout_heatmap.visibility)})),paint:bd||(bd=new cl({"heatmap-radius":new al(ul.paint_heatmap["heatmap-radius"]),"heatmap-weight":new al(ul.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new sl(ul.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ll(ul.paint_heatmap["heatmap-color"]),"heatmap-opacity":new sl(ul.paint_heatmap["heatmap-opacity"])}))},e,r,i),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Td({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return mh("heatmap-radius",this,t)}queryIntersectsFeature(t,e,r,i,n,o,s,a){const l=this.paint.get("heatmap-radius").evaluate(e,r);return ad(t,i,o,s,a,!0,!0,new Ve(0,0),l)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(t,e,r){return"heatmap"===t?{config:new tu(this,{zoom:e,lut:r}),overrideFog:!1}:{}}},hillshade:class extends Cl{constructor(t,e,r,i){super(t,{layout:xd||(xd=new cl({visibility:new sl(ul.layout_hillshade.visibility)})),paint:wd||(wd=new cl({"hillshade-illumination-direction":new sl(ul.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new sl(ul.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new sl(ul.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new sl(ul.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new sl(ul.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new sl(ul.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new sl(ul.paint_hillshade["hillshade-emissive-strength"])}))},e,r,i)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(t,e,r){return{overrideFog:!1}}},fill:class extends Cl{constructor(t,e,r,i){super(t,{layout:rp||(rp=new cl({"fill-sort-key":new al(ul.layout_fill["fill-sort-key"]),visibility:new sl(ul.layout_fill.visibility)})),paint:ip||(ip=new cl({"fill-antialias":new sl(ul.paint_fill["fill-antialias"]),"fill-opacity":new al(ul.paint_fill["fill-opacity"]),"fill-color":new al(ul.paint_fill["fill-color"]),"fill-outline-color":new al(ul.paint_fill["fill-outline-color"]),"fill-translate":new sl(ul.paint_fill["fill-translate"]),"fill-translate-anchor":new sl(ul.paint_fill["fill-translate-anchor"]),"fill-pattern":new al(ul.paint_fill["fill-pattern"]),"fill-emissive-strength":new sl(ul.paint_fill["fill-emissive-strength"])}))},e,r,i)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),r=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getDefaultProgramParams(t,e,r){return{config:new tu(this,{zoom:e,lut:r}),overrideFog:!1}}recalculate(t,e){super.recalculate(t,e);const r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new ep(t)}queryRadius(){return gh(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,r,i,n,o){return!t.queryGeometry.isAboveHorizon&&ih(yh(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,t.pixelToTileUnitsFactor),i)}isTileClipped(){return!0}},"fill-extrusion":class extends Cl{constructor(t,e,r,i){super(t,{layout:Bf||(Bf=new cl({visibility:new sl(ul["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new sl(ul["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:zf||(zf=new cl({"fill-extrusion-opacity":new sl(ul["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new al(ul["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new sl(ul["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new sl(ul["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new al(ul["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new al(ul["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new al(ul["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new sl(ul["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new sl(ul["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new sl(ul["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new sl(ul["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new sl(ul["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new sl(ul["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new sl(ul["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new sl(ul["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new al(ul["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new al(ul["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new sl(ul["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new sl(ul["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new sl(ul["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new sl(ul["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new sl(ul["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new al(ul["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-line-alignment":new sl(ul["paint_fill-extrusion"]["fill-extrusion-line-alignment"])}))},e,r,i),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(t){return new Pf(t)}queryRadius(){return gh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(e,r,i,n,o,s,a,l,c){const u=vh(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),s.angle,e.pixelToTileUnitsFactor),h=this.paint.get("fill-extrusion-height").evaluate(r,i),d=this.paint.get("fill-extrusion-base").evaluate(r,i),p=[0,0],f=l&&s.elevation,m=s.elevation?s.elevation.exaggeration():1,g=e.tile.getBucket(this);if(f&&g instanceof Pf){const t=g.centroidVertexArray,e=c+1;e<t.length&&(p[0]=t.geta_centroid_pos0(e),p[1]=t.geta_centroid_pos1(e))}if(0===p[0]&&1===p[1])return!1;"globe"===s.projection.name&&(n=Rf([n],[new Ve(0,0),new Ve(mo,mo)],e.tileID.canonical).map((t=>t.polygon)).flat());const y=f?l:null,[v,_]=function(e,r,i,n,o,s,a,l,c,u,h){return"globe"===e.projection.name?function(e,r,i,n,o,s,a,l,c,u,h){const d=[],p=[],f=e.projection.upVectorScale(h,e.center.lat,e.worldSize).metersToTile,m=[0,0,0,1],g=[0,0,0,1],y=(t,e,r,i)=>{t[0]=e,t[1]=r,t[2]=i,t[3]=1},v=Df();i>0&&(i+=v),n+=v;for(const v of r){const r=[],_=[];for(const d of v){const p=d.x+o.x,v=d.y+o.y,b=e.projection.projectTilePoint(p,v,h),x=e.projection.upVector(h,d.x,d.y);let w=i,T=n;if(a){const t=Vf(p,v,i,n,a,l,c,u);w+=t.base,T+=t.top}0!==i?y(m,b.x+x[0]*f*w,b.y+x[1]*f*w,b.z+x[2]*f*w):y(m,b.x,b.y,b.z),y(g,b.x+x[0]*f*T,b.y+x[1]*f*T,b.z+x[2]*f*T),t.$.transformMat4(m,m,s),t.$.transformMat4(g,g,s),r.push(new Cp(m[0],m[1],m[2])),_.push(new Cp(g[0],g[1],g[2]))}d.push(r),p.push(_)}return[d,p]}(e,r,i,n,o,s,a,l,c,u,h):a?function(e,r,i,n,o,s,a,l,c){const u=[],h=[],d=[0,0,0,1];for(const p of e){const e=[],f=[];for(const u of p){const h=u.x+n.x,p=u.y+n.y,m=Vf(h,p,r,i,s,a,l,c);d[0]=h,d[1]=p,d[2]=m.base,d[3]=1,t.aB.transformMat4(d,d,o),d[3]=Math.max(d[3],1e-5);const g=new Cp(d[0]/d[3],d[1]/d[3],d[2]/d[3]);d[0]=h,d[1]=p,d[2]=m.top,d[3]=1,t.aB.transformMat4(d,d,o),d[3]=Math.max(d[3],1e-5);const y=new Cp(d[0]/d[3],d[1]/d[3],d[2]/d[3]);e.push(g),f.push(y)}u.push(e),h.push(f)}return[u,h]}(r,i,n,o,s,a,l,c,u):function(t,e,r,i,n){const o=[],s=[],a=n[8]*e,l=n[9]*e,c=n[10]*e,u=n[11]*e,h=n[8]*r,d=n[9]*r,p=n[10]*r,f=n[11]*r;for(const e of t){const t=[],r=[];for(const o of e){const e=o.x+i.x,s=o.y+i.y,m=n[0]*e+n[4]*s+n[12],g=n[1]*e+n[5]*s+n[13],y=n[2]*e+n[6]*s+n[14],v=n[3]*e+n[7]*s+n[15],_=m+a,b=g+l,x=y+c,w=Math.max(v+u,1e-5),T=m+h,E=g+d,S=y+p,P=Math.max(v+f,1e-5);t.push(new Cp(_/w,b/w,x/w)),r.push(new Cp(T/P,E/P,S/P))}o.push(t),s.push(r)}return[o,s]}(r,i,n,o,s)}(s,n,d,h,u,a,y,p,m,s.center.lat,e.tileID.canonical),b=e.queryGeometry;return function(t,e,r){let i=1/0;ih(r,e)&&(i=Nf(r,e[0]));for(let n=0;n<e.length;n++){const o=e[n],s=t[n];for(let t=0;t<o.length-1;t++){const e=o[t],n=[e,o[t+1],s[t+1],s[t],e];eh(r,n)&&(i=Math.min(i,Nf(r,n)))}}return i!==1/0&&i}(v,_,b.isPointQuery()?b.screenBounds:b.screenGeometry)}},line:class extends Cl{constructor(t,e,r,i){const n=h_();super(t,n,e,r,i),n.layout&&(this.layout=new ol(n.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof ns,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=(()=>{if(p_)return p_;const t=h_();return p_=new d_(t.paint.properties["line-width"].specification),p_.useIntegerZoom=!0,p_})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new am(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(t,e,r){const i=fm(this);return{config:new tu(this,{zoom:e,lut:r}),defines:i,overrideFog:!1}}queryRadius(t){const e=t,r=y_(mh("line-width",this,e),mh("line-gap-width",this,e)),i=mh("line-offset",this,e);return r/2+Math.abs(i)+gh(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,r,i,n,o){if(t.queryGeometry.isAboveHorizon)return!1;const s=yh(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,t.pixelToTileUnitsFactor),a=t.pixelToTileUnitsFactor/2*y_(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),l=this.paint.get("line-offset").evaluate(e,r);return l&&(i=function(t,e){const r=[],i=new Ve(0,0);for(let n=0;n<t.length;n++){const o=t[n],s=[];for(let t=0;t<o.length;t++){const r=o[t],n=o[t+1],a=0===t?i:r.sub(o[t-1])._unit()._perp(),l=t===o.length-1?i:n.sub(r)._unit()._perp(),c=a._add(l)._unit();c._mult(1/(c.x*l.x+c.y*l.y)),s.push(c._mult(e)._add(r))}r.push(s)}return r}(i,l*t.pixelToTileUnitsFactor)),function(t,e,r){for(let i=0;i<e.length;i++){const n=e[i];if(t.length>=3)for(let e=0;e<n.length;e++)if(uh(t,n[e]))return!0;if(nh(t,n,r))return!0}return!1}(s,i,a)}isTileClipped(){return!0}isDraped(t){const e=this.layout.get("line-z-offset");return e.isConstant()&&!e.constantOr(0)}},symbol:b_,background:class extends Cl{constructor(t,e,r,i){super(t,{layout:x_||(x_=new cl({visibility:new sl(ul.layout_background.visibility)})),paint:w_||(w_=new cl({"background-color":new sl(ul.paint_background["background-color"]),"background-pattern":new sl(ul.paint_background["background-pattern"]),"background-opacity":new sl(ul.paint_background["background-opacity"]),"background-emissive-strength":new sl(ul.paint_background["background-emissive-strength"])}))},e,r,i)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(t,e,r){return{overrideFog:!1}}},raster:C_,"raster-particle":F_,sky:class extends Cl{constructor(t,e,r,i){super(t,{layout:L_||(L_=new cl({visibility:new sl(ul.layout_sky.visibility)})),paint:D_||(D_=new cl({"sky-type":new sl(ul.paint_sky["sky-type"]),"sky-atmosphere-sun":new sl(ul.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new sl(ul.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new sl(ul.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new sl(ul.paint_sky["sky-gradient-radius"]),"sky-gradient":new ll(ul.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new sl(ul.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new sl(ul.paint_sky["sky-atmosphere-color"]),"sky-opacity":new sl(ul.paint_sky["sky-opacity"])}))},e,r,i),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"sky-gradient"===t?this._updateColorRamp():"sky-atmosphere-sun"!==t&&"sky-atmosphere-halo-color"!==t&&"sky-atmosphere-color"!==t&&"sky-atmosphere-sun-intensity"!==t||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Td({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if("atmosphere"===this.paint.get("sky-type")){const r=this.paint.get("sky-atmosphere-sun"),i=!r,n=t.style.light,o=n.properties.get("position");return i&&"viewport"===n.properties.get("anchor")&&fr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),i?z_(o.azimuthal,90-o.polar,e):z_(r[0],90-r[1],e)}const r=this.paint.get("sky-gradient-center");return z_(r[0],90-r[1],e)}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return"atmosphere"===t?["skyboxCapture","skybox"]:"gradient"===t?["skyboxGradient"]:null}},slot:class extends Cl{constructor(t,e,r,i){super(t,{paint:R_||(R_=new cl({}))},e,null)}},model:class extends Cl{constructor(t,e,r,i){super(t,{layout:ab||(ab=new cl({visibility:new sl(ul.layout_model.visibility),"model-id":new al(ul.layout_model["model-id"])})),paint:lb||(lb=new cl({"model-opacity":new sl(ul.paint_model["model-opacity"]),"model-rotation":new al(ul.paint_model["model-rotation"]),"model-scale":new al(ul.paint_model["model-scale"]),"model-translation":new al(ul.paint_model["model-translation"]),"model-color":new al(ul.paint_model["model-color"]),"model-color-mix-intensity":new al(ul.paint_model["model-color-mix-intensity"]),"model-type":new sl(ul.paint_model["model-type"]),"model-cast-shadows":new sl(ul.paint_model["model-cast-shadows"]),"model-receive-shadows":new sl(ul.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new sl(ul.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new al(ul.paint_model["model-emissive-strength"]),"model-roughness":new al(ul.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new al(ul.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new sl(ul.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new sl(ul.paint_model["model-front-cutoff"])}))},e,r,i),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(t){return new sb(t)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(t){return t instanceof dx?mo-1:0}queryIntersectsFeature(e,r,i,n,o,s){if(!this.modelManager)return!1;const a=this.modelManager,l=e.tile.getBucket(this);if(!(l&&l instanceof sb))return!1;const c=l;for(const i in c.instancesPerModel){const n=c.instancesPerModel[i],o=void 0!==r.id?r.id:r.properties&&r.properties.hasOwnProperty("id")?r.properties.id:void 0;if(n.idToFeaturesIndex.hasOwnProperty(o)){const r=n.features[n.idToFeaturesIndex[o]],l=a.getModel(i,this.scope);if(!l)return!1;let u=t.ae.create();const h=new _u(0,0),d=c.canonical;let p=Number.MAX_VALUE;for(let i=0;i<r.instancedDataCount;++i){const o=16*(r.instancedDataOffset+i),a=n.instancedDataArray.float32,c=[a[o+4],a[o+5],a[o+6]];gx(d,h,a[o],0|a[o+1]),hb(u,l,s,h,r.rotation,r.scale,c,!1,!1,!1),"globe"===s.projection.name&&(u=W_(u,s));const f=t.ae.multiply([],s.projMatrix,u),m=e.queryGeometry,g=Z_(m.isPointQuery()?m.screenBounds:m.screenGeometry,s,f,l.aabb);null!=g&&(p=Math.min(g,p))}return p!==Number.MAX_VALUE&&p}}return!1}_handleOverridablePaintPropertyUpdate(t,e,r){return!(!this.layout||e.isDataDriven()||r.isDataDriven()||"model-color"!==t&&"model-color-mix-intensity"!==t&&"model-rotation"!==t&&"model-scale"!==t&&"model-translation"!==t&&"model-emissive-strength"!==t)}_isPropertyZoomDependent(t){const e=this._transitionablePaint._values[t];return null!=e&&null!=e.value&&null!=e.value.expression&&e.value.expression instanceof ga}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(e,r,i,n){const o=e.tile,s=o.getBucket(this);let a=null,l=Number.MAX_VALUE;if(!(s&&s instanceof dx))return{queryFeature:a,intersectionZ:l};const c=s.getNodesInfo()[r];if(c.hiddenByReplacement||!c.node.meshes||!i.filter(new Ka(o.tileID.overscaledZ),c.feature,o.tileID.canonical))return{queryFeature:a,intersectionZ:l};const u=c.node,h=n.calculatePosMatrix(o.tileID.toUnwrapped(),n.worldSize),d=c.evaluatedScale;let p=0;n.elevation&&u.elevation&&(p=u.elevation*n.elevation.exaggeration()),t.ae.translate(h,h,[(u.anchor?u.anchor[0]:0)*(d[0]-1),(u.anchor?u.anchor[1]:0)*(d[1]-1),p]),t.ae.scale(h,h,d),t.ae.multiply(h,h,u.matrix);const f=e.queryGeometry,m=f.isPointQuery()?f.screenBounds:f.screenGeometry,g=function(e){const r=t.ae.multiply([],h,e.matrix),i=t.ae.multiply(r,n.expandedFarZProjMatrix,r);for(let t=0;t<e.meshes.length;++t){const r=e.meshes[t];if(t===e.lightMeshIndex)continue;const o=Z_(m,n,i,r.aabb);null!=o&&(l=Math.min(o,l))}if(e.children)for(const t of e.children)g(t)};if(g(u),l===Number.MAX_VALUE)return{queryFeature:a,intersectionZ:l};const y=new _u(0,0);return gx(o.tileID.canonical,y,c.node.anchor[0],c.node.anchor[1]),a={type:"Feature",geometry:{type:"Point",coordinates:[y.lng,y.lat]},properties:c.feature.properties,id:c.feature.id,state:{},layer:this.serialize()},{queryFeature:a,intersectionZ:l}}},clip:class extends Cl{constructor(t,e,r,i){super(t,{layout:np||(np=new cl({"clip-layer-types":new sl(ul.layout_clip["clip-layer-types"]),"clip-layer-scope":new sl(ul.layout_clip["clip-layer-scope"])})),paint:op||(op=new cl({}))},e,r,i)}recalculate(t,e){super.recalculate(t,e)}createBucket(t){return new lp(t)}isTileClipped(){return!0}is3D(){return!0}}};Sa(n_,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});const vx=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class _x{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,r]=new Uint8Array(t,0,2);if(219!==e)throw new Error("Data does not appear to be in a KDBush format.");const i=r>>4;if(1!==i)throw new Error(`Got v${i} data when expected v1.`);const n=vx[15&r];if(!n)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(t,2,1),[s]=new Uint32Array(t,4,1);return new _x(s,o,n,t)}constructor(t,e=64,r=Float64Array,i){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=r,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const n=vx.indexOf(this.ArrayType),o=2*t*this.ArrayType.BYTES_PER_ELEMENT,s=t*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-s%8)%8;if(n<0)throw new Error(`Unexpected typed array class: ${r}.`);i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+s+a,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+o+s+a),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+s+a,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+n]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=t,this.coords[this._pos++]=e,r}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return bx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,r,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:o,nodeSize:s}=this,a=[0,n.length-1,0],l=[];for(;a.length;){const c=a.pop()||0,u=a.pop()||0,h=a.pop()||0;if(u-h<=s){for(let s=h;s<=u;s++){const a=o[2*s],c=o[2*s+1];a>=t&&a<=r&&c>=e&&c<=i&&l.push(n[s])}continue}const d=h+u>>1,p=o[2*d],f=o[2*d+1];p>=t&&p<=r&&f>=e&&f<=i&&l.push(n[d]),(0===c?t<=p:e<=f)&&(a.push(h),a.push(d-1),a.push(1-c)),(0===c?r>=p:i>=f)&&(a.push(d+1),a.push(u),a.push(1-c))}return l}within(t,e,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:n,nodeSize:o}=this,s=[0,i.length-1,0],a=[],l=r*r;for(;s.length;){const c=s.pop()||0,u=s.pop()||0,h=s.pop()||0;if(u-h<=o){for(let r=h;r<=u;r++)Ex(n[2*r],n[2*r+1],t,e)<=l&&a.push(i[r]);continue}const d=h+u>>1,p=n[2*d],f=n[2*d+1];Ex(p,f,t,e)<=l&&a.push(i[d]),(0===c?t-r<=p:e-r<=f)&&(s.push(h),s.push(d-1),s.push(1-c)),(0===c?t+r>=p:e+r>=f)&&(s.push(d+1),s.push(u),s.push(1-c))}return a}}function bx(t,e,r,i,n,o){if(n-i<=r)return;const s=i+n>>1;xx(t,e,s,i,n,o),bx(t,e,r,i,s-1,1-o),bx(t,e,r,s+1,n,1-o)}function xx(t,e,r,i,n,o){for(;n>i;){if(n-i>600){const s=n-i+1,a=r-i+1,l=Math.log(s),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(s-c)/s)*(a-s/2<0?-1:1);xx(t,e,r,Math.max(i,Math.floor(r-a*c/s+u)),Math.min(n,Math.floor(r+(s-a)*c/s+u)),o)}const s=e[2*r+o];let a=i,l=n;for(wx(t,e,i,r),e[2*n+o]>s&&wx(t,e,i,n);a<l;){for(wx(t,e,a,l),a++,l--;e[2*a+o]<s;)a++;for(;e[2*l+o]>s;)l--}e[2*i+o]===s?wx(t,e,i,l):(l++,wx(t,e,l,n)),l<=r&&(i=l+1),r<=l&&(n=l-1)}}function wx(t,e,r,i){Tx(t,r,i),Tx(e,2*r,2*i),Tx(e,2*r+1,2*i+1)}function Tx(t,e,r){const i=t[e];t[e]=t[r],t[r]=i}function Ex(t,e,r,i){const n=t-r,o=e-i;return n*n+o*o}t.A=Yo,t.B=Jo,t.C=Gi,t.D=Xo,t.E=zi,t.F=Dn,t.H=pl,t.I=Qy,t.J=na,t.K=ea,t.L=function(t){const e=t.value;let r=[];if(!e)return r;const i=Mn(e);return"string"!==i?(r=r.concat([new rb(t.key,e,`string expected, "${i}" found`)]),r):(ib(e,!0)||(r=r.concat([new rb(t.key,e,`invalid url "${e}"`)])),r)},t.M=class{constructor(t,e,r,i){this.id=t,this.position=null!=e?new _u(e[0],e[1]):new _u(0,0),this.orientation=null!=r?r:[0,0,0],this.nodes=i,this.uploaded=!1,this.aabb=new Ah([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(e,r){if(t.ae.multiply(e.matrix,r,e.matrix),e.meshes)for(const t of e.meshes){const r=Ah.applyTransformFast(t.aabb,e.matrix);this.aabb.encapsulate(r)}if(e.children)for(const t of e.children)this._applyTransformations(t,e.matrix)}computeBoundsAndApplyParent(){const e=t.ae.identity([]);for(const t of this.nodes)this._applyTransformations(t,e)}computeModelMatrix(t,e,r,i,n,o,s=!1){hb(this.matrix,this,t.transform,this.position,e,r,i,n,o,s)}upload(t){if(!this.uploaded){for(const e of this.nodes)fb(e,t);for(const t of this.nodes)mb(t);this.uploaded=!0}}destroy(){for(const t of this.nodes)gb(t)}},t.N=ul,t.O=tl,t.P=Ve,t.Q=rr,t.R=Qr,t.S=hc,t.T=$y,t.U=cl,t.V=rb,t.W=sl,t.X=class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return yr(t.expression.evaluate(e))}interpolate(t,e,r){return{x:qi(t.x,e.x,r),y:qi(t.y,e.y,r),z:qi(t.z,e.z,r),azimuthal:qi(t.azimuthal,e.azimuthal,r),polar:qi(t.polar,e.polar,r)}}},t.Y=Ka,t.Z=ga,t._=Uu,t.a=nv,t.a$=wh,t.a0=Je,t.a1=ol,t.a2=Qh,t.a3=qi,t.a4=mo,t.a5=Wi,t.a6=class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return function([t,e]){const r=yr([1,t,e]);return{x:r.x,y:r.y,z:r.z}}(t.expression.evaluate(e))}interpolate(t,e,r){return{x:qi(t.x,e.x,r),y:qi(t.y,e.y,r),z:qi(t.z,e.z,r)}}},t.a7=Gc,t.a8=Bc,t.a9=jc,t.aA=function(t,e,r){t[4*e+0]=r[0],t[4*e+1]=r[1],t[4*e+2]=r[2],t[4*e+3]=r[3]},t.aC=function(e,r){const{x:i,y:n}=e.point,o=Jh(i,n,e.worldSize/e._pixelsPerMercatorPixel,0,0);return t.ae.multiply(o,o,Xh(zh(r)))},t.aE=Ym,t.aF=ag,t.aG=Xm,t.aH=function(t,e,r,i,n){const o=5*e+2;t.float32[o+0]=r,t.float32[o+1]=i,t.float32[o+2]=n},t.aI=zy,t.aJ=_u,t.aK=Oy,t.aL=Eu,t.aM=kh,t.aN=N_,t.aO=Tu,t.aP=Uh,t.aQ=Su,t.aR=function(t,e,r,i,n,o,s,a,l){if("globe"===l.name)return Uh(t,e,new Tu(r,i,n),!1);const c=uy({z:r,x:i,y:n},l);return new Ah([(o+c.x/c.scale)*e,e*(c.y/c.scale),s],[(o+c.x2/c.scale)*e,e*(c.y2/c.scale),a])},t.aS=function(t,e,r){let i=0;for(let r=0;r<2;++r){const n=0;t[r]>n&&(i+=(t[r]-n)*(t[r]-n)),e[r]<n&&(i+=(n-e[r])*(n-e[r]))}return i},t.aT=Bu,t.aU=xh,t.aV=cu,t.aW=function(e){const r=t.ae.identity(new Float64Array(16));t.ae.multiply(r,e.pixelMatrix,e.globeMatrix);const i=[0,pu,0],n=[0,fu,0];return t.$.transformMat4(i,i,r),t.$.transformMat4(n,n,r),[i[0]>0&&i[0]<=e.width&&i[1]>0&&i[1]<=e.height&&!ed(e,new _u(e.center.lat,90)),n[0]>0&&n[0]<=e.width&&n[1]>0&&n[1]<=e.height&&!ed(e,new _u(e.center.lat,-90))]},t.aX=function(e,r){const{scale:i}=e.tileTransform,n=i*mo/(e.tileSize*Math.pow(2,r.zoom-e.tileID.overscaledZ+e.tileID.canonical.z));return t.aD.scale(new Float32Array(4),r.inverseAdjustmentMatrix,[n,n])},t.aY=V_,t.aZ=j_,t.a_=function(e){const r=j_(e,!0);return t.aD.invert([],[r[0],r[1],r[4],r[5]])},t.aa=Uc,t.ab=zc,t.ac=He,t.ad=function(t,e,r){const i=Math.sqrt(t*t+e*e+r*r),n=i>0?Math.acos(r/i)*Ge:0;let o=0!==t||0!==e?Math.atan2(-e,-t)*Ge+90:0;return o<0&&(o+=360),[i,o,n]},t.af=tv,t.ag=av,t.ah=rv,t.ai=function(t,e){const r={};for(let i=0;i<e.length;i++){const n=e[i];n in t&&(r[n]=t[n])}return r},t.aj=bu,t.ak=Iu,t.al=Ou,t.am=kl,t.an=function(t){Hr++,Hr>jr&&(t.getActor().send("enforceCacheSizeLimit",zr),Hr=0)},t.ao=vi,t.ap=class{constructor(t){this.entries={},this.scheduler=t}request(t,e,r,i){const n=this.entries[t]=this.entries[t]||{callbacks:[]};if(n.result){const[t,r]=n.result;return this.scheduler?this.scheduler.add((()=>{i(t,r)}),e):i(t,r),()=>{}}return n.callbacks.push(i),n.cancel||(n.cancel=r(((r,i)=>{n.result=[r,i];for(const t of n.callbacks)this.scheduler?this.scheduler.add((()=>{t(r,i)}),e):t(r,i);setTimeout((()=>delete this.entries[t]),3e3)}))),()=>{n.result||(n.callbacks=n.callbacks.filter((t=>t!==i)),n.callbacks.length||(n.cancel(),delete this.entries[t]))}}},t.aq=function(t,e,r){const i=JSON.stringify(t.request);return t.data&&(this.deduped.entries[i]={result:[null,t.data]}),this.deduped.request(i,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},(e=>{const i=ii(t.request,((t,i,n,o)=>{t?e(t):i&&e(null,{vectorTile:r?void 0:new Ap(new jm(i)),rawData:i,cacheControl:n,expires:o})}));return()=>{i.cancel(),e()}}),e)},t.ar=Nc,t.as=class extends Fc{constructor(t){super(t),this.current=Hc}set(t,e,r){if(this.fetchUniformLocation(t,e))for(let t=0;t<9;t++)if(r[t]!==this.current[t]){this.current=r,this.gl.uniformMatrix3fv(this.location,!1,r);break}}},t.at=Vc,t.au=Ke,t.av=Qe,t.ax=Ar,t.ay=Lu,t.az=Ru,t.b=Ac,t.b$=ku,t.b0=function(t){const{x:e,y:r}=t.point,{lng:i,lat:n}=t._center;return Jh(e,r,t.worldSize,i,n)},t.b1=qe,t.b2=Pu,t.b3=lu,t.b4=function(t){const e=Math.round((t+45+360)%360/90)%4;return We[e]},t.b5=45,t.b6=Cu,t.b7=Vu,t.b8=Ah,t.b9=yr,t.bA=uv,t.bB=vd,t.bC=function(t,e){return[Math.pow(t[0],2.2)*e,Math.pow(t[1],2.2)*e,Math.pow(t[2],2.2)*e]},t.bD=hm,t.bF=Kh,t.bG=Or,t.bH=Ir,t.bI=256,t.bJ=function(e,r){const i=[0,0,0],n=Zh(zh(r.canonical));return t.$.transformMat4(i,i,n),t.$.transformMat4(i,i,e),i},t.bK=t=>({u_camera_to_center_distance:new zc(t),u_extrude_scale:new Wc(t),u_device_pixel_ratio:new zc(t),u_matrix:new Gc(t),u_inv_rot_matrix:new Gc(t),u_merc_center:new jc(t),u_tile_id:new Nc(t),u_zoom_transition:new zc(t),u_up_dir:new Nc(t),u_emissive_strength:new zc(t)}),t.bL=t=>({u_matrix:new Gc(t),u_pixels_to_tile_units:new Wc(t),u_device_pixel_ratio:new zc(t),u_units_to_pixels:new jc(t),u_dash_image:new Bc(t),u_gradient_image:new Bc(t),u_image_height:new zc(t),u_texsize:new jc(t),u_tile_units_to_pixels:new zc(t),u_alpha_discard_threshold:new zc(t),u_trim_offset:new jc(t),u_trim_fade_range:new jc(t),u_trim_color:new Vc(t),u_emissive_strength:new zc(t)}),t.bM=t=>({u_matrix:new Gc(t),u_texsize:new jc(t),u_pixels_to_tile_units:new Wc(t),u_device_pixel_ratio:new zc(t),u_image:new Bc(t),u_units_to_pixels:new jc(t),u_tile_units_to_pixels:new zc(t),u_alpha_discard_threshold:new zc(t),u_trim_offset:new jc(t)}),t.bN=Jl,t.bO=rm,t.bP=qm,t.bQ=Km,t.bR=Qg,t.bS=vg,t.bT=sd,t.bU=(t,e,r,i,n,o)=>{const s=t.transform,a="globe"===s.projection.name;let l;if("map"===o.paint.get("circle-pitch-alignment"))if(a){const t=Kh(s.zoom,e.canonical)*s._pixelsPerMercatorPixel;l=Float32Array.from([t,0,0,t])}else l=s.calculatePixelsToTileUnitsMatrix(r);else l=new Float32Array([s.pixelsToGLUnits[0],0,0,s.pixelsToGLUnits[1]]);const c={u_camera_to_center_distance:t.transform.getCameraToCenterDistance(s.projection),u_matrix:t.translatePosMatrix(e.projMatrix,r,o.paint.get("circle-translate"),o.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Dr.devicePixelRatio,u_extrude_scale:l,u_inv_rot_matrix:od,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:o.paint.get("circle-emissive-strength")};if(a){c.u_inv_rot_matrix=i,c.u_merc_center=n,c.u_tile_id=[e.canonical.x,e.canonical.y,1<<e.canonical.z],c.u_zoom_transition=Qh(s.zoom);const t=n[0]*mo,r=n[1]*mo;c.u_up_dir=s.projection.upVector(new Tu(0,0,0),t,r)}return c},t.bV=fm,t.bW=(t,e,r,i,n,o)=>{const s=t.transform;return{u_matrix:pm(t,e,r,i),u_texsize:e.imageAtlasTexture?e.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:s.calculatePixelsToTileUnitsMatrix(e),u_device_pixel_ratio:n,u_image:0,u_tile_units_to_pixels:dm(e,s),u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:o}},t.bX=(t,e,r,i,n,o,s)=>{const a=t.transform,l=a.calculatePixelsToTileUnitsMatrix(e);return{u_matrix:pm(t,e,r,i),u_pixels_to_tile_units:l,u_device_pixel_ratio:o,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:n,u_texsize:mm(r)&&e.lineAtlasTexture?e.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:dm(e,t.transform),u_alpha_discard_threshold:0,u_trim_offset:s,u_trim_fade_range:r.paint.get("line-trim-fade-range"),u_trim_color:r.paint.get("line-trim-color").toRenderColor(r.lut).toArray01(),u_emissive_strength:r.paint.get("line-emissive-strength")}},t.bY=sr,t.bZ=Td,t.b_=Df,t.ba=function(t){return[Math.pow(t[0],1/2.2),Math.pow(t[1],1/2.2),Math.pow(t[2],1/2.2)]},t.bb=Ze,t.bc=function(t,e,r){const i=Qh(r.zoom),n=t.style.map._antialias,o=e.options.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return 0===i&&!n&&!o},t.bd=function(e){const r=e.pixelsPerMeter,i=r/Lu(1,e.center.lat),n=t.ae.identity(new Float64Array(16));return t.ae.translate(n,n,[e.point.x,e.point.y,0]),t.ae.scale(n,n,[i,i,r]),Float32Array.from(n)},t.be=$h,t.bf=function(t){const e=Bu-5;t=Ke(t,-e,e)/e*90;const r=Math.pow(Math.abs(Math.sin(He(t))),3);return Math.round(r*(du.length-1))},t.bg=function(e,r,i,n){const o=r.getNorth(),s=r.getSouth(),a=r.getWest(),l=r.getEast(),c=1<<e.z,u=l-a,h=o-s,d=u/hu,p=-h/du[i],f=[0,d,0,p,0,0,o,a,0];if(e.z>0){const e=180/n;t.bE.multiply(f,f,[e/u+1,0,0,0,e/h+1,0,-.5*e/d,.5*e/p,1])}return f[2]=c,f[5]=e.x,f[8]=e.y,f},t.bh=Zh,t.bi=zh,t.bj=function(e,r,i){const n=t.ae.identity(new Float64Array(16)),o=(r/(1<<e)-.5)*Math.PI*2;return t.ae.rotateY(n,i.globeMatrix,o),Float32Array.from(n)},t.bk=Lr,t.bl=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},t.bm=C_,t.bn=F_,t.bo=A_,t.bp=function(t,e){const r=document.createElement("video");r.muted=!0,r.onloadstart=function(){e(null,r)};for(let e=0;e<t.length;e++){const i=document.createElement("source");ni(t[e])||(r.crossOrigin="Anonymous"),i.src=t[e],r.appendChild(i)}return{cancel:()=>{}}},t.bq=Gy,t.br=lr,t.bs=class{isDataAvailableAtPoint(t){const e=this._source();if(this.isUsingMockSource()||!e||t.y<0||t.y>1)return!1;const r=e.getSource().maxzoom,i=1<<r,n=Math.floor(t.x),o=Math.floor((t.x-n)*i),s=Math.floor(t.y*i),a=this.findDEMTileFor(new Su(r,n,r,o,s));return!(!a||!a.dem)}getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,r=!0){if(this.isUsingMockSource())return null;null==e&&(e=null);const i=this._source();if(!i)return e;if(t.y<0||t.y>1)return e;const n=i.getSource().maxzoom,o=1<<n,s=Math.floor(t.x),a=t.x-s,l=new Su(n,s,n,Math.floor(a*o),Math.floor(t.y*o)),c=this.findDEMTileFor(l);if(!c||!c.dem)return e;const u=c.dem,h=1<<c.tileID.canonical.z,d=(a*h-c.tileID.canonical.x)*u.dim,p=(t.y*h-c.tileID.canonical.y)*u.dim,f=Math.floor(d),m=Math.floor(p);return(r?this.exaggeration():1)*qi(qi(u.get(f,m),u.get(f,m+1),p-m),qi(u.get(f+1,m),u.get(f+1,m+1),p-m),d-f)}getAtTileOffset(t,e,r){const i=1<<t.canonical.z;return this.getAtPointOrZero(new Uu(t.wrap+(t.canonical.x+e/mo)/i,(t.canonical.y+r/mo)/i))}getAtTileOffsetFunc(e,r,i,n){return o=>{const s=this.getAtTileOffset(e,o.x,o.y),a=n.upVector(e.canonical,o.x,o.y),l=n.upVectorScale(e.canonical,r,i).metersToTile;return t.$.scale(a,a,s*l),a}}getForTilePoints(t,e,r,i){if(this.isUsingMockSource())return!1;const n=sf.create(this,t,i);return!!n&&(e.forEach((t=>{t[2]=this.exaggeration()*n.getElevationAt(t[0],t[1],r)})),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const r=e.dem.tree,i=e.tileID,n=1<<t.canonical.z-i.canonical.z;let o=t.canonical.x/n-i.canonical.x,s=t.canonical.y/n-i.canonical.y,a=0;for(let e=0;e<t.canonical.z-i.canonical.z&&!r.leaves[a];e++){o*=2,s*=2;const t=2*Math.floor(s)+Math.floor(o);a=r.childOffsets[a]+t,o%=1,s%=1}return{min:this.exaggeration()*r.minimums[a],max:this.exaggeration()*r.maximums[a]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,r){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const t=this.visibleDemTiles;if(0===t.length)return null;let e=!1,r=Number.MAX_VALUE,i=Number.MIN_VALUE;for(const n of t){const t=this.getMinMaxForTile(n.tileID);t&&(r=Math.min(r,t.min),i=Math.max(i,t.max),e=!0)}return e?{min:r,max:i}:null}},t.bt=Oh,t.bu=Lh,t.bv=Fl,t.bw=tc,t.bx=a_,t.by=bb,t.bz=Pb,t.c=ix,t.c$=function(t,e,r,i){return"custom"===t.type?new B_(t,e):new yx[t.type](t,e,r,i)},t.c0=Pf,t.c1=ff,t.c2=450,t.c3=7,t.c4=M_,t.c5=o_,t.c6=256,t.c7=Nh,t.c8=Xh,t.c9=Dl,t.cA=hh,t.cB=function(e,r,i=0){return t.$.fromValues(((r.x-i)*e.scale-e.x)*mo,(r.y*e.scale-e.y)*mo,Fu(r.z,r.y))},t.cC=function(t){let e=1/0,r=1/0,i=-1/0,n=-1/0;for(const o of t)e=Math.min(e,o.x),r=Math.min(r,o.y),i=Math.max(i,o.x),n=Math.max(n,o.y);return{min:new Ve(e,r),max:new Ve(i,n)}},t.cD=uh,t.cE=Gu,t.cF=au,t.cG=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.cH=Cg,t.cI=eh,t.cJ=Fp,t.cK=Hp,t.cL=qp,t.cM=ty,t.cN=_x,t.cO=function(t){return t({pluginStatus:$a,pluginURL:Ga}),Wa.on("pluginStateChange",t),t},t.cP=Ng,t.cQ=jg,t.cR=ei,t.cS=Ha,t.cT=o,t.cU=Fr,t.cV=Li,t.cW=dr,t.cX=function(t){const e=t.indexOf(Pl);return e>=0?t.slice(0,e):t},t.cY=function(t){return t.indexOf(Pl)>=0},t.cZ=function(t){const e=t.indexOf(Pl);return e>=0?t.slice(e+1):""},t.c_=function(t){const e=[],r=t.id;return void 0===r&&e.push({message:`layers.${r}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${r}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),e},t.ca=Ul,t.cb=nc,t.cc=1,t.cd=iv,t.ce=0,t.cf=oc,t.cg=function(t,e,r,i,n){return Ke((t-e)/(r-e)*(n-i)+i,i,n)},t.ch=Gs,t.ci=ju,t.cj=class{constructor(t,e,r,i){this.context=t,this.format=i,this.size=r,this.texture=t.gl.createTexture();const[n,o,s]=this.size,{gl:a}=t;a.bindTexture(a.TEXTURE_3D,this.texture),t.pixelStoreUnpackFlipY.set(!1),t.pixelStoreUnpack.set(1),t.pixelStoreUnpackPremultiplyAlpha.set(!1);let l=this.format,c=a.UNSIGNED_BYTE;this.format===a.DEPTH_COMPONENT&&(l=a.DEPTH_COMPONENT16,c=a.UNSIGNED_SHORT),this.format===a.R8&&(i=a.RED),this.format===a.R32F&&(c=a.FLOAT,i=a.RED),a.texImage3D(a.TEXTURE_3D,0,l,n,o,s,0,i,c,e.data)}bind(t,e){const{context:r}=this,{gl:i}=r;i.bindTexture(i.TEXTURE_3D,this.texture),t!==this.minFilter&&(i.texParameteri(i.TEXTURE_3D,i.TEXTURE_MAG_FILTER,t),i.texParameteri(i.TEXTURE_3D,i.TEXTURE_MIN_FILTER,t),this.minFilter=t),e!==this.wrapS&&(i.texParameteri(i.TEXTURE_3D,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_3D,i.TEXTURE_WRAP_T,e),this.wrapS=e)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}},t.ck=W_,t.cl=[1,1,1],t.cm=sf,t.cn=ub,t.co=Xl,t.cp=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Ve(1/0,1/0),max:new Ve(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(t,e=!1){const r=Vp(new Ve(0,0),new Ve(mo,mo),t),i=[];if(e&&!jp(r,this._globalClipBounds))return i;for(const e of this._activeRegions){if(e.hiddenByOverlap)continue;if(!jp(r,e))continue;const n=Up(e.min,e.max,t);i.push({min:n.min,max:n.max,sourceId:this._sourceIds[e.priority],footprint:e.footprint,footprintTileId:e.tileId,order:e.order,clipMask:e.clipMask,clipScope:e.clipScope})}return i}setSources(t){this._setSources(t.map((t=>({getSourceId:()=>t.cache.id,getFootprints:()=>{const e=[];for(const r of t.cache.getVisibleCoordinates()){const i=t.cache.getTile(r).buckets[t.layer];i&&i.updateFootprints(r.toUnwrapped(),e)}return e},getOrder:()=>t.order,getClipMask:()=>t.clipMask,getClipScope:()=>t.clipScope}))))}_addSource(t){const e=t.getFootprints();if(0===e.length)return;const r=t.getOrder(),i=t.getClipMask(),n=t.getClipScope();for(const t of e){if(!t.footprint)continue;const e=Vp(t.footprint.min,t.footprint.max,t.id);this._activeRegions.push({min:e.min,max:e.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:t.id,footprint:t.footprint,order:r,clipMask:i,clipScope:n})}this._sourceIds.push(t.getSourceId())}_computeReplacement(){this._activeRegions.sort(((t,e)=>t.priority-e.priority||Bp(t.min,e.min)||Bp(t.max,e.max)||t.order-e.order||t.clipMask-e.clipMask||function(t,e){const r=(t,e)=>t+e;return t.length-e.length||t.reduce(r,"").localeCompare(e.reduce(r,""))}(t.clipScope,e.clipScope)));let t=this._activeRegions.length!==this._prevRegions.length;if(!t){let e=0;for(;!t&&e!==this._activeRegions.length;){const r=this._activeRegions[e],i=this._prevRegions[e];t=r.priority!==i.priority||!zp(r,i)||r.order!==i.order||r.clipMask!==i.clipMask||!Ue(r.clipScope,i.clipScope),++e}}if(t){++this._updateTime;for(const t of this._activeRegions)t.order!==Rp&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,t.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,t.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,t.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,t.max.y));const t=t=>{const e=this._activeRegions;if(t>=e.length)return t;const r=e[t].priority;for(;t<e.length&&e[t].priority===r;)++t;return t};if(this._sourceIds.length>1){let e=0,r=t(e);for(;e!==r;){let i=e;const n=e;for(;i!==r;){const t=this._activeRegions[i];t.hiddenByOverlap=!1;for(let e=0;e<n;e++){const r=this._activeRegions[e];if(!r.hiddenByOverlap&&t.order===Rp&&jp(t,r)&&(t.hiddenByOverlap=Gp(t.footprint,t.tileId,r.footprint,r.tileId),t.hiddenByOverlap))break}++i}e=r,r=t(e)}}}}_setSources(t){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let e=t.length-1;e>=0;e--)this._addSource(t[e]);this._computeReplacement()}},t.cq=zl,t.cr=Jy,t.cs=ac,t.ct=class{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy()}_fillGridMeshWithLods(t,e){const r=new Fl,i=new tc,n=[],o=t+1+2,s=e[0]+1,a=e[0]+1+(1+e.length),l=(t,e,r)=>{let i=t===o-1?t-2:0===t?t:t-1;return i+=r?24575:0,[i,e]};for(let t=0;t<o;++t)r.emplaceBack(...l(t,0,!0));for(let t=0;t<s;++t)for(let e=0;e<o;++e)r.emplaceBack(...l(e,t,(0===e||e===o-1)&&!0));for(let t=0;t<e.length;++t){const i=e[t];for(let t=0;t<o;++t)r.emplaceBack(...l(t,i,!0))}for(let t=0;t<e.length;++t){const s=i.length,l=e[t]+1+2,c=new tc;for(let r=0;r<l-1;r++){const n=r===l-2,s=n?o*(a-e.length+t-r):o;for(let t=0;t<o-1;t++){const e=r*o+t;0===r||n||0===t||t===o-2?(c.emplaceBack(e+1,e,e+s),c.emplaceBack(e+s,e+s+1,e+1)):(i.emplaceBack(e+1,e,e+s),i.emplaceBack(e+s,e+s+1,e+1))}}const u=Ac.simpleSegment(0,s,r.length,i.length-s);for(let t=0;t<c.uint16.length;t+=3)i.emplaceBack(c.uint16[t],c.uint16[t+1],c.uint16[t+2]);const h=Ac.simpleSegment(0,s,r.length,i.length-s);n.push({withoutSkirts:u,withSkirts:h})}return{vertices:r,indices:i,segments:n}}_createGrid(t){const e=this._fillGridMeshWithLods(hu,du);this._gridSegments=e.segments,this._gridBuffer=t.createVertexBuffer(e.vertices,Oh.members),this._gridIndexBuffer=t.createIndexBuffer(e.indices,!0)}_createPoles(t){const e=new tc;for(let t=0;t<=hu;t++)e.emplaceBack(0,t+1,t+2);this._poleIndexBuffer=t.createIndexBuffer(e,!0);const r=new nc,i=new nc,n=new nc,o=new nc;this._poleSegments=[];for(let t=0,e=0;t<lu;t++){const s=360/(1<<t);r.emplaceBack(0,-au,0,.5,0),i.emplaceBack(0,-au,0,.5,1),n.emplaceBack(0,-au,0,.5,.5),o.emplaceBack(0,-au,0,.5,.5);for(let t=0;t<=hu;t++){let e=t/hu,a=0;const l=qi(0,s,e),[c,u,h]=mu(id,nd,l,au);r.emplaceBack(c,u,h,e,a),i.emplaceBack(c,u,h,e,1-a);const d=He(l);e=.5+.5*Math.sin(d),a=.5+.5*Math.cos(d),n.emplaceBack(c,u,h,e,a),o.emplaceBack(c,u,h,e,1-a)}this._poleSegments.push(Ac.simpleSegment(e,0,66,64)),e+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(r,Ch,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(i,Ch,!1),this._texturedPoleNorthVertexBuffer=t.createVertexBuffer(n,Ch,!1),this._texturedPoleSouthVertexBuffer=t.createVertexBuffer(o,Ch,!1)}getGridBuffers(t,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t,e){return[e?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,e?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}},t.cu=function(t){return ki.has(t)},t.cv=Rp,t.cw=af,t.cx=function(t,e,r=0,i=!0){const n=new Ve(r,r),o=t.sub(n),s=e.add(n),a=[o,new Ve(s.x,o.y),s,new Ve(o.x,s.y)];return i&&a.push(o.clone()),a},t.cy=function(t,e){const r=[];for(let i=0;i<t.length;i++){const n=Qe(i-1,-1,t.length-1),o=Qe(i+1,-1,t.length-1),s=t[i],a=t[o],l=t[n].sub(s).unit(),c=a.sub(s).unit(),u=c.angleWithSep(l.x,l.y),h=l.add(c).unit().mult(-1*e/Math.sin(u/2));r.push(s.add(h))}return r},t.cz=hy,t.d=Ue,t.d$=r_,t.d0=hr,t.d1=Wa,t.d2=ri,t.d3=Xe,t.d4=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},t.d5=Ye,t.d6=Nu,t.d7=gu,t.d8=function([t,e,r]){const i=Math.hypot(t,e,r),n=Math.atan2(t,r),o=.5*Math.PI-Math.acos(-e/i);return new _u(qe(n),qe(o))},t.d9=Du,t.dA=function(){Pb().acquire(Tb)},t.dB=function(){const t=Sb;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(Tb),Sb=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},t.dC=Eb,t.dD=function(t){const e=$r();if(!e)return;const r=e.delete(Br);t&&r.catch(t).then((()=>t()))},t.dE=xb,t.dF=Lb,t.dG=function(t){Ab=Dr.resolveURL(t),Ob||(Ob=new bb(Pb(),new zi)),Ob.broadcast("setDracoUrl",Ab)},t.dH=Db,t.dI=function(t){Cb=Dr.resolveURL(t),Ob||(Ob=new bb(Pb(),new zi)),Ob.broadcast("setMeshoptUrl",Cb)},t.dJ=er,t.dK=Sa,t.dL=gd,t.dM=zg,t.dN=uy,t.dO=fc,t.dP=gm,t.dQ=$m,t.dR=im,t.dS=ur,t.dT=Dg,t.dU=Uy,t.dV=function(t,e,r,i,n,o,s,a,l,c,u){t.createArrays(),t.tilePixelRatio=mo/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const h=t.layers[0].layout,d=t.layers[0]._unevaluatedLayout._values,p={};if("composite"===t.textSizeData.kind){const{minZoom:e,maxZoom:r}=t.textSizeData;p.compositeTextSizes=[d["text-size"].possiblyEvaluate(new Ka(e),a),d["text-size"].possiblyEvaluate(new Ka(r),a)]}if("composite"===t.iconSizeData.kind){const{minZoom:e,maxZoom:r}=t.iconSizeData;p.compositeIconSizes=[d["icon-size"].possiblyEvaluate(new Ka(e),a),d["icon-size"].possiblyEvaluate(new Ka(r),a)]}p.layoutTextSize=d["text-size"].possiblyEvaluate(new Ka(l+1),a),p.layoutIconSize=d["icon-size"].possiblyEvaluate(new Ka(l+1),a),p.textMaxSize=d["text-size"].possiblyEvaluate(new Ka(18),a);const f="map"===h.get("text-rotation-alignment")&&"point"!==h.get("symbol-placement"),m=h.get("text-size");let g=!1;for(const e of t.features)if(e.icon&&e.icon.nameSecondary){g=!0;break}for(const o of t.features){const l=h.get("text-font").evaluate(o,{},a).join(","),d=m.evaluate(o,{},a),y=p.layoutTextSize.evaluate(o,{},a),v=(p.layoutIconSize.evaluate(o,{},a),{horizontal:{},vertical:void 0}),_=o.text;let b,x=[0,0];if(_){const i=_.toString(),s=h.get("text-letter-spacing").evaluate(o,{},a)*qm,c=h.get("text-line-height").evaluate(o,{},a)*qm,u=Oa(i)?s:0,p=h.get("text-anchor").evaluate(o,{},a),m=h.get("text-variable-anchor");if(!m){const t=h.get("text-radial-offset").evaluate(o,{},a);x=t?Qg(p,[t*qm,Kg]):h.get("text-offset").evaluate(o,{},a).map((t=>t*qm))}let g=f?"center":h.get("text-justify").evaluate(o,{},a);const b="point"===h.get("symbol-placement"),w=b?h.get("text-max-width").evaluate(o,{},a)*qm:1/0,T=o=>{t.allowVerticalPlacement&&Ia(i)&&(v.vertical=ug(_,e,r,n,l,w,c,p,o,u,x,ag.vertical,!0,y,d))};if(!f&&m){const t="auto"===g?m.map((t=>ty(t))):[g];let i=!1;for(let o=0;o<t.length;o++){const s=t[o];if(!v.horizontal[s])if(i)v.horizontal[s]=v.horizontal[0];else{const t=ug(_,e,r,n,l,w,c,"center",s,u,x,ag.horizontal,!1,y,d);t&&(v.horizontal[s]=t,i=1===t.positionedLines.length)}}T("left")}else{if("auto"===g&&(g=ty(p)),b||h.get("text-writing-mode").indexOf("horizontal")>=0||!Ia(i)){const t=ug(_,e,r,n,l,w,c,p,g,u,x,ag.horizontal,!1,y,d);t&&(v.horizontal[g]=t)}T(b?"left":g)}}let w=!1;if(o.icon&&o.icon.namePrimary){const e=i[o.icon.namePrimary];e&&(b=bg(n[o.icon.namePrimary],o.icon.nameSecondary?n[o.icon.nameSecondary]:void 0,h.get("icon-offset").evaluate(o,{},a),h.get("icon-anchor").evaluate(o,{},a)),w=e.sdf,void 0===t.sdfIcons?t.sdfIcons=e.sdf:t.sdfIcons!==e.sdf&&fr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.pixelRatio||0!==h.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}const T=oy(v.horizontal)||v.vertical;t.iconsInText||(t.iconsInText=!!T&&T.iconsInText),(T||b)&&ey(t,o,v,b,i,p,y,0,x,w,s,a,c,u,g)}o&&t.generateCollisionDebugBuffers(l,t.collisionBoxArray)},t.dW=am,t.dX=ep,t.dY=Ap,t.dZ=jm,t.d_=of,t.da=yu,t.db=i,t.dc=ed,t.dd=td,t.de=function(e){const r=[0,0,0],i=t.ae.identity(new Float64Array(16));return t.ae.multiply(i,e.pixelMatrix,e.globeMatrix),t.$.transformMat4(r,r,i),new Ve(r[0],r[1])},t.df=u,t.dg=c,t.dh=function(t){const e=t.navigator?t.navigator.userAgent:null;return!!function(t){if(null==Pr){const e=t.navigator?t.navigator.userAgent:null;Pr=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Pr}(t)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},t.di=nr,t.dj=class{constructor(t,e,r){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!r,this._createSkuToken()}_createSkuToken(){const t=function(){let t="";for(let e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ci,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,r){if(!o(t))return t;const i=di(t);return i.params.push(`sdk=js-${e}`),i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||r)}normalizeGlyphsURL(t,e){if(!o(t))return t;const r=di(t);return r.path=`/fonts/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeModelURL(t,e){if(!o(t))return t;const r=di(t);return r.path=`/models/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeSourceURL(t,e,r,i){if(!o(t))return t;const n=di(t);return n.path=`/v4/${n.authority}.json`,n.params.push("secure"),r&&n.params.push(`language=${r}`),i&&n.params.push(`worldview=${i}`),this._makeAPIURL(n,this._customAccessToken||e)}normalizeSpriteURL(t,e,r,i){const n=di(t);return o(t)?(n.path=`/styles/v1${n.path}/sprite${e}${r}`,this._makeAPIURL(n,this._customAccessToken||i)):(n.path+=`${e}${r}`,pi(n))}normalizeTileURL(t,e,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!o(t))return t;const n=di(t);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||r&&"raster"!==n.authority&&512===r?"@2x":""}${qr.supported?".webp":"$1"}`),"raster"===n.authority?n.path=`/${i.RASTER_URL_PREFIX}${n.path}`:"rasterarrays"===n.authority?n.path=`/${i.RASTERARRAYS_URL_PREFIX}${n.path}`:"3dtiles"===n.authority?n.path=`/${i.TILES3D_URL_PREFIX}${n.path}`:(n.path=n.path.replace(/^.+\/v4\//,"/"),n.path=`/${i.TILE_URL_VERSION}${n.path}`);const s=this._customAccessToken||function(t){for(const e of t){const t=e.match(/^access_token=(.*)$/);if(t)return t[1]}return null}(n.params)||i.ACCESS_TOKEN;return i.REQUIRE_ACCESS_TOKEN&&s&&this._skuToken&&n.params.push(`sku=${this._skuToken}`),this._makeAPIURL(n,s)}canonicalizeTileURL(t,e){const r=di(t);if(!r.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!r.path.match(/\.[\w]+$/))return t;let n="mapbox://";r.path.match(/^\/raster\/v1\//)?n+=`raster/${r.path.replace(`/${i.RASTER_URL_PREFIX}/`,"")}`:r.path.match(/^\/rasterarrays\/v1\//)?n+=`rasterarrays/${r.path.replace(`/${i.RASTERARRAYS_URL_PREFIX}/`,"")}`:n+=`tiles/${r.path.replace(`/${i.TILE_URL_VERSION}/`,"")}`;let o=r.params;return e&&(o=o.filter((t=>!t.match(/^access_token=/)))),o.length&&(n+=`?${o.join("&")}`),n}canonicalizeTileset(t,e){const r=!!e&&o(e),i=[];for(const e of t.tiles||[])n(e)?i.push(this.canonicalizeTileURL(e,r)):i.push(e);return i}_makeAPIURL(t,e){const r="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",n=di(i.API_URL);if(t.protocol=n.protocol,t.authority=n.authority,"http"===t.protocol){const e=t.params.indexOf("secure");e>=0&&t.params.splice(e,1)}if("/"!==n.path&&(t.path=`${n.path}${t.path}`),!i.REQUIRE_ACCESS_TOKEN)return pi(t);if(e=e||i.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${r}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${r}`)}return t.params=t.params.filter((t=>-1===t.indexOf("access_token"))),t.params.push(`access_token=${e||""}`),pi(t)}},t.dk=function(t,e){e?ki.add(t):ki.delete(t)},t.dl=qr,t.dm=Ei,t.dn=Pi,t.dp=ui,t.dq=bi,t.dr=wi,t.ds=function(t){ki.delete(t)},t.dt=Si,t.du=_i,t.dv=tr,t.dw=e,t.dx=function(t,e){zr=t,jr=e},t.dy=function(t,e,r=!1){if($a===ja||$a===Na||$a===Va)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ga=Dr.resolveURL(t),$a=ja,Ua=e,qa(),r||Xa()},t.dz=Za,t.e=Dr,t.e0=Mp,t.e1=gp,t.e2=je,t.e3=vm,t.e4=d,t.e5=ii,t.e6=function(t){let e=0;if(new Uint32Array(t,0,1)[0]!==$b){const r=new Uint32Array(t,0,7),[,,i,n,o,s]=r;e=r.byteLength+n+o+s+o,(i!==t.byteLength||e>=t.byteLength)&&fr("Invalid b3dm header information.")}return Xb(t,e)},t.e7=function(t,e){const r=ix(t);for(const t of r){for(const e of t.meshes)nx(e);t.lights&&(t.lightMeshIndex=t.meshes.length,t.meshes.push(ox(t.lights,e)))}return r},t.e8=dx,t.e9=_b,t.ea=Ya,t.eb=function(t){Gr(),Vr&&Vr.then((e=>{e.keys().then((r=>{for(let i=0;i<r.length-t;i++)e.delete(r[i])}))}))},t.f=Ri,t.g=Di,t.h=function(t,e){return ri(rr(t,{type:"json"}),e)},t.i=li,t.j=yd,t.k=Ig,t.l=function(t){return fetch(t).then((t=>t.arrayBuffer())).then((e=>Xb(e,0,t)))},t.m=Lg,t.n=class extends rb{},t.o=Mn,t.p=lv,t.q=Xi,t.r=ta,t.s=ia,t.t=ra,t.u=hl,t.v=pa,t.w=fr,t.x=dl,t.y=ya,t.z=fa})),i(["./shared"],(function(t){function e(t){const e=t?t.url.toString():void 0;return e?performance.getEntriesByName(e):[]}function r(t){if("number"==typeof t||"boolean"==typeof t||"string"==typeof t||null==t)return JSON.stringify(t);if(Array.isArray(t)){let e="[";for(const i of t)e+=`${r(i)},`;return`${e}]`}let e="{";for(const i of Object.keys(t).sort())e+=`${i}:${r(t[i])},`;return`${e}}`}function i(e){let i="";for(const n of t.cG)i+=`/${r(e[n])}`;return i}class n{constructor(t){this.keyCache={},this._layers={},this._layerConfigs={},t&&this.replace(t)}replace(t,e){this._layerConfigs={},this._layers={},this.update(t,[],e)}update(e,r,n){this._options=n;for(const r of e)this._layerConfigs[r.id]=r,(this._layers[r.id]=t.c$(r,this.scope,null,this._options)).compileFilter(),this.keyCache[r.id]&&delete this.keyCache[r.id];for(const t of r)delete this.keyCache[t],delete this._layerConfigs[t],delete this._layers[t];this.familiesBySource={};const o=function(t,e){const r={};for(let n=0;n<t.length;n++){const o=e&&e[t[n].id]||i(t[n]);e&&(e[t[n].id]=o);let s=r[o];s||(s=r[o]=[]),s.push(t[n])}const n=[];for(const t in r)n.push(r[t]);return n}(t.dJ(this._layerConfigs),this.keyCache);for(const t of o){const e=t.map((t=>this._layers[t.id])),r=e[0];if("none"===r.visibility)continue;const i=r.source||"";let n=this.familiesBySource[i];n||(n=this.familiesBySource[i]={});const o=r.sourceLayer||"_geojsonTileLayer";let s=n[o];s||(s=n[o]=[]),s.push(e)}}}const o=1*t.dM;class s{constructor(e){const r={},i=[];for(const t in e){const n=e[t],s=r[t]={};for(const t in n.glyphs){const e=n.glyphs[+t];if(!e||0===e.bitmap.width||0===e.bitmap.height)continue;const r=e.metrics.localGlyph?o:1,a={x:0,y:0,w:e.bitmap.width+2*r,h:e.bitmap.height+2*r};i.push(a),s[t]=a}}const{w:n,h:s}=t.k(i),a=new t.dL({width:n||1,height:s||1});for(const i in e){const n=e[i];for(const e in n.glyphs){const s=n.glyphs[+e];if(!s||0===s.bitmap.width||0===s.bitmap.height)continue;const l=r[i][e],c=s.metrics.localGlyph?o:1;t.dL.copy(s.bitmap,a,{x:0,y:0},{x:l.x+c,y:l.y+c},s.bitmap)}}this.image=a,this.positions=r}}t.dK(s,"GlyphAtlas");class a{constructor(e){this.tileID=new t.aQ(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.lut=e.lut,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.scope=e.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.promoteId=e.promoteId,this.isSymbolTile=e.isSymbolTile,this.tileTransform=t.dN(e.tileID.canonical,e.projection),this.projection=e.projection,this.brightness=e.brightness,this.extraShadowCaster=!!e.extraShadowCaster,this.tessellationStep=e.tessellationStep}parse(e,r,i,n,o){this.status="parsing",this.data=e,this.collisionBoxArray=new t.dO;const a=new t.dP(Object.keys(e.layers).sort()),c=new t.dQ(this.tileID,this.promoteId);c.bucketLayerIDs=[];const u={},h=new t.dR(256,256),d={featureIndex:c,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:h,availableImages:i,brightness:this.brightness},p=r.familiesBySource[this.source];for(const r in p){const n=e.layers[r];if(!n)continue;let o=!1,s=!1,h=!1;for(const t of p[r])"symbol"===t[0].type?o=!0:s=!0,t[0].is3D()&&"model"!==t[0].type&&(h=!0);if(this.extraShadowCaster&&!h)continue;if(!0===this.isSymbolTile&&!o)continue;if(!1===this.isSymbolTile&&!s)continue;1===n.version&&t.w(`Vector tile source "${this.source}" layer "${r}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const f=a.encode(r),m=[];for(let t=0;t<n.length;t++){const e=n.feature(t),i=c.getId(e,r);m.push({feature:e,id:i,index:t,sourceLayerIndex:f})}for(const t of p[r]){const e=t[0];(!this.extraShadowCaster||e.is3D()&&"model"!==e.type)&&(void 0!==this.isSymbolTile&&"symbol"===e.type!==this.isSymbolTile||e.minzoom&&this.zoom<Math.floor(e.minzoom)||e.maxzoom&&this.zoom>=e.maxzoom||"none"!==e.visibility&&(l(t,this.zoom,d.brightness,i),(u[e.id]=e.createBucket({index:c.bucketLayerIDs.length,layers:t,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:f,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(m,d,this.tileID.canonical,this.tileTransform),c.bucketLayerIDs.push(t.map((t=>t.id)))))}}let f,m,g,y;h.trim();const v={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},_=()=>{if(f)return this.status="done",o(f);if(this.extraShadowCaster)this.status="done",o(null,{buckets:t.dJ(u).filter((t=>!t.isEmpty())),featureIndex:c,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:d.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(m&&g&&y){const e=new s(m),r=new t.dT(g,y,this.lut);for(const n in u){const o=u[n];o instanceof t.dU?(l(o.layers,this.zoom,d.brightness,i),t.dV(o,m,e.positions,g,r.iconPositions,this.showCollisionBoxes,i,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):o.hasPattern&&(o instanceof t.dW||o instanceof t.dX||o instanceof t.c0)&&(l(o.layers,this.zoom,d.brightness,i),o.addFeatures(d,this.tileID.canonical,r.patternPositions,i,this.tileTransform,this.brightness))}this.status="done",o(null,{buckets:t.dJ(u).filter((t=>!t.isEmpty())),featureIndex:c,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,lineAtlas:h,imageAtlas:r,brightness:d.brightness})}};if(!this.extraShadowCaster){const e=t.dS(d.glyphDependencies,(t=>Object.keys(t).map(Number)));Object.keys(e).length?n.send("getGlyphs",{uid:this.uid,stacks:e,scope:this.scope},((t,e)=>{f||(f=t,m=e,_())}),void 0,!1,v):m={};const r=Object.keys(d.iconDependencies);r.length?n.send("getImages",{icons:r,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},((t,e)=>{f||(f=t,g=e,_())}),void 0,!1,v):g={};const i=Object.keys(d.patternDependencies);i.length?n.send("getImages",{icons:i,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},((t,e)=>{f||(f=t,y=e,_())}),void 0,!1,v):y={}}_()}}function l(e,r,i,n){const o=new t.Y(r,{brightness:i});for(const t of e)t.recalculate(o,n)}class c extends t.E{constructor(e,r,i,n,o,s){super(),this.actor=e,this.layerIndex=r,this.availableImages=i,this.loadVectorData=o||t.aq,this.loading={},this.loaded={},this.deduped=new t.ap(e.scheduler),this.isSpriteLoaded=n,this.scheduler=e.scheduler,this.brightness=s}loadTile(r,i){const n=r.uid,o=r&&r.request,s=o&&o.collectResourceTiming,l=this.loading[n]=new a(r);l.abort=this.loadVectorData(r,((a,c)=>{const u=!this.loading[n];if(delete this.loading[n],u||a||!c)return l.status="done",u||(this.loaded[n]=l),i(a);const h=c.rawData,d={};c.expires&&(d.expires=c.expires),c.cacheControl&&(d.cacheControl=c.cacheControl),l.vectorTile=c.vectorTile||new t.dY(new t.dZ(h));const p=()=>{l.parse(l.vectorTile,this.layerIndex,this.availableImages,this.actor,((r,n)=>{if(r||!n)return i(r);const a={};if(s){const t=e(o);t.length>0&&(a.resourceTiming=JSON.parse(JSON.stringify(t)))}i(null,t.Q({rawTileData:h.slice(0)},n,d,a))}))};this.isSpriteLoaded?p():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(p,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom}):p()})),this.loaded=this.loaded||{},this.loaded[n]=l}))}reloadTile(e,r){const i=this.loaded,n=e.uid;if(i&&i[n]){const o=i[n];o.showCollisionBoxes=e.showCollisionBoxes,o.projection=e.projection,o.brightness=e.brightness,o.tileTransform=t.dN(e.tileID.canonical,e.projection),o.extraShadowCaster=e.extraShadowCaster,o.lut=e.lut;const s=(t,e)=>{const i=o.reloadCallback;i&&(delete o.reloadCallback,o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,i)),r(t,e)};"parsing"===o.status?o.reloadCallback=s:"done"===o.status&&(o.vectorTile?o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}else r(null,void 0)}abortTile(t,e){const r=t.uid,i=this.loading[r];i&&(i.abort&&i.abort(),delete this.loading[r]),e()}removeTile(t,e){const r=this.loaded,i=t.uid;r&&r[i]&&delete r[i],e()}}class u{loadTile(e,r){const{uid:i,encoding:n,rawImageData:o,padding:s}=e,a=ImageBitmap&&o instanceof ImageBitmap?this.getImageData(o,s):o;r(null,new t.d_(i,a,n,s<1))}getImageData(t,e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(t.width,t.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=t.width,this.offscreenCanvas.height=t.height,this.offscreenCanvasContext.drawImage(t,0,0,t.width,t.height);const r=this.offscreenCanvasContext.getImageData(-e,-e,t.width+2*e,t.height+2*e);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),r}}t.d$.setPbf(t.dZ);class h{decodeRasterArray({task:e,buffer:r},i){t.d$.performDecoding(r,e).then((t=>{i(null,t)}),(t=>{i(t)}))}}const d=t.e0.prototype.toGeoJSON;let p=class{constructor(e){this._feature=e,this.extent=t.a4,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(1===this._feature.type){const e=[];for(const r of this._feature.geometry)e.push([new t.P(r[0],r[1])]);return e}{const e=[];for(const r of this._feature.geometry){const i=[];for(const e of r)i.push(new t.P(e[0],e[1]));e.push(i)}return e}}toGeoJSON(t,e,r){return d.call(this,t,e,r)}},f=class{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.a4,this.length=e.length,this._features=e}feature(t){return new p(this._features[t])}};const m=64/4096,g=128;class y{constructor(){this.features=new Map}clear(){this.features.clear()}load(t=[],e){for(const r of t){const t=r.id;if(null==t)continue;let i=this.features.get(t);i&&this.updateCache(i,e),r.geometry?(i=_(r),this.updateCache(i,e),this.features.set(t,i)):this.features.delete(t),this.updateCache(i,e)}}updateCache(t,e){for(const{canonical:r,uid:i}of Object.values(e)){const{z:n,x:o,y:s}=r;v(t,Math.pow(2,n),o,s)&&delete e[i]}}getTile(t,e,r){const i=Math.pow(2,t),n=[];for(const t of this.features.values())v(t,i,e,r)&&n.push(T(t,i,e,r));return{features:n}}getFeatures(){return[...this.features.values()]}}function v({minX:t,minY:e,maxX:r,maxY:i},n,o,s){return t<(o+1+m)/n&&e<(s+1+m)/n&&r>(o-m)/n&&i>(s-m)/n}function _(t){const{id:e,geometry:r,properties:i}=t;if(!r)return;if("GeometryCollection"===r.type)throw new Error("GeometryCollection not supported in dynamic mode.");const{type:n,coordinates:o}=r,s={id:e,type:1,geometry:[],tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},a=s.geometry;if("Point"===n)b(o,a,s);else if("MultiPoint"===n)for(const t of o)b(t,a,s);else if("LineString"===n)s.type=2,x(o,a,s);else if("MultiLineString"===n)s.type=2,w(o,a,s);else if("Polygon"===n)s.type=3,w(o,a,s,!0);else{if("MultiPolygon"!==n)throw new Error("Input data is not a valid GeoJSON object.");s.type=3;for(const t of o)w(t,a,s,!0)}return s}function b([e,r],i,n){const o=t.ak(e);let s=t.al(r);s=s<0?0:s>1?1:s,i.push(o,s),n.minX=Math.min(n.minX,o),n.minY=Math.min(n.minY,s),n.maxX=Math.max(n.maxX,o),n.maxY=Math.max(n.maxY,s)}function x(t,e,r,i=!1,n=!1){const o=[];for(const e of t)b(e,o,r);e.push(o),i&&function(t,e){let r=0;for(let e=0,i=t.length,n=i-2;e<i;n=e,e+=2)r+=(t[e]-t[n])*(t[e+1]+t[n+1]);if(r>0===e)for(let e=0,r=t.length;e<r/2;e+=2){const i=t[e],n=t[e+1];t[e]=t[r-2-e],t[e+1]=t[r-1-e],t[r-2-e]=i,t[r-1-e]=n}}(o,n)}function w(t,e,r,i=!1){for(let n=0;n<t.length;n++)x(t[n],e,r,i,0===n)}function T(e,r,i,n){const{id:o,type:s,geometry:a,tags:l}=e,c=[];if(1===s)!function(e,r,i,n,o){for(let s=0;s<e.length;s+=2){const a=Math.round(t.a4*(e[s+0]*r-i)),l=Math.round(t.a4*(e[s+1]*r-n));o.push([a,l])}}(a,r,i,n,c);else for(const t of a)E(t,r,i,n,c);return{id:o,type:s,geometry:c,tags:l}}function E(e,r,i,n,o){const s=-g,a=t.a4+g;let l;for(let c=0;c<e.length-2;c+=2){let u=Math.round(t.a4*(e[c+0]*r-i)),h=Math.round(t.a4*(e[c+1]*r-n)),d=Math.round(t.a4*(e[c+2]*r-i)),p=Math.round(t.a4*(e[c+3]*r-n));const f=d-u,m=p-h;u<s&&d<s||(u<s?(h+=Math.round(m*((s-u)/f)),u=s):d<s&&(p=h+Math.round(m*((s-u)/f)),d=s),h<s&&p<s||(h<s?(u+=Math.round(f*((s-h)/m)),h=s):p<s&&(d=u+Math.round(f*((s-h)/m)),p=s),u>=a&&d>=a||(u>=a?(h+=Math.round(m*((a-u)/f)),u=a):d>=a&&(p=h+Math.round(m*((a-u)/f)),d=a),h>=a&&p>=a||(h>=a?(u+=Math.round(f*((a-h)/m)),h=a):p>=a&&(d=u+Math.round(f*((a-h)/m)),p=a),l&&u===l[l.length-1][0]&&h===l[l.length-1][1]||(l=[[u,h]],o.push(l)),l.push([d,p])))))}}var S={exports:{}},P=t.e2,k=t.e1.VectorTileFeature,A=M;function M(t,e){this.options=e||{},this.features=t,this.length=t.length}function C(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}M.prototype.feature=function(t){return new C(this.features[t],this.options.extent)},C.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var r=t[e],i=[],n=0;n<r.length;n++)i.push(new P(r[n][0],r[n][1]));this.geometry.push(i)}return this.geometry},C.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,r=-1/0,i=1/0,n=-1/0,o=0;o<t.length;o++)for(var s=t[o],a=0;a<s.length;a++){var l=s[a];e=Math.min(e,l.x),r=Math.max(r,l.x),i=Math.min(i,l.y),n=Math.max(n,l.y)}return[e,i,r,n]},C.prototype.toGeoJSON=k.prototype.toGeoJSON;var I=t.e3,O=A;function L(t){var e=new I;return function(t,e){for(var r in t.layers)e.writeMessage(3,D,t.layers[r])}(t,e),e.finish()}function D(t,e){var r;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var i={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<t.length;r++)i.feature=t.feature(r),e.writeMessage(2,R,i);var n=i.keys;for(r=0;r<n.length;r++)e.writeStringField(3,n[r]);var o=i.values;for(r=0;r<o.length;r++)e.writeMessage(4,N,o[r])}function R(t,e){var r=t.feature;void 0!==r.id&&e.writeVarintField(1,r.id),e.writeMessage(2,F,t),e.writeVarintField(3,r.type),e.writeMessage(4,j,r)}function F(t,e){var r=t.feature,i=t.keys,n=t.values,o=t.keycache,s=t.valuecache;for(var a in r.properties){var l=r.properties[a],c=o[a];if(null!==l){void 0===c&&(i.push(a),o[a]=c=i.length-1),e.writeVarint(c);var u=typeof l;"string"!==u&&"boolean"!==u&&"number"!==u&&(l=JSON.stringify(l));var h=u+":"+l,d=s[h];void 0===d&&(n.push(l),s[h]=d=n.length-1),e.writeVarint(d)}}}function B(t,e){return(e<<3)+(7&t)}function z(t){return t<<1^t>>31}function j(t,e){for(var r=t.loadGeometry(),i=t.type,n=0,o=0,s=r.length,a=0;a<s;a++){var l=r[a],c=1;1===i&&(c=l.length),e.writeVarint(B(1,c));for(var u=3===i?l.length-1:l.length,h=0;h<u;h++){1===h&&1!==i&&e.writeVarint(B(2,u-1));var d=l[h].x-n,p=l[h].y-o;e.writeVarint(z(d)),e.writeVarint(z(p)),n+=d,o+=p}3===i&&e.writeVarint(B(7,1))}}function N(t,e){var r=typeof t;"string"===r?e.writeStringField(1,t):"boolean"===r?e.writeBooleanField(7,t):"number"===r&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}S.exports=L,S.exports.fromVectorTileJs=L,S.exports.fromGeojsonVt=function(t,e){e=e||{};var r={};for(var i in t)r[i]=new O(t[i].features,e),r[i].name=i,r[i].version=e.version,r[i].extent=e.extent;return L({layers:r})},S.exports.GeoJSONWrapper=O;var V=t.e4(S.exports);const U={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},$=Math.fround||(G=new Float32Array(1),t=>(G[0]=+t,G[0]));var G;const H=3,q=5,W=6;class Z{constructor(t){this.options=Object.assign(Object.create(U),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:e,minZoom:r,maxZoom:i}=this.options;e&&console.time("total time");const n=`prepare ${t.length} points`;e&&console.time(n),this.points=t;const o=[];for(let e=0;e<t.length;e++){const r=t[e];if(!r.geometry)continue;const[i,n]=r.geometry.coordinates,s=$(K(i)),a=$(J(n));o.push(s,a,1/0,e,-1,1),this.options.reduce&&o.push(0)}let s=this.trees[i+1]=this._createTree(o);e&&console.timeEnd(n);for(let t=i;t>=r;t--){const r=+Date.now();s=this.trees[t]=this._createTree(this._cluster(s,t)),e&&console.log("z%d: %d clusters in %dms",t,s.numItems,+Date.now()-r)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let r=((t[0]+180)%360+360)%360-180;const i=Math.max(-90,Math.min(90,t[1]));let n=180===t[2]?180:((t[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)r=-180,n=180;else if(r>n){const t=this.getClusters([r,i,180,o],e),s=this.getClusters([-180,i,n,o],e);return t.concat(s)}const s=this.trees[this._limitZoom(e)],a=s.range(K(r),J(o),K(n),J(i)),l=s.data,c=[];for(const t of a){const e=this.stride*t;c.push(l[e+q]>1?X(l,e,this.clusterProps):this.points[l[e+H]])}return c}getChildren(t){const e=this._getOriginId(t),r=this._getOriginZoom(t),i="No cluster with the specified id.",n=this.trees[r];if(!n)throw new Error(i);const o=n.data;if(e*this.stride>=o.length)throw new Error(i);const s=this.options.radius/(this.options.extent*Math.pow(2,r-1)),a=n.within(o[e*this.stride],o[e*this.stride+1],s),l=[];for(const e of a){const r=e*this.stride;o[r+4]===t&&l.push(o[r+q]>1?X(o,r,this.clusterProps):this.points[o[r+H]])}if(0===l.length)throw new Error(i);return l}getLeaves(t,e,r){const i=[];return this._appendLeaves(i,t,e=e||10,r=r||0,0),i}getTile(t,e,r){const i=this.trees[this._limitZoom(t)],n=Math.pow(2,t),{extent:o,radius:s}=this.options,a=s/o,l=(r-a)/n,c=(r+1+a)/n,u={features:[]};return this._addTileFeatures(i.range((e-a)/n,l,(e+1+a)/n,c),i.data,e,r,n,u),0===e&&this._addTileFeatures(i.range(1-a/n,l,1,c),i.data,n,r,n,u),e===n-1&&this._addTileFeatures(i.range(0,l,a/n,c),i.data,-1,r,n,u),u.features.length?u:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const r=this.getChildren(t);if(e++,1!==r.length)break;t=r[0].properties.cluster_id}return e}_appendLeaves(t,e,r,i,n){const o=this.getChildren(e);for(const e of o){const o=e.properties;if(o&&o.cluster?n+o.point_count<=i?n+=o.point_count:n=this._appendLeaves(t,o.cluster_id,r,i,n):n<i?n++:t.push(e),t.length===r)break}return n}_createTree(e){const r=new t.cN(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let t=0;t<e.length;t+=this.stride)r.add(e[t],e[t+1]);return r.finish(),r.data=e,r}_addTileFeatures(t,e,r,i,n,o){for(const s of t){const t=s*this.stride,a=e[t+q]>1;let l,c,u;if(a)l=Y(e,t,this.clusterProps),c=e[t],u=e[t+1];else{const r=this.points[e[t+H]];l=r.properties;const[i,n]=r.geometry.coordinates;c=K(i),u=J(n)}const h={type:1,geometry:[[Math.round(this.options.extent*(c*n-r)),Math.round(this.options.extent*(u*n-i))]],tags:l};let d;d=a||this.options.generateId?e[t+H]:this.points[e[t+H]].id,void 0!==d&&(h.id=d),o.features.push(h)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,e){const{radius:r,extent:i,reduce:n,minPoints:o}=this.options,s=r/(i*Math.pow(2,e)),a=t.data,l=[],c=this.stride;for(let r=0;r<a.length;r+=c){if(a[r+2]<=e)continue;a[r+2]=e;const i=a[r],u=a[r+1],h=t.within(a[r],a[r+1],s),d=a[r+q];let p=d;for(const t of h){const r=t*c;a[r+2]>e&&(p+=a[r+q])}if(p>d&&p>=o){let t,o=i*d,s=u*d,f=-1;const m=(r/c<<5)+(e+1)+this.points.length;for(const i of h){const l=i*c;if(a[l+2]<=e)continue;a[l+2]=e;const u=a[l+q];o+=a[l]*u,s+=a[l+1]*u,a[l+4]=m,n&&(t||(t=this._map(a,r,!0),f=this.clusterProps.length,this.clusterProps.push(t)),n(t,this._map(a,l)))}a[r+4]=m,l.push(o/p,s/p,1/0,m,-1,p),n&&l.push(f)}else{for(let t=0;t<c;t++)l.push(a[r+t]);if(p>1)for(const t of h){const r=t*c;if(!(a[r+2]<=e)){a[r+2]=e;for(let t=0;t<c;t++)l.push(a[r+t])}}}}return l}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e,r){if(t[e+q]>1){const i=this.clusterProps[t[e+W]];return r?Object.assign({},i):i}const i=this.points[t[e+H]].properties,n=this.options.map(i);return r&&n===i?Object.assign({},n):n}}function X(t,e,r){return{type:"Feature",id:t[e+H],properties:Y(t,e,r),geometry:{type:"Point",coordinates:[(i=t[e],360*(i-.5)),Q(t[e+1])]}};var i}function Y(t,e,r){const i=t[e+q],n=i>=1e4?`${Math.round(i/1e3)}k`:i>=1e3?Math.round(i/100)/10+"k":i,o=t[e+W],s=-1===o?{}:Object.assign({},r[o]);return Object.assign(s,{cluster:!0,cluster_id:t[e+H],point_count:i,point_count_abbreviated:n})}function K(t){return t/360+.5}function J(t){const e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function Q(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function tt(t,e,r,i){let n=i;const o=e+(r-e>>1);let s,a=r-e;const l=t[e],c=t[e+1],u=t[r],h=t[r+1];for(let i=e+3;i<r;i+=3){const e=et(t[i],t[i+1],l,c,u,h);if(e>n)s=i,n=e;else if(e===n){const t=Math.abs(i-o);t<a&&(s=i,a=t)}}n>i&&(s-e>3&&tt(t,e,s,i),t[s+2]=n,r-s>3&&tt(t,s,r,i))}function et(t,e,r,i,n,o){let s=n-r,a=o-i;if(0!==s||0!==a){const l=((t-r)*s+(e-i)*a)/(s*s+a*a);l>1?(r=n,i=o):l>0&&(r+=s*l,i+=a*l)}return s=t-r,a=e-i,s*s+a*a}function rt(t,e,r,i){const n={id:t??null,type:e,geometry:r,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if("Point"===e||"MultiPoint"===e||"LineString"===e)it(n,r);else if("Polygon"===e)it(n,r[0]);else if("MultiLineString"===e)for(const t of r)it(n,t);else if("MultiPolygon"===e)for(const t of r)it(n,t[0]);return n}function it(t,e){for(let r=0;r<e.length;r+=3)t.minX=Math.min(t.minX,e[r]),t.minY=Math.min(t.minY,e[r+1]),t.maxX=Math.max(t.maxX,e[r]),t.maxY=Math.max(t.maxY,e[r+1])}function nt(t,e,r,i){if(!e.geometry)return;const n=e.geometry.coordinates;if(n&&0===n.length)return;const o=e.geometry.type,s=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2);let a=[],l=e.id;if(r.promoteId?l=e.properties[r.promoteId]:r.generateId&&(l=i||0),"Point"===o)ot(n,a);else if("MultiPoint"===o)for(const t of n)ot(t,a);else if("LineString"===o)st(n,a,s,!1);else if("MultiLineString"===o){if(r.lineMetrics){for(const r of n)a=[],st(r,a,s,!1),t.push(rt(l,"LineString",a,e.properties));return}at(n,a,s,!1)}else if("Polygon"===o)at(n,a,s,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(const n of e.geometry.geometries)nt(t,{id:l,geometry:n,properties:e.properties},r,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const t of n){const e=[];at(t,e,s,!0),a.push(e)}}t.push(rt(l,o,a,e.properties))}function ot(t,e){e.push(lt(t[0]),ct(t[1]),0)}function st(t,e,r,i){let n,o,s=0;for(let r=0;r<t.length;r++){const a=lt(t[r][0]),l=ct(t[r][1]);e.push(a,l,0),r>0&&(s+=i?(n*l-a*o)/2:Math.sqrt(Math.pow(a-n,2)+Math.pow(l-o,2))),n=a,o=l}const a=e.length-3;e[2]=1,tt(e,0,a,r),e[a+2]=1,e.size=Math.abs(s),e.start=0,e.end=e.size}function at(t,e,r,i){for(let n=0;n<t.length;n++){const o=[];st(t[n],o,r,i),e.push(o)}}function lt(t){return t/360+.5}function ct(t){const e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function ut(t,e,r,i,n,o,s,a){if(i/=e,o>=(r/=e)&&s<i)return t;if(s<r||o>=i)return null;const l=[];for(const e of t){const t=e.geometry;let o=e.type;const s=0===n?e.minX:e.minY,c=0===n?e.maxX:e.maxY;if(s>=r&&c<i){l.push(e);continue}if(c<r||s>=i)continue;let u=[];if("Point"===o||"MultiPoint"===o)ht(t,u,r,i,n);else if("LineString"===o)dt(t,u,r,i,n,!1,a.lineMetrics);else if("MultiLineString"===o)ft(t,u,r,i,n,!1);else if("Polygon"===o)ft(t,u,r,i,n,!0);else if("MultiPolygon"===o)for(const e of t){const t=[];ft(e,t,r,i,n,!0),t.length&&u.push(t)}if(u.length){if(a.lineMetrics&&"LineString"===o){for(const t of u)l.push(rt(e.id,o,t,e.tags));continue}"LineString"!==o&&"MultiLineString"!==o||(1===u.length?(o="LineString",u=u[0]):o="MultiLineString"),"Point"!==o&&"MultiPoint"!==o||(o=3===u.length?"Point":"MultiPoint"),l.push(rt(e.id,o,u,e.tags))}}return l.length?l:null}function ht(t,e,r,i,n){for(let o=0;o<t.length;o+=3){const s=t[o+n];s>=r&&s<=i&&mt(e,t[o],t[o+1],t[o+2])}}function dt(t,e,r,i,n,o,s){let a=pt(t);const l=0===n?gt:yt;let c,u,h=t.start;for(let d=0;d<t.length-3;d+=3){const p=t[d],f=t[d+1],m=t[d+2],g=t[d+3],y=t[d+4],v=0===n?p:f,_=0===n?g:y;let b=!1;s&&(c=Math.sqrt(Math.pow(p-g,2)+Math.pow(f-y,2))),v<r?_>r&&(u=l(a,p,f,g,y,r),s&&(a.start=h+c*u)):v>i?_<i&&(u=l(a,p,f,g,y,i),s&&(a.start=h+c*u)):mt(a,p,f,m),_<r&&v>=r&&(u=l(a,p,f,g,y,r),b=!0),_>i&&v<=i&&(u=l(a,p,f,g,y,i),b=!0),!o&&b&&(s&&(a.end=h+c*u),e.push(a),a=pt(t)),s&&(h+=c)}let d=t.length-3;const p=t[d],f=t[d+1],m=0===n?p:f;m>=r&&m<=i&&mt(a,p,f,t[d+2]),d=a.length-3,o&&d>=3&&(a[d]!==a[0]||a[d+1]!==a[1])&&mt(a,a[0],a[1],a[2]),a.length&&e.push(a)}function pt(t){const e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function ft(t,e,r,i,n,o){for(const s of t)dt(s,e,r,i,n,o,!1)}function mt(t,e,r,i){t.push(e,r,i)}function gt(t,e,r,i,n,o){const s=(o-e)/(i-e);return mt(t,o,r+(n-r)*s,1),s}function yt(t,e,r,i,n,o){const s=(o-r)/(n-r);return mt(t,e+(i-e)*s,o,1),s}function vt(t,e){const r=[];for(let i=0;i<t.length;i++){const n=t[i],o=n.type;let s;if("Point"===o||"MultiPoint"===o||"LineString"===o)s=_t(n.geometry,e);else if("MultiLineString"===o||"Polygon"===o){s=[];for(const t of n.geometry)s.push(_t(t,e))}else if("MultiPolygon"===o){s=[];for(const t of n.geometry){const r=[];for(const i of t)r.push(_t(i,e));s.push(r)}}r.push(rt(n.id,o,s,n.tags))}return r}function _t(t,e){const r=[];r.size=t.size,void 0!==t.start&&(r.start=t.start,r.end=t.end);for(let i=0;i<t.length;i+=3)r.push(t[i]+e,t[i+1],t[i+2]);return r}function bt(t,e){if(t.transformed)return t;const r=1<<t.z,i=t.x,n=t.y;for(const o of t.features){const t=o.geometry,s=o.type;if(o.geometry=[],1===s)for(let s=0;s<t.length;s+=2)o.geometry.push(xt(t[s],t[s+1],e,r,i,n));else for(let s=0;s<t.length;s++){const a=[];for(let o=0;o<t[s].length;o+=2)a.push(xt(t[s][o],t[s][o+1],e,r,i,n));o.geometry.push(a)}}return t.transformed=!0,t}function xt(t,e,r,i,n,o){return[Math.round(r*(t*i-n)),Math.round(r*(e*i-o))]}function wt(t,e,r,i,n){const o=e===n.maxZoom?0:n.tolerance/((1<<e)*n.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:t.length,source:null,x:r,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const e of t)Tt(s,e,o,n);return s}function Tt(t,e,r,i){const n=e.geometry,o=e.type,s=[];if(t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),"Point"===o||"MultiPoint"===o)for(let e=0;e<n.length;e+=3)s.push(n[e],n[e+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)Et(s,n,t,r,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(let e=0;e<n.length;e++)Et(s,n[e],t,r,"Polygon"===o,0===e);else if("MultiPolygon"===o)for(let e=0;e<n.length;e++){const i=n[e];for(let e=0;e<i.length;e++)Et(s,i[e],t,r,!0,0===e)}if(s.length){let r=e.tags||null;if("LineString"===o&&i.lineMetrics){r={};for(const t in e.tags)r[t]=e.tags[t];r.mapbox_clip_start=n.start/n.size,r.mapbox_clip_end=n.end/n.size}const a={geometry:s,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:r};null!==e.id&&(a.id=e.id),t.features.push(a)}}function Et(t,e,r,i,n,o){const s=i*i;if(i>0&&e.size<(n?s:i))return void(r.numPoints+=e.length/3);const a=[];for(let t=0;t<e.length;t+=3)(0===i||e[t+2]>s)&&(r.numSimplified++,a.push(e[t],e[t+1])),r.numPoints++;n&&function(t,e){let r=0;for(let e=0,i=t.length,n=i-2;e<i;n=e,e+=2)r+=(t[e]-t[n])*(t[e+1]+t[n+1]);if(r>0===e)for(let e=0,r=t.length;e<r/2;e+=2){const i=t[e],n=t[e+1];t[e]=t[r-2-e],t[e+1]=t[r-1-e],t[r-2-e]=i,t[r-1-e]=n}}(a,o),t.push(a)}const St={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Pt{constructor(t,e){const r=(e=this.options=function(t,e){for(const r in e)t[r]=e[r];return t}(Object.create(St),e)).debug;if(r&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");let i=function(t,e){const r=[];if("FeatureCollection"===t.type)for(let i=0;i<t.features.length;i++)nt(r,t.features[i],e,i);else nt(r,"Feature"===t.type?t:{geometry:t},e);return r}(t,e);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),i=function(t,e){const r=e.buffer/e.extent;let i=t;const n=ut(t,1,-1-r,r,0,-1,2,e),o=ut(t,1,1-r,2+r,0,-1,2,e);return(n||o)&&(i=ut(t,1,-r,1+r,0,-1,2,e)||[],n&&(i=vt(n,1).concat(i)),o&&(i=i.concat(vt(o,-1)))),i}(i,e),i.length&&this.splitTile(i,0,0,0),r&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(t,e,r,i,n,o,s){const a=[t,e,r,i],l=this.options,c=l.debug;for(;a.length;){i=a.pop(),r=a.pop(),e=a.pop(),t=a.pop();const u=1<<e,h=kt(e,r,i);let d=this.tiles[h];if(!d&&(c>1&&console.time("creation"),d=this.tiles[h]=wt(t,e,r,i,l),this.tileCoords.push({z:e,x:r,y:i}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,r,i,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));const t=`z${e}`;this.stats[t]=(this.stats[t]||0)+1,this.total++}if(d.source=t,null==n){if(e===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue}else{if(e===l.maxZoom||e===n)continue;if(null!=n){const t=n-e;if(r!==o>>t||i!==s>>t)continue}}if(d.source=null,0===t.length)continue;c>1&&console.time("clipping");const p=.5*l.buffer/l.extent,f=.5-p,m=.5+p,g=1+p;let y=null,v=null,_=null,b=null,x=ut(t,u,r-p,r+m,0,d.minX,d.maxX,l),w=ut(t,u,r+f,r+g,0,d.minX,d.maxX,l);t=null,x&&(y=ut(x,u,i-p,i+m,1,d.minY,d.maxY,l),v=ut(x,u,i+f,i+g,1,d.minY,d.maxY,l),x=null),w&&(_=ut(w,u,i-p,i+m,1,d.minY,d.maxY,l),b=ut(w,u,i+f,i+g,1,d.minY,d.maxY,l),w=null),c>1&&console.timeEnd("clipping"),a.push(y||[],e+1,2*r,2*i),a.push(v||[],e+1,2*r,2*i+1),a.push(_||[],e+1,2*r+1,2*i),a.push(b||[],e+1,2*r+1,2*i+1)}}getTile(t,e,r){t=+t,e=+e,r=+r;const i=this.options,{extent:n,debug:o}=i;if(t<0||t>24)return null;const s=1<<t,a=kt(t,e=e+s&s-1,r);if(this.tiles[a])return bt(this.tiles[a],n);o>1&&console.log("drilling down to z%d-%d-%d",t,e,r);let l,c=t,u=e,h=r;for(;!l&&c>0;)c--,u>>=1,h>>=1,l=this.tiles[kt(c,u,h)];return l&&l.source?(o>1&&(console.log("found parent tile z%d-%d-%d",c,u,h),console.time("drilling down")),this.splitTile(l.source,c,u,h,t,e,r),o>1&&console.timeEnd("drilling down"),this.tiles[a]?bt(this.tiles[a],n):null):null}}function kt(t,e,r){return 32*((1<<t)*r+e)+t}function At(t,e){const r=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);const i=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!i)return e(null,null);const n=new f(i.features);let o=V(n);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:n,rawData:o.buffer})}class Mt extends c{constructor(t,e,r,i,n,o){super(t,e,r,i,At,o),n&&(this.loadGeoJSON=n),this._dynamicIndex=new y}loadData(r,i){const n=r&&r.request,o=n&&n.collectResourceTiming;this.loadGeoJSON(r,((s,a)=>{if(s||!a)return i(s);if("object"!=typeof a)return i(new Error(`Input data given to '${r.source}' is not a valid GeoJSON object.`));{try{if(r.filter){const e=t.z(r.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===e.result)throw new Error(e.value.map((t=>`${t.key}: ${t.message}`)).join(", "));a.features=a.features.filter((t=>e.value.evaluate({zoom:0},t)))}r.dynamic?("Feature"===a.type&&(a={type:"FeatureCollection",features:[a]}),r.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(a.features,this.loaded),r.cluster&&(a.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=r.cluster?new Z(function({superclusterOptions:e,clusterProperties:r}){if(!r||!e)return e;const i={},n={},o={accumulated:null,zoom:0},s={properties:null},a=Object.keys(r);for(const e of a){const[o,s]=r[e],a=t.z(s),l=t.z("string"==typeof o?[o,["accumulated"],["get",e]]:o);i[e]=a.value,n[e]=l.value}return e.map=t=>{s.properties=t;const e={};for(const t of a)e[t]=i[t].evaluate(o,s);return e},e.reduce=(t,e)=>{s.properties=e;for(const e of a)o.accumulated=t[e],t[e]=n[e].evaluate(o,s)},e}(r)).load(a.features):r.dynamic?this._dynamicIndex:function(t,e){return new Pt(t,e)}(a,r.geojsonVtOptions)}catch(t){return i(t)}const s={};if(o){const t=e(n);t&&(s.resourceTiming={},s.resourceTiming[r.source]=JSON.parse(JSON.stringify(t)))}i(null,s)}}))}reloadTile(t,e){const r=this.loaded;return r&&r[t.uid]?t.partial?e(null,void 0):super.reloadTile(t,e):this.loadTile(t,e)}loadGeoJSON(e,r){if(e.request)t.h(e.request,r);else{if("string"!=typeof e.data)return r(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`));try{return r(null,JSON.parse(e.data))}catch(t){return r(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}}getClusterChildren(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}}getClusterLeaves(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}}}class Ct{constructor(e,r){this.tileID=new t.aQ(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=e.projection,this.brightness=r}parse(e,r,i,n){this.status="parsing";const o=new t.aQ(i.tileID.overscaledZ,i.tileID.wrap,i.tileID.canonical.z,i.tileID.canonical.x,i.tileID.canonical.y),s={},a=r.familiesBySource[i.source],l=new t.dQ(o,i.promoteId);return l.bucketLayerIDs=[],l.is3DTile=!0,t.e6(e).then((e=>{if(!e)return n(new Error("Could not parse tile"));const r=t.e7(e,1/t.b7(i.tileID.canonical)),c=e.json.extensionsUsed&&e.json.extensionsUsed.includes("MAPBOX_mesh_features")||e.json.asset.extras&&e.json.asset.extras.MAPBOX_mesh_features,u=e.json.extensionsUsed&&e.json.extensionsUsed.includes("EXT_meshopt_compression"),h=new t.Y(this.zoom,{brightness:this.brightness});for(const e in a)for(const i of a[e]){const e=i[0];l.bucketLayerIDs.push(i.map((t=>t.id))),e.recalculate(h,[]);const n=new t.e8(r,o,c,u,this.brightness,l);c||(n.needsUpload=!0),s[e.fqid]=n,n.evaluate(e)}this.status="done",n(null,{buckets:s,featureIndex:l})})).catch((t=>n(new Error(t.message))))}}class It{constructor(t,e,r,i,n,o){this.actor=t,this.layerIndex=e,this.brightness=o,this.loading={},this.loaded={}}loadTile(e,r){const i=e.uid,n=this.loading[i]=new Ct(e,this.brightness);t.e5(e.request,((t,o)=>{const s=!this.loading[i];return delete this.loading[i],s||t?(n.status="done",s||(this.loaded[i]=n),r(t)):o&&0!==o.byteLength?void n.parse(o,this.layerIndex,e,((t,e)=>{n.status="done",this.loaded=this.loaded||{},this.loaded[i]=n,t||!e?r(t):r(null,e)})):(n.status="done",this.loaded[i]=n,r())}))}reloadTile(t,e){const r=this.loaded,i=t.uid;if(r&&r[i]){const n=r[i];n.projection=t.projection,n.brightness=t.brightness;const o=(r,i)=>{n.reloadCallback&&(delete n.reloadCallback,this.loadTile(t,e)),e(r,i)};"parsing"===n.status?n.reloadCallback=o:"done"===n.status&&this.loadTile(t,e)}}abortTile(t,e){const r=t.uid;this.loading[r]&&delete this.loading[r],e()}removeTile(t,e){const r=this.loaded,i=t.uid;r&&r[i]&&delete r[i],e()}}class Ot{constructor(e){this.self=e,this.actor=new t.e9(e,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=t.aK({name:"mercator"}),this.workerSourceTypes={vector:c,geojson:Mt,"batched-model":It},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(t,e)=>{if(this.workerSourceTypes[t])throw new Error(`Worker source with name "${t}" already registered.`);this.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=e=>{if(t.ea.isParsed())throw new Error("RTL text plugin already registered.");t.ea.applyArabicShaping=e.applyArabicShaping,t.ea.processBidirectionalText=e.processBidirectionalText,t.ea.processStyledBidirectionalText=e.processStyledBidirectionalText}}clearCaches(t,e,r){delete this.layerIndexes[t],delete this.availableImages[t],delete this.workerSources[t],delete this.demWorkerSources[t],delete this.rasterArrayWorkerSource,r()}checkIfReady(t,e,r){r()}setReferrer(t,e){this.referrer=e}spriteLoaded(e,{scope:r,isLoaded:i}){if(this.isSpriteLoaded[e]||(this.isSpriteLoaded[e]={}),this.isSpriteLoaded[e][r]=i,this.workerSources[e]&&this.workerSources[e][r])for(const n in this.workerSources[e][r]){const o=this.workerSources[e][r][n];for(const e in o){const r=o[e];r instanceof c&&(r.isSpriteLoaded=i,r.fire(new t.g("isSpriteLoaded")))}}}setImages(t,{scope:e,images:r},i){if(this.availableImages[t]||(this.availableImages[t]={}),this.availableImages[t][e]=r,this.workerSources[t]&&this.workerSources[t][e]){for(const i in this.workerSources[t][e]){const n=this.workerSources[t][e][i];for(const t in n)n[t].availableImages=r}i()}else i()}setProjection(e,r){this.projections[e]=t.aK(r)}setBrightness(t,e,r){this.brightness=e,r()}setLayers(t,e,r){this.getLayerIndex(t,e.scope).replace(e.layers,e.options),r()}updateLayers(t,e,r){this.getLayerIndex(t,e.scope).update(e.layers,e.removedIds,e.options),r()}loadTile(t,e,r){e.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,e.type,e.source,e.scope).loadTile(e,r)}loadDEMTile(t,e,r){this.getDEMWorkerSource(t,e.source,e.scope).loadTile(e,r)}decodeRasterArray(t,e,r){this.getRasterArrayWorkerSource().decodeRasterArray(e,r)}reloadTile(t,e,r){e.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,e.type,e.source,e.scope).reloadTile(e,r)}abortTile(t,e,r){this.getWorkerSource(t,e.type,e.source,e.scope).abortTile(e,r)}removeTile(t,e,r){this.getWorkerSource(t,e.type,e.source,e.scope).removeTile(e,r)}removeSource(t,e,r){if(!(this.workerSources[t]&&this.workerSources[t][e.scope]&&this.workerSources[t][e.scope][e.type]&&this.workerSources[t][e.scope][e.type][e.source]))return;const i=this.workerSources[t][e.scope][e.type][e.source];delete this.workerSources[t][e.scope][e.type][e.source],void 0!==i.removeSource?i.removeSource(e,r):r()}loadWorkerSource(t,e,r){try{this.self.importScripts(e.url),r()}catch(t){r(t.toString())}}syncRTLPluginState(e,r,i){try{t.ea.setState(r);const e=t.ea.getPluginURL();if(t.ea.isLoaded()&&!t.ea.isParsed()&&null!=e){this.self.importScripts(e);const r=t.ea.isParsed();i(r?void 0:new Error(`RTL Text Plugin failed to import scripts from ${e}`),r)}}catch(t){i(t.toString())}}setDracoUrl(t,e){this.dracoUrl=e}getAvailableImages(t,e){this.availableImages[t]||(this.availableImages[t]={});let r=this.availableImages[t][e];return r||(r=[]),r}getLayerIndex(t,e){this.layerIndexes[t]||(this.layerIndexes[t]={});let r=this.layerIndexes[t][e];return r||(r=this.layerIndexes[t][e]=new n,r.scope=e),r}getWorkerSource(t,e,r,i){return this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][i]||(this.workerSources[t][i]={}),this.workerSources[t][i][e]||(this.workerSources[t][i][e]={}),this.isSpriteLoaded[t]||(this.isSpriteLoaded[t]={}),this.workerSources[t][i][e][r]||(this.workerSources[t][i][e][r]=new this.workerSourceTypes[e]({send:(e,r,i,n,o,s)=>{this.actor.send(e,r,i,t,o,s)},scheduler:this.actor.scheduler},this.getLayerIndex(t,i),this.getAvailableImages(t,i),this.isSpriteLoaded[t][i],void 0,this.brightness)),this.workerSources[t][i][e][r]}getDEMWorkerSource(t,e,r){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][r]||(this.demWorkerSources[t][r]={}),this.demWorkerSources[t][r][e]||(this.demWorkerSources[t][r][e]=new u),this.demWorkerSources[t][r][e]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new h),this.rasterArrayWorkerSource}enforceCacheSizeLimit(e,r){t.eb(r)}getWorkerPerformanceMetrics(t,e,r){r(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Ot(self)),Ot})),i(["./shared"],(function(t){var e=r;function r(t){return!function(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,r=new Blob([""],{type:"text/javascript"}),i=URL.createObjectURL(r);try{e=new Worker(i),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(i),t}()?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(!e)return!1;var r=e.getImageData(0,0,1,1);return r&&r.width===t.width}()?(void 0===i[e=t&&t.failIfMajorPerformanceCaveat]&&(i[e]=function(t){var e,i=function(t){var e=document.createElement("canvas"),i=Object.create(r.webGLContextAttributes);return i.failIfMajorPerformanceCaveat=t,e.getContext("webgl2",i)}(t);if(!i)return!1;try{e=i.createShader(i.VERTEX_SHADER)}catch(t){return!1}return!(!e||i.isContextLost())&&(i.shaderSource(e,"void main() {}"),i.compileShader(e),!0===i.getShaderParameter(e,i.COMPILE_STATUS))}(e)),i[e]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var e}(t)}var i={};function n(t,e,r){const i=document.createElement(t);return null!=e&&(i.className=e),r&&r.appendChild(i),i}function o(t,e,r){const i=document.createElementNS("http://www.w3.org/2000/svg",t);for(const t of Object.keys(e))i.setAttributeNS(null,t,String(e[t]));return r&&r.appendChild(i),i}r.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const s="undefined"!=typeof document?document.documentElement&&document.documentElement.style:null,a=s&&void 0!==s.userSelect?"userSelect":"WebkitUserSelect";let l;function c(){s&&a&&(l=s[a],s[a]="none")}function u(){s&&a&&(s[a]=l)}function h(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",h,!0)}function d(){window.addEventListener("click",h,!0),window.setTimeout((()=>{window.removeEventListener("click",h,!0)}),0)}function p(t,e){const r=t.getBoundingClientRect();return g(t,r,e)}function f(t,e){const r=t.getBoundingClientRect(),i=[];for(let n=0;n<e.length;n++)i.push(g(t,r,e[n]));return i}function m(t){return void 0!==window.InstallTrigger&&2===t.button&&t.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:t.button}function g(e,r,i){const n=e.offsetWidth===r.width?1:e.offsetWidth/r.width;return new t.P((i.clientX-r.left)*n,(i.clientY-r.top)*n)}class y{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(t,e){this._updatedSourceCaches[t]=e,this.setDirty()}discardSourceCacheUpdate(t){delete this._updatedSourceCaches[t]}updateLayer(t){const e=t.scope;this._updatedLayers[e]=this._updatedLayers[e]||new Set,this._updatedLayers[e].add(t.id),this.setDirty()}removeLayer(t){const e=t.scope;this._removedLayers[e]=this._removedLayers[e]||{},this._updatedLayers[e]=this._updatedLayers[e]||new Set,this._removedLayers[e][t.id]=t,this._updatedLayers[e].delete(t.id),this._updatedPaintProps.delete(t.fqid),this.setDirty()}getRemovedLayer(t){return this._removedLayers[t.scope]?this._removedLayers[t.scope][t.id]:null}discardLayerRemoval(t){this._removedLayers[t.scope]&&delete this._removedLayers[t.scope][t.id]}getLayerUpdatesByScope(){const t={};for(const e in this._updatedLayers)t[e]=t[e]||{},t[e].updatedIds=Array.from(this._updatedLayers[e].values());for(const e in this._removedLayers)t[e]=t[e]||{},t[e].removedIds=Object.keys(this._removedLayers[e]);return t}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(t){this._updatedPaintProps.add(t.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(t){this._updatedImages.add(t),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}const v={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class _{constructor(t,e,r,i,n,o){this.length=e.length,this.attributes=r,this.itemSize=e.bytesPerElement,this.dynamicDraw=i,this.instanceCount=o,this.context=t;const s=t.gl;this.buffer=s.createBuffer(),t.bindVertexBuffer.set(this.buffer),s.bufferData(s.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?s.DYNAMIC_DRAW:s.STATIC_DRAW),this.dynamicDraw||n||e.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,e){for(let r=0;r<this.attributes.length;r++){const i=e.attributes[this.attributes[r].name];void 0!==i&&t.enableVertexAttribArray(i)}}setVertexAttribPointers(t,e,r){for(let i=0;i<this.attributes.length;i++){const n=this.attributes[i],o=e.attributes[n.name];void 0!==o&&t.vertexAttribPointer(o,n.components,t[v[n.type]],!1,this.itemSize,n.offset+this.itemSize*(r||0))}}setVertexAttribDivisor(t,e,r){for(let i=0;i<this.attributes.length;i++){const n=e.attributes[this.attributes[i].name];void 0!==n&&this.instanceCount&&this.instanceCount>0&&t.vertexAttribDivisor(n,r)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class b{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class x extends b{getDefault(){return t.C.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class w extends b{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class T extends b{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class E extends b{getDefault(){return[!0,!0,!0,!0]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class S extends b{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class P extends b{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class k extends b{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class A extends b{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class M extends b{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}}class C extends b{getDefault(){return[0,1]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class I extends b{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}}class O extends b{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class L extends b{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}}class D extends b{getDefault(){const t=this.gl;return[t.ONE,t.ZERO,t.ONE,t.ZERO]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.blendFuncSeparate(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class R extends b{getDefault(){return t.C.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class F extends b{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(t,t),this.current=t,this.dirty=!1)}}class B extends b{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}}class z extends b{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class j extends b{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}let N=class extends b{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}};class V extends b{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class U extends b{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class $ extends b{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class G extends b{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class H extends b{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class q extends b{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class W extends b{getDefault(){return null}set(t){const e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Z extends b{getDefault(){return null}set(t){this.gl&&(t!==this.current||this.dirty)&&(this.gl.bindVertexArray(t),this.current=t,this.dirty=!1)}}class X extends b{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Y extends b{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class K extends b{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class J extends b{constructor(t,e){super(t),this.context=t,this.parent=e}getDefault(){return null}}class Q extends J{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class tt extends J{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,this.attachment(),e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class et extends J{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,this.attachment(),e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class rt extends tt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class it{constructor(t,e,r,i,n){this.context=t,this.width=e,this.height=r;const o=this.framebuffer=t.gl.createFramebuffer();i&&(this.colorAttachment=new Q(t,o)),n&&(this.depthAttachmentType=n,this.depthAttachment="renderbuffer"===n?new tt(t,o):new et(t,o))}destroy(){const t=this.context.gl;if(this.colorAttachment){const e=this.colorAttachment.get();e&&t.deleteTexture(e)}if(this.depthAttachment&&this.depthAttachmentType)if("renderbuffer"===this.depthAttachmentType){const e=this.depthAttachment.get();e&&t.deleteRenderbuffer(e)}else{const e=this.depthAttachment.get();e&&t.deleteTexture(e)}t.deleteFramebuffer(this.framebuffer)}}class nt{constructor(t,e){this.gl=t,this.clearColor=new x(this),this.clearDepth=new w(this),this.clearStencil=new T(this),this.colorMask=new E(this),this.depthMask=new S(this),this.stencilMask=new P(this),this.stencilFunc=new k(this),this.stencilOp=new A(this),this.stencilTest=new M(this),this.depthRange=new C(this),this.depthTest=new I(this),this.depthFunc=new O(this),this.blend=new L(this),this.blendFunc=new D(this),this.blendColor=new R(this),this.blendEquation=new F(this),this.cullFace=new B(this),this.cullFaceSide=new z(this),this.frontFace=new j(this),this.program=new N(this),this.activeTexture=new V(this),this.viewport=new U(this),this.bindFramebuffer=new $(this),this.bindRenderbuffer=new G(this),this.bindTexture=new H(this),this.bindVertexBuffer=new q(this),this.bindElementBuffer=new W(this),this.bindVertexArrayOES=new Z(this),this.pixelStoreUnpack=new X(this),this.pixelStoreUnpackPremultiplyAlpha=new Y(this),this.pixelStoreUnpackFlipY=new K(this),this.options=e?{...e}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=t.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=t.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=t.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=t.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.maxPointSize=t.getParameter(t.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,r,i){return new t.I(this,e,r,i)}createVertexBuffer(t,e,r,i,n){return new _(this,t,e,r,i,n)}createRenderbuffer(t,e,r){const i=this.gl,n=i.createRenderbuffer();return this.bindRenderbuffer.set(n),i.renderbufferStorage(i.RENDERBUFFER,t,e,r),this.bindRenderbuffer.set(null),n}createFramebuffer(t,e,r,i){return new it(this,t,e,r,i)}clear({color:t,depth:e,stencil:r,colorMask:i}){const n=this.gl;let o=0;t&&(o|=n.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set(i||[!0,!0,!0,!0])),void 0!==e&&(o|=n.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(e),this.depthMask.set(!0)),void 0!==r&&(o|=n.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),n.clear(o)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(e){t.d(e.blendFunction,t.a.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor),e.blendEquation?this.blendEquation.set(e.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(e.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class ot{constructor(e,r,i,n){const o={width:i[0],height:i[1],data:null},s=e.gl;this.targetColorTexture=new t.T(e,o,s.RGBA,{useMipmap:!1}),this.backgroundColorTexture=new t.T(e,o,s.RGBA,{useMipmap:!1}),this.context=e,this.updateParticleTexture(r,n),this.lastInvalidatedAt=0}updateParticleTexture(e,r){if(this.particleTextureDimension===r.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const i=this.context.gl,n=r.width*r.height;this.particleTexture0=new t.T(this.context,r,i.RGBA,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new t.T(this.context,r,i.RGBA,{premultiply:!1,useMipmap:!1});const o=new t.S;o.reserve(n);for(let t=0;t<n;t++)o.emplaceBack(t);this.particleIndexBuffer=this.context.createVertexBuffer(o,t.p.members,!0),this.particleSegment=t.b.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=r.width}update(e){return!(this.lastInvalidatedAt<e&&(this.lastInvalidatedAt=t.e.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}class st extends t.E{constructor(t){super(),this.requestManager=t,this.models={"":{}},this.numModelsLoading={}}loadModel(e,r){return t.l(this.requestManager.transformRequest(r,t.R.Model).url).then((r=>{if(!r)return;const i=t.c(r),n=new t.M(e,void 0,void 0,i);return n.computeBoundsAndApplyParent(),n})).catch((i=>{if(i&&404===i.status)return null;this.fire(new t.f(new Error(`Could not load model ${e} from ${r}: ${i.message}`)))}))}load(e,r){this.models[r]||(this.models[r]={});const i=Object.keys(e);this.numModelsLoading[r]=(this.numModelsLoading[r]||0)+i.length;const n=[];for(const t of i)n.push(this.loadModel(t,e[t]));Promise.allSettled(n).then((e=>{for(let t=0;t<e.length;t++){const{status:n,value:o}=e[t];"fulfilled"===n&&o&&(this.models[r][i[t]]={model:o,numReferences:1})}this.numModelsLoading[r]-=i.length,this.fire(new t.g("data",{dataType:"style"}))})).catch((e=>{this.fire(new t.f(new Error(`Could not load models: ${e.message}`)))}))}isLoaded(){for(const t in this.numModelsLoading)if(this.numModelsLoading[t]>0)return!1;return!0}hasModel(t,e){return!!this.getModel(t,e)}getModel(t,e){return this.models[e]||(this.models[e]={}),this.models[e][t]?this.models[e][t].model:void 0}addModel(t,e,r){this.models[r]||(this.models[r]={}),this.hasModel(t,r)&&this.models[r][t].numReferences++,this.load({[t]:this.requestManager.normalizeModelURL(e)},r)}addModels(t,e){this.models[e]||(this.models[e]={});const r={};for(const i in t)this.models[e][i]={},r[i]=this.requestManager.normalizeModelURL(t[i]);this.load(r,e)}addModelsFromBucket(t,e){this.models[e]||(this.models[e]={});const r={};for(const i of t)this.hasModel(i,e)?this.models[e][i].numReferences++:r[i]=this.requestManager.normalizeModelURL(i);this.load(r,e)}removeModel(t,e){if(this.models[e]&&this.models[e][t]&&(this.models[e][t].numReferences--,0===this.models[e][t].numReferences)){const r=this.models[e][t].model;delete this.models[e][t],r.destroy()}}listModels(t){return this.models[t]||(this.models[t]={}),Object.keys(this.models[t])}upload(t,e){this.models[e]||(this.models[e]={});for(const r in this.models[e])this.models[e][r].model&&this.models[e][r].model.upload(t.context)}}function at(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class lt extends t.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(e){this.images[e]={},this.loaded[e]=!1,this.updatedImages[e]={},this.patterns[e]={},this.callbackDispatchedThisFrame[e]={},this.atlasImage[e]=new t.j({width:1,height:1})}isLoaded(){for(const t in this.loaded)if(!this.loaded[t])return!1;return!0}setLoaded(t,e){if(this.loaded[e]!==t&&(this.loaded[e]=t,t)){for(const{ids:t,callback:r}of this.requestors)this._notify(t,e,r);this.requestors=[]}}hasImage(t,e){return!!this.getImage(t,e)}getImage(t,e){return this.images[e][t]}addImage(t,e,r){this._validate(t,r)&&(this.images[e][t]=r)}_validate(e,r){let i=!0;return this._validateStretch(r.stretchX,r.data&&r.data.width)||(this.fire(new t.f(new Error(`Image "${e}" has invalid "stretchX" value`))),i=!1),this._validateStretch(r.stretchY,r.data&&r.data.height)||(this.fire(new t.f(new Error(`Image "${e}" has invalid "stretchY" value`))),i=!1),this._validateContent(r.content,r)||(this.fire(new t.f(new Error(`Image "${e}" has invalid "content" value`))),i=!1),i}_validateStretch(t,e){if(!t)return!0;let r=0;for(const i of t){if(i[0]<r||i[1]<i[0]||e<i[1])return!1;r=i[1]}return!0}_validateContent(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,e,r){r.version=this.images[e][t].version+1,this.images[e][t]=r,this.updatedImages[e][t]=!0}removeImage(t,e){const r=this.images[e][t];delete this.images[e][t],delete this.patterns[e][t],r.userImage&&r.userImage.onRemove&&r.userImage.onRemove()}listImages(t){return Object.keys(this.images[t])}getImages(t,e,r){let i=!0;const n=!!this.loaded[e];if(!n)for(const r of t)this.images[e][r]||(i=!1);n||i?this._notify(t,e,r):this.requestors.push({ids:t,scope:e,callback:r})}getUpdatedImages(t){return this.updatedImages[t]}_notify(e,r,i){const n={};for(const i of e){this.images[r][i]||this.fire(new t.g("styleimagemissing",{id:i}));const e=this.images[r][i];e?n[i]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,hasRenderCallback:Boolean(e.userImage&&e.userImage.render)}:t.w(`Image "${i}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}i(null,n)}getPixelSize(t){const{width:e,height:r}=this.atlasImage[t];return{width:e,height:r}}getPattern(e,r,i){const n=this.patterns[r][e],o=this.getImage(e,r);if(!o)return null;if(n&&n.position.version===o.version)return n.position;if(n)n.position.version=o.version;else{const i={w:o.data.width+2,h:o.data.height+2,x:0,y:0},n=new t.m(i,o);this.patterns[r][e]={bin:i,position:n}}return this._updatePatternAtlas(r,i),this.patterns[r][e].position}bind(e,r){const i=e.gl;let n=this.atlasTexture[r];n?this.dirty&&(n.update(this.atlasImage[r]),this.dirty=!1):(n=new t.T(e,this.atlasImage[r],i.RGBA),this.atlasTexture[r]=n),n.bind(i.LINEAR,i.CLAMP_TO_EDGE)}_updatePatternAtlas(e,r){const i=[];for(const t in this.patterns[e])i.push(this.patterns[e][t].bin);const{w:n,h:o}=t.k(i),s=this.atlasImage[e];s.resize({width:n||1,height:o||1});for(const i in this.patterns[e]){const{bin:n}=this.patterns[e][i],o=n.x+1,a=n.y+1,l=this.images[e][i].data,c=l.width,u=l.height;t.j.copy(l,s,{x:0,y:0},{x:o,y:a},{width:c,height:u},r),t.j.copy(l,s,{x:0,y:u-1},{x:o,y:a-1},{width:c,height:1},r),t.j.copy(l,s,{x:0,y:0},{x:o,y:a+u},{width:c,height:1},r),t.j.copy(l,s,{x:c-1,y:0},{x:o-1,y:a},{width:1,height:u},r),t.j.copy(l,s,{x:0,y:0},{x:o+c,y:a},{width:1,height:u},r)}this.dirty=!0}beginFrame(){for(const t in this.images)this.callbackDispatchedThisFrame[t]={}}dispatchRenderCallbacks(t,e){for(const r of t){if(this.callbackDispatchedThisFrame[e][r])continue;this.callbackDispatchedThisFrame[e][r]=!0;const t=this.images[e][r];at(t)&&this.updateImage(r,e,t)}}}function ct(e){const r=e.key,i=e.value,n=e.valueSpec||{},o=e.objectElementValidators||{},s=e.style,a=e.styleSpec;let l=[];const c=t.o(i);if("object"!==c)return[new t.V(r,i,`object expected, ${c} found`)];for(const e in i){const c=e.split(".")[0];let u;o[c]?u=o[c]:n[c]?u=It:o["*"]?u=o["*"]:n["*"]&&(u=It),u?l=l.concat(u({key:(r?`${r}.`:r)+e,value:i[e],valueSpec:n[c]||n["*"],style:s,styleSpec:a,object:i,objectKey:e},i)):l.push(new t.n(r,i[e],`unknown property "${e}"`))}for(const e in n)o[e]||n[e].required&&void 0===n[e].default&&void 0===i[e]&&l.push(new t.V(r,i,`missing required property "${e}"`));return l}function ut(e){const r=e.value,i=e.valueSpec,n=e.style,o=e.styleSpec,s=e.key,a=e.arrayElementValidator||It;if("array"!==t.o(r))return[new t.V(s,r,`array expected, ${t.o(r)} found`)];if(i.length&&r.length!==i.length)return[new t.V(s,r,`array length ${i.length} expected, length ${r.length} found`)];if(i["min-length"]&&r.length<i["min-length"])return[new t.V(s,r,`array length at least ${i["min-length"]} expected, length ${r.length} found`)];let l={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};o.$version<7&&(l.function=i.function),"object"===t.o(i.value)&&(l=i.value);let c=[];for(let t=0;t<r.length;t++)c=c.concat(a({array:r,arrayIndex:t,value:r[t],valueSpec:l,style:n,styleSpec:o,key:`${s}[${t}]`},!0));return c}function ht(e){const r=e.key,i=e.value,n=e.valueSpec;let o=t.o(i);if("number"===o&&i!=i&&(o="NaN"),"number"!==o)return[new t.V(r,i,`number expected, ${o} found`)];if("minimum"in n){let o=n.minimum;if("array"===t.o(n.minimum)&&(o=n.minimum[e.arrayIndex]),i<o)return[new t.V(r,i,`${i} is less than the minimum value ${o}`)]}if("maximum"in n){let o=n.maximum;if("array"===t.o(n.maximum)&&(o=n.maximum[e.arrayIndex]),i>o)return[new t.V(r,i,`${i} is greater than the maximum value ${o}`)]}return[]}function dt(e){const r=e.valueSpec,i=t.u(e.value.type);let n,o,s,a={};const l="categorical"!==i&&void 0===e.value.property,c=!l,u="array"===t.o(e.value.stops)&&"array"===t.o(e.value.stops[0])&&"object"===t.o(e.value.stops[0][0]),h=ct({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===i)return[new t.V(e.key,e.value,'identity function may not have a "stops" property')];let r=[];const n=e.value;return r=r.concat(ut({key:e.key,value:n,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:d})),"array"===t.o(n)&&0===n.length&&r.push(new t.V(e.key,n,"array must have at least one stop")),r},default:function(t){return It({key:t.key,value:t.value,valueSpec:r,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===i&&l&&h.push(new t.V(e.key,e.value,'missing required property "property"')),"identity"===i||e.value.stops||h.push(new t.V(e.key,e.value,'missing required property "stops"')),"exponential"===i&&e.valueSpec.expression&&!t.s(e.valueSpec)&&h.push(new t.V(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(c&&!t.r(e.valueSpec)?h.push(new t.V(e.key,e.value,"property functions not supported")):l&&!t.t(e.valueSpec)&&h.push(new t.V(e.key,e.value,"zoom functions not supported"))),"categorical"!==i&&!u||void 0!==e.value.property||h.push(new t.V(e.key,e.value,'"property" property is required')),h;function d(e){let i=[];const n=e.value,l=e.key;if("array"!==t.o(n))return[new t.V(l,n,`array expected, ${t.o(n)} found`)];if(2!==n.length)return[new t.V(l,n,`array length 2 expected, length ${n.length} found`)];if(u){if("object"!==t.o(n[0]))return[new t.V(l,n,`object expected, ${t.o(n[0])} found`)];if(void 0===n[0].zoom)return[new t.V(l,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new t.V(l,n,"object stop key must have value")];const r=t.u(n[0].zoom);if("number"!=typeof r)return[new t.V(l,n[0].zoom,"stop zoom values must be numbers")];if(s&&s>r)return[new t.V(l,n[0].zoom,"stop zoom values must appear in ascending order")];r!==s&&(s=r,o=void 0,a={}),i=i.concat(ct({key:`${l}[0]`,value:n[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:ht,value:p}}))}else i=i.concat(p({key:`${l}[0]`,value:n[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},n));return t.v(t.x(n[1]))?i.concat([new t.V(`${l}[1]`,n[1],"expressions are not allowed in function stops.")]):i.concat(It({key:`${l}[1]`,value:n[1],valueSpec:r,style:e.style,styleSpec:e.styleSpec}))}function p(e,s){const l=t.o(e.value),c=t.u(e.value),u=null!==e.value?e.value:s;if(n){if(l!==n)return[new t.V(e.key,u,`${l} stop domain type must match previous stop domain type ${n}`)]}else n=l;if("number"!==l&&"string"!==l&&"boolean"!==l&&"number"!=typeof c&&"string"!=typeof c&&"boolean"!=typeof c)return[new t.V(e.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==l&&"categorical"!==i){let n=`number expected, ${l} found`;return t.r(r)&&void 0===i&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new t.V(e.key,u,n)]}return"categorical"!==i||"number"!==l||"number"==typeof c&&isFinite(c)&&Math.floor(c)===c?"categorical"!==i&&"number"===l&&"number"==typeof c&&"number"==typeof o&&void 0!==o&&c<o?[new t.V(e.key,u,"stop domain values must appear in ascending order")]:(o=c,"categorical"===i&&c in a?[new t.V(e.key,u,"stop domain values must be unique")]:(a[c]=!0,[])):[new t.V(e.key,u,`integer expected, found ${String(c)}`)]}}function pt(e){const r=("property"===e.expressionContext?t.y:t.z)(t.x(e.value),e.valueSpec);if("error"===r.result)return r.value.map((r=>new t.V(`${e.key}${r.key}`,e.value,r.message)));const i=r.value.expression||r.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!i.outputDefined())return[new t.V(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!t.A(i))return[new t.V(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext)return ft(i,e);if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!t.B(i,["zoom","feature-state"]))return[new t.V(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!t.D(i))return[new t.V(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ft(e,r){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const t of r.valueSpec.expression.parameters)i.delete(t);if(0===i.size)return[];const n=[];return e instanceof t.F&&i.has(e.name)?[new t.V(r.key,r.value,`["${e.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(e.eachChild((t=>{n.push(...ft(t,r))})),n)}function mt(e){const r=e.key,i=e.value,n=e.valueSpec,o=[];return Array.isArray(n.values)?-1===n.values.indexOf(t.u(i))&&o.push(new t.V(r,i,`expected one of [${n.values.join(", ")}], ${JSON.stringify(i)} found`)):-1===Object.keys(n.values).indexOf(t.u(i))&&o.push(new t.V(r,i,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(i)} found`)),o}function gt(e){return t.H(t.x(e.value))?pt(t.q({},e,{expressionContext:"filter",valueSpec:e.styleSpec[`filter_${e.layerType||"fill"}`]})):yt(e)}function yt(e){const r=e.value,i=e.key;if("array"!==t.o(r))return[new t.V(i,r,`array expected, ${t.o(r)} found`)];const n=e.styleSpec;let o,s=[];if(r.length<1)return[new t.V(i,r,"filter array must have at least 1 element")];switch(s=s.concat(mt({key:`${i}[0]`,value:r[0],valueSpec:n.filter_operator,style:e.style,styleSpec:e.styleSpec})),t.u(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&"$type"===t.u(r[1])&&s.push(new t.V(i,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":3!==r.length&&s.push(new t.V(i,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(o=t.o(r[1]),"string"!==o&&s.push(new t.V(`${i}[1]`,r[1],`string expected, ${o} found`)));for(let a=2;a<r.length;a++)o=t.o(r[a]),"$type"===t.u(r[1])?s=s.concat(mt({key:`${i}[${a}]`,value:r[a],valueSpec:n.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==o&&"number"!==o&&"boolean"!==o&&s.push(new t.V(`${i}[${a}]`,r[a],`string, number, or boolean expected, ${o} found`));break;case"any":case"all":case"none":for(let t=1;t<r.length;t++)s=s.concat(yt({key:`${i}[${t}]`,value:r[t],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":o=t.o(r[1]),2!==r.length?s.push(new t.V(i,r,`filter array for "${r[0]}" operator must have 2 elements`)):"string"!==o&&s.push(new t.V(`${i}[1]`,r[1],`string expected, ${o} found`))}return s}function vt(e,r){const i=e.key,n=e.style,o=e.layer,s=e.styleSpec,a=e.value,l=e.objectKey,c=s[`${r}_${e.layerType}`];if(!c)return[];const u=l.match(/^(.*)-transition$/);if("paint"===r&&u&&c[u[1]]&&c[u[1]].transition)return It({key:i,value:a,valueSpec:s.transition,style:n,styleSpec:s});const h=e.valueSpec||c[l];if(!h)return[new t.n(i,a,`unknown property "${l}"`)];let d;if("string"===t.o(a)&&t.r(h)&&!h.tokens&&(d=/^{([^}]+)}$/.exec(a))){const e=`\`{ "type": "identity", "property": ${d?JSON.stringify(d[1]):'"_"'} }\``;return[new t.V(i,a,`"${l}" does not support interpolation syntax\nUse an identity property function instead: ${e}.`)]}const p=[];if("symbol"===e.layerType)"text-field"!==l||!n||n.glyphs||n.imports||p.push(new t.V(i,a,'use of "text-field" requires a style "glyphs" property')),"text-font"===l&&t.J(t.x(a))&&"identity"===t.u(a.type)&&p.push(new t.V(i,a,'"text-font" does not support identity functions'));else if("model"===e.layerType&&"paint"===r&&o&&o.layout&&o.layout.hasOwnProperty("model-id")&&t.r(h)&&(t.K(h)||t.t(h))){const e=t.y(t.x(a),h),r=e.value.expression||e.value._styleExpression.expression;r&&!t.B(r,["measure-light"])&&("model-emissive-strength"===l&&t.D(r)&&t.A(r)||p.push(new t.V(i,a,`${l} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return p.concat(It({key:e.key,value:a,valueSpec:h,style:n,styleSpec:s,expressionContext:"property",propertyType:r,propertyKey:l}))}function _t(t){return vt(t,"paint")}function bt(t){return vt(t,"layout")}function xt(e){let r=[];const i=e.value,n=e.key,o=e.style,s=e.styleSpec;i.type||i.ref||r.push(new t.V(n,i,'either "type" or "ref" is required'));let a=t.u(i.type);const l=t.u(i.ref);if(i.id){const s=t.u(i.id);for(let a=0;a<e.arrayIndex;a++){const e=o.layers[a];t.u(e.id)===s&&r.push(new t.V(n,i.id,`duplicate layer id "${i.id}", previously used at line ${e.id.__line__}`))}}if("ref"in i){let e;["type","source","source-layer","filter","layout"].forEach((e=>{e in i&&r.push(new t.V(n,i[e],`"${e}" is prohibited for ref layers`))})),o.layers.forEach((r=>{t.u(r.id)===l&&(e=r)})),e?e.ref?r.push(new t.V(n,i.ref,"ref cannot reference another ref layer")):a=t.u(e.type):"string"==typeof l&&r.push(new t.V(n,i.ref,`ref layer "${l}" not found`))}else if("background"!==a&&"sky"!==a&&"slot"!==a)if(i.source){const e=o.sources&&o.sources[i.source],s=e&&t.u(e.type);e?"vector"===s&&"raster"===a?r.push(new t.V(n,i.source,`layer "${i.id}" requires a raster source`)):"raster"===s&&"raster"!==a?r.push(new t.V(n,i.source,`layer "${i.id}" requires a vector source`)):"vector"!==s||i["source-layer"]?"raster-dem"===s&&"hillshade"!==a?r.push(new t.V(n,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"raster-array"!==s||["raster","raster-particle"].includes(a)?"line"!==a||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||"geojson"===s&&e.lineMetrics?"raster-particle"===a&&"raster-array"!==s&&r.push(new t.V(n,i.source,`layer "${i.id}" requires a 'raster-array' source.`)):r.push(new t.V(n,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new t.V(n,i.source,"raster-array source can only be used with layer type 'raster'.")):r.push(new t.V(n,i,`layer "${i.id}" must specify a "source-layer"`)):r.push(new t.V(n,i.source,`source "${i.source}" not found`))}else r.push(new t.V(n,i,'missing required property "source"'));return r=r.concat(ct({key:n,value:i,valueSpec:s.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":()=>[],type:()=>It({key:`${n}.type`,value:i.type,valueSpec:s.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"}),filter:e=>gt(t.q({layerType:a},e)),layout:e=>ct({layer:i,key:e.key,value:e.value,valueSpec:{},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":e=>bt(t.q({layerType:a},e))}}),paint:e=>ct({layer:i,key:e.key,value:e.value,valueSpec:{},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":e=>_t(t.q({layerType:a,layer:i},e))}})}})),r}function wt(e){const r=e.value,i=e.key,n=t.o(r);return"string"!==n?[new t.V(i,r,`string expected, ${n} found`)]:[]}const Tt={promoteId:function({key:e,value:r}){if("string"===t.o(r))return wt({key:e,value:r});{const t=[];for(const i in r)t.push(...wt({key:`${e}.${i}`,value:r[i]}));return t}}};function Et(e){const r=e.value,i=e.key,n=e.styleSpec,o=e.style;if(!r.type)return[new t.V(i,r,'"type" is required')];const s=t.u(r.type);let a=[];switch(["vector","raster","raster-dem","raster-array"].includes(s)&&(r.url||r.tiles||a.push(new t.n(i,r,'Either "url" or "tiles" is required.'))),s){case"vector":case"raster":case"raster-dem":case"raster-array":return a=a.concat(ct({key:i,value:r,valueSpec:n[`source_${s.replace("-","_")}`],style:e.style,styleSpec:n,objectElementValidators:Tt})),a;case"geojson":if(a=ct({key:i,value:r,valueSpec:n.source_geojson,style:o,styleSpec:n,objectElementValidators:Tt}),r.cluster)for(const t in r.clusterProperties){const[e,n]=r.clusterProperties[t],o="string"==typeof e?[e,["accumulated"],["get",t]]:e;a.push(...pt({key:`${i}.${t}.map`,value:n,expressionContext:"cluster-map"})),a.push(...pt({key:`${i}.${t}.reduce`,value:o,expressionContext:"cluster-reduce"}))}return a;case"video":return ct({key:i,value:r,valueSpec:n.source_video,style:o,styleSpec:n});case"image":return ct({key:i,value:r,valueSpec:n.source_image,style:o,styleSpec:n});case"canvas":return[new t.V(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return mt({key:`${i}.type`,value:r.type,valueSpec:{values:St(n)},style:o,styleSpec:n})}}function St(t){return t.source.reduce(((e,r)=>{const i=t[r];return"enum"===i.type.type&&(e=e.concat(Object.keys(i.type.values))),e}),[])}function Pt(e){const r=e.value,i=e.styleSpec,n=i.light,o=e.style;let s=[];const a=t.o(r);if(void 0===r)return s;if("object"!==a)return s=s.concat([new t.V("light",r,`object expected, ${a} found`)]),s;for(const e in r){const a=e.match(/^(.*)-transition$/);s=s.concat(a&&n[a[1]]&&n[a[1]].transition?It({key:e,value:r[e],valueSpec:i.transition,style:o,styleSpec:i}):n[e]?It({key:e,value:r[e],valueSpec:n[e],style:o,styleSpec:i}):[new t.V(e,r[e],`unknown property "${e}"`)])}return s}function kt(e){const r=e.value;let i=[];if(!r)return i;const n=t.o(r);if("object"!==n)return i=i.concat([new t.V("light-3d",r,`object expected, ${n} found`)]),i;const o=e.styleSpec,s=o["light-3d"],a=e.key,l=e.style,c=e.style.lights;for(const e of["type","id"])if(!(e in r))return i=i.concat([new t.V("light-3d",r,`missing property ${e} on light`)]),i;if(r.type&&c)for(let n=0;n<e.arrayIndex;n++){const e=t.u(r.type),o=c[n];t.u(o.type)===e&&i.push(new t.V(a,r.id,`duplicate light type "${r.type}", previously defined at line ${o.id.__line__}`))}const u=`properties_light_${r.type}`;if(!(u in o))return i=i.concat([new t.V("light-3d",r,`Invalid light type ${r.type}`)]),i;const h=o[u];for(const n in r)if("properties"===n){const s=r[n],a=t.o(s);if("object"!==a)return i=i.concat([new t.V("properties",s,`object expected, ${a} found`)]),i;for(const r in s)i=i.concat(h[r]?It({key:r,value:s[r],valueSpec:h[r],style:l,styleSpec:o}):[new t.n(e.key,s[r],`unknown property "${r}"`)])}else{const e=n.match(/^(.*)-transition$/);i=i.concat(e&&s[e[1]]&&s[e[1]].transition?It({key:n,value:r[n],valueSpec:o.transition,style:l,styleSpec:o}):s[n]?It({key:n,value:r[n],valueSpec:s[n],style:l,styleSpec:o}):[new t.n(n,r[n],`unknown property "${n}"`)])}return i}function At(e){const r=e.value,i=e.key,n=e.style,o=e.styleSpec,s=o.terrain;let a=[];const l=t.o(r);if(void 0===r)return a;if("null"===l)return a;if("object"!==l)return a=a.concat([new t.V("terrain",r,`object expected, ${l} found`)]),a;for(const e in r){const i=e.match(/^(.*)-transition$/);a=a.concat(i&&s[i[1]]&&s[i[1]].transition?It({key:e,value:r[e],valueSpec:o.transition,style:n,styleSpec:o}):s[e]?It({key:e,value:r[e],valueSpec:s[e],style:n,styleSpec:o}):[new t.n(e,r[e],`unknown property "${e}"`)])}if(r.source){const e=n.sources&&n.sources[r.source],o=e&&t.u(e.type);e?"raster-dem"!==o&&a.push(new t.V(i,r.source,`terrain cannot be used with a source of type ${String(o)}, it only be used with a "raster-dem" source type`)):a.push(new t.V(i,r.source,`source "${r.source}" not found`))}else a.push(new t.V(i,r,'terrain is missing required property "source"'));return a}function Mt(e){const r=e.value,i=e.style,n=e.styleSpec,o=n.fog;let s=[];const a=t.o(r);if(void 0===r)return s;if("object"!==a)return s=s.concat([new t.V("fog",r,`object expected, ${a} found`)]),s;for(const e in r){const a=e.match(/^(.*)-transition$/);s=s.concat(a&&o[a[1]]&&o[a[1]].transition?It({key:e,value:r[e],valueSpec:n.transition,style:i,styleSpec:n}):o[e]?It({key:e,value:r[e],valueSpec:o[e],style:i,styleSpec:n}):[new t.n(e,r[e],`unknown property "${e}"`)])}return s}const Ct={"*":()=>[],array:ut,boolean:function(e){const r=e.value,i=e.key,n=t.o(r);return"boolean"!==n?[new t.V(i,r,`boolean expected, ${n} found`)]:[]},number:ht,color:function(e){const r=e.key,i=e.value,n=t.o(i);return"string"!==n?[new t.V(r,i,`color expected, ${n} found`)]:null===t.G(i)?[new t.V(r,i,`color expected, "${i}" found`)]:[]},enum:mt,filter:gt,function:dt,layer:xt,object:ct,source:Et,model:t.L,light:Pt,"light-3d":kt,terrain:At,fog:Mt,string:wt,formatted:function(t){return 0===wt(t).length?[]:pt(t)},resolvedImage:function(t){return 0===wt(t).length?[]:pt(t)},projection:function(e){const r=e.value,i=e.styleSpec,n=i.projection,o=e.style;let s=[];const a=t.o(r);if("object"===a)for(const t in r)s=s.concat(It({key:t,value:r[t],valueSpec:n[t],style:o,styleSpec:i}));else"string"!==a&&(s=s.concat([new t.V("projection",r,`object or string expected, ${a} found`)]));return s},import:function(e){const{value:r,styleSpec:i}=e,{data:n,...o}=r;Object.defineProperty(o,"__line__",{value:r.__line__,enumerable:!1});let s=ct(t.q({},e,{value:o,valueSpec:i.import}));return""===t.u(o.id)&&s.push(new t.V(`${e.key}.id`,o,"import id can't be an empty string")),n&&(s=s.concat(Lt(n,i,{key:`${e.key}.data`}))),s}};function It(e,r=!1){const i=e.value,n=e.valueSpec,o=e.styleSpec;if(n.expression&&t.J(t.u(i)))return dt(e);if(n.expression&&t.v(t.x(i)))return pt(e);if(n.type&&Ct[n.type]){const i=Ct[n.type](e);return!0===r&&i.length>0&&"array"===t.o(e.value)?pt(e):i}return ct(t.q({},e,{valueSpec:n.type?o[n.type]:n}))}function Ot(e){const r=e.value,i=e.key,n=wt(e);return n.length||(-1===r.indexOf("{fontstack}")&&n.push(new t.V(i,r,'"glyphs" url must include a "{fontstack}" token')),-1===r.indexOf("{range}")&&n.push(new t.V(i,r,'"glyphs" url must include a "{range}" token'))),n}function Lt(e,r=t.N,i={}){return It({key:i.key||"",value:e,valueSpec:r.$root,styleSpec:r,style:e,objectElementValidators:{glyphs:Ot,"*":()=>[]}})}function Dt(e,r=t.N){return Ht(Lt(e,r))}const Rt=t=>Ht(Et(t)),Ft=t=>Ht(Pt(t)),Bt=t=>Ht(kt(t)),zt=t=>Ht(At(t)),jt=t=>Ht(Mt(t)),Nt=t=>Ht(xt(t)),Vt=t=>Ht(gt(t)),Ut=t=>Ht(_t(t)),$t=t=>Ht(bt(t)),Gt=e=>Ht(t.L(e));function Ht(t){return t.slice().sort(((t,e)=>t.line&&e.line?t.line-e.line:0))}function qt(e,r){let i=!1;if(r&&r.length)for(const n of r)n instanceof t.n?t.w(n.message):(e.fire(new t.f(new Error(n.message))),i=!0);return i}let Wt;class Zt extends t.E{constructor(e,r="flat"){super(),this._transitionable=new t.O(Wt||(Wt=new t.U({anchor:new t.W(t.N.light.anchor),position:new t.X(t.N.light.position),color:new t.W(t.N.light.color),intensity:new t.W(t.N.light.intensity)}))),this.setLight(e,r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,e,r={}){this._validate(Ft,t,r)||(this._transitionable.setTransitionOrValue(t),this.id=e)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,r,i){return(!i||!1!==i.validate)&&qt(this,e.call(Dt,t.Q({value:r,style:{glyphs:!0,sprite:!0},styleSpec:t.N})))}}const Xt=new t.U({source:new t.W(t.N.terrain.source),exaggeration:new t.W(t.N.terrain.exaggeration)});let Yt=class extends t.E{constructor(e,r,i,n){super(),this.scope=i,this._transitionable=new t.O(Xt,i,n),this._transitionable.setTransitionOrValue(e,n),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r}get(){return this._transitionable.serialize()}set(t,e){this._transitionable.setTransitionOrValue(t,e)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}getExaggeration(e){return this._transitioning.possiblyEvaluate(new t.Y(e)).get("exaggeration")}isZoomDependent(){const e=this._transitionable._values.exaggeration;return null!=e&&null!=e.value&&null!=e.value.expression&&e.value.expression instanceof t.Z}};const Kt=45,Jt=65,Qt=.05;function te(e,r,i,n){const o=t.a0(Kt,Jt,i),[s,a]=ee(e,n);let l=1-Math.min(1,Math.exp((r-s)/(a-s)*-6));return l*=l*l,l=Math.min(1,1.00747*l),l*o*e.alpha}function ee(t,e){const r=.5/Math.tan(.5*e);return[t.range[0]+r,t.range[1]+r]}function re(e,r,i,n,o){const s=t.$.transformMat4([],[r,i,n],o.mercatorFogMatrix);return te(e,t.$.length(s),o.pitch,o._fov)}function ie(e,r,i,n,o,s,a){const l=[[i,n,0],[o,n,0],[o,s,0],[i,s,0]];let c=Number.MAX_VALUE,u=-Number.MAX_VALUE;for(const e of l){const i=t.$.transformMat4([],e,r),n=t.$.length(i);c=Math.min(c,n),u=Math.max(u,n)}return[te(e,c,a.pitch,a._fov),te(e,u,a.pitch,a._fov)]}const ne=new t.U({range:new t.W(t.N.fog.range),color:new t.W(t.N.fog.color),"high-color":new t.W(t.N.fog["high-color"]),"space-color":new t.W(t.N.fog["space-color"]),"horizon-blend":new t.W(t.N.fog["horizon-blend"]),"star-intensity":new t.W(t.N.fog["star-intensity"]),"vertical-range":new t.W(t.N.fog["vertical-range"])});class oe extends t.E{constructor(e,r,i,n){super(),this._transitionable=new t.O(ne,i,new Map(n)),this.set(e,n),this._transitioning=this._transitionable.untransitioned(),this._transform=r,this.properties=new t.a1(ne),this.scope=i}get state(){const e=this._transform,r="globe"===e.projection.name,i=t.a2(e.zoom),n=this.properties.get("range"),o=[.5,3];return{range:r?[t.a3(o[0],n[0],i),t.a3(o[1],n[1],i)]:n,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(e,r,i={}){if(this._validate(jt,e,i))return;const n=t.Q({},e);for(const e of Object.keys(t.N.fog))void 0===n[e]&&(n[e]=t.N.fog[e].default);this._options=n,this._transitionable.setTransitionOrValue(this._options,r)}getOpacity(e){if(!this._transform.projection.supportsFog)return 0;const r=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:t.a0(Kt,Jt,e))*r.a}getOpacityAtLatLng(e,r){return this._transform.projection.supportsFog?function(e,r,i){const n=t._.fromLngLat(r),o=i.elevation?i.elevation.getAtPointOrZero(n):0;return re(e,n.x,n.y,o,i)}(this.state,e,r):0}getOpacityForTile(e){if(!this._transform.projection.supportsFog)return[1,1];const r=this._transform.calculateFogTileMatrix(e.toUnwrapped());return ie(this.state,r,0,0,t.a4,t.a4,this._transform)}getOpacityForBounds(t,e,r,i,n){return this._transform.projection.supportsFog?ie(this.state,t,e,r,i,n,this._transform):[1,1]}getFovAdjustedRange(t){return this._transform.projection.supportsFog?ee(this.state,t):[0,1]}isVisibleOnFrustum(e){if(!this._transform.projection.supportsFog)return!1;const r=[4,5,6,7];for(const i of r){const r=e.points[i];let n;if(r[2]>=0)n=r;else{const o=e.points[i-4];n=t.a5(o,r,o[2]/(o[2]-r[2]))}if(re(this.state,n[0],n[1],0,this._transform)>=Qt)return!0}return!1}updateConfig(t){this._transitionable.setTransitionOrValue(this._options,new Map(t))}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,r,i){return(!i||!1!==i.validate)&&qt(this,e.call(Dt,t.Q({value:r,style:{glyphs:!0,sprite:!0},styleSpec:t.N})))}}class se extends t.E{constructor(e,r,i,n){super(),this.scope=i,this._options=e,this.properties=new t.a1(r),this._transitionable=new t.O(r,i,new Map(n)),this._transitionable.setTransitionOrValue(e.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(t){this._transitionable.setTransitionOrValue(this._options.properties,new Map(t))}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(t,e){this._options=t,this._transitionable.setTransitionOrValue(t.properties,e)}shadowsEnabled(){return!!this.properties&&!0===this.properties.get("cast-shadows")}}let ae,le;var ce="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef RENDER_CUTOFF\nfloat cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}\n#endif",ue="\nout vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#ifdef INDICATOR_CUTOUT\nuniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;\n#endif\nvec4 applyCutout(vec4 color) {\n#ifdef INDICATOR_CUTOUT\nfloat holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);\n#else\nreturn color;\n#endif\n}\n#ifdef DEBUG_WIREFRAME\n#define HANDLE_WIREFRAME_DEBUG \\\nglFragColor=vec4(0.7,0.0,0.0,0.7); \\\ngl_FragDepth=gl_FragCoord.z-0.0001;\n#else\n#define HANDLE_WIREFRAME_DEBUG\n#endif\n#ifdef RENDER_CUTOFF\nuniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;\n#endif\nvec4 textureLodCustom(sampler2D image,vec2 pos,vec2 lod_coord) {vec2 size=vec2(textureSize(image,0));vec2 dx=dFdx(lod_coord.xy*size);vec2 dy=dFdy(lod_coord.xy*size);float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}",he="\n#define EXTENT 8192.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}\n#ifdef RENDER_CUTOFF\nuniform vec4 u_cutoff_params;out float v_cutoff_opacity;\n#endif\nconst vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}",de="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",pe="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nvec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }\n#endif\n#ifdef DEPTH_OCCLUSION\nuniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;\n#ifdef DEPTH_D24\nfloat unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}\n#else\nhighp float unpack_depth_rgba(vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}\n#endif\nbool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;\n#ifdef DEPTH_D24\nfloat depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);\n#else\nfloat depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));\n#endif\nreturn coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;\n#ifdef DEPTH_D24\nhighp vec4 depth=vec4(\ntexture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r\n);depth=unpack_depth4(depth);\n#else\nhighp vec4 depth=vec4(\nunpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))\n);\n#endif\nreturn depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {\n#ifdef DEPTH_D24\nhighp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);\n#else\nhighp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));\n#endif\nres+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}\n#else\nbool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }\n#endif//DEPTH_OCCLUSION",fe="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",me="highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {\n#ifdef FOG_DITHERING\nvec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);\n#else\nreturn color;\n#endif\n}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif",ge="#ifdef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)\n);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)\n);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}\n#endif",ye="#ifdef RASTER_ARRAY\nuniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}\n#endif\nuniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}",ve="#ifdef RENDER_SHADOWS\nuniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}\n#endif//RENDER_SHADOWS",_e="#ifdef RENDER_SHADOWS\n#ifdef DEPTH_TEXTURE\nuniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;\n#else\nuniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;\n#endif\nuniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_1,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_0,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;\n#ifdef NATIVE\nhighp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));\n#else\nhighp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(\nshadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)\n);\n#endif\nvec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {\n#ifdef SHADOWS_SINGLE_CASCADE\nlight_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);\n#else\nlight_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));\n#endif\n}highp float calculate_shadow_bias(float NDotL) {\n#ifdef NORMAL_OFFSET\nreturn 0.5*u_shadow_bias.x;\n#else\nreturn 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));\n#endif\n}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}\n#endif";const be=[];Pe(ce,be),Pe(he,be),Pe(ue,be);const xe={"_prelude_fog.vertex.glsl":fe,"_prelude_terrain.vertex.glsl":pe,"_prelude_shadow.vertex.glsl":ve,"_prelude_fog.fragment.glsl":me,"_prelude_shadow.fragment.glsl":_e,"_prelude_lighting.glsl":"\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}\n#endif//LIGHTING_3D_MODE","_prelude_raster_array.glsl":ge,"_prelude_raster_particle.glsl":ye},we={};ke("",pe),ke(me,fe),ke(_e,ve),ke(ge,""),ke(ye,"");const Te=ke(ue,he),Ee=ce;var Se={background:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nin vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_lighting.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),backgroundPattern:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),circle:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\nglFragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}'),clippingMask:ke("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ke('#include "_prelude_fog.fragment.glsl"\nuniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),heatmapTexture:ke("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(0.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}","in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:ke("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",'#include "_prelude_terrain.vertex.glsl"\nin vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}'),collisionCircle:ke("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}","in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ke("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",'#include "_prelude_terrain.vertex.glsl"\nin vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;\n#endif\nout vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}'),fill:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutline:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin highp vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutlinePattern:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;out highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillPattern:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillExtrusion:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec4 v_color;in vec4 v_flat;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;\n#endif\nuniform lowp float u_opacity;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec2 v_ao;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nin vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nin highp vec3 v_normal;\n#endif\nuniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nin float v_flood_radius;in float v_has_floodlight;\n#endif\nuniform float u_emissive_strength;in float v_height;void main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nvec3 normal=normalize(v_normal);\n#endif\nfloat z;vec4 color=v_color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);\n#ifdef LIGHTING_3D_MODE\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#else\ncolor=mix(v_color,v_roof_color,z);\n#endif\n#endif\nfloat h=max(0.0,v_height);float ao_shade=1.0;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\ncolor.rgb*=mix(ao_shade,1.0,v_has_floodlight);\n#else\ncolor.rgb*=ao_shade;\n#endif\n#else\ncolor.rgb*=ao_shade;\n#endif\n#endif\n#ifdef LIGHTING_3D_MODE\nfloat flood_radiance=0.0;\n#ifdef FLOOD_LIGHT\nflood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef FLOOD_LIGHT\nfloat ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);\n#else\nfloat shadowed_lighting_factor;\n#ifdef RENDER_CUTOFF\nshadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}\n#else\nshadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);\n#endif\ncolor.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);\n#endif\n#else\ncolor.rgb=apply_lighting(color.rgb,normal);\n#ifdef FLOOD_LIGHT\ncolor.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);\n#endif\n#endif\ncolor.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));\n#endif\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_alignment;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef RENDER_WALL_MODE\nin vec4 a_join_normal_inside_polygon;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nuniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nout vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nout highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec2 v_ao;\n#endif\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nout float v_flood_radius;out float v_has_floodlight;\n#endif\nout float v_height;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define highp float flood_light_wall_radius\n#pragma mapbox: define highp float line_width\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize highp float flood_light_wall_radius\n#pragma mapbox: initialize highp float line_width\nbase*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nv_normal=normal;\n#endif\nbase=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat cutoff=1.0;vec3 scaled_pos=pos;\n#ifdef RENDER_CUTOFF\nvec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);\n#endif\nfloat hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0));\n#ifdef RENDER_WALL_MODE\nvec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside_polygon.xy/EXTENT);float isPolygon=a_join_normal_inside_polygon.w;float sideAlignment=abs(isPolygon*u_alignment);scaled_pos.xy+=(1.0-a_join_normal_inside_polygon.z)*mix(wall_offset*0.5,wall_offset*mix(1.0,0.0,max(u_alignment,0.0)),sideAlignment);scaled_pos.xy-=a_join_normal_inside_polygon.z*mix(wall_offset*0.5,wall_offset*mix(0.0,1.0,max(u_alignment,0.0)),sideAlignment);\n#endif\ngl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=pos;vec3 shd_pos1=pos;\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifndef LIGHTING_3D_MODE\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#endif\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\nfloat is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;\n#endif\nv_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);\n#else\nv_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),fillExtrusionDepth:ke("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_alignment;uniform float u_width_scale;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef RENDER_WALL_MODE\nin vec4 a_join_normal_inside_polygon;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp float line_width\nout highp float v_depth;void main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp float line_width\nbase*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nvec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);\n#else\npos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\n#ifdef RENDER_WALL_MODE\nvec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside_polygon.xy/EXTENT);float isPolygon=a_join_normal_inside_polygon.w;float sideAlignment=abs(isPolygon*u_alignment);pos.xy+=(1.0-a_join_normal_inside_polygon.z)*mix(wall_offset*0.5,wall_offset*mix(1.0,0.0,max(u_alignment,0.0)),sideAlignment);pos.xy-=a_join_normal_inside_polygon.z*mix(wall_offset*0.5,wall_offset*mix(0.0,1.0,max(u_alignment,0.0)),sideAlignment);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}'),fillExtrusionPattern:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nin vec3 v_normal;\n#endif\nin vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_alignment;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef RENDER_WALL_MODE\nin vec4 a_join_normal_inside_polygon;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nout vec2 v_pos;out vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nout vec3 v_normal;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\n#pragma mapbox: define highp float line_width\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\n#pragma mapbox: initialize highp float line_width\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\n#ifdef RENDER_WALL_MODE\nvec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside_polygon.xy/EXTENT);float isPolygon=a_join_normal_inside_polygon.w;float sideAlignment=abs(isPolygon*u_alignment);p.xy+=(1.0-a_join_normal_inside_polygon.z)*mix(wall_offset*0.5,wall_offset*mix(1.0,0.0,max(u_alignment,0.0)),sideAlignment);p.xy-=a_join_normal_inside_polygon.z*mix(wall_offset*0.5,wall_offset*mix(0.0,1.0,max(u_alignment,0.0)),sideAlignment);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_normal=normal;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}'),groundShadow:ke('#include "_prelude_shadow.fragment.glsl"\nprecision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\nvoid main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);\n#ifdef RENDER_CUTOFF\nshadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));\n#endif\n#ifdef FOG\nshadow=mix(shadow,vec3(1.0),v_fog_opacity);\n#endif\n#ifdef INDICATOR_CUTOUT\nshadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);\n#endif\nglFragColor=vec4(shadow,1.0);}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);\n#endif\n}'),fillExtrusionGroundEffect:ke("uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;\n#ifdef SDF_SUBPASS\nin highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}\n#ifdef FOG\nin highp float v_fog;\n#endif\n#endif\nvoid main() {\n#ifdef CLEAR_SUBPASS\nvec4 color=vec4(1.0);\n#ifdef CLEAR_FROM_TEXTURE\ncolor=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));\n#endif\nglFragColor=color;\n#else\n#ifdef SDF_SUBPASS\nhighp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;\n#ifdef FOG\nfog=v_fog;\n#endif\n#ifdef RENDER_CUTOFF\nfog*=v_cutoff_opacity;\n#endif\nglFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));\n#else\nvec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);\n#ifdef OVERDRAW_INSPECTOR\ncolor=vec4(1.0);\n#endif\nglFragColor=color;\n#endif\nHANDLE_WIREFRAME_DEBUG;\n#endif\n}",'#include "_prelude_fog.vertex.glsl"\nin highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;\n#ifdef SDF_SUBPASS\nout highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;\n#ifdef FOG\nout highp float v_fog;\n#endif\n#endif\nuniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;\n#pragma mapbox: define highp float flood_light_ground_radius\nconst float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {\n#pragma mapbox: initialize highp float flood_light_ground_radius\nvec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;\n#ifdef SDF_SUBPASS\nv_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);\n#ifdef FOG\nv_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);\n#endif\n#endif\nfloat hidden_by_landmark=0.0;\n#ifdef HAS_CENTROID\nhidden_by_landmark=a_hidden_by_landmark;\n#endif\nfloat isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n}'),hillshadePrepare:ke("precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\nglFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);\n#endif\n#ifdef FOG\nglFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),line:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;in vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nfloat luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trim_alpha=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}\n#endif\nif (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nout_color*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define EXTRUDE_SCALE 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(ELEVATED)\nin float a_z_offset;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nin highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nin float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);\n#if defined(ELEVATED)\nvec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);\n#else\ngl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#endif\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),linePattern:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;\n#ifdef RENDER_LINE_TRIM_OFFSET\nin highp vec4 v_uv;\n#endif\n#ifdef LINE_JOIN_NONE\nin vec2 v_pattern_data;\n#endif\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define mediump float pixel_ratio\n#pragma mapbox: define mediump float blur\n#pragma mapbox: define mediump float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize mediump float pixel_ratio\n#pragma mapbox: initialize mediump float blur\n#pragma mapbox: initialize mediump float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;float x=mod(pattern_x,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}\n#endif\n#ifdef LINE_JOIN_NONE\nfloat pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}\n#endif\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting_ground(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(ELEVATED)\nin float a_z_offset;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nin highp vec4 a_packed;\n#endif\nin highp float a_linesofar;\n#ifdef LINE_JOIN_NONE\nin highp vec3 a_pattern_data;out vec2 v_pattern_data;\n#endif\nuniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;\n#ifdef RENDER_LINE_TRIM_OFFSET\nout highp vec4 v_uv;\n#endif\n#pragma mapbox: define mediump float blur\n#pragma mapbox: define mediump float opacity\n#pragma mapbox: define mediump float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define mediump float floorwidth\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define mediump float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize mediump float blur\n#pragma mapbox: initialize mediump float opacity\n#pragma mapbox: initialize mediump float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize mediump float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize mediump float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);\n#if defined(ELEVATED)\nvec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);\n#else\ngl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#endif\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nfloat a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef LINE_JOIN_NONE\nv_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),raster:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_raster_array.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;\n#ifdef PROJECTION_GLOBE_VIEW\nin float v_split_fade;\n#endif\nuniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;\n#ifndef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;\n#endif\n#ifdef RASTER_COLOR\nuniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;\n#endif\nvoid main() {vec4 color0,color1,color;vec2 value;\n#ifdef RASTER_COLOR\n#ifdef RASTER_ARRAY\n#ifdef RASTER_ARRAY_LINEAR\nvalue=mix(\nraTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#else\nvalue=mix(\nraTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#endif\nif (value.y > 0.0) value.x/=value.y;\n#else\ncolor=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);\n#endif\ncolor=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;\n#else\ncolor0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);\n#endif\ncolor.a*=u_opacity;\n#ifdef GLOBE_POLES\ncolor.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);\n#endif\nvec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef PROJECTION_GLOBE_VIEW\nglFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));\n#endif\n#ifdef RENDER_CUTOFF\nglFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;in vec2 a_texture_pos;\n#endif\nout vec2 v_pos0;out vec2 v_pos1;out float v_depth;\n#ifdef PROJECTION_GLOBE_VIEW\nout float v_split_fade;\n#endif\nvoid main() {vec2 uv;\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);\n#endif\n#else\nfloat w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    \nv_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\ngl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;\n#ifdef RENDER_CUTOFF\nv_depth=gl_Position.z;\n#endif\n}'),rasterParticle:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8\nin vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\nuv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}'),rasterParticleDraw:ke("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",'#include "_prelude_raster_particle.glsl"\nin float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(\nmod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}'),rasterParticleTexture:ke("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:ke('#include "_prelude_raster_particle.glsl"\nuniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(\nlinearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)\n);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}',"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbolIcon:ke('#include "_prelude_lighting.glsl"\nuniform sampler2D u_texture;\n#ifdef ICON_TRANSITION\nuniform float u_icon_transition;\n#endif\nin float v_fade_opacity;in vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nin vec2 v_tex_b;\n#endif\n#ifdef COLOR_ADJUSTMENT\nuniform mat4 u_color_adj_mat;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float emissive_strength\nlowp float alpha=opacity*v_fade_opacity;vec4 out_color;\n#ifdef ICON_TRANSITION\nvec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);\n#else\nout_color=texture(u_texture,v_tex_a);\n#endif\n#ifdef COLOR_ADJUSTMENT\nout_color=u_color_adj_mat*out_color;\n#endif\nout_color*=alpha;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef OCCLUSION_QUERIES\nin float a_occlusion_query_opacity;\n#endif\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\n#ifdef ICON_TRANSITION\nin vec2 a_texb;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nout vec2 v_tex_b;\n#endif\nout float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float emissive_strength\n#pragma mapbox: define lowp float occlusion_opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float emissive_strength\n#pragma mapbox: initialize lowp float occlusion_opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;vec2 a;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;\n#endif\nvec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nv_tex_a=a_tex/u_texsize;\n#ifdef ICON_TRANSITION\nv_tex_b=a_texb/u_texsize;\n#endif\nv_fade_opacity=out_fade_opacity;\n#ifdef DEPTH_OCCLUSION\nfloat depthOcclusion=occlusionFadeMultiSample(projected_point);float depthOcclusionMultplier=mix(occlusion_opacity,1.0,depthOcclusion);v_fade_opacity*=depthOcclusionMultplier;\n#endif\n#ifdef OCCLUSION_QUERIES\nfloat occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);v_fade_opacity*=occludedFadeMultiplier;\n#endif\n}'),symbolSDF:ke('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\nuniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\n#ifdef OCCLUSION_QUERIES\nin float a_occlusion_query_opacity;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout float v_draw_halo;out vec2 v_data0;out vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\n#pragma mapbox: define lowp float occlusion_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\n#pragma mapbox: initialize lowp float occlusion_opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;\n#endif\nvec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;\n#ifdef DEPTH_OCCLUSION\nfloat depthOcclusion=occlusionFadeMultiSample(projected_point);float depthOcclusionMultplier=mix(occlusion_opacity,1.0,depthOcclusion);out_fade_opacity*=depthOcclusionMultplier;\n#endif\n#ifdef OCCLUSION_QUERIES\nfloat occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;\n#endif\nfloat alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}'),symbolTextAndIcon:ke('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef OCCLUSION_QUERIES\nin float a_occlusion_query_opacity;\n#endif\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout float v_draw_halo;out vec4 v_data0;out vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\n#pragma mapbox: define lowp float occlusion_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\n#pragma mapbox: initialize lowp float occlusion_opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nfloat out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;\n#ifdef DEPTH_OCCLUSION\nfloat depthOcclusion=occlusionFadeMultiSample(projected_point);float depthOcclusionMultplier=mix(occlusion_opacity,1.0,depthOcclusion);out_fade_opacity*=depthOcclusionMultplier;\n#endif\n#ifdef OCCLUSION_QUERIES\nfloat occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;\n#endif\nfloat alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+ xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}'),terrainRaster:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;in vec2 v_pos0;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;\n#endif\nuniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;\n#ifdef LIGHTING_3D_MODE\nconst vec3 normal=vec3(0.0,0.0,1.0);\n#ifdef RENDER_SHADOWS\nfloat cutoffOpacity=1.0;\n#ifdef RENDER_CUTOFF\ncutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);\n#endif\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nvec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;\n#else\nfloat lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));\n#endif\n#else\nfloat lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;\n#endif\n#endif\n#else\ncolor=image_color;\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;\n#endif\nvoid main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);\n#endif\n}'),terrainDepth:ke("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}'),skybox:ke('#include "_prelude_fog.fragment.glsl"\nin lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',de),skyboxGradient:ke('#include "_prelude_fog.fragment.glsl"\nin highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',de),skyboxCapture:ke("\nin highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}","in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nraster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);\n#else\nraster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;\n#else\ncolor=apply_lighting_ground(color);\n#endif\n#endif\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;\n#endif\nout vec2 v_pos0;void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);globe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}'),globeAtmosphere:ke('#include "_prelude_fog.fragment.glsl"\nuniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {\n#ifdef ALPHA_PASS\nglFragColor=vec4(0,0,0,0);return;\n#else\n#ifdef NATIVE\nglFragColor=vec4(1,1,1,1);\n#else\nglFragColor=vec4(0,0,0,1);\n#endif\nreturn;\n#endif\n}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;\n#ifdef ALPHA_PASS\nfloat a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);\n#else\nvec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;\n#ifndef NATIVE\nc=dither(c,gl_FragCoord.xy+u_temporal_offset);\n#endif\nglFragColor=vec4(c*t,t);\n#endif\n}',"in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}"),model:ke('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;\n#endif\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nuniform vec4 u_occlusionTextureTransform;\n#endif\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#ifdef HAS_ATTRIBUTE_a_pbr\nin lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;\n#endif\n#ifdef HAS_TEXTURE_u_baseColorTexture\nuniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;\n#endif\n#ifdef HAS_TEXTURE_u_metallicRoughnessTexture\nuniform sampler2D u_metallicRoughnessTexture;\n#endif\n#ifdef HAS_TEXTURE_u_occlusionTexture\nuniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;\n#endif\n#ifdef HAS_TEXTURE_u_normalTexture\nuniform sampler2D u_normalTexture;\n#endif\n#ifdef HAS_TEXTURE_u_emissionTexture\nuniform sampler2D u_emissionTexture;\n#endif\n#ifdef APPLY_LUT_ON_GPU\nuniform highp sampler3D u_lutTexture;\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nin highp float v_depth;uniform highp sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;uniform vec2 u_depth_range_unpack;\n#ifdef DEPTH_D24\nfloat unpack_depth(float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}\n#else\nhighp float unpack_depth_rgba(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}\n#endif\nbool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;\n#ifdef DEPTH_D24\nhighp float depth=unpack_depth(texture(u_depthTexture,coord).r);\n#else\nhighp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));\n#endif\nreturn v_depth > depth+0.0005;}\n#endif\n#define saturate(_x) clamp(_x,0.,1.)\nvec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)\n{\n#ifdef LIGHTING_3D_MODE\nvec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));\n#endif\nreturn apply_lighting(albedo,transformed_normal,lighting_factor);\n#else\nvec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;\n#endif\n}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;\n#ifdef HAS_ATTRIBUTE_a_color_3f\nalbedo*=vec4(color_3f,1.0);\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#else\n#ifdef HAS_ATTRIBUTE_a_color_4f\nalbedo*=color_4f;\n#endif\n#endif\n#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)\nvec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}\n#ifdef UNPREMULT_TEXTURE_IN_SHADER\nif(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;\n#endif\nif(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}\n#endif\nvec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);\n#ifdef APPLY_LUT_ON_GPU\ncolor=applyLUT(u_lutTexture,color);\n#endif\nreturn color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {\n#ifdef HAS_TEXTURE_u_normalTexture\nhighp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;\n#else\nreturn mat3(1.0);\n#endif\n}highp vec3 getNormal(){highp vec3 n;\n#ifdef HAS_ATTRIBUTE_a_normal_3f\nn=normalize(normal_3f);\n#else\nhighp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;\n#endif\n#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nvec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);\n#endif\nreturn n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;\n#ifdef HAS_ATTRIBUTE_a_pbr\nmat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;\n#endif\n#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) \nvec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;\n#endif\nconst float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)\n{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)\n{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)\n{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)\n{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)\n{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)\n{\n#ifdef LIGHTING_3D_MODE\nreturn mat.diffuseColor;\n#else\nreturn mat.diffuseColor/PI;\n#endif\n}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)\n{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)\n{vec3 env_light=vec3(0.65,0.65,0.65);\n#ifdef LIGHTING_3D_MODE\nfloat ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;\n#endif\nvec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)\n{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=NdotL;\n#endif\nvec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;\n#if !defined(LIGHTING_3D_MODE)\nconst vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);\n#endif\ncolor*=intensityFactor;return color;}void main() {\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nif (isOccluded()) {discard;}\n#endif\nvec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;\n#ifdef LIGHTING_3D_MODE\nlightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;\n#endif\nvec4 finalColor;\n#ifdef DIFFUSE_SHADED\nvec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);\n#ifdef HAS_TEXTURE_u_occlusionTexture\nfloat ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;\n#endif\nfinalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;\n#else\nMaterial mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;\n#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nvec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;\n#else\nvec2 uv=uv_2f;\n#endif\nao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;\n#endif\nvec4 emissive=u_emissiveFactor;\n#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nemissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);\n#endif\n#ifdef APPLY_LUT_ON_GPU\nfloat emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;\n#endif\ncolor+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;\n#ifdef HAS_ATTRIBUTE_a_pbr\nfloat resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;\n#ifdef APPLY_LUT_ON_GPU\ncolor_mix=applyLUT(u_lutTexture,color_mix);\n#endif\ncolor=mix(color,color_mix,min(1.0,resEmission));\n#ifdef HAS_ATTRIBUTE_a_color_4f\nfloat distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);\n#endif\n#endif\nvec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);\n#endif\n#ifdef FOG\nfinalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));\n#endif\n#ifdef RENDER_CUTOFF\nfinalColor*=v_cutoff_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\nfinalColor=applyCutout(finalColor);\n#endif\nglFragColor=finalColor;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec3 a_pos_3f;\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr\n#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength\nuniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_normal_matrix;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;\n#endif\nout vec4 v_position_height;out lowp vec4 v_color_mix;\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nout highp float v_depth;\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\nout lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;\n#endif\nvec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute-custom highp vec4 pbr\n#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength\nhighp mat4 normal_matrix;\n#ifdef INSTANCED_ARRAYS\nnormal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\nnormal_matrix=u_normal_matrix;\n#endif\nvec3 local_pos;mat3 rs;\n#ifdef MODEL_POSITION_ON_GPU\nvec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;\n#else\nlocal_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);\n#endif\nv_position_height.w=a_pos_3f.z;\n#ifdef HAS_ATTRIBUTE_a_pbr\nvec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(local_pos);\n#endif\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nfloat x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);\n#else\nnormal_3f=vec3(normal_matrix*vec4(normal_3f,0));\n#endif\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#ifdef HAS_ATTRIBUTE_a_color_4f\nv_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);\n#ifdef NORMAL_OFFSET\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nvec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();\n#else\nvec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();\n#endif\n#endif\n#endif\nv_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;\n#endif\n}'),modelDepth:ke("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}","in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;\n#ifdef MODEL_POSITION_ON_GPU\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_instance;\n#endif\nuniform highp mat4 u_node_matrix;\n#endif\nvoid main() {\n#ifdef MODEL_POSITION_ON_GPU\nhighp mat4 instance;\n#ifdef INSTANCED_ARRAYS\ninstance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\ninstance=u_instance;\n#endif\nvec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);\n#else\ngl_Position=u_matrix*vec4(a_pos_3f,1);\n#endif\nv_depth=gl_Position.z/gl_Position.w;}"),stars:ke("in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)\n{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}","\nin vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}"),occlusion:ke("uniform vec4 u_color;void main() {glFragColor=u_color;}",'#include "_prelude_terrain.vertex.glsl"\nin highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;\n#ifdef TERRAIN\nfloat e=elevation(world_pos.xy);world_pos.z+=e;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}')};function Pe(t,e){const r=t.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let t of r)if(t=t.trim(),"#"===t[0]&&t.includes("if")&&!t.includes("endif")){t=t.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const r=t.split(" ");for(const t of r)e.includes(t)||e.push(t)}}function ke(t,e){const r=/#include\s+"([^"]+)"/g,i=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let n=e.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);n&&(n=n.map((t=>{const e=t.split(" ");return e[e.length-1]})),n=[...new Set(n)]);const o={},s=[],a=[];if(t=t.replace(r,((t,e)=>(a.push(e),""))),(e=e.replace(r,((t,e)=>(s.push(e),"")))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let l=[...be];Pe(t,l),Pe(e,l);for(const t of[...s,...a])xe[t]||console.error(`Undefined include: ${t}`),we[t]||(we[t]=[],Pe(xe[t],we[t])),l=[...l,...we[t]];return{fragmentSource:t=t.replace(i,((t,e,r,i,n)=>(o[n]=!0,"define"===e?`\n#ifndef HAS_UNIFORM_u_${n}\nin ${r} ${i} ${n};\n#else\nuniform ${r} ${i} u_${n};\n#endif\n`:"initialize"===e?`\n#ifdef HAS_UNIFORM_u_${n}\n    ${r} ${i} ${n} = u_${n};\n#endif\n`:"define-attribute"===e?`\n#ifdef HAS_ATTRIBUTE_a_${n}\n    in ${r} ${i} ${n};\n#endif\n`:"initialize-attribute"===e?"":void 0))),vertexSource:e=e.replace(i,((t,e,r,i,n)=>{const s="float"===i?"vec2":i,a=n.match(/color/)?"color":s;return"define-attribute-vertex-shader-only"===e?`\n#ifdef HAS_ATTRIBUTE_a_${n}\nin ${r} ${i} a_${n};\n#endif\n`:o[n]?"define"===e?`\n#ifndef HAS_UNIFORM_u_${n}\nuniform lowp float u_${n}_t;\nin ${r} ${s} a_${n};\nout ${r} ${i} ${n};\n#else\nuniform ${r} ${i} u_${n};\n#endif\n`:"initialize"===e?"vec4"===a?`\n#ifndef HAS_UNIFORM_u_${n}\n    ${n} = a_${n};\n#else\n    ${r} ${i} ${n} = u_${n};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${n}\n    ${n} = unpack_mix_${a}(a_${n}, u_${n}_t);\n#else\n    ${r} ${i} ${n} = u_${n};\n#endif\n`:"define-attribute"===e?`\n#ifdef HAS_ATTRIBUTE_a_${n}\n    in ${r} ${i} a_${n};\n    out ${r} ${i} ${n};\n#endif\n`:"initialize-attribute"===e?`\n#ifdef HAS_ATTRIBUTE_a_${n}\n    ${n} = a_${n};\n#endif\n`:void 0:"define"===e?`\n#ifndef HAS_UNIFORM_u_${n}\nuniform lowp float u_${n}_t;\nin ${r} ${s} a_${n};\n#else\nuniform ${r} ${i} u_${n};\n#endif\n`:"define-instanced"===e?"mat4"===a?`\n#ifdef INSTANCED_ARRAYS\nin vec4 a_${n}0;\nin vec4 a_${n}1;\nin vec4 a_${n}2;\nin vec4 a_${n}3;\n#else\nuniform ${r} ${i} u_${n};\n#endif\n`:`\n#ifdef INSTANCED_ARRAYS\nin ${r} ${s} a_${n};\n#else\nuniform ${r} ${i} u_${n};\n#endif\n`:"initialize-attribute-custom"===e?`\n#ifdef HAS_ATTRIBUTE_a_${n}\n    ${r} ${i} ${n} = a_${n};\n#endif\n`:"vec4"===a?`\n#ifndef HAS_UNIFORM_u_${n}\n    ${r} ${i} ${n} = a_${n};\n#else\n    ${r} ${i} ${n} = u_${n};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${n}\n    ${r} ${i} ${n} = unpack_mix_${a}(a_${n}, u_${n}_t);\n#else\n    ${r} ${i} ${n} = u_${n};\n#endif\n`})),staticAttributes:n,usedDefines:l,vertexIncludes:s,fragmentIncludes:a}}class Ae{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(t,e,r,i,n,o,s,a){this.context=t;let l=this.boundPaintVertexBuffers.length!==i.length;for(let t=0;!l&&t<i.length;t++)this.boundPaintVertexBuffers[t]!==i[t]&&(l=!0);let c=this.boundDynamicVertexBuffers.length!==s.length;for(let t=0;!c&&t<s.length;t++)this.boundDynamicVertexBuffers[t]!==s[t]&&(c=!0);if(!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==r||l||c||this.boundIndexBuffer!==n||this.boundVertexOffset!==o)this.freshBind(e,r,i,n,o,s,a);else{t.bindVertexArrayOES.set(this.vao);for(const r of s)r&&(r.bind(),a&&r.instanceCount&&r.setVertexAttribDivisor(t.gl,e,a));n&&n.dynamicDraw&&n.bind()}}freshBind(t,e,r,i,n,o,s){const a=t.numAttributes,l=this.context,c=l.gl;this.vao&&this.destroy(),this.vao=l.gl.createVertexArray(),l.bindVertexArrayOES.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=i,this.boundVertexOffset=n,this.boundDynamicVertexBuffers=o,e.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,n);for(const e of r)e.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,n);for(const e of o)e&&(e.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,n),s&&e.instanceCount&&e.setVertexAttribDivisor(c,t,s));i&&i.bind(),l.currentNumAttributes=a}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Me(e,r){const i=Math.pow(2,r.canonical.z),n=r.canonical.y;return[new t._(0,n/i).toLngLat().lat,new t._(0,(n+1)/i).toLngLat().lat]}function Ce(e,r,i,n,o,s,a){const l=e.context,c=l.gl,u=i.hillshadeFBO;if(!u)return;e.prepareDrawTile();const h=e.isTileAffectedByFog(r),d=e.getOrCreateProgram("hillshade",{overrideFog:h});l.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,u.colorAttachment.get());const p=((e,r,i,n)=>{const o=i.paint.get("hillshade-shadow-color"),s=i.paint.get("hillshade-highlight-color"),a=i.paint.get("hillshade-accent-color"),l=i.paint.get("hillshade-emissive-strength");let c=t.ac(i.paint.get("hillshade-illumination-direction"));if("viewport"===i.paint.get("hillshade-illumination-anchor"))c-=e.transform.angle;else if(e.style&&e.style.enable3dLights()&&e.style.directionalLight){const r=e.style.directionalLight.properties.get("direction"),i=t.ad(r.x,r.y,r.z);c=t.ac(i[1])}const u=!e.options.moving;return{u_matrix:n||e.transform.calculateProjMatrix(r.tileID.toUnwrapped(),u),u_image:0,u_latrange:Me(0,r.tileID),u_light:[i.paint.get("hillshade-exaggeration"),c],u_shadow:o.toRenderColor(i.lut),u_highlight:s.toRenderColor(i.lut),u_emissive_strength:l,u_accent:a.toRenderColor(i.lut)}})(e,i,n,e.terrain?r.projMatrix:null);e.uploadCommonUniforms(l,d,r.toUnwrapped());const{tileBoundsBuffer:f,tileBoundsIndexBuffer:m,tileBoundsSegments:g}=e.getTileBoundsBuffers(i);d.draw(e,c.TRIANGLES,o,s,a,t.ag.disabled,p,n.id,f,m,g)}function Ie(e,r,i){if(!r.needsDEMTextureUpload)return;const n=e.context,o=n.gl;n.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||e.getTileTexture(i.stride);const s=i.getPixels();r.demTexture?r.demTexture.update(s,{premultiply:!1}):r.demTexture=new t.T(n,s,o.R32F,{premultiply:!1}),r.needsDEMTextureUpload=!1}function Oe(e,r,i){const n=e.context,o=n.gl;if(!r.dem)return;const s=r.dem;if(n.activeTexture.set(o.TEXTURE1),Ie(e,r,s),!r.demTexture)return;r.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE);const a=s.dim;n.activeTexture.set(o.TEXTURE0);let l=r.hillshadeFBO;if(!l){const e=new t.T(n,{width:a,height:a,data:null},o.RGBA);e.bind(o.LINEAR,o.CLAMP_TO_EDGE),l=r.hillshadeFBO=n.createFramebuffer(a,a,!0,"renderbuffer"),l.colorAttachment.set(e.texture)}n.bindFramebuffer.set(l.framebuffer),n.viewport.set([0,0,a,a]);const{tileBoundsBuffer:c,tileBoundsIndexBuffer:u,tileBoundsSegments:h}=e.getMercatorTileBoundsBuffers(),d=[];e.linearFloatFilteringSupported()&&d.push("TERRAIN_DEM_FLOAT_FORMAT"),e.getOrCreateProgram("hillshadePrepare",{defines:d}).draw(e,o.TRIANGLES,t.af.disabled,t.ah.disabled,t.a.unblended,t.ag.disabled,((e,r)=>{const i=r.stride,n=t.ae.create();return t.ae.ortho(n,0,t.a4,-t.a4,0,0,1),t.ae.translate(n,n,[0,-t.a4,0]),{u_matrix:n,u_image:1,u_dimension:[i,i],u_zoom:e.overscaledZ}})(r.tileID,s),i.id,c,u,h),r.needsHillshadePrepare=!1}function Le(e,r,i,n,o){const s=function(i,n){if(i)return o(i);if(n){if(e.url&&n.tiles&&e.tiles&&delete e.tiles,n.variants){if(!Array.isArray(n.variants))return o(new Error("variants must be an array"));for(const e of n.variants){if(null==e||"object"!=typeof e||e.constructor!==Object)return o(new Error("variant must be an object"));if(!Array.isArray(e.capabilities))return o(new Error("capabilities must be an array"));if(1===e.capabilities.length&&"meshopt"===e.capabilities[0]){n=t.Q(n,e);break}}}const i=t.ai(t.Q(n,e),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);n.vector_layers&&(i.vectorLayers=n.vector_layers,i.vectorLayerIds=i.vectorLayers.map((t=>t.id))),n.raster_layers&&(i.rasterLayers=n.raster_layers,i.rasterLayerIds=i.rasterLayers.map((t=>t.id))),i.tiles=r.canonicalizeTileset(i,e.url),o(null,i)}},a=function(t,e,r){if(!t)return null;if(!e&&!r)return t;r=r||t.worldview_default;const i=Object.values(t.language||{});if(0===i.length)return null;const n=Object.values(t.worldview||{});if(0===n.length)return null;const o=i.every((t=>t===e)),s=n.every((t=>t===r));return o&&s?t:e in(t.language_options||{})||r in(t.worldview_options||{})?null:t.language_options&&t.worldview_options?t:null}(e.data,i,n);return a?t.e.frame((()=>s(null,a))):e.url?t.h(r.transformRequest(r.normalizeSourceURL(e.url,null,i,n),t.R.Source),s):t.e.frame((()=>{const{data:t,...r}=e;s(null,r)}))}class De{constructor(e,r,i){this.bounds=t.aj.convert(this.validateBounds(e)),this.minzoom=r||0,this.maxzoom=i||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(e){const r=Math.pow(2,e.z),i=Math.floor(t.ak(this.bounds.getWest())*r),n=Math.floor(t.al(this.bounds.getNorth())*r),o=Math.ceil(t.ak(this.bounds.getEast())*r),s=Math.ceil(t.al(this.bounds.getSouth())*r);return e.x>=i&&e.x<o&&e.y>=n&&e.y<s}}class Re extends t.E{constructor(e,r,i,n){super(),this.id=e,this.dispatcher=i,this.setEventedParent(n),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.Q({type:"raster"},r),t.Q(this,t.ai(r,["url","scheme","tileSize"]))}load(e){this._loaded=!1,this.fire(new t.g("dataloading",{dataType:"source"})),this._tileJSONRequest=Le(this._options,this.map._requestManager,null,null,((r,i)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new t.f(r)):i&&(t.Q(this,i),i.bounds&&(this.tileBounds=new De(i.bounds,this.minzoom,this.maxzoom)),t.ao(i.tiles),this.fire(new t.g("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.g("data",{dataType:"source",sourceDataType:"content"}))),e&&e(r)}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const e=t.am(this.id,this.scope);this.load((()=>this.map.style.clearSource(e)))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(t){this.cancelTileJSONRequest()}serialize(){return t.Q({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(e,r){const i=t.e.devicePixelRatio>=2,n=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),i,this.tileSize);e.request=t.i(this.map._requestManager.transformRequest(n,t.R.Tile),((i,n,o,s)=>(delete e.request,e.aborted?(e.state="unloaded",r(null)):i?(e.state="errored",r(i)):n?(this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:o,expires:s}),e.setTexture(n,this.map.painter),e.state="loaded",t.an(this.dispatcher),void r(null)):r(null))))}abortTile(t,e){t.request&&(t.request.cancel(),delete t.request),e&&e()}unloadTile(e,r){e.texture&&e.texture instanceof t.T?(e.destroy(!0),e.texture&&e.texture instanceof t.T&&this.map.painter.saveTileTexture(e.texture)):e.destroy(),r&&r()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Fe extends t.E{constructor(e,r,i,n){if(super(),this.id=e,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.Q(this,t.ai(r,["url","scheme","tileSize","promoteId"])),this._options=t.Q({type:"vector"},r),this._collectResourceTiming=!!r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(n),this._tileWorkers={},this._deduped=new t.ap}load(e){this._loaded=!1,this.fire(new t.g("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,i=this.map._worldview;this._tileJSONRequest=Le(this._options,this.map._requestManager,r,i,((n,o)=>{this._tileJSONRequest=null,this._loaded=!0,n?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),i&&2!==i.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${i}`),this.fire(new t.f(n))):o&&(t.Q(this,o),o.bounds&&(this.tileBounds=new De(o.bounds,this.minzoom,this.maxzoom)),t.ao(o.tiles,this.map._requestManager._customAccessToken),this.fire(new t.g("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.g("data",{dataType:"source",sourceDataType:"content"}))),e&&e(n)}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const e=t.am(this.id,this.scope);this.load((()=>this.map.style.clearSource(e)))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(t){this.cancelTileJSONRequest()}serialize(){return t.Q({},this._options)}loadTile(e,r){const i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),n=this.map._requestManager.transformRequest(i,t.R.Tile),o=this.map.style?this.map.style.getLut(this.scope):null,s={request:n,data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,lut:o?{image:o.image.clone()}:null,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:t.e.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:e.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:e.isExtraShadowCaster,tessellationStep:this.map._tessellationStep};if(s.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state)"loading"===e.state?e.reloadCallback=r:e.request=e.actor.send("reloadTile",s,a.bind(this));else if(e.actor=this._tileWorkers[i]=this._tileWorkers[i]||this.dispatcher.getActor(),this.dispatcher.ready)e.request=e.actor.send("loadTile",s,a.bind(this),void 0,!0);else{const r=t.aq.call({deduped:this._deduped},s,((t,r)=>{t||!r?a.call(this,t):(s.data={cacheControl:r.cacheControl,expires:r.expires,rawData:r.rawData.slice(0)},e.actor&&e.actor.send("loadTile",s,a.bind(this),void 0,!0))}),!0);e.request={cancel:r}}function a(i,n){return delete e.request,e.aborted?r(null):i&&404!==i.status?r(i):(n&&n.resourceTiming&&(e.resourceTiming=n.resourceTiming),this.map._refreshExpiredTiles&&n&&e.setExpiryData(n),e.loadVectorData(n,this.map.painter),t.an(this.dispatcher),r(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(t,e){t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope}),t.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}const Be=(t,e,r)=>({u_matrix:t,u_image0:0,u_skirt_height:e,u_ground_shadow_factor:r}),ze=(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m)=>({u_proj_matrix:Float32Array.from(t),u_globe_matrix:e,u_normalize_matrix:Float32Array.from(i),u_merc_matrix:r,u_zoom_transition:n,u_merc_center:o,u_image0:0,u_frustum_tl:s,u_frustum_tr:a,u_frustum_br:l,u_frustum_bl:c,u_globe_pos:u,u_globe_radius:h,u_viewport:d,u_grid_matrix:m?Float32Array.from(m):new Float32Array(9),u_skirt_height:p,u_far_z_cutoff:f});class je{constructor(t=0,e=0,r=0,i=0){if(isNaN(t)||t<0||isNaN(e)||e<0||isNaN(r)||r<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=r,this.right=i}interpolate(e,r,i){return null!=r.top&&null!=e.top&&(this.top=t.a3(e.top,r.top,i)),null!=r.bottom&&null!=e.bottom&&(this.bottom=t.a3(e.bottom,r.bottom,i)),null!=r.left&&null!=e.left&&(this.left=t.a3(e.left,r.left,i)),null!=r.right&&null!=e.right&&(this.right=t.a3(e.right,r.right,i)),this}getCenter(e,r){const i=t.au((this.left+e-this.right)/2,0,e),n=t.au((this.top+r-this.bottom)/2,0,r);return new t.P(i,n)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new je(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ne(e,r){const i=t.ax(e,3);t.ae.fromQuat(e,r),t.aA(e,3,i)}function Ve(e,r){const i=t.aw.identity([]);return t.aw.rotateZ(i,i,-r),t.aw.rotateX(i,i,-e),i}function Ue(e,r){const i=[e[0],e[1],0],n=[r[0],r[1],0];if(t.$.length(i)>=1e-15){const e=t.$.normalize([],i);t.$.scale(n,e,t.$.dot(n,e)),r[0]=n[0],r[1]=n[1]}const o=t.$.cross([],r,e);if(t.$.len(o)<1e-15)return null;const s=Math.atan2(-o[1],o[0]);return Ve(Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2]),s)}class $e{constructor(t,e){this.position=t,this.orientation=e}get position(){return this._position}set position(e){if(e){const r=e instanceof t._?e:new t._(e[0],e[1],e[2]);this._renderWorldCopies&&(r.x=t.av(r.x,0,1)),this._position=r}else this._position=null}lookAtPoint(e,r){if(this.orientation=null,!this.position)return;const i=this.position,n=this._elevation?this._elevation.getAtPointOrZero(t._.fromLngLat(e)):0,o=t._.fromLngLat(e,n),s=[o.x-i.x,o.y-i.y,o.z-i.z];r||(r=[0,0,1]),r[2]=Math.abs(r[2]),this.orientation=Ue(s,r)}setPitchBearing(e,r){this.orientation=Ve(t.ac(e),t.ac(-r))}}class Ge{constructor(e,r){this._transform=t.ae.identity([]),this.orientation=r,this.position=e}get mercatorPosition(){const e=this.position;return new t._(e[0],e[1],e[2])}get position(){const e=t.ax(this._transform,3);return[e[0],e[1],e[2]]}set position(e){var r;e&&t.aA(this._transform,3,[(r=e)[0],r[1],r[2],1])}get orientation(){return this._orientation}set orientation(e){this._orientation=e||t.aw.identity([]),e&&Ne(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),e=this.right();return{bearing:Math.atan2(-e[1],e[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,e){this._orientation=Ve(t,e),Ne(this._transform,this._orientation)}forward(){const e=t.ax(this._transform,2);return[-e[0],-e[1],-e[2]]}up(){const e=t.ax(this._transform,1);return[-e[0],-e[1],-e[2]]}right(){const e=t.ax(this._transform,0);return[e[0],e[1],e[2]]}getCameraToWorld(e,r){const i=new Float64Array(16);return t.ae.invert(i,this.getWorldToCamera(e,r)),i}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(e,r,i){const n=this.position;t.$.scale(n,n,-e);const o=new Float64Array(16);return t.ae.fromScaling(o,[i,i,i]),t.ae.translate(o,o,n),o[10]*=r,o}getWorldToCamera(e,r){const i=new Float64Array(16),n=new Float64Array(4),o=this.position;return t.aw.conjugate(n,this._orientation),t.$.scale(o,o,-e),t.ae.fromQuat(i,n),t.ae.translate(i,i,o),i[1]*=-1,i[5]*=-1,i[9]*=-1,i[13]*=-1,i[8]*=r,i[9]*=r,i[10]*=r,i[11]*=r,i}getCameraToClipPerspective(e,r,i,n){const o=new Float64Array(16);return t.ae.perspective(o,e,r,i,n),o}getCameraToClipOrthographic(e,r,i,n,o,s){const a=new Float64Array(16);return t.ae.ortho(a,e,r,i,n,o,s),a}getDistanceToElevation(e,r=!1){const i=0===e?0:t.ay(e,r?t.az(this.position[1]):this.position[1]),n=this.forward();return(i-this.position[2])/n[2]}clone(){return new Ge([...this.position],[...this.orientation])}}const He={unknown:0,flipRequired:1,flipNotRequired:2},qe=Math.tan(85*Math.PI/180);function We(e,r,i,n,o,s,a){const l=t.ae.create();if(i)if("globe"===s.name){const e=t.aC(o,r);t.ae.multiply(l,l,e)}else{const e=t.aD.invert([],a);l[0]=e[0],l[1]=e[1],l[4]=e[2],l[5]=e[3],n||t.ae.rotateZ(l,l,o.angle)}else t.ae.multiply(l,o.labelPlaneMatrix,e);return l}function Ze(t,e,r,i,n,o,s){const a=We(t,e,r,i,n,o,s);return"globe"===o.name&&r||(a[2]=a[6]=a[10]=a[14]=0),a}function Xe(e,r,i,n,o,s,a){if(i){if("globe"===s.name){const l=We(e,r,i,n,o,s,a);return t.ae.invert(l,l),t.ae.multiply(l,e,l),l}{const r=t.ae.clone(e),i=t.ae.identity([]);return i[0]=a[0],i[1]=a[1],i[4]=a[2],i[5]=a[3],t.ae.multiply(r,r,i),n||t.ae.rotateZ(r,r,-o.angle),r}}return o.glCoordMatrix}function Ye(e,r,i,n){const o=[e,r,i,1];i?t.aB.transformMat4(o,o,n):ar(o,o,n);const s=o[3];return o[0]/=s,o[1]/=s,o[2]/=s,o}function Ke(t,e){return Math.min(.5+t/e*.5,1.5)}function Je(t,e){const r=t[0]/t[3],i=t[1]/t[3];return r>=-e[0]&&r<=e[0]&&i>=-e[1]&&i<=e[1]}function Qe(e,r,i,n,o,s,a,l,c,u){const h=i.transform,d=n?e.textSizeData:e.iconSizeData,p=t.aE(d,i.transform.zoom),f="globe"===h.projection.name,m=[256/i.width*2+1,256/i.height*2+1],g=n?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;g.clear();let y=null;f&&(y=n?e.text.globeExtVertexArray:e.icon.globeExtVertexArray);const v=e.lineVertexArray,_=n?e.text.placedSymbolArray:e.icon.placedSymbolArray,b=i.transform.width/i.transform.height;let x,w=!1;for(let n=0;n<_.length;n++){const f=_.get(n),{numGlyphs:T,writingMode:E}=f;if(E!==t.aF.vertical||w||x===t.aF.horizontal||(w=!0),x=E,(f.hidden||E===t.aF.vertical)&&!w){sr(T,g);continue}w=!1;const S=new t.P(f.tileAnchorX,f.tileAnchorY);let{x:P,y:k,z:A}=h.projection.projectTilePoint(S.x,S.y,u.canonical);if(c){const[t,e,r]=c(S);P+=t,k+=e,A+=r}const M=[P,k,A,1];if(t.aB.transformMat4(M,M,r),!Je(M,m)){sr(T,g);continue}const C=M[3],I=Ke(i.transform.getCameraToCenterDistance(h.projection),C),O=t.aG(d,p,f),L=a?O/I:O*I,D=Ye(P,k,A,o);if(D[3]<=0){sr(T,g);continue}let R={};const F=a?null:c,B=rr(f,L,!1,l,r,o,s,e.glyphOffsetArray,v,g,y,D,S,R,b,F,h.projection,u,a);w=B.useVertical,F&&B.needsFlipping&&(R={}),(B.notEnoughRoom||w||B.needsFlipping&&rr(f,L,!0,l,r,o,s,e.glyphOffsetArray,v,g,y,D,S,R,b,F,h.projection,u,a).notEnoughRoom)&&sr(T,g)}n?(e.text.dynamicLayoutVertexBuffer.updateData(g),y&&e.text.globeExtVertexBuffer&&e.text.globeExtVertexBuffer.updateData(y)):(e.icon.dynamicLayoutVertexBuffer.updateData(g),y&&e.icon.globeExtVertexBuffer&&e.icon.globeExtVertexBuffer.updateData(y))}function tr(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m){const{lineStartIndex:g,glyphStartIndex:y,segment:v}=a,_=y+a.numGlyphs,b=g+a.lineLength,x=e.getoffsetX(y),w=e.getoffsetX(_-1),T=or(t*x,r,i,n,o,s,v,g,b,l,c,u,h,d,!0,p,f,m);if(!T)return null;const E=or(t*w,r,i,n,o,s,v,g,b,l,c,u,h,d,!0,p,f,m);return E?{first:T,last:E}:null}function er(e,r,i,n){return e===t.aF.horizontal&&Math.abs(n)>Math.abs(i)?{useVertical:!0}:e===t.aF.vertical?n>0?{needsFlipping:!0}:null:r!==He.unknown&&function(t,e){return 0===t||Math.abs(e/t)>qe}(i,n)?r===He.flipRequired?{needsFlipping:!0}:null:i<0?{needsFlipping:!0}:null}function rr(e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y,v,_){const b=r/24,x=e.lineOffsetX*b,w=e.lineOffsetY*b,{lineStartIndex:T,glyphStartIndex:E,numGlyphs:S,segment:P,writingMode:k,flipState:A}=e,M=T+e.lineLength,C=e=>{if(h){const[r,i,n]=e.up,o=u.length;t.aH(h,o+0,r,i,n),t.aH(h,o+1,r,i,n),t.aH(h,o+2,r,i,n),t.aH(h,o+3,r,i,n)}const[r,i,n]=e.point;t.aI(u,r,i,n,e.angle)};if(S>1){const t=tr(b,l,x,w,i,d,p,e,c,s,f,g,!1,y,v,_);if(!t)return{notEnoughRoom:!0};if(n&&!i){let[r,i,n]=t.first.point,[o,s,l]=t.last.point;[r,i]=Ye(r,i,n,a),[o,s]=Ye(o,s,l,a);const c=er(k,A,(o-r)*m,s-i);if(e.flipState=c&&c.needsFlipping?He.flipRequired:He.flipNotRequired,c)return c}C(t.first);for(let t=E+1;t<E+S-1;t++){const e=or(b*l.getoffsetX(t),x,w,i,d,p,P,T,M,c,s,f,g,!1,!1,y,v,_);if(!e)return u.length-=4*(t-E),{notEnoughRoom:!0};C(e)}C(t.last)}else{if(n&&!i){const r=Ye(p.x,p.y,0,o),i=T+P+1,n=new t.P(c.getx(i),c.gety(i)),s=Ye(n.x,n.y,0,o),a=s[3]>0?s:nr(p,n,r,1,o,void 0,y,v.canonical),l=er(k,A,(a[0]-r[0])*m,a[1]-r[1]);if(e.flipState=l&&l.needsFlipping?He.flipRequired:He.flipNotRequired,l)return l}const r=or(b*l.getoffsetX(E),x,w,i,d,p,P,T,M,c,s,f,g,!1,!1,y,v,_);if(!r)return{notEnoughRoom:!0};C(r)}return{}}function ir(t,e,r,i,n){const{x:o,y:s,z:a}=i.projectTilePoint(t.x,t.y,e);if(!n)return Ye(o,s,a,r);const[l,c,u]=n(t);return Ye(o+l,s+c,a+u,r)}function nr(e,r,i,n,o,s,a,l){const c=ir(e.sub(r)._unit()._add(e),l,o,a,s);return t.$.sub(c,i,c),t.$.normalize(c,c),t.$.scaleAndAdd(c,i,c,n)}function or(e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y,v){const _=n?e-r:e+r;let b=_>0?1:-1,x=0;n&&(b*=-1,x=Math.PI),b<0&&(x+=Math.PI);let w=l+a+(b>0?0:1)|0,T=o,E=o,S=0,P=0;const k=Math.abs(_),A=[],M=[];let C=s,I=C;const O=()=>nr(I,C,E,k-S+1,h,p,g,y.canonical);for(;S+P<=k;){if(w+=b,w<l||w>=c)return null;if(E=T,I=C,A.push(E),f&&M.push(I),C=new t.P(u.getx(w),u.gety(w)),T=d[w],!T){const t=ir(C,y.canonical,h,g,p);T=t[3]>0?d[w]=t:O()}S+=P,P=t.$.distance(E,T)}m&&p&&(d[w]&&(T=O(),P=t.$.distance(E,T)),d[w]=T);const L=(k-S)/P,D=C.sub(I)._mult(L)._add(I),R=t.$.sub([],T,E),F=t.$.scaleAndAdd([],E,R,L);let B=[0,0,1],z=R[0],j=R[1];if(v&&(B=g.upVector(y.canonical,D.x,D.y),0!==B[0]||0!==B[1]||1!==B[2])){const e=[B[2],0,-B[0]],r=t.$.cross([],B,e);t.$.normalize(e,e),t.$.normalize(r,r),z=t.$.dot(R,e),j=t.$.dot(R,r)}if(i){const e=t.$.cross([],B,R);t.$.normalize(e,e),t.$.scaleAndAdd(F,F,e,i*b)}const N=x+Math.atan2(j,z);return A.push(F),f&&M.push(D),{point:F,angle:N,path:A,tilePath:M,up:B}}function sr(t,e){const r=e.length,i=r+4*t;e.resize(i),e.float32.fill(-1/0,4*r,4*i)}function ar(t,e,r){const i=e[0],n=e[1];return t[0]=r[0]*i+r[4]*n+r[12],t[1]=r[1]*i+r[5]*n+r[13],t[3]=r[3]*i+r[7]*n+r[15],t}const lr=(t,e,r)=>(1-r)*t+r*e,cr=t=>t*t*t*t*t;class ur{constructor(e,r,i,n,o,s,a){this.tileSize=512,this._renderWorldCopies=void 0===o||o,this._minZoom=e||0,this._maxZoom=r||22,this._minPitch=i??0,this._maxPitch=n??60,this.setProjection(s),this.setMaxBounds(a),this.width=0,this.height=0,this._center=new t.aJ(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new je,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Ge,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const t=new ur(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.mercatorFromTransition=this.mercatorFromTransition,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get isOrthographic(){return"globe"!==this.projection.name&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return"globe"!==this.projection.name&&!this.isOrthographic}updateElevation(t,e=!1){const r=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||r)&&this._updateCameraOnTerrain(),(t||r)&&this._constrainCamera(e),this._calcMatrices()}getProjection(){return t.ai(this.projection,["name","center","parallels"])}setProjection(e){this.projectionOptions=e||{name:"mercator"};const r=this.projection?this.getProjection():void 0;this.projection=t.aK(this.projectionOptions);const i=this.getProjection(),n=!t.d(r,i);return n&&this._calcMatrices(),this.mercatorFromTransition=!1,n}setOrthographicProjectionAtLowPitch(t){return this._orthographicProjectionAtLowPitch!==t&&(this._orthographicProjectionAtLowPitch=t,this._calcMatrices(),!0)}setMercatorFromTransition(){const e=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=t.aK({name:"mercator"});const r=e!==this.projection.name;return r&&this._calcMatrices(),r}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return t.ay(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.P(this.width,this.height)}get bearing(){return t.av(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(e){const r=-e*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=t.aD.create(),t.aD.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const r=t.au(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const t=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/t)}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=t.ac(e),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._setZoom(e),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(t){this._tileCoverLift!==t&&(this._tileCoverLift=t)}_updateCameraOnTerrain(){const t=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,e=this.elevation&&t===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||t===Number.NEGATIVE_INFINITY&&(!e||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const r=this._elevation;e||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&r.exaggeration()&&this._centerAltitudeValidForExaggeration!==r.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*r.exaggeration(),this._centerAltitudeValidForExaggeration=r.exaggeration()):(this._centerAltitude=t||0,this._centerAltitudeValidForExaggeration=r.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const e=this._elevation,r=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],i=this.horizonLineFromTop();let n=0,o=0;for(let s=0;s<r.length;s++){const a=new t.P(r[s][0]*this.width,i+r[s][1]*(this.height-i)),l=e.pointCoordinate(a);if(!l)continue;const c=1/Math.hypot(l[0]-this._camera.position[0],l[1]-this._camera.position[1]);n+=l[3]*c,o+=c}return 0===o?NaN:n/o}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const t=this._seaLevelZoom,e=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),r=this.pixelsPerMeter/this.worldSize*e,i=this._mercatorZfromZoom(t),n=this._mercatorZfromZoom(this._maxZoom),o=Math.max(i-r,n);this._setZoom(this._zoomFromMercatorZ(o))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(e){const r=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,e.toAltitude()));let i;i=e.z<this._camera.position[2]?[r.x,r.y,r.z]:[e.x,e.y,e.z];const n=t.$.length(t.$.sub([],this._camera.position,i));return t.au(this._zoomFromMercatorZ(n),this._minZoom,this._maxZoom)}setFreeCameraOptions(e){if(!this.height)return;if(!e.position&&!e.orientation)return;this._updateCameraState();let r=!1;if(e.orientation&&!t.aw.exactEquals(e.orientation,this._camera.orientation)&&(r=this._setCameraOrientation(e.orientation)),e.position){const i=[e.position.x,e.position.y,e.position.z];t.$.exactEquals(i,this._camera.position)||(this._setCameraPosition(i),r=!0)}r&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const e=this._camera.position,r=new $e;return r.position=new t._(e[0],e[1],e[2]),r.orientation=this._camera.orientation,r._elevation=this.elevation,r._renderWorldCopies=this.renderWorldCopies,r}_setCameraOrientation(e){if(!t.aw.length(e))return!1;t.aw.normalize(e,e);const r=t.$.transformQuat([],[0,0,-1],e),i=t.$.transformQuat([],[0,-1,0],e);if(i[2]<0)return!1;const n=Ue(r,i);return!!n&&(this._camera.orientation=n,!0)}_setCameraPosition(e){const r=this.zoomScale(this.minZoom)*this.tileSize,i=this.zoomScale(this.maxZoom)*this.tileSize,n=this.cameraToCenterDistance;e[2]=t.au(e[2],n/i,n/r),this._camera.position=e}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,r){this._unmodified=!1,this._edgeInsets.interpolate(t,e,r),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)}getVisibleUnwrappedCoordinates(e){const r=[new t.aL(0,e)];if(this.renderWorldCopies){const i=this.pointCoordinate(new t.P(0,0)),n=this.pointCoordinate(new t.P(this.width,0)),o=this.pointCoordinate(new t.P(this.width,this.height)),s=this.pointCoordinate(new t.P(0,this.height)),a=Math.floor(Math.min(i.x,n.x,o.x,s.x)),l=Math.floor(Math.max(i.x,n.x,o.x,s.x)),c=1;for(let i=a-c;i<=l+c;i++)0!==i&&r.push(new t.aL(i,e))}return r}isLODDisabled(t){return(!t||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(e,r,i){let n=[];const o=void 0!==i,s=!o;if(s&&this.zoom<r)return n;if(o&&0===i[0]&&0===i[1])return n;const a=new Set,l=(e,r,i,o,s)=>{const l=t.b2(r,e,i,o,s);a.has(l)||(n.push(new t.aQ(e,r,i,o,s)),a.add(l))};for(let t=0;t<e.length;t++){const n=e[t];if(s&&n.canonical.z!==r)continue;const a=n.canonical,c=n.overscaledZ,u=n.wrap,h=1<<a.z,d=a.x+1<h,p=a.x>0,f=a.y+1<h,m=a.y>0,g=n.wrap-(p?0:1),y=n.wrap+(d?0:1),v=p?a.x-1:h-1,_=d?a.x+1:0;if(o)i[0]<0?(l(c,y,a.z,_,a.y),i[1]<0&&f&&(l(c,u,a.z,a.x,a.y+1),l(c,y,a.z,_,a.y+1)),i[1]>0&&m&&(l(c,u,a.z,a.x,a.y-1),l(c,y,a.z,_,a.y-1))):i[0]>0?(l(c,g,a.z,v,a.y),i[1]<0&&f&&(l(c,u,a.z,a.x,a.y+1),l(c,g,a.z,v,a.y+1)),i[1]>0&&m&&(l(c,u,a.z,a.x,a.y-1),l(c,g,a.z,v,a.y-1))):i[1]<0&&f?l(c,u,a.z,a.x,a.y+1):m&&l(c,u,a.z,a.x,a.y-1);else{const t=n.visibleQuadrants;1&t&&(l(c,g,a.z,v,a.y),m&&(l(c,u,a.z,a.x,a.y-1),l(c,g,a.z,v,a.y-1))),2&t&&(l(c,y,a.z,_,a.y),m&&(l(c,u,a.z,a.x,a.y-1),l(c,y,a.z,_,a.y-1))),4&t&&(l(c,g,a.z,v,a.y),f&&(l(c,u,a.z,a.x,a.y+1),l(c,g,a.z,v,a.y+1))),8&t&&(l(c,y,a.z,_,a.y),f&&(l(c,u,a.z,a.x,a.y+1),l(c,y,a.z,_,a.y+1)))}}const c=[];for(const t of n)n.some((e=>t.isChildOf(e)))||c.push(t);if(n=c.filter((t=>!e.some((e=>!!(t.overscaledZ<r&&e.isChildOf(t))||t.equals(e)||t.isChildOf(e))))),s){const t=1<<r,e="globe"===this.projection.name?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),i=[t*e.x,t*e.y],o=4,s=o*o;n=n.filter((t=>{const e=t.canonical.x+.5-i[0],r=t.canonical.y+.5-i[1];return e*e+r*r<s}))}return n}coveringTiles(e){let r=this.coveringZoomLevel(e);const i=r,n=this.elevation&&this.elevation.exaggeration(),o=n&&!e.isTerrainDEM,s="mercator"===this.projection.name;if(void 0!==e.minzoom&&r<e.minzoom)return[];void 0!==e.maxzoom&&r>e.maxzoom&&(r=e.maxzoom);const a=this.locationCoordinate(this.center),l=this.center.lat,c=1<<r,u=[c*a.x,c*a.y,0],h="globe"===this.projection.name,d=!h,p=t.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,d),f=h?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),m=c*t.ay(1,this.center.lat),g=this._camera.position[2]/t.ay(1,this.center.lat),y=[c*f.x,c*f.y,g*(d?1:m)],v=h||n,_=this.cameraToCenterDistance/e.tileSize*(e.roundZoom?1:.502),b=this.isLODDisabled(!0)?r:0;let x;if(this._elevation&&e.isTerrainDEM)x=1e4*this._elevation.exaggeration();else if(this._elevation){const t=this._elevation.getMinMaxForVisibleTiles();x=t?t.max:this._centerAltitude}else x=this._centerAltitude;const w=e.isTerrainDEM?-x:this._elevation?this._elevation.getMinElevationBelowMSL():0,T=this.projection.isReprojectedInTileSpace?t.aN(this):1,E=e=>{const r=1/4e4,i=new t._(e.x+r,e.y,e.z),n=new t._(e.x,e.y+r,e.z),o=e.toLngLat(),s=i.toLngLat(),a=n.toLngLat(),l=this.locationCoordinate(o),c=this.locationCoordinate(s),u=this.locationCoordinate(a),h=Math.hypot(c.x-l.x,c.y-l.y),d=Math.hypot(u.x-l.x,u.y-l.y);return Math.sqrt(h*d)*T/r},S=e=>{const r=x,i=w;return{aabb:t.aR(this,c,0,0,0,e,i,r,this.projection),zoom:0,x:0,y:0,minZ:i,maxZ:r,wrap:e,fullyVisible:!1}},P=[];let k=[];const A=r,M=e.reparseOverscaled?i:r,C=(g-this._centerAltitude)*m,I=t=>{if(!this._elevation||!t.tileID||!s)return;const e=this._elevation.getMinMaxForTile(t.tileID),r=t.aabb;e?(r.min[2]=e.min,r.max[2]=e.max,r.center[2]=(r.min[2]+r.max[2])/2):(t.shouldSplit=L(t),t.shouldSplit||(r.min[2]=r.max[2]=r.center[2]=this._centerAltitude))},O=(t,e)=>{if(.707*e<t)return 1;const r=e/t;return r/(1.4144271570014144+(Math.pow(1.1,r-1.4144271570014144+1)-1)/(1.1-1)-1)},L=e=>{if(e.zoom<b)return!0;if(e.zoom===A)return!1;if(null!=e.shouldSplit)return e.shouldSplit;const r=e.aabb.distanceX(y),n=e.aabb.distanceY(y);let a=C,c=1;if(h){a=e.aabb.distanceZ(y);const r=Math.pow(2,e.zoom),i=t.az((e.y+1)/r),n=t.az(e.y/r),o=Math.min(Math.max(l,i),n),s=t.b6(o)/t.b6(l);if(c=o===l?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,s/this._mercatorScaleRatio),this.zoom<=t.b3&&e.zoom===A-1&&s>=.9)return!0}else if(o&&(a=e.aabb.distanceZ(y)*m),this.projection.isReprojectedInTileSpace&&i<=5){const r=Math.pow(2,e.zoom),i=E(new t._((e.x+.5)/r,(e.y+.5)/r));c=i>.85?1:i}if(!s){const t=Math.sqrt(r*r+n*n+a*a);let i=(1<<A-e.zoom)*_*c;return i*=O(Math.max(a,C),t),t<i}let d=Number.MAX_VALUE,p=0;const f=e.aabb.getCorners(),g=[];for(const e of f){t.$.sub(g,e,y),h||(o?g[2]*=m:g[2]=C);const r=t.$.dot(g,this._camera.forward());r<d&&(d=r,p=Math.abs(g[2]))}let v=(1<<A-e.zoom)*_*c;if(v*=O(Math.max(p,C),d),d<v)return!0;const x=e.aabb.closestPoint(u);return x[0]===u[0]&&x[1]===u[1]};if(this.renderWorldCopies)for(let t=1;t<=3;t++)P.push(S(-t)),P.push(S(t));for(P.push(S(0));P.length>0;){const i=P.pop(),n=i.x,a=i.y;let l=i.fullyVisible;const d=()=>"globe"===this.projection.name&&(0===i.y||i.y===(1<<i.zoom)-1);if(!l){let e=v?i.aabb.intersects(p):i.aabb.intersectsFlat(p);if(0===e&&d()){const r=new t.aO(i.zoom,n,a);e=t.aP(this,c,r,!0).intersects(p)}if(0===e)continue;l=2===e}if(i.zoom!==A&&L(i))for(let e=0;e<4;e++){const r=(n<<1)+e%2,u=(a<<1)+(e>>1),d={aabb:s?i.aabb.quadrant(e):t.aR(this,c,i.zoom+1,r,u,i.wrap,i.minZ,i.maxZ,this.projection),zoom:i.zoom+1,x:r,y:u,wrap:i.wrap,fullyVisible:l,tileID:void 0,shouldSplit:void 0,minZ:i.minZ,maxZ:i.maxZ};o&&!h&&(d.tileID=new t.aQ(i.zoom+1===A?M:i.zoom+1,i.wrap,i.zoom+1,r,u),I(d)),P.push(d)}else{const o=i.zoom===A?M:i.zoom;if(e.minzoom&&e.minzoom>o)continue;let s=0;if(!l){let r=v?i.aabb.intersectsPrecise(p):i.aabb.intersectsPreciseFlat(p);if(0===r&&d()){const e=new t.aO(i.zoom,n,a);r=t.aP(this,c,e,!0).intersectsPrecise(p)}if(0===r)continue;if(e.calculateQuadrantVisibility)if(p.containsPoint(i.aabb.center))s=15;else for(let t=0;t<4;t++)0!==i.aabb.quadrant(t).intersects(p)&&(s|=1<<t)}const h=u[0]-(.5+n+(i.wrap<<i.zoom))*(1<<r-i.zoom),f=u[1]-.5-a,m=i.tileID?i.tileID:new t.aQ(o,i.wrap,i.zoom,n,a);e.calculateQuadrantVisibility&&(m.visibleQuadrants=s),k.push({tileID:m,distanceSq:h*h+f*f})}}if(this.fogCullDistSq){const r=this.fogCullDistSq,i=this.horizonLineFromTop();k=k.filter((n=>{const o=[0,0,0,1],s=[t.a4,t.a4,0,1],a=this.calculateFogTileMatrix(n.tileID.toUnwrapped());t.aB.transformMat4(o,o,a),t.aB.transformMat4(s,s,a);const l=t.aB.min([],o,s),c=t.aB.max([],o,s),u=t.aS(l,c);if(0===u)return!0;let h=!1;const d=this._elevation;if(d&&u>r&&0!==i){const r=this.calculateProjMatrix(n.tileID.toUnwrapped());let o;e.isTerrainDEM||(o=d.getMinMaxForTile(n.tileID)),o||(o={min:w,max:x});const s=t.b4(this.rotation),a=[s[0]*t.a4,s[1]*t.a4,o.max];t.$.transformMat4(a,a,r),h=(1-a[1])*this.height*.5<i}return u<r||h}))}return k.sort(((t,e)=>t.distanceSq-e.distanceSq)).map((t=>t.tileID))}resize(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(e){const r=t.au(e.lat,-t.aT,t.aT),i=this.projection.project(e.lng,r);return new t.P(i.x*this.worldSize,i.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/t.ay(1,this.center.lat)/this.worldSize}setLocationAtPoint(e,r){let i,n;const o=this.centerPoint;if("globe"===this.projection.name){const t=this.worldSize;i=(r.x-o.x)/t,n=(r.y-o.y)/t}else{const t=this.pointCoordinate(r),e=this.pointCoordinate(o);i=t.x-e.x,n=t.y-e.y}const s=this.locationCoordinate(e);this.setLocation(new t._(s.x-i,s.y-n))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(e,r){const i=r?t.ay(r,e.lat):void 0,n=this.projection.project(e.lng,e.lat);return new t._(n.x,n.y,i)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(e,r){const i=null!=r?r:this._centerAltitude,n=[e.x,e.y,0,1],o=[e.x,e.y,1,1];t.aB.transformMat4(n,n,this.pixelMatrixInverse),t.aB.transformMat4(o,o,this.pixelMatrixInverse);const s=o[3];t.aB.scale(n,n,1/n[3]),t.aB.scale(o,o,1/s);const a=n[2],l=o[2];return{p0:n,p1:o,t:a===l?0:(i-a)/(l-a)}}screenPointToMercatorRay(e){const r=[e.x,e.y,0,1],i=[e.x,e.y,1,1];return t.aB.transformMat4(r,r,this.pixelMatrixInverse),t.aB.transformMat4(i,i,this.pixelMatrixInverse),t.aB.scale(r,r,1/r[3]),t.aB.scale(i,i,1/i[3]),r[2]=t.ay(r[2],this._center.lat)*this.worldSize,i[2]=t.ay(i[2],this._center.lat)*this.worldSize,t.aB.scale(r,r,1/this.worldSize),t.aB.scale(i,i,1/this.worldSize),new t.aU([r[0],r[1],r[2]],t.$.normalize([],t.$.sub([],i,r)))}rayIntersectionCoordinate(e){const{p0:r,p1:i,t:n}=e,o=t.ay(r[2],this._center.lat),s=t.ay(i[2],this._center.lat);return new t._(t.a3(r[0],i[0],n)/this.worldSize,t.a3(r[1],i[1],n)/this.worldSize,t.a3(o,s,n))}pointCoordinate(t,e=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,e)}pointCoordinate3D(e){if(!this.elevation)return this.pointCoordinate(e);let r=this.projection.pointCoordinate3D(this,e.x,e.y);if(r)return new t._(r[0],r[1],r[2]);let i=0,n=this.horizonLineFromTop();if(e.y>n)return this.pointCoordinate(e);const o=.02*n,s=e.clone();for(let e=0;e<10&&n-i>o;e++){s.y=t.a3(i,n,.66);const e=this.projection.pointCoordinate3D(this,s.x,s.y);e?(n=s.y,r=e):i=s.y}return r?new t._(r[0],r[1],r[2]):this.pointCoordinate(e)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}isPointOnSurface(e){if(e.y<0||e.y>this.height||e.x<0||e.x>this.width)return!1;if(this.elevation||this.zoom>=t.aV)return!this.isPointAboveHorizon(e);const r=this.pointCoordinate(e);return r.y>=0&&r.y<=1}_coordinatePoint(e,r){const i=r&&this.elevation?this.elevation.getAtPointOrZero(e,this._centerAltitude):this._centerAltitude,n=[e.x*this.worldSize,e.y*this.worldSize,i+e.toAltitude(),1];return t.aB.transformMat4(n,n,this.pixelMatrix),n[3]>0?new t.P(n[0]/n[3],n[1]/n[3]):new t.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:e,left:r}=this._edgeInsets,i=this.height-this._edgeInsets.bottom,n=this.width-this._edgeInsets.right,o=this.pointLocation3D(new t.P(r,e)),s=this.pointLocation3D(new t.P(n,e)),a=this.pointLocation3D(new t.P(n,i)),l=this.pointLocation3D(new t.P(r,i));let c=Math.min(o.lng,s.lng,a.lng,l.lng),u=Math.max(o.lng,s.lng,a.lng,l.lng),h=Math.min(o.lat,s.lat,a.lat,l.lat),d=Math.max(o.lat,s.lat,a.lat,l.lat);const p=Math.pow(2,-this.zoom)/16*270,f="globe"===this.projection.name?1:4,m=(e,r,i,n,o)=>{const s=(e+i)/2,a=(r+n)/2,l=new t.P(s,a),{lng:g,lat:y}=this.pointLocation3D(l),v=Math.max(0,c-g,h-y,g-u,y-d);c=Math.min(c,g),u=Math.max(u,g),h=Math.min(h,y),d=Math.max(d,y),(o<f||v>p)&&(m(e,r,s,a,o+1),m(s,a,i,n,o+1))};if(m(r,e,n,e,1),m(n,e,n,i,1),m(n,i,r,i,1),m(r,i,r,e,1),"globe"===this.projection.name){const[e,r]=t.aW(this);e?(d=90,u=180,c=-180):r&&(h=-90,u=180,c=-180)}return new t.aj(new t.aJ(c,h),new t.aJ(u,d))}_getBoundsRectangular(e,r){const{top:i,left:n}=this._edgeInsets,o=this.height-this._edgeInsets.bottom,s=this.width-this._edgeInsets.right,a=new t.P(n,i),l=new t.P(s,i),c=new t.P(s,o),u=new t.P(n,o);let h=this.pointCoordinate(a,e),d=this.pointCoordinate(l,e);const p=this.pointCoordinate(c,r),f=this.pointCoordinate(u,r),m=(t,e)=>(e.y-t.y)/(e.x-t.x);return h.y>1&&d.y>=0?h=new t._((1-f.y)/m(f,h)+f.x,1):h.y<0&&d.y<=1&&(h=new t._(-f.y/m(f,h)+f.x,0)),d.y>1&&h.y>=0?d=new t._((1-p.y)/m(p,d)+p.x,1):d.y<0&&h.y<=1&&(d=new t._(-p.y/m(p,d)+p.x,0)),(new t.aj).extend(this.coordinateLocation(h)).extend(this.coordinateLocation(d)).extend(this.coordinateLocation(f)).extend(this.coordinateLocation(p))}_getBoundsRectangularTerrain(){const t=this.elevation;if(!t.visibleDemTiles.length||t.isUsingMockSource())return this._getBoundsRectangular(0,0);const e=t.visibleDemTiles.reduce(((t,e)=>{if(e.dem){const r=e.dem.tree;t.min=Math.min(t.min,r.minimums[0]),t.max=Math.max(t.max,r.maximums[0])}return t}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(e.min*t.exaggeration(),e.max*t.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(t=!0){const e=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,r=this.height/2-e*(1-this._horizonShift);return t?Math.max(0,r):r}getMaxBounds(){return this.maxBounds}setMaxBounds(e){this.maxBounds=e,this.minLat=-t.aT,this.maxLat=t.aT,this.minLng=-180,this.maxLng=180,e&&(this.minLat=e.getSouth(),this.maxLat=e.getNorth(),this.minLng=e.getWest(),this.maxLng=e.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=t.ak(this.minLng)*this.tileSize,this.worldMaxX=t.ak(this.maxLng)*this.tileSize,this.worldMinY=t.al(this.maxLat)*this.tileSize,this.worldMaxY=t.al(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,e){return this.projection.createTileMatrix(this,e,t)}calculateDistanceTileData(e){const r=e.key,i=this._distanceTileDataCache;if(i[r])return i[r];const n=e.canonical,o=1/this.height,s=this.cameraWorldSize,a=s/this.zoomScale(n.z),l=(n.x+Math.pow(2,n.z)*e.wrap)*a,c=n.y*a,u=this.point;u.x*=s/this.worldSize,u.y*=s/this.worldSize;const h=this.angle,d=Math.sin(-h),p=-Math.cos(-h);return i[r]={bearing:[d,p],center:[(u.x-l)*o,(u.y-c)*o],scale:a/t.a4*o},i[r]}calculateFogTileMatrix(e){const r=e.key,i=this._fogTileMatrixCache;if(i[r])return i[r];const n=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,e);return t.ae.multiply(n,this.worldToFogMatrix,n),i[r]=new Float32Array(n),i[r]}calculateProjMatrix(e,r=!1,i=!1){const n=e.key;let o;if(o=i?this._expandedProjMatrixCache:r?this._alignedProjMatrixCache:this._projMatrixCache,o[n])return o[n];const s=this.calculatePosMatrix(e,this.worldSize);let a;return a=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:i?this.expandedFarZProjMatrix:r?this.alignedProjMatrix:this.projMatrix,t.ae.multiply(s,a,s),o[n]=new Float32Array(s),o[n]}calculatePixelsToTileUnitsMatrix(e){const r=e.tileID.key,i=this._pixelsToTileUnitsCache;if(i[r])return i[r];const n=t.aX(e,this);return i[r]=n,i[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const e=1/this.worldSize,r=t.ae.fromScaling([],[e,e,e]);return t.ae.multiply(r,r,this.globeMatrix),r}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const e=this._elevation;this._updateCameraState();const r=t.ay(1,this._center.lat)*this.worldSize,i=this._computeCameraPosition(r),n=this._camera.forward(),o=t.ay(1,this._center.lat);i[2]/=o,n[2]/=o,t.$.normalize(n,n);const s=e.raycast(i,n,e.exaggeration());if(s){const e=t.$.scaleAndAdd([],i,n,s),r=new t._(e[0],e[1],t.ay(e[2],t.az(e[1]))),a=(r.z+t.$.length([r.x-i[0],r.y-i[1],r.z-i[2]*o]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(a),this._centerAltitude=r.toAltitude(),this._center=this.coordinateLocation(r),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(e=!1){if(!this._elevation)return;const r=this._elevation,i=t.ay(1,this._center.lat)*this.worldSize,n=this._computeCameraPosition(i),o=r.getAtPointOrZero(new t._(...n)),s=this.pixelsPerMeter/this.worldSize*o,a=this._minimumHeightOverTerrain(),l=n[2]-s;if(l<=a)if(l<0||e){const e=this.locationCoordinate(this._center,this._centerAltitude),r=[n[0],n[1],e.z-n[2]],i=t.$.length(r);r[2]-=(a-l)/this._pixelsPerMercatorPixel;const o=t.$.length(r);if(0===o)return;t.$.scale(r,r,i/o*this._pixelsPerMercatorPixel),this._camera.position=[n[0],n[1],e.z*this._pixelsPerMercatorPixel-r[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const e="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||e){const r=this.center;return r.lat=t.au(r.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!e)&&(r.lng=t.au(r.lng,this.minLng,this.maxLng)),this.center=r,void(this._constraining=!1)}const r=this._unmodified,{x:i,y:n}=this.point;let o=0,s=i,a=n;const l=this.width/2,c=this.height/2,u=this.worldMinY*this.scale,h=this.worldMaxY*this.scale;if(n-c<u&&(a=u+c),n+c>h&&(a=h-c),h-u<this.height&&(o=Math.max(o,this.height/(h-u)),a=(h+u)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const t=this.worldMinX*this.scale,e=this.worldMaxX*this.scale,r=this.worldSize/2-(t+e)/2;s=(i+r+this.worldSize)%this.worldSize-r,s-l<t&&(s=t+l),s+l>e&&(s=e-l),e-t<this.width&&(o=Math.max(o,this.width/(e-t)),s=(e+t)/2)}s===i&&a===n||(this.center=this.unproject(new t.P(s,a))),o&&(this.zoom+=this.scaleZoom(o)),this._constrainCamera(),this._unmodified=r,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,r="globe"===this.projection.name,i=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=t.ay(1,this.center.lat)/t.ay(1,t.b5));const n=t.aY(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,n),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const o="meters"===this.projection.zAxisUnit?i:1,s=this._camera.getWorldToCamera(this.worldSize,o);let a;const l=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(l[8]=2*-e.x/this.width,l[9]=2*e.y/this.height,this.isOrthographic){let t=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),r=t*this.aspect,i=-r,n=-t;r-=e.x,i-=e.x,t+=e.y,n+=e.y,a=this._camera.getCameraToClipOrthographic(i,r,n,t,this._nearZ,this._farZ),((t,e,r,i)=>{for(let n=0;n<16;n++)t[n]=lr(e[n],r[n],i)})(a,a,l,cr(this.pitch>=15?1:this.pitch/15))}else a=l;const c=t.ae.mul([],l,s);let u=t.ae.mul([],a,s);if(this.projection.isReprojectedInTileSpace){const e=this.locationCoordinate(this.center),r=t.ae.identity([]);t.ae.translate(r,r,[e.x*this.worldSize,e.y*this.worldSize,0]),t.ae.multiply(r,r,t.aZ(this)),t.ae.translate(r,r,[-e.x*this.worldSize,-e.y*this.worldSize,0]),t.ae.multiply(u,u,r),t.ae.multiply(c,c,r),this.inverseAdjustmentMatrix=t.a_(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=t.ae.scale([],u,[this.worldSize,this.worldSize,this.worldSize/o,1]),this.projMatrix=u,this.invProjMatrix=t.ae.invert(new Float64Array(16),this.projMatrix),r){const r=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);r[8]=2*-e.x/this.width,r[9]=2*e.y/this.height,this.expandedFarZProjMatrix=t.ae.mul([],r,s)}else this.expandedFarZProjMatrix=this.projMatrix;const h=t.ae.invert([],a);this.frustumCorners=t.a$.fromInvProjectionMatrix(h,this.horizonLineFromTop(),this.height),this.cameraFrustum=t.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!r);const d=new Float32Array(16);t.ae.identity(d),t.ae.scale(d,d,[1,-1,1]),t.ae.rotateX(d,d,this._pitch),t.ae.rotateZ(d,d,this.angle);const p=t.ae.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=t.ae.clone(p);const f=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;p[8]=2*-e.x/this.width,p[9]=2*(e.y+f)/this.height,this.skyboxMatrix=t.ae.multiply(d,p,d);const m=this.point,g=m.x,y=m.y,v=this.width%2/2,_=this.height%2/2,b=Math.cos(this.angle),x=Math.sin(this.angle),w=g-Math.round(g)+b*v+x*_,T=y-Math.round(y)+b*_+x*v,E=new Float64Array(u);if(t.ae.translate(E,E,[w>.5?w-1:w,T>.5?T-1:T,0]),this.alignedProjMatrix=E,u=t.ae.create(),t.ae.scale(u,u,[this.width/2,-this.height/2,1]),t.ae.translate(u,u,[1,-1,0]),this.labelPlaneMatrix=u,u=t.ae.create(),t.ae.scale(u,u,[1,-1,1]),t.ae.translate(u,u,[-1,-1,0]),t.ae.scale(u,u,[2/this.width,2/this.height,1]),this.glCoordMatrix=u,this.pixelMatrix=t.ae.multiply(new Float64Array(16),this.labelPlaneMatrix,c),this._calcFogMatrices(),this._distanceTileDataCache={},u=t.ae.invert(new Float64Array(16),this.pixelMatrix),!u)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=u,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=t.b0(this);const e=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=t.$.transformMat4(e,e,s),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=u;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const e=this.cameraWorldSizeForFog,r=this.cameraPixelsPerMeter,i=this._camera.position,n=1/this.height/this._pixelsPerMercatorPixel,o=[e,e,r];t.$.scale(o,o,n),t.$.scale(i,i,-1),t.$.multiply(i,i,o);const s=t.ae.create();t.ae.translate(s,s,i),t.ae.scale(s,s,o),this.mercatorFogMatrix=s,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(e,r,n)}_computeCameraPosition(t){const e=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,r=this._camera.forward(),i=this.point,n=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*e-t/this.worldSize*this._centerAltitude;return[i.x/this.worldSize-r[0]*n,i.y/this.worldSize-r[1]*n,t/this.worldSize*this._centerAltitude-r[2]*n]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(e){const r=this._maxCameraBoundsDistance()*Math.cos(this._pitch),i=this._camera.position[2],n=e[2];let o=1;this.projection.wrap&&(this.center=this.center.wrap()),n>0&&(o=Math.min((r-i)/n,1)),this._camera.position=t.$.scaleAndAdd([],this._camera.position,e,o),this._updateStateFromCamera()}_updateStateFromCamera(){const e=this._camera.position,r=this._camera.forward(),{pitch:i,bearing:n}=this._camera.getPitchBearing(),o=t.ay(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,s=this._mercatorZfromZoom(this._maxZoom)*Math.cos(t.ac(this._maxPitch)),a=Math.max((e[2]-o)/Math.cos(i),s),l=this._zoomFromMercatorZ(a);t.$.scaleAndAdd(e,e,r,a),this._pitch=t.au(i,t.ac(this.minPitch),t.ac(this.maxPitch)),this.angle=t.av(n,-Math.PI,Math.PI),this._setZoom(t.au(l,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new t._(e[0],e[1],e[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min(null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}zoomFromMercatorZAdjusted(e){let r=0,i=t.aV,n=0,o=1/0;for(;i-r>1e-6&&i>r;){const t=r+.5*(i-r),s=this.tileSize*Math.pow(2,t),a=this.getCameraToCenterDistance(this.projection,t,s),l=this.scaleZoom(a/(e*this.tileSize)),c=Math.abs(t-l);c<o&&(o=c,n=t),t<l?r=t:i=t}return n}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(t.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(e,r){const i=Math.min(e.x,r.x),n=Math.max(e.x,r.x),o=Math.min(e.y,r.y),s=Math.max(e.y,r.y);if(o<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const a=[new t.P(i,o),new t.P(n,s),new t.P(i,s),new t.P(n,o)],l=this.renderWorldCopies?-3:0,c=this.renderWorldCopies?4:1;for(const t of a){const e=this.pointRayIntersection(t);if(e.t<0)return!0;const r=this.rayIntersectionCoordinate(e);if(r.x<l||r.y<0||r.x>c||r.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+t.b1(this.fovAboveCenter)>88||this.anyCornerOffEdge(new t.P(0,0),new t.P(this.width,this.height))}zoomDeltaToMovement(e,r){const i=t.$.length(t.$.sub([],this._camera.position,e)),n=this._zoomFromMercatorZ(i)+r;return i-this._mercatorZfromZoom(n)}getCameraPoint(){if("globe"===this.projection.name){const e=function([e,r,i],n){const o=[e,r,i,1];t.aB.transformMat4(o,o,n);const s=o[3]=Math.max(o[3],1e-6);return o[0]/=s,o[1]/=s,o[2]/=s,o}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new t.P(e[0],e[1])}{const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.P(0,e))}}getCameraToCenterDistance(e,r=this.zoom,i=this.worldSize){const n=t.aY(e,r,this.width,this.height,1024),o=e.pixelSpaceConversion(this.center.lat,i,n);let s=.5/Math.tan(.5*this._fov)*this.height*o;return this.isOrthographic&&(s=lr(1,s,cr(this.pitch>=15?1:this.pitch/15))),s}getWorldToCameraMatrix(){const e=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&t.ae.multiply(e,e,this.globeMatrix),e}getFrustum(e){return t.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,e,"meters"===this.projection.zAxisUnit)}}const hr={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11},dr=(e,r)=>{if(r>0&&e.terrain&&t.w("Cutoff is currently disabled on terrain"),r<=0||e.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const i=e.transform,n=Math.max(Math.abs(i._zoom-(e.minCutoffZoom-1)),1),o=i.isLODDisabled(!1)?t.a0(60,45,i.pitch):t.a0(30,15,i.pitch),s=i._farZ-i._nearZ,a=r*i.height,l=((1-(c=o))*i.cameraToCenterDistance+c*(i._farZ+a))*n;var c;return{shouldRenderCutoff:o<1,uniformValues:{u_cutoff_params:[i._nearZ,i._farZ,(l-i._nearZ)/s,(l-a-i._nearZ)/s]}}},pr={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class fr{constructor(t,e){this.aabb=t,this.lastCascade=e}}class mr{add(t,e){const r=this.receivers[t.key];void 0!==r?(r.aabb.min[0]=Math.min(r.aabb.min[0],e.min[0]),r.aabb.min[1]=Math.min(r.aabb.min[1],e.min[1]),r.aabb.min[2]=Math.min(r.aabb.min[2],e.min[2]),r.aabb.max[0]=Math.max(r.aabb.max[0],e.max[0]),r.aabb.max[1]=Math.max(r.aabb.max[1],e.max[1]),r.aabb.max[2]=Math.max(r.aabb.max[2],e.max[2])):this.receivers[t.key]=new fr(e,null)}clear(){this.receivers={}}get(t){return this.receivers[t.key]}computeRequiredCascades(e,r,i){const n=t.b8.fromPoints(e.points);let o=0;for(const e in this.receivers){const s=this.receivers[e];if(!s)continue;if(!n.intersectsAabb(s.aabb))continue;s.aabb.min=n.closestPoint(s.aabb.min),s.aabb.max=n.closestPoint(s.aabb.max);const a=s.aabb.getCorners();for(let e=0;e<i.length;e++){let n=!0;for(const o of a){const s=[o[0]*r,o[1]*r,o[2]];if(t.$.transformMat4(s,s,i[e].matrix),s[0]<-1||s[0]>1||s[1]<-1||s[1]>1){n=!1;break}}if(s.lastCascade=e,o=Math.max(o,e),n)break}}return o+1}}class gr{constructor(e){this.painter=e,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new mr,this._depthMode=new t.af(e.context.gl.LEQUAL,t.af.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,e.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},(()=>{this.painter.style.map.triggerRepaint()})),e.tp.registerParameter(pr,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),e.tp.registerParameter(pr,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),e.tp.registerParameter(pr,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),e.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const t of this._cascades)t.texture.destroy(),t.framebuffer.destroy();this._cascades=[]}updateShadowParameters(e,r){const i=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!r||!r.properties)return;const n=r.properties.get("shadow-intensity");if(!r.shadowsEnabled()||n<=0)return;if(this._shadowLayerCount=i.style.order.reduce(((t,r)=>{const n=i.style._mergedLayers[r];return t+(n.hasShadowPass()&&!n.isHidden(e.zoom)?1:0)}),0),this._enabled=this._shadowLayerCount>0,!this.enabled)return;const o=i.context,s=pr.shadowMapResolution,a=pr.shadowMapResolution;if(0===this._cascades.length||pr.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let e=0;e<pr.cascadeCount;++e){const e=i._shadowMapDebug,r=o.gl,n=o.createFramebuffer(s,a,e,"texture"),l=new t.T(o,{width:s,height:a,data:null},r.DEPTH_COMPONENT);if(n.depthAttachment.set(l.texture),e){const e=new t.T(o,{width:s,height:a,data:null},r.RGBA);n.colorAttachment.set(e.texture)}this._cascades.push({framebuffer:n,texture:l,matrix:[],far:0,boundingSphereRadius:0,frustum:new t.aM,scale:0})}}this.shadowDirection=vr(r);let l=0;if(e.elevation){const t=e.elevation,r=[1e4,-1e4];t.visibleDemTiles.filter((t=>t.dem)).forEach((t=>{const e=t.dem.tree;r[0]=Math.min(r[0],e.minimums[0]),r[1]=Math.max(r[1],e.maximums[0])})),1e4!==r[0]&&(l=(r[1]-r[0])*t.exaggeration())}const c=1.5*e.cameraToCenterDistance,u=3*c,h=new Float64Array(16);for(let r=0;r<this._cascades.length;++r){const i=this._cascades[r];let n=e.height/50,o=1;1===pr.cascadeCount?o=u:0===r?o=c:(n=c,o=u);const[s,a]=br(e,this.shadowDirection,n,o,pr.shadowMapResolution,l);i.scale=e.scale,i.matrix=s,i.boundingSphereRadius=a,t.ae.invert(h,i.matrix),i.frustum=t.aM.fromInvProjectionMatrix(h,1,0,!0),i.far=o}const d=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[d].far,this._cascades[d].far],this._uniformValues.u_shadow_intensity=n,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/pr.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=pr.shadowMapResolution,this._uniformValues.u_shadowmap_0=hr.ShadowMap0,this._uniformValues.u_shadowmap_1=hr.ShadowMap0+1,this._groundShadowTiles=i.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const p=i.transform.elevation;for(const t of this._groundShadowTiles){let e={min:0,max:0};if(p){const r=p.getMinMaxForTile(t);r&&(e=r)}this.addShadowReceiver(t.toUnwrapped(),e.min,e.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(t){this._enabled=t}drawShadowPass(e,r){if(!this.enabled)return;const i=this.painter,n=i.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(i.transform.getFrustum(0),i.transform.worldSize,this._cascades),n.viewport.set([0,0,pr.shadowMapResolution,pr.shadowMapResolution]);for(let o=0;o<this._numCascadesToRender;++o){i.currentShadowCascade=o,n.bindFramebuffer.set(this._cascades[o].framebuffer.framebuffer),n.clear({color:t.C.white,depth:1});for(const t of e.order){const n=e._mergedLayers[t];if(!n.hasShadowPass()||n.isHidden(i.transform.zoom))continue;const o=e.getLayerSourceCache(n),s=o?r[o.id]:void 0;("model"===n.type||s&&s.length)&&i.renderLayer(i,o,n,s)}}i.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const e=this.painter,r=e.style,i=e.context,n=r.directionalLight,o=r.ambientLight;if(!n||!o)return;const s=[],a=dr(e,e.longestCutoffRange);a.shouldRenderCutoff&&s.push("RENDER_CUTOFF");const l=_r(r,n,o),c=new t.af(i.gl.LEQUAL,t.af.ReadOnly,e.depthRangeFor3D);for(const r of this._groundShadowTiles){const n=r.toUnwrapped(),o=e.isTileAffectedByFog(r),u=e.getOrCreateProgram("groundShadow",{defines:s,overrideFog:o});this.setupShadows(n,u),e.uploadCommonUniforms(i,u,n,null,a);const h={u_matrix:e.transform.calculateProjMatrix(n),u_ground_shadow_factor:l};u.draw(e,i.gl.TRIANGLES,c,t.ah.disabled,t.a.multiply,t.ag.disabled,h,"ground_shadow",e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments,{},e.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?t.a.unblended:t.a.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(e){const r=this.painter.transform,i=r.calculatePosMatrix(e,r.worldSize);return t.ae.multiply(i,this._cascades[this.painter.currentShadowCascade].matrix,i),Float32Array.from(i)}calculateShadowPassMatrixFromMatrix(e){return t.ae.multiply(e,this._cascades[this.painter.currentShadowCascade].matrix,e),Float32Array.from(e)}setupShadows(e,r,i,n=0){if(!this.enabled)return;const o=this.painter.transform,s=this.painter.context,a=s.gl,l=this._uniformValues,c=new Float64Array(16),u=o.calculatePosMatrix(e,o.worldSize);for(let e=0;e<this._cascades.length;e++)t.ae.multiply(c,this._cascades[e].matrix,u),l[0===e?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(c),s.activeTexture.set(a.TEXTURE0+hr.ShadowMap0+e),this._cascades[e].texture.bind(a.NEAREST,a.CLAMP_TO_EDGE);if(this.useNormalOffset=!!i,this.useNormalOffset){const r=t.b7(e.canonical),s=2/o.tileSize*t.a4/pr.shadowMapResolution,a=s*this._cascades[0].boundingSphereRadius,c=s*this._cascades[this._cascades.length-1].boundingSphereRadius,u=("vector-tile"===i?1:3)/Math.pow(2,n-e.canonical.z-(1-o.zoom+Math.floor(o.zoom)));l.u_shadow_normal_offset=[r,a*u,c*u],l.u_shadow_bias=[6e-5,.0012,.012]}else l.u_shadow_bias=[36e-5,.0012,.012];r.setShadowUniformValues(s,l)}setupShadowsFromMatrix(e,r,i=!1){if(!this.enabled)return;const n=this.painter.context,o=n.gl,s=this._uniformValues,a=new Float64Array(16);for(let r=0;r<pr.cascadeCount;r++)t.ae.multiply(a,this._cascades[r].matrix,e),s[0===r?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(a),n.activeTexture.set(o.TEXTURE0+hr.ShadowMap0+r),this._cascades[r].texture.bind(o.NEAREST,o.CLAMP_TO_EDGE);if(this.useNormalOffset=i,i){const t=pr.normalOffset;s.u_shadow_normal_offset=[1,t,t],s.u_shadow_bias=[6e-5,.0012,.012]}else s.u_shadow_bias=[36e-5,.0012,.012];r.setShadowUniformValues(n,s)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(e,r,i,n){if(n[2]>=0)return{};const o=function(e,r,i){const n=i/(1<<e.canonical.z);return new t.b8([e.canonical.x*n+e.wrap*i,e.canonical.y*n+e.wrap*i,0],[(e.canonical.x+1)*n+e.wrap*i,(e.canonical.y+1)*n+e.wrap*i,r])}(e,r,i).getCorners(),s=r/-n[2];n[0]<0?(t.$.add(o[0],o[0],[n[0]*s,0,0]),t.$.add(o[3],o[3],[n[0]*s,0,0])):n[0]>0&&(t.$.add(o[1],o[1],[n[0]*s,0,0]),t.$.add(o[2],o[2],[n[0]*s,0,0])),n[1]<0?(t.$.add(o[0],o[0],[0,n[1]*s,0]),t.$.add(o[1],o[1],[0,n[1]*s,0])):n[1]>0&&(t.$.add(o[2],o[2],[0,n[1]*s,0]),t.$.add(o[3],o[3],[0,n[1]*s,0]));const a={};return a.vertices=o,a.planes=[yr(o[1],o[0],o[4]),yr(o[2],o[1],o[5]),yr(o[3],o[2],o[6]),yr(o[0],o[3],o[7])],a}addShadowReceiver(e,r,i){this._receivers.add(e,t.b8.fromTileIdAndHeight(e,r,i))}getMaxCascadeForTile(t){const e=this._receivers.get(t);return e&&e.lastCascade?e.lastCascade:0}}function yr(e,r,i){const n=t.$.sub([],i,r),o=t.$.sub([],e,r),s=t.$.cross([],n,o),a=t.$.length(s);return 0===a?[0,0,1,0]:(t.$.scale(s,s,1/a),[s[0],s[1],s[2],-t.$.dot(s,r)])}function vr(e){const r=e.properties.get("direction"),i=t.ad(r.x,r.y,r.z);i[2]=t.au(i[2],0,75);const n=t.b9([i[0],i[1],i[2]]);return t.$.fromValues(n.x,n.y,n.z)}function _r(e,r,i){const n=r.properties.get("color"),o=r.properties.get("intensity"),s=r.properties.get("direction"),a=[s.x,s.y,s.z],l=i.properties.get("color"),c=i.properties.get("intensity"),u=Math.max(t.$.dot([0,0,1],a),0),h=[0,0,0];t.$.scale(h,l.toRenderColor(e.getLut(r.scope)).toArray01Linear().slice(0,3),c);const d=[0,0,0];return t.$.scale(d,n.toRenderColor(e.getLut(i.scope)).toArray01Linear().slice(0,3),u*o),t.ba([h[0]>0?h[0]/(h[0]+d[0]):0,h[1]>0?h[1]/(h[1]+d[1]):0,h[2]>0?h[2]/(h[2]+d[2]):0])}function br(e,r,i,n,o,s){const a=e.zoom,l=e.scale,c=e.worldSize,u=1/c,h=e.aspect,d=Math.sqrt(1+h*h)*Math.tan(.5*e.fovX),p=d*d,f=n-i,m=n+i;let g,y;p>f/m?(g=n,y=n*d):(g=.5*m*(1+p),y=.5*Math.sqrt(f*f+2*(n*n+i*i)*p+m*m*p*p));const v=e.projection.pixelsPerMeter(e.center.lat,c),_=e._camera.getCameraToWorldMercator(),b=[0,0,-g*u];t.$.transformMat4(b,b,_);let x=y*u;const w=e._edgeInsets;if(!(0===w.left&&0===w.top&&0===w.right&&0===w.bottom||w.left===w.right&&w.top===w.bottom)){const r=e._camera.getWorldToCamera(e.worldSize,"meters"===e.projection.zAxisUnit?v:1),o=e._camera.getCameraToClipPerspective(e._fov,e.width/e.height,i,n);o[8]=2*-e.centerOffset.x/e.width,o[9]=2*e.centerOffset.y/e.height;const s=new Float64Array(16);t.ae.mul(s,o,r);const u=new Float64Array(16);t.ae.invert(u,s);const h=t.aM.fromInvProjectionMatrix(u,c,a,!0);for(const r of h.points){const i=((T=r)[0]/=l,T[1]/=l,T[2]=t.ay(T[2],e._center.lat),T);x=Math.max(x,t.$.len(t.$.subtract([],b,i)))}}var T;x*=o/(o-1);const E=Math.acos(r[2]),S=Math.atan2(-r[0],-r[1]),P=new Ge;P.position=b,P.setPitchBearing(E,S);const k=P.getWorldToCamera(c,v),A=x*c,M=Math.min(e._mercatorZfromZoom(17)*c*-2,-2*A),C=P.getCameraToClipOrthographic(-A,A,-A,A,M,(A+s*v)/r[2]),I=new Float64Array(16);t.ae.multiply(I,C,k);const O=t.$.fromValues(Math.floor(1e6*b[0])/1e6*c,Math.floor(1e6*b[1])/1e6*c,0),L=.5*o,D=[0,0,0];t.$.transformMat4(D,O,I),t.$.scale(D,D,L);const R=[Math.floor(D[0]),Math.floor(D[1]),Math.floor(D[2])],F=[0,0,0];t.$.sub(F,D,R),t.$.scale(F,F,-1/L);const B=new Float64Array(16);return t.ae.identity(B),t.ae.translate(B,B,F),t.ae.multiply(I,B,I),[I,A]}function xr(t,e){return null!=t&&null!=e&&!(!t.hasData()||!e.hasData())&&null!=t.demTexture&&null!=e.demTexture&&t.tileID.key!==e.tileID.key}const wr=new class{constructor(){this.operations={}}newMorphing(t,e,r,i,n){if(t in this.operations){const e=this.operations[t];e.to.tileID.key!==r.tileID.key&&(e.queued=r)}else this.operations[t]={startTime:i,phase:0,duration:n,from:e,to:r,queued:null}}getMorphValuesForProxy(t){if(!(t in this.operations))return null;const e=this.operations[t];return{from:e.from,to:e.to,phase:e.phase}}update(t){for(const e in this.operations){const r=this.operations[e];for(r.phase=(t-r.startTime)/r.duration;r.phase>=1||!this._validOp(r);)if(!this._nextOp(r,t)){delete this.operations[e];break}}}_nextOp(t,e){return!!t.queued&&(t.from=t.to,t.to=t.queued,t.queued=null,t.phase=0,t.startTime=e,!0)}_validOp(t){return t.from.hasData()&&t.to.hasData()}},Tr={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Er(t,e,r){if(0===e)return 0;const i=e<1&&514===r?.25/e:1;return 6*Math.pow(1.5,22-t)*Math.max(e,1)*i}function Sr(t,e){const r=1<<t.z;return!e&&(0===t.x||t.x===r-1)||0===t.y||t.y===r-1}const Pr=t=>({u_matrix:t});function kr(e,r,i,n,o){if(o>0){const s=t.e.now(),a=(s-e.timeAdded)/o,l=r?(s-r.timeAdded)/o:-1,c=i.getSource(),u=n.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),h=!r||Math.abs(r.tileID.overscaledZ-u)>Math.abs(e.tileID.overscaledZ-u),d=h&&e.refreshedUponExpiration?1:t.au(h?a:1-l,0,1);return e.refreshedUponExpiration&&a>=1&&(e.refreshedUponExpiration=!1),r?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}class Ar extends Re{constructor(e,r,i,n){super(e,r,i,n),this.type="raster-array",this.maxzoom=22,this._options=t.Q({type:"raster-array"},r)}triggerRepaint(t){const e=this.map.painter._terrain,r=this.map.style.getSourceCache(this.id);e&&e.enabled&&r&&e._clearRenderCacheForTile(r.id,t.tileID),this.map.triggerRepaint()}loadTile(e,r){const i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),n=this.map._requestManager.transformRequest(i,t.R.Tile);e.requestParams=n,e.actor||(e.actor=this.dispatcher.getActor()),e.request=e.fetchHeader(void 0,((t,i,n,o)=>{if(delete e.request,e.aborted)return e.state="unloaded",r(null);if(t){if(20===t.code)return;return e.state="errored",r(t)}this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:n,expires:o}),e.state="empty",r(null)}))}unloadTile(e,r){const i=e.texture;i&&i instanceof t.T?(e.destroy(!0),this.map.painter.saveTileTexture(i)):(e.destroy(),e.flushQueues(),e._isHeaderLoaded=!1,delete e._mrt,delete e.textureDescriptor),e.fbo&&(e.fbo.destroy(),delete e.fbo),delete e.request,delete e.requestParams,delete e.neighboringTiles,e.state="unloaded"}prepareTile(e,r,i){e._isHeaderLoaded&&("empty"!==e.state&&(e.state="reloading"),e.fetchBand(r,i,((r,i)=>{if(r)return e.state="errored",this.fire(new t.f(r)),void this.triggerRepaint(e);i&&(e.setTexture(i,this.map.painter),e.state="loaded",this.triggerRepaint(e))})))}getInitialBand(t){if(!this.rasterLayers)return 0;const e=this.rasterLayers.find((({id:e})=>e===t)),r=e&&e.fields,i=r&&r.bands&&r.bands;return i?i[0]:0}getTextureDescriptor(e,r,i){if(!e)return;const n=r.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!n)return;let o=null;r instanceof t.bm?o=r.paint.get("raster-array-band"):r instanceof t.bn&&(o=r.paint.get("raster-particle-array-band"));const s=o||this.getInitialBand(n);if(null!=s)if(e.textureDescriptor){if(!e.updateNeeded(n,s)||i)return Object.assign({},e.textureDescriptor,{texture:e.texture})}else this.prepareTile(e,n,s)}}const Mr={vector:Fe,raster:Re,"raster-dem":class extends Re{constructor(e,r,i,n){super(e,r,i,n),this.type="raster-dem",this.maxzoom=22,this._options=t.Q({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(e,r){const i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function n(t,i){t&&(e.state="errored",r(t)),i&&(e.dem=i,e.dem.onDeserialize(),e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0,e.state="loaded",r(null))}e.request=t.i(this.map._requestManager.transformRequest(i,t.R.Tile),function(i,o,s,a){if(delete e.request,e.aborted)e.state="unloaded",r(null);else if(i)e.state="errored",r(i);else if(o){this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:s,expires:a});const r=ImageBitmap&&o instanceof ImageBitmap&&t.bk(),i=1-(o.width-t.bl(o.width))/2;i<1||e.neighboringTiles||(e.neighboringTiles=this._getNeighboringTiles(e.tileID));const l=r?o:t.e.getImageData(o,i),c={uid:e.uid,coord:e.tileID,source:this.id,scope:this.scope,rawImageData:l,encoding:this.encoding,padding:i};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",c,n.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(e){const r=e.canonical,i=Math.pow(2,r.z),n=(r.x-1+i)%i,o=0===r.x?e.wrap-1:e.wrap,s=(r.x+1+i)%i,a=r.x+1===i?e.wrap+1:e.wrap,l={};return l[new t.aQ(e.overscaledZ,o,r.z,n,r.y).key]={backfilled:!1},l[new t.aQ(e.overscaledZ,a,r.z,s,r.y).key]={backfilled:!1},r.y>0&&(l[new t.aQ(e.overscaledZ,o,r.z,n,r.y-1).key]={backfilled:!1},l[new t.aQ(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},l[new t.aQ(e.overscaledZ,a,r.z,s,r.y-1).key]={backfilled:!1}),r.y+1<i&&(l[new t.aQ(e.overscaledZ,o,r.z,n,r.y+1).key]={backfilled:!1},l[new t.aQ(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},l[new t.aQ(e.overscaledZ,a,r.z,s,r.y+1).key]={backfilled:!1}),l}},"raster-array":Ar,geojson:class extends t.E{constructor(e,r,i,n){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=i.getActor(),this.setEventedParent(n),this._data=r.data,this._options=t.Q({},r),this._collectResourceTiming=r.collectResourceTiming,void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),void 0!==r.minzoom&&(this.minzoom=r.minzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const o=t.a4/this.tileSize;this.workerOptions=t.Q({source:this.id,scope:this.scope,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(void 0!==r.buffer?r.buffer:128)*o,tolerance:(void 0!==r.tolerance?r.tolerance:.375)*o,extent:t.a4,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:t.a4,radius:(void 0!==r.clusterRadius?r.clusterRadius:50)*o,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter,dynamic:r.dynamic},r.workerOptions)}onAdd(t){this.map=t,this.setData(this._data)}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(e){if(!this._options.dynamic)return this.fire(new t.f(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if("string"!=typeof e&&("Feature"===e.type&&(e={type:"FeatureCollection",features:[e]}),"FeatureCollection"!==e.type))return this.fire(new t.f(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&"string"!=typeof e&&"string"!=typeof this._data&&"FeatureCollection"===this._data.type){const t=new Map;for(const e of this._data.features)t.set(e.id,e);for(const r of e.features)t.set(r.id,r);this._data.features=[...t.values()]}else this._data=e;return this._updateWorkerData(!0),this}getClusterExpansionZoom(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id,scope:this.scope},e),this}getClusterChildren(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id,scope:this.scope},e),this}getClusterLeaves(t,e,r,i){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:t,limit:e,offset:r},i),this}_updateWorkerData(e=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new t.g("dataloading",{dataType:"source"})),this._loaded=!1;const r=t.Q({append:e},this.workerOptions);r.scope=this.scope;const i=this._data;"string"==typeof i?(r.request=this.map._requestManager.transformRequest(t.e.resolveURL(i),t.R.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(i),this._pendingLoad=this.actor.send(`${this.type}.loadData`,r,((r,i)=>{if(this._loaded=!0,this._pendingLoad=null,r)this.fire(new t.f(r));else{const r={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&i&&i.resourceTiming&&i.resourceTiming[this.id]&&(r.resourceTiming=i.resourceTiming[this.id]),e&&(this._partialReload=!0),this.fire(new t.g("data",r)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(e),this._coalesce=!1)}))}loaded(){return this._loaded}loadTile(e,r){const i=e.actor?"reloadTile":"loadTile";e.actor=this.actor;const n=this.map.style?this.map.style.getLut(this.scope):null,o=this._partialReload,s={type:this.type,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:n?{image:n.image.clone()}:null,scope:this.scope,pixelRatio:t.e.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,partial:o};e.request=this.actor.send(i,s,((t,n)=>o&&!n?(e.state="loaded",r(null)):(delete e.request,e.destroy(),e.aborted?r(null):t?r(t):(e.loadVectorData(n,this.map.painter,"reloadTile"===i),r(null)))),void 0,"loadTile"===i)}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t,e){this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope}),t.destroy()}onRemove(t){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return t.Q({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends t.bo{constructor(t,e,r,i){super(t,e,r,i),this.roundZoom=!0,this.type="video",this.options=e}load(){this._loaded=!1;const e=this.options;this.urls=[];for(const r of e.urls)this.urls.push(this.map._requestManager.transformRequest(r,t.R.Source).url);t.bp(this.urls,((e,r)=>{this._loaded=!0,e?this.fire(new t.f(e)):r&&(this.video=r,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new t.f(new t.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,r=e.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new t.T(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(e)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:t.bo,model:class extends t.E{constructor(t,e,r,i){super(),this.id=t,this.type="model",this.models=[],this._loaded=!1,this._options=e}load(){const e=[];for(const r in this._options.models){const i=this._options.models[r],n=t.l(this.map._requestManager.transformRequest(i.uri,t.R.Model).url).then((e=>{if(!e)return;const n=t.c(e),o=new t.M(r,i.position,i.orientation,n);o.computeBoundsAndApplyParent(),this.models.push(o)})).catch((e=>{this.fire(new t.f(new Error(`Could not load model ${r} from ${i.uri}: ${e.message}`)))}));e.push(n)}return Promise.allSettled(e).then((()=>{this._loaded=!0,this.fire(new t.g("data",{dataType:"source",sourceDataType:"metadata"}))})).catch((e=>{this.fire(new t.f(new Error(`Could not load models: ${e.message}`)))}))}onAdd(t){this.map=t,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(t,e){}serialize(){return{type:"model"}}},"batched-model":class extends t.E{constructor(t,e,r,i){super(),this.type="batched-model",this.id=t,this.tileSize=512,this._options=e,this.tiles=this._options.tiles,this.maxzoom=e.maxzoom||19,this.minzoom=e.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=r,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(i)}onAdd(t){this.map=t,this.load()}load(e){this._loaded=!1,this.fire(new t.g("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,i=this.map._worldview;this._tileJSONRequest=Le(this._options,this.map._requestManager,r,i,((n,o)=>{this._tileJSONRequest=null,this._loaded=!0,n?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),i&&2!==i.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${i}`),this.fire(new t.f(n))):o&&(t.Q(this,o),o.bounds&&(this.tileBounds=new De(o.bounds,this.minzoom,this.maxzoom)),t.ao(o.tiles,this.map._requestManager._customAccessToken),this.fire(new t.g("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.g("data",{dataType:"source",sourceDataType:"content"}))),e&&e(n)}))}hasTransition(){return!1}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loaded(){return this._loaded}loadTile(e,r){const i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),n={request:this.map._requestManager.transformRequest(i,t.R.Tile),data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:e.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(e.actor&&"expired"!==e.state)if("loading"===e.state)e.reloadCallback=r;else{if(e.buckets){const t=Object.values(e.buckets);for(const e of t)e.dirty=!0;return void(e.state="loaded")}e.request=e.actor.send("reloadTile",n,o.bind(this))}else e.actor=this.dispatcher.getActor(),e.request=e.actor.send("loadTile",n,o.bind(this),void 0,!0);function o(t,i){return e.aborted?r(null):t&&404!==t.status?r(t):(i&&(i.resourceTiming&&(e.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&e.setExpiryData(i),e.buckets={...e.buckets,...i.buckets},i.featureIndex&&(e.latestFeatureIndex=i.featureIndex)),e.state="loaded",void r(null))}}serialize(){return t.Q({},this._options)}},canvas:class extends t.bo{constructor(e,r,i,n){super(e,r,i,n),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some((t=>!Array.isArray(t)||2!==t.length||t.some((t=>"number"!=typeof t))))||this.fire(new t.f(new t.V(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.f(new t.V(`sources.${e}`,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new t.f(new t.V(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof HTMLCanvasElement||this.fire(new t.f(new t.V(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.f(new t.V(`sources.${e}`,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.f(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(t){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const r=this.map.painter.context;this.texture?!e&&!this._playing||this.texture instanceof t.bq||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.T(r,this.canvas,r.gl.RGBA,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}},custom:class extends t.E{constructor(e,r,i,n){super(),this.id=e,this.type="custom",this._dataType="raster",this._dispatcher=i,this._implementation=r,this.setEventedParent(n),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new t.f(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new t.f(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new De(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),t.Q(this,t.ai(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return t.ai(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new t.g("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.g("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(e){this.map=e,this._loaded=!1,this.fire(new t.g("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(e),this.load()}onRemove(t){this._implementation.onRemove&&this._implementation.onRemove(t)}hasTile(t){if(this._implementation.hasTile){const{x:e,y:r,z:i}=t.canonical;return this._implementation.hasTile({x:e,y:r,z:i})}return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,e){const{x:r,y:i,z:n}=t.tileID.canonical,o=new AbortController;t.request=Promise.resolve(this._implementation.loadTile({x:r,y:i,z:n},{signal:o.signal})).then(function(r){return delete t.request,t.aborted?(t.state="unloaded",e(null)):void 0===r?(t.state="errored",e(null)):null===r?(this.loadTileData(t,{width:this.tileSize,height:this.tileSize,data:null}),t.state="loaded",e(null)):function(t){return t instanceof ImageData||t instanceof HTMLCanvasElement||t instanceof ImageBitmap||t instanceof HTMLImageElement}(r)?(this.loadTileData(t,r),t.state="loaded",void e(null)):(t.state="errored",e(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch((r=>{20!==r.code&&(t.state="errored",e(r))})),t.request.cancel=()=>o.abort()}loadTileData(t,e){t.setTexture(e,this.map.painter)}unloadTile(e,r){if(e.texture&&e.texture instanceof t.T?(e.destroy(!0),e.texture&&e.texture instanceof t.T&&this.map.painter.saveTileTexture(e.texture)):e.destroy(),this._implementation.unloadTile){const{x:t,y:r,z:i}=e.tileID.canonical;this._implementation.unloadTile({x:t,y:r,z:i})}r&&r()}abortTile(t,e){t.request&&t.request.cancel&&(t.request.cancel(),delete t.request),e&&e()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((t=>({x:t.canonical.x,y:t.canonical.y,z:t.canonical.z})))}_clearTiles(){const e=t.am(this.id,this.scope);this.map.style.clearSource(e)}_update(){this.fire(new t.g("data",{dataType:"source",sourceDataType:"content"}))}}},Cr=function(e,r,i,n){const o=new Mr[r.type](e,r,i,n);if(o.id!==e)throw new Error(`Expected Source id to be ${e} instead of ${o.id}`);return t.br(["load","abort","unload","serialize","prepare"],o),o};class Ir extends t.bx{constructor(e){const r={type:"raster-dem",maxzoom:e.transform.maxZoom},i=new t.by(t.bz(),null),n=Cr("mock-dem",r,i,e.style);super("mock-dem",n,!1),n.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,e){t.state="loaded",e(null)}}class Or extends t.bx{constructor(e){const r=Cr("proxy",{type:"geojson",maxzoom:e.transform.maxZoom},new t.by(t.bz(),null),e.style);super("proxy",r,!1),r.setEventedParent(this),this.map=this.getSource().map=e,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(e,r,i){if(e.freezeTileCoverage)return;this.transform=e;const n=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((r,i)=>{if(r[i.key]="",!this._tiles[i.key]){const r=new t.bA(i,this._source.tileSize*i.overscaleFactor(),e.tileZoom);r.state="loaded",this._tiles[i.key]=r}return r}),{});for(const t in this._tiles)t in n||(this.freeFBO(t),this._tiles[t].unloadVectorData(),delete this._tiles[t])}freeFBO(t){const e=this.proxyCachedFBO[t];if(void 0!==e){const r=Object.values(e);this.renderCachePool.push(...r),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach((t=>t.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Lr extends t.aQ{constructor(t,e,r){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=e,this.projMatrix=r}}class Dr extends t.bs{constructor(e,r){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},e.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},(()=>{this._style.map.triggerRepaint()})),e.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},(()=>{this._style.map.triggerRepaint()})),e.tp.registerButton(["Terrain"],"Invalidate Render Cache",(()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()})),this.painter=e,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[i,n,o]=function(e){const r=new t.bv,i=new t.bw,n=131;r.reserve(17161),i.reserve(33800);const o=t.a4/128,s=t.a4+o/2,a=s+o;for(let e=-o;e<a;e+=o)for(let i=-o;i<a;i+=o){const n=i<0||i>s||e<0||e>s?24575:0,o=t.au(Math.round(i),0,t.a4),a=t.au(Math.round(e),0,t.a4);r.emplaceBack(o+n,a)}const l=(t,e)=>{const r=e*n+t;i.emplaceBack(r+1,r,r+n),i.emplaceBack(r+n,r+n+1,r+1)};for(let t=1;t<129;t++)for(let e=1;e<129;e++)l(e,t);return[0,129].forEach((t=>{for(let e=0;e<130;e++)l(e,t),l(t,e)})),[r,i,32768]}(),s=e.context;this.gridBuffer=s.createVertexBuffer(i,t.bt.members),this.gridIndexBuffer=s.createIndexBuffer(n),this.gridSegments=t.b.simpleSegment(0,0,i.length,n.length),this.gridNoSkirtSegments=t.b.simpleSegment(0,0,i.length,o),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Or(r.map),this.orthoMatrix=t.ae.create(),t.ae.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,t.a4,0,t.a4,0,1);const a=s.gl;this._overlapStencilMode=new t.ah({func:a.GEQUAL,mask:255},0,255,a.KEEP,a.KEEP,a.REPLACE),this._previousZoom=e.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=r,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Ir(r.map),this._pendingGroundEffectLayers=[]}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),this._style=t,this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(e,r,i){if(e&&e.terrain){this._style!==e&&(this.style=e,this._evaluationZoom=void 0);const n=e.terrain.properties,o=0===e.terrain.drapeRenderMode,s=e.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=t.e.now();const a=e.terrain&&e.terrain.scope,l=n.get("source"),c=o?this._mockSourceCache:e.getSourceCache(l,a);if(!c)return void t.w(`Couldn't find terrain source "${l}".`);if(this.sourceCache=c,this._exaggeration=s?this.calculateExaggeration(r):n.get("exaggeration"),!r.projection.requiresDraping&&s&&0===this._exaggeration)return void this._disable();this.enabled=!0;const u=()=>{this.sourceCache.used&&t.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const e=this.getScaledDemTileSize();this.sourceCache.update(r,e,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,u(),this._initializing=!0),u(),r.updateElevation(!0,i),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(r),this._emptyDEMTextureDirty=!0,this._previousZoom=r.zoom}else this._disable()}calculateExaggeration(e){const r=this._previousCameraAltitude,i=e.getFreeCameraOptions().position.z/e.pixelsPerMeter*e.worldSize;this._previousCameraAltitude=i;const n=null!=r?i-r:Number.MAX_VALUE;if(Math.abs(n)<2)return this._exaggeration;const o=e.zoom,s=this._style.terrain;if(!this._previousUpdateTimestamp)return s.getExaggeration(o);let a=o-this._previousZoom;const l=this._previousUpdateTimestamp;let c=o;null!=this._evaluationZoom&&(c=this._evaluationZoom,Math.abs(o-c)>.5&&(a=.5*(o-c+a)),a*n<0&&(c+=a)),this._evaluationZoom=c;const u=s.getExaggeration(c),h=u===s.getExaggeration(Math.max(0,c-.1));if(h&&Math.abs(u-this._exaggeration)<.01)return u;let d=Math.min(.1,.00375*(this._updateTimestamp-l));return(h||u<.1||Math.abs(a)<1e-4)&&(d=Math.min(.2,4*d)),t.a3(this._exaggeration,u,d)}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(t){t.coord&&"source"===t.dataType?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):"style"===t.dataType&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._mergedSourceCaches)this._style._mergedSourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach((t=>t.fb.destroy())),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(e){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const r=this.proxySourceCache,i=this.painter.transform;this._initializing&&(this._initializing=0===i._centerAltitude&&-1===this.getAtPointOrZero(t._.fromLngLat(i.center),-1),this._emptyDEMTextureDirty=!this._initializing);const n=this.proxyCoords=r.getIds().map((t=>{const e=r.getTileByID(t).tileID;return e.projMatrix=i.calculateProjMatrix(e.toUnwrapped()),e}));!function(e,r){const i=r.transform.pointCoordinate(r.transform.getCameraPoint()),n=new t.P(i.x,i.y);e.sort(((e,r)=>{if(r.overscaledZ-e.overscaledZ)return r.overscaledZ-e.overscaledZ;const i=new t.P(e.canonical.x+(1<<e.canonical.z)*e.wrap,e.canonical.y),o=new t.P(r.canonical.x+(1<<r.canonical.z)*r.wrap,r.canonical.y),s=n.mult(1<<e.canonical.z);return s.x-=.5,s.y-=.5,s.distSqr(i)-s.distSqr(o)}))}(n,this.painter);const o=this.proxyToSource||{};this.proxyToSource={},n.forEach((t=>{this.proxyToSource[t.key]={}})),this.terrainTileForTile={};const s=this._style._mergedSourceCaches;for(const t in s){const r=s[t];if(!r.used)continue;if(r!==this.sourceCache&&this.resetTileLookupCache(r.id),this._setupProxiedCoordsForOrtho(r,e[t],o),r.usedForTerrain)continue;const i=e[t];r.getSource().reparseOverscaled&&this._assignTerrainTiles(i)}this.proxiedCoords[r.id]=n.map((t=>new Lr(t,t.key,this.orthoMatrix))),this._assignTerrainTiles(n),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(o),this.renderingToTexture=!1;const a={};this._visibleDemTiles=[];for(const t of this.proxyCoords){const e=this.terrainTileForTile[t.key];if(!e)continue;const r=e.tileID.key;r in a||(this._visibleDemTiles.push(e),a[r]=r)}}_assignTerrainTiles(t){this._initializing||t.forEach((t=>{if(this.terrainTileForTile[t.key])return;const e=this._findTileCoveringTileID(t,this.sourceCache);e&&(this.terrainTileForTile[t.key]=e)}))}_prepareDEMTextures(){const t=this.painter.context,e=t.gl;for(const r in this.terrainTileForTile){const i=this.terrainTileForTile[r],n=i.dem;!n||i.demTexture&&!i.needsDEMTextureUpload||(t.activeTexture.set(e.TEXTURE1),Ie(this.painter,i,n))}}_prepareDemTileUniforms(t,e,r,i){if(!e||null==e.demTexture)return!1;const n=t.tileID.canonical,o=Math.pow(2,e.tileID.canonical.z-n.z),s=i||"";return r[`u_dem_tl${s}`]=[n.x*o%1,n.y*o%1],r[`u_dem_scale${s}`]=o,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let t=0;const e=this._visibleDemTiles.reduce(((e,r)=>{if(!r.dem)return e;const i=r.dem.tree.minimums[0];return i>0&&t++,e+i}),0);return t?e/t:0}_updateEmptyDEMTexture(){const e=this.painter.context,r=e.gl;e.activeTexture.set(r.TEXTURE2);const i=this._getLoadedAreaMinimum(),[n,o]=(()=>{const e=new t.bB({width:1,height:1},new Float32Array([i]));return[r.R32F,e]})();this._emptyDEMTextureDirty=!1;let s=this._emptyDEMTexture;return s?s.update(o,{premultiply:!1}):s=this._emptyDEMTexture=new t.T(e,o,n,{premultiply:!1}),s}setupElevationDraw(e,r,i){const n=this.painter.context,o=n.gl,s={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};s.u_exaggeration=this.exaggeration();let a=null,l=null,c=1;if(i&&i.morphing&&this._useVertexMorphing){const t=i.morphing.srcDemTile,r=i.morphing.dstDemTile;c=i.morphing.phase,t&&r&&(this._prepareDemTileUniforms(e,t,s,"_prev")&&(l=t),this._prepareDemTileUniforms(e,r,s)&&(a=r))}const u=t=>t&&t.demTexture&&this.painter.linearFloatFilteringSupported()?o.LINEAR:o.NEAREST;let h=null;var d;if(this.enabled?l&&a?(h=a.demTexture,n.activeTexture.set(o.TEXTURE4),l.demTexture.bind(u(l),o.CLAMP_TO_EDGE),s.u_dem_lerp=c):(a=this.terrainTileForTile[e.tileID.key],h=this._prepareDemTileUniforms(e,a,s)?a.demTexture:this.emptyDEMTexture):h=this.emptyDEMTexture,n.activeTexture.set(o.TEXTURE2),h&&(s.u_dem_size=1===(d=h).size[0]?1:d.size[0]-2,h.bind(u(a),o.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(i&&i.useDepthForOcclusion,r,s),i&&i.useMeterToDem&&a){const e=(1<<a.tileID.canonical.z)*t.ay(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;s.u_meter_to_dem=e}if(i&&i.labelPlaneMatrixInv&&(s.u_label_plane_matrix_inv=i.labelPlaneMatrixInv),r.setTerrainUniformValues(n,s),"globe"===this.painter.transform.projection.name){const t=this.globeUniformValues(this.painter.transform,e.tileID.canonical,i&&i.useDenormalizedUpVectorScale);r.setGlobeUniformValues(n,t)}}globeUniformValues(e,r,i){const n=e.projection;return{u_tile_tl_up:n.upVector(r,0,0),u_tile_tr_up:n.upVector(r,t.a4,0),u_tile_br_up:n.upVector(r,t.a4,t.a4),u_tile_bl_up:n.upVector(r,0,t.a4),u_tile_up_scale:i?t.bu(1):n.upVectorScale(r,e.center.lat,e.worldSize).metersToTile}}renderToBackBuffer(e){const r=this.painter,i=this.painter.context;0!==e.length&&(i.bindFramebuffer.set(null),i.viewport.set([0,0,r.width,r.height]),r.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(e,r,i,n,o){if("globe"===e.transform.projection.name)!function(e,r,i,n,o){const s=e.context,a=s.gl;let l,c;const u=e.transform,h=t.bc(e,s,u),d=(t,r)=>{if(c===r)return;const i=[Tr[r],"PROJECTION_GLOBE_VIEW"];h&&i.push("CUSTOM_ANTIALIASING");const n=e.isTileAffectedByFog(t);l=e.getOrCreateProgram("globeRaster",{defines:i,overrideFog:n}),c=r},p=e.colorModeForRenderPass(),f=new t.af(a.LEQUAL,t.af.ReadWrite,e.depthRangeFor3D);wr.update(o);const m=t.bd(u),g=[t.ak(u.center.lng),t.al(u.center.lat)],y=e.globeSharedBuffers,v=[u.width*t.e.devicePixelRatio,u.height*t.e.devicePixelRatio],_=Float32Array.from(u.globeMatrix),b={useDenormalizedUpVectorScale:!0};{const u=e.transform,h=Er(u.zoom,r.exaggeration(),r.sourceCache._source.tileSize);c=-1;const x=a.TRIANGLES;for(const c of n){const n=i.getTile(c),w=t.ah.disabled,T=r.prevTerrainTileForTile[c.key],E=r.terrainTileForTile[c.key];xr(T,E)&&wr.newMorphing(c.key,T,E,o,250),s.activeTexture.set(a.TEXTURE0),n.texture&&n.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);const S=wr.getMorphValuesForProxy(c.key),P=S?1:0;S&&t.q(b,{morphing:{srcDemTile:S.from,dstDemTile:S.to,phase:t.bb(S.phase)}});const k=t.be(c.canonical),A=t.bf(k.getCenter().lat),M=t.bg(c.canonical,k,A,u.worldSize/u._pixelsPerMercatorPixel),C=t.bh(t.bi(c.canonical)),I=ze(u.expandedFarZProjMatrix,_,m,C,t.a2(u.zoom),g,u.frustumCorners.TL,u.frustumCorners.TR,u.frustumCorners.BR,u.frustumCorners.BL,u.globeCenterInViewSpace,u.globeRadius,v,h,u._farZ,M);if(d(c,P),l&&(r.setupElevationDraw(n,l,b),e.uploadCommonUniforms(s,l,c.toUnwrapped()),y)){const[r,i,n]=y.getGridBuffers(A,0!==h);l.draw(e,x,f,w,p,t.ag.backCCW,I,"globe_raster",r,i,n)}}}if(y&&(e.renderDefaultNorthPole||e.renderDefaultSouthPole)){const o=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];h&&o.push("CUSTOM_ANTIALIASING"),l=e.getOrCreateProgram("globeRaster",{defines:o});for(const o of n){const{x:n,y:c,z:h}=o.canonical,d=0===c,m=c===(1<<h)-1,[_,x,w,T]=y.getPoleBuffers(h,!1);if(T&&(d||m)){const c=i.getTile(o);s.activeTexture.set(a.TEXTURE0),c.texture&&c.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);let y=t.bj(h,n,u);const E=t.bh(t.bi(o.canonical)),S=(r,i)=>r.draw(e,a.TRIANGLES,f,t.ah.disabled,p,t.ag.disabled,ze(u.expandedFarZProjMatrix,y,y,E,0,g,u.frustumCorners.TL,u.frustumCorners.TR,u.frustumCorners.BR,u.frustumCorners.BL,u.globeCenterInViewSpace,u.globeRadius,v,0,u._farZ),"globe_pole_raster",i,w,T);r.setupElevationDraw(c,l,b),e.uploadCommonUniforms(s,l,o.toUnwrapped()),d&&e.renderDefaultNorthPole&&S(l,_),m&&e.renderDefaultSouthPole&&(y=t.ae.scale(t.ae.create(),y,[1,-1,1]),S(l,x))}}}}(e,r,i,n,o);else{const s=e.context,a=s.gl;let l,c;const u=e.shadowRenderer,h=dr(e,e.longestCutoffRange),d=t=>{if(c===t)return;const r=[];r.push(Tr[t]),h.shouldRenderCutoff&&r.push("RENDER_CUTOFF"),l=e.getOrCreateProgram("terrainRaster",{defines:r}),c=t},p=e.colorModeForRenderPass(),f=new t.af(a.LEQUAL,t.af.ReadWrite,e.depthRangeFor3D);wr.update(o);const m=e.transform,g=Er(m.zoom,r.exaggeration(),r.sourceCache._source.tileSize);let y=[0,0,0];if(u){const t=e.style.directionalLight,r=e.style.ambientLight;t&&r&&(y=_r(e.style,t,r))}{c=-1;const v=a.TRIANGLES,[_,b]=[r.gridIndexBuffer,r.gridSegments];for(const c of n){const n=i.getTile(c),x=t.ah.disabled,w=r.prevTerrainTileForTile[c.key],T=r.terrainTileForTile[c.key];xr(w,T)&&wr.newMorphing(c.key,w,T,o,250),s.activeTexture.set(a.TEXTURE0),n.texture&&n.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);const E=wr.getMorphValuesForProxy(c.key),S=E?1:0;let P;E&&(P={morphing:{srcDemTile:E.from,dstDemTile:E.to,phase:t.bb(E.phase)}});const k=Be(c.projMatrix,Sr(c.canonical,m.renderWorldCopies)?g/10:g,y);if(d(S),!l)continue;r.setupElevationDraw(n,l,P);const A=c.toUnwrapped();u&&u.setupShadows(A,l),e.uploadCommonUniforms(s,l,A,null,h),l.draw(e,v,f,x,p,t.ag.backCCW,k,"terrain_raster",r.gridBuffer,_,b)}}}}(r,this,this.proxySourceCache,e,this._updateTimestamp),this.renderingToTexture=!0,r.gpuTimingDeferredRenderEnd(),e.splice(0,e.length))}renderBatch(e){if(0===this._drapedRenderBatches.length)return e+1;this.renderingToTexture=!0;const r=this.painter,i=this.painter.context,n=this.proxySourceCache,o=this.proxiedCoords[n.id],s=this._drapedRenderBatches.shift(),a=r.style.order,l=[];let c=0;for(const u of o){const o=n.getTileByID(u.proxyTileKey),h=n.proxyCachedFBO[u.key]?n.proxyCachedFBO[u.key][e]:void 0,d=void 0!==h?n.renderCache[h]:this.pool[c++],p=void 0!==h;if(o.texture=d.tex,p&&!d.dirty){l.push(o.tileID);continue}let f;i.bindFramebuffer.set(d.fb.framebuffer),this.renderedToTile=!1,d.dirty&&(i.clear({color:t.C.transparent,stencil:0}),d.dirty=!1);for(let t=s.start;t<=s.end;++t){const e=r.style._mergedLayers[a[t]];if(e.isHidden(r.transform.zoom))continue;const n=r.style.getLayerSourceCache(e),o=n?this.proxyToSource[u.key][n.id]:[u];if(!o)continue;const s=o;i.viewport.set([0,0,d.fb.width,d.fb.height]),f!==(n?n.id:null)&&(this._setupStencil(d,o,e,n),f=n?n.id:null),r.renderLayer(r,n,e,s)}if(0===this._drapedRenderBatches.length)for(const t of this._pendingGroundEffectLayers){const e=r.style._mergedLayers[a[t]];if(e.isHidden(r.transform.zoom))continue;const n=r.style.getLayerSourceCache(e),o=n?this.proxyToSource[u.key][n.id]:[u];if(!o)continue;const s=o;i.viewport.set([0,0,d.fb.width,d.fb.height]),f!==(n?n.id:null)&&(this._setupStencil(d,o,e,n),f=n?n.id:null),r.renderLayer(r,n,e,s)}this.renderedToTile?(d.dirty=!0,l.push(o.tileID)):p||--c,5===c&&(c=0,this.renderToBackBuffer(l))}return this.renderToBackBuffer(l),this.renderingToTexture=!1,i.bindFramebuffer.set(null),i.viewport.set([0,0,r.width,r.height]),s.end+1}postRender(){}isLayerOrderingCorrect(t){const e=t.order.length;let r=-1,i=e;for(let n=0;n<e;++n)this._style.isLayerDraped(t._mergedLayers[t.order[n]])?r=Math.max(r,n):i=Math.min(i,n);return i>r}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter((t=>t.dem)).forEach((e=>{t=Math.min(t,e.dem.tree.minimums[0])})),0===t?t:(t-30)*this._exaggeration}raycast(t,e,r){if(!this._visibleDemTiles)return null;const i=this._visibleDemTiles.filter((t=>t.dem)).map((i=>{const n=i.tileID,o=1<<n.overscaledZ,{x:s,y:a}=n.canonical,l=s/o,c=(s+1)/o,u=a/o,h=(a+1)/o;return{minx:l,miny:u,maxx:c,maxy:h,t:i.dem.tree.raycastRoot(l,u,c,h,t,e,r),tile:i}}));i.sort(((t,e)=>(null!==t.t?t.t:Number.MAX_VALUE)-(null!==e.t?e.t:Number.MAX_VALUE)));for(const n of i){if(null==n.t)return null;const i=n.tile.dem.tree.raycast(n.minx,n.miny,n.maxx,n.maxy,t,e,r);if(null!=i)return i}return null}_createFBO(){const e=this.painter.context,r=e.gl,i=this.drapeBufferSize;e.activeTexture.set(r.TEXTURE0);const n=new t.T(e,{width:i[0],height:i[1],data:null},r.RGBA);n.bind(r.LINEAR,r.CLAMP_TO_EDGE);const o=e.createFramebuffer(i[0],i[1],!0,null);return o.colorAttachment.set(n.texture),o.depthAttachment=new rt(e,o.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=e.createRenderbuffer(e.gl.DEPTH_STENCIL,i[0],i[1]),this._stencilRef=0,o.depthAttachment.set(this._sharedDepthStencil),e.clear({stencil:0})):o.depthAttachment.set(this._sharedDepthStencil),e.extTextureFilterAnisotropic&&r.texParameterf(r.TEXTURE_2D,e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.extTextureFilterAnisotropicMax),{fb:o,tex:n,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache)return!0;if(this._style.hasLightTransitions())return!0;for(const t in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[t].hasTransition())return!0;return this._style.order.some((t=>{const e=this._style._mergedLayers[t],r=e.isHidden(this.painter.transform.zoom);return"custom"===e.type?!r&&e.shouldRedrape():!r&&e.hasTransition()}))}_clearLineLayersFromRenderCache(){let e=!1;for(const t of this._style.getSources())if(t instanceof Fe){e=!0;break}if(!e)return;const r={};for(let e=0;e<this._style.order.length;++e){const i=this._style._mergedLayers[this._style.order[e]],n=this._style.getLayerSourceCache(i);if(n&&!r[n.id]&&!i.isHidden(this.painter.transform.zoom)&&"line"===i.type&&i.widthExpression()instanceof t.Z){r[n.id]=!0;for(const t of this.proxyCoords){const e=this.proxyToSource[t.key][n.id];if(e)for(const t of e)this._clearRenderCacheForTile(n.id,t)}}}}_clearRasterLayersFromRenderCache(){let t=!1;for(const e in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[e]._source instanceof Re){t=!0;break}if(!t)return;const e={};for(let t=0;t<this._style.order.length;++t){const r=this._style._mergedLayers[this._style.order[t]],i=this._style.getLayerSourceCache(r);if(!i||e[i.id])continue;if(r.isHidden(this.painter.transform.zoom)||"raster"!==r.type)continue;const n=r.paint.get("raster-fade-duration");for(const t of this.proxyCoords){const e=this.proxyToSource[t.key][i.id];if(e)for(const t of e){const e=kr(i.getTile(t),i.findLoadedParent(t,0),i,this.painter.transform,n);(1!==e.opacity||0!==e.mix)&&this._clearRenderCacheForTile(i.id,t)}}}}_setupDrapedRenderBatches(){const e=this._style.order,r=e.length;if(0===r)return;const i=[];this._pendingGroundEffectLayers=[];let n,o=0,s=this._style._mergedLayers[e[o]];for(;!this._style.isLayerDraped(s)&&s.isHidden(this.painter.transform.zoom)&&++o<r;)s=this._style._mergedLayers[e[o]];for(;o<r;++o){const t=this._style._mergedLayers[e[o]];t.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(t)?void 0===n&&(n=o):("fill-extrusion"===t.type&&this._pendingGroundEffectLayers.push(o),void 0!==n&&(i.push({start:n,end:o-1}),n=void 0)))}if(void 0!==n&&i.push({start:n,end:o-1}),0!==i.length){const e=i[i.length-1];this._pendingGroundEffectLayers.every((t=>t>e.end))||t.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=i}_setupRenderCache(t){const e=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,e.renderCache.length>e.renderCachePool.length){const t=Object.values(e.proxyCachedFBO);e.proxyCachedFBO={};for(let r=0;r<t.length;++r){const i=Object.values(t[r]);e.renderCachePool.push(...i)}}return}this._clearRasterLayersFromRenderCache();const r=this.proxyCoords,i=this._tilesDirty;for(let n=r.length-1;n>=0;n--){const o=r[n];if(e.getTileByID(o.key),void 0!==e.proxyCachedFBO[o.key]){const r=t[o.key],n=this.proxyToSource[o.key];let s=0;for(const t in n){const e=n[t],o=r[t];if(!o||o.length!==e.length||e.some(((e,r)=>e!==o[r]||i[t]&&i[t].hasOwnProperty(e.key)))){s=-1;break}++s}for(const t in e.proxyCachedFBO[o.key])e.renderCache[e.proxyCachedFBO[o.key][t]].dirty=s<0||s!==Object.values(r).length}}const n=[...this._drapedRenderBatches];n.sort(((t,e)=>e.end-e.start-(t.end-t.start)));for(const t of n)for(const i of r){if(e.proxyCachedFBO[i.key])continue;let r=e.renderCachePool.pop();void 0===r&&e.renderCache.length<50&&(r=e.renderCache.length,e.renderCache.push(this._createFBO())),void 0!==r&&(e.proxyCachedFBO[i.key]={},e.proxyCachedFBO[i.key][t.start]=r,e.renderCache[r].dirty=!0)}this._tilesDirty={}}_setupStencil(t,e,r,i){if(!i||!this._sourceTilesOverlap[i.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const n=this.painter.context,o=n.gl;if(e.length<=1)return void(this._overlapStencilType=!1);let s;if(r.isTileClipped())s=e.length,this._overlapStencilMode.test={func:o.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(e[0].overscaledZ>e[e.length-1].overscaledZ))return void(this._overlapStencilType=!1);s=1,this._overlapStencilMode.test={func:o.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+s>255&&(n.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=s,this._overlapStencilMode.ref=this._stencilRef,r.isTileClipped()&&this._renderTileClippingMasks(e,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(e){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[e.key]),this._overlapStencilMode):t.ah.disabled}_renderTileClippingMasks(e,r){const i=this.painter,n=this.painter.context,o=n.gl;i._tileClippingMaskIDs={},n.setColorMode(t.a.disabled),n.setDepthMode(t.af.disabled);const s=i.getOrCreateProgram("clippingMask");for(const n of e){const e=i._tileClippingMaskIDs[n.key]=--r;s.draw(i,o.TRIANGLES,t.af.disabled,new t.ah({func:o.ALWAYS,mask:0},e,255,o.KEEP,o.KEEP,o.REPLACE),t.a.disabled,t.ag.disabled,Pr(n.projMatrix),"$clipping",i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}pointCoordinate(e){const r=this.painter.transform;if(e.x<0||e.x>r.width||e.y<0||e.y>r.height)return null;const i=[e.x,e.y,1,1];t.aB.transformMat4(i,i,r.pixelMatrixInverse),t.aB.scale(i,i,1/i[3]),i[0]/=r.worldSize,i[1]/=r.worldSize;const n=r._camera.position,o=t.ay(1,r.center.lat),s=[n[0],n[1],n[2]/o,0],a=t.$.subtract([],i.slice(0,3),s);t.$.normalize(a,a);const l=this.raycast(s,a,this._exaggeration);return null!==l&&l?(t.$.scaleAndAdd(s,s,a,l),s[3]=s[2],s[2]*=o,s):null}_setupProxiedCoordsForOrtho(e,r,i){if(e.getSource()instanceof t.bo)return this._setupProxiedCoordsForImageSource(e,r,i);this._findCoveringTileCache[e.id]=this._findCoveringTileCache[e.id]||{};const n=this.proxiedCoords[e.id]=[],o=this.proxyCoords;for(let t=0;t<o.length;t++){const r=o[t],s=this._findTileCoveringTileID(r,e);if(s){const t=this._createProxiedId(r,s,i[r.key]&&i[r.key][e.id]);n.push(t),this.proxyToSource[r.key][e.id]=[t]}}let s=!1;const a=new Set;for(let t=0;t<r.length;t++){const o=e.getTile(r[t]);if(!o||!o.hasData())continue;const l=this._findTileCoveringTileID(o.tileID,this.proxySourceCache);if(l&&l.tileID.canonical.z!==o.tileID.canonical.z){const t=this.proxyToSource[l.tileID.key][e.id],r=this._createProxiedId(l.tileID,o,i[l.tileID.key]&&i[l.tileID.key][e.id]);t?t.splice(t.length-1,0,r):this.proxyToSource[l.tileID.key][e.id]=[r];const c=this.proxyToSource[l.tileID.key][e.id];a.has(c)||a.add(c),n.push(r),s=!0}}if(this._sourceTilesOverlap[e.id]=s,s&&this._debugParams.sortTilesHiZFirst)for(const t of a)t.sort(((t,e)=>e.overscaledZ-t.overscaledZ))}_setupProxiedCoordsForImageSource(e,r,i){if(!e.getSource().loaded())return;const n=this.proxiedCoords[e.id]=[],o=this.proxyCoords,s=e.getSource(),a=s.tileID;if(!a)return;const l=new t.P(a.x,a.y)._div(1<<a.z),c=s.coordinates.map(t._.fromLngLat).reduce(((t,e)=>(t.min.x=Math.min(t.min.x,e.x-l.x),t.min.y=Math.min(t.min.y,e.y-l.y),t.max.x=Math.max(t.max.x,e.x-l.x),t.max.y=Math.max(t.max.y,e.y-l.y),t)),{min:new t.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new t.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),u=(e,r)=>{const i=e.wrap+e.canonical.x/(1<<e.canonical.z),n=e.canonical.y/(1<<e.canonical.z),o=t.a4/(1<<e.canonical.z),s=r.wrap+r.canonical.x/(1<<r.canonical.z),a=r.canonical.y/(1<<r.canonical.z);return i+o<s+c.min.x||i>s+c.max.x||n+o<a+c.min.y||n>a+c.max.y};for(let t=0;t<o.length;t++){const s=o[t];for(let t=0;t<r.length;t++){const o=e.getTile(r[t]);if(!o||!o.hasData())continue;if(u(s,o.tileID))continue;const a=this._createProxiedId(s,o,i[s.key]&&i[s.key][e.id]),l=this.proxyToSource[s.key][e.id];l?l.push(a):this.proxyToSource[s.key][e.id]=[a],n.push(a)}}}_createProxiedId(e,r,i){let n=this.orthoMatrix;if(i){const t=i.find((t=>t.key===r.tileID.key));if(t)return t}if(r.tileID.key!==e.key){const i=e.canonical.z-r.tileID.canonical.z;let o,s,a;n=t.ae.create();const l=r.tileID.wrap-e.wrap<<e.overscaledZ;i>0?(o=t.a4>>i,s=o*((r.tileID.canonical.x<<i)-e.canonical.x+l),a=o*((r.tileID.canonical.y<<i)-e.canonical.y)):(o=t.a4<<-i,s=t.a4*(r.tileID.canonical.x-(e.canonical.x+l<<-i)),a=t.a4*(r.tileID.canonical.y-(e.canonical.y<<-i))),t.ae.ortho(n,0,o,0,o,0,1),t.ae.translate(n,n,[s,a,0])}return new Lr(r.tileID,e.key,n)}_findTileCoveringTileID(e,r){let i=r.getTile(e);if(i&&i.hasData())return i;const n=this._findCoveringTileCache[r.id],o=n[e.key];if(i=o?r.getTileByID(o):null,i&&i.hasData()||null===o)return i;let s=i?i.tileID:e,a=s.overscaledZ;const l=r.getSource().minzoom,c=[];if(!o){const n=r.getSource().maxzoom;if(e.canonical.z>=n){const i=e.canonical.z-n;r.getSource().reparseOverscaled?(a=Math.max(e.canonical.z+2,r.transform.tileZoom),s=new t.aQ(a,e.wrap,n,e.canonical.x>>i,e.canonical.y>>i)):0!==i&&(a=n,s=new t.aQ(a,e.wrap,n,e.canonical.x>>i,e.canonical.y>>i))}s.key!==e.key&&(c.push(s.key),i=r.getTile(s))}const u=t=>{c.forEach((e=>{n[e]=t})),c.length=0};for(a-=1;a>=l&&(!i||!i.hasData());a--){i&&u(i.tileID.key);const t=s.calculateScaledKey(a);if(i=r.getTileByID(t),i&&i.hasData())break;const e=n[t];if(null===e)break;void 0===e?c.push(t):i=r.getTileByID(e)}return u(i?i.tileID.key:null),i&&i.hasData()?i:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,e){let r=this._tilesDirty[t];r||(r=this._tilesDirty[t]={}),r[e.key]=!0}}function Rr(e,r,i){const n=function(e,r,i){const n=t.$.dot(r,e),o=t.$.dot(i,[.2126,.7152,.0722]),s=(t,e,r)=>(1-r)*t+r*e,a=s(1-.3*Math.min(o,1),1,Math.min(n+1,1));return s(.92,1,Math.asin(t.au(r[2],-1,1))/Math.PI+.5)*a}(e,[0,0,1],r),o=[0,0,0];t.$.scale(o,i.slice(0,3),n);const s=[0,0,0];t.$.scale(s,r.slice(0,3),e[2]);const a=[0,0,0];return t.$.add(a,o,s),t.ba(a)}const Fr=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Br=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class zr{static cacheKey(t,e,r,i){let n=`${e}${i?i.cacheKey:""}`;for(const e of r)t.usedDefines.includes(e)&&(n+=`/${e}`);return n}constructor(e,r,i,n,o,s){const a=e.gl;this.program=a.createProgram(),this.configuration=n,this.name=r,this.fixedDefines=[...s];const l=n?n.getBinderAttributes():[],c=(i.staticAttributes||[]).concat(l);let u=n?n.defines():[];u=u.concat(s.map((t=>`#define ${t}`)));const h="#version 300 es\n";let d=h+u.concat("precision mediump float;",Ee,Te.fragmentSource).join("\n");for(const t of i.fragmentIncludes)d+=`\n${xe[t]}`;d+=`\n${i.fragmentSource}`;let p=h+u.concat("precision highp float;",Ee,Te.vertexSource).join("\n");for(const t of i.vertexIncludes)p+=`\n${xe[t]}`;p+=`\n${i.vertexSource}`;const f=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())return void(this.failedToCreate=!0);a.shaderSource(f,d),a.compileShader(f),a.attachShader(this.program,f);const m=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(m,p),a.compileShader(m),a.attachShader(this.program,m),this.attributes={},this.numAttributes=c.length;for(let t=0;t<this.numAttributes;t++)if(c[t]){const e=c[t].startsWith("a_")?c[t]:`a_${c[t]}`;a.bindAttribLocation(this.program,t,e),this.attributes[e]=t}a.linkProgram(this.program),a.deleteShader(m),a.deleteShader(f),this.fixedUniforms=o(e),this.binderUniforms=n?n.getUniforms(e):[],(s.includes("TERRAIN")||-1!==r.indexOf("symbol")||-1!==r.indexOf("circle"))&&(this.terrainUniforms=(e=>({u_dem:new t.a8(e),u_dem_prev:new t.a8(e),u_dem_tl:new t.a9(e),u_dem_scale:new t.ab(e),u_dem_tl_prev:new t.a9(e),u_dem_scale_prev:new t.ab(e),u_dem_size:new t.ab(e),u_dem_lerp:new t.ab(e),u_exaggeration:new t.ab(e),u_depth:new t.a8(e),u_depth_size_inv:new t.a9(e),u_depth_range_unpack:new t.a9(e),u_occluder_half_size:new t.ab(e),u_occlusion_depth_offset:new t.ab(e),u_meter_to_dem:new t.ab(e),u_label_plane_matrix_inv:new t.a7(e)}))(e)),s.includes("GLOBE")&&(this.globeUniforms=(e=>({u_tile_tl_up:new t.ar(e),u_tile_tr_up:new t.ar(e),u_tile_br_up:new t.ar(e),u_tile_bl_up:new t.ar(e),u_tile_up_scale:new t.ab(e)}))(e)),s.includes("FOG")&&(this.fogUniforms=(e=>({u_fog_matrix:new t.a7(e),u_fog_range:new t.a9(e),u_fog_color:new t.at(e),u_fog_horizon_blend:new t.ab(e),u_fog_vertical_limit:new t.a9(e),u_fog_temporal_offset:new t.ab(e),u_frustum_tl:new t.ar(e),u_frustum_tr:new t.ar(e),u_frustum_br:new t.ar(e),u_frustum_bl:new t.ar(e),u_globe_pos:new t.ar(e),u_globe_radius:new t.ab(e),u_globe_transition:new t.ab(e),u_is_globe:new t.a8(e),u_viewport:new t.a9(e)}))(e)),s.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(e=>({u_cutoff_params:new t.at(e)}))(e)),s.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(e=>({u_lighting_ambient_color:new t.ar(e),u_lighting_directional_dir:new t.ar(e),u_lighting_directional_color:new t.ar(e),u_ground_radiance:new t.ar(e)}))(e)),s.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(e=>({u_light_matrix_0:new t.a7(e),u_light_matrix_1:new t.a7(e),u_fade_range:new t.a9(e),u_shadow_normal_offset:new t.ar(e),u_shadow_intensity:new t.ab(e),u_shadow_texel_size:new t.ab(e),u_shadow_map_resolution:new t.ab(e),u_shadow_direction:new t.ar(e),u_shadow_bias:new t.ar(e),u_shadowmap_0:new t.a8(e),u_shadowmap_1:new t.a8(e)}))(e))}}setTerrainUniformValues(t,e){if(!this.terrainUniforms)return;const r=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)r[t]&&r[t].set(this.program,t,e[t])}}setGlobeUniformValues(t,e){if(!this.globeUniforms)return;const r=this.globeUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)r[t]&&r[t].set(this.program,t,e[t])}}setFogUniformValues(t,e){if(!this.fogUniforms)return;const r=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)r[t].set(this.program,t,e[t])}}setCutoffUniformValues(t,e){if(!this.cutoffUniforms)return;const r=this.cutoffUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)r[t].set(this.program,t,e[t])}}setLightsUniformValues(t,e){if(!this.lightsUniforms)return;const r=this.lightsUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)r[t].set(this.program,t,e[t])}}setShadowUniformValues(t,e){if(this.failedToCreate||!this.shadowUniforms)return;const r=this.shadowUniforms;t.program.set(this.program);for(const t in e)r[t].set(this.program,t,e[t])}_drawDebugWireframe(e,r,i,n,o,s,a,l,c,u){const h=e.options.wireframe;if(!1===h.terrain&&!1===h.layers2D&&!1===h.layers3D)return;const d=e.context;if(!(()=>!(!h.terrain||"terrainRaster"!==this.name&&"globeRaster"!==this.name)||!(!h.layers2D||e._terrain&&e._terrain.renderingToTexture||!Fr.includes(this.name))||!(!h.layers3D||!Br.includes(this.name)))())return;const p=d.gl,f=e.wireframeDebugCache.getLinesFromTrianglesBuffer(e.frameCounter,o,d);if(!f)return;const m=[...this.fixedDefines];m.push("DEBUG_WIREFRAME");const g=e.getOrCreateProgram(this.name,{config:this.configuration,defines:m});d.program.set(g.program);const y=(t,e,r)=>{if(e[t]&&r[t])for(const i in e[t])r[t][i]&&r[t][i].set(r.program,i,e[t][i].current)};c&&c.setUniforms(g.program,d,g.binderUniforms,a,{zoom:l}),y("fixedUniforms",this,g),y("terrainUniforms",this,g),y("globeUniforms",this,g),y("fogUniforms",this,g),y("lightsUniforms",this,g),y("shadowUniforms",this,g),f.bind(),d.setColorMode(new t.a([p.ONE,p.ONE_MINUS_SRC_ALPHA,p.ZERO,p.ONE],t.C.transparent,[!0,!0,!0,!1])),d.setDepthMode(new t.af(r.func===p.LESS?p.LEQUAL:r.func,t.af.ReadOnly,r.range)),d.setStencilMode(t.ah.disabled);const v=3*s.primitiveLength*2,_=3*s.primitiveOffset*2*2;u&&u>1?p.drawElementsInstanced(p.LINES,v,p.UNSIGNED_SHORT,_,u):p.drawElements(p.LINES,v,p.UNSIGNED_SHORT,_),o.bind(),d.program.set(this.program),d.setDepthMode(r),d.setStencilMode(i),d.setColorMode(n)}draw(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m){const g=t.context,y=g.gl;if(this.failedToCreate)return;g.program.set(this.program),g.setDepthMode(r),g.setStencilMode(i),g.setColorMode(n),g.setCullFace(o);for(const t of Object.keys(this.fixedUniforms))this.fixedUniforms[t].set(this.program,t,s[t]);p&&p.setUniforms(this.program,g,this.binderUniforms,h,{zoom:d});const v={[y.POINTS]:1,[y.LINES]:2,[y.TRIANGLES]:3,[y.LINE_STRIP]:1}[e],_=m&&m>0?1:void 0;for(const o of u.get()){const s=o.vaos||(o.vaos={});(s[a]||(s[a]=new Ae)).bind(g,this,l,p?p.getPaintVertexBuffers():[],c,o.vertexOffset,f||[],_),m&&m>1?y.drawElementsInstanced(e,o.primitiveLength*v,y.UNSIGNED_SHORT,o.primitiveOffset*v*2,m):c?y.drawElements(e,o.primitiveLength*v,y.UNSIGNED_SHORT,o.primitiveOffset*v*2):y.drawArrays(e,o.vertexOffset,o.vertexLength),e===y.TRIANGLES&&c&&this._drawDebugWireframe(t,r,i,n,c,o,h,d,p,m)}}}function jr(e,r){const i=Math.pow(2,r.tileID.overscaledZ),n=r.tileSize*Math.pow(2,e.transform.tileZoom)/i,o=n*(r.tileID.canonical.x+r.tileID.wrap*i),s=n*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/t.bD(r,1,e.transform.tileZoom),u_pixel_coord_upper:[o>>16,s>>16],u_pixel_coord_lower:[65535&o,65535&s]}}const Nr=t.ae.create(),Vr=(e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y,v)=>{const _=r.style.light,b=_.properties.get("position"),x=[b.x,b.y,b.z],w=t.bE.create();"viewport"===_.properties.get("anchor")&&(t.bE.fromRotation(w,-r.transform.angle),t.$.transformMat3(x,x,w));const T=_.properties.get("color"),E=r.transform,S={u_matrix:e,u_lightpos:x,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[T.r,T.g,T.b],u_vertical_gradient:+i,u_opacity:n,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Nr,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:o,u_edge_radius:s,u_alignment:a,u_width_scale:l,u_flood_light_color:f,u_vertical_scale:m,u_flood_light_intensity:g,u_ground_shadow_factor:y,u_emissive_strength:v};return"globe"===E.projection.name&&(S.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],S.u_zoom_transition=h,S.u_inv_rot_matrix=p,S.u_merc_center=d,S.u_up_dir=E.projection.upVector(new t.aO(0,0,0),d[0]*t.a4,d[1]*t.a4),S.u_height_lift=u),S},Ur=(t,e,r,i,n)=>({u_matrix:t,u_edge_radius:e,u_alignment:r,u_width_scale:i,u_vertical_scale:n}),$r=(e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g)=>{const y=Vr(e,r,i,n,o,s,a,l,c,h,d,p,f,m,g,1,[0,0,0],0),v={u_height_factor:-Math.pow(2,c.overscaledZ)/u.tileSize/8};return t.Q(y,jr(r,u),v)},Gr=(t,e)=>({u_matrix:t,u_emissive_strength:e}),Hr=(e,r,i,n)=>t.Q(Gr(e,r),jr(i,n)),qr=(t,e,r)=>({u_matrix:t,u_world:r,u_emissive_strength:e}),Wr=(e,r,i,n,o)=>t.Q(Hr(e,r,i,n),{u_world:o}),Zr=(e,r,i,n)=>{const o=t.a4/i.tileSize;return{u_matrix:e,u_camera_to_center_distance:r.getCameraToCenterDistance(n),u_extrude_scale:[r.pixelsToGLUnits[0]/o,r.pixelsToGLUnits[1]/o]}},Xr=(t,e,r=1)=>({u_matrix:t,u_color:e.toRenderColor(null),u_overlay:0,u_overlay_scale:r}),Yr=t.ae.create(),Kr=(e,r,i,n,o,s,a)=>{const l=e.transform,c="globe"===l.projection.name,u=c?t.bF(l.zoom,r.canonical)*l._pixelsPerMercatorPixel:t.bD(i,1,s),h={u_matrix:r.projMatrix,u_extrude_scale:u,u_intensity:a,u_inv_rot_matrix:Yr,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(c){h.u_inv_rot_matrix=n,h.u_merc_center=o,h.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],h.u_zoom_transition=t.a2(l.zoom);const e=o[0]*t.a4,i=o[1]*t.a4;h.u_up_dir=l.projection.upVector(new t.aO(0,0,0),e,i)}return h};function Jr(t,[e,r,i,n],[o,s]){if(o===s)return[0,0,0,0];const a=255*(t-1)/(t*(s-o));return[e*a,r*a,i*a,n*a]}function Qr(t,e,[r,i]){return r===i?0:.5/t+(e-r)*(t-1)/(t*(i-r))}const ti=(e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y,v,_,b,x)=>({u_matrix:e,u_normalize_matrix:r,u_globe_matrix:i,u_merc_matrix:n,u_grid_matrix:o,u_tl_parent:s,u_scale_parent:u,u_fade_t:h.mix,u_opacity:h.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:t.bG(d.paint.get("raster-saturation")),u_contrast_factor:t.bH(d.paint.get("raster-contrast")),u_spin_weights:ei(d.paint.get("raster-hue-rotate")),u_perspective_transform:p,u_raster_elevation:f,u_zoom_transition:a,u_merc_center:l,u_cutoff_params:c,u_colorization_mix:Jr(t.bI,g,v),u_colorization_offset:Qr(t.bI,y,v),u_color_ramp:m,u_texture_offset:[b/(_+2*b),_/(_+2*b)],u_texture_res:[_+2*b,_+2*b],u_emissive_strength:x});function ei(t){t*=Math.PI/180;const e=Math.sin(t),r=Math.cos(t);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}const ri=.05,ii=(t,e,r,i,n,o,s,a,l,c,u,h)=>({u_matrix:t,u_normalize_matrix:e,u_globe_matrix:r,u_merc_matrix:i,u_grid_matrix:n,u_tl_parent:o,u_scale_parent:c,u_fade_t:u.mix,u_opacity:u.opacity,u_image0:0,u_image1:1,u_raster_elevation:h,u_zoom_transition:s,u_merc_center:a,u_cutoff_params:l}),ni=(t,e,r,i,n,o,s,a,l,c)=>({u_particle_texture:t,u_particle_texture_side_len:e,u_tile_offset:r,u_velocity:i,u_color_ramp:o,u_velocity_res:n,u_max_speed:s,u_uv_offset:a,u_data_scale:[255*l[0],255*l[1]],u_data_offset:c,u_particle_pos_scale:1.1,u_particle_pos_offset:[ri,ri]}),oi=(t,e,r,i,n,o,s,a,l,c)=>({u_particle_texture:t,u_particle_texture_side_len:e,u_velocity:r,u_velocity_res:i,u_max_speed:n,u_speed_factor:o,u_reset_rate:s,u_rand_seed:Math.random(),u_uv_offset:a,u_data_scale:[255*l[0],255*l[1]],u_data_offset:c,u_particle_pos_scale:1.1,u_particle_pos_offset:[ri,ri]}),si=t.ae.create(),ai=(e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y,v)=>{const _=o.transform,b={u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:_.getCameraToCenterDistance(g),u_rotate_symbol:+i,u_aspect_ratio:_.width/_.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_matrix:s,u_label_plane_matrix:a,u_coord_matrix:l,u_is_text:+c,u_pitch_with_map:+n,u_texsize:u,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:si,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:si,u_up_vector:[0,-1,0],u_color_adj_mat:y,u_icon_transition:v||0};return"globe"===g.name&&(b.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],b.u_zoom_transition=d,b.u_inv_rot_matrix=f,b.u_merc_center=p,b.u_camera_forward=_._camera.forward(),b.u_ecef_origin=t.bJ(_.globeMatrix,h.toUnwrapped()),b.u_tile_matrix=Float32Array.from(_.globeMatrix),b.u_up_vector=m),b},li=(e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y)=>t.Q(ai(e,r,i,n,o,s,a,l,c,u,d,p,f,m,g,y),{u_gamma_scale:n?o.transform.getCameraToCenterDistance(y)*Math.cos(o.terrain?0:o.transform._pitch):1,u_device_pixel_ratio:t.e.devicePixelRatio,u_is_halo:+h,undefined:void 0}),ci=(e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g)=>t.Q(li(e,r,i,n,o,s,a,l,!0,c,!0,h,d,p,f,m,g),{u_texsize_icon:u,u_texture_icon:1}),ui=(t,e,r,i)=>({u_matrix:t,u_emissive_strength:e,u_opacity:r,u_color:i}),hi=(e,r,i,n,o,s,a,l)=>t.Q(function(e,r,i,n,o){const{width:s,height:a}=n.imageManager.getPixelSize(r),l=Math.pow(2,o.tileID.overscaledZ),c=o.tileSize*Math.pow(2,n.transform.tileZoom)/l,u=c*(o.tileID.canonical.x+o.tileID.wrap*l),h=c*o.tileID.canonical.y;return{u_image:0,u_pattern_tl:i.tl,u_pattern_br:i.br,u_texsize:[s,a],u_pattern_size:i.displaySize,u_tile_units_to_pixels:1/t.bD(o,1,n.transform.tileZoom),u_pixel_coord_upper:[u>>16,h>>16],u_pixel_coord_lower:[65535&u,65535&h]}}(0,s,a,n,l),{u_matrix:e,u_emissive_strength:r,u_opacity:i}),di=new Float32Array(t.ae.identity([])),pi=(e,r,i,n,o,s,a,l,c,u,h,d,p,f=[0,0,0],m)=>{const g=o.style.light,y=g.properties.get("position"),v=[-y.x,-y.y,y.z],_=t.bE.create();"viewport"===g.properties.get("anchor")&&(t.bE.fromRotation(_,-o.transform.angle),t.$.transformMat3(v,v,_));const b="MASK"===h.alphaMode,x=g.properties.get("color").toRenderColor(null),w=p.paint.get("model-ambient-occlusion-intensity"),T=p.paint.get("model-color").constantOr(t.C.white).toRenderColor(null),E=p.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:e,u_lighting_matrix:r,u_normal_matrix:i,u_node_matrix:n||di,u_lightpos:v,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[x.r,x.g,x.b],u_camera_pos:f,u_opacity:s,u_baseTextureIsAlpha:0,u_alphaMask:+b,u_alphaCutoff:h.alphaCutoff,u_baseColorFactor:[a.r,a.g,a.b,a.a],u_emissiveFactor:[l[0],l[1],l[2],1],u_metallicFactor:c,u_roughnessFactor:u,u_baseColorTexture:hr.BaseColor,u_metallicRoughnessTexture:hr.MetallicRoughness,u_normalTexture:hr.Normal,u_occlusionTexture:hr.Occlusion,u_emissionTexture:hr.Emission,u_lutTexture:hr.LUT,u_color_mix:[T.r,T.g,T.b,E],u_aoIntensity:w,u_emissive_strength:d,u_occlusionTextureTransform:m||[0,0,0,0]}},fi=(t,e=di,r=di)=>({u_matrix:t,u_instance:e,u_node_matrix:r}),mi={fillExtrusion:e=>({u_matrix:new t.a7(e),u_lightpos:new t.ar(e),u_lightintensity:new t.ab(e),u_lightcolor:new t.ar(e),u_vertical_gradient:new t.ab(e),u_opacity:new t.ab(e),u_edge_radius:new t.ab(e),u_alignment:new t.ab(e),u_width_scale:new t.ab(e),u_ao:new t.a9(e),u_tile_id:new t.ar(e),u_zoom_transition:new t.ab(e),u_inv_rot_matrix:new t.a7(e),u_merc_center:new t.a9(e),u_up_dir:new t.ar(e),u_height_lift:new t.ab(e),u_flood_light_color:new t.ar(e),u_vertical_scale:new t.ab(e),u_flood_light_intensity:new t.ab(e),u_ground_shadow_factor:new t.ar(e),u_emissive_strength:new t.ab(e)}),fillExtrusionDepth:e=>({u_matrix:new t.a7(e),u_edge_radius:new t.ab(e),u_alignment:new t.ab(e),u_width_scale:new t.ab(e),u_vertical_scale:new t.ab(e)}),fillExtrusionPattern:e=>({u_matrix:new t.a7(e),u_lightpos:new t.ar(e),u_lightintensity:new t.ab(e),u_lightcolor:new t.ar(e),u_vertical_gradient:new t.ab(e),u_height_factor:new t.ab(e),u_edge_radius:new t.ab(e),u_alignment:new t.ab(e),u_width_scale:new t.ab(e),u_ao:new t.a9(e),u_tile_id:new t.ar(e),u_zoom_transition:new t.ab(e),u_inv_rot_matrix:new t.a7(e),u_merc_center:new t.a9(e),u_up_dir:new t.ar(e),u_height_lift:new t.ab(e),u_image:new t.a8(e),u_texsize:new t.a9(e),u_pixel_coord_upper:new t.a9(e),u_pixel_coord_lower:new t.a9(e),u_tile_units_to_pixels:new t.ab(e),u_opacity:new t.ab(e)}),fillExtrusionGroundEffect:e=>({u_matrix:new t.a7(e),u_opacity:new t.ab(e),u_ao_pass:new t.ab(e),u_meter_to_tile:new t.ab(e),u_ao:new t.a9(e),u_flood_light_intensity:new t.ab(e),u_flood_light_color:new t.ar(e),u_attenuation:new t.ab(e),u_edge_radius:new t.ab(e),u_fb:new t.a8(e),u_fb_size:new t.ab(e)}),fill:e=>({u_matrix:new t.a7(e),u_emissive_strength:new t.ab(e)}),fillPattern:e=>({u_matrix:new t.a7(e),u_emissive_strength:new t.ab(e),u_image:new t.a8(e),u_texsize:new t.a9(e),u_pixel_coord_upper:new t.a9(e),u_pixel_coord_lower:new t.a9(e),u_tile_units_to_pixels:new t.ab(e)}),fillOutline:e=>({u_matrix:new t.a7(e),u_emissive_strength:new t.ab(e),u_world:new t.a9(e)}),fillOutlinePattern:e=>({u_matrix:new t.a7(e),u_emissive_strength:new t.ab(e),u_world:new t.a9(e),u_image:new t.a8(e),u_texsize:new t.a9(e),u_pixel_coord_upper:new t.a9(e),u_pixel_coord_lower:new t.a9(e),u_tile_units_to_pixels:new t.ab(e)}),circle:t.bK,collisionBox:e=>({u_matrix:new t.a7(e),u_camera_to_center_distance:new t.ab(e),u_extrude_scale:new t.a9(e)}),collisionCircle:e=>({u_matrix:new t.a7(e),u_inv_matrix:new t.a7(e),u_camera_to_center_distance:new t.ab(e),u_viewport_size:new t.a9(e)}),debug:e=>({u_color:new t.aa(e),u_matrix:new t.a7(e),u_overlay:new t.a8(e),u_overlay_scale:new t.ab(e)}),clippingMask:e=>({u_matrix:new t.a7(e)}),heatmap:e=>({u_extrude_scale:new t.ab(e),u_intensity:new t.ab(e),u_matrix:new t.a7(e),u_inv_rot_matrix:new t.a7(e),u_merc_center:new t.a9(e),u_tile_id:new t.ar(e),u_zoom_transition:new t.ab(e),u_up_dir:new t.ar(e)}),heatmapTexture:e=>({u_image:new t.a8(e),u_color_ramp:new t.a8(e),u_opacity:new t.ab(e)}),hillshade:e=>({u_matrix:new t.a7(e),u_image:new t.a8(e),u_latrange:new t.a9(e),u_light:new t.a9(e),u_shadow:new t.aa(e),u_highlight:new t.aa(e),u_emissive_strength:new t.ab(e),u_accent:new t.aa(e)}),hillshadePrepare:e=>({u_matrix:new t.a7(e),u_image:new t.a8(e),u_dimension:new t.a9(e),u_zoom:new t.ab(e)}),line:t.bL,linePattern:t.bM,raster:e=>({u_matrix:new t.a7(e),u_normalize_matrix:new t.a7(e),u_globe_matrix:new t.a7(e),u_merc_matrix:new t.a7(e),u_grid_matrix:new t.as(e),u_tl_parent:new t.a9(e),u_scale_parent:new t.ab(e),u_fade_t:new t.ab(e),u_opacity:new t.ab(e),u_image0:new t.a8(e),u_image1:new t.a8(e),u_brightness_low:new t.ab(e),u_brightness_high:new t.ab(e),u_saturation_factor:new t.ab(e),u_contrast_factor:new t.ab(e),u_spin_weights:new t.ar(e),u_perspective_transform:new t.a9(e),u_raster_elevation:new t.ab(e),u_zoom_transition:new t.ab(e),u_merc_center:new t.a9(e),u_cutoff_params:new t.at(e),u_colorization_mix:new t.at(e),u_colorization_offset:new t.ab(e),u_color_ramp:new t.a8(e),u_texture_offset:new t.a9(e),u_texture_res:new t.a9(e),u_emissive_strength:new t.ab(e)}),rasterParticle:e=>({u_matrix:new t.a7(e),u_normalize_matrix:new t.a7(e),u_globe_matrix:new t.a7(e),u_merc_matrix:new t.a7(e),u_grid_matrix:new t.as(e),u_tl_parent:new t.a9(e),u_scale_parent:new t.ab(e),u_fade_t:new t.ab(e),u_opacity:new t.ab(e),u_image0:new t.a8(e),u_image1:new t.a8(e),u_raster_elevation:new t.ab(e),u_zoom_transition:new t.ab(e),u_merc_center:new t.a9(e),u_cutoff_params:new t.at(e)}),rasterParticleTexture:e=>({u_texture:new t.a8(e),u_opacity:new t.ab(e)}),rasterParticleDraw:e=>({u_particle_texture:new t.a8(e),u_particle_texture_side_len:new t.ab(e),u_tile_offset:new t.a9(e),u_velocity:new t.a8(e),u_color_ramp:new t.a8(e),u_velocity_res:new t.a9(e),u_max_speed:new t.ab(e),u_uv_offset:new t.a9(e),u_data_scale:new t.a9(e),u_data_offset:new t.ab(e),u_particle_pos_scale:new t.ab(e),u_particle_pos_offset:new t.a9(e)}),rasterParticleUpdate:e=>({u_particle_texture:new t.a8(e),u_particle_texture_side_len:new t.ab(e),u_velocity:new t.a8(e),u_velocity_res:new t.a9(e),u_max_speed:new t.ab(e),u_speed_factor:new t.ab(e),u_reset_rate:new t.ab(e),u_rand_seed:new t.ab(e),u_uv_offset:new t.a9(e),u_data_scale:new t.a9(e),u_data_offset:new t.ab(e),u_particle_pos_scale:new t.ab(e),u_particle_pos_offset:new t.a9(e)}),symbolIcon:e=>({u_is_size_zoom_constant:new t.a8(e),u_is_size_feature_constant:new t.a8(e),u_size_t:new t.ab(e),u_size:new t.ab(e),u_camera_to_center_distance:new t.ab(e),u_rotate_symbol:new t.a8(e),u_aspect_ratio:new t.ab(e),u_fade_change:new t.ab(e),u_matrix:new t.a7(e),u_label_plane_matrix:new t.a7(e),u_coord_matrix:new t.a7(e),u_is_text:new t.a8(e),u_pitch_with_map:new t.a8(e),u_texsize:new t.a9(e),u_tile_id:new t.ar(e),u_zoom_transition:new t.ab(e),u_inv_rot_matrix:new t.a7(e),u_merc_center:new t.a9(e),u_camera_forward:new t.ar(e),u_tile_matrix:new t.a7(e),u_up_vector:new t.ar(e),u_ecef_origin:new t.ar(e),u_texture:new t.a8(e),u_icon_transition:new t.ab(e),u_color_adj_mat:new t.a7(e)}),symbolSDF:e=>({u_is_size_zoom_constant:new t.a8(e),u_is_size_feature_constant:new t.a8(e),u_size_t:new t.ab(e),u_size:new t.ab(e),u_camera_to_center_distance:new t.ab(e),u_rotate_symbol:new t.a8(e),u_aspect_ratio:new t.ab(e),u_fade_change:new t.ab(e),u_matrix:new t.a7(e),u_label_plane_matrix:new t.a7(e),u_coord_matrix:new t.a7(e),u_is_text:new t.a8(e),u_pitch_with_map:new t.a8(e),u_texsize:new t.a9(e),u_texture:new t.a8(e),u_gamma_scale:new t.ab(e),u_device_pixel_ratio:new t.ab(e),u_tile_id:new t.ar(e),u_zoom_transition:new t.ab(e),u_inv_rot_matrix:new t.a7(e),u_merc_center:new t.a9(e),u_camera_forward:new t.ar(e),u_tile_matrix:new t.a7(e),u_up_vector:new t.ar(e),u_ecef_origin:new t.ar(e),u_is_halo:new t.a8(e)}),symbolTextAndIcon:e=>({u_is_size_zoom_constant:new t.a8(e),u_is_size_feature_constant:new t.a8(e),u_size_t:new t.ab(e),u_size:new t.ab(e),u_camera_to_center_distance:new t.ab(e),u_rotate_symbol:new t.a8(e),u_aspect_ratio:new t.ab(e),u_fade_change:new t.ab(e),u_matrix:new t.a7(e),u_label_plane_matrix:new t.a7(e),u_coord_matrix:new t.a7(e),u_is_text:new t.a8(e),u_pitch_with_map:new t.a8(e),u_texsize:new t.a9(e),u_texsize_icon:new t.a9(e),u_texture:new t.a8(e),u_texture_icon:new t.a8(e),u_gamma_scale:new t.ab(e),u_device_pixel_ratio:new t.ab(e),u_is_halo:new t.a8(e)}),background:e=>({u_matrix:new t.a7(e),u_emissive_strength:new t.ab(e),u_opacity:new t.ab(e),u_color:new t.aa(e)}),backgroundPattern:e=>({u_matrix:new t.a7(e),u_emissive_strength:new t.ab(e),u_opacity:new t.ab(e),u_image:new t.a8(e),u_pattern_tl:new t.a9(e),u_pattern_br:new t.a9(e),u_texsize:new t.a9(e),u_pattern_size:new t.a9(e),u_pixel_coord_upper:new t.a9(e),u_pixel_coord_lower:new t.a9(e),u_tile_units_to_pixels:new t.ab(e)}),terrainRaster:e=>({u_matrix:new t.a7(e),u_image0:new t.a8(e),u_skirt_height:new t.ab(e),u_ground_shadow_factor:new t.ar(e)}),skybox:e=>({u_matrix:new t.a7(e),u_sun_direction:new t.ar(e),u_cubemap:new t.a8(e),u_opacity:new t.ab(e),u_temporal_offset:new t.ab(e)}),skyboxGradient:e=>({u_matrix:new t.a7(e),u_color_ramp:new t.a8(e),u_center_direction:new t.ar(e),u_radius:new t.ab(e),u_opacity:new t.ab(e),u_temporal_offset:new t.ab(e)}),skyboxCapture:e=>({u_matrix_3f:new t.as(e),u_sun_direction:new t.ar(e),u_sun_intensity:new t.ab(e),u_color_tint_r:new t.at(e),u_color_tint_m:new t.at(e),u_luminance:new t.ab(e)}),globeRaster:e=>({u_proj_matrix:new t.a7(e),u_globe_matrix:new t.a7(e),u_normalize_matrix:new t.a7(e),u_merc_matrix:new t.a7(e),u_zoom_transition:new t.ab(e),u_merc_center:new t.a9(e),u_image0:new t.a8(e),u_grid_matrix:new t.as(e),u_skirt_height:new t.ab(e),u_far_z_cutoff:new t.ab(e),u_frustum_tl:new t.ar(e),u_frustum_tr:new t.ar(e),u_frustum_br:new t.ar(e),u_frustum_bl:new t.ar(e),u_globe_pos:new t.ar(e),u_globe_radius:new t.ab(e),u_viewport:new t.a9(e)}),globeAtmosphere:e=>({u_frustum_tl:new t.ar(e),u_frustum_tr:new t.ar(e),u_frustum_br:new t.ar(e),u_frustum_bl:new t.ar(e),u_horizon:new t.ab(e),u_transition:new t.ab(e),u_fadeout_range:new t.ab(e),u_color:new t.at(e),u_high_color:new t.at(e),u_space_color:new t.at(e),u_temporal_offset:new t.ab(e),u_horizon_angle:new t.ab(e)}),model:e=>({u_matrix:new t.a7(e),u_lighting_matrix:new t.a7(e),u_normal_matrix:new t.a7(e),u_node_matrix:new t.a7(e),u_lightpos:new t.ar(e),u_lightintensity:new t.ab(e),u_lightcolor:new t.ar(e),u_camera_pos:new t.ar(e),u_opacity:new t.ab(e),u_baseColorFactor:new t.at(e),u_emissiveFactor:new t.at(e),u_metallicFactor:new t.ab(e),u_roughnessFactor:new t.ab(e),u_baseTextureIsAlpha:new t.a8(e),u_alphaMask:new t.a8(e),u_alphaCutoff:new t.ab(e),u_baseColorTexture:new t.a8(e),u_metallicRoughnessTexture:new t.a8(e),u_normalTexture:new t.a8(e),u_occlusionTexture:new t.a8(e),u_emissionTexture:new t.a8(e),u_lutTexture:new t.a8(e),u_color_mix:new t.at(e),u_aoIntensity:new t.ab(e),u_emissive_strength:new t.ab(e),u_occlusionTextureTransform:new t.at(e)}),modelDepth:e=>({u_matrix:new t.a7(e),u_instance:new t.a7(e),u_node_matrix:new t.a7(e)}),groundShadow:e=>({u_matrix:new t.a7(e),u_ground_shadow_factor:new t.ar(e)}),stars:e=>({u_matrix:new t.a7(e),u_up:new t.ar(e),u_right:new t.ar(e),u_intensity_multiplier:new t.ab(e)}),occlusion:e=>({u_matrix:new t.a7(e),u_anchorPos:new t.ar(e),u_screenSizePx:new t.a9(e),u_occluderSizePx:new t.a9(e),u_color:new t.at(e)})};function gi(e,r,i){const n=r.createTileMatrix(e,e.worldSize,i.toUnwrapped());return t.ae.multiply(new Float32Array(16),e.projMatrix,n)}function yi(t,e,r){if(e.projection.name===r.projection.name)return t.projMatrix;const i=r.clone();return i.setProjection(e.projection),gi(i,e.getProjection(),t)}function vi(t,e,r){return e.name===r.projection.name?t.projMatrix:gi(r,e,t)}let _i;function bi(e,r,i,n,o,s,a){const l=e.context,c=l.gl,u=e.transform,h=e.getOrCreateProgram("collisionBox"),d=[];let p=0,f=0;for(let l=0;l<n.length;l++){const m=n[l],g=r.getTile(m),y=g.getBucket(i);if(!y)continue;const v=yi(m,y,u);let _=v;0===o[0]&&0===o[1]||(_=e.translatePosMatrix(v,g,o,s));const b=a?y.textCollisionBox:y.iconCollisionBox,x=y.collisionCircleArray;if(x.length>0){const e=t.ae.create(),r=_;t.ae.mul(e,y.placementInvProjMatrix,u.glCoordMatrix),t.ae.mul(e,e,y.placementViewportMatrix),d.push({circleArray:x,circleOffset:f,transform:r,invTransform:e,projection:y.getProjection()}),p+=x.length/4,f=p}b&&(e.terrain&&e.terrain.setupElevationDraw(g,h),h.draw(e,c.LINES,t.af.disabled,t.ah.disabled,e.colorModeForRenderPass(),t.ag.disabled,Zr(_,u,g,y.getProjection()),i.id,b.layoutVertexBuffer,b.indexBuffer,b.segments,null,u.zoom,null,[b.collisionVertexBuffer,b.collisionVertexBufferExt]))}if(!a||!d.length)return;const m=e.getOrCreateProgram("collisionCircle"),g=new t.bN;g.resize(4*p),g._trim();let y=0;for(const t of d)for(let e=0;e<t.circleArray.length/4;e++){const r=4*e,i=t.circleArray[r+0],n=t.circleArray[r+1],o=t.circleArray[r+2],s=t.circleArray[r+3];g.emplace(y++,i,n,o,s,0),g.emplace(y++,i,n,o,s,1),g.emplace(y++,i,n,o,s,2),g.emplace(y++,i,n,o,s,3)}(!_i||_i.length<2*p)&&(_i=function(e){const r=2*e,i=new t.bw;i.resize(r),i._trim();for(let t=0;t<r;t++){const e=6*t;i.uint16[e+0]=4*t+0,i.uint16[e+1]=4*t+1,i.uint16[e+2]=4*t+2,i.uint16[e+3]=4*t+2,i.uint16[e+4]=4*t+3,i.uint16[e+5]=4*t+0}return i}(p));const v=l.createIndexBuffer(_i,!0),_=l.createVertexBuffer(g,t.bO.members,!0);for(const r of d){const n={u_matrix:r.transform,u_inv_matrix:r.invTransform,u_camera_to_center_distance:(b=u).getCameraToCenterDistance(r.projection),u_viewport_size:[b.width,b.height]};m.draw(e,c.TRIANGLES,t.af.disabled,t.ah.disabled,e.colorModeForRenderPass(),t.ag.disabled,n,i.id,_,v,t.b.simpleSegment(0,2*r.circleOffset,r.circleArray.length,r.circleArray.length/2),null,u.zoom)}var b;_.destroy(),v.destroy()}const xi=t.ae.create();function wi(e){const r=e._camera.getWorldToCamera(e.worldSize,1),i=t.ae.multiply([],r,e.globeMatrix);t.ae.invert(i,i);const n=[0,0,0],o=[0,1,0,0];return t.aB.transformMat4(o,o,i),n[0]=o[0],n[1]=o[1],n[2]=o[2],t.$.normalize(n,n),n}function Ti({width:e,height:r,anchor:i,textOffset:n,textScale:o},s){const{horizontalAlign:a,verticalAlign:l}=t.bS(i),c=-(a-.5)*e,u=-(l-.5)*r,h=t.bR(i,n);return new t.P((c/o+h[0])*s,(u/o+h[1])*s)}function Ei(e,r,i,n,o,s,a,l,c,u,h){const d=e.text.placedSymbolArray,p=e.text.dynamicLayoutVertexArray,f=e.icon.dynamicLayoutVertexArray,m={},g=e.getProjection(),y=vi(l,g,s),v=s.elevation,_=g.upVectorScale(l.canonical,s.center.lat,s.worldSize).metersToTile;p.clear();for(let f=0;f<d.length;f++){const b=d.get(f),{tileAnchorX:x,tileAnchorY:w,numGlyphs:T}=b,E=b.hidden||!b.crossTileID||e.allowVerticalPlacement&&!b.placedOrientation?null:n[b.crossTileID];if(E){let n=0,d=0,f=0;if(v){const t=v?v.getAtTileOffset(l,x,w):0,[e,r,i]=g.upVector(l.canonical,x,w);n=t*e*_,d=t*r*_,f=t*i*_}let[S,P,k,A]=Ye(b.projectedAnchorX+n,b.projectedAnchorY+d,b.projectedAnchorZ+f,i?y:a);const M=Ke(s.getCameraToCenterDistance(g),A);let C=o.evaluateSizeForFeature(e.textSizeData,u,b)*M/t.bP;i&&(C*=e.tilePixelRatio/c);const I=Ti(E,C);i?(({x:S,y:P,z:k}=g.projectTilePoint(x+I.x,w+I.y,l.canonical)),[S,P,k]=Ye(S+n,P+d,k+f,a)):(r&&I._rotate(-s.angle),S+=I.x,P+=I.y,k=0);const O=e.allowVerticalPlacement&&b.placedOrientation===t.aF.vertical?Math.PI/2:0;for(let e=0;e<T;e++)t.aI(p,S,P,k,O);h&&b.associatedIconIndex>=0&&(m[b.associatedIconIndex]={x:S,y:P,z:k,angle:O})}else sr(T,p)}if(h){f.clear();const r=e.icon.placedSymbolArray;for(let e=0;e<r.length;e++){const i=r.get(e),{numGlyphs:n}=i,o=m[e];if(i.hidden||!o)sr(n,f);else{const{x:e,y:r,z:i,angle:s}=o;for(let o=0;o<n;o++)t.aI(f,e,r,i,s)}}e.icon.dynamicLayoutVertexBuffer.updateData(f)}e.text.dynamicLayoutVertexBuffer.updateData(p)}function Si(e,r,i,n,o,s,a={}){const l=i.paint.get("icon-translate"),c=i.paint.get("text-translate"),u=i.paint.get("icon-translate-anchor"),h=i.paint.get("text-translate-anchor"),d=i.layout.get("icon-rotation-alignment"),p=i.layout.get("text-rotation-alignment"),f=i.layout.get("icon-pitch-alignment"),m=i.layout.get("text-pitch-alignment"),g=i.layout.get("icon-keep-upright"),y=i.layout.get("text-keep-upright"),v=i.paint.get("icon-color-saturation"),_=i.paint.get("icon-color-contrast"),b=i.paint.get("icon-color-brightness-min"),x=i.paint.get("icon-color-brightness-max");i.paint.get("icon-occlusion-opacity").constantOr(0),i.paint.get("text-occlusion-opacity").constantOr(0);const w=e.context,T=w.gl,E=e.transform,S="map"===d,P="map"===p,k="map"===f,A="map"===m,M=void 0!==i.layout.get("symbol-sort-key").constantOr(1);let C=!1;const I=e.depthModeForSublayer(0,t.af.ReadOnly),O=[t.ak(E.center.lng),t.al(E.center.lat)],L=i.layout.get("text-variable-anchor"),D="globe"===E.projection.name,R=[],F=[0,-1,0];for(const o of n){const n=r.getTile(o),s=n.getBucket(i);if(!s)continue;if("mercator"===s.projection.name&&D)continue;if(s.fullyClipped)continue;const d="globe"===s.projection.name,p=d?t.a2(E.zoom):0,f=vi(o,s.getProjection(),E),m=E.calculatePixelsToTileUnitsMatrix(n),w=L&&s.hasTextData(),I=s.hasIconTextFit()&&w&&s.hasIconData(),B=s.getProjection().createInversionMatrix(E,o.canonical),z=t=>{E.depthOcclusionForSymbolsAndCircles&&(i.hasInitialOcclusionOpacityProperties||e.terrain)&&(t.push("DEPTH_D24"),t.push("DEPTH_OCCLUSION"))},j=()=>{const r=S&&"point"!==i.layout.get("symbol-placement"),a=[];z(a);const c=r||I,h=i.paint.get("icon-image-cross-fade").constantOr(0);e.terrainRenderModeElevated()&&k&&a.push("PITCH_WITH_MAP_TERRAIN"),d&&(a.push("PROJECTION_GLOBE_VIEW"),c&&a.push("PROJECTED_POS_ON_VIEWPORT")),h>0&&a.push("ICON_TRANSITION"),s.icon.zOffsetVertexBuffer&&a.push("Z_OFFSET"),0===v&&0===_&&0===b&&1===x||a.push("COLOR_ADJUSTMENT");const y=s.icon.programConfigurations.get(i.id),w=e.getOrCreateProgram(s.sdfIcons?"symbolSDF":"symbolIcon",{config:y,defines:a});let P;const A=n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],M=s.iconSizeData,C=t.aE(M,E.zoom),L=k||0!==E.pitch,R=We(f,n.tileID.canonical,k,S,E,s.getProjection(),m),j=Xe(f,n.tileID.canonical,k,S,E,s.getProjection(),m),N=e.translatePosMatrix(j,n,l,u,!0),V=e.translatePosMatrix(f,n,l,u),U=c?xi:R,$=S&&!k&&!r;let G=F;!D&&!E.mercatorFromTransition||S||(G=wi(E));const H=d?G:F;if(s.sdfIcons&&!s.iconsInText)P=li(M.kind,C,$,k,e,V,U,N,!1,A,!0,o,p,O,B,H,s.getProjection());else{const t=i.getColorAdjustmentMatrix(v,_,b,x);P=ai(M.kind,C,$,k,e,V,U,N,!1,A,o,p,O,B,H,s.getProjection(),t,h)}const q=n.imageAtlasTexture?n.imageAtlasTexture:null,W=1!==i.layout.get("icon-size").constantOr(0)||s.iconsNeedLinear,Z=s.sdfIcons||e.options.rotating||e.options.zooming||W||L?T.LINEAR:T.NEAREST,X=s.sdfIcons&&0!==i.paint.get("icon-halo-width").constantOr(1),Y=e.terrain&&k&&r?t.ae.invert(t.ae.create(),R):xi;if(r&&s.icon){const t=E.elevation,r=t?t.getAtTileOffsetFunc(o,E.center.lat,E.worldSize,s.getProjection()):null,i=Ze(f,n.tileID.canonical,k,S,E,s.getProjection(),m);Qe(s,f,e,!1,i,j,k,g,r,o)}return{program:w,buffers:s.icon,uniformValues:P,atlasTexture:q,atlasTextureIcon:null,atlasInterpolation:Z,atlasInterpolationIcon:null,isSDF:s.sdfIcons,hasHalo:X,tile:n,labelPlaneMatrixInv:Y}},N=()=>{const r=P&&"point"!==i.layout.get("symbol-placement"),a=[],l=r||L||I;e.terrainRenderModeElevated()&&A&&a.push("PITCH_WITH_MAP_TERRAIN"),d&&(a.push("PROJECTION_GLOBE_VIEW"),l&&a.push("PROJECTED_POS_ON_VIEWPORT")),s.text.zOffsetVertexBuffer&&a.push("Z_OFFSET"),z(a);const u=s.text.programConfigurations.get(i.id),g=e.getOrCreateProgram(s.iconsInText?"symbolTextAndIcon":"symbolSDF",{config:u,defines:a});let v,_=[0,0],b=null;const x=s.textSizeData;s.iconsInText&&(_=n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],b=n.imageAtlasTexture?n.imageAtlasTexture:null,v=A||0!==E.pitch||e.options.rotating||e.options.zooming||"composite"===x.kind||"camera"===x.kind?T.LINEAR:T.NEAREST);const w=n.glyphAtlasTexture?n.glyphAtlasTexture.size:[0,0],S=t.aE(x,E.zoom),k=We(f,n.tileID.canonical,A,P,E,s.getProjection(),m),M=Xe(f,n.tileID.canonical,A,P,E,s.getProjection(),m),C=e.translatePosMatrix(M,n,c,h,!0),R=e.translatePosMatrix(f,n,c,h),j=l?xi:k,N=P&&!A&&!r;let V=F;!D&&!E.mercatorFromTransition||P||(V=wi(E));const U=d?V:F;let $;$=s.iconsInText?ci(x.kind,S,N,A,e,R,j,C,w,_,o,p,O,B,U,s.getProjection()):li(x.kind,S,N,A,e,R,j,C,!0,w,!0,o,p,O,B,U,s.getProjection());const G=n.glyphAtlasTexture?n.glyphAtlasTexture:null,H=T.LINEAR,q=0!==i.paint.get("text-halo-width").constantOr(1),W=e.terrain&&A&&r?t.ae.invert(t.ae.create(),k):xi;if(r&&s.text){const t=E.elevation,r=t?t.getAtTileOffsetFunc(o,E.center.lat,E.worldSize,s.getProjection()):null,i=Ze(f,n.tileID.canonical,A,P,E,s.getProjection(),m);Qe(s,f,e,!0,i,M,A,y,r,o)}return{program:g,buffers:s.text,uniformValues:$,atlasTexture:G,atlasTextureIcon:b,atlasInterpolation:H,atlasInterpolationIcon:v,isSDF:!0,hasHalo:q,tile:n,labelPlaneMatrixInv:W}},V=s.icon.segments.get().length,U=s.text.segments.get().length,$=V&&!a.onlyText?j():null,G=U&&!a.onlyIcons?N():null,H=i.paint.get("icon-opacity").constantOr(1),q=i.paint.get("text-opacity").constantOr(1);if(M&&s.canOverlap){C=!0;const e=H&&!a.onlyText?s.icon.segments.get():[],r=q&&!a.onlyIcons?s.text.segments.get():[];for(const r of e)R.push({segments:new t.b([r]),sortKey:r.sortKey,state:$});for(const e of r)R.push({segments:new t.b([e]),sortKey:e.sortKey,state:G})}else a.onlyText||R.push({segments:H?s.icon.segments:new t.b([]),sortKey:0,state:$}),a.onlyIcons||R.push({segments:q?s.text.segments:new t.b([]),sortKey:0,state:G})}C&&R.sort(((t,e)=>t.sortKey-e.sortKey));for(const t of R){const r=t.state;if(r)if(e.terrain?e.terrain.setupElevationDraw(r.tile,r.program,{useDepthForOcclusion:E.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:r.labelPlaneMatrixInv}):e.setupDepthForOcclusion(E.depthOcclusionForSymbolsAndCircles,r.program),w.activeTexture.set(T.TEXTURE0),r.atlasTexture&&r.atlasTexture.bind(r.atlasInterpolation,T.CLAMP_TO_EDGE,!0),r.atlasTextureIcon&&(w.activeTexture.set(T.TEXTURE1),r.atlasTextureIcon&&r.atlasTextureIcon.bind(r.atlasInterpolationIcon,T.CLAMP_TO_EDGE,!0)),e.uploadCommonLightUniforms(e.context,r.program),r.hasHalo){const n=r.uniformValues;n.u_is_halo=1,Pi(r.buffers,t.segments,i,e,r.program,I,o,s,n,2),n.u_is_halo=0}else{if(r.isSDF){const n=r.uniformValues;r.hasHalo&&(n.u_is_halo=1,Pi(r.buffers,t.segments,i,e,r.program,I,o,s,n,1)),n.u_is_halo=0}Pi(r.buffers,t.segments,i,e,r.program,I,o,s,r.uniformValues,1)}}}function Pi(e,r,i,n,o,s,a,l,c,u){const h=[e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer,e.iconTransitioningVertexBuffer,e.globeExtVertexBuffer,e.zOffsetVertexBuffer];o.draw(n,n.context.gl.TRIANGLES,s,a,l,t.ag.disabled,c,i.id,e.layoutVertexBuffer,e.indexBuffer,r,i.paint,n.transform.zoom,e.programConfigurations.get(i.id),h,u)}function ki(e,r,i,n,o,s,a){const l=e.context.gl,c=i.paint.get("fill-pattern"),u=c&&c.constantOr(1);let h,d,p,f,m;a?(d=u&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",h=l.LINES):(d=u?"fillPattern":"fill",h=l.TRIANGLES);for(const g of n){const n=r.getTile(g);if(u&&!n.patternsLoaded())continue;const y=n.getBucket(i);if(!y)continue;e.prepareDrawTile();const v=y.programConfigurations.get(i.id),_=e.isTileAffectedByFog(g),b=e.getOrCreateProgram(d,{config:v,overrideFog:_});u&&(e.context.activeTexture.set(l.TEXTURE0),n.imageAtlasTexture&&n.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),v.updatePaintBuffers());const x=c.constantOr(null);if(x&&n.imageAtlas){const t=n.imageAtlas.patternPositions[x.toString()];t&&v.setConstantPatternPositions(t)}const w=e.translatePosMatrix(g.projMatrix,n,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor")),T=i.paint.get("fill-emissive-strength");if(a){f=y.indexBuffer2,m=y.segments2;const t=e.terrain&&e.terrain.renderingToTexture?e.terrain.drapeBufferSize:[l.drawingBufferWidth,l.drawingBufferHeight];p="fillOutlinePattern"===d&&u?Wr(w,T,e,n,t):qr(w,T,t)}else f=y.indexBuffer,m=y.segments,p=u?Hr(w,T,e,n):Gr(w,T);e.uploadCommonUniforms(e.context,b,g.toUnwrapped()),b.draw(e,h,o,e.stencilModeForClipping(g),s,t.ag.disabled,p,i.id,y.layoutVertexBuffer,f,m,i.paint,e.transform.zoom,v,void 0)}}function Ai(e,r,i,n,o,s,a,l){i.resetLayerRenderingStats(e);const c=e.context,u=c.gl,h=e.transform,d=i.paint.get("fill-extrusion-pattern"),p=d.constantOr(1),f=i.paint.get("fill-extrusion-opacity"),m=e.style.enable3dLights(),g=i.paint.get(m&&!p?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),y=[i.paint.get("fill-extrusion-ambient-occlusion-intensity"),g],v=i.layout.get("fill-extrusion-edge-radius"),_=v>0&&!i.paint.get("fill-extrusion-rounded-roof"),b=_?0:v,x="globe"===h.projection.name?t.b_():0,w="globe"===h.projection.name,T=w?t.a2(h.zoom):0,E=[t.ak(h.center.lng),t.al(h.center.lat)],S=i.paint.get("fill-extrusion-flood-light-color").toRenderColor(i.lut).toArray01().slice(0,3),P=i.paint.get("fill-extrusion-flood-light-intensity"),k=i.paint.get("fill-extrusion-vertical-scale"),A=0!==i.paint.get("fill-extrusion-line-width").constantOr(1),M=dr(e,i.paint.get("fill-extrusion-cutoff-fade-range")),C=i.paint.get("fill-extrusion-emissive-strength"),I=[];w&&I.push("PROJECTION_GLOBE_VIEW"),y[0]>0&&I.push("FAUX_AO"),_&&I.push("ZERO_ROOF_RADIUS"),l&&I.push("HAS_CENTROID"),P>0&&I.push("FLOOD_LIGHT"),M.shouldRenderCutoff&&I.push("RENDER_CUTOFF"),A&&I.push("RENDER_WALL_MODE");const O=(()=>{const e=i.paint.get("fill-extrusion-line-alignment");switch(e){case"inside":return 1;case"outside":return-1;case"center":return 0;default:return t.w(`Unsupported value for fill-extrusion-line-alignment: ${e}`),0}})();let L;const D="shadow"===e.renderPass,R=e.shadowRenderer,F=D&&!!R;e.shadowRenderer&&(e.shadowRenderer.useNormalOffset=!0);let B=[0,0,0];if(R){const t=e.style.directionalLight,r=e.style.ambientLight;t&&r&&(B=_r(e.style,t,r)),L=I.concat(["SHADOWS_SINGLE_CASCADE"])}const z=F?"fillExtrusionDepth":p?"fillExtrusionPattern":"fillExtrusion",j=i.getLayerRenderingStats();for(const m of n){const n=r.getTile(m),g=n.getBucket(i);if(!g||g.projection.name!==h.projection.name)continue;let v=!1;R&&(v=0===R.getMaxCascadeForTile(m.toUnwrapped()));const _=e.isTileAffectedByFog(m),F=g.programConfigurations.get(i.id),N=e.getOrCreateProgram(z,{config:F,defines:v?L:I,overrideFog:_});if(e.terrain&&e.terrain.setupElevationDraw(n,N,{useMeterToDem:!0}),!g.centroidVertexBuffer){const t=N.attributes.a_centroid_pos;void 0!==t&&u.vertexAttrib2f(t,0,0)}!D&&R&&R.setupShadows(n.tileID.toUnwrapped(),N,"vector-tile",n.tileID.overscaledZ),p&&(e.context.activeTexture.set(u.TEXTURE0),n.imageAtlasTexture&&n.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),F.updatePaintBuffers());const V=d.constantOr(null);if(V&&n.imageAtlas){const t=n.imageAtlas.patternPositions[V.toString()];t&&F.setConstantPatternPositions(t)}const U=i.paint.get("fill-extrusion-vertical-gradient"),$=1/g.tileToMeter;let G;if(D&&R){if(Di(n.tileID,g,e))continue;const t=R.calculateShadowPassMatrixFromTile(n.tileID.toUnwrapped());G=Ur(t,b,O,$,k)}else{const t=e.translatePosMatrix(m.expandedProjMatrix,n,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),r=h.projection.createInversionMatrix(h,m.canonical);G=p?$r(t,e,U,f,y,b,O,$,m,n,x,T,E,r,S,k):Vr(t,e,U,f,y,b,O,$,m,x,T,E,r,S,k,P,B,C)}e.uploadCommonUniforms(c,N,m.toUnwrapped(),null,M);let H=g.segments;if("mercator"===h.projection.name&&!D&&(H=g.getVisibleSegments(n.tileID,e.terrain,e.transform.getFrustum(0)),!H.get().length))continue;if(j)if(D)for(const t of H.get())j.numRenderedVerticesInShadowPass+=t.primitiveLength;else for(const t of H.get())j.numRenderedVerticesInTransparentPass+=t.primitiveLength;const q=[];(e.terrain||l)&&q.push(g.centroidVertexBuffer),w&&q.push(g.layoutVertexExtBuffer),A&&q.push(g.wallVertexBuffer),N.draw(e,c.gl.TRIANGLES,o,s,a,t.ag.backCCW,G,i.id,g.layoutVertexBuffer,g.indexBuffer,H,i.paint,e.transform.zoom,F,q)}e.shadowRenderer&&(e.shadowRenderer.useNormalOffset=!1)}function Mi(e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y,v,_){const b=e.context,x=b.gl,w=e.transform,T=e.transform.zoom,E=[],S=dr(e,i.paint.get("fill-extrusion-cutoff-fade-range"));"clear"===u?(E.push("CLEAR_SUBPASS"),_&&(E.push("CLEAR_FROM_TEXTURE"),b.activeTexture.set(x.TEXTURE0),_.bind(x.LINEAR,x.CLAMP_TO_EDGE))):"sdf"===u&&E.push("SDF_SUBPASS"),y&&E.push("HAS_CENTROID"),S.shouldRenderCutoff&&E.push("RENDER_CUTOFF");const P=i.layout.get("fill-extrusion-edge-radius"),k=(t,r,n,u,v)=>{const x=r.programConfigurations.get(i.id),w=e.isTileAffectedByFog(t),k=e.getOrCreateProgram("fillExtrusionGroundEffect",{config:x,defines:E,overrideFog:w}),A=((t,e,r,i,n,o,s,a,l,c,u)=>({u_matrix:e,u_opacity:r,u_ao_pass:i?1:0,u_meter_to_tile:n,u_ao:o,u_flood_light_intensity:s,u_flood_light_color:a,u_attenuation:l,u_edge_radius:c,u_fb:0,u_fb_size:u}))(0,u,h,c,v,[d,p*v],f,m,g,T>=17?0:P*v,_?_.size[0]:0),M=[];y&&M.push(r.hiddenByLandmarkVertexBuffer),e.uploadCommonUniforms(b,k,t.toUnwrapped(),null,S),k.draw(e,b.gl.TRIANGLES,o,s,a,l,A,i.id,r.vertexBuffer,r.indexBuffer,n,i.paint,T,x,M)};for(const o of n){const n=r.getTile(o),s=n.getBucket(i);if(!s||s.projection.name!==w.projection.name||!s.groundEffect||s.groundEffect&&!s.groundEffect.hasData())continue;const a=s.groundEffect,l=1/s.tileToMeter;{const t=e.translatePosMatrix(o.projMatrix,n,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),r=a.getDefaultSegment();k(o,a,r,t,l)}if(v)for(let s=0;s<4;s++){const a=t.b$[s](o),c=r.getTile(a);if(!c)continue;const u=c.getBucket(i);if(!u||u.projection.name!==w.projection.name||!u.groundEffect||u.groundEffect&&!u.groundEffect.hasData())continue;const h=u.groundEffect;let d,p;0===s?(d=[-t.a4,0,0],p=1):1===s?(d=[t.a4,0,0],p=0):2===s?(d=[0,-t.a4,0],p=3):(d=[0,t.a4,0],p=2);const f=h.regionSegments[p];if(!f)continue;const m=new Float32Array(16);t.ae.translate(m,o.projMatrix,d),k(o,h,f,e.translatePosMatrix(m,n,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),l)}}}function Ci(e,r,i,n,o,s,a){0===n.centroidVertexArray.length&&n.createCentroidsBuffer();const l=s?s.findDEMTileFor(i):null;if(!(l&&l.dem||a))return;const c=e=>new t.P(Math.ceil((e+t.c2)*t.c3),0),u=t=>{const e=r.getSource().minzoom,i=t=>{const e=r.getTileByID(t);if(e&&e.hasData())return e.getBucket(o)},n=[0,-1,1];for(const r of n){if(t.overscaledZ+r<e)continue;const n=i(t.calculateScaledKey(t.overscaledZ+r));if(n)return n}},h=[0,0,0],d=(e,r)=>(h[0]=Math.min(e.min.y,r.min.y),h[1]=Math.max(e.max.y,r.max.y),h[2]=t.a4-r.min.x>e.max.x?r.min.x-t.a4:e.max.x,h),p=(e,r)=>(h[0]=Math.min(e.min.x,r.min.x),h[1]=Math.max(e.max.x,r.max.x),h[2]=t.a4-r.min.y>e.max.y?r.min.y-t.a4:e.max.y,h),f=[(t,e)=>d(t,e),(t,e)=>d(e,t),(t,e)=>p(t,e),(t,e)=>p(e,t)],m=(e,r,n,o,a,c,u)=>{if(!s)return 0;const h=[[c?n:e,c?e:n,0],[c?n:r,c?r:n,0]],d=u<0?t.a4+u:u,p=[c?d:(e+r)/2,c?(e+r)/2:d,0];return 0===n&&u<0||0!==n&&u>0?s.getForTilePoints(a,[p],!0,o):h.push(p),s.getForTilePoints(i,h,!0,l),Math.max(h[0][2],h[1][2],p[2])/s.exaggeration()};for(let e=0;e<4;e++){const r=n.borderFeatureIndices[e];if(0===r.length)continue;const o=t.b$[e](i),l=u(o);if(!(l&&l instanceof t.c0))continue;if(n.borderDoneWithNeighborZ[e]===l.canonical.z)continue;0===l.centroidVertexArray.length&&l.createCentroidsBuffer();const h=s?s.findDEMTileFor(o):null;if(!(h&&h.dem||a))continue;const d=(e<2?1:5)-e,p=l.borderDoneWithNeighborZ[d]!==n.canonical.z,v=l.borderFeatureIndices[d];let _=0;if(n.canonical.z!==l.canonical.z){for(const t of r)n.showCentroid(n.featuresOnBorder[t]);if(p)for(const t of v)l.showCentroid(l.featuresOnBorder[t]);n.borderDoneWithNeighborZ[e]=l.canonical.z,l.borderDoneWithNeighborZ[d]=n.canonical.z}for(const i of r){const r=n.featuresOnBorder[i],s=n.centroidData[r.centroidDataIndex],u=r.borders[e];let p;for(;_<v.length;){p=l.featuresOnBorder[v[_]];const t=p.borders[d];if(t[1]>u[0]+3||t[0]>u[0]-3)break;l.showCentroid(p),_++}if(p&&_<v.length){const i=_;let b=0;for(;!(p.borders[d][0]>u[1]-3)&&(b++,++_!==v.length);)p=l.featuresOnBorder[v[_]];if(p=l.featuresOnBorder[v[i]],b>1){const t=p.borders[d];Math.abs(u[0]-t[0])<3&&Math.abs(u[1]-t[1])<3&&(b=1,_=i+1)}else if(0===b){n.showCentroid(r);continue}const x=l.centroidData[p.centroidDataIndex];a&&1===b&&(((g=s).flags|(y=x).flags)&t.c1?(g.flags|=t.c1,y.flags|=t.c1):(g.flags&=~t.c1,y.flags&=~t.c1));const w=r.intersectsCount()>1||p.intersectsCount()>1;if(b>1)_=i,s.centroidXY=x.centroidXY=new t.P(0,0);else if(h&&h.dem&&!w){const r=f[e](s,x),i=e%2?t.a4-1:0,n=m(r[0],Math.min(t.a4-1,r[1]),i,h,o,e<2,r[2]);s.centroidXY=x.centroidXY=c(n)}else w?s.centroidXY=x.centroidXY=new t.P(0,0):(s.centroidXY=n.encodeBorderCentroid(r),x.centroidXY=l.encodeBorderCentroid(p));n.writeCentroidToBuffer(s),l.writeCentroidToBuffer(x)}else n.showCentroid(r)}n.borderDoneWithNeighborZ[e]=l.canonical.z,l.borderDoneWithNeighborZ[d]=n.canonical.z}var g,y;(n.needsCentroidUpdate||!n.centroidVertexBuffer&&0!==n.centroidVertexArray.length)&&n.uploadCentroid(e)}const Ii=[1,0,0],Oi=[0,1,0],Li=[0,0,1];function Di(e,r,i){const n=i.transform,o=i.shadowRenderer;if(!o)return!0;const s=e.toUnwrapped(),a=n.tileSize*o._cascades[i.currentShadowCascade].scale;let l=r.maxHeight;if(n.elevation){const t=n.elevation.getMinMaxForTile(e);t&&(l+=t.max)}const c=[...o.shadowDirection];c[2]=-c[2];const u=o.computeSimplifiedTileShadowVolume(s,l,a,c);if(!u)return!1;const h=[Ii,Oi,Li,c,[c[0],0,c[2]],[0,c[1],c[2]]],d="globe"===n.projection.name,p=n.scaleZoom(a),f=t.aM.fromInvProjectionMatrix(n.invProjMatrix,n.worldSize,p,!d),m=o.getCurrentCascadeFrustum();return 0===f.intersectsPrecise(u.vertices,u.planes,h)||0===m.intersectsPrecise(u.vertices,u.planes,h)}function Ri(e){return[e[0]*t.c4,e[1]*t.c4,e[2]*t.c4,0]}function Fi(e,r,i,n,o,s,a,l,c){const u=n.getSource(),h=i.globeSharedBuffers;if(!h)return;let d,p,f;if(r&&(d=n.getTile(r)),u instanceof t.bo?(p=u.texture,f=t.bj(0,0,i.transform)):d&&r&&(p=d.texture,f=t.bj(r.canonical.z,r.canonical.x,i.transform)),!p||!f)return;e||(f=t.ae.scale(t.ae.create(),f,[1,-1,1]));const m=i.context,g=m.gl,y="nearest"===o.paint.get("raster-resampling")?g.NEAREST:g.LINEAR,v=i.colorModeForDrapableLayerRenderPass(s),_=a.defines;_.push("GLOBE_POLES");const b=new t.af(g.LEQUAL,t.af.ReadWrite,i.depthRangeFor3D),x=Float32Array.from(i.transform.expandedFarZProjMatrix),w=Float32Array.from(t.bh(t.bi(new t.aO(0,0,0))));i.terrain&&i.terrain.prepareDrawTile(),m.activeTexture.set(g.TEXTURE0),p.bind(y,g.CLAMP_TO_EDGE),m.activeTexture.set(g.TEXTURE1),p.bind(y,g.CLAMP_TO_EDGE),p.useMipmap&&m.extTextureFilterAnisotropic&&i.transform.pitch>20&&g.texParameterf(g.TEXTURE_2D,m.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,m.extTextureFilterAnisotropicMax);const[T,E,S,P]=r?h.getPoleBuffers(r.canonical.z,!1):h.getPoleBuffers(0,!0),k=o.paint.get("raster-elevation");let A;e?(A=T,i.renderDefaultNorthPole=0!==k):(A=E,i.renderDefaultSouthPole=0!==k);const M=Ri(a.mix),C=((t,e,r,i,n,o,s,a,l,c,u,h,d)=>ti(t,e,r,new Float32Array(16),new Float32Array(9),[0,0],i,[0,0],[0,0,0,0],1,{opacity:1,mix:0},o,[0,0]||0,a,2,c,u,h,1,0,d))(x,w,f,t.a2(i.transform.zoom),0,o,0,k,0,M,a.offset,a.range,s),I=i.getOrCreateProgram("raster",{defines:_});i.uploadCommonUniforms(m,I,null),I.draw(i,g.TRIANGLES,b,c,v,l,C,o.id,A,S,P)}function Bi(t){const e=t._nearZ,r=t.projection.farthestPixelDistance(t),i=r-e,n=.2*t.height,o=e+n;return[e,r,(o-n-e)/i,(o-e)/i]}function zi(e,r,i,n){if(e)return r instanceof Ar&&e instanceof t.c5?r.getTextureDescriptor(e,i,!0):{texture:e.texture,mix:Ri(n.mix),offset:n.offset,buffer:0,tileSize:1}}function ji(e,r,i){if(!e)return null;const n=r.getTextureDescriptor(e,i,!0);if(!n)return null;let{texture:o,mix:s,offset:a,tileSize:l,buffer:c,format:u}=n;if(!o||!u)return null;let h=!1;return"uint32"===u&&(h=!0,s[3]=0,s=Jr(t.c6,s,[0,i.paint.get("raster-particle-max-speed")]),a=Qr(t.c6,a,[0,i.paint.get("raster-particle-max-speed")])),{texture:o,textureOffset:[c/(l+2*c),l/(l+2*c)],tileSize:l,scalarData:h,scale:s,offset:a,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[u]]}}function Ni(t){const e=t._nearZ,r=t.projection.farthestPixelDistance(t),i=r-e,n=.2*t.height,o=e+n;return[e,r,(o-n-e)/i,(o-e)/i]}const Vi=new t.C(1,0,0,1),Ui=new t.C(0,1,0,1),$i=new t.C(0,0,1,1),Gi=new t.C(1,0,1,1),Hi=new t.C(0,1,1,1);function qi(e,r,i,n,o,s,a){const l=e.context,c=e.transform,u=l.gl,h="globe"===c.projection.name,d=h?["PROJECTION_GLOBE_VIEW"]:[];let p=t.ae.clone(i.projMatrix);if(h&&t.a2(c.zoom)>0){const e=t.c7(i.canonical,c),r=t.c8(e);p=t.ae.multiply(new Float32Array(16),c.globeMatrix,r),t.ae.multiply(p,c.projMatrix,p)}const f=t.ae.create();f[12]+=2*o/(t.e.devicePixelRatio*c.width),f[13]+=2*s/(t.e.devicePixelRatio*c.height),t.ae.multiply(p,f,p);const m=e.getOrCreateProgram("debug",{defines:d}),g=r.getTileByID(i.key);e.terrain&&e.terrain.setupElevationDraw(g,m);const y=t.af.disabled,v=t.ah.disabled,_=e.colorModeForRenderPass(),b="$debug";l.activeTexture.set(u.TEXTURE0),e.emptyTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),h?g._makeGlobeTileDebugBuffers(e.context,c):g._makeDebugTileBoundsBuffers(e.context,c.projection);const x=g._tileDebugBuffer||e.debugBuffer,w=g._tileDebugIndexBuffer||e.debugIndexBuffer,T=g._tileDebugSegments||e.debugSegments;if(m.draw(e,u.LINE_STRIP,y,v,_,t.ag.disabled,Xr(p,n),b,x,w,T,null,null,null,[g._globeTileDebugBorderBuffer]),a){const t=g.latestRawTileData,r=Math.floor((t&&t.byteLength||0)/1024);let n=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(n+=` => ${i.overscaledZ}`),n+=` ${g.state}`,n+=` ${r}kb`,function(t,e){t.initDebugOverlayCanvas();const r=t.debugOverlayCanvas,i=t.context.gl,n=t.debugOverlayCanvas.getContext("2d");n.clearRect(0,0,r.width,r.height),n.shadowColor="white",n.shadowBlur=2,n.lineWidth=1.5,n.strokeStyle="white",n.textBaseline="top",n.font="bold 36px Open Sans, sans-serif",n.fillText(e,5,5),n.strokeText(e,5,5),t.debugOverlayTexture.update(r),t.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}(e,n)}const E=r.getTile(i).tileSize,S=512/Math.min(E,512)*(i.overscaledZ/c.zoom)*.5,P=g._tileDebugTextBuffer||e.debugBuffer,k=g._tileDebugTextIndexBuffer||e.quadTriangleIndexBuffer,A=g._tileDebugTextSegments||e.debugSegments;m.draw(e,u.TRIANGLES,y,v,t.a.alphaBlended,t.ag.disabled,Xr(p,t.C.transparent,S),b,P,k,A,null,null,null,[g._globeTileDebugTextBuffer])}function Wi(t,e,r,i){Xi(t,0,e+r/2,t.transform.width,r,i)}function Zi(t,e,r,i){Xi(t,e-r/2,0,r,t.transform.height,i)}function Xi(e,r,i,n,o,s){const a=e.context,l=a.gl;l.enable(l.SCISSOR_TEST),l.scissor(r*t.e.devicePixelRatio,i*t.e.devicePixelRatio,n*t.e.devicePixelRatio,o*t.e.devicePixelRatio),a.clear({color:s}),l.disable(l.SCISSOR_TEST)}const Yi=t.c9([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ki}=Yi;function Ji(t,e,r,i){t.emplaceBack(e,r,i)}class Qi{constructor(e){this.vertexArray=new t.ca,this.indices=new t.bw,Ji(this.vertexArray,-1,-1,1),Ji(this.vertexArray,1,-1,1),Ji(this.vertexArray,-1,1,1),Ji(this.vertexArray,1,1,1),Ji(this.vertexArray,-1,-1,-1),Ji(this.vertexArray,1,-1,-1),Ji(this.vertexArray,-1,1,-1),Ji(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=e.createVertexBuffer(this.vertexArray,Ki),this.indexBuffer=e.createIndexBuffer(this.indices),this.segment=t.b.simpleSegment(0,0,36,12)}}function tn(e,r,i,n,o,s){const a=e.context.gl,l=r.paint.get("sky-atmosphere-color"),c=r.paint.get("sky-atmosphere-halo-color"),u=r.paint.get("sky-atmosphere-sun-intensity"),h=((t,e,r,i,n)=>({u_matrix_3f:t,u_sun_direction:e,u_sun_intensity:r,u_color_tint_r:[i.r,i.g,i.b,i.a],u_color_tint_m:[n.r,n.g,n.b,n.a],u_luminance:5e-5}))(t.bE.fromMat4(t.bE.create(),n),o,u,l,c);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+s,r.skyboxTexture,0),i.draw(e,a.TRIANGLES,t.af.disabled,t.ah.disabled,t.a.unblended,t.ag.frontCW,h,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const en=t.c9([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class rn{constructor(e){const r=new t.cb;r.emplaceBack(-1,1,1,0,0),r.emplaceBack(1,1,1,1,0),r.emplaceBack(1,-1,1,1,1),r.emplaceBack(-1,-1,1,0,1);const i=new t.bw;i.emplaceBack(0,1,2),i.emplaceBack(2,3,0),this.vertexBuffer=e.createVertexBuffer(r,en.members),this.indexBuffer=e.createIndexBuffer(i),this.segments=t.b.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const nn=t.c9([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class on{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class sn{constructor(e){this.colorModeAlphaBlendedWriteRGB=new t.a([t.cc,t.cd,t.cc,t.cd],t.C.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new t.a([t.cc,t.ce,t.cc,t.ce],t.C.transparent,[!1,!1,!1,!0]),this.params=new on,this.updateNeeded=!0,e.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},(()=>{this.updateNeeded=!0})),e.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),e.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0})),e.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0}))}update(e){const r=e.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new rn(r);const e=this.params.sizeRange,i=this.params.intensityRange,n=function(e){const r=t.ch(30),i=[];for(let n=0;n<e;++n){const e=2*Math.PI*r(),n=Math.acos(1-2*r())-.5*Math.PI;i.push(t.$.fromValues(Math.cos(n)*Math.cos(e),Math.cos(n)*Math.sin(e),Math.sin(n)))}return i}(this.params.starsCount),o=t.ch(300),s=new t.cf,a=new t.bw;let l=0;for(let r=0;r<n.length;++r){const c=t.$.scale([],n[r],200),u=Math.max(0,1+.01*e*(1*o()-.5)),h=Math.max(0,1+.01*i*(1*o()-.5));s.emplaceBack(c[0],c[1],c[2],-1,-1,u,h),s.emplaceBack(c[0],c[1],c[2],1,-1,u,h),s.emplaceBack(c[0],c[1],c[2],1,1,u,h),s.emplaceBack(c[0],c[1],c[2],-1,1,u,h),a.emplaceBack(l+0,l+1,l+2),a.emplaceBack(l+0,l+2,l+3),l+=4}this.starsVx=r.createVertexBuffer(s,nn.members),this.starsIdx=r.createIndexBuffer(a),this.starsSegments=t.b.simpleSegment(0,0,s.length,a.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(e,r){const i=e.context,n=i.gl,o=e.transform,s=new t.af(n.LEQUAL,t.af.ReadOnly,[0,1]),a=t.a2(o.zoom),l=e.style.getLut(r.scope),c=r.properties.get("color").toRenderColor(l).toArray01(),u=r.properties.get("high-color").toRenderColor(l).toArray01(),h=r.properties.get("space-color").toRenderColor(l).toArray01PremultipliedAlpha(),d=5e-4,p=t.cg(r.properties.get("horizon-blend"),0,1,d,.25),f=t.bc(e,i,o)&&p===d?o.worldSize/(2*Math.PI*1.025)-1:o.globeRadius,m=e.frameCounter/1e3%1,g=t.$.length(o.globeCenterInViewSpace),y=Math.sqrt(Math.pow(g,2)-Math.pow(f,2)),v=Math.acos(y/g),_=r=>{const l="globe"===o.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];r&&l.push("ALPHA_PASS");const d=e.getOrCreateProgram("globeAtmosphere",{defines:l}),f=((t,e,r,i,n,o,s,a,l,c,u,h)=>({u_frustum_tl:t,u_frustum_tr:e,u_frustum_br:r,u_frustum_bl:i,u_horizon:n,u_transition:o,u_fadeout_range:s,u_color:a,u_high_color:l,u_space_color:c,u_temporal_offset:u,u_horizon_angle:h}))(o.frustumCorners.TL,o.frustumCorners.TR,o.frustumCorners.BR,o.frustumCorners.BL,o.frustumCorners.horizon,a,p,c,u,h,m,v);e.uploadCommonUniforms(i,d);const g=this.atmosphereBuffer;g&&d.draw(e,n.TRIANGLES,s,t.ah.disabled,r?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,t.ag.backCW,f,r?"atmosphere_glow_alpha":"atmosphere_glow",g.vertexBuffer,g.indexBuffer,g.segments)};_(!1),_(!0)}drawStars(e,r){const i=t.au(r.properties.get("star-intensity"),0,1);if(0===i)return;const n=e.context,o=n.gl,s=e.transform,a=e.getOrCreateProgram("stars"),l=t.aw.identity([]);t.aw.rotateX(l,l,-s._pitch),t.aw.rotateZ(l,l,-s.angle),t.aw.rotateX(l,l,t.ac(s._center.lat)),t.aw.rotateY(l,l,-t.ac(s._center.lng));const c=t.ae.fromQuat(new Float32Array(16),l),u=t.ae.multiply([],s.starsProjMatrix,c),h=t.bE.fromMat4([],c),d=t.bE.invert([],h),p=[0,1,0];t.$.transformMat3(p,p,d),t.$.scale(p,p,this.params.sizeMultiplier);const f=[1,0,0];t.$.transformMat3(f,f,d),t.$.scale(f,f,this.params.sizeMultiplier);const m=(g=p,y=f,v=i,{u_matrix:Float32Array.from(u),u_up:g,u_right:y,u_intensity_multiplier:v});var g,y,v;e.uploadCommonUniforms(n,a),this.starsVx&&this.starsIdx&&a.draw(e,o.TRIANGLES,t.af.disabled,t.ah.disabled,this.colorModeAlphaBlendedWriteRGB,t.ag.disabled,m,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function an(e,r){const i=[...e],n=r.cameraWorldSizeForFog/r.worldSize,o=t.ae.identity([]);return t.ae.scale(o,o,[n,n,1]),t.ae.multiply(i,o,i),t.ae.multiply(i,r.worldToFogMatrix,i),i}function ln(e,r,i,n,o){const s=i.material,a=n.context,{baseColorTexture:l,metallicRoughnessTexture:c}=s.pbrMetallicRoughness,{normalTexture:u,occlusionTexture:h,emissionTexture:d}=s;function p(t,r,i){if(t&&(e.push(r),a.activeTexture.set(a.gl.TEXTURE0+i),t.gfxTexture)){const{minFilter:e,magFilter:r,wrapS:i,wrapT:n}=t.sampler;t.gfxTexture.bindExtraParam(e,r,i,n)}}p(l,"HAS_TEXTURE_u_baseColorTexture",hr.BaseColor),p(c,"HAS_TEXTURE_u_metallicRoughnessTexture",hr.MetallicRoughness),p(u,"HAS_TEXTURE_u_normalTexture",hr.Normal),p(h,"HAS_TEXTURE_u_occlusionTexture",hr.Occlusion),p(d,"HAS_TEXTURE_u_emissionTexture",hr.Emission),o&&(o.texture||(o.texture=new t.cj(n.context,o.image,[o.image.height,o.image.height,o.image.height],a.gl.RGBA)),a.activeTexture.set(a.gl.TEXTURE0+hr.LUT),o.texture&&o.texture.bind(a.gl.LINEAR,a.gl.CLAMP_TO_EDGE),e.push("APPLY_LUT_ON_GPU")),i.texcoordBuffer&&(e.push("HAS_ATTRIBUTE_a_uv_2f"),r.push(i.texcoordBuffer)),i.colorBuffer&&(e.push(12===i.colorBuffer.itemSize?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),r.push(i.colorBuffer)),i.normalBuffer&&(e.push("HAS_ATTRIBUTE_a_normal_3f"),r.push(i.normalBuffer)),i.pbrBuffer&&(e.push("HAS_ATTRIBUTE_a_pbr"),e.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),r.push(i.pbrBuffer)),"OPAQUE"!==s.alphaMode&&"MASK"!==s.alphaMode||e.push("UNPREMULT_TEXTURE_IN_SHADER"),s.defined||e.push("DIFFUSE_SHADED"),e.push("USE_STANDARD_DERIVATIVES")}function cn(e,r,i,n,o,s){const a=i.paint.get("model-opacity"),l=r.context,c=new t.af(r.context.gl.LEQUAL,t.af.ReadWrite,r.depthRangeFor3D),u=r.transform,h=e.mesh,d=h.material,p=d.pbrMetallicRoughness,f=r.style.fog;let m;m="pixels"===r.transform.projection.zAxisUnit?[...e.nodeModelMatrix]:t.ae.multiply([],n.zScaleMatrix,e.nodeModelMatrix),t.ae.multiply(m,n.negCameraPosMatrix,m);const g=t.ae.invert([],m);t.ae.transpose(g,g);const y=i.paint.get("model-emissive-strength").constantOr(0),v=pi(new Float32Array(e.worldViewProjection),new Float32Array(m),new Float32Array(g),null,r,a,p.baseColorFactor.toRenderColor(null),d.emissiveFactor,p.metallicFactor,p.roughnessFactor,d,y,i),_={defines:[]},b=[];ln(_.defines,b,h,r,i.lut);const x=r.shadowRenderer;x&&(x.useNormalOffset=!1);let w=null;if(f){const t=an(e.nodeModelMatrix,r.transform);if(w=new Float32Array(t),"globe"!==u.projection.name){const e=h.aabb.min,r=h.aabb.max,[i,n]=f.getOpacityForBounds(t,e[0],e[1],r[0],r[1]);_.overrideFog=i>=Qt||n>=Qt}}const T=dr(r,i.paint.get("model-cutoff-fade-range"));T.shouldRenderCutoff&&_.defines.push("RENDER_CUTOFF");const E=r.getOrCreateProgram("model",_);r.uploadCommonUniforms(l,E,null,w,T),"shadow"!==r.renderPass&&x&&x.setupShadowsFromMatrix(e.nodeModelMatrix,E),E.draw(r,l.gl.TRIANGLES,c,o,s,h.material.doubleSided?t.ag.disabled:t.ag.backCCW,v,i.id,h.vertexBuffer,h.indexBuffer,h.segments,i.paint,r.transform.zoom,void 0,b)}function un(e,r,i,n,o,s,a){let l;l="globe"===e.projection.name?t.ck(i,e):[...i],t.ae.multiply(l,l,r.matrix);const c=t.ae.multiply([],n,l);if(r.meshes)for(const e of r.meshes){if("BLEND"!==e.material.alphaMode){a.push({mesh:e,depth:0,modelIndex:o,worldViewProjection:c,nodeModelMatrix:l});continue}const r=t.$.transformMat4([],e.centroid,c);r[2]>0&&s.push({mesh:e,depth:r[2],modelIndex:o,worldViewProjection:c,nodeModelMatrix:l})}if(r.children)for(const t of r.children)un(e,t,i,n,o,s,a)}function hn(e,r,i,n){const o=i.shadowRenderer;if(!o)return;const s=o.getShadowPassDepthMode(),a=o.getShadowPassColorMode(),l=o.calculateShadowPassMatrixFromMatrix(r),c=fi(l);i.getOrCreateProgram("modelDepth",{defines:i._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(i,i.context.gl.TRIANGLES,s,t.ah.disabled,a,t.ag.backCCW,c,n.id,e.vertexBuffer,e.indexBuffer,e.segments,n.paint,i.transform.zoom,void 0,void 0)}function dn(e,r,i){const n=r.updateZoomBasedPaintProperties(),o=function(e,r,i){let n,o,s,a=e.terrain?e.terrain.exaggeration():0;if(e.terrain&&a>0){const r=e.terrain,o=r.findDEMTileFor(i);o&&o.dem?n=t.cm.create(r,i,o):a=0}if(0===a&&(r.terrainElevationMin=0,r.terrainElevationMax=0),a===r.validForExaggeration&&(0===a||n&&n._demTile&&n._demTile.tileID===r.validForDEMTile.id&&n._dem._timestamp===r.validForDEMTile.timestamp))return!1;for(const t in r.instancesPerModel){const e=r.instancesPerModel[t];for(let t=0;t<e.instancedDataArray.length;++t){const i=(n?a*n.getElevationAt(0|e.instancedDataArray.float32[16*t],0|e.instancedDataArray.float32[16*t+1],!0,!0):0)+e.instancesEvaluatedElevation[t];e.instancedDataArray.float32[16*t+6]=i,o=o?Math.min(r.terrainElevationMin,i):i,s=s?Math.max(r.terrainElevationMax,i):i}}return r.terrainElevationMin=o||0,r.terrainElevationMax=s||0,r.validForExaggeration=a,r.validForDEMTile=n&&n._demTile?{id:n._demTile.tileID,timestamp:n._dem._timestamp}:{id:void 0,timestamp:0},!0}(e,r,i);(n||o)&&(r.uploaded=!1,r.upload(e.context))}const pn={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new t.b8([0,0,0],[t.a4,t.a4,0])};function fn(e,r){const i=1<<e.canonical.z,n=r.getFreeCameraOptions().position,o=r.elevation,s=e.canonical.x/i,a=(e.canonical.x+1)/i,l=e.canonical.y/i,c=(e.canonical.y+1)/i;let u=r._centerAltitude;if(o){const t=o.getMinMaxForTile(e);t&&t.max>u&&(u=t.max)}const h=t.au(n.x,s,a)-n.x,d=t.au(n.y,l,c)-n.y,p=t.ay(u,r.center.lat)-n.z;return r._zoomFromMercatorZ(Math.sqrt(h*h+d*d+p*p))}function mn(e,r,i,n,o,s,a){const l=e.context,c="shadow"===e.renderPass,u=e.shadowRenderer,h=c&&u?u.getShadowPassDepthMode():new t.af(l.gl.LEQUAL,t.af.ReadWrite,e.depthRangeFor3D),d=e.isTileAffectedByFog(s);if(i.meshes)for(const p of i.meshes){const f=["MODEL_POSITION_ON_GPU"],m=[];let g,y,v;n.instancedDataArray.length>20&&f.push("INSTANCED_ARRAYS");const _=dr(e,r.paint.get("model-cutoff-fade-range"));if(_.shouldRenderCutoff&&f.push("RENDER_CUTOFF"),c&&u)g=e.getOrCreateProgram("modelDepth",{defines:f}),y=fi(a.shadowTileMatrix,a.shadowTileMatrix,Float32Array.from(i.matrix)),v=u.getShadowPassColorMode();else{ln(f,m,p,e,r.lut),g=e.getOrCreateProgram("model",{defines:f,overrideFog:d});const n=p.material,c=n.pbrMetallicRoughness,h=r.paint.get("model-opacity"),b=r.paint.get("model-emissive-strength").constantOr(0);y=pi(s.expandedProjMatrix,Float32Array.from(i.matrix),new Float32Array(16),null,e,h,c.baseColorFactor.toRenderColor(null),n.emissiveFactor,c.metallicFactor,c.roughnessFactor,n,b,r,o),u&&(a.shadowUniformsInitialized?g.setShadowUniformValues(l,u.getShadowUniformValues()):(u.setupShadows(s.toUnwrapped(),g,"model-tile",s.overscaledZ),a.shadowUniformsInitialized=!0)),v=_.shouldRenderCutoff||h<1||"OPAQUE"!==n.alphaMode?t.a.alphaBlended:t.a.unblended}e.uploadCommonUniforms(l,g,s.toUnwrapped(),null,_);const b=p.material.doubleSided?t.ag.disabled:t.ag.backCCW;if(n.instancedDataArray.length>20)m.push(n.instancedDataBuffer),g.draw(e,l.gl.TRIANGLES,h,t.ah.disabled,v,b,y,r.id,p.vertexBuffer,p.indexBuffer,p.segments,r.paint,e.transform.zoom,void 0,m,n.instancedDataArray.length);else{const i=c?"u_instance":"u_normal_matrix";for(let o=0;o<n.instancedDataArray.length;++o)y[i]=new Float32Array(n.instancedDataArray.arrayBuffer,64*o,16),g.draw(e,l.gl.TRIANGLES,h,t.ah.disabled,v,b,y,r.id,p.vertexBuffer,p.indexBuffer,p.segments,r.paint,e.transform.zoom,void 0,m)}}if(i.children)for(const t of i.children)mn(e,r,t,n,o,s,a)}const gn=[1,-1,1];function yn(e,r,i,n){if(!i.modelManager)return!0;const o=i.modelManager;if(!i.shadowRenderer)return!0;const s=i.shadowRenderer,a=r.aabb;let l=!0,c=e.maxHeight;if(0===c){let t=0;for(const r in e.instancesPerModel){const e=o.getModel(r,n);e?t=Math.max(t,Math.max(Math.max(e.aabb.max[0],e.aabb.max[1]),e.aabb.max[2])):l=!1}c=e.maxScale*t*1.41+e.maxVerticalOffset,l&&(e.maxHeight=c)}a.max[2]=c,a.min[2]+=e.terrainElevationMin,a.max[2]+=e.terrainElevationMax,t.$.transformMat4(a.min,a.min,r.tileMatrix),t.$.transformMat4(a.max,a.max,r.tileMatrix);const u=a.intersects(s.getCurrentCascadeFrustum());return 0===i.currentShadowCascade&&(e.isInsideFirstShadowMapFrustum=2===u),0===u}function vn(e,r){const i=e.uniformValues.u_cutoff_params[0],n=e.uniformValues.u_cutoff_params[1],o=e.uniformValues.u_cutoff_params[2],s=e.uniformValues.u_cutoff_params[3];return n===i||s===o?1:t.au(((r-i)/(n-i)-o)/(s-o),0,1)}function _n(e,r,i,n){if(r.pitch<20)return 1;const o=r.getWorldToCameraMatrix(),s=t.ae.multiply([],o,e),a=[...i.min,1];let l=t.aB.transformMat4([],a,s),c=l,u=l;a[1]=i.max[1],l=t.aB.transformMat4([],a,s),c=l[1]<c[1]?l:c,u=l[1]>u[1]?l:u,a[0]=i.max[0],l=t.aB.transformMat4([],a,s),c=l[1]<c[1]?l:c,u=l[1]>u[1]?l:u,a[1]=i.min[1],l=t.aB.transformMat4([],a,s),c=l[1]<c[1]?l:c,u=l[1]>u[1]?l:u;const h=t.au(n[0],0,1),d=100*r.pixelsPerMeter*t.au(n[1],0,1),p=t.au(n[2],0,1),f=t.$.lerp([],c,u,h),m=Math.tan(.5*r.fovX),g=-f[2]*m;if(0===d)return f[1]<-Math.abs(g)?p:1;const y=(-Math.abs(g)-f[1])/d,v=(t,e,r)=>(1-r)*t+r*e,_=t.au(v(1,p,y),p,1);return v(1,_,t.au((r.pitch-20)/20,0,1))}class bn{}class xn{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(e,r,i){{const t=this._storage.get(r.id);if(t)return t.lastUsedFrameIdx=e,t.buf}const n=i.gl,o=n.getBufferParameter(n.ELEMENT_ARRAY_BUFFER,n.BUFFER_SIZE),s=new ArrayBuffer(o),a=new Int16Array(s);n.getBufferSubData(n.ELEMENT_ARRAY_BUFFER,0,new Int16Array(s));const l=new t.co;for(let t=0;t<o/2;t+=3){const e=a[t],r=a[t+1],i=a[t+2];l.emplaceBack(e,r),l.emplaceBack(r,i),l.emplaceBack(i,e)}const c=i.bindVertexArrayOES.current,u=new bn;return u.buf=new t.I(i,l),u.lastUsedFrameIdx=e,this._storage.set(r.id,u),i.bindVertexArrayOES.set(c),u.buf}update(t){for(const[e,r]of this._storage)t-r.lastUsedFrameIdx>30&&(r.buf.destroy(),this._storage.delete(e))}destroy(){for(const[t,e]of this._storage)e.buf.destroy(),this._storage.delete(t)}}class wn{constructor(t){this.occluderSize=30,this.depthOffset=-1e-4,t.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),t.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Tn={symbol:function(e,r,i,n,o){if("translucent"!==e.renderPass)return;const s=t.ah.disabled,a=e.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(e,r,i,n,o,s,a){const l=r.transform,c="map"===o,u="map"===s;for(const r of e){const e=n.getTile(r),o=e.getBucket(i);if(!o||!o.text||!o.text.segments.get().length)continue;const s=t.aE(o.textSizeData,l.zoom),h=vi(r,o.getProjection(),l),d=l.calculatePixelsToTileUnitsMatrix(e),p=We(h,e.tileID.canonical,u,c,l,o.getProjection(),d),f=o.hasIconTextFit()&&o.hasIconData();if(s){const i=Math.pow(2,l.zoom-e.tileID.overscaledZ);Ei(o,c,u,a,t.bQ,l,p,r,i,s,f)}}}(n,e,i,r,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),o);const l=0!==i.paint.get("icon-opacity").constantOr(1),c=0!==i.paint.get("text-opacity").constantOr(1);void 0!==i.layout.get("symbol-sort-key").constantOr(1)&&(l||c)?Si(e,r,i,n,s,a):(l&&Si(e,r,i,n,s,a,{onlyIcons:!0}),c&&Si(e,r,i,n,s,a,{onlyText:!0})),r.map.showCollisionBoxes&&(bi(e,r,i,n,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),bi(e,r,i,n,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))},circle:function(e,r,i,n){if("translucent"!==e.renderPass)return;const o=i.paint.get("circle-opacity"),s=i.paint.get("circle-stroke-width"),a=i.paint.get("circle-stroke-opacity"),l=void 0!==i.layout.get("circle-sort-key").constantOr(1),c=i.paint.get("circle-emissive-strength");if(0===o.constantOr(1)&&(0===s.constantOr(1)||0===a.constantOr(1)))return;const u=e.context,h=u.gl,d=e.transform,p=e.depthModeForSublayer(0,t.af.ReadOnly),f=t.ah.disabled,m=e.colorModeForDrapableLayerRenderPass(c),g="globe"===d.projection.name,y=[t.ak(d.center.lng),t.al(d.center.lat)],v=[];for(let o=0;o<n.length;o++){const s=n[o],a=r.getTile(s),c=a.getBucket(i);if(!c||c.projection.name!==d.projection.name)continue;const u=c.programConfigurations.get(i.id),h=t.bT(i),p=e.isTileAffectedByFog(s);g&&h.push("PROJECTION_GLOBE_VIEW"),h.push("DEPTH_D24"),e.terrain&&d.depthOcclusionForSymbolsAndCircles&&h.push("DEPTH_OCCLUSION");const f=e.getOrCreateProgram("circle",{config:u,defines:h,overrideFog:p}),m=c.layoutVertexBuffer,_=c.globeExtVertexBuffer,b=c.indexBuffer,x=d.projection.createInversionMatrix(d,s.canonical),w={programConfiguration:u,program:f,layoutVertexBuffer:m,globeExtVertexBuffer:_,indexBuffer:b,uniformValues:t.bU(e,s,a,x,y,i),tile:a};if(l){const e=c.segments.get();for(const r of e)v.push({segments:new t.b([r]),sortKey:r.sortKey,state:w})}else v.push({segments:c.segments,sortKey:0,state:w})}l&&v.sort(((t,e)=>t.sortKey-e.sortKey));const _={useDepthForOcclusion:d.depthOcclusionForSymbolsAndCircles};for(const r of v){const{programConfiguration:n,program:o,layoutVertexBuffer:s,globeExtVertexBuffer:a,indexBuffer:l,uniformValues:c,tile:g}=r.state,y=r.segments;e.terrain&&e.terrain.setupElevationDraw(g,o,_),e.uploadCommonUniforms(u,o,g.tileID.toUnwrapped()),o.draw(e,h.TRIANGLES,p,f,m,t.ag.disabled,c,i.id,s,l,y,i.paint,d.zoom,n,[a])}},heatmap:function(e,r,i,n){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){const o=e.context,s=o.gl,a=t.ah.disabled,l=new t.a([s.ONE,s.ONE,s.ONE,s.ONE],t.C.transparent,[!0,!0,!0,!0]);!function(t,e,r,i){const n=t.gl,o=e.width*i,s=e.height*i;t.activeTexture.set(n.TEXTURE1),t.viewport.set([0,0,o,s]);let a=r.heatmapFbo;if(!a||a&&(a.width!==o||a.height!==s)){a&&a.destroy();const e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),a=r.heatmapFbo=t.createFramebuffer(o,s,!0,null),function(t,e,r,i,n,o){const s=t.gl;s.texImage2D(s.TEXTURE_2D,0,t.extRenderToTextureHalfFloat?s.RGBA16F:s.RGBA,n,o,0,s.RGBA,t.extRenderToTextureHalfFloat?s.HALF_FLOAT:s.UNSIGNED_BYTE,null),i.colorAttachment.set(r)}(t,0,e,a,o,s)}else n.bindTexture(n.TEXTURE_2D,a.colorAttachment.get()),t.bindFramebuffer.set(a.framebuffer)}(o,e,i,"globe"===e.transform.projection.name?.5:.25),o.clear({color:t.C.transparent});const c=e.transform,u="globe"===c.projection.name,h=u?["PROJECTION_GLOBE_VIEW"]:[],d=u?t.ag.frontCCW:t.ag.disabled,p=[t.ak(c.center.lng),t.al(c.center.lat)];for(let f=0;f<n.length;f++){const m=n[f];if(r.hasRenderableParent(m))continue;const g=r.getTile(m),y=g.getBucket(i);if(!y||y.projection.name!==c.projection.name)continue;const v=e.isTileAffectedByFog(m),_=y.programConfigurations.get(i.id),b=e.getOrCreateProgram("heatmap",{config:_,defines:h,overrideFog:v}),{zoom:x}=e.transform;e.terrain&&e.terrain.setupElevationDraw(g,b),e.uploadCommonUniforms(o,b,m.toUnwrapped());const w=c.projection.createInversionMatrix(c,m.canonical);b.draw(e,s.TRIANGLES,t.af.disabled,a,l,d,Kr(e,m,g,w,p,x,i.paint.get("heatmap-intensity")),i.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,i.paint,e.transform.zoom,_,u?[y.globeExtVertexBuffer]:null)}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,r){const i=e.context,n=i.gl,o=r.heatmapFbo;if(!o)return;i.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,o.colorAttachment.get()),i.activeTexture.set(n.TEXTURE1);let s=r.colorRampTexture;s||(s=r.colorRampTexture=new t.T(i,r.colorRamp,n.RGBA)),s.bind(n.LINEAR,n.CLAMP_TO_EDGE),e.getOrCreateProgram("heatmapTexture").draw(e,n.TRIANGLES,t.af.disabled,t.ah.disabled,e.colorModeForRenderPass(),t.ag.disabled,((t,e,r,i)=>({u_image:0,u_color_ramp:1,u_opacity:e.paint.get("heatmap-opacity")}))(0,r),r.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,r.paint,e.transform.zoom)}(e,i))},line:function(e,r,i,n){if("translucent"!==e.renderPass)return;const o=i.paint.get("line-opacity"),s=i.paint.get("line-width");if(0===o.constantOr(1)||0===s.constantOr(1))return;const a=i.paint.get("line-emissive-strength"),l=i.paint.get("line-occlusion-opacity"),c=e.context,u=c.gl,h=i.layout.get("line-z-offset"),d=!h.isConstant()||!!h.constantOr(0),p=d?new t.af(e.depthOcclusion?u.GREATER:u.LEQUAL,t.af.ReadOnly,e.depthRangeFor3D):e.depthModeForSublayer(0,t.af.ReadOnly),f=e.colorModeForDrapableLayerRenderPass(a),m=e.terrain&&e.terrain.renderingToTexture,g=m?1:t.e.devicePixelRatio,y=i.paint.get("line-dasharray"),v=y.constantOr(1),_=i.layout.get("line-cap"),b=y.constantOr(null),x=_.constantOr(null),w=i.paint.get("line-pattern"),T=w.constantOr(1),E=w.constantOr(null),S=i.paint.get("line-opacity").constantOr(1);let P=!T&&1!==S||e.depthOcclusion&&l>0&&l<1;const k=i.paint.get("line-gradient"),A=T?"linePattern":"line",M=t.bV(i);let C;if(m&&e.terrain&&e.terrain.clipOrMaskOverlapStencilType()&&(P=!1),0!==l&&e.depthOcclusion){const e=i.paint._values["line-opacity"];e&&e.value&&"constant"===e.value.kind?C=e.value:t.w(`Occlusion opacity for layer ${i.id} is supported only when line-opacity isn't data-driven.`)}if(d&&(e.forceTerrainMode=!0),!d&&0!==l&&e.terrain&&!m)return void t.w(`Occlusion opacity for layer ${i.id} is supported on terrain only if the layer has non-zero line-z-offset.`);const I=P&&d?e.stencilModeFor3D():t.ah.disabled;for(const o of n){const n=r.getTile(o);if(T&&!n.patternsLoaded())continue;const s=n.getBucket(i);if(!s)continue;e.prepareDrawTile();const a=s.programConfigurations.get(i.id),h=e.isTileAffectedByFog(o),y=e.getOrCreateProgram(A,{config:a,defines:d?[...M,"ELEVATED"]:M,overrideFog:h});if(E&&n.imageAtlas){const t=n.imageAtlas.patternPositions[E.toString()];t&&a.setConstantPatternPositions(t)}if(!T&&b&&x&&n.lineAtlas){const t=n.lineAtlas.getDash(b,x);t&&a.setConstantPatternPositions(t)}let[_,w]=i.paint.get("line-trim-offset");if("round"===x||"square"===x){const t=1;_!==w&&(0===_&&(_-=t),1===w&&(w+=t))}const O=m?o.projMatrix:null,L=T?t.bW(e,n,i,O,g,[_,w]):t.bX(e,n,i,O,s.lineClipsArray.length,g,[_,w]);if(k){const n=s.gradients[i.id];let a=n.texture;if(i.gradientVersion!==n.version){let l=256;if(i.stepInterpolant){const i=r.getSource().maxzoom,n=o.canonical.z===i?Math.ceil(1<<e.transform.maxZoom-o.canonical.z):1;l=t.au(t.bY(s.maxLineLength/t.a4*1024*n),256,c.maxTextureSize)}n.gradient=t.bZ({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:l,image:n.gradient||void 0,clips:s.lineClipsArray}),n.texture?n.texture.update(n.gradient):n.texture=new t.T(c,n.gradient,u.RGBA),n.version=i.gradientVersion,a=n.texture}c.activeTexture.set(u.TEXTURE1),a.bind(i.stepInterpolant?u.NEAREST:u.LINEAR,u.CLAMP_TO_EDGE)}v&&(c.activeTexture.set(u.TEXTURE0),n.lineAtlasTexture&&n.lineAtlasTexture.bind(u.LINEAR,u.REPEAT),a.updatePaintBuffers()),T&&(c.activeTexture.set(u.TEXTURE0),n.imageAtlasTexture&&n.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),a.updatePaintBuffers()),d&&e.terrain.setupElevationDraw(n,y),e.uploadCommonUniforms(c,y,o.toUnwrapped());const D=r=>{null!=C&&(C.value=S*l),y.draw(e,u.TRIANGLES,p,r,f,t.ag.disabled,L,i.id,s.layoutVertexBuffer,s.indexBuffer,s.segments,i.paint,e.transform.zoom,a,[s.layoutVertexBuffer2,s.patternVertexBuffer,s.zOffsetVertexBuffer]),null!=C&&(C.value=S)};if(P&&!d){const r=e.stencilModeForClipping(o).ref;0===r&&m&&c.clear({stencil:0});const i={func:u.EQUAL,mask:255};L.u_alpha_discard_threshold=.8,D(new t.ah(i,r,255,u.KEEP,u.KEEP,u.INVERT)),L.u_alpha_discard_threshold=0,D(new t.ah(i,r,255,u.KEEP,u.KEEP,u.KEEP))}else P&&d&&(L.u_alpha_discard_threshold=.001),D(d?I:e.stencilModeForClipping(o))}P&&(e.resetStencilClippingMasks(),m&&c.clear({stencil:0})),0===l||e.depthOcclusion||m||e.layersWithOcclusionOpacity.push(e.currentLayer),d&&(e.forceTerrainMode=!1)},fill:function(e,r,i,n){const o=i.paint.get("fill-color"),s=i.paint.get("fill-opacity");if(0===s.constantOr(1))return;const a=i.paint.get("fill-emissive-strength"),l=e.colorModeForDrapableLayerRenderPass(a),c=i.paint.get("fill-pattern"),u=e.opaquePassEnabledForLayer()&&!c.constantOr(1)&&1===o.constantOr(t.C.transparent).a&&1===s.constantOr(0)?"opaque":"translucent";if(e.renderPass===u){const o=e.depthModeForSublayer(1,"opaque"===e.renderPass?t.af.ReadWrite:t.af.ReadOnly);ki(e,r,i,n,o,l,!1)}if("translucent"===e.renderPass&&i.paint.get("fill-antialias")){const o=e.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,t.af.ReadOnly);ki(e,r,i,n,o,l,!0)}},"fill-extrusion":function(e,r,i,n){const o=i.paint.get("fill-extrusion-opacity"),s=e.context,a=s.gl,l=e.terrain,c=l&&l.renderingToTexture;if(0===o)return;const u=e.conflationActive&&e.style.isLayerClipped(i,r.getSource()),h=e.style.order.indexOf(i.fqid);if(u&&function(t,e,r,i,n){for(const o of i){const i=e.getTile(o).getBucket(r);i&&(i.updateReplacement(o,t.replacementSource,n),i.uploadCentroid(t.context))}}(e,r,i,n,h),l||u)for(const t of n){const n=r.getTile(t).getBucket(i);n&&Ci(e.context,r,t,n,i,l,u)}if("shadow"===e.renderPass&&e.shadowRenderer){const s=e.shadowRenderer;if(l&&o<.65&&i._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof t.Z)return;const a=s.getShadowPassDepthMode(),c=s.getShadowPassColorMode();Ai(e,r,i,n,a,t.ah.disabled,c,u)}else if("translucent"===e.renderPass){const h=!i.paint.get("fill-extrusion-pattern").constantOr(1),d=i.paint.get("fill-extrusion-color").constantOr(t.C.white);if(!c&&0!==d.a){const s=new t.af(e.context.gl.LEQUAL,t.af.ReadWrite,e.depthRangeFor3D);1===o&&h?Ai(e,r,i,n,s,t.ah.disabled,t.a.unblended,u):(Ai(e,r,i,n,s,t.ah.disabled,t.a.disabled,u),Ai(e,r,i,n,s,e.stencilModeFor3D(),e.colorModeForRenderPass(),u),e.resetStencilClippingMasks())}if(e.style.enable3dLights()&&h&&(!l&&"globe"!==e.transform.projection.name||c)){const o=i.paint.get("fill-extrusion-opacity"),h=i.paint.get("fill-extrusion-ambient-occlusion-intensity"),d=i.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),p=i.paint.get("fill-extrusion-flood-light-intensity"),f=i.paint.get("fill-extrusion-flood-light-color").toRenderColor(i.lut).toArray01().slice(0,3),m=h>0&&d>0,g=p>0,y=(t,e,r)=>(1-r)*t+r*e,v=s=>{const l=e.depthModeForSublayer(1,t.af.ReadOnly,a.LEQUAL,!0),c=i.paint.get(s?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),m=y(.1,3,c),g=e._showOverdrawInspector;if(!g){const c=new t.ah({func:a.ALWAYS,mask:255},255,255,a.KEEP,a.KEEP,a.REPLACE),g=new t.a([a.ONE,a.ONE,a.ONE,a.ONE],t.C.transparent,[!1,!1,!1,!0],a.MIN);Mi(e,r,i,n,l,c,g,t.ag.disabled,s,"sdf",o,h,d,p,f,m,u,!1)}{const c=g?t.ah.disabled:new t.ah({func:a.EQUAL,mask:255},255,255,a.KEEP,a.DECR,a.DECR),y=g?e.colorModeForRenderPass():new t.a([a.ONE_MINUS_DST_ALPHA,a.DST_ALPHA,a.ONE,a.ONE],t.C.transparent,[!0,!0,!0,!0]);Mi(e,r,i,n,l,c,y,t.ag.disabled,s,"color",o,h,d,p,f,m,u,!1)}};if(c){const c=(s,l,c)=>{const m=e.depthModeForSublayer(1,t.af.ReadOnly,a.LEQUAL,!1),g=i.paint.get(s?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),v=y(.1,3,g);{const c=new t.a([a.ONE,a.ONE,a.ONE,a.ONE],t.C.transparent,[!1,!1,!1,!0]);Mi(e,r,i,n,m,t.ah.disabled,c,t.ag.disabled,s,"clear",o,h,d,p,f,v,u,l)}{const c=new t.ah({func:a.ALWAYS,mask:255},255,255,a.KEEP,a.KEEP,a.REPLACE),g=new t.a([a.ONE,a.ONE,a.ONE,a.ONE],t.C.transparent,[!1,!1,!1,!0],a.MIN);Mi(e,r,i,n,m,c,g,t.ag.disabled,s,"sdf",o,h,d,p,f,v,u,l)}{const c=s?a.ZERO:a.ONE_MINUS_DST_ALPHA,g=new t.ah({func:a.EQUAL,mask:255},255,255,a.KEEP,a.DECR,a.DECR),y=new t.a([c,a.DST_ALPHA,a.ONE_MINUS_DST_ALPHA,a.ZERO],t.C.transparent,[!0,!0,!0,!0]);Mi(e,r,i,n,m,g,y,t.ag.disabled,s,"color",o,h,d,p,f,v,u,l)}{const g=new t.a([a.ONE,a.ONE,a.ONE,s?a.ZERO:a.ONE],t.C.transparent,[!1,!1,!1,!0],s?a.FUNC_ADD:a.MAX);Mi(e,r,i,n,m,t.ah.disabled,g,t.ag.disabled,s,"clear",o,h,d,p,f,v,u,l,c)}};if(m||g){let r;if(e.prepareDrawTile(),l){const e=l.drapeBufferSize[0],i=l.drapeBufferSize[1];r=l.framebufferCopyTexture,r&&(!r||r.size[0]===e&&r.size[1]===i)||(r&&r.destroy(),r=l.framebufferCopyTexture=new t.T(s,new t.j({width:e,height:i}),a.RGBA)),r.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.copyTexImage2D(a.TEXTURE_2D,0,a.RGBA,0,0,e,i,0)}m&&c(!0,!1,r),g&&c(!1,!0,r)}}else m&&v(!0),g&&v(!1),(m||g)&&e.resetStencilClippingMasks()}}},hillshade:function(e,r,i,n){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;if(e.style.disableElevatedTerrain)return;const o=e.context,s=e.terrain&&e.terrain.renderingToTexture,[a,l]="translucent"!==e.renderPass||s?[{},n]:e.stencilConfigForOverlap(n);for(const n of l){const o=r.getTile(n);if(o.needsHillshadePrepare&&"offscreen"===e.renderPass)Oe(e,o,i);else if("translucent"===e.renderPass){const r=e.depthModeForSublayer(0,t.af.ReadOnly),l=i.paint.get("hillshade-emissive-strength"),c=e.colorModeForDrapableLayerRenderPass(l),u=s&&e.terrain?e.terrain.stencilModeForRTTOverlap(n):a[n.overscaledZ];Ce(e,n,o,i,r,u,c)}}o.viewport.set([0,0,e.width,e.height]),e.resetStencilClippingMasks()},raster:function(e,r,i,n,o,s){if("translucent"!==e.renderPass)return;if(0===i.paint.get("raster-opacity"))return;const a="globe"===e.transform.projection.name,l=0!==i.paint.get("raster-elevation"),c=l&&a;if(e.renderElevatedRasterBackface&&!c)return;const u=e.context,h=u.gl,d=r.getSource(),p=function(e,r,i,n){const o=r.paint.get("raster-color"),s="raster-array"===e.type,a=[],l=r.paint.get("raster-resampling"),c=r.paint.get("raster-color-mix");let u=r.paint.get("raster-color-range");const h=[c[0],c[1],c[2],0],d=c[3];let p="nearest"===l?n.NEAREST:n.LINEAR;if(s&&(a.push("RASTER_ARRAY"),o||a.push("RASTER_COLOR"),"linear"===l&&a.push("RASTER_ARRAY_LINEAR"),p=n.NEAREST,!u&&e.rasterLayers)){const t=e.rasterLayers.find((({id:t})=>t===r.sourceLayer));t&&t.fields&&t.fields.range&&(u=t.fields.range)}if(u=u||[0,1],o){a.push("RASTER_COLOR"),i.activeTexture.set(n.TEXTURE2),r.updateColorRamp(u);let e=r.colorRampTexture;e||(e=r.colorRampTexture=new t.T(i,r.colorRamp,n.RGBA)),e.bind(n.LINEAR,n.CLAMP_TO_EDGE)}return{mix:h,range:u,offset:d,defines:a,resampling:p}}(d,i,u,h);if(d instanceof t.bo&&!n.length&&!a)return;const f=i.paint.get("raster-emissive-strength"),m=e.colorModeForDrapableLayerRenderPass(f),g=e.terrain&&e.terrain.renderingToTexture,y=!e.options.moving,v="nearest"===i.paint.get("raster-resampling")?h.NEAREST:h.LINEAR;if(d instanceof t.bo&&!n.length&&(d.onNorthPole||d.onSouthPole)){const n=l?e.stencilModeFor3D():t.ah.disabled;return void Fi(!!d.onNorthPole,null,e,r,i,f,p,t.ag.disabled,n)}if(!n.length)return;const[_,b]=d instanceof t.bo||g?[{},n]:e.stencilConfigForOverlap(n),x=b[b.length-1].overscaledZ;c&&p.defines.push("PROJECTION_GLOBE_VIEW"),l&&p.defines.push("RENDER_CUTOFF");const w=(n,o,b)=>{for(const w of n){const n=w.toUnwrapped(),T=r.getTile(w);if(g&&(!T||!T.hasData()))continue;u.activeTexture.set(h.TEXTURE0);const E=zi(T,d,i,p);if(!E||!E.texture)continue;const{texture:S,mix:P,offset:k,tileSize:A,buffer:M}=E;let C,I;g?(C=t.af.disabled,I=w.projMatrix):l?(C=new t.af(h.LEQUAL,t.af.ReadWrite,e.depthRangeFor3D),I=a?Float32Array.from(e.transform.expandedFarZProjMatrix):e.transform.calculateProjMatrix(n,y)):(C=e.depthModeForSublayer(w.overscaledZ-x,1===i.paint.get("raster-opacity")?t.af.ReadWrite:t.af.ReadOnly,h.LESS),I=e.transform.calculateProjMatrix(n,y));const O=e.terrain&&g?e.terrain.stencilModeForRTTOverlap(w):_[w.overscaledZ],L=s?0:i.paint.get("raster-fade-duration");T.registerFadeDuration(L);const D=r.findLoadedParent(w,0),R=kr(T,D,r,e.transform,L);let F,B;e.terrain&&e.terrain.prepareDrawTile(),u.activeTexture.set(h.TEXTURE0),S.bind(v,h.CLAMP_TO_EDGE),u.activeTexture.set(h.TEXTURE1),D?(D.texture&&D.texture.bind(v,h.CLAMP_TO_EDGE),F=Math.pow(2,D.tileID.overscaledZ-T.tileID.overscaledZ),B=[T.tileID.canonical.x*F%1,T.tileID.canonical.y*F%1]):S.bind(v,h.CLAMP_TO_EDGE),S.useMipmap&&u.extTextureFilterAnisotropic&&e.transform.pitch>20&&h.texParameterf(h.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax);const z=e.transform;let j;const N=l?Bi(z):[0,0,0,0];let V,U,$,G,H,q=0;if(c&&d instanceof t.bo&&d.coordinates.length>3)V=Float32Array.from(t.bh(t.bi(new t.aO(0,0,0)))),U=Float32Array.from(z.globeMatrix),$=Float32Array.from(t.bd(z)),G=[t.ak(z.center.lng),t.al(z.center.lat)],j=d.elevatedGlobePerspectiveTransform,H=d.elevatedGlobeGridMatrix||new Float32Array(9);else if(c){const e=t.be(w.canonical);q=t.bf(e.getCenter().lat),V=Float32Array.from(t.bh(t.bi(w.canonical))),U=Float32Array.from(z.globeMatrix),$=Float32Array.from(t.bd(z)),G=[t.ak(z.center.lng),t.al(z.center.lat)],j=[0,0],H=Float32Array.from(t.bg(w.canonical,e,q,z.worldSize/z._pixelsPerMercatorPixel))}else j=d instanceof t.bo?d.perspectiveTransform:[0,0],V=new Float32Array(16),U=new Float32Array(9),$=new Float32Array(16),G=[0,0],H=new Float32Array(9);const W=ti(I,V,U,$,H,B||[0,0],t.a2(e.transform.zoom),G,N,F||1,R,i,j,l?i.paint.get("raster-elevation"):0,2,P,k,p.range,A,M,f),Z=e.isTileAffectedByFog(w),X=e.getOrCreateProgram("raster",{defines:p.defines,overrideFog:Z});if(e.uploadCommonUniforms(u,X,n),d instanceof t.bo){const r=d.elevatedGlobeVertexBuffer,n=d.elevatedGlobeIndexBuffer;if(g||!a)d.boundsBuffer&&d.boundsSegments&&X.draw(e,h.TRIANGLES,C,t.ah.disabled,m,t.ag.disabled,W,i.id,d.boundsBuffer,e.quadTriangleIndexBuffer,d.boundsSegments);else if(r&&n){const s=z.zoom<=t.b3?d.elevatedGlobeSegments:d.getSegmentsForLongitude(z.center.lng);s&&X.draw(e,h.TRIANGLES,C,t.ah.disabled,m,o,W,i.id,r,n,s)}}else if(c){C=new t.af(h.LEQUAL,t.af.ReadOnly,e.depthRangeFor3D);const r=e.globeSharedBuffers;if(r){const[t,n,s]=r.getGridBuffers(q,!1);X.draw(e,h.TRIANGLES,C,b||O,e.colorModeForRenderPass(),o,W,i.id,t,n,s)}}else{const{tileBoundsBuffer:r,tileBoundsIndexBuffer:n,tileBoundsSegments:o}=e.getTileBoundsBuffers(T);X.draw(e,h.TRIANGLES,C,O,m,t.ag.disabled,W,i.id,r,n,o)}}if(!(d instanceof t.bo)&&c)for(const s of n){const n=s.canonical.y===(1<<s.canonical.z)-1;0===s.canonical.y&&Fi(!0,s,e,r,i,f,p,o,b||t.ah.disabled),n&&Fi(!1,s,e,r,i,f,p,o===t.ag.frontCW?t.ag.backCW:t.ag.frontCW,b||t.ah.disabled)}};c?w(b,e.renderElevatedRasterBackface?t.ag.backCW:t.ag.frontCW,e.stencilModeFor3D()):w(b,t.ag.disabled,void 0),e.resetStencilClippingMasks()},"raster-particle":function(e,r,i,n,o,s){"offscreen"===e.renderPass&&function(e,r,i,n){if(!n.length)return;const o=e.context,s=o.gl,a=r.getSource();if(!(a instanceof Ar))return;const l=Math.ceil(Math.sqrt(i.paint.get("raster-particle-count")));let c=i.particlePositionRGBAImage;if(!c||c.width!==l){const e=function(t){const e=t*t,r=new Uint8Array(4*e),i=function(t){return t|=0,t=Math.imul(2747636419^t,2654435769),t=Math.imul(t^t>>>16,2654435769),((t=Math.imul(t^t>>>16,2654435769))>>>0)/4294967296},n=1/1.1;for(let t=0;t<e;t++){const e=n*(i(2*t+0)+ri),o=n*(i(2*t+1)+ri),s=255*e%1,a=255*o%1,l=s,c=o-a/255,u=a;r[4*t+0]=255*(e-s/255),r[4*t+1]=255*l,r[4*t+2]=255*c,r[4*t+3]=255*u}return r}(l);c=i.particlePositionRGBAImage=new t.j({width:l,height:l},e)}let u=i.particleFramebuffer;u?u.width!==l&&(u.destroy(),u=i.particleFramebuffer=o.createFramebuffer(l,l,!0,null)):u=i.particleFramebuffer=o.createFramebuffer(l,l,!0,null);const h=[];for(const e of n){const n=r.getTile(e);if(!(n instanceof t.c5))continue;const s=ji(n,a,i);if(!s)continue;const u=[n.tileSize,n.tileSize];let d=i.tileFramebuffer;d||(d=i.tileFramebuffer=o.createFramebuffer(u[0],u[1],!0,null));let p=n.rasterParticleState;p||(p=n.rasterParticleState=new ot(o,e,u,c));const f=p.update(i.lastInvalidatedAt);p.particleTextureDimension!==l&&p.updateParticleTexture(e,c);const m=p.targetColorTexture;p.targetColorTexture=p.backgroundColorTexture,p.backgroundColorTexture=m;const g=p.particleTexture0;p.particleTexture0=p.particleTexture1,p.particleTexture1=g,h.push([e,s,p,f])}if(0===h.length)return;const d=t.e.now(),p=i.previousDrawTimestamp?.001*(d-i.previousDrawTimestamp):.0167;if(i.previousDrawTimestamp=d,i.hasColorMap()){o.activeTexture.set(s.TEXTURE0+2);let e=i.colorRampTexture;e||(e=i.colorRampTexture=new t.T(o,i.colorRamp,s.RGBA)),e.bind(s.LINEAR,s.CLAMP_TO_EDGE)}o.bindFramebuffer.set(i.tileFramebuffer.framebuffer),function(e,r,i){const n=e.context,o=n.gl,s=r.tileFramebuffer;n.activeTexture.set(o.TEXTURE0);const a={u_texture:0,u_opacity:1.05*(c=r.paint.get("raster-particle-fade-opacity-factor"))/(c+.05)},l=e.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var c;for(const c of i){const[,,i,u]=c;s.colorAttachment.set(i.targetColorTexture.texture),n.viewport.set([0,0,s.width,s.height]),n.clear({color:t.C.transparent}),u&&(i.backgroundColorTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE),l.draw(e,o.TRIANGLES,t.af.disabled,t.ah.disabled,t.a.alphaBlended,t.ag.disabled,a,r.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments))}}(e,i,h),function(e,r,i,n){const o=e.context,s=o.gl,a=i.tileFramebuffer,l="globe"===e.transform.projection.name,c=i.paint.get("raster-particle-max-speed");for(const u of n){const[n,h,d]=u;o.activeTexture.set(s.TEXTURE0+0),h.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),a.colorAttachment.set(d.targetColorTexture.texture);const p=e.getOrCreateProgram("rasterParticleDraw",{defines:h.defines,overrideFog:!1});o.activeTexture.set(s.TEXTURE0+1);const f=h.scalarData?[]:[0,1,2,3].map((e=>t.b$[e](n)));f.push(n);const m=n.canonical.x,g=n.canonical.y;for(const o of f){const a=r.getTile(l?o.wrapped():o);if(!a)continue;const u=a.rasterParticleState;if(!u)continue;const d=o.canonical.x+(1<<o.canonical.z)*(o.wrap-n.wrap),f=o.canonical.y;u.particleTexture0.bind(s.NEAREST,s.CLAMP_TO_EDGE);const y=ni(1,u.particleTexture0.size[0],[d-m,f-g],0,h.texture.size,2,c,h.textureOffset,h.scale,h.offset);p.draw(e,s.POINTS,t.af.disabled,t.ah.disabled,t.a.alphaBlended,t.ag.disabled,y,i.id,u.particleIndexBuffer,void 0,u.particleSegment)}}}(e,r,i,h),o.bindFramebuffer.set(i.particleFramebuffer.framebuffer),function(e,r,i,n){const o=e.context,s=o.gl,a=r.paint.get("raster-particle-max-speed"),l=n*r.paint.get("raster-particle-speed-factor")*.15,c=function(t){return Math.pow(t,6)}(.01+1*r.paint.get("raster-particle-reset-rate-factor")),u=r.particleFramebuffer;o.viewport.set([0,0,u.width,u.height]);for(const n of i){const[,i,h]=n;o.activeTexture.set(s.TEXTURE0+0),i.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),o.activeTexture.set(s.TEXTURE0+1);const d=h.particleTexture0;d.bind(s.NEAREST,s.CLAMP_TO_EDGE);const p=oi(1,d.size[0],0,i.texture.size,a,l,c,i.textureOffset,i.scale,i.offset);u.colorAttachment.set(h.particleTexture1.texture),o.clear({color:t.C.transparent}),e.getOrCreateProgram("rasterParticleUpdate",{defines:i.defines}).draw(e,s.TRIANGLES,t.af.disabled,t.ah.disabled,t.a.unblended,t.ag.disabled,p,r.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments)}}(e,i,h,p)}(e,r,i,n),"translucent"===e.renderPass&&(function(e,r,i,n,o){const s=e.context,a=s.gl,l=r.getSource().tileSize,c=5*(1-t.a0(t.aV,t.aV+1,e.transform.zoom))*l+i.paint.get("raster-particle-elevation"),u=!e.options.moving,h="globe"===e.transform.projection.name;if(!n.length)return;const[d,p]=e.stencilConfigForOverlap(n),f=[];h&&f.push("PROJECTION_GLOBE_VIEW");const m=e.stencilModeFor3D();for(const n of p){const o=n.toUnwrapped(),l=r.getTile(n);if(!l.rasterParticleState)continue;const p=l.rasterParticleState,g=100;l.registerFadeDuration(g);const y=r.findLoadedParent(n,0),v=kr(l,y,r,e.transform,g);let _,b;e.terrain&&e.terrain.prepareDrawTile(),s.activeTexture.set(a.TEXTURE0),p.targetColorTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE),s.activeTexture.set(a.TEXTURE1),y&&y.rasterParticleState?(y.rasterParticleState.targetColorTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE),_=Math.pow(2,y.tileID.overscaledZ-l.tileID.overscaledZ),b=[l.tileID.canonical.x*_%1,l.tileID.canonical.y*_%1]):p.targetColorTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE);const x=h?Float32Array.from(e.transform.expandedFarZProjMatrix):e.transform.calculateProjMatrix(o,u),w=e.transform,T=Ni(w),E=t.be(n.canonical),S=t.bf(E.getCenter().lat);let P,k,A,M,C;h?(P=Float32Array.from(t.bh(t.bi(n.canonical))),k=Float32Array.from(w.globeMatrix),A=Float32Array.from(t.bd(w)),M=[t.ak(w.center.lng),t.al(w.center.lat)],C=Float32Array.from(t.bg(n.canonical,E,S,w.worldSize/w._pixelsPerMercatorPixel))):(P=new Float32Array(16),k=new Float32Array(9),A=new Float32Array(16),M=[0,0],C=new Float32Array(9));const I=ii(x,P,k,A,C,b||[0,0],t.a2(e.transform.zoom),M,T,_||1,v,c),O=e.isTileAffectedByFog(n),L=e.getOrCreateProgram("rasterParticle",{defines:f,overrideFog:O});if(e.uploadCommonUniforms(s,L,o),h){const r=new t.af(a.LEQUAL,t.af.ReadOnly,e.depthRangeFor3D),n=0,o=e.globeSharedBuffers;if(o){const[s,l,c]=o.getGridBuffers(S,0!==n);L.draw(e,a.TRIANGLES,r,m,t.a.alphaBlended,e.renderElevatedRasterBackface?t.ag.frontCCW:t.ag.backCCW,I,i.id,s,l,c)}}else{const r=e.depthModeForSublayer(0,t.af.ReadOnly),o=d[n.overscaledZ],{tileBoundsBuffer:s,tileBoundsIndexBuffer:c,tileBoundsSegments:u}=e.getTileBoundsBuffers(l);L.draw(e,a.TRIANGLES,r,o,t.a.alphaBlended,t.ag.disabled,I,i.id,s,c,u)}}e.resetStencilClippingMasks()}(e,r,i,n),e.style.map.triggerRepaint())},background:function(e,r,i,n){const o=i.paint.get("background-color"),s=i.paint.get("background-opacity"),a=i.paint.get("background-emissive-strength");if(0===s)return;const l=e.context,c=l.gl,u=e.transform,h=u.tileSize,d=i.paint.get("background-pattern");let p;if(void 0!==d){if(null===d)return;if(p=e.imageManager.getPattern(d.toString(),i.scope,e.style.getLut(i.scope)),!p)return}const f=!d&&1===o.a&&1===s&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==f)return;const m=t.ah.disabled,g=e.depthModeForSublayer(0,"opaque"===f?t.af.ReadWrite:t.af.ReadOnly),y=e.colorModeForDrapableLayerRenderPass(a),v=d?"backgroundPattern":"background";let _,b=n;b||(_=e.getBackgroundTiles(),b=Object.values(_).map((t=>t.tileID))),d&&(l.activeTexture.set(c.TEXTURE0),e.imageManager.bind(e.context,i.scope));for(const f of b){const b=e.isTileAffectedByFog(f),x=e.getOrCreateProgram(v,{overrideFog:b}),w=f.toUnwrapped(),T=n?f.projMatrix:e.transform.calculateProjMatrix(w);e.prepareDrawTile();const E=r?r.getTile(f):_?_[f.key]:new t.bA(f,h,u.zoom,e),S=d?hi(T,a,s,e,0,i.scope,p,{tileID:f,tileSize:h}):ui(T,a,s,o.toRenderColor(i.lut));e.uploadCommonUniforms(l,x,w);const{tileBoundsBuffer:P,tileBoundsIndexBuffer:k,tileBoundsSegments:A}=e.getTileBoundsBuffers(E);x.draw(e,c.TRIANGLES,g,m,y,t.ag.disabled,S,i.id,P,k,A)}},sky:function(e,r,i){const n=e._atmosphere?t.a2(e.transform.zoom):1,o=i.paint.get("sky-opacity")*n;if(0===o)return;const s=e.context,a=i.paint.get("sky-type"),l=new t.af(s.gl.LEQUAL,t.af.ReadOnly,[0,1]),c=e.frameCounter/1e3%1;"atmosphere"===a?"offscreen"===e.renderPass?i.needsSkyboxCapture(e)&&(function(e,r,i,n){const o=e.context,s=o.gl;let a=r.skyboxFbo;if(!a){a=r.skyboxFbo=o.createFramebuffer(32,32,!0,null),r.skyboxGeometry=new Qi(o),r.skyboxTexture=o.gl.createTexture(),s.bindTexture(s.TEXTURE_CUBE_MAP,r.skyboxTexture),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MAG_FILTER,s.LINEAR);for(let t=0;t<6;++t)s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,s.RGBA,32,32,0,s.RGBA,s.UNSIGNED_BYTE,null)}o.bindFramebuffer.set(a.framebuffer),o.viewport.set([0,0,32,32]);const l=r.getCenter(e,!0),c=e.getOrCreateProgram("skyboxCapture"),u=new Float64Array(16);t.ae.identity(u),t.ae.rotateY(u,u,.5*-Math.PI),tn(e,r,c,u,l,0),t.ae.identity(u),t.ae.rotateY(u,u,.5*Math.PI),tn(e,r,c,u,l,1),t.ae.identity(u),t.ae.rotateX(u,u,.5*-Math.PI),tn(e,r,c,u,l,2),t.ae.identity(u),t.ae.rotateX(u,u,.5*Math.PI),tn(e,r,c,u,l,3),t.ae.identity(u),tn(e,r,c,u,l,4),t.ae.identity(u),t.ae.rotateY(u,u,Math.PI),tn(e,r,c,u,l,5),o.viewport.set([0,0,e.width,e.height])}(e,i),i.markSkyboxValid(e)):"sky"===e.renderPass&&function(e,r,i,n,o){const s=e.context,a=s.gl,l=e.transform,c=e.getOrCreateProgram("skybox");s.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_CUBE_MAP,r.skyboxTexture);const u=((t,e,r,i,n)=>({u_matrix:t,u_sun_direction:e,u_cubemap:0,u_opacity:i,u_temporal_offset:n}))(l.skyboxMatrix,r.getCenter(e,!1),0,n,o);e.uploadCommonUniforms(s,c),c.draw(e,a.TRIANGLES,i,t.ah.disabled,e.colorModeForRenderPass(),t.ag.backCW,u,"skybox",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}(e,i,l,o,c):"gradient"===a&&"sky"===e.renderPass&&function(e,r,i,n,o){const s=e.context,a=s.gl,l=e.transform,c=e.getOrCreateProgram("skyboxGradient");r.skyboxGeometry||(r.skyboxGeometry=new Qi(s)),s.activeTexture.set(a.TEXTURE0);let u=r.colorRampTexture;u||(u=r.colorRampTexture=new t.T(s,r.colorRamp,a.RGBA)),u.bind(a.LINEAR,a.CLAMP_TO_EDGE);const h=((e,r,i,n,o)=>({u_matrix:e,u_color_ramp:0,u_center_direction:r,u_radius:t.ac(i),u_opacity:n,u_temporal_offset:o}))(l.skyboxMatrix,r.getCenter(e,!1),r.paint.get("sky-gradient-radius"),n,o);e.uploadCommonUniforms(s,c),c.draw(e,a.TRIANGLES,i,t.ah.disabled,e.colorModeForRenderPass(),t.ag.backCW,h,"skyboxGradient",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}(e,i,l,o,c)},debug:function(e,r,i,n,o,s){for(let a=0;a<i.length;a++)if(o){const o=1,l=.8,c=new t.C(n.r*l,n.g*l,n.b*l,1);qi(e,r,i[a],n,-o,-o,s),qi(e,r,i[a],n,-o,o,s),qi(e,r,i[a],n,o,o,s),qi(e,r,i[a],n,o,-o,s),qi(e,r,i[a],c,0,0,s)}else qi(e,r,i[a],n,0,0,s)},custom:function(e,r,i,n){const o=e.context,s=i.implementation;if(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes("custom")||e.terrain&&(e.terrain.renderingToTexture||"offscreen"===e.renderPass)&&i.isDraped(r)){if("offscreen"===e.renderPass){const r=s.prerender;if(r){if(e.setCustomLayerDefaults(),o.setColorMode(e.colorModeForRenderPass()),"globe"===e.transform.projection.name){const i=e.transform.pointMerc;r.call(s,o.gl,e.transform.customLayerMatrix(),e.transform.getProjection(),e.transform.globeToMercatorMatrix(),t.a2(e.transform.zoom),[i.x,i.y],e.transform.pixelsPerMeterRatio)}else r.call(s,o.gl,e.transform.customLayerMatrix());o.setDirty(),e.setBaseState()}}else if("translucent"===e.renderPass){if(e.terrain&&e.terrain.renderingToTexture){const r=s.renderToTile;if(r){const i=n[0].canonical,a=new t._(i.x+n[0].wrap*(1<<i.z),i.y,i.z);o.setDepthMode(t.af.disabled),o.setStencilMode(t.ah.disabled),o.setColorMode(e.colorModeForRenderPass()),e.setCustomLayerDefaults(),r.call(s,o.gl,a),o.setDirty(),e.setBaseState()}return}e.setCustomLayerDefaults(),o.setColorMode(e.colorModeForRenderPass()),o.setStencilMode(t.ah.disabled);const r="3d"===s.renderingMode?new t.af(e.context.gl.LEQUAL,t.af.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,t.af.ReadOnly);if(o.setDepthMode(r),"globe"===e.transform.projection.name){const r=e.transform.pointMerc;s.render(o.gl,e.transform.customLayerMatrix(),e.transform.getProjection(),e.transform.globeToMercatorMatrix(),t.a2(e.transform.zoom),[r.x,r.y],e.transform.pixelsPerMeterRatio)}else s.render(o.gl,e.transform.customLayerMatrix());o.setDirty(),e.setBaseState(),o.bindFramebuffer.set(null)}}else t.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(e,r,i,n){if("opaque"===e.renderPass)return;const o=i.paint.get("model-opacity");if(0===o)return;const s=i.paint.get("model-cast-shadows");if("shadow"===e.renderPass){if(!s)return;if(e.terrain&&o<.65&&i._transitionablePaint._values["model-opacity"].value.expression instanceof t.Z)return}const a=e.shadowRenderer,l=i.paint.get("model-receive-shadows");a&&(a.useNormalOffset=!0,l||(a.enabled=!1));const c=()=>{a&&(a.useNormalOffset=!0,l||(a.enabled=!0))},u=r.getSource();if("light-beam"===e.renderPass&&"batched-model"!==u.type)return;if("vector"===u.type||"geojson"===u.type)return function(e,r,i,n,o){const s=e.transform;if("mercator"!==s.projection.name)return void t.w(`Drawing 3D models for ${s.projection.name} projection is not yet implemented`);const a=s.getFreeCameraOptions().position;if(!e.modelManager)return;const l=e.modelManager;i.modelManager=l;const c=e.shadowRenderer;if(!i._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const u=i._unevaluatedLayout._values["model-id"],h={...i.layout.get("model-id").parameters},d=e.style.order.indexOf(i.fqid);for(const p of n){const n=r.getTile(p).getBucket(i);if(!n||n.projection.name!==s.projection.name)continue;const f=n.getModelUris();f&&!n.modelsRequested&&(l.addModelsFromBucket(f,o),n.modelsRequested=!0);const m=fn(p,s);h.zoom=m;const g=u.possiblyEvaluate(h);if(dn(e,n,p),pn.shadowUniformsInitialized=!1,pn.useSingleShadowCascade=!!c&&0===c.getMaxCascadeForTile(p.toUnwrapped()),"shadow"===e.renderPass&&c){if(1===e.currentShadowCascade&&n.isInsideFirstShadowMapFrustum)continue;const r=s.calculatePosMatrix(p.toUnwrapped(),s.worldSize);if(pn.tileMatrix.set(r),pn.shadowTileMatrix=Float32Array.from(c.calculateShadowPassMatrixFromMatrix(r)),pn.aabb.min.fill(0),pn.aabb.max[0]=pn.aabb.max[1]=t.a4,pn.aabb.max[2]=0,yn(n,pn,e,i.scope))continue}const y=1<<p.canonical.z,v=[((a.x-p.wrap)*y-p.canonical.x)*t.a4,(a.y*y-p.canonical.y)*t.a4,a.z*y*t.a4];e.conflationActive&&Object.keys(n.instancesPerModel).length>0&&e.style.isLayerClipped(i,r.getSource())&&n.updateReplacement(p,e.replacementSource,d,o)&&(n.uploaded=!1,n.upload(e.context));for(let t in n.instancesPerModel){const r=n.instancesPerModel[t];r.features.length>0&&(t=g.evaluate(r.features[0].feature,{}));const s=l.getModel(t,o);if(s&&s.uploaded)for(const t of s.nodes)mn(e,i,t,r,v,p,pn)}}}(e,r,i,n,"vector"===u.type?i.scope:""),void c();if(!u.loaded())return;if("batched-model"===u.type)return function(e,r,i,n){i.resetLayerRenderingStats(e);const o=e.context,s=e.transform,a=e.style.fog,l=e.shadowRenderer;if("mercator"!==s.projection.name)return void t.w(`Drawing 3D landmark models for ${s.projection.name} projection is not yet implemented`);const c=e.transform.getFreeCameraOptions().position,u=t.$.scale([],[c.x,c.y,c.z],e.transform.worldSize);t.$.negate(u,u);const h=t.ae.identity([]),d=t.ci(s.center.lat,s.zoom),p=t.ae.fromScaling([],[1,1,1/d]);t.ae.translate(h,h,u);const f=i.paint.get("model-opacity"),m=new t.af(o.gl.LEQUAL,t.af.ReadWrite,e.depthRangeFor3D),g=new t.af(o.gl.LEQUAL,t.af.ReadOnly,e.depthRangeFor3D),y=new t.b8([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),v="shadow"===e.renderPass,_=v&&l?l.getCurrentCascadeFrustum():s.getFrustum(s.scaleZoom(s.worldSize)),b=i.paint.get("model-front-cutoff"),x=b[2]<1,w=dr(e,i.paint.get("model-cutoff-fade-range")),T=i.getLayerRenderingStats();(function(t,e,r,i){const n=t.terrain?t.terrain.exaggeration():0,o=t.transform.zoom;for(const s of i){const i=e.getTile(s).getBucket(r);i&&(t.conflationActive&&i.updateReplacement(s,t.replacementSource),i.evaluateScale(t,r),t.terrain&&n>0&&i.elevationUpdate(t.terrain,n,s,r.source),i.needsReEvaluation(t,o,r)&&i.evaluate(r))}})(e,r,i,n),function(){let c,u,d;x?(c=n.length-1,u=-1,d=-1):(c=0,u=n.length,d=1);for(let E=c;E!==u;E+=d){const c=n[E],u=r.getTile(c).getBucket(i);if(!u||!u.uploaded)continue;let d=!1;l&&(d=0===l.getMaxCascadeForTile(c.toUnwrapped()));const S=s.calculatePosMatrix(c.toUnwrapped(),s.worldSize),P=u.modelTraits,k=[];for(const r of u.getNodesInfo()){if(r.hiddenByReplacement)continue;if(!r.node.meshes)continue;const i=r.node;let n=0;e.terrain&&i.elevation&&(n=i.elevation*e.terrain.exaggeration());const o=r.evaluatedScale;if(o[0]<=1&&o[1]<=1&&o[2]<=1&&0===(()=>{const e=r.aabb;return y.min=[...e.min],y.max=[...e.max],y.min[2]+=n,y.max[2]+=n,t.$.transformMat4(y.min,y.min,S),t.$.transformMat4(y.max,y.max,S),y})().intersects(_))continue;const a=[...S],l=i.anchor?i.anchor[0]:0,c=i.anchor?i.anchor[1]:0;t.ae.translate(a,a,[l*(o[0]-1),c*(o[1]-1),n]),t.$.exactEquals(o,t.cl)||t.ae.scale(a,a,o);const u=t.ae.multiply([],a,i.matrix),h=t.ae.multiply([],s.expandedFarZProjMatrix,u),d=t.ae.multiply([],s.expandedFarZProjMatrix,a),p=t.aB.transformMat4([],[l,c,n,1],h)[2];i.hidden=!1;let m=f;v||(x&&(m*=_n(a,s,r.aabb,b)),m*=vn(w,p)),0!==m?k.push({nodeInfo:r,depth:p,opacity:m,wvpForNode:h,wvpForTile:d,nodeModelMatrix:u,tileModelMatrix:a}):i.hidden=!0}v||k.sort(((t,e)=>!x||1===t.opacity&&1===e.opacity?t.depth<e.depth?-1:1:1===t.opacity?-1:1===e.opacity?1:t.depth>e.depth?-1:1));for(const r of k){const n=r.nodeInfo,c=n.node;let u=t.ae.multiply([],p,r.tileModelMatrix);t.ae.multiply(u,h,u);const f=t.ae.invert([],u);t.ae.transpose(f,f),t.ae.scale(f,f,gn),u=t.ae.multiply(u,u,c.matrix);const y="light-beam"===e.renderPass,_=P&t.cn.HasMapboxMeshFeatures,b=_?0:n.evaluatedRMEA[0][2];for(let h=0;h<c.meshes.length;++h){const p=c.meshes[h],x=h===c.lightMeshIndex;let w=r.wvpForNode;if(x){if(!y&&!e.terrain&&e.shadowRenderer){e.currentLayer<e.firstLightBeamLayer&&(e.firstLightBeamLayer=e.currentLayer);continue}w=r.wvpForTile}else if(y)continue;const E={defines:[]},S=[];if(ln(E.defines,S,p,e,i.lut),_||E.defines.push("DIFFUSE_SHADED"),d&&E.defines.push("SHADOWS_SINGLE_CASCADE"),T&&(v?T.numRenderedVerticesInShadowPass+=p.vertexArray.length:T.numRenderedVerticesInTransparentPass+=p.vertexArray.length),v){hn(p,r.nodeModelMatrix,e,i);continue}let P=null;if(a){const t=an(r.nodeModelMatrix,e.transform);if(P=new Float32Array(t),"globe"!==s.projection.name){const e=p.aabb.min,r=p.aabb.max,[i,n]=a.getOpacityForBounds(t,e[0],e[1],r[0],r[1]);E.overrideFog=i>=Qt||n>=Qt}}const k=p.material;let A;k.occlusionTexture&&k.occlusionTexture.offsetScale&&(A=k.occlusionTexture.offsetScale,E.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!v&&l&&(l.useNormalOffset=!!p.normalBuffer);const M=e.getOrCreateProgram("model",E);!v&&l&&l.setupShadowsFromMatrix(r.tileModelMatrix,M,l.useNormalOffset),e.uploadCommonUniforms(o,M,null,P);const C=k.pbrMetallicRoughness;C.metallicFactor=.9,C.roughnessFactor=.5;const I=pi(new Float32Array(w),new Float32Array(u),new Float32Array(f),new Float32Array(c.matrix),e,r.opacity,C.baseColorFactor.toRenderColor(null),k.emissiveFactor,C.metallicFactor,C.roughnessFactor,k,b,i,[0,0,0],A);!x&&(n.hasTranslucentParts||r.opacity<1)&&M.draw(e,o.gl.TRIANGLES,m,t.ah.disabled,t.a.disabled,t.ag.backCCW,I,i.id,p.vertexBuffer,p.indexBuffer,p.segments,i.paint,e.transform.zoom,void 0,S),M.draw(e,o.gl.TRIANGLES,x?g:m,t.ah.disabled,x||r.opacity<1||n.hasTranslucentParts?t.a.alphaBlended:t.a.unblended,t.ag.backCCW,I,i.id,p.vertexBuffer,p.indexBuffer,p.segments,i.paint,e.transform.zoom,void 0,S)}}}}()}(e,r,i,n),void c();if("model"!==u.type)return;const h=u.getModels(),d=[],p=e.transform.getFreeCameraOptions().position,f=t.$.scale([],[p.x,p.y,p.z],e.transform.worldSize);t.$.negate(f,f);const m=[],g=[];let y=0;for(const r of h){const n=i.paint.get("model-rotation").constantOr(null),o=i.paint.get("model-scale").constantOr(null),s=i.paint.get("model-translation").constantOr(null);r.computeModelMatrix(e,n,o,s,!0,!0,!1);const a=t.ae.identity([]),l=t.ci(r.position.lat,e.transform.zoom),c=t.ae.fromScaling([],[1,1,1/l]);t.ae.translate(a,a,f),d.push({zScaleMatrix:c,negCameraPosMatrix:a});for(const t of r.nodes)un(e.transform,t,r.matrix,e.transform.expandedFarZProjMatrix,y,m,g);y++}if(m.sort(((t,e)=>e.depth-t.depth)),"shadow"!==e.renderPass){if(1===o)for(const r of g)cn(r,e,i,d[r.modelIndex],t.ah.disabled,e.colorModeForRenderPass());else{for(const r of g)cn(r,e,i,d[r.modelIndex],t.ah.disabled,t.a.disabled);for(const t of g)cn(t,e,i,d[t.modelIndex],e.stencilModeFor3D(),e.colorModeForRenderPass());e.resetStencilClippingMasks()}for(const r of m)cn(r,e,i,d[r.modelIndex],t.ah.disabled,e.colorModeForRenderPass());c()}else{for(const t of g)hn(t.mesh,t.nodeModelMatrix,e,i);for(const t of m)hn(t.mesh,t.nodeModelMatrix,e,i);c()}}},En={model:function(t,e,r){const i=e.getSource();if(!i.loaded())return;if("vector"===i.type||"geojson"===i.type)return void(r.modelManager&&r.modelManager.upload(r,"vector"===i.type?t.scope:""));if("batched-model"===i.type)return;if("model"!==i.type)return;const n=i.getModels();for(const t of n)t.upload(r.context)},raster:function(t,e,r){const i=e.getSource();if(!(i instanceof Ar&&i.loaded()))return;const n=t.sourceLayer||i.rasterLayerIds&&i.rasterLayerIds[0];if(!n)return;const o=t.paint.get("raster-array-band")||i.getInitialBand(n);if(null==o)return;const s=e.getIds().map((t=>e.getTileByID(t)));for(const t of s)t.updateNeeded(n,o)&&i.prepareTile(t,n,o)},"raster-particle":function(t,e,r){const i=e.getSource();if(!(i instanceof Ar&&i.loaded()))return;const n=t.sourceLayer||i.rasterLayerIds&&i.rasterLayerIds[0];if(!n)return;const o=t.paint.get("raster-particle-array-band")||i.getInitialBand(n);if(null==o)return;const s=e.getIds().map((t=>e.getTileByID(t)));for(const t of s)t.updateNeeded(n,o)&&i.prepareTile(t,n,o)}};class Sn{constructor(e,r,i,n){this.context=new nt(e,r),this.transform=i,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=n,this._timeStamp=t.e.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const o=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const t of o)this._debugParams.enabledLayers[t]=!0;n.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},(()=>{this.style.map.triggerRepaint()})),n.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),n.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),n.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),n.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const t of o)n.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],t);this.occlusionParams=new wn(n),this.setup(),this.numSublayers=t.bx.maxUnderzooming+t.bx.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new t.cp,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new gr(this),this._wireframeDebugCache=new xn,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const s=new t.j({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new t.T(this.context,s,e.RGBA)}updateTerrain(t,e){const r=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(r||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Dr(this,t));const i=this._terrain;this.transform.elevation=r?i:null,i.update(t,this.transform,e),this.transform.elevation&&!i.enabled&&(this.transform.elevation=null)}_updateFog(t){const e=t.fog;if(!e||"globe"===this.transform.projection.name||e.getOpacity(this.transform.pitch)<1||e.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[r,i]=e.getFovAdjustedRange(this.transform._fov);if(r>i)return void(this.transform.fogCullDistSq=null);const n=r+.78*(i-r);this.transform.fogCullDistSq=n*n}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(t){t&&!this._terrain&&(this._terrain=new Dr(this,this.style)),this._forceTerrainMode=t}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(e,r){if(this.width=e*t.e.devicePixelRatio,this.height=r*t.e.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const t of this.style.order)this.style._mergedLayers[t].resize()}setup(){const e=this.context,r=new t.bv;r.emplaceBack(0,0),r.emplaceBack(t.a4,0),r.emplaceBack(0,t.a4),r.emplaceBack(t.a4,t.a4),this.tileExtentBuffer=e.createVertexBuffer(r,t.bt.members),this.tileExtentSegments=t.b.simpleSegment(0,0,4,2);const i=new t.bv;i.emplaceBack(0,0),i.emplaceBack(t.a4,0),i.emplaceBack(0,t.a4),i.emplaceBack(t.a4,t.a4),this.debugBuffer=e.createVertexBuffer(i,t.bt.members),this.debugSegments=t.b.simpleSegment(0,0,4,5);const n=new t.bv;n.emplaceBack(-1,-1),n.emplaceBack(1,-1),n.emplaceBack(-1,1),n.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(n,t.bt.members),this.viewportSegments=t.b.simpleSegment(0,0,4,2);const o=new t.cq;o.emplaceBack(0,0,0,0),o.emplaceBack(t.a4,0,t.a4,0),o.emplaceBack(0,t.a4,0,t.a4),o.emplaceBack(t.a4,t.a4,t.a4,t.a4),this.mercatorBoundsBuffer=e.createVertexBuffer(o,t.cr.members),this.mercatorBoundsSegments=t.b.simpleSegment(0,0,4,2);const s=new t.bw;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s);const a=new t.cs;for(const t of[0,1,3,2,0])a.emplaceBack(t);this.debugIndexBuffer=e.createIndexBuffer(a),this.emptyTexture=new t.T(e,new t.j({width:1,height:1},Uint8Array.of(0,0,0,0)),e.gl.RGBA),this.identityMat=t.ae.create();const l=this.context.gl;this.stencilClearMode=new t.ah({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const e=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,e.TRIANGLES,t.af.disabled,this.stencilClearMode,t.a.disabled,t.ag.disabled,Pr(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(e,r,i){if(!r||this.currentStencilSource===r.id||!e.isTileClipped()||!i||0===i.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let t=!1;for(const e of i)if(void 0===this._tileClippingMaskIDs[e.key]){t=!0;break}if(!t)return}this.currentStencilSource=r.id;const n=this.context,o=n.gl;this.nextStencilID+i.length>256&&this.clearStencil(),n.setColorMode(t.a.disabled),n.setDepthMode(t.af.disabled);const s=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const e of i){const i=r.getTile(e),n=this._tileClippingMaskIDs[e.key]=this.nextStencilID++,{tileBoundsBuffer:a,tileBoundsIndexBuffer:l,tileBoundsSegments:c}=this.getTileBoundsBuffers(i);s.draw(this,o.TRIANGLES,t.af.disabled,new t.ah({func:o.ALWAYS,mask:0},n,255,o.KEEP,o.KEEP,o.REPLACE),t.a.disabled,t.ag.disabled,Pr(e.projMatrix),"$clipping",a,l,c)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,r=this.context.gl;return new t.ah({func:r.NOTEQUAL,mask:255},e,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(e){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(e);const r=this.context.gl;return new t.ah({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,r.KEEP,r.KEEP,r.REPLACE)}stencilConfigForOverlap(e){const r=this.context.gl,i=e.sort(((t,e)=>e.overscaledZ-t.overscaledZ)),n=i[i.length-1].overscaledZ,o=i[0].overscaledZ-n+1;if(o>1){this.currentStencilSource=void 0,this.nextStencilID+o>256&&this.clearStencil();const e={};for(let i=0;i<o;i++)e[i+n]=new t.ah({func:r.GEQUAL,mask:255},i+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=o,[e,i]}return[{[n]:t.ah.disabled},i]}colorModeForRenderPass(){const e=this.context.gl;if(this._showOverdrawInspector){const r=1/8;return new t.a([e.CONSTANT_COLOR,e.ONE,e.CONSTANT_COLOR,e.ONE],new t.C(r,r,r,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?t.a.unblended:t.a.alphaBlended}colorModeForDrapableLayerRenderPass(e){const r=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&"translucent"===this.renderPass?new t.a([r.ONE,r.ONE_MINUS_SRC_ALPHA,r.CONSTANT_ALPHA,r.ONE_MINUS_SRC_ALPHA],new t.C(0,0,0,void 0===e?0:e),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(e,r,i,n=!1){if(this.depthOcclusion)return new t.af(this.context.gl.GREATER,t.af.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!n)return t.af.disabled;const o=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new t.af(i||this.context.gl.LEQUAL,r,[o,o])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const e=this.context.gl,r=Math.ceil(this.width),i=Math.ceil(this.height),n=this.context.bindFramebuffer.get(),o=e.getParameter(e.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===r&&this.depthFBO.height===i||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),0!==r&&0!==i&&(this.depthFBO=new it(this.context,r,i,!1,"texture"),this.depthTexture=new t.T(this.context,{width:r,height:i,data:null},e.DEPTH_STENCIL),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(n),e.bindTexture(e.TEXTURE_2D,o),this.depthFBO&&(e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),e.blitFramebuffer(0,0,r,i,0,0,r,i,e.DEPTH_BUFFER_BIT,e.NEAREST),e.bindFramebuffer(e.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(0===this._dt?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce(((t,e)=>t+e/this._fpsHistory.length),0))}render(e,r){const i=t.e.now();this._dt=i-this._timeStamp,this._timeStamp=i,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=e.map.repaint,this.style=e,this.options=r;const n=this.style._mergedLayers,o=this.style.order.filter((t=>{const e=n[t];return!(e.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[e.type]}));let s=!1,a=!1;for(const t of o){const e=n[t];"circle"===e.type&&(s=!0),"symbol"===e.type&&(e.hasInitialOcclusionOpacityProperties?a=!0:s=!0)}const l=o.map((t=>n[t])),c=this.style._mergedSourceCaches;this.imageManager=e.imageManager,this.modelManager=e.modelManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.e.now()),this.imageManager.beginFrame();let u=0,h=!1;for(const t in c){const e=c[t];e.used&&(e.prepare(this.context),e.getSource().usedInConflation&&++u)}let d=!1;for(const t of l)t.isHidden(this.transform.zoom)||("clip"===t.type&&(d=!0),this.prepareLayer(t));const p={},f={},m={},g={},y={};for(const t in c){const e=c[t];p[t]=e.getVisibleCoordinates(),f[t]=p[t].slice().reverse(),m[t]=e.getVisibleCoordinates(!0).reverse(),g[t]=e.getShadowCasterCoordinates(),y[t]=e.sortCoordinatesByDistance(p[t])}const v=t=>{const e=this.style.getLayerSourceCache(t);return e&&e.used?e.getSource():null};if(u||d){const e=[],r=[];let i=0;for(const t of l)this.isSourceForClippingOrConflation(t,v(t))&&(e.push(t),r.push(i)),i++;if(e&&(d||e.length>1)){const i=[];for(let n=0;n<e.length;n++){const o=e[n],s=r[n],a=this.style.getLayerSourceCache(o);if(!a||!a.used||!a.getSource().usedInConflation&&"clip"!==o.type)continue;let l=t.cv,c=t.cw.None;const u=[];if("clip"===o.type){l=s;for(const e of o.layout.get("clip-layer-types"))c|="model"===e?t.cw.Model:"symbol"===e?t.cw.Symbol:t.cw.FillExtrusion;for(const t of o.layout.get("clip-layer-scope"))u.push(t)}i.push({layer:o.fqid,cache:a,order:l,clipMask:c,clipScope:u})}this.replacementSource.setSources(i),h=!0}}h||this.replacementSource.clear(),this.conflationActive=h,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let t=0;t<l.length;t++){const e=l[t],r=e.cutoffRange();if(this.longestCutoffRange=Math.max(r,this.longestCutoffRange),r>0){const t=v(e);t&&(this.minCutoffZoom=Math.max(t.minzoom,this.minCutoffZoom)),e.minzoom&&(this.minCutoffZoom=Math.max(e.minzoom,this.minCutoffZoom))}e.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=t),this._lastOcclusionLayer=t)}const _=this.style&&this.style.fog;_?(this._fogVisible=0!==_.getOpacity(this.transform.pitch),this._fogVisible&&"globe"!==this.transform.projection.name&&(this._fogVisible=_.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(m),this.opaquePassCutoff=0);const b=this._shadowRenderer;if(b){b.updateShadowParameters(this.transform,this.style.directionalLight);for(const t in c)for(const e of p[t]){let t={min:0,max:0};this.terrain&&(t=this.terrain.getMinMaxForTile(e)||t),b.addShadowReceiver(e.toUnwrapped(),t.min,t.max)}}if("globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new t.ct(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new sn(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!t.cu(this.context.gl))return;this.renderPass="offscreen";for(const t of l){const r=e.getLayerSourceCache(t);if(!t.hasOffscreenPass()||t.isHidden(this.transform.zoom))continue;const i=r?f[r.id]:void 0;("custom"===t.type||"raster"===t.type||"raster-particle"===t.type||t.isSky()||i&&i.length)&&this.renderLayer(this,r,t,i)}this.depthRangeFor3D=[0,1-(l.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,g)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const x="globe"===this.transform.projection.name||this.transform.isHorizonVisible(),w=(()=>{if(r.showOverdrawInspector)return t.C.black;const e=this.style.fog;if(e&&this.transform.projection.supportsFog){const r=this.style.getLut(e.scope);if(!x){const i=e.properties.get("color").toRenderColor(r).toArray01();return new t.C(...i)}if(x){const i=e.properties.get("space-color").toRenderColor(r).toArray01();return new t.C(...i)}}return t.C.transparent})();if(this.context.clear({color:w,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&x&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=o.length-1;this.currentLayer>=0;this.currentLayer--){const t=l[this.currentLayer],r=e.getLayerSourceCache(t);if(t.isSky())continue;const i=r?(t.is3D()?y:f)[r.id]:void 0;this._renderTileClippingMasks(t,r,i),this.renderLayer(this,r,t,i)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&x&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||t.a2(this.transform.zoom)>0)&&("globe"===this.transform.projection.name||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<o.length;this.currentLayer++){const t=l[this.currentLayer],r=e.getLayerSourceCache(t);t.isSky()&&this.renderLayer(this,r,t,r?f[r.id]:void 0)}function T(t,e){let r;return e&&(r=("symbol"===t.type?m:t.is3D()?y:f)[e.id]),r}if(this.renderPass="translucent","globe"===this.transform.projection.name){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<o.length;){const t=l[this.currentLayer];if("raster"===t.type||"raster-particle"===t.type){const r=e.getLayerSourceCache(t);this.renderLayer(this,r,t,T(t,r))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let E=0;b&&(E=b.getShadowCastingLayerCount());let S=!1,P=-1;for(let t=0;t<o.length;++t){const e=l[t];e.isHidden(this.transform.zoom)||e.is3D()&&(P=t)}for(a&&-1===P&&(s=!0);this.currentLayer<o.length;){const t=l[this.currentLayer],r=e.getLayerSourceCache(t);if(t.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(t)){if(t.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(s&&!S&&this.terrain&&!this.transform.isOrthographic&&(S=!0,this.blitDepth()),a&&-1!==P&&this.currentLayer===P+1&&!this.transform.isOrthographic&&this.blitDepth(),t.is3D()||this.terrain||this._renderTileClippingMasks(t,r,r?p[r.id]:void 0),this.renderLayer(this,r,t,T(t,r)),!this.terrain&&b&&E>0&&t.hasShadowPass()&&0==--E&&(b.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const t=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=t;this.currentLayer++){const t=l[this.currentLayer];if(!t.hasLightBeamPass())continue;const r=e.getLayerSourceCache(t);this.renderLayer(this,r,t,r?f[r.id]:void 0)}this.currentLayer=t,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const t=this.currentLayer;this.depthOcclusion=!0;for(const t of this.layersWithOcclusionOpacity){this.currentLayer=t;const r=l[this.currentLayer],i=e.getLayerSourceCache(r),n=i?f[i.id]:void 0;r.is3D()||this.terrain||this._renderTileClippingMasks(r,i,i?p[i.id]:void 0),this.renderLayer(this,i,r,n)}this.depthOcclusion=!1,this.currentLayer=t,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let r=null;l.forEach((t=>{const i=e.getLayerSourceCache(t);i&&!t.isHidden(this.transform.zoom)&&i.getVisibleCoordinates().length&&(!r||r.getSource().maxzoom<i.getSource().maxzoom)&&(r=i)})),r&&this.options.showTileBoundaries&&Tn.debug(this,r,r.getVisibleCoordinates(),t.C.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Tn.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new t.C(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(t){const e=t.transform.padding;Wi(t,t.transform.height-(e.top||0),3,Vi),Wi(t,e.bottom||0,3,Ui),Zi(t,e.left||0,3,$i),Zi(t,t.transform.width-(e.right||0),3,Gi);const r=t.transform.centerPoint;!function(t,e,r,i){Xi(t,e-1,r-10,2,20,i),Xi(t,e-10,r-1,20,2,i)}(t,r.x,t.transform.height-r.y,Hi)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),h||(this.conflationActive=!1)}prepareLayer(t){this.gpuTimingStart(t);const{unsupportedLayers:e}=this.transform.projection,r=!e||!e.includes(t.type);if(En[t.type]&&(r||this.terrain&&"custom"===t.type)){const e=this.style.getLayerSourceCache(t);En[t.type](t,e,this)}this.gpuTimingEnd()}renderLayer(t,e,r,i){r.isHidden(this.transform.zoom)||("background"===r.type||"sky"===r.type||"custom"===r.type||"model"===r.type||"raster"===r.type||"raster-particle"===r.type||i&&i.length)&&(this.id=r.id,this.gpuTimingStart(r),t.transform.projection.unsupportedLayers&&t.transform.projection.unsupportedLayers.includes(r.type)&&(!t.terrain||"custom"!==r.type)||"clip"===r.type||Tn[r.type](t,e,r,i,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery,r=this.context.gl;let i=this.gpuTimers[t.id];i||(i=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:r.createQuery()}),i.calls++,r.beginQuery(e.TIME_ELAPSED_EXT,i.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,e=this.context.gl,r=e.createQuery();this.deferredRenderGpuTimeQueries.push(r),e.beginQuery(t.TIME_ELAPSED_EXT,r)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const e={};for(const r in t){const i=t[r],n=this.context.extTimerQuery,o=n.getQueryParameter(i.query,this.context.gl.QUERY_RESULT)/1e6;n.deleteQueryEXT(i.query),e[r]=o}return e}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const e=this.context.extTimerQuery,r=this.context.gl;let i=0;for(const n of t)i+=e.getQueryParameter(n,r.QUERY_RESULT)/1e6,e.deleteQueryEXT(n);return i}translatePosMatrix(e,r,i,n,o){if(!i[0]&&!i[1])return e;const s=o?"map"===n?this.transform.angle:0:"viewport"===n?-this.transform.angle:0;if(s){const t=Math.sin(s),e=Math.cos(s);i=[i[0]*e-i[1]*t,i[0]*t+i[1]*e]}const a=[o?i[0]:t.bD(r,i[0],this.transform.zoom),o?i[1]:t.bD(r,i[1],this.transform.zoom),0],l=new Float32Array(16);return t.ae.translate(l,e,a),l}saveTileTexture(t){const e=t.size[0],r=this._tileTextures[e];r?r.push(t):this._tileTextures[e]=[t]}getTileTexture(t){const e=this._tileTextures[t];return e&&e.length>0?e.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return null!=this.context.extTextureFloatLinear}currentGlobalDefines(t,e,r){const i=void 0===r?this.terrain&&this.terrain.renderingToTexture:r,n=[];return this.style&&this.style.enable3dLights()&&("globeRaster"===t||"terrainRaster"===t?(n.push("LIGHTING_3D_MODE"),n.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):i||n.push("LIGHTING_3D_MODE")),"shadow"===this.renderPass?this._shadowMapDebug||n.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?n.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):n.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(n.push("TERRAIN"),this.linearFloatFilteringSupported()&&n.push("TERRAIN_DEM_FLOAT_FORMAT")),"globe"===this.transform.projection.name&&n.push("GLOBE"),!this._fogVisible||i||void 0!==e&&!e||n.push("FOG","FOG_DITHERING"),i&&n.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&n.push("OVERDRAW_INSPECTOR"),n}getOrCreateProgram(t,e){this.cache=this.cache||{};const r=e&&e.defines||[],i=e&&e.config,n=this.currentGlobalDefines(t,e&&e.overrideFog,e&&e.overrideRtt).concat(r),o=zr.cacheKey(Se[t],t,n,i);return this.cache[o]||(this.cache[o]=new zr(this.context,t,Se[t],i,mi[t],n)),this.cache[o]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(e,r){if(this.style.enable3dLights()){const i=this.style.directionalLight,n=this.style.ambientLight;if(i&&n){const o=((e,r,i)=>{const n=e.properties.get("direction"),o=e.properties.get("color").toRenderColor(i.getLut(e.scope)).toArray01(),s=e.properties.get("intensity"),a=r.properties.get("color").toRenderColor(i.getLut(r.scope)).toArray01(),l=r.properties.get("intensity"),c=[n.x,n.y,n.z],u=t.bC(a,l),h=t.bC(o,s);return{u_lighting_ambient_color:u,u_lighting_directional_dir:c,u_lighting_directional_color:h,u_ground_radiance:Rr(c,h,u)}})(i,n,this.style);r.setLightsUniformValues(e,o)}}}uploadCommonUniforms(e,r,i,n,o){if(this.uploadCommonLightUniforms(e,r),this.terrain&&this.terrain.renderingToTexture)return;const s=this.style.fog;if(s){const o=s.getOpacity(this.transform.pitch),a=((e,r,i,n,o,s,a,l,c,u,h,d)=>{const p=e.transform,f=r.properties.get("color").toRenderColor(e.style.getLut(r.scope)).toArray01();f[3]=n;const m=e.frameCounter/1e3%1,[g,y]=r.properties.get("vertical-range");return{u_fog_matrix:i?p.calculateFogTileMatrix(i):d||e.identityMat,u_fog_range:r.getFovAdjustedRange(p._fov),u_fog_color:f,u_fog_horizon_blend:r.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(g,y),y],u_fog_temporal_offset:m,u_frustum_tl:o,u_frustum_tr:s,u_frustum_br:a,u_frustum_bl:l,u_globe_pos:c,u_globe_radius:u,u_viewport:h,u_globe_transition:t.a2(p.zoom),u_is_globe:+("globe"===p.projection.name)}})(this,s,i,o,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*t.e.devicePixelRatio,this.transform.height*t.e.devicePixelRatio],n);r.setFogUniformValues(e,a)}o&&r.setCutoffUniformValues(e,o.uniformValues)}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){const t=this.canvasCopy();t&&(this.frameCopies.push(t),this.tileLoaded=!1)}canvasCopy(){const t=this.context.gl,e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),e}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&0!==t.getOpacity(this.transform.pitch)}getBackgroundTiles(){const e=this._backgroundTiles,r=this._backgroundTiles={},i=this.transform.coveringTiles({tileSize:512});for(const n of i)r[n.key]=e[n.key]||new t.bA(n,512,this.transform.tileZoom,this);return r}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(t,e){return!(!t.is3D()||t.minzoom&&t.minzoom>this.transform.zoom||(this.style._clipLayerIndices.length||"building"!==t.sourceLayer)&&"clip"!==t.type&&(!e||"batched-model"!==e.type))}isTileAffectedByFog(t){if(!this.style||!this.style.fog)return!1;if("globe"===this.transform.projection.name)return!0;let e=this._cachedTileFogOpacities[t.key];return e||(this._cachedTileFogOpacities[t.key]=e=this.style.fog.getOpacityForTile(t)),e[0]>=Qt||e[1]>=Qt}setupDepthForOcclusion(t,e,r){const i=this.context,n=i.gl,o=!!r;var s;r||(r={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),i.activeTexture.set(n.TEXTURE3),t&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(n.NEAREST,n.CLAMP_TO_EDGE),r.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],r.u_depth_range_unpack=[2/((s=this.depthRangeFor3D)[1]-s[0]),-1-2*s[0]/(s[1]-s[0])],r.u_occluder_half_size=.5*this.occlusionParams.occluderSize,r.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(n.NEAREST,n.CLAMP_TO_EDGE),i.activeTexture.set(n.TEXTURE0),o||e.setTerrainUniformValues(i,r)}}class Pn{constructor(t,e,r,i){this.screenBounds=t,this.cameraPoint=e,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=r,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,i)}static createFromScreenPoints(e,r){let i,n;if(e instanceof t.P||"number"==typeof e[0]){const o=t.P.convert(e);i=[o],n=r.isPointAboveHorizon(o)}else{const o=t.P.convert(e[0]),s=t.P.convert(e[1]);i=[o,s],n=t.cx(o,s).every((t=>r.isPointAboveHorizon(t)))}return new Pn(i,r.getCameraPoint(),n,r)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(e){return t.cx(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],e)}bufferedCameraGeometry(e){const r=this.screenBounds[0],i=1===this.screenBounds.length?this.screenBounds[0].add(new t.P(1,1)):this.screenBounds[1],n=t.cx(r,i,0,!1);return this.cameraPoint.y>i.y&&(this.cameraPoint.x>r.x&&this.cameraPoint.x<i.x?n.splice(3,0,this.cameraPoint):this.cameraPoint.x>=i.x?n[2]=this.cameraPoint:this.cameraPoint.x<=r.x&&(n[3]=this.cameraPoint)),t.cy(n,e)}bufferedCameraGeometryGlobe(e){const r=this.screenBounds[0],i=1===this.screenBounds.length?this.screenBounds[0].add(new t.P(1,1)):this.screenBounds[1],n=t.cx(r,i,e),o=this.cameraPoint.clone();switch(3*((o.y>r.y)+(o.y>i.y))+((o.x>r.x)+(o.x>i.x))){case 0:n[0]=o,n[4]=o.clone();break;case 1:n.splice(1,0,o);break;case 2:n[1]=o;break;case 3:n.splice(4,0,o);break;case 5:n.splice(2,0,o);break;case 6:n[3]=o;break;case 7:n.splice(3,0,o);break;case 8:n[2]=o}return n}containsTile(e,r,i,n=0){const o=e.queryPadding/r._pixelsPerMercatorPixel+1,s=i?this._bufferedCameraMercator(o,r):this._bufferedScreenMercator(o,r);let a=e.tileID.wrap+(s.unwrapped?n:0);const l=s.polygon.map((r=>t.cz(e.tileTransform,r,a)));if(!t.cA(l,0,0,t.a4,t.a4))return;a=e.tileID.wrap+(this.screenGeometryMercator.unwrapped?n:0);const c=this.screenGeometryMercator.polygon.map((r=>t.cB(e.tileTransform,r,a))),u=c.map((e=>new t.P(e[0],e[1]))),h=r.getFreeCameraOptions().position||new t._(0,0,0),d=t.cB(e.tileTransform,h,a),p=c.map((e=>{const r=t.$.sub(e,e,d);return t.$.normalize(r,r),new t.aU(d,r)})),f=t.bD(e,1,r.zoom)*r._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:u,tilespaceRays:p,bufferedTilespaceGeometry:l,bufferedTilespaceBounds:(m=t.cC(l),m.min.x=t.au(m.min.x,0,t.a4),m.min.y=t.au(m.min.y,0,t.a4),m.max.x=t.au(m.max.x,0,t.a4),m.max.y=t.au(m.max.y,0,t.a4),m),tile:e,tileID:e.tileID,pixelToTileUnitsFactor:f};var m}_bufferedScreenMercator(t,e){const r=Mn(t);if(this._screenRaycastCache[r])return this._screenRaycastCache[r];{let i;return i="globe"===e.projection.name?this._projectAndResample(this.bufferedScreenGeometry(t),e):{polygon:this.bufferedScreenGeometry(t).map((t=>e.pointCoordinate3D(t))),unwrapped:!0},this._screenRaycastCache[r]=i,i}}_bufferedCameraMercator(t,e){const r=Mn(t);if(this._cameraRaycastCache[r])return this._cameraRaycastCache[r];{let i;return i="globe"===e.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),e):{polygon:this.bufferedCameraGeometry(t).map((t=>e.pointCoordinate3D(t))),unwrapped:!0},this._cameraRaycastCache[r]=i,i}}_projectAndResample(e,r){const i=function(e,r){const i=t.ae.multiply([],r.pixelMatrix,r.globeMatrix),n=[0,-t.cF,0,1],o=[0,t.cF,0,1],s=[0,0,0,1];t.aB.transformMat4(n,n,i),t.aB.transformMat4(o,o,i),t.aB.transformMat4(s,s,i);const a=new t.P(n[0]/n[3],n[1]/n[3]),l=new t.P(o[0]/o[3],o[1]/o[3]),c=t.cD(e,a)&&n[3]<s[3],u=t.cD(e,l)&&o[3]<s[3];if(!c&&!u)return null;const h=function(t,e,r){for(let i=1;i<t.length;i++){const n=An(e.pointCoordinate3D(t[i-1]).x),o=An(e.pointCoordinate3D(t[i]).x);if(r<0){if(n<o)return{idx:i,t:-n/(o-1-n)}}else if(o<n)return{idx:i,t:(1-n)/(o+1-n)}}return null}(e,r,c?-1:1);if(!h)return null;const{idx:d,t:p}=h;let f=d>1?kn(e.slice(0,d),r):[],m=d<e.length?kn(e.slice(d),r):[];f=f.map((e=>new t.P(An(e.x),e.y))),m=m.map((e=>new t.P(An(e.x),e.y)));const g=[...f];0===g.length&&g.push(m[m.length-1]);const y=t.a3(g[g.length-1].y,(0===m.length?f[0]:m[0]).y,p);let v;return v=c?[new t.P(0,y),new t.P(0,0),new t.P(1,0),new t.P(1,y)]:[new t.P(1,y),new t.P(1,1),new t.P(0,1),new t.P(0,y)],g.push(...v),0===m.length?g.push(f[0]):g.push(...m),{polygon:g.map((e=>new t._(e.x,e.y))),unwrapped:!1}}(e,r);if(i)return i;const n=function(e,r){let i=!1,n=-1/0,o=0;for(let t=0;t<e.length-1;t++)e[t].x>n&&(n=e[t].x,o=t);for(let t=0;t<e.length-1;t++){const r=(o+t)%(e.length-1),n=e[r],s=e[r+1];Math.abs(n.x-s.x)>.5&&(n.x<s.x?(n.x+=1,0===r&&(e[e.length-1].x+=1)):(s.x+=1,r+1===e.length-1&&(e[0].x+=1)),i=!0)}const s=t.ak(r.center.lng);return i&&s<Math.abs(s-1)&&e.forEach((t=>{t.x-=1})),{polygon:e,unwrapped:i}}(kn(e,r).map((e=>new t.P(An(e.x),e.y))),r);return{polygon:n.polygon.map((e=>new t._(e.x,e.y))),unwrapped:n.unwrapped}}}function kn(e,r){return t.cE(e,(t=>{const e=r.pointCoordinate3D(t);t.x=e.x,t.y=e.y}),1/256)}function An(t){return t<0?1+t%1:t%1}function Mn(t){return 100*t|0}function Cn(e,r){const i=t.ae.identity([]);return t.ae.scale(i,i,[.5*e.width,.5*-e.height,1]),t.ae.translate(i,i,[1,-1,0]),t.ae.multiply(i,i,e.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(i)}function In(t,e,r,i,n,o,s,a=!1){const l=t.tilesIn(i,s,a);l.sort(Ln);const c=[];for(const i of l)c.push({wrappedTileID:i.tile.tileID.wrapped().key,queryResults:i.tile.queryRenderedFeatures(e,r,t._state,i,n,o,Cn(t.transform,i.tile.tileID),a)});const u=function(t){const e={},r={};for(const i of t){const t=i.queryResults,n=i.wrappedTileID,o=r[n]=r[n]||{};for(const r in t){const i=t[r],n=o[r]=o[r]||{},s=e[r]=e[r]||[];for(const t of i)n[t.featureIndex]||(n[t.featureIndex]=!0,s.push(t))}}return e}(c);for(const e in u)u[e].forEach((e=>{const r=e.feature,i=r.layer;i&&"background"!==i.type&&"sky"!==i.type&&"slot"!==i.type&&(r.source=i.source,i["source-layer"]&&(r.sourceLayer=i["source-layer"]),r.state=void 0!==r.id?t.getFeatureState(i["source-layer"],r.id):{})}));return u}function On(t,e){const r=t.getRenderableIds().map((e=>t.getTileByID(e))),i=[],n={};for(let t=0;t<r.length;t++){const o=r[t],s=o.tileID.canonical.key;n[s]||(n[s]=!0,o.querySourceFeatures(i,e))}return i}function Ln(t,e){const r=t.tileID,i=e.tileID;return r.overscaledZ-i.overscaledZ||r.canonical.y-i.canonical.y||r.wrap-i.wrap||r.canonical.x-i.canonical.x}class Dn{constructor(t){this.style=t,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const t=!1,e=!1;for(const r in this.style._mergedLayers){const i=this.style._mergedLayers[r];if("fill-extrusion"===i.type)this.layers.push({layer:i,visible:t,visibilityChanged:e});else if("model"===i.type){const r=this.style.getLayerSource(i);r&&"batched-model"===r.type&&this.layers.push({layer:i,visible:t,visibilityChanged:e})}}}onNewFrame(t){this.layersGotHidden=!1;for(const e of this.layers){const r=e.layer;let i=!1;"fill-extrusion"===r.type?i=!r.isHidden(t)&&r.paint.get("fill-extrusion-opacity")>0:"model"===r.type&&(i=!r.isHidden(t)&&r.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!i&&e.visible,e.visible=i}}updateZOffset(t,e){this.currentBuildingBuckets=[];for(const t of this.layers){const r=t.layer,i=this.style.getLayerSourceCache(r);let n=1;"fill-extrusion"===r.type&&(n=t.visible?r.paint.get("fill-extrusion-vertical-scale"):0);let o=i?i.getTile(e):null;if(!o&&i&&e.canonical.z>i.getSource().minzoom){let t=e.scaledTo(Math.min(i.getSource().maxzoom,e.overscaledZ-1));for(;t.overscaledZ>=i.getSource().minzoom&&(o=i.getTile(t),!o&&0!==t.overscaledZ);)t=t.scaledTo(t.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:o?o.getBucket(r):null,tileID:o?o.tileID:e,verticalScale:n})}t.hasAnyZOffset=!1;let r=!1;for(let i=0;i<t.symbolInstances.length;i++){const n=t.symbolInstances.get(i),o=n.zOffset,s=this._getHeightAtTileOffset(e,n.tileAnchorX,n.tileAnchorY);n.zOffset=s!==Number.NEGATIVE_INFINITY?s:o,r||o===n.zOffset||(r=!0),t.hasAnyZOffset||0===n.zOffset||(t.hasAnyZOffset=!0)}r&&(t.zOffsetBuffersNeedUpload=!0,t.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(e,r,i,n){let o=r,s=i;if(e.canonical.z!==n.canonical.z){const a=n.canonical,l=1/(1<<e.canonical.z-a.z);o=(r+e.canonical.x*t.a4)*l-a.x*t.a4|0,s=(i+e.canonical.y*t.a4)*l-a.y*t.a4|0}return{tileX:o,tileY:s}}_getHeightAtTileOffset(t,e,r){let i,n;for(let o=0;o<this.layers.length;++o){if("fill-extrusion"!==this.layers[o].layer.type)continue;const{bucket:s,tileID:a,verticalScale:l}=this.currentBuildingBuckets[o];if(!s)continue;const{tileX:c,tileY:u}=this._mapCoordToOverlappingTile(t,e,r,a),h=s.getHeightAtTileCoord(c,u);h&&void 0!==h.height&&(h.hidden?i=h.height:n=Math.max(h.height*l,n||0))}if(void 0!==n)return n;for(let n=0;n<this.layers.length;++n){const o=this.layers[n];if("model"!==o.layer.type||!o.visible)continue;const{bucket:s,tileID:a}=this.currentBuildingBuckets[n];if(!s)continue;const{tileX:l,tileY:c}=this._mapCoordToOverlappingTile(t,e,r,a),u=s.getHeightAtTileCoord(l,c);if(u&&!u.hidden)return void 0===u.height&&void 0!==i?Math.min(u.maxHeight,i)*u.verticalScale:u.height?u.height*u.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Rn(e,r){const i={};for(const t in e)"ref"!==t&&(i[t]=e[t]);return t.cG.forEach((t=>{t in r&&(i[t]=r[t])})),i}function Fn(t){t=t.slice();const e=Object.create(null);for(let r=0;r<t.length;r++)e[t[r].id]=t[r];for(let r=0;r<t.length;r++)"ref"in t[r]&&(t[r]=Rn(t[r],e[t[r].ref]));return t}const Bn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function zn(t,e,r){r.push({command:Bn.addSource,args:[t,e[t]]})}function jn(t,e,r){e.push({command:Bn.removeSource,args:[t]}),r[t]=!0}function Nn(t,e,r,i){jn(t,r,i),zn(t,e,r)}function Vn(e,r,i){let n;for(n in e[i])if(e[i].hasOwnProperty(n)&&"data"!==n&&!t.d(e[i][n],r[i][n]))return!1;for(n in r[i])if(r[i].hasOwnProperty(n)&&"data"!==n&&!t.d(e[i][n],r[i][n]))return!1;return!0}function Un(e,r,i,n,o,s){let a;for(a in r=r||{},e=e||{})e.hasOwnProperty(a)&&(t.d(e[a],r[a])||i.push({command:s,args:[n,a,r[a],o]}));for(a in r)r.hasOwnProperty(a)&&!e.hasOwnProperty(a)&&(t.d(e[a],r[a])||i.push({command:s,args:[n,a,r[a],o]}))}function $n(t){return t.id}function Gn(t,e){return t[e.id]=e,t}class Hn{constructor(t,e){this.reset(t,e)}reset(t,e){this.points=t||[],this._distances=[0];for(let t=1;t<this.points.length;t++)this._distances[t]=this._distances[t-1]+this.points[t].dist(this.points[t-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.au(e,0,1);let r=1,i=this._distances[r];const n=e*this.paddedLength+this.padding;for(;i<n&&r<this._distances.length;)i=this._distances[++r];const o=r-1,s=this._distances[o],a=i-s,l=a>0?(n-s)/a:0;return this.points[o].mult(1-l).add(this.points[r].mult(l))}}class qn{constructor(t,e,r){const i=this.boxCells=[],n=this.circleCells=[];this.xCellCount=Math.ceil(t/r),this.yCellCount=Math.ceil(e/r);for(let t=0;t<this.xCellCount*this.yCellCount;t++)i.push([]),n.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,e,r,i,n){this._forEachCell(e,r,i,n,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(n)}insertCircle(t,e,r,i){this._forEachCell(e-i,r-i,e+i,r+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(r),this.circles.push(i)}_insertBoxCell(t,e,r,i,n,o){this.boxCells[n].push(o)}_insertCircleCell(t,e,r,i,n,o){this.circleCells[n].push(o)}_query(t,e,r,i,n,o){if(r<0||t>this.width||i<0||e>this.height)return!n&&[];const s=[];if(t<=0&&e<=0&&this.width<=r&&this.height<=i){if(n)return!0;for(let t=0;t<this.boxKeys.length;t++)s.push({key:this.boxKeys[t],x1:this.bboxes[4*t],y1:this.bboxes[4*t+1],x2:this.bboxes[4*t+2],y2:this.bboxes[4*t+3]});for(let t=0;t<this.circleKeys.length;t++){const e=this.circles[3*t],r=this.circles[3*t+1],i=this.circles[3*t+2];s.push({key:this.circleKeys[t],x1:e-i,y1:r-i,x2:e+i,y2:r+i})}return o?s.filter(o):s}return this._forEachCell(t,e,r,i,this._queryCell,s,{hitTest:n,seenUids:{box:{},circle:{}}},o),n?s.length>0:s}_queryCircle(t,e,r,i,n){const o=t-r,s=t+r,a=e-r,l=e+r;if(s<0||o>this.width||l<0||a>this.height)return!i&&[];const c=[];return this._forEachCell(o,a,s,l,this._queryCellCircle,c,{hitTest:i,circle:{x:t,y:e,radius:r},seenUids:{box:{},circle:{}}},n),i?c.length>0:c}query(t,e,r,i,n){return this._query(t,e,r,i,!1,n)}hitTest(t,e,r,i,n){return this._query(t,e,r,i,!0,n)}hitTestCircle(t,e,r,i){return this._queryCircle(t,e,r,!0,i)}_queryCell(t,e,r,i,n,o,s,a){const l=s.seenUids,c=this.boxCells[n];if(null!==c){const n=this.bboxes;for(const u of c)if(!l.box[u]){l.box[u]=!0;const c=4*u;if(t<=n[c+2]&&e<=n[c+3]&&r>=n[c+0]&&i>=n[c+1]&&(!a||a(this.boxKeys[u]))){if(s.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[u],x1:n[c],y1:n[c+1],x2:n[c+2],y2:n[c+3]})}}}const u=this.circleCells[n];if(null!==u){const n=this.circles;for(const c of u)if(!l.circle[c]){l.circle[c]=!0;const u=3*c;if(this._circleAndRectCollide(n[u],n[u+1],n[u+2],t,e,r,i)&&(!a||a(this.circleKeys[c]))){if(s.hitTest)return o.push(!0),!0;{const t=n[u],e=n[u+1],r=n[u+2];o.push({key:this.circleKeys[c],x1:t-r,y1:e-r,x2:t+r,y2:e+r})}}}}}_queryCellCircle(t,e,r,i,n,o,s,a){const l=s.circle,c=s.seenUids,u=this.boxCells[n];if(null!==u){const t=this.bboxes;for(const e of u)if(!c.box[e]){c.box[e]=!0;const r=4*e;if(this._circleAndRectCollide(l.x,l.y,l.radius,t[r+0],t[r+1],t[r+2],t[r+3])&&(!a||a(this.boxKeys[e])))return o.push(!0),!0}}const h=this.circleCells[n];if(null!==h){const t=this.circles;for(const e of h)if(!c.circle[e]){c.circle[e]=!0;const r=3*e;if(this._circlesCollide(t[r],t[r+1],t[r+2],l.x,l.y,l.radius)&&(!a||a(this.circleKeys[e])))return o.push(!0),!0}}}_forEachCell(t,e,r,i,n,o,s,a){const l=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),u=this._convertToXCellCoord(r),h=this._convertToYCellCoord(i);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++)if(n.call(this,t,e,r,i,this.xCellCount*l+d,o,s,a))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,e,r,i,n,o){const s=i-t,a=n-e,l=r+o;return l*l>s*s+a*a}_circleAndRectCollide(t,e,r,i,n,o,s){const a=(o-i)/2,l=Math.abs(t-(i+a));if(l>a+r)return!1;const c=(s-n)/2,u=Math.abs(e-(n+c));if(u>c+r)return!1;if(l<=a||u<=c)return!0;const h=l-a,d=u-c;return h*h+d*d<=r*r}}const Wn=100;class Zn{constructor(t,e,r=new qn(t.width+200,t.height+200,25),i=new qn(t.width+200,t.height+200,25)){this.transform=t,this.grid=r,this.ignoredGrid=i,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Wn,this.screenBottomBoundary=t.height+Wn,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=e}placeCollisionBox(t,e,r,i,n,o,s,a){let l=r.projectedAnchorX,c=r.projectedAnchorY,u=r.projectedAnchorZ;const h=r.elevation,d=r.tileID,p=t.getProjection();if(h&&d){const[t,e,i]=p.upVector(d.canonical,r.tileAnchorX,r.tileAnchorY),n=p.upVectorScale(d.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;l+=t*h*n,c+=e*h*n,u+=i*h*n}const f=this.projectAndGetPerspectiveRatio(s,l,c,u,r.tileID,"globe"===p.name||!!h||this.transform.pitch>0,p),m=o*f.perspectiveRatio,g=(r.x1*e+i.x-r.padding)*m+f.point.x,y=(r.y1*e+i.y-r.padding)*m+f.point.y,v=(r.x2*e+i.x+r.padding)*m+f.point.x,_=(r.y2*e+i.y+r.padding)*m+f.point.y,b=f.perspectiveRatio<=.55||f.occluded;return!this.isInsideGrid(g,y,v,_)||!n&&this.grid.hitTest(g,y,v,_,a)||b?{box:[],offscreen:!1,occluded:f.occluded}:{box:[g,y,v,_],offscreen:this.isOffscreen(g,y,v,_),occluded:!1}}placeCollisionCircles(e,r,i,n,o,s,a,l,c,u,h,d,p,f,m){const g=[],y=this.transform.elevation,v=e.getProjection(),_=y?y.getAtTileOffsetFunc(m,this.transform.center.lat,this.transform.worldSize,v):null,b=new t.P(i.tileAnchorX,i.tileAnchorY);let{x,y:w,z:T}=v.projectTilePoint(b.x,b.y,m.canonical);if(_){const[t,e,r]=_(b);x+=t,w+=e,T+=r}const E="globe"===v.name,S=this.projectAndGetPerspectiveRatio(a,x,w,T,m,E||!!y||this.transform.pitch>0,v),{perspectiveRatio:P}=S,k=(h?s/P:s*P)/t.bP,A=Ye(x,w,T,l),M=S.signedDistanceFromCamera>0?tr(k,o,i.lineOffsetX*k,i.lineOffsetY*k,!1,A,b,i,n,l,{},y&&!h?_:null,h&&!!y,v,m,h):null;let C=!1,I=!1,O=!0;if(M&&!S.occluded){const e=.5*p*P+f,i=new t.P(-100,-100),n=new t.P(this.screenRightBoundary,this.screenBottomBoundary),o=new Hn,{first:s,last:a}=M,l=s.path.length;let h=[];for(let t=l-1;t>=1;t--)h.push(s.path[t]);for(let t=1;t<a.path.length;t++)h.push(a.path[t]);const m=2.5*e;c&&(h=h.map((([t,e,r],i)=>(_&&!E&&(r=_(i<l-1?s.tilePath[l-1-i]:a.tilePath[i-l+2])[2]),Ye(t,e,r,c)))),h.some((t=>t[3]<=0))&&(h=[]));let y=[];if(h.length>0){let e=1/0,r=-1/0,o=1/0,s=-1/0;for(const t of h)e=Math.min(e,t[0]),o=Math.min(o,t[1]),r=Math.max(r,t[0]),s=Math.max(s,t[1]);r>=i.x&&e<=n.x&&s>=i.y&&o<=n.y&&(y=[h.map((e=>new t.P(e[0],e[1])))],(e<i.x||r>n.x||o<i.y||s>n.y)&&(y=t.cH(y,i.x,i.y,n.x,n.y)))}for(const t of y){o.reset(t,.25*e);let i=0;i=o.length<=.5*e?1:Math.ceil(o.paddedLength/m)+1;for(let t=0;t<i;t++){const n=t/Math.max(i-1,1),s=o.lerp(n),a=s.x+Wn,l=s.y+Wn;g.push(a,l,e,0);const c=a-e,h=l-e,p=a+e,f=l+e;if(O=O&&this.isOffscreen(c,h,p,f),I=I||this.isInsideGrid(c,h,p,f),!r&&this.grid.hitTestCircle(a,l,e,d)&&(C=!0,!u))return{circles:[],offscreen:!1,collisionDetected:C,occluded:!1}}}}return{circles:!u&&C||!I?[]:g,offscreen:O,collisionDetected:C,occluded:S.occluded}}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const r=[];let i=1/0,n=1/0,o=-1/0,s=-1/0;for(const a of e){const e=new t.P(a.x+Wn,a.y+Wn);i=Math.min(i,e.x),n=Math.min(n,e.y),o=Math.max(o,e.x),s=Math.max(s,e.y),r.push(e)}const a=this.grid.query(i,n,o,s).concat(this.ignoredGrid.query(i,n,o,s)),l={},c={};for(const e of a){const i=e.key;if(void 0===l[i.bucketInstanceId]&&(l[i.bucketInstanceId]={}),l[i.bucketInstanceId][i.featureIndex])continue;const n=[new t.P(e.x1,e.y1),new t.P(e.x2,e.y1),new t.P(e.x2,e.y2),new t.P(e.x1,e.y2)];t.cI(r,n)&&(l[i.bucketInstanceId][i.featureIndex]=!0,void 0===c[i.bucketInstanceId]&&(c[i.bucketInstanceId]=[]),c[i.bucketInstanceId].push(i.featureIndex))}return c}insertCollisionBox(t,e,r,i,n){(e?this.ignoredGrid:this.grid).insert({bucketInstanceId:r,featureIndex:i,collisionGroupID:n},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,e,r,i,n){const o=e?this.ignoredGrid:this.grid,s={bucketInstanceId:r,featureIndex:i,collisionGroupID:n};for(let e=0;e<t.length;e+=4)o.insertCircle(s,t[e],t[e+1],t[e+2])}projectAndGetPerspectiveRatio(e,r,i,n,o,s,a){const l=[r,i,n,1];let c=!1;if(n||this.transform.pitch>0){if(t.aB.transformMat4(l,l,e),this.fogState&&o&&"globe"!==a.name){const e=function(e,r,i,n,o,s){const a=s.calculateFogTileMatrix(o),l=[r,i,n];return t.$.transformMat4(l,l,a),te(e,t.$.length(l),s.pitch,s._fov)}(this.fogState,r,i,n,o.toUnwrapped(),this.transform);c=e>.9}}else ar(l,l,e);const u=l[3];return{point:new t.P((l[0]/u+1)/2*this.transform.width+Wn,(-l[1]/u+1)/2*this.transform.height+Wn),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(a)/u*.5,1.5),signedDistanceFromCamera:u,occluded:s&&l[2]>u||c}}isOffscreen(t,e,r,i){return r<Wn||t>=this.screenRightBoundary||i<Wn||e>this.screenBottomBoundary}isInsideGrid(t,e,r,i){return r>=0&&t<this.gridRightBoundary&&i>=0&&e<this.gridBottomBoundary}getViewportMatrix(){const e=t.ae.identity([]);return t.ae.translate(e,e,[-100,-100,0]),e}}class Xn{constructor(t,e,r,i){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):i&&r?1:0,this.placed=r}isHidden(){return 0===this.opacity&&!this.placed}}class Yn{constructor(t,e,r,i,n,o=!1){this.text=new Xn(t?t.text:null,e,r,n),this.icon=new Xn(t?t.icon:null,e,i,n),this.clipped=o}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Kn{constructor(t,e,r,i=!1){this.text=t,this.icon=e,this.skipFade=r,this.clipped=i}}class Jn{constructor(){this.invProjMatrix=t.ae.create(),this.viewportMatrix=t.ae.create(),this.circles=[]}}class Qn{constructor(t,e,r,i,n){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=r,this.bucketIndex=i,this.tileID=n}}class to{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:t=>t.collisionGroupID===e}}return this.collisionGroups[t]}}function eo(e,r,i,n,o){const{horizontalAlign:s,verticalAlign:a}=t.bS(e),l=-(s-.5)*r,c=-(a-.5)*i,u=t.bR(e,n);return new t.P(l+u[0]*o,c+u[1]*o)}function ro(e,r,i,n,o){const s=new t.P(e,r);return i&&s._rotate(n?o:-o),s}class io{constructor(t,e,r,i,n,o){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new Zn(this.transform,n),this.buildingIndex=o,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new to(r),this.collisionCircleArrays={},this.prevPlacement=i,i&&(i.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,r,i,n){const o=i.getBucket(r),s=i.latestFeatureIndex;if(!o||!s||r.fqid!==o.layerIds[0])return;const a=o.layers[0].layout,l=i.collisionBoxArray,c=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),u=i.tileSize/t.a4,h=i.tileID.toUnwrapped();this.transform.setProjection(o.projection);const d=(p=i.tileID,f=o.getProjection(),m=this.transform,f.name===this.projection?m.calculateProjMatrix(p.toUnwrapped()):gi(m,f,p));var p,f,m;const g="map"===a.get("text-pitch-alignment"),y="map"===a.get("text-rotation-alignment");r.compileFilter();const v=r.dynamicFilter(),_=r.dynamicFilterNeedsFeature(),b=this.transform.calculatePixelsToTileUnitsMatrix(i),x=Ze(d,i.tileID.canonical,g,y,this.transform,o.getProjection(),b);let w=null;if(g){const e=Xe(d,i.tileID.canonical,g,y,this.transform,o.getProjection(),b);w=t.ae.multiply([],this.transform.labelPlaneMatrix,e)}let T=null;v&&i.latestFeatureIndex&&(T={unwrappedTileID:h,dynamicFilter:v,dynamicFilterNeedsFeature:_,featureIndex:i.latestFeatureIndex}),this.retainedQueryData[o.bucketInstanceId]=new Qn(o.bucketInstanceId,s,o.sourceLayerIndex,o.index,i.tileID);const E={bucket:o,layout:a,posMatrix:d,textLabelPlaneMatrix:x,labelToScreenMatrix:w,clippingData:T,scale:c,textPixelRatio:u,holdingForFade:i.holdingForFade(),collisionBoxArray:l,partiallyEvaluatedTextSize:t.aE(o.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:t.aE(o.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(n)for(const t of o.sortKeyRanges){const{sortKey:r,symbolInstanceStart:i,symbolInstanceEnd:n}=t;e.push({sortKey:r,symbolInstanceStart:i,symbolInstanceEnd:n,parameters:E})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:E})}attemptAnchorPlacement(t,e,r,i,n,o,s,a,l,c,u,h,d,p,f,m,g,y){const{textOffset0:v,textOffset1:_,crossTileID:b}=h,x=[v,_],w=eo(t,r,i,x,n),T=this.collisionIndex.placeCollisionBox(p,n,e,ro(w.x,w.y,o,s,this.transform.angle),u,a,l,c.predicate);if(m){const t=p.getSymbolInstanceIconSize(y,this.transform.zoom,h.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(p,t,m,ro(w.x,w.y,o,s,this.transform.angle),u,a,l,c.predicate).box.length)return}if(T.box.length>0){let e;return this.prevPlacement&&this.prevPlacement.variableOffsets[b]&&this.prevPlacement.placements[b]&&this.prevPlacement.placements[b].text&&(e=this.prevPlacement.variableOffsets[b].anchor),this.variableOffsets[b]={textOffset:x,width:r,height:i,anchor:t,textScale:n,prevAnchor:e},this.markUsedJustification(p,t,h,f),p.allowVerticalPlacement&&(this.markUsedOrientation(p,f,h),this.placedOrientations[b]=f),{shift:w,placedGlyphBoxes:T}}}placeLayerBucketPart(e,r,i,n){const{bucket:o,layout:s,posMatrix:a,textLabelPlaneMatrix:l,labelToScreenMatrix:c,clippingData:u,textPixelRatio:h,holdingForFade:d,collisionBoxArray:p,partiallyEvaluatedTextSize:f,partiallyEvaluatedIconSize:m,collisionGroup:g}=e.parameters,y=s.get("text-optional"),v=s.get("icon-optional"),_=s.get("text-allow-overlap"),b=s.get("icon-allow-overlap"),x="map"===s.get("text-rotation-alignment"),w="map"===s.get("text-pitch-alignment"),T="viewport-y"===s.get("symbol-z-order"),E=s.get("symbol-z-elevate");this.transform.setProjection(o.projection);let S=_&&(b||!o.hasIconData()||v),P=b&&(_||!o.hasTextData()||y);!o.collisionArrays&&p&&o.deserializeCollisionBoxes(p),i&&n&&o.updateCollisionDebugBuffers(this.transform.zoom,p);const k=(e,n,p)=>{const{crossTileID:T,numVerticalGlyphVertices:E}=e;if(u){const i={zoom:this.transform.zoom,pitch:this.transform.pitch};let n=null;if(u.dynamicFilterNeedsFeature){const t=this.retainedQueryData[o.bucketInstanceId];n=u.featureIndex.loadFeature({featureIndex:e.featureIndex,bucketIndex:t.bucketIndex,sourceLayerIndex:t.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,u.dynamicFilter)(i,n,this.retainedQueryData[o.bucketInstanceId].tileID.canonical,new t.P(e.tileAnchorX,e.tileAnchorY),this.transform.calculateDistanceTileData(u.unwrappedTileID)))return this.placements[T]=new Kn(!1,!1,!1,!0),void r.add(T)}if(r.has(T))return;if(d)return void(this.placements[T]=new Kn(!1,!1,!1));let k=!1,A=!1,M=!0,C=!1,I=!1,O=null,L={box:null,offscreen:null,occluded:null},D={box:null,offscreen:null,occluded:null},R=null,F=null,B=null,z=0,j=0,N=0;p.textFeatureIndex?z=p.textFeatureIndex:e.useRuntimeCollisionCircles&&(z=e.featureIndex),p.verticalTextFeatureIndex&&(j=p.verticalTextFeatureIndex);const V=t=>{t.tileID=this.retainedQueryData[o.bucketInstanceId].tileID;const r=this.transform.elevation;t.elevation=e.zOffset+(r?r.getAtTileOffset(t.tileID,t.tileAnchorX,t.tileAnchorY):0)},U=p.textBox;if(U){V(U);const r=r=>{let i=t.aF.horizontal;if(o.allowVerticalPlacement&&!r&&this.prevPlacement){const t=this.prevPlacement.placedOrientations[T];t&&(this.placedOrientations[T]=t,i=t,this.markUsedOrientation(o,i,e))}return i},i=(e,r)=>{if(o.allowVerticalPlacement&&E>0&&p.verticalTextBox){for(const i of o.writingModes)if(i===t.aF.vertical?(L=r(),D=L):L=e(),L&&L.box&&L.box.length)break}else L=e()};if(s.get("text-variable-anchor")){let l=s.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[T]){const t=this.prevPlacement.variableOffsets[T];l.indexOf(t.anchor)>0&&(l=l.filter((e=>e!==t.anchor)),l.unshift(t.anchor))}const c=(t,r,i)=>{const s=o.getSymbolInstanceTextSize(f,e,this.transform.zoom,n),c=(t.x2-t.x1)*s+2*t.padding,u=(t.y2-t.y1)*s+2*t.padding,d=e.hasIconTextFit&&!b?r:null;d&&V(d);let p={box:[],offscreen:!1,occluded:!1};const y=_?2*l.length:l.length;for(let r=0;r<y;++r){const y=this.attemptAnchorPlacement(l[r%l.length],t,c,u,s,x,w,h,a,g,r>=l.length,e,n,o,i,d,f,m);if(y&&(p=y.placedGlyphBoxes,p&&p.box&&p.box.length)){k=!0,O=y.shift;break}}return p};i((()=>c(U,p.iconBox,t.aF.horizontal)),(()=>{const e=p.verticalTextBox;return e&&V(e),o.allowVerticalPlacement&&!(L&&L.box&&L.box.length)&&E>0&&e?c(e,p.verticalIconBox,t.aF.vertical):{box:null,offscreen:null,occluded:null}})),L&&(k=L.box,M=L.offscreen,C=L.occluded);const u=r(!(!L||!L.box));if(!k&&this.prevPlacement){const t=this.prevPlacement.variableOffsets[T];t&&(this.variableOffsets[T]=t,this.markUsedJustification(o,t.anchor,e,u))}}else{const s=(r,i)=>{const s=o.getSymbolInstanceTextSize(f,e,this.transform.zoom,n),l=this.collisionIndex.placeCollisionBox(o,s,r,new t.P(0,0),_,h,a,g.predicate);return l&&l.box&&l.box.length&&(this.markUsedOrientation(o,i,e),this.placedOrientations[T]=i),l};i((()=>s(U,t.aF.horizontal)),(()=>{const e=p.verticalTextBox;return o.allowVerticalPlacement&&E>0&&e?(V(e),s(e,t.aF.vertical)):{box:null,offscreen:null,occluded:null}})),r(!!(L&&L.box&&L.box.length))}}if(R=L,k=R&&R.box&&R.box.length>0,M=R&&R.offscreen,C=R&&R.occluded,e.useRuntimeCollisionCircles){const r=o.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex>=0?e.centerJustifiedTextSymbolIndex:e.verticalPlacedTextSymbolIndex),n=t.aG(o.textSizeData,f,r),u=s.get("text-padding");F=this.collisionIndex.placeCollisionCircles(o,_,r,o.lineVertexArray,o.glyphOffsetArray,n,a,l,c,i,w,g.predicate,e.collisionCircleDiameter*n/t.bP,u,this.retainedQueryData[o.bucketInstanceId].tileID),k=_||F.circles.length>0&&!F.collisionDetected,M=M&&F.offscreen,C=F.occluded}if(p.iconFeatureIndex&&(N=p.iconFeatureIndex),p.iconBox){const r=r=>{V(r);const i=e.hasIconTextFit&&O?ro(O.x,O.y,x,w,this.transform.angle):new t.P(0,0),n=o.getSymbolInstanceIconSize(m,this.transform.zoom,e.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(o,n,r,i,b,h,a,g.predicate)};D&&D.box&&D.box.length&&p.verticalIconBox?(B=r(p.verticalIconBox),A=B.box.length>0):(B=r(p.iconBox),A=B.box.length>0),M=M&&B.offscreen,I=B.occluded}const $=y||0===e.numHorizontalGlyphVertices&&0===E,G=v||0===e.numIconVertices;if($||G?G?$||(A=A&&k):k=A&&k:A=k=A&&k,k&&R&&R.box&&this.collisionIndex.insertCollisionBox(R.box,s.get("text-ignore-placement"),o.bucketInstanceId,D&&D.box&&j?j:z,g.ID),A&&B&&this.collisionIndex.insertCollisionBox(B.box,s.get("icon-ignore-placement"),o.bucketInstanceId,N,g.ID),F&&(k&&this.collisionIndex.insertCollisionCircles(F.circles,s.get("text-ignore-placement"),o.bucketInstanceId,z,g.ID),i)){const t=o.bucketInstanceId;let e=this.collisionCircleArrays[t];void 0===e&&(e=this.collisionCircleArrays[t]=new Jn);for(let t=0;t<F.circles.length;t+=4)e.circles.push(F.circles[t+0]),e.circles.push(F.circles[t+1]),e.circles.push(F.circles[t+2]),e.circles.push(F.collisionDetected?1:0)}const H="globe"!==o.projection.name;S=S&&(H||!C),P=P&&(H||!I),this.placements[T]=new Kn(k||S,A||P,M||o.justReloaded),r.add(T)};if(E&&this.buildingIndex&&(this.buildingIndex.updateZOffset(o,this.retainedQueryData[o.bucketInstanceId].tileID),o.updateZOffset()),T){const e=o.getSortedSymbolIndexes(this.transform.angle);for(let t=e.length-1;t>=0;--t){const r=e[t];k(o.symbolInstances.get(r),r,o.collisionArrays[r])}o.hasAnyZOffset&&t.w(`${o.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(o.hasAnyZOffset){const t=o.getSortedIndexesByZOffset();for(let e=0;e<t.length;++e){const r=t[e];k(o.symbolInstances.get(r),r,o.collisionArrays[r])}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)k(o.symbolInstances.get(t),t,o.collisionArrays[t]);if(i&&o.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[o.bucketInstanceId];t.ae.invert(e.invProjMatrix,a),e.viewportMatrix=this.collisionIndex.getViewportMatrix()}o.justReloaded=!1}markUsedJustification(e,r,i,n){const{leftJustifiedTextSymbolIndex:o,centerJustifiedTextSymbolIndex:s,rightJustifiedTextSymbolIndex:a,verticalPlacedTextSymbolIndex:l,crossTileID:c}=i,u=t.cM(r),h=n===t.aF.vertical?l:"left"===u?o:"center"===u?s:"right"===u?a:-1;o>=0&&(e.text.placedSymbolArray.get(o).crossTileID=h>=0&&o!==h?0:c),s>=0&&(e.text.placedSymbolArray.get(s).crossTileID=h>=0&&s!==h?0:c),a>=0&&(e.text.placedSymbolArray.get(a).crossTileID=h>=0&&a!==h?0:c),l>=0&&(e.text.placedSymbolArray.get(l).crossTileID=h>=0&&l!==h?0:c)}markUsedOrientation(e,r,i){const n=r===t.aF.horizontal||r===t.aF.horizontalOnly?r:0,o=r===t.aF.vertical?r:0,{leftJustifiedTextSymbolIndex:s,centerJustifiedTextSymbolIndex:a,rightJustifiedTextSymbolIndex:l,verticalPlacedTextSymbolIndex:c}=i,u=e.text.placedSymbolArray;s>=0&&(u.get(s).placedOrientation=n),a>=0&&(u.get(a).placedOrientation=n),l>=0&&(u.get(l).placedOrientation=n),c>=0&&(u.get(c).placedOrientation=o)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const e=this.prevPlacement;let r=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;const i=e?e.symbolFadeChange(t):1,n=e?e.opacities:{},o=e?e.variableOffsets:{},s=e?e.placedOrientations:{};for(const t in this.placements){const e=this.placements[t],o=n[t];o?(this.opacities[t]=new Yn(o,i,e.text,e.icon,null,e.clipped),r=r||e.text!==o.text.placed||e.icon!==o.icon.placed):(this.opacities[t]=new Yn(null,i,e.text,e.icon,e.skipFade,e.clipped),r=r||e.text||e.icon)}for(const t in n){const e=n[t];if(!this.opacities[t]){const n=new Yn(e,i,!1,!1);n.isHidden()||(this.opacities[t]=n,r=r||e.text.placed||e.icon.placed)}}for(const t in o)this.variableOffsets[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.variableOffsets[t]=o[t]);for(const t in s)this.placedOrientations[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.placedOrientations[t]=s[t]);r?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)}updateLayerOpacities(t,e,r,i){const n=new Set;for(const o of e){const e=o.getBucket(t);e&&o.latestFeatureIndex&&t.fqid===e.layerIds[0]&&(this.updateBucketOpacities(e,n,o.collisionBoxArray,r,i,o.tileID,t.scope),e.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(e,o.tileID),e.updateZOffset()))}}updateBucketOpacities(e,r,i,n,o,s,a){e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const l=e.layers[0].layout,c=!!e.layers[0].dynamicFilter(),u=new Yn(null,0,!1,!1,!0),h=l.get("text-allow-overlap"),d=l.get("icon-allow-overlap"),p=l.get("text-variable-anchor"),f="map"===l.get("text-rotation-alignment"),m="map"===l.get("text-pitch-alignment"),g=new Yn(null,0,h&&(d||!e.hasIconData()||l.get("icon-optional")),d&&(h||!e.hasTextData()||l.get("text-optional")),!0);!e.collisionArrays&&i&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(i);const y=(t,e,r)=>{for(let i=0;i<e/4;i++)t.opacityVertexArray.emplaceBack(r)};let v=0;o&&e.updateReplacement(s,o);for(let i=0;i<e.symbolInstances.length;i++){const l=e.symbolInstances.get(i),{numHorizontalGlyphVertices:h,numVerticalGlyphVertices:d,crossTileID:_,numIconVertices:b,tileAnchorX:x,tileAnchorY:w}=l,T=r.has(_);let E=this.opacities[_];T?E=u:E||(E=g,this.opacities[_]=E),r.add(_);const S=h>0||d>0,P=b>0,k=this.placedOrientations[_],A=k===t.aF.vertical,M=k===t.aF.horizontal||k===t.aF.horizontalOnly;!S&&!P||E.isHidden()||v++;let C=!1;if((S||P)&&o)for(const r of e.activeReplacements){if(t.cJ(r,n,t.cw.Symbol,a))continue;if(r.min.x>x||x>r.max.x||r.min.y>w||w>r.max.y)continue;const e=t.cK(x,w,s.canonical,r.footprintTileId.canonical);if(C=t.cL(e,r),C)break}if(S){const t=C?fo:po(E.text);y(e.text,h,A?fo:t),y(e.text,d,M?fo:t);const r=E.text.isHidden(),{leftJustifiedTextSymbolIndex:i,centerJustifiedTextSymbolIndex:n,rightJustifiedTextSymbolIndex:o,verticalPlacedTextSymbolIndex:s}=l,a=e.text.placedSymbolArray,c=r||A?1:0;i>=0&&(a.get(i).hidden=c),n>=0&&(a.get(n).hidden=c),o>=0&&(a.get(o).hidden=c),s>=0&&(a.get(s).hidden=r||M?1:0);const u=this.variableOffsets[_];u&&this.markUsedJustification(e,u.anchor,l,k);const p=this.placedOrientations[_];p&&(this.markUsedJustification(e,"left",l,p),this.markUsedOrientation(e,p,l))}if(P){const t=C?fo:po(E.icon),{placedIconSymbolIndex:r,verticalPlacedIconSymbolIndex:i}=l,n=e.icon.placedSymbolArray,o=E.icon.isHidden()?1:0;r>=0&&(y(e.icon,b,A?fo:t),n.get(r).hidden=o),i>=0&&(y(e.icon,l.numVerticalIconVertices,M?fo:t),n.get(i).hidden=o)}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const r=e.collisionArrays[i];if(r){let i=new t.P(0,0),n=!0;if(r.textBox||r.verticalTextBox){if(p){const t=this.variableOffsets[_];t?(i=eo(t.anchor,t.width,t.height,t.textOffset,t.textScale),f&&i._rotate(m?this.transform.angle:-this.transform.angle)):n=!1}c&&(n=!E.clipped),r.textBox&&no(e.textCollisionBox.collisionVertexArray,E.text.placed,!n||A,i.x,i.y),r.verticalTextBox&&no(e.textCollisionBox.collisionVertexArray,E.text.placed,!n||M,i.x,i.y)}const o=n&&Boolean(!M&&r.verticalIconBox);r.iconBox&&no(e.iconCollisionBox.collisionVertexArray,E.icon.placed,o,l.hasIconTextFit?i.x:0,l.hasIconTextFit?i.y:0),r.verticalIconBox&&no(e.iconCollisionBox.collisionVertexArray,E.icon.placed,!o,l.hasIconTextFit?i.x:0,l.hasIconTextFit?i.y:0)}}}if(e.fullyClipped=0===v,e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=t.invProjMatrix,e.placementViewportMatrix=t.viewportMatrix,e.collisionCircleArray=t.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,e){const r=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*r>t}setStale(){this.stale=!0}}function no(t,e,r,i,n){t.emplaceBack(e?1:0,r?1:0,i||0,n||0),t.emplaceBack(e?1:0,r?1:0,i||0,n||0),t.emplaceBack(e?1:0,r?1:0,i||0,n||0),t.emplaceBack(e?1:0,r?1:0,i||0,n||0)}const oo=Math.pow(2,25),so=Math.pow(2,24),ao=Math.pow(2,17),lo=Math.pow(2,16),co=Math.pow(2,9),uo=Math.pow(2,8),ho=Math.pow(2,1);function po(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;const e=t.placed?1:0,r=Math.floor(127*t.opacity);return r*oo+e*so+r*ao+e*lo+r*co+e*uo+r*ho+e}const fo=0;class mo{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(t,e,r,i,n){const o=this._bucketParts;for(;this._currentTileIndex<t.length;)if(e.getBucketParts(o,i,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,n())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort(((t,e)=>t.sortKey-e.sortKey)));this._currentPartIndex<o.length;){const t=o[this._currentPartIndex];if(e.placeLayerBucketPart(t,this._seenCrossTileIDs,r,0===t.symbolInstanceStart),this._currentPartIndex++,n())return!0}return!1}}class go{constructor(t,e,r,i,n,o,s,a,l){this.placement=new io(t,n,o,s,a,l),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=i,this._done=!1}isDone(){return this._done}continuePlacement(e,r,i,n){const o=t.e.now(),s=()=>{const e=t.e.now()-o;return!this._forceFullPlacement&&e>2};for(;this._currentPlacementIndex>=0;){const o=r[e[this._currentPlacementIndex]],a=this.placement.collisionIndex.transform.zoom;if("symbol"===o.type&&(!o.minzoom||o.minzoom<=a)&&(!o.maxzoom||o.maxzoom>a)){const e=o,r=e.layout.get("symbol-z-elevate"),a=this._inProgressLayer=this._inProgressLayer||new mo(e),l=t.am(o.source,o.scope);if(a.continuePlacement(r?n[l]:i[l],this.placement,this._showCollisionBoxes,o,s))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const yo=512/t.a4/2;class vo{constructor(e,r,i){this.tileID=e,this.bucketInstanceId=i,this.index=new t.cN(r.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const n=e.canonical.x*t.a4,o=e.canonical.y*t.a4;for(let t=0;t<r.length;t++){const{key:e,crossTileID:i,tileAnchorX:s,tileAnchorY:a}=r.get(t),l=Math.floor((n+s)*yo),c=Math.floor((o+a)*yo);this.index.add(l,c),this.keys.push(e),this.crossTileIDs.push(i)}this.index.finish()}findMatches(e,r,i){const n=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z),o=yo/Math.pow(2,r.canonical.z-this.tileID.canonical.z),s=r.canonical.x*t.a4,a=r.canonical.y*t.a4;for(let t=0;t<e.length;t++){const r=e.get(t);if(r.crossTileID)continue;const{key:l,tileAnchorX:c,tileAnchorY:u}=r,h=Math.floor((s+c)*o),d=Math.floor((a+u)*o),p=this.index.range(h-n,d-n,h+n,d+n);for(const t of p){const e=this.crossTileIDs[t];if(this.keys[t]===l&&!i.has(e)){i.add(e),r.crossTileID=e;break}}}}}class _o{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class bo{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const e=Math.round((t-this.lng)/360);if(0!==e)for(const t in this.indexes){const r=this.indexes[t],i={};for(const t in r){const n=r[t];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+e),i[n.tileID.key]=n}this.indexes[t]=i}this.lng=t}addBucket(t,e,r){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let t=0;t<e.symbolInstances.length;t++)e.symbolInstances.get(t).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]=new Set);const i=this.usedCrossTileIDs[t.overscaledZ];for(const r in this.indexes){const n=this.indexes[r];if(Number(r)>t.overscaledZ)for(const r in n){const o=n[r];o.tileID.isChildOf(t)&&o.findMatches(e.symbolInstances,t,i)}else{const o=n[t.scaledTo(Number(r)).key];o&&o.findMatches(e.symbolInstances,t,i)}}for(let t=0;t<e.symbolInstances.length;t++){const n=e.symbolInstances.get(t);n.crossTileID||(n.crossTileID=r.generate(),i.add(n.crossTileID))}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new vo(t,e.symbolInstances,e.bucketInstanceId),!0}removeBucketCrossTileIDs(t,e){for(const r of e.crossTileIDs)this.usedCrossTileIDs[t].delete(r)}removeStaleBuckets(t){let e=!1;for(const r in this.indexes){const i=this.indexes[r];for(const n in i)t[i[n].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,i[n]),delete i[n],e=!0)}return e}}class xo{constructor(){this.layerIndexes={},this.crossTileIDs=new _o,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,e,r,i){let n=this.layerIndexes[t.fqid];void 0===n&&(n=this.layerIndexes[t.fqid]=new bo);let o=!1;const s={};"globe"!==i.name&&n.handleWrapJump(r);for(const r of e){const e=r.getBucket(t);e&&t.fqid===e.layerIds[0]&&(e.bucketInstanceId||(e.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(r.tileID,e,this.crossTileIDs)&&(o=!0),s[e.bucketInstanceId]=!0)}return n.removeStaleBuckets(s)&&(o=!0),o}pruneUnusedLayers(t){const e={};t.forEach((t=>{e[t]=!0}));for(const t in this.layerIndexes)e[t]||delete this.layerIndexes[t]}}const wo=new t.U({data:new t.W(t.N.colorTheme.data)}),To=(t,e)=>qt(t,e&&e.filter((t=>"source.canvas"!==t.identifier))),Eo=t.ai(Bn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),So=t.ai(Bn,["setCenter","setZoom","setBearing","setPitch"]),Po={version:8,layers:[],sources:{}},ko={duration:300,delay:0};class Ao extends t.E{constructor(e,r={}){super(),this.map=e,this.scope=r.scope||"",this.globalId=null,this.fragments=[],this.importDepth=r.importDepth||0,this.importsCache=r.importsCache||new Map,this.resolvedImports=r.resolvedImports||new Set,this.transition=t.Q({},ko),this._buildingIndex=new Dn(this),this.crossTileSymbolIndex=new xo,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerIndices=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=r.styleChanges||new y,this.dispatcher=r.dispatcher?r.dispatcher:new t.by(t.bz(),this),r.imageManager?this.imageManager=r.imageManager:(this.imageManager=new lt,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=r.glyphManager?r.glyphManager:new t.cP(e._requestManager,r.localFontFamily?t.cQ.all:r.localIdeographFontFamily?t.cQ.ideographs:t.cQ.none,r.localFontFamily||r.localIdeographFontFamily),r.modelManager?this.modelManager=r.modelManager:(this.modelManager=new st(e._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null},this._styleColorThemeForScope={},this.options=r.configOptions?r.configOptions:new Map,this._configDependentLayers=r.configDependentLayers?r.configDependentLayers:new Set,this._config=r.config,this._initialConfig=r.initialConfig,this.dispatcher.broadcast("setReferrer",t.cR());const i=this;this._rtlTextPluginCallback=Ao.registerForPluginStateChange((e=>{i.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},((e,r)=>{if(t.cS(e),r&&r.every((t=>t)))for(const t in i._sourceCaches){const e=i._sourceCaches[t],r=e.getSource().type;"vector"!==r&&"geojson"!==r||e.reload()}}))})),this.on("data",(t=>{if("source"!==t.dataType||"metadata"!==t.sourceDataType)return;const e=this.getOwnSource(t.sourceId);if(e&&e.vectorLayerIds)for(const t in this._layers){const r=this._layers[t];r.source===e.id&&this._validateLayer(r)}}))}load(t){return t?("string"==typeof t?this.loadURL(t):this.loadJSON(t),this):this}_getGlobalId(e){if(!e)return null;if("string"==typeof e){if(t.cT(e))return e;const r=t.cU(e);if(!r.startsWith("http"))try{return new URL(r,location.href).toString()}catch(t){return r}return r}return`json://${t.cV(JSON.stringify(e))}`}_diffStyle(e,r,i){this.globalId=this._getGlobalId(e);const n=(t,e)=>{try{e(null,this.setState(t,i))}catch(t){e(t,!1)}};if("string"==typeof e){const i=this.map._requestManager.normalizeStyleURL(e),o=this.map._requestManager.transformRequest(i,t.R.Style);t.h(o,((e,i)=>{e?this.fire(new t.f(e)):i&&n(i,r)}))}else"object"==typeof e&&n(e,r)}loadURL(e,r={}){this.fire(new t.g("dataloading",{dataType:"style"}));const i="boolean"==typeof r.validate?r.validate:!t.cT(e);this.globalId=this._getGlobalId(e),e=this.map._requestManager.normalizeStyleURL(e,r.accessToken),this.resolvedImports.add(e);const n=this.importsCache.get(e);if(n)return this._load(n,i);const o=this.map._requestManager.transformRequest(e,t.R.Style);this._request=t.h(o,((r,n)=>{if(this._request=null,r)this.fire(new t.f(r));else if(n)return this.importsCache.set(e,n),this._load(n,i)}))}loadJSON(e,r={}){this.fire(new t.g("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(e),this._request=t.e.frame((()=>{this._request=null,this._load(e,!1!==r.validate)}))}loadEmpty(){this.fire(new t.g("dataloading",{dataType:"style"})),this._load(Po,!1)}_loadImports(e,r,i){if(this.importDepth>=4)return t.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const n=[];for(const t of e){const e=this._createFragmentStyle(t),o=new Promise((t=>{e.once("style.import.load",t),e.once("error",t)})).then((()=>this.mergeAll()));if(n.push(o),this.resolvedImports.has(t.url)){e.loadEmpty();continue}const s=t.data||this.importsCache.get(t.url);s?(e.loadJSON(s,{validate:r}),this._isInternalStyle(s)&&(e.globalId=null)):t.url?e.loadURL(t.url,{validate:r}):e.loadEmpty();const a={style:e,id:t.id,config:t.config};if(i){const t=this.fragments.findIndex((({id:t})=>t===i));this.fragments=this.fragments.slice(0,t).concat(a).concat(this.fragments.slice(t))}else this.fragments.push(a)}return Promise.allSettled(n)}getImportGlobalIds(t=this,e=new Set){for(const r of t.fragments)r.style.globalId&&e.add(r.style.globalId),this.getImportGlobalIds(r.style,e);return[...e.values()]}_createFragmentStyle(e){const r=this.scope?t.am(e.id,this.scope):e.id;let i;const n=this._initialConfig&&this._initialConfig[r];(e.config||n)&&(i=t.Q({},e.config,n));const o=new Ao(this.map,{scope:r,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:i,configOptions:this.options,configDependentLayers:this._configDependentLayers});return o.setEventedParent(this.map,{style:o}),o}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(t){return this.isRootStyle()&&(t.fragment||!!t.schema&&!1!==t.fragment)}_load(e,r){const i=e.schema;if(this._isInternalStyle(e)){const i=t.Q({},Po,{imports:[{id:"basemap",data:e,url:""}]});return void this._load(i,r)}if(this.updateConfig(this._config,i),r&&To(this,Dt(e)))return;this._loaded=!0,this.stylesheet=t.cW(e);const n=()=>{for(const t in e.sources)this.addSource(t,e.sources[t],{validate:!1,isInitialLoad:!0});e.sprite?this._loadSprite(e.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(e.glyphs,this.scope);const i=Fn(this.stylesheet.layers);if(this._order=i.map((t=>t.id)),this.stylesheet.light&&t.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(1===this.stylesheet.lights.length&&"flat"===this.stylesheet.lights[0].type){const t=this.stylesheet.lights[0];this.light=new Zt(t.properties,t.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Zt(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const e of i){const r=t.c$(e,this.scope,this._styleColorTheme.lut,this.options);0!==r.configDependencies.size&&this._configDependentLayers.add(r.fqid),r.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=r,this._serializedLayers[r.id]=r.serialize();const i=this.getOwnLayerSourceCache(r),n=!!this.directionalLight&&this.directionalLight.shadowsEnabled();i&&r.canCastShadows()&&n&&(i.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const n=this.stylesheet.terrain;n&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(n,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new t.g("data",{dataType:"style"}));const o=this.isRootStyle();e.imports?this._loadImports(e.imports,r).then((()=>{this._reloadImports(),this.fire(new t.g(o?"style.load":"style.import.load"))})):(this._reloadImports(),this.fire(new t.g(o?"style.load":"style.import.load")))},o=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=o,o){const e=this._evaluateColorThemeData(o);this._loadColorTheme(e).then((()=>{n()})).catch((e=>{t.w(`Couldn't load color theme from the stylesheet: ${e}`),n()}))}else this._styleColorTheme.lut=null,n()}isRootStyle(){return 0===this.importDepth}mergeAll(){let e,r,i,n,o,s,a,l;const c={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((t=>{if(t.stylesheet){if(null!=t.light&&(e=t.light),t.stylesheet.lights)for(const e of t.stylesheet.lights)"ambient"===e.type&&null!=t.ambientLight&&(r=t.ambientLight),"directional"===e.type&&null!=t.directionalLight&&(i=t.directionalLight);n=this._prioritizeTerrain(n,t.terrain,t.stylesheet.terrain),t.stylesheet.fog&&null!=t.fog&&(o=t.fog),null!=t.stylesheet.camera&&(l=t.stylesheet.camera),null!=t.stylesheet.projection&&(s=t.stylesheet.projection),null!=t.stylesheet.transition&&(a=t.stylesheet.transition),c[t.scope]=t._styleColorTheme}})),this.light=e,this.ambientLight=r,this.directionalLight=i,this.fog=o,this._styleColorThemeForScope=c,null===n?delete this.terrain:this.terrain=n,this.camera=l||{"camera-projection":"perspective"},this.projection=s||{name:"mercator"},this.transition=t.Q({},ko,a),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(t){const e=r=>{for(const t of r.fragments)e(t.style);t(r)};e(this)}_prioritizeTerrain(t,e,r){const i=t&&0===t.drapeRenderMode;return null===r?e&&0===e.drapeRenderMode?e:i?t:null:null!=e&&(!t||i||e&&1===e.drapeRenderMode)?e:t}mergeTerrain(){let t;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((e=>{t=this._prioritizeTerrain(t,e.terrain,e.stylesheet.terrain)})),null===t?delete this.terrain:this.terrain=t}mergeProjection(){let t;this.forEachFragmentStyle((e=>{null!=e.stylesheet.projection&&(t=e.stylesheet.projection)})),this.projection=t||{name:"mercator"}}mergeSources(){const e={},r={},i={};this.forEachFragmentStyle((n=>{for(const r in n._sourceCaches){const i=t.am(r,n.scope);e[i]=n._sourceCaches[r]}for(const e in n._otherSourceCaches){const i=t.am(e,n.scope);r[i]=n._otherSourceCaches[e]}for(const e in n._symbolSourceCaches){const r=t.am(e,n.scope);i[r]=n._symbolSourceCaches[e]}})),this._mergedSourceCaches=e,this._mergedOtherSourceCaches=r,this._mergedSymbolSourceCaches=i}mergeLayers(){const e={},r=[],i={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle((i=>{for(const n of i._order){const o=i._layers[n];if("slot"===o.type){const r=t.cX(n);if(e[r])continue;e[r]=[]}o.slot&&e[o.slot]?e[o.slot].push(o):r.push(o)}})),this._mergedOrder=[],this._clipLayerIndices=[];let n=0;const o=(r=[])=>{for(const s of r)if("slot"===s.type){const r=t.cX(s.id);e[r]&&o(e[r]),this._mergedSlots.push(r)}else{const e=t.am(s.id,s.scope);this._mergedOrder.push(e),i[e]=s,s.is3D()&&(this._has3DLayers=!0),"circle"===s.type&&(this._hasCircleLayers=!0),"symbol"===s.type&&(this._hasSymbolLayers=!0),"clip"===s.type&&this._clipLayerIndices.push(n),n++}};o(r),this._mergedOrder.sort(((t,e)=>{const r=i[t],n=i[e];return r.hasInitialOcclusionOpacityProperties?n.is3D()?1:0:r.is3D()&&n.hasInitialOcclusionOpacityProperties?-1:0})),this._mergedLayers=i,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}getCamera(){return this.stylesheet.camera}setCamera(e){return this.stylesheet.camera=t.Q({},this.stylesheet.camera,e),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(e){return e.data?function(e,r,i){const n=t.Q({},r);for(const e of Object.keys(t.N.colorTheme))void 0===n[e]&&(n[e]=t.N.colorTheme[e].default);const o=new t.O(wo,e,new Map(i));return o.setTransitionOrValue(n,i),o.untransitioned().possiblyEvaluate(new t.Y(0))}(this.scope,e,this.options).get("data"):null}_loadColorTheme(e){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const r=this._styleColorTheme.lutLoadingCorrelationID;return new Promise(((i,n)=>{const o="data:image/png;base64,";if(!e||0===e.length)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void i();let s=e;s.startsWith(o)||(s=o+s);const a="mapbox-reserved-lut",l=new Image;l.src=s,l.onerror=()=>{this._styleColorTheme.lutLoading=!1,n(new Error("Failed to load image data"))},l.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==r)return void i();this._styleColorTheme.lutLoading=!1;const{width:o,height:s,data:c}=t.e.getImageData(l);if(s>32)return void n(new Error("The height of the image must be less than or equal to 32 pixels."));if(o!==s*s)return void n(new Error("The width of the image must be equal to the height squared."));this.getImage(a)&&this.removeImage(a),this.addImage(a,{data:new t.j({width:o,height:s},c),pixelRatio:1,sdf:!1,version:0});const u=this.imageManager.getImage(a,this.scope);u?(this._styleColorTheme.lut={image:u.data,data:e},i()):n(new Error("Missing LUT image."))}}))}getLut(t){const e=this._styleColorThemeForScope[t];return e?e.lut:null}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(e){this._spriteRequest=function(e,r,i){let n,o,s;const a=t.e.devicePixelRatio>1?"@2x":"";let l=t.h(r.transformRequest(r.normalizeSpriteURL(e,a,".json"),t.R.SpriteJSON),((t,e)=>{l=null,s||(s=t,n=e,u())})),c=t.i(r.transformRequest(r.normalizeSpriteURL(e,a,".png"),t.R.SpriteImage),((t,e)=>{c=null,s||(s=t,o=e,u())}));function u(){if(s)i(s);else if(n&&o){const e=t.e.getImageData(o),r={};for(const i in n){const{width:o,height:s,x:a,y:l,sdf:c,pixelRatio:u,stretchX:h,stretchY:d,content:p}=n[i],f=new t.j({width:o,height:s});t.j.copy(e,f,{x:a,y:l},{x:0,y:0},{width:o,height:s},null),r[i]={data:f,pixelRatio:u,sdf:c,stretchX:h,stretchY:d,content:p}}i(null,r)}}return{cancel(){l&&(l.cancel(),l=null),c&&(c.cancel(),c=null)}}}(e,this.map._requestManager,((e,r)=>{if(this._spriteRequest=null,e)this.fire(new t.f(e));else if(r)for(const t in r)this.imageManager.addImage(t,this.scope,r[t]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new t.g("data",{dataType:"style"}))}))}_validateLayer(e){const r=this.getOwnSource(e.source);if(!r)return;const i=e.sourceLayer;i&&("geojson"===r.type||r.vectorLayerIds&&-1===r.vectorLayerIds.indexOf(i))&&this.fire(new t.f(new Error(`Source layer "${i}" does not exist on source "${r.id}" as specified by style layer "${e.id}"`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;if(!this.imageManager.isLoaded())return!1;if(!this.modelManager.isLoaded())return!1;if(this._styleColorTheme.lutLoading)return!1;for(const{style:t}of this.fragments)if(!t.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map(((t,e)=>{const r=this.fragments[e];return r&&r.style&&(t.data=r.style.serialize()),t}))}_serializeSources(){const t={};for(const e in this._sourceCaches){const r=this._sourceCaches[e].getSource();t[r.id]||(t[r.id]=r.serialize())}return t}_serializeLayers(t){const e=[];for(const r of t){const t=this._layers[r];t&&"custom"!==t.type&&e.push(t.serialize())}return e}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions())return!0;if(this.hasFogTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(t){return!!this.terrain&&t.isDraped(this.getLayerSourceCache(t))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(e){const r=this.getOwnLayer(e);if(r)return r;this.fire(new t.f(new Error(`The layer '${e}' does not exist in the map's style.`)))}_checkSource(e){const r=this.getOwnSource(e);if(r)return r;this.fire(new t.f(new Error(`The source '${e}' does not exist in the map's style.`)))}precompilePrograms(t,e){const r=this.map.painter;if(r)for(let i=t.minzoom||0;i<(t.maxzoom||25.5);i++){const i=t.getProgramIds();if(i)for(const n of i){const i=t.getDefaultProgramParams(n,e.zoom,this._styleColorTheme.lut);i&&(r.style=this,this.fog&&(r._fogVisible=!0,i.overrideFog=!0,r.getOrCreateProgram(n,i)),r._fogVisible=!1,i.overrideFog=!1,r.getOrCreateProgram(n,i),(this.stylesheet.terrain||this.stylesheet.projection&&"globe"===this.stylesheet.projection.name)&&(i.overrideRtt=!0,r.getOrCreateProgram(n,i)))}}}update(e){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(e),this.directionalLight&&this.directionalLight.recalculate(e);const r=this.calculateLightsBrightness();e.brightness=r||0,r!==this._brightness&&(this._brightness=r,this.dispatcher.broadcast("setBrightness",r));const i=this._changes.isDirty();let n=!1;if(this._changes.isDirty()){const t=this._changes.getLayerUpdatesByScope();for(const e in t){const{updatedIds:r,removedIds:i}=t[e];(r||i)&&(this._updateWorkerLayers(e,r,i),n=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(e),this.light&&this.light.updateTransitions(e),this.ambientLight&&this.ambientLight.updateTransitions(e),this.directionalLight&&this.directionalLight.updateTransitions(e),this.fog&&this.fog.updateTransitions(e),this._changes.reset()}const o={};for(const t in this._mergedSourceCaches){const e=this._mergedSourceCaches[t];o[t]=e.used,e.used=!1,e.tileCoverLift=0}for(const t of this._mergedOrder){const r=this._mergedLayers[t];if(r.recalculate(e,this._availableImages),!r.isHidden(e.zoom)){const t=this.getLayerSourceCache(r);t&&(t.used=!0,t.tileCoverLift=Math.max(t.tileCoverLift,r.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback((()=>{this.precompilePrograms(r,e)})):this.precompilePrograms(r,e))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&n&&this.mergeLayers();for(const e in o){const r=this._mergedSourceCaches[e];o[e]!==r.used&&r.getSource().fire(new t.g("data",{sourceDataType:"visibility",dataType:"source",sourceId:r.getSource().id}))}this.light&&this.light.recalculate(e),this.terrain&&this.terrain.recalculate(e),this.fog&&this.fog.recalculate(e),this.z=e.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),i&&this.fire(new t.g("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=this._changes.getUpdatedImages();if(t.length){for(const e in this._sourceCaches)this._sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changes.resetUpdatedImages()}}_updateWorkerLayers(t,e,r){const i=this.getFragmentStyle(t);i&&this.dispatcher.broadcast("updateLayers",{layers:e?i._serializeLayers(e):[],scope:t,removedIds:r||[],options:i.options})}setState(e,r){if(this._checkLoaded(),To(this,Dt(e)))return!1;(e=t.cW(e)).layers=Fn(e.layers);const i=function(e,r){if(!e)return[{command:Bn.setStyle,args:[r]}];let i=[];try{if(!t.d(e.version,r.version))return[{command:Bn.setStyle,args:[r]}];if(t.d(e.center,r.center)||i.push({command:Bn.setCenter,args:[r.center]}),t.d(e.zoom,r.zoom)||i.push({command:Bn.setZoom,args:[r.zoom]}),t.d(e.bearing,r.bearing)||i.push({command:Bn.setBearing,args:[r.bearing]}),t.d(e.pitch,r.pitch)||i.push({command:Bn.setPitch,args:[r.pitch]}),t.d(e.sprite,r.sprite)||i.push({command:Bn.setSprite,args:[r.sprite]}),t.d(e.glyphs,r.glyphs)||i.push({command:Bn.setGlyphs,args:[r.glyphs]}),t.d(e.imports,r.imports)||function(e=[],r=[],i){r=r||[];const n=(e=e||[]).map($n),o=r.map($n),s=e.reduce(Gn,{}),a=r.reduce(Gn,{}),l=n.slice();let c,u,h,d;for(c=0,u=0;c<n.length;c++)h=n[c],a.hasOwnProperty(h)?u++:(i.push({command:Bn.removeImport,args:[h]}),l.splice(l.indexOf(h,u),1));for(c=0,u=0;c<o.length;c++)h=o[o.length-1-c],l[l.length-1-c]!==h&&(s.hasOwnProperty(h)?(i.push({command:Bn.removeImport,args:[h]}),l.splice(l.lastIndexOf(h,l.length-u),1)):u++,d=l[l.length-c],i.push({command:Bn.addImport,args:[a[h],d]}),l.splice(l.length-c,0,h));for(const e of r){const r=s[e.id];r&&!t.d(r,e)&&i.push({command:Bn.updateImport,args:[e.id,e]})}}(e.imports,r.imports,i),t.d(e.transition,r.transition)||i.push({command:Bn.setTransition,args:[r.transition]}),t.d(e.light,r.light)||i.push({command:Bn.setLight,args:[r.light]}),t.d(e.fog,r.fog)||i.push({command:Bn.setFog,args:[r.fog]}),t.d(e.projection,r.projection)||i.push({command:Bn.setProjection,args:[r.projection]}),t.d(e.lights,r.lights)||i.push({command:Bn.setLights,args:[r.lights]}),t.d(e.camera,r.camera)||i.push({command:Bn.setCamera,args:[r.camera]}),!t.d(e["color-theme"],r["color-theme"]))return[{command:Bn.setStyle,args:[r]}];const n={},o=[];!function(e,r,i,n){let o;for(o in r=r||{},e=e||{})e.hasOwnProperty(o)&&(r.hasOwnProperty(o)||jn(o,i,n));for(o in r){if(!r.hasOwnProperty(o))continue;const s=r[o];e.hasOwnProperty(o)?t.d(e[o],s)||("geojson"===e[o].type&&"geojson"===s.type&&Vn(e,r,o)?i.push({command:Bn.setGeoJSONSourceData,args:[o,s.data]}):Nn(o,r,i,n)):zn(o,r,i)}}(e.sources,r.sources,o,n);const s=[];e.layers&&e.layers.forEach((t=>{t.source&&n[t.source]?i.push({command:Bn.removeLayer,args:[t.id]}):s.push(t)}));let a=e.terrain;a&&n[a.source]&&(i.push({command:Bn.setTerrain,args:[void 0]}),a=void 0),i=i.concat(o),t.d(a,r.terrain)||i.push({command:Bn.setTerrain,args:[r.terrain]}),function(e,r,i){r=r||[];const n=(e=e||[]).map($n),o=r.map($n),s=e.reduce(Gn,{}),a=r.reduce(Gn,{}),l=n.slice(),c=Object.create(null);let u,h,d,p,f,m,g;for(u=0,h=0;u<n.length;u++)d=n[u],a.hasOwnProperty(d)?h++:(i.push({command:Bn.removeLayer,args:[d]}),l.splice(l.indexOf(d,h),1));for(u=0,h=0;u<o.length;u++)d=o[o.length-1-u],l[l.length-1-u]!==d&&(s.hasOwnProperty(d)?(i.push({command:Bn.removeLayer,args:[d]}),l.splice(l.lastIndexOf(d,l.length-h),1)):h++,m=l[l.length-u],i.push({command:Bn.addLayer,args:[a[d],m]}),l.splice(l.length-u,0,d),c[d]=!0);for(u=0;u<o.length;u++)if(d=o[u],p=s[d],f=a[d],!c[d]&&!t.d(p,f))if(t.d(p.source,f.source)&&t.d(p["source-layer"],f["source-layer"])&&t.d(p.type,f.type)){for(g in Un(p.layout,f.layout,i,d,null,Bn.setLayoutProperty),Un(p.paint,f.paint,i,d,null,Bn.setPaintProperty),t.d(p.slot,f.slot)||i.push({command:Bn.setSlot,args:[d,f.slot]}),t.d(p.filter,f.filter)||i.push({command:Bn.setFilter,args:[d,f.filter]}),t.d(p.minzoom,f.minzoom)&&t.d(p.maxzoom,f.maxzoom)||i.push({command:Bn.setLayerZoomRange,args:[d,f.minzoom,f.maxzoom]}),p)p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&"slot"!==g&&(0===g.indexOf("paint.")?Un(p[g],f[g],i,d,g.slice(6),Bn.setPaintProperty):t.d(p[g],f[g])||i.push({command:Bn.setLayerProperty,args:[d,g,f[g]]}));for(g in f)f.hasOwnProperty(g)&&!p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&"slot"!==g&&(0===g.indexOf("paint.")?Un(p[g],f[g],i,d,g.slice(6),Bn.setPaintProperty):t.d(p[g],f[g])||i.push({command:Bn.setLayerProperty,args:[d,g,f[g]]}))}else i.push({command:Bn.removeLayer,args:[d]}),m=l[l.lastIndexOf(d)+1],i.push({command:Bn.addLayer,args:[f,m]})}(s,r.layers,i)}catch(t){console.warn("Unable to compute style diff:",t),i=[{command:Bn.setStyle,args:[r]}]}return i}(this.serialize(),e).filter((t=>!(t.command in So)));if(0===i.length)return!1;const n=i.filter((t=>!(t.command in Eo)));if(n.length>0)throw new Error(`Unimplemented: ${n.map((t=>t.command)).join(", ")}.`);const o=[];return i.forEach((t=>{o.push(this[t.command].apply(this,t.args))})),r&&Promise.all(o).then(r),this.stylesheet=e,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(e,r){return this.getImage(e)?this.fire(new t.f(new Error("An image with this name already exists."))):(this.imageManager.addImage(e,this.scope,r),this._afterImageUpdated(e),this)}updateImage(t,e){this.imageManager.updateImage(t,this.scope,e)}getImage(t){return this.imageManager.getImage(t,this.scope)}removeImage(e){return this.getImage(e)?(this.imageManager.removeImage(e,this.scope),this._afterImageUpdated(e),this):this.fire(new t.f(new Error("No image with this name exists.")))}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(e),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new t.g("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(t,e,r={}){return this._checkLoaded(),this._validate(Gt,`models.${t}`,e,null,r)||(this.modelManager.addModel(t,e,this.scope),this._changes.setDirty()),this}hasModel(t){return this.modelManager.hasModel(t,this.scope)}removeModel(e){return this.hasModel(e)?(this.modelManager.removeModel(e,this.scope),this):this.fire(new t.f(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(e,r,i={}){if(this._checkLoaded(),void 0!==this.getOwnSource(e))throw new Error(`There is already a source with ID "${e}".`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(Rt,`sources.${e}`,r,null,i))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const n=Cr(e,r,this.dispatcher,this);n.scope=this.scope,n.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(n.id),source:n.serialize(),sourceId:n.id})));const o=e=>{const r=(e?"symbol:":"other:")+n.id,i=t.am(r,this.scope),o=this._sourceCaches[r]=new t.bx(i,n,e);(e?this._symbolSourceCaches:this._otherSourceCaches)[n.id]=o,o.onAdd(this.map)};o(!1),"vector"!==r.type&&"geojson"!==r.type||o(!0),n.onAdd&&n.onAdd(this.map),i.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(e){this._checkLoaded();const r=this.getOwnSource(e);if(!r)throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===e)return this.fire(new t.f(new Error(`Source "${e}" cannot be removed while layer "${r}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===e)return this.fire(new t.f(new Error(`Source "${e}" cannot be removed while terrain is using it.`)));const i=this.getOwnSourceCaches(e);for(const e of i){const r=t.cX(e.id);delete this._sourceCaches[r],this._changes.discardSourceCacheUpdate(e.id),e.fire(new t.g("data",{sourceDataType:"metadata",dataType:"source",sourceId:e.getSource().id})),e.setEventedParent(null),e.clearTiles()}return delete this._otherSourceCaches[e],delete this._symbolSourceCaches[e],this.mergeSources(),r.setEventedParent(null),r.onRemove&&r.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(t,e){this._checkLoaded(),this.getOwnSource(t).setData(e),this._changes.setDirty()}getOwnSource(t){const e=this.getOwnSourceCache(t);return e&&e.getSource()}getOwnSources(){const t=[];for(const e in this._otherSourceCaches){const r=this.getOwnSourceCache(e);r&&t.push(r.getSource())}return t}areTilesLoaded(){const t=this._mergedSourceCaches;for(const e in t){const r=t[e]._tiles;for(const t in r){const e=r[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0}setLights(e){if(this._checkLoaded(),!e)return delete this.ambientLight,void delete this.directionalLight;const r=this._getTransitionParameters();for(const i of e){if(this._validate(Bt,"lights",i))return;switch(i.type){case"ambient":if(this.ambientLight){const t=this.ambientLight;t.set(i),t.updateTransitions(r)}else this.ambientLight=new se(i,ae||(ae=new t.U({color:new t.W(t.N.properties_light_ambient.color),intensity:new t.W(t.N.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const t=this.directionalLight;t.set(i),t.updateTransitions(r)}else this.directionalLight=new se(i,le||(le=new t.U({direction:new t.a6(t.N.properties_light_directional.direction),color:new t.W(t.N.properties_light_directional.color),intensity:new t.W(t.N.properties_light_directional.intensity),"cast-shadows":new t.W(t.N.properties_light_directional["cast-shadows"]),"shadow-intensity":new t.W(t.N.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const i=new t.Y(this.z||0,r);this.ambientLight&&this.ambientLight.recalculate(i),this.directionalLight&&this.directionalLight.recalculate(i),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const e=this.directionalLight,r=this.ambientLight;if(!e||!r)return;const i=t=>.2126*(t[0]<=.03928?t[0]/12.92:Math.pow((t[0]+.055)/1.055,2.4))+.7152*(t[1]<=.03928?t[1]/12.92:Math.pow((t[1]+.055)/1.055,2.4))+.0722*(t[2]<=.03928?t[2]/12.92:Math.pow((t[2]+.055)/1.055,2.4)),n=e.properties.get("color").toRenderColor(null).toArray01(),o=e.properties.get("intensity"),s=e.properties.get("direction"),a=1-t.ad(s.x,s.y,s.z)[2]/90,l=i(n)*o*a,c=r.properties.get("color").toRenderColor(null).toArray01(),u=r.properties.get("intensity");return(l+i(c)*u)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const t=[];return this.directionalLight&&t.push(this.directionalLight.get()),this.ambientLight&&t.push(this.ambientLight.get()),t}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(e){if(!e)return this;if(t.cY(e)){const r=t.cZ(e),i=this.fragments.find((({id:t})=>t===r));if(!i)throw new Error(`Style import not found: ${e}`);const n=t.cX(e);return i.style.getFragmentStyle(n)}{const t=this.fragments.find((({id:t})=>t===e));if(!t)throw new Error(`Style import not found: ${e}`);return t.style}}getConfigProperty(e,r){const i=this.getFragmentStyle(e);if(!i)return null;const n=t.am(r,i.scope),o=i.options.get(n),s=o?o.value||o.default:null;return s?s.serialize():null}setConfigProperty(e,r,i){const n=this.getFragmentStyle(e);if(!n)return;const o=n.stylesheet.schema;if(!o||!o[r])return;const s=t.z(i);if("success"!==s.result)return void To(this,s.value);const a=s.value.expression,l=t.am(r,n.scope),c=n.options.get(l);if(!c)return;let u;const{minValue:h,maxValue:d,stepValue:p,type:f,values:m}=o[r],g=t.z(o[r].default);"success"===g.result&&(u=g.value.expression),u?(this.options.set(l,{...c,value:a,default:u,minValue:h,maxValue:d,stepValue:p,type:f,values:m}),this.updateConfigDependencies(r)):this.fire(new t.f(new Error(`No schema defined for the config option "${r}" in the "${e}" fragment.`)))}getConfig(e){const r=this.getFragmentStyle(e);if(!r)return null;const i=r.stylesheet.schema;if(!i)return null;const n={};for(const e in i){const i=t.am(e,r.scope),o=r.options.get(i),s=o?o.value||o.default:null;n[e]=s?s.serialize():null}return n}setConfig(t,e){const r=this.getFragmentStyle(t);r&&(r.updateConfig(e,r.stylesheet.schema),this.updateConfigDependencies())}getSchema(t){const e=this.getFragmentStyle(t);return e?e.stylesheet.schema:null}setSchema(t,e){const r=this.getFragmentStyle(t);r&&(r.stylesheet.schema=e,r.updateConfig(r._config,e),this.updateConfigDependencies())}updateConfig(e,r){if(this._config=e,e||r)if(r)for(const i in r){let n,o;const s=t.z(r[i].default);if("success"===s.result&&(n=s.value.expression),e&&void 0!==e[i]){const r=t.z(e[i]);"success"===r.result&&(o=r.value.expression)}const{minValue:a,maxValue:l,stepValue:c,type:u,values:h}=r[i];if(n){const e=t.am(i,this.scope);this.options.set(e,{default:n,value:o,minValue:a,maxValue:l,stepValue:c,type:u,values:h})}else this.fire(new t.f(new Error(`No schema defined for config option "${i}".`)))}else this.fire(new t.f(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(t){for(const e of this._configDependentLayers){const r=this.getLayer(e);if(r){if(t&&!r.configDependencies.has(t))continue;r.possiblyEvaluateVisibility(),this._updateLayer(r)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle((t=>{if(t._styleColorTheme.colorTheme){const e=t._evaluateColorThemeData(t._styleColorTheme.colorTheme);(!t._styleColorTheme.lut&&""!==e||t._styleColorTheme.lut&&e!==t._styleColorTheme.lut.data)&&t.setColorTheme(t._styleColorTheme.colorTheme)}})),this._changes.setDirty()}addLayer(e,r,i={}){this._checkLoaded();const n=e.id;if(this._layers[n])return void this.fire(new t.f(new Error(`Layer with id "${n}" already exists on this map`)));let o;if("custom"===e.type){if(To(this,t.c_(e)))return;o=t.c$(e,this.scope,this._styleColorTheme.lut,this.options)}else{if("object"==typeof e.source&&(this.addSource(n,e.source),e=t.cW(e),e=t.Q(e,{source:n})),this._validate(Nt,`layers.${n}`,e,{arrayIndex:-1},i))return;o=t.c$(e,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(o),o.setEventedParent(this,{layer:{id:n}}),this._serializedLayers[o.id]=o.serialize()}0!==o.configDependencies.size&&this._configDependentLayers.add(o.fqid);let s=this._order.length;if(r){const e=this._order.indexOf(r);if(-1===e)return void this.fire(new t.f(new Error(`Layer with id "${r}" does not exist on this map.`)));o.slot===this._layers[r].slot?s=e:t.w(`Layer with id "${r}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(s,0,n),this._layerOrderChanged=!0,this._layers[n]=o;const a=this.getOwnLayerSourceCache(o),l=!!this.directionalLight&&this.directionalLight.shadowsEnabled();a&&o.canCastShadows()&&l&&(a.castsShadows=!0);const c=this._changes.getRemovedLayer(o);if(c&&o.source&&a&&"custom"!==o.type){this._changes.discardLayerRemoval(o);const e=t.am(o.source,o.scope);c.type!==o.type?this._changes.updateSourceCache(e,"clear"):(this._changes.updateSourceCache(e,"reload"),a.pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map),o.scope=this.scope,this.mergeLayers()}moveLayer(e,r){this._checkLoaded();const i=this._checkLayer(e);if(!i)return;if(e===r)return;const n=this._order.indexOf(e);this._order.splice(n,1);let o=this._order.length;if(r){const e=this._order.indexOf(r);if(-1===e)return void this.fire(new t.f(new Error(`Layer with id "${r}" does not exist on this map.`)));i.slot===this._layers[r].slot?o=e:t.w(`Layer with id "${r}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(o,0,e),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(t){this._checkLoaded();const e=this._checkLayer(t);if(!e)return;e.setEventedParent(null);const r=this._order.indexOf(t);this._order.splice(r,1),delete this._layers[t],delete this._serializedLayers[t],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(e.fqid),this._changes.removeLayer(e);const i=this.getOwnLayerSourceCache(e);if(i&&i.castsShadows){let t=!1;for(const r in this._layers)if(this._layers[r].source===e.source&&this._layers[r].canCastShadows()){t=!0;break}i.castsShadows=t}e.onRemove&&e.onRemove(this.map),this.mergeLayers()}getOwnLayer(t){return this._layers[t]}hasLayer(t){return t in this._mergedLayers}hasLayerType(t){for(const e in this._layers)if(this._layers[e].type===t)return!0;return!1}setLayerZoomRange(t,e,r){this._checkLoaded();const i=this._checkLayer(t);i&&(i.minzoom===e&&i.maxzoom===r||(null!=e&&(i.minzoom=e),null!=r&&(i.maxzoom=r),this._updateLayer(i)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(t,e){this._checkLoaded();const r=this._checkLayer(t);r&&r.slot!==e&&(r.slot=e,this._updateLayer(r))}setFilter(e,r,i={}){this._checkLoaded();const n=this._checkLayer(e);if(n&&!t.d(n.filter,r))return null==r?(n.filter=void 0,void this._updateLayer(n)):void(this._validate(Vt,`layers.${n.id}.filter`,r,{layerType:n.type},i)||(n.filter=t.cW(r),this._updateLayer(n)))}getFilter(e){const r=this._checkLayer(e);if(r)return t.cW(r.filter)}setLayoutProperty(e,r,i,n={}){this._checkLoaded();const o=this._checkLayer(e);if(o&&!t.d(o.getLayoutProperty(r),i)){if(null!=i&&(!n||!1!==n.validate)&&To(o,$t.call(Dt,{key:`layers.${e}.layout.${r}`,layerType:o.type,objectKey:r,value:i,styleSpec:t.N,style:{glyphs:!0,sprite:!0}})))return;o.setLayoutProperty(r,i),0!==o.configDependencies.size&&this._configDependentLayers.add(o.fqid),this._updateLayer(o)}}getLayoutProperty(t,e){const r=this._checkLayer(t);if(r)return r.getLayoutProperty(e)}setPaintProperty(e,r,i,n={}){this._checkLoaded();const o=this._checkLayer(e);if(!o)return;if(t.d(o.getPaintProperty(r),i))return;if(null!=i&&(!n||!1!==n.validate)&&To(o,Ut.call(Dt,{key:`layers.${e}.paint.${r}`,layerType:o.type,objectKey:r,value:i,styleSpec:t.N})))return;const s=o.setPaintProperty(r,i);0!==o.configDependencies.size&&this._configDependentLayers.add(o.fqid),s&&this._updateLayer(o),this._changes.updatePaintProperties(o)}getPaintProperty(t,e){const r=this._checkLayer(t);if(r)return r.getPaintProperty(e)}setFeatureState(e,r){this._checkLoaded();const i=e.source,n=e.sourceLayer,o=this._checkSource(i);if(!o)return;const s=o.type;if("geojson"===s&&n)return void this.fire(new t.f(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===s&&!n)return void this.fire(new t.f(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===e.id&&this.fire(new t.f(new Error("The feature id parameter must be provided.")));const a=this.getOwnSourceCaches(i);for(const t of a)t.setFeatureState(n,e.id,r)}removeFeatureState(e,r){this._checkLoaded();const i=e.source,n=this._checkSource(i);if(!n)return;const o=n.type,s="vector"===o?e.sourceLayer:void 0;if("vector"===o&&!s)return void this.fire(new t.f(new Error("The sourceLayer parameter must be provided for vector source types.")));if(r&&"string"!=typeof e.id&&"number"!=typeof e.id)return void this.fire(new t.f(new Error("A feature id is required to remove its specific state property.")));const a=this.getOwnSourceCaches(i);for(const t of a)t.removeFeatureState(s,e.id,r)}getFeatureState(e){this._checkLoaded();const r=e.source,i=e.sourceLayer,n=this._checkSource(r);if(n){if("vector"!==n.type||i)return void 0===e.id&&this.fire(new t.f(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(r)[0].getFeatureState(i,e.id);this.fire(new t.f(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(e){return this.stylesheet.transition=t.Q({},this.stylesheet.transition,e),this.transition=this.stylesheet.transition,this}getTransition(){return t.Q({},this.stylesheet.transition)}serialize(){this._checkLoaded();const e=this.getTerrain(),r=e&&this.terrain&&this.terrain.scope===this.scope?e:this.stylesheet.terrain;return t.d0({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:r,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},(t=>void 0!==t))}_updateLayer(e){this._changes.updateLayer(e);const r=this.getLayerSourceCache(e),i=t.am(e.source,e.scope),n=this._changes.getUpdatedSourceCaches();e.source&&!n[i]&&r&&"raster"!==r.getSource().type&&(this._changes.updateSourceCache(i,"reload"),r.pause()),e.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const e=t=>"fill-extrusion"===this._mergedLayers[t].type||"model"===this._mergedLayers[t].type,r=this.order,i={},n=[];for(let o=r.length-1;o>=0;o--){const s=r[o];if(e(s)){i[s]=o;for(const e of t){const t=e[s];if(t)for(const e of t)n.push(e)}}}n.sort(((t,e)=>e.intersectionZ-t.intersectionZ));const o=[];for(let s=r.length-1;s>=0;s--){const a=r[s];if(e(a))for(let t=n.length-1;t>=0;t--){const e=n[t].feature;if(e.layer&&i[e.layer.id]<s)break;o.push(e),n.pop()}else for(const e of t){const t=e[a];if(t)for(const e of t)o.push(e.feature)}}return o}queryRenderedFeatures(e,r,i){r&&r.filter&&this._validate(Vt,"queryRenderedFeatures.filter",r.filter,null,r),r.scope=this.scope,r.availableImages=this._availableImages,r.serializedLayers=this._serializedLayers;const n={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new t.f(new Error("parameters.layers must be an Array."))),[];for(const e of r.layers){const r=this._mergedLayers[e];if(!r)return this.fire(new t.f(new Error(`The layer '${e}' does not exist in the map's style and cannot be queried for features.`))),[];n[r.source]=!0}}const o=[],s=r.serializedLayers||{},a=r&&r.layers?r.layers.some((t=>{const e=this.getLayer(t);return e&&e.is3D()})):this.has3DLayers(),l=Pn.createFromScreenPoints(e,i);for(const t in this._mergedSourceCaches){const e=this._mergedSourceCaches[t].getSource();if(!e||e.scope!==r.scope)continue;const c=this._mergedSourceCaches[t].getSource().id;r.layers&&!n[c]||o.push(In(this._mergedSourceCaches[t],this._mergedLayers,s,l,r,i,a,!!this.map._showQueryGeometry))}return this.placement&&o.push(function(t,e,r,i,n,o,s){const a={},l=o.queryRenderedSymbols(i),c=[];for(const t of Object.keys(l).map(Number))c.push(s[t]);c.sort(Ln);for(const r of c){const i=r.featureIndex.lookupSymbolFeatures(l[r.bucketInstanceId],e,r.bucketIndex,r.sourceLayerIndex,n.filter,n.layers,n.availableImages,t);for(const t in i){const e=a[t]=a[t]||[],n=i[t];n.sort(((t,e)=>{const i=r.featureSortOrder;if(i){const r=i.indexOf(t.featureIndex);return i.indexOf(e.featureIndex)-r}return e.featureIndex-t.featureIndex}));for(const t of n)e.push(t)}}for(const e in a)a[e].forEach((i=>{const n=i.feature,o=r(t[e]);if(!o)return;const s=o.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=s}));return a}(this._mergedLayers,s,this.getLayerSourceCache.bind(this),l.screenGeometry,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(o)}querySourceFeatures(t,e){e&&e.filter&&this._validate(Vt,"querySourceFeatures.filter",e.filter,null,e);const r=this.getOwnSourceCaches(t);let i=[];for(const t of r)i=i.concat(On(t,e));return i}addSourceType(t,e,r){return Ao.getSourceType(t)?r(new Error(`A source type called "${t}" already exists.`)):(Ao.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},r):r(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(e,r,i={}){this._checkLoaded();const n=this.light.getLight();let o=!1;for(const r in e)if(!t.d(e[r],n[r])){o=!0;break}if(!o)return;const s=this._getTransitionParameters();this.light.setLight(e,r,i),this.light.updateTransitions(s)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){void 0===this.disableElevatedTerrain&&(this.disableElevatedTerrain=t.e.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&t.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(e,r=1){if(this._checkLoaded(),!e)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),0===r&&delete this.terrain,null===e?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let i=e;const n=null==e.source;if(1===r){if(this.disableElevatedTerrain)return;if("object"==typeof i.source){const e="terrain-dem-src";this.addSource(e,i.source),i=t.cW(i),i=t.Q(i,{source:e})}const e=t.Q({},i),r={};if(this.terrain&&n){e.source=this.terrain.get().source;const t=this.terrain?this.getFragmentStyle(this.terrain.scope):null;t&&(r.style=t.serialize())}if(this._validate(zt,"terrain",e,r))return}if(!this.terrain||this.terrain.scope!==this.scope&&!n||this.terrain&&r!==this.terrain.drapeRenderMode){if(!i)return;this._createTerrain(i,r),this.fire(new t.g("data",{dataType:"style"}))}else{const r=this.terrain,n=r.get();for(const e of Object.keys(t.N.terrain))!i.hasOwnProperty(e)&&t.N.terrain[e].default&&(i[e]=t.N.terrain[e].default);for(const i in e)if(!t.d(e[i],n[i])){r.set(e,this.options),this.stylesheet.terrain=e;const i=this._getTransitionParameters({duration:0});r.updateTransitions(i),this.fire(new t.g("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const e=this.fog=new oe(t,this.map.transform,this.scope,this.options);this.stylesheet.fog=e.get();const r=this._getTransitionParameters({duration:0});e.updateTransitions(r)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask((()=>{for(const t of this.map._markers)t._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(e){if(this._checkLoaded(),!e)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const r=this.fog;if(!t.d(r.get(),e)){r.set(e,this.options),this.stylesheet.fog=r.get();const t=this._getTransitionParameters({duration:0});r.updateTransitions(t)}}else this._createFog(e);this._markersNeedUpdate=!0}setColorTheme(e){this._checkLoaded();const r=()=>{for(const t in this._layers)this._layers[t].lut=this._styleColorTheme.lut;for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles()};if(this._styleColorTheme.colorTheme=e,!e)return this._styleColorTheme.lut=null,void r();const i=this._evaluateColorThemeData(e);this._loadColorTheme(i).then((()=>{this.fire(new t.g("colorthemeset")),r()})).catch((e=>{t.w(`Couldn't set color theme: ${e}`)}))}_getTransitionParameters(e){return{now:t.e.now(),transition:t.Q(this.transition,e)}}updateDrapeFirstLayers(){if(!this.terrain)return;const t=[],e=[];for(const r of this._mergedOrder)this.isLayerDraped(this._mergedLayers[r])?t.push(r):e.push(r);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...e)}_createTerrain(t,e){const r=this.terrain=new Yt(t,e,this.scope,this.options);1===e&&(this.stylesheet.terrain=t),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const i=this._getTransitionParameters({duration:0});r.updateTransitions(i)}_force3DLayerUpdate(){for(const t in this._layers){const e=this._layers[t];"fill-extrusion"===e.type&&this._updateLayer(e)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const e=this._layers[t];"symbol"===e.type&&this._updateLayer(e)}}_validate(e,r,i,n,o={}){if(o&&!1===o.validate)return!1;const s=t.Q({},this.serialize());return To(this,e.call(Dt,t.Q({key:r,style:s,value:i,styleSpec:t.N},n)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.d1.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._mergedLayers)this._mergedLayers[t].setEventedParent(null);for(const t in this._mergedSourceCaches)this._mergedSourceCaches[t].clearTiles(),this._mergedSourceCaches[t].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(t){const e=this.getSourceCaches(t);for(const t of e)t.clearTiles()}clearSources(){for(const t in this._mergedSourceCaches)this._mergedSourceCaches[t].clearTiles()}reloadSource(t){const e=this.getSourceCaches(t);for(const t of e)t.resume(),t.reload()}reloadSources(){for(const t of this.getSources())t.reload&&t.reload()}updateSources(t){let e;this.directionalLight&&(e=vr(this.directionalLight));for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].update(t,void 0,void 0,e)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const e=this._sourceCaches[t];e.resume(),e.reload()}}_updatePlacement(e,r,i,n,o,s,a=!1){let l=!1,c=!1;const u={},h={};for(const e of this._mergedOrder){const i=this._mergedLayers[e];if("symbol"!==i.type)continue;const n=t.am(i.source,i.scope);let o=u[n];if(!o){const t=this.getLayerSourceCache(i);if(!t)continue;const e=t.getRenderableIds(!0).map((e=>t.getTileByID(e)));h[n]=e.slice(),o=u[n]=e.sort(((t,e)=>e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)))}const s=this.crossTileSymbolIndex.addLayer(i,o,r.center.lng,r.projection);l=l||s}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),a=a||this._layerOrderChanged||0===n,this._layerOrderChanged&&this.fire(new t.g("neworder")),(a||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.e.now(),r.zoom))&&(this.pauseablePlacement=new go(r,this._mergedOrder,a,i,n,o,this.placement,this.fog&&r.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,u,h),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.e.now()),c=!0),l&&this.pauseablePlacement.placement.setStale()),c||l){this._buildingIndex.onNewFrame(r.zoom);for(let e=0;e<this._mergedOrder.length;e++){const r=this._mergedLayers[this._mergedOrder[e]];if("symbol"!==r.type)continue;const i=this.isLayerClipped(r)&&this._clipLayerIndices.some((t=>e<t));this.placement.updateLayerOpacities(r,u[t.am(r.source,r.scope)],e,i?s:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.e.now())}}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}addImport(e,r){this._checkLoaded();const i=this.stylesheet.imports=this.stylesheet.imports||[];if(-1!==i.findIndex((({id:t})=>t===e.id)))return void this.fire(new t.f(new Error(`Import with id '${e.id}' already exists in the map's style.`)));if(!r)return i.push(e),this._loadImports([e],!0);const n=i.findIndex((({id:t})=>t===r));return-1===n&&this.fire(new t.f(new Error(`Import with id "${r}" does not exist on this map.`))),this.stylesheet.imports=i.slice(0,n).concat(e).concat(i.slice(n)),this._loadImports([e],!0,r)}updateImport(e,r){this._checkLoaded();const i=this.stylesheet.imports||[],n=this.getImportIndex(e);return-1===n?this:"string"==typeof r?(this.setImportUrl(e,r),this):(r.url&&r.url!==i[n].url&&this.setImportUrl(e,r.url),t.d(r.config,i[n].config)||this.setImportConfig(e,r.config),t.d(r.data,i[n].data)||this.setImportData(e,r.data),this)}moveImport(t,e){this._checkLoaded();let r=this.stylesheet.imports||[];const i=this.getImportIndex(t);if(-1===i)return this;const n=this.getImportIndex(e);if(-1===n)return this;const o=r[i],s=this.fragments[i];return r=r.filter((({id:e})=>e!==t)),this.fragments=this.fragments.filter((({id:e})=>e!==t)),this.stylesheet.imports=r.slice(0,n).concat(o).concat(r.slice(n)),this.fragments=this.fragments.slice(0,n).concat(s).concat(this.fragments.slice(n)),this.mergeLayers(),this}setImportUrl(t,e){this._checkLoaded();const r=this.stylesheet.imports||[],i=this.getImportIndex(t);if(-1===i)return this;r[i].url=e;const n=this.fragments[i];return n.style=this._createFragmentStyle(r[i]),n.style.on("style.import.load",(()=>this.mergeAll())),n.style.loadURL(e),this}setImportData(t,e){this._checkLoaded();const r=this.getImportIndex(t),i=this.stylesheet.imports||[];return-1===r?this:e?(this.fragments[r].style.setState(e),this._reloadImports(),this):(delete i[r].data,this.setImportUrl(t,i[r].url))}setImportConfig(t,e){this._checkLoaded();const r=this.getImportIndex(t),i=this.stylesheet.imports||[];if(-1===r)return this;e?i[r].config=e:delete i[r].config;const n=this.fragments[r],o=n.style.stylesheet&&n.style.stylesheet.schema;return n.config=e,n.style.updateConfig(e,o),this.updateConfigDependencies(),this}removeImport(t){this._checkLoaded();const e=this.stylesheet.imports||[],r=this.getImportIndex(t);-1!==r&&(e.splice(r,1),this.fragments[r].style._remove(),this.fragments.splice(r,1),this._reloadImports())}getImportIndex(e){const r=(this.stylesheet.imports||[]).findIndex((t=>t.id===e));return-1===r&&this.fire(new t.f(new Error(`Import '${e}' does not exist in the map's style and cannot be updated.`))),r}getLayer(t){return this._mergedLayers[t]}getSources(){const t=[];for(const e in this._mergedOtherSourceCaches){const r=this._mergedOtherSourceCaches[e];r&&t.push(r.getSource())}return t}getSource(t,e){const r=this.getSourceCache(t,e);return r&&r.getSource()}getLayerSource(t){const e=this.getLayerSourceCache(t);return e&&e.getSource()}getSourceCache(e,r){const i=t.am(e,r);return this._mergedOtherSourceCaches[i]}getLayerSourceCache(e){const r=t.am(e.source,e.scope);return"symbol"===e.type?this._mergedSymbolSourceCaches[r]:this._mergedOtherSourceCaches[r]}getSourceCaches(t){if(null==t)return Object.values(this._mergedSourceCaches);const e=[];return this._mergedOtherSourceCaches[t]&&e.push(this._mergedOtherSourceCaches[t]),this._mergedSymbolSourceCaches[t]&&e.push(this._mergedSymbolSourceCaches[t]),e}updateSourceCaches(){const t=this._changes.getUpdatedSourceCaches();for(const e in t){const r=t[e];"reload"===r?this.reloadSource(e):"clear"===r&&this.clearSource(e)}}updateLayers(t){const e=this._changes.getUpdatedPaintProperties();for(const r of e){const e=this.getLayer(r);e&&e.updateTransitions(t)}}getImages(t,e,r){this.imageManager.getImages(e.icons,e.scope,r),this._updateTilesForChangedImages();const i=t=>{t&&t.setDependencies(e.tileID.key,e.type,e.icons)};i(this._otherSourceCaches[e.source]),i(this._symbolSourceCaches[e.source])}getGlyphs(t,e,r){this.glyphManager.getGlyphs(e.stacks,e.scope,r)}getResource(e,r,i){return t.d2(r,i)}getOwnSourceCache(t){return this._otherSourceCaches[t]}getOwnLayerSourceCache(t){return"symbol"===t.type?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}getOwnSourceCaches(t){const e=[];return this._otherSourceCaches[t]&&e.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&e.push(this._symbolSourceCaches[t]),e}_isSourceCacheLoaded(e){const r=this.getOwnSourceCaches(e);return 0===r.length?(this.fire(new t.f(new Error(`There is no source with ID '${e}'`))),!1):r.every((t=>t.loaded()))}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(e,r){if(0===this._clipLayerIndices.length&&"fill-extrusion"!==e.type)return!1;const i="fill-extrusion"===e.type&&"building"===e.sourceLayer;let n=0;if(e.is3D()){if(i||r&&"batched-model"===r.type)return!0;"model"===e.type&&(n=t.cw.Model)}else"symbol"===e.type&&(n=t.cw.Symbol);for(const e of this._clipLayerIndices){const r=this._mergedLayers[this._mergedOrder[e]];if(!r)continue;const i=[];for(const e of r.layout.get("clip-layer-types"))i.push("model"===e?t.cw.Model:"symbol"===e?t.cw.Symbol:t.cw.FillExtrusion);for(const t of i)if(n&t)return!0}return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach((t=>{t.style._remove()})),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function Mo(t,e){let r=!1,i=null;const n=()=>{i=null,r&&(t(),i=setTimeout(n,e),r=!1)};return()=>(r=!0,i||n(),i)}Ao.getSourceType=function(t){return Mr[t]},Ao.setSourceType=function(t,e){Mr[t]=e},Ao.registerForPluginStateChange=t.cO;class Co{constructor(e){this._hashName=e&&encodeURIComponent(e),t.br(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Mo(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,window.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const e=Io(t);if(this._hashName){const t=this._hashName;let r=!1;const i=location.hash.slice(1).split("&").map((i=>{const n=i.split("=")[0];return n===t?(r=!0,`${n}=${e}`):i})).filter((t=>t));return r||i.push(`${t}=${e}`),`#${i.join("&")}`}return`#${e}`}_getCurrentHash(){const t=location.hash.replace("#","");if(this._hashName){let e;return t.split("&").map((t=>t.split("="))).forEach((t=>{t[0]===this._hashName&&(e=t)})),(e&&e[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const e=this._getCurrentHash();if(e.length>=3&&!e.some((t=>isNaN(t)))){const r=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(e[3]||0):t.getBearing();return t.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:r,pitch:+(e[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Io(t,e){const r=t.getCenter(),i=Math.round(100*t.getZoom())/100,n=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,n),s=Math.round(r.lng*o)/o,a=Math.round(r.lat*o)/o,l=t.getBearing(),c=t.getPitch();let u=e?`/${s}/${a}/${i}`:`${i}/${a}/${s}`;return(l||c)&&(u+="/"+Math.round(10*l)/10),c&&(u+=`/${Math.round(c)}`),u}const Oo={linearity:.3,easing:t.d3(0,0,.3,1)},Lo=t.Q({deceleration:2500,maxSpeed:1400},Oo),Do=t.Q({deceleration:20,maxSpeed:1400},Oo),Ro=t.Q({deceleration:1e3,maxSpeed:360},Oo),Fo=t.Q({deceleration:1e3,maxSpeed:90},Oo);class Bo{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.e.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,r=t.e.now();for(;e.length>0&&r-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._map._prefersReducedMotion())return;if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,pan:new t.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)r.zoom+=t.zoomDelta||0,r.bearing+=t.bearingDelta||0,r.pitch+=t.pitchDelta||0,t.panDelta&&r.pan._add(t.panDelta),t.around&&(r.around=t.around),t.pinchAround&&(r.pinchAround=t.pinchAround);const i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,n={};if(r.pan.mag()){const o=jo(r.pan.mag(),i,t.Q({},Lo,e||{}));n.offset=r.pan.mult(o.amount/r.pan.mag()),n.center=this._map.transform.center,zo(n,o)}if(r.zoom){const t=jo(r.zoom,i,Do);n.zoom=this._map.transform.zoom+t.amount,zo(n,t)}if(r.bearing){const e=jo(r.bearing,i,Ro);n.bearing=this._map.transform.bearing+t.au(e.amount,-179,179),zo(n,e)}if(r.pitch){const t=jo(r.pitch,i,Fo);n.pitch=this._map.transform.pitch+t.amount,zo(n,t)}if(n.zoom||n.bearing){const t=void 0===r.pinchAround?r.around:r.pinchAround;n.around=t?this._map.unproject(t):this._map.getCenter()}return this.clear(),n.noMoveStart=!0,n}}function zo(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function jo(e,r,i){const{maxSpeed:n,linearity:o,deceleration:s}=i,a=t.au(e*o/(r/1e3),-n,n),l=Math.abs(a)/(s*o);return{easing:i.easing,duration:1e3*l,amount:a*(l/2)}}class No extends t.g{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,i,n={}){const o=p(r.getCanvasContainer(),i),s=r.unproject(o);super(e,t.Q({point:o,lngLat:s,originalEvent:i},n)),this._defaultPrevented=!1,this.target=r}}class Vo extends t.g{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,i){const n="touchend"===e?i.changedTouches:i.touches,o=f(r.getCanvasContainer(),n),s=o.map((t=>r.unproject(t))),a=o.reduce(((t,e,r,i)=>t.add(e.div(i.length))),new t.P(0,0));super(e,{points:o,point:a,lngLats:s,lngLat:r.unproject(a),originalEvent:i}),this._defaultPrevented=!1}}class Uo extends t.g{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e){super("wheel",{originalEvent:e}),this._defaultPrevented=!1}}class $o{constructor(t,e){this._map=t,this._clickTolerance=e.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new Uo(this._map,t))}mousedown(t,e){return this._mousedownPos=e,this._firePreventable(new No(t.type,this._map,t))}mouseup(t){this._map.fire(new No(t.type,this._map,t))}preclick(e){const r=t.Q({},e);r.type="preclick",this._map.fire(new No(r.type,this._map,r))}click(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||(this.preclick(t),this._map.fire(new No(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new No(t.type,this._map,t))}mouseover(t){this._map.fire(new No(t.type,this._map,t))}mouseout(t){this._map.fire(new No(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Vo(t.type,this._map,t))}touchmove(t){this._map.fire(new Vo(t.type,this._map,t))}touchend(t){this._map.fire(new Vo(t.type,this._map,t))}touchcancel(t){this._map.fire(new Vo(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Go{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new No(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new No("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new No(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ho{constructor(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(c(),this._startPos=this._lastPos=e,this._active=!0)}mousemoveWindow(t,e){if(!this._active)return;const r=e,i=this._startPos,o=this._lastPos;if(!i||!o||o.equals(r)||!this._box&&r.dist(i)<this._clickTolerance)return;this._lastPos=r,this._box||(this._box=n("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const s=Math.min(i.x,r.x),a=Math.max(i.x,r.x),l=Math.min(i.y,r.y),c=Math.max(i.y,r.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform=`translate(${s}px,${l}px)`,this._box.style.width=a-s+"px",this._box.style.height=c-l+"px")}))}mouseupWindow(e,r){if(!this._active)return;const i=this._startPos,n=r;if(i&&0===e.button){if(this.reset(),d(),i.x!==n.x||i.y!==n.y)return this._map.fire(new t.g("boxzoomend",{originalEvent:e})),{cameraAnimation:t=>t.fitScreenCoordinates(i,n,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",e)}}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),u(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new t.g(e,{originalEvent:r}))}}function qo(t,e){const r={};for(let i=0;i<t.length;i++)r[t[i].identifier]=e[i];return r}class Wo{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(e,r,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=e.timeStamp),i.length===this.numTouches&&(this.centroid=function(e){const r=new t.P(0,0);for(const t of e)r._add(t);return r.div(e.length)}(r),this.touches=qo(i,r)))}touchmove(t,e,r){if(this.aborted||!this.centroid)return;const i=qo(r,e);for(const t in this.touches){const e=i[t];(!e||e.dist(this.touches[t])>30)&&(this.aborted=!0)}}touchend(t,e,r){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===r.length){const t=!this.aborted&&this.centroid;if(this.reset(),t)return t}}}class Zo{constructor(t){this.singleTap=new Wo(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,e,r){this.singleTap.touchstart(t,e,r)}touchmove(t,e,r){this.singleTap.touchmove(t,e,r)}touchend(t,e,r){const i=this.singleTap.touchend(t,e,r);if(i){const e=t.timeStamp-this.lastTime<500,r=!this.lastTap||this.lastTap.dist(i)<30;if(e&&r||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=i,this.count===this.numTaps)return this.reset(),i}}}class Xo{constructor(){this._zoomIn=new Zo({numTouches:1,numTaps:2}),this._zoomOut=new Zo({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,e,r){this._zoomIn.touchstart(t,e,r),this._zoomOut.touchstart(t,e,r)}touchmove(t,e,r){this._zoomIn.touchmove(t,e,r),this._zoomOut.touchmove(t,e,r)}touchend(t,e,r){const i=this._zoomIn.touchend(t,e,r),n=this._zoomOut.touchend(t,e,r);return i?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(i)},{originalEvent:t})}):n?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(n)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Yo={0:1,2:2};class Ko{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,e){return!1}_move(t,e){return{}}mousedown(t,e){if(this._lastPoint)return;const r=m(t);this._correctButton(t,r)&&(this._lastPoint=e,this._eventButton=r)}mousemoveWindow(t,e){const r=this._lastPoint;if(r)if(t.preventDefault(),null!=this._eventButton&&function(t,e){const r=Yo[e];return void 0===t.buttons||(t.buttons&r)!==r}(t,this._eventButton))this.reset();else if(this._moved||!(e.dist(r)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(r,e)}mouseupWindow(t){this._lastPoint&&m(t)===this._eventButton&&(this._moved&&d(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jo extends Ko{mousedown(t,e){super.mousedown(t,e),this._lastPoint&&(this._active=!0)}_correctButton(t,e){return 0===e&&!t.ctrlKey}_move(t,e){return{around:e,panDelta:e.sub(t)}}}class Qo extends Ko{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const r=.8*(e.x-t.x);if(r)return this._active=!0,{bearingDelta:r}}contextmenu(t){t.preventDefault()}}class ts extends Ko{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const r=-.5*(e.y-t.y);if(r)return this._active=!0,{pitchDelta:r}}contextmenu(t){t.preventDefault()}}class es{constructor(e,r){this._map=e,this._el=e.getCanvasContainer(),this._minTouches=1,this._clickTolerance=r.clickTolerance||1,this.reset(),t.br(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new t.P(0,0)}touchstart(t,e,r){return this._calculateTransform(t,e,r)}touchmove(e,r,i){if(this._active&&!(i.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===i.length&&!t.d4())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return e.cancelable&&e.preventDefault(),this._calculateTransform(e,r,i)}}touchend(t,e,r){this._calculateTransform(t,e,r),this._active&&r.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,i){i.length>0&&(this._active=!0);const n=qo(i,r),o=new t.P(0,0),s=new t.P(0,0);let a=0;for(const t in n){const e=n[t],r=this._touches[t];r&&(o._add(e),s._add(e.sub(r)),a++,n[t]=e)}if(this._touches=n,a<this._minTouches||!s.mag())return;const l=s.div(a);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:o.div(a),panDelta:l}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=n("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")}),500)}}class rs{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,e,r){return{}}touchstart(t,e,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([e[0],e[1]]))}touchmove(t,e,r){const i=this._firstTwoTouches;if(!i)return;t.preventDefault();const[n,o]=i,s=is(r,e,n),a=is(r,e,o);if(!s||!a)return;const l=this._aroundCenter?null:s.add(a).div(2);return this._move([s,a],l,t)}touchend(t,e,r){if(!this._firstTwoTouches)return;const[i,n]=this._firstTwoTouches,o=is(r,e,i),s=is(r,e,n);o&&s||(this._active&&d(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function is(t,e,r){for(let i=0;i<t.length;i++)if(t[i].identifier===r)return e[i]}function ns(t,e){return Math.log(t/e)/Math.LN2}class os extends rs{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,e){const r=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(ns(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ns(this._distance,r),pinchAround:e}}}function ss(t,e){return 180*t.angleWith(e)/Math.PI}class as extends rs{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,e){const r=this._vector;if(this._vector=t[0].sub(t[1]),r&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:ss(this._vector,r),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const e=25/(Math.PI*this._minDiameter)*360,r=this._startVector;if(!r)return!1;const i=ss(t,r);return Math.abs(i)<e}}function ls(t){return Math.abs(t.y)>Math.abs(t.x)}class cs extends rs{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,ls(t[0].sub(t[1]))&&(this._valid=!1)}_move(e,r,i){const n=this._lastPoints;if(!n)return;const o=e[0].sub(n[0]),s=e[1].sub(n[1]);return this._map._cooperativeGestures&&!t.d4()&&i.touches.length<3||(this._valid=this.gestureBeginsVertically(o,s,i.timeStamp),!this._valid)?void 0:(this._lastPoints=e,this._active=!0,{pitchDelta:(o.y+s.y)/2*-.5})}gestureBeginsVertically(t,e,r){if(void 0!==this._valid)return this._valid;const i=t.mag()>=2,n=e.mag()>=2;if(!i&&!n)return;if(!i||!n)return null==this._firstMove&&(this._firstMove=r),r-this._firstMove<100&&void 0;const o=t.y>0==e.y>0;return ls(t)&&ls(e)&&o}}const us={panStep:100,bearingStep:15,pitchStep:10};class hs{constructor(){const t=us;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,r=0,i=0,n=0,o=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?r=-1:(t.preventDefault(),n=-1);break;case 39:t.shiftKey?r=1:(t.preventDefault(),n=1);break;case 38:t.shiftKey?i=1:(t.preventDefault(),o=-1);break;case 40:t.shiftKey?i=-1:(t.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(r=0,i=0),{cameraAnimation:s=>{const a=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:ds,zoom:e?Math.round(a)+e*(t.shiftKey?2:1):a,bearing:s.getBearing()+r*this._bearingStep,pitch:s.getPitch()+i*this._pitchStep,offset:[-n*this._panStep,-o*this._panStep],center:s.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ds(t){return t*(2-t)}const ps=4.000244140625,fs=1/450;class ms{constructor(e,r){this._map=e,this._el=e.getCanvasContainer(),this._handler=r,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=fs,t.br(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(e){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(e.ctrlKey||e.metaKey||this.isZooming()||t.d4()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let r=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const i=t.e.now(),n=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==r&&r%ps==0?this._type="wheel":0!==r&&Math.abs(r)<4?this._type="trackpad":n>400?(this._type=null,this._lastValue=r,this._timeout=window.setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(n*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=e,this._delta-=r,this._active||this._start(e)),e.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const e=p(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:e,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const e=this._map.transform;"wheel"===this._type&&e.projection.wrap&&(e._center.lng>=180||e._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const r=()=>e._terrainEnabled()&&this._aroundCoord?e.computeZoomRelativeTo(this._aroundCoord):e.zoom;if(0!==this._delta){const t="wheel"===this._type&&Math.abs(this._delta)>ps?this._wheelZoomRate:this._defaultZoomRate;let i=2/(1+Math.exp(-Math.abs(this._delta*t)));this._delta<0&&0!==i&&(i=1/i);const n=r(),o=Math.pow(2,n),s="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):o;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(s*i))),"wheel"===this._type&&(this._startZoom=n,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const i="number"==typeof this._targetZoom?this._targetZoom:r(),n=this._startZoom,o=this._easing;let s,a=!1;if("wheel"===this._type&&n&&o){const e=Math.min((t.e.now()-this._lastWheelEventTime)/200,1),r=o(e);s=t.a3(n,i,r),e<1?this._frameId||(this._frameId=!0):a=!0}else s=i,a=!0;this._active=!0,a&&(this._active=!1,this._finishTimeout=window.setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200));let l=s-r();return l*this._lastDelta<0&&(l=0),{noInertia:!0,needsRenderFrame:!a,zoomDelta:l,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let r=t.d5;if(this._prevEase){const e=this._prevEase,i=(t.e.now()-e.start)/e.duration,n=e.easing(i+.01)-e.easing(i),o=.27/Math.sqrt(n*n+1e-4)*.01,s=Math.sqrt(.0729-o*o);r=t.d3(o,s,.25,1)}return this._prevEase={start:t.e.now(),duration:e,easing:r},r}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=n("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")}),200)}}class gs{constructor(t,e){this._clickZoom=t,this._tapZoom=e}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ys{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,e){return t.preventDefault(),{cameraAnimation:r=>{r.easeTo({duration:300,zoom:r.getZoom()+(t.shiftKey?-1:1),around:r.unproject(e)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class vs{constructor(){this._tap=new Zo({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,e,r){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?r.length>0&&(this._swipePoint=e[0],this._swipeTouch=r[0].identifier):this._tap.touchstart(t,e,r))}touchmove(t,e,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;const i=e[0],n=i.y-this._swipePoint.y;return this._swipePoint=i,t.preventDefault(),this._active=!0,{zoomDelta:n/128}}}else this._tap.touchmove(t,e,r)}touchend(t,e,r){this._tapTime?this._swipePoint&&0===r.length&&this.reset():this._tap.touchend(t,e,r)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _s{constructor(t,e,r){this._el=t,this._mousePan=e,this._touchPan=r}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class bs{constructor(t,e,r){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=r}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class xs{constructor(t,e,r,i){this._el=t,this._touchZoom=e,this._touchRotate=r,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ws=t=>t.zoom||t.drag||t.pitch||t.rotate;class Ts extends t.g{}class Es{constructor(){this.constants=[1,1,.01],this.radius=0}setup(e,r){const i=t.$.sub([],r,e);this.radius=t.$.length(i[2]<0?t.$.div([],i,this.constants):[i[0],i[1],0])}projectRay(e){t.$.div(e,e,this.constants),t.$.normalize(e,e),t.$.mul(e,e,this.constants);const r=t.$.scale([],e,this.radius);if(r[2]>0){const e=t.$.scale([],[0,0,1],t.$.dot(r,[0,0,1])),i=t.$.scale([],t.$.normalize([],[r[0],r[1],0]),this.radius),n=t.$.add([],r,t.$.scale([],t.$.sub([],t.$.add([],i,e),r),2));r[0]=n[0],r[1]=n[1]}return r}}function Ss(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class Ps{constructor(e,r){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Bo(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Es,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(r),t.br(["handleEvent","handleWindowEvent"],this);const i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[window,"blur",void 0]];for(const[t,e,r]of this._listeners){const i=t===document?this.handleWindowEvent:this.handleEvent;t.addEventListener(e,i,r)}}destroy(){for(const[t,e,r]of this._listeners){const i=t===document?this.handleWindowEvent:this.handleEvent;t.removeEventListener(e,i,r)}}_addDefaultHandlers(t){const e=this._map,r=e.getCanvasContainer();this._add("mapEvent",new $o(e,t));const i=e.boxZoom=new Ho(e,t);this._add("boxZoom",i);const n=new Xo,o=new ys;e.doubleClickZoom=new gs(o,n),this._add("tapZoom",n),this._add("clickZoom",o);const s=new vs;this._add("tapDragZoom",s);const a=e.touchPitch=new cs(e);this._add("touchPitch",a);const l=new Qo(t),c=new ts(t);e.dragRotate=new bs(t,l,c),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);const u=new Jo(t),h=new es(e,t);e.dragPan=new _s(r,u,h),this._add("mousePan",u),this._add("touchPan",h,["touchZoom","touchRotate"]);const d=new as,p=new os;e.touchZoomRotate=new xs(r,p,d,s),this._add("touchRotate",d,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Go(e));const f=e.scrollZoom=new ms(e,this);this._add("scrollZoom",f,["mousePan"]);const m=e.keyboard=new hs;this._add("keyboard",m);for(const r of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[r]&&e[r].enable(t[r])}_add(t,e,r){this._handlers.push({handlerName:t,handler:e,allowed:r}),this._handlersById[t]=e}stop(t){if(!this._updatingCamera){for(const{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ws(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(t,e,r){for(const i in t)if(i!==r&&(!e||e.indexOf(i)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const e=[];for(const r of t)this._el.contains(r.target)&&e.push(r);return e}handleEvent(t,e){this._updatingCamera=!0;const r="renderFrame"===t.type,i=r?void 0:t,n={needsRenderFrame:!1},o={},s={},a=t.touches?this._getMapTouches(t.touches):void 0,l=a?f(this._el,a):r?void 0:p(this._el,t);for(const{handlerName:r,handler:c,allowed:u}of this._handlers){if(!c.isEnabled())continue;let h;this._blockedByActive(s,u,r)?c.reset():c[e||t.type]&&(h=c[e||t.type](t,l,a),this.mergeHandlerResult(n,o,h,r,i),h&&h.needsRenderFrame&&this._triggerRenderFrame()),(h||c.isActive())&&(s[r]=c)}const c={};for(const t in this._previousActiveHandlers)s[t]||(c[t]=i);this._previousActiveHandlers=s,(Object.keys(c).length||Ss(n))&&(this._changes.push([n,o,c]),this._triggerRenderFrame()),(Object.keys(s).length||Ss(n))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:u}=n;u&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],u(this._map))}mergeHandlerResult(e,r,i,n,o){if(!i)return;t.Q(e,i);const s={handlerName:n,originalEvent:i.originalEvent||o};void 0!==i.zoomDelta&&(r.zoom=s),void 0!==i.panDelta&&(r.drag=s),void 0!==i.pitchDelta&&(r.pitch=s),void 0!==i.bearingDelta&&(r.rotate=s)}_applyChanges(){const e={},r={},i={};for(const[n,o,s]of this._changes)n.panDelta&&(e.panDelta=(e.panDelta||new t.P(0,0))._add(n.panDelta)),n.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+n.zoomDelta),n.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+n.bearingDelta),n.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+n.pitchDelta),void 0!==n.around&&(e.around=n.around),void 0!==n.aroundCoord&&(e.aroundCoord=n.aroundCoord),void 0!==n.pinchAround&&(e.pinchAround=n.pinchAround),n.noInertia&&(e.noInertia=n.noInertia),t.Q(r,o),t.Q(i,s);this._updateMapTransform(e,r,i),this._changes=[]}_updateMapTransform(e,r,i){const n=this._map,o=n.transform,s=t=>[t.x,t.y,t.z];if((t=>{const e=this._eventsInProgress.drag;return e&&!this._handlersById[e.handlerName].isActive()})()&&!Ss(e)){const t=o.zoom;o.cameraElevationReference="sea",null!=this._originalZoom&&o._orthographicProjectionAtLowPitch&&"globe"!==o.projection.name&&0===o.pitch?(o.cameraElevationReference="ground",o.zoom=this._originalZoom):(o.recenterOnTerrain(),o.cameraElevationReference="ground"),t!==o.zoom&&this._map._update(!0)}if(o._isCameraConstrained&&n._stop(!0),!Ss(e))return void this._fireEvents(r,i,!0);let{panDelta:a,zoomDelta:l,bearingDelta:c,pitchDelta:u,around:h,aroundCoord:d,pinchAround:p}=e;o._isCameraConstrained&&(l>0&&(l=0),o._isCameraConstrained=!1),void 0!==p&&(h=p),(l||(t=>r[t]&&!this._eventsInProgress[t])("drag"))&&h&&(this._dragOrigin=s(o.pointCoordinate3D(h)),this._originalZoom=o.zoom,this._trackingEllipsoid.setup(o._camera.position,this._dragOrigin)),o.cameraElevationReference="sea",n._stop(!0),h=h||n.transform.centerPoint,c&&(o.bearing+=c),u&&(o.pitch+=u),o._updateCameraState();const f=[0,0,0];if(a)if("mercator"===o.projection.name){const t=this._trackingEllipsoid.projectRay(o.screenPointToMercatorRay(h).dir),e=this._trackingEllipsoid.projectRay(o.screenPointToMercatorRay(h.sub(a)).dir);f[0]=e[0]-t[0],f[1]=e[1]-t[1]}else{const e=o.pointCoordinate(h);if("globe"===o.projection.name){a=a.rotate(-o.angle);const r=o._pixelsPerMercatorPixel/o.worldSize;f[0]=-a.x*t.d6(t.az(e.y))*r,f[1]=-a.y*t.d6(o.center.lat)*r}else{const t=o.pointCoordinate(h.sub(a));e&&t&&(f[0]=t.x-e.x,f[1]=t.y-e.y)}}const m=o.zoom,g=[0,0,0];if(l){const e=s(d||o.pointCoordinate3D(h)),r={dir:t.$.normalize([],t.$.sub([],e,o._camera.position))};if(r.dir[2]<0){const i=o.zoomDeltaToMovement(e,l);t.$.scale(g,r.dir,i)}}const y=t.$.add(f,f,g);o._translateCameraConstrained(y),l&&Math.abs(o.zoom-m)>1e-4&&o.recenterOnTerrain(),o.cameraElevationReference="ground",this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(r,i,!0)}_fireEvents(e,r,i){const n=ws(this._eventsInProgress),o=ws(e),s={};for(const t in e){const{originalEvent:r}=e[t];this._eventsInProgress[t]||(s[`${t}start`]=r),this._eventsInProgress[t]=e[t]}!n&&o&&this._fireEvent("movestart",o.originalEvent);for(const t in s)this._fireEvent(t,s[t]);o&&this._fireEvent("move",o.originalEvent);for(const t in e){const{originalEvent:r}=e[t];this._fireEvent(t,r)}const a={};let l;for(const t in this._eventsInProgress){const{handlerName:e,originalEvent:i}=this._eventsInProgress[t];this._handlersById[e].isActive()||(delete this._eventsInProgress[t],l=r[e]||i,a[`${t}end`]=l)}for(const t in a)this._fireEvent(t,a[t]);const c=ws(this._eventsInProgress);if(i&&(n||o)&&!c){this._updatingCamera=!0;const e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),r=t=>0!==t&&-this._bearingSnap<t&&t<this._bearingSnap;e?(r(e.bearing||this._map.getBearing())&&(e.bearing=0),this._map.easeTo(e,{originalEvent:l})):(this._map.fire(new t.g("moveend",{originalEvent:l})),r(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new t.g(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{this._frameId=void 0,this.handleEvent(new Ts("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const ks="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class As extends t.E{constructor(e,r){super(),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=r.bearingSnap,this._respectPrefersReducedMotion=!1!==r.respectPrefersReducedMotion,t.br(["_renderFrameCallback"],this)}getCenter(){return new t.aJ(this.transform.center.lng,this.transform.center.lat)}setCenter(t,e){return this.jumpTo({center:t},e)}panBy(e,r,i){return e=t.P.convert(e).mult(-1),this.panTo(this.transform.center,t.Q({offset:e},r),i)}panTo(e,r,i){return this.easeTo(t.Q({center:e},r),i)}getZoom(){return this.transform.zoom}setZoom(t,e){return this.jumpTo({zoom:t},e),this}zoomTo(e,r,i){return this.easeTo(t.Q({zoom:e},r),i)}zoomIn(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}zoomOut(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}getBearing(){return this.transform.bearing}setBearing(t,e){return this.jumpTo({bearing:t},e),this}getPadding(){return this.transform.padding}setPadding(t,e){return this.jumpTo({padding:t},e),this}rotateTo(e,r,i){return this.easeTo(t.Q({bearing:e},r),i)}resetNorth(e,r){return this.rotateTo(0,t.Q({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(t.Q({bearing:0,pitch:0,duration:1e3},e),r),this}snapToNorth(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}getPitch(){return this.transform.pitch}setPitch(t,e){return this.jumpTo({pitch:t},e),this}cameraForBounds(e,r){e=t.aj.convert(e);const i=r&&r.bearing||0,n=r&&r.pitch||0,o=e.getNorthWest(),s=e.getSouthEast();return this._cameraForBounds(this.transform,o,s,i,n,r)}_extendPadding(e){const r={top:0,right:0,bottom:0,left:0};return null==e?t.Q({},r,this.transform.padding):"number"==typeof e?{top:e,bottom:e,right:e,left:e}:t.Q({},r,e)}_extendCameraOptions(e){return(e=t.Q({offset:[0,0],maxZoom:this.transform.maxZoom},e)).padding=this._extendPadding(e.padding),e}_minimumAABBFrustumDistance(t,e){const r=e.max[0]-e.min[0],i=e.max[1]-e.min[1];return r/i>t.aspect?r/(2*Math.tan(.5*t.fovX)*t.aspect):i/(2*Math.tan(.5*t.fovY)*t.aspect)}_cameraForBoundsOnGlobe(e,r,i,n,o,s){const a=e.clone(),l=this._extendCameraOptions(s);a.bearing=n,a.pitch=o;const c=t.aJ.convert(r),u=t.aJ.convert(i),h=.5*(c.lat+u.lat),d=.5*(c.lng+u.lng),p=t.d7(h,d),f=t.$.normalize([],p),m=t.$.normalize([],t.$.cross([],f,[0,1,0])),g=t.$.cross([],m,f),y=[m[0],m[1],m[2],0,g[0],g[1],g[2],0,f[0],f[1],f[2],0,0,0,0,1],v=[p,t.d7(c.lat,c.lng),t.d7(u.lat,c.lng),t.d7(u.lat,u.lng),t.d7(c.lat,u.lng),t.d7(h,c.lng),t.d7(h,u.lng),t.d7(c.lat,d),t.d7(u.lat,d)];let _=t.b8.fromPoints(v.map((e=>[t.$.dot(m,e),t.$.dot(g,e),t.$.dot(f,e)])));const b=t.$.transformMat4([],_.center,y);0===t.$.squaredLength(b)&&t.$.set(b,0,0,1),t.$.normalize(b,b),t.$.scale(b,b,t.cF),a.center=t.d8(b);const x=a.getWorldToCameraMatrix(),w=t.ae.invert(new Float64Array(16),x);_=t.b8.applyTransform(_,t.ae.multiply([],x,y));const T=this._extendAABB(_,a,l,n);if(!T)return void t.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");_=T,t.$.transformMat4(b,b,x);const E=.5*(_.max[2]-_.min[2]),S=this._minimumAABBFrustumDistance(a,_),P=t.$.scale([],[0,0,1],E),k=t.$.add(P,b,P),A=S+(0===a.pitch?0:t.$.distance(b,k)),M=a.globeCenterInViewSpace,C=t.$.sub([],b,[M[0],M[1],M[2]]);t.$.normalize(C,C),t.$.scale(C,C,A);const I=t.$.add([],b,C);t.$.transformMat4(I,I,w);const O=t.da/t.cF,L=t.$.length(I),D=t.ay(Math.max(L*O-t.da,Number.EPSILON),0),R=Math.min(a.zoomFromMercatorZAdjusted(D),l.maxZoom);return R>.5*(t.b3+t.aV)?(a.setProjection({name:"mercator"}),a.zoom=R,this._cameraForBounds(a,r,i,n,o,s)):{center:a.center,zoom:R,bearing:n,pitch:o}}_extendAABB(e,r,i,n){const o=.5*((i.padding.left||0)+(i.padding.right||0)),s=.5*((i.padding.top||0)+(i.padding.bottom||0)),a=s,l=o,c=o,u=s,h=r.width-(l+c),d=r.height-(a+u),p=t.$.sub([],e.max,e.min),f=Math.min(h/p[0],d/p[1]),m=Math.min(r.scaleZoom(r.scale*f),i.maxZoom);if(isNaN(m))return null;const g=r.scale/r.zoomScale(m),y=new t.b8([e.min[0]-l*g,e.min[1]-u*g,e.min[2]],[e.max[0]+c*g,e.max[1]+a*g,e.max[2]]),v=("number"==typeof i.offset.x&&"number"==typeof i.offset.y?new t.P(i.offset.x,i.offset.y):t.P.convert(i.offset)).rotate(-t.ac(n));return y.center[0]-=v.x*g,y.center[1]+=v.y*g,y}queryTerrainElevation(e,r){const i=this.transform.elevation;return i?(r=t.Q({},{exaggerated:!0},r),i.getAtPoint(t._.fromLngLat(e),null,r.exaggerated)):null}_cameraForBounds(e,r,i,n,o,s){if("globe"===e.projection.name)return this._cameraForBoundsOnGlobe(e,r,i,n,o,s);const a=e.clone(),l=this._extendCameraOptions(s);a.bearing=n,a.pitch=o;const c=t.aJ.convert(r),u=t.aJ.convert(i),h=new t.aJ(c.lng,u.lat),d=new t.aJ(u.lng,c.lat),p=a.project(c),f=a.project(u),m=this.queryTerrainElevation(c),g=this.queryTerrainElevation(u),y=this.queryTerrainElevation(h),v=this.queryTerrainElevation(d),_=[[p.x,p.y,Math.min(m||0,g||0,y||0,v||0)],[f.x,f.y,Math.max(m||0,g||0,y||0,v||0)]];let b=t.b8.fromPoints(_);const x=a.getWorldToCameraMatrix(),w=t.ae.invert(new Float64Array(16),x);b=t.b8.applyTransform(b,x);const T=this._extendAABB(b,a,l,n);if(!T)return void t.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");b=T;const E=.5*t.$.sub([],b.max,b.min)[2],S=this._minimumAABBFrustumDistance(a,b),P=[0,0,1,0];t.aB.transformMat4(P,P,x),t.aB.normalize(P,P);const k=t.$.scale([],P,S+E),A=t.$.add([],b.center,k);t.$.transformMat4(b.center,b.center,w),t.$.transformMat4(A,A,w);const M=[b.center[0],b.center[1],A[2]*a.pixelsPerMeter];t.$.scale(M,M,1/a.worldSize);const C=t.d9(M[0]),I=t.az(M[1]),O=Math.min(a._zoomFromMercatorZ(M[2]),l.maxZoom),L=new t.aJ(C,I);return a.mercatorFromTransition&&O<.5*(t.b3+t.aV)?(a.setProjection({name:"globe"}),a.zoom=O,this._cameraForBounds(a,r,i,n,o,s)):{center:L,zoom:O,bearing:n,pitch:o}}fitBounds(t,e,r){const i=this.cameraForBounds(t,e);return this._fitInternal(i,e,r)}fitScreenCoordinates(e,r,i,n,o){const s=t.P.convert(e),a=t.P.convert(r),l=new t.P(Math.min(s.x,a.x),Math.min(s.y,a.y)),c=new t.P(Math.max(s.x,a.x),Math.max(s.y,a.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(s,a))return this;const u=this.transform.pointLocation3D(l),h=this.transform.pointLocation3D(c),d=this.transform.pointLocation3D(new t.P(l.x,c.y)),p=this.transform.pointLocation3D(new t.P(c.x,l.y)),f=[Math.min(u.lng,h.lng,d.lng,p.lng),Math.min(u.lat,h.lat,d.lat,p.lat)],m=[Math.max(u.lng,h.lng,d.lng,p.lng),Math.max(u.lat,h.lat,d.lat,p.lat)],g=n&&n.pitch?n.pitch:this.getPitch(),y=this._cameraForBounds(this.transform,f,m,i,g,n);return this._fitInternal(y,n,o)}_fitInternal(e,r,i){return e?(r=t.Q(e,r)).linear?this.easeTo(r,i):this.flyTo(r,i):this}jumpTo(e,r){this.stop();const i=e.preloadOnly?this.transform.clone():this.transform;let n=!1,o=!1,s=!1;if("zoom"in e&&i.zoom!==+e.zoom&&(n=!0,i.zoom=+e.zoom),void 0!==e.center&&(i.center=t.aJ.convert(e.center)),"bearing"in e&&i.bearing!==+e.bearing&&(o=!0,i.bearing=+e.bearing),"pitch"in e&&i.pitch!==+e.pitch&&(s=!0,i.pitch=+e.pitch),null!=e.padding){const t="number"==typeof e.padding?this._extendPadding(e.padding):e.padding;i.isPaddingEqual(t)||(i.padding=t)}return e.preloadOnly?(this._preloadTiles(i),this):(this.fire(new t.g("movestart",r)).fire(new t.g("move",r)),n&&this.fire(new t.g("zoomstart",r)).fire(new t.g("zoom",r)).fire(new t.g("zoomend",r)),o&&this.fire(new t.g("rotatestart",r)).fire(new t.g("rotate",r)).fire(new t.g("rotateend",r)),s&&this.fire(new t.g("pitchstart",r)).fire(new t.g("pitch",r)).fire(new t.g("pitchend",r)),this.fire(new t.g("moveend",r)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||t.w(ks),this.transform.getFreeCameraOptions()}setFreeCameraOptions(e,r){const i=this.transform;if(!i.projection.supportsFreeCamera)return t.w(ks),this;this.stop();const n=i.zoom,o=i.pitch,s=i.bearing;i.setFreeCameraOptions(e);const a=n!==i.zoom,l=o!==i.pitch,c=s!==i.bearing;return this.fire(new t.g("movestart",r)).fire(new t.g("move",r)),a&&this.fire(new t.g("zoomstart",r)).fire(new t.g("zoom",r)).fire(new t.g("zoomend",r)),c&&this.fire(new t.g("rotatestart",r)).fire(new t.g("rotate",r)).fire(new t.g("rotateend",r)),l&&this.fire(new t.g("pitchstart",r)).fire(new t.g("pitch",r)).fire(new t.g("pitchend",r)),this.fire(new t.g("moveend",r)),this}easeTo(e,r){this._stop(!1,e.easeId),(!1===(e=t.Q({offset:[0,0],duration:500,easing:t.d5},e)).animate||this._prefersReducedMotion(e))&&(e.duration=0);const i=this.transform,n=this.getZoom(),o=this.getBearing(),s=this.getPitch(),a=this.getPadding(),l="zoom"in e?+e.zoom:n,c="bearing"in e?this._normalizeBearing(e.bearing,o):o,u="pitch"in e?+e.pitch:s,h=this._extendPadding(e.padding),d=t.P.convert(e.offset);let p,f,m;if("globe"===i.projection.name){const r=t._.fromLngLat(i.center),n=d.rotate(-i.angle);r.x+=n.x/i.worldSize,r.y+=n.y/i.worldSize;const o=r.toLngLat(),s=t.aJ.convert(e.center||o);this._normalizeCenter(s),p=i.centerPoint.add(n),f=new t.P(r.x,r.y).mult(i.worldSize),m=new t.P(t.ak(s.lng),t.al(s.lat)).mult(i.worldSize).sub(f)}else{p=i.centerPoint.add(d);const r=i.pointLocation(p),n=t.aJ.convert(e.center||r);this._normalizeCenter(n),f=i.project(r),m=i.project(n).sub(f)}const g=i.zoomScale(l-n);let y,v;e.around&&(y=t.aJ.convert(e.around),v=i.locationPoint(y));const _=this._zooming||l!==n,b=this._rotating||o!==c,x=this._pitching||u!==s,w=!i.isPaddingEqual(h),T=i=>T=>{if(_&&(i.zoom=t.a3(n,l,T)),b&&(i.bearing=t.a3(o,c,T)),x&&(i.pitch=t.a3(s,u,T)),w&&(i.interpolatePadding(a,h,T),p=i.centerPoint.add(d)),y)i.setLocationAtPoint(y,v);else{const t=i.zoomScale(i.zoom-n),e=l>n?Math.min(2,g):Math.max(.5,g),r=Math.pow(e,1-T),o=i.unproject(f.add(m.mult(T*r)).mult(t));i.setLocationAtPoint(i.renderWorldCopies?o.wrap():o,p)}return e.preloadOnly||this._fireMoveEvents(r),i};if(e.preloadOnly){const t=this._emulate(T,e.duration,i);return this._preloadTiles(t),this}const E={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=_,this._rotating=b,this._pitching=x,this._padding=w,this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,E),this._ease(T(i),(t=>{"sea"===i.cameraElevationReference&&i.recenterOnTerrain(),this._afterEase(r,t)}),e),this}_prepareEase(e,r,i={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&0===this.transform.pitch&&"globe"!==this.transform.projection.name&&(this.transform.cameraElevationReference="ground"),r||i.moving||this.fire(new t.g("movestart",e)),this._zooming&&!i.zooming&&this.fire(new t.g("zoomstart",e)),this._rotating&&!i.rotating&&this.fire(new t.g("rotatestart",e)),this._pitching&&!i.pitching&&this.fire(new t.g("pitchstart",e))}_fireMoveEvents(e){this.fire(new t.g("move",e)),this._zooming&&this.fire(new t.g("zoom",e)),this._rotating&&this.fire(new t.g("rotate",e)),this._pitching&&this.fire(new t.g("pitch",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const i=this._zooming,n=this._rotating,o=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new t.g("zoomend",e)),n&&this.fire(new t.g("rotateend",e)),o&&this.fire(new t.g("pitchend",e)),this.fire(new t.g("moveend",e))}flyTo(e,r){if(this._prefersReducedMotion(e)){const i=t.ai(e,["center","zoom","bearing","pitch","around","padding"]);return this.jumpTo(i,r)}this.stop(),e=t.Q({offset:[0,0],speed:1.2,curve:1.42,easing:t.d5},e);const i=this.transform,n=this.getZoom(),o=this.getBearing(),s=this.getPitch(),a=this.getPadding(),l="zoom"in e?t.au(+e.zoom,i.minZoom,i.maxZoom):n,c="bearing"in e?this._normalizeBearing(e.bearing,o):o,u="pitch"in e?+e.pitch:s,h=this._extendPadding(e.padding),d=i.zoomScale(l-n),p=t.P.convert(e.offset);let f=i.centerPoint.add(p);const m=i.pointLocation(f),g=t.aJ.convert(e.center||m);this._normalizeCenter(g);const y=i.project(m),v=i.project(g).sub(y);let _=e.curve;const b=Math.max(i.width,i.height),x=b/d,w=v.mag();if("minZoom"in e){const r=t.au(Math.min(e.minZoom,n,l),i.minZoom,i.maxZoom),o=b/i.zoomScale(r-n);_=Math.sqrt(o/w*2)}const T=_*_;function E(t){const e=(x*x-b*b+(t?-1:1)*T*T*w*w)/(2*(t?x:b)*T*w);return Math.log(Math.sqrt(e*e+1)-e)}function S(t){return(Math.exp(t)-Math.exp(-t))/2}function P(t){return(Math.exp(t)+Math.exp(-t))/2}const k=E(0);let A=function(t){return P(k)/P(k+_*t)},M=function(t){return b*((P(k)*(S(e=k+_*t)/P(e))-S(k))/T)/w;var e},C=(E(1)-k)/_;if(Math.abs(w)<1e-6||!isFinite(C)){if(Math.abs(b-x)<1e-6)return this.easeTo(e,r);const t=x<b?-1:1;C=Math.abs(Math.log(x/b))/_,M=function(){return 0},A=function(e){return Math.exp(t*_*e)}}e.duration="duration"in e?+e.duration:1e3*C/("screenSpeed"in e?+e.screenSpeed/_:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0);const I=o!==c,O=u!==s,L=!i.isPaddingEqual(h),D=i=>d=>{const m=d*C,_=1/A(m);i.zoom=1===d?l:n+i.scaleZoom(_),I&&(i.bearing=t.a3(o,c,d)),O&&(i.pitch=t.a3(s,u,d)),L&&(i.interpolatePadding(a,h,d),f=i.centerPoint.add(p));const b=1===d?g:i.unproject(y.add(v.mult(M(m))).mult(_));return i.setLocationAtPoint(i.renderWorldCopies?b.wrap():b,f),i._updateCameraOnTerrain(),e.preloadOnly||this._fireMoveEvents(r),i};if(e.preloadOnly){const t=this._emulate(D,e.duration,i);return this._preloadTiles(t),this}return this._zooming=!0,this._rotating=I,this._pitching=O,this._padding=L,this._prepareEase(r,!1),this._ease(D(i),(()=>this._afterEase(r)),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(t){}_cancelRenderFrame(t){}_stop(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const t=this._onEaseEnd;this._onEaseEnd=void 0,t.call(this,e)}if(!t){const t=this.handlers;t&&t.stop(!1)}return this}_ease(e,r,i){!1===i.animate||0===i.duration?(e(1),r()):(this._easeStart=t.e.now(),this._easeOptions=i,this._onEaseFrame=e,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const e=Math.min((t.e.now()-this._easeStart)/this._easeOptions.duration,1),r=this._onEaseFrame;r&&r(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(e,r){e=t.av(e,-180,180);const i=Math.abs(e-r);return Math.abs(e-360-r)<i&&(e-=360),Math.abs(e+360-r)<i&&(e+=360),e}_normalizeCenter(t){const e=this.transform;if(e.maxBounds)return;if("globe"!==e.projection.name&&!e.renderWorldCopies)return;const r=t.lng-e.center.lng;t.lng+=r>180?-360:r<-180?360:0}_prefersReducedMotion(e){return this._respectPrefersReducedMotion&&t.e.prefersReducedMotion&&!(e&&e.essential)}_emulate(t,e,r){const i=Math.ceil(15*e/1e3),n=[],o=t(r.clone());for(let t=0;t<=i;t++){const e=o(t/i);n.push(e.clone())}return n}_preloadTiles(t,e){}}class Ms{constructor(e={}){this.options=e,t.br(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const e=this.options&&this.options.compact,r=t._getUIString("AttributionControl.ToggleAttribution");this._map=t,this._container=n("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=n("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",r);const i=n("span","mapboxgl-ctrl-icon",this._compactButton);return i.setAttribute("aria-hidden","true"),i.setAttribute("title",r),this._innerContainer=n("div","mapboxgl-ctrl-attrib-inner",this._container),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));const r=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.db.ACCESS_TOKEN}];if(e){const i=r.reduce(((t,e,i)=>(e.value&&(t+=`${e.key}=${e.value}${i<r.length-1?"&":""}`),t)),"?");e.href=`${t.db.FEEDBACK_URL}/${i}#${Io(this._map,!0)}`,e.rel="noopener nofollow"}}_updateData(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}const e=this._map.style._mergedSourceCaches;for(const r in e){const i=e[r];if(i.used){const e=i.getSource();e.attribution&&t.indexOf(e.attribution)<0&&t.push(e.attribution)}}t.sort(((t,e)=>t.length-e.length)),t=t.filter(((e,r)=>{for(let i=r+1;i<t.length;i++)if(t[i].indexOf(e)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const r=t.join(" | ");r!==this._attribHTML&&(this._attribHTML=r,t.length?(this._innerContainer.innerHTML=r,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Cs{constructor(){t.br(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=n("div","mapboxgl-ctrl");const e=n("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(0===Object.entries(t).length)return!0;for(const e in t){const r=t[e].getSource();if(r.hasOwnProperty("mapbox_logo")&&!r.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}}}class Is{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}remove(t){const e=this._currentlyRunning,r=e?this._queue.concat(e):this._queue;for(const e of r)if(e.id===t)return void(e.cancelled=!0)}run(t=0){const e=this._currentlyRunning=this._queue;this._queue=[];for(const r of e)if(!r.cancelled&&(r.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Os(e,r,i){if(e=new t.aJ(e.lng,e.lat),r){const n=new t.aJ(e.lng-360,e.lat),o=new t.aJ(e.lng+360,e.lat),s=360*Math.ceil(Math.abs(e.lng-i.center.lng)/360),a=i.locationPoint(e).distSqr(r),l=r.x<0||r.y<0||r.x>i.width||r.y>i.height;i.locationPoint(n).distSqr(r)<a&&(l||Math.abs(n.lng-i.center.lng)<s)?e=n:i.locationPoint(o).distSqr(r)<a&&(l||Math.abs(o.lng-i.center.lng)<s)&&(e=o)}for(;Math.abs(e.lng-i.center.lng)>180;){const t=i.locationPoint(e);if(t.x>=0&&t.y>=0&&t.x<=i.width&&t.y<=i.height)break;e.lng>i.center.lng?e.lng-=360:e.lng+=360}return e}const Ls={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ds extends t.E{constructor(e,r){if(super(),(e instanceof HTMLElement||r)&&(e=t.Q({element:e},r)),t.br(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=e&&e.occludedOpacity||.2,e&&e.element)this._element=e.element,this._offset=t.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=n("div");const r=41,i=27,s=o("svg",{display:"block",height:r*this._scale+"px",width:i*this._scale+"px",viewBox:`0 0 ${i} ${r}`},this._element),a=o("radialGradient",{id:"shadowGradient"},o("defs",{},s));o("stop",{offset:"10%","stop-opacity":.4},a),o("stop",{offset:"100%","stop-opacity":.05},a),o("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},s),o("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},s),o("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},s),o("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},s),this._offset=t.P.convert(e&&e.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(t=>{t.preventDefault()})),this._element.addEventListener("mousedown",(t=>{t.preventDefault()}));const i=this._element.classList;for(const t in Ls)i.remove(`mapboxgl-marker-anchor-${t}`);i.add(`mapboxgl-marker-anchor-${this._anchor}`);const s=e&&e.className?e.className.trim().split(/\s+/):[];i.add(...s),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.aJ.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const e=38.1,r=13.5,i=Math.sqrt(Math.pow(r,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[i,-1*(e-r+i)],"bottom-right":[-i,-1*(e-r+i)],left:[r,-1*(e-r)],right:[-r,-1*(e-r)]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const e=t.code,r=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==r&&13!==r||this.togglePopup()}_onMapClick(t){const e=t.originalEvent.target,r=this._element;this._popup&&(e===r||r.contains(e))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map,e=this._pos;if(!t||!e)return!1;const r=t.unproject(e),i=t.getFreeCameraOptions();if(!i.position)return!1;const n=i.position.toLngLat();return n.distanceTo(r)<.9*n.distanceTo(this._lngLat)}_evaluateOpacity(){const e=this._map;if(!e)return;const r=this._pos;if(!r||r.x<0||r.x>e.transform.width||r.y<0||r.y>e.transform.height)return void this._clearFadeTimer();const i=e.unproject(r);let n;e._showingGlobe()&&t.dc(e.transform,this._lngLat)?n=0:(n=1-e._queryFogOpacity(i),e.transform._terrainEnabled()&&e.getTerrain()&&this._behindTerrain()&&(n*=this._occludedOpacity)),this._element.style.opacity=`${n}`,this._element.style.pointerEvents=n>0?"auto":"none",this._popup&&this._popup._setOpacity(n),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const e=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${t.x}px,${t.y}px)\n            ${Ls[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${e.x}px,${e.y}px)\n        `}_calculateXYTransform(){const e=this._pos,r=this._map,i=this.getPitchAlignment();if(!r||!e||"map"!==i)return"";if(!r._showingGlobe()){const t=r.getPitch();return t?`rotateX(${t}deg)`:""}const n=t.b1(t.dd(r.transform,this._lngLat)),o=e.sub(t.de(r.transform)),s=Math.abs(o.x)+Math.abs(o.y);if(0===s)return"";const a=n/s;return`rotateX(${-o.y*a}deg) rotateY(${o.x*a}deg)`}_calculateZTransform(){const e=this._pos,r=this._map;if(!r||!e)return"";let i=0;const n=this.getRotationAlignment();if("map"===n)if(r._showingGlobe()){const e=r.project(new t.aJ(this._lngLat.lng,this._lngLat.lat+.001)),n=r.project(new t.aJ(this._lngLat.lng,this._lngLat.lat-.001)).sub(e);i=t.b1(Math.atan2(n.y,n.x))-90}else i=-r.getBearing();else if("horizon"===n){const n=t.a0(4,6,r.getZoom()),o=t.de(r.transform);o.y+=n*r.transform.height;const s=e.sub(o),a=t.b1(Math.atan2(s.y,s.x));i=(a>90?a-270:a+90)*(1-n)}return i+=this._rotation,i?`rotateZ(${i}deg)`:""}_update(t){cancelAnimationFrame(this._updateFrameId);const e=this._map;e&&(e.transform.renderWorldCopies&&(this._lngLat=Os(this._lngLat,this._pos,e.transform)),this._pos=e.project(this._lngLat),!0===t?this._updateFrameId=requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),e._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(e._showingGlobe()||e.getTerrain()||e.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(e){return this._offset=t.P.convert(e),this._update(),this}addClassName(t){return this._element.classList.add(t),this}removeClassName(t){return this._element.classList.remove(t),this}toggleClassName(t){return this._element.classList.toggle(t)}_onMove(e){const r=this._map;if(!r)return;const i=this._pointerdownPos,n=this._positionDelta;if(i&&n){if(!this._isDragging){const t=this._clickTolerance||r._clickTolerance;if(e.point.dist(i)<t)return;this._isDragging=!0}this._pos=e.point.sub(n),this._lngLat=r.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.g("dragstart"))),this.fire(new t.g("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const e=this._map;e&&(e.off("mousemove",this._onMove),e.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new t.g("dragend")),this._state="inactive"}_addDragHandler(t){const e=this._map,r=this._pos;e&&r&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(r),this._pointerdownPos=t.point,this._state="pending",e.on("mousemove",this._onMove),e.on("touchmove",this._onMove),e.once("mouseup",this._onUp),e.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const e=this._map;return e&&(t?(e.on("mousedown",this._addDragHandler),e.on("touchstart",this._addDragHandler)):(e.off("mousedown",this._addDragHandler),e.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(t){return this._occludedOpacity=t||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Rs={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Fs=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Bs(e=new t.P(0,0),r="bottom"){if("number"==typeof e){const i=Math.round(Math.sqrt(.5*Math.pow(e,2)));switch(r){case"top":return new t.P(0,e);case"top-left":return new t.P(i,i);case"top-right":return new t.P(-i,i);case"bottom":return new t.P(0,-e);case"bottom-left":return new t.P(i,-i);case"bottom-right":return new t.P(-i,-i);case"left":return new t.P(e,0);case"right":return new t.P(-e,0)}return new t.P(0,0)}return e instanceof t.P||Array.isArray(e)?t.P.convert(e):t.P.convert(e[r]||[0,0])}class zs{constructor(t){this.jumpTo(t)}getValue(e){if(e<=this._startTime)return this._start;if(e>=this._endTime)return this._end;const r=t.bb((e-this._startTime)/(this._endTime-this._startTime));return this._start*(1-r)+this._end*r}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,e,r){this._start=this.getValue(e),this._end=t,this._startTime=e,this._endTime=e+r}}const js={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Ns{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}const Vs={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0},Us={showCompass:!0,showZoom:!0,visualizePitch:!1};class $s{constructor(e,r,i=!1){this._clickTolerance=10,this.element=r,this.mouseRotate=new Qo({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,i&&(this.mousePitch=new ts({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),t.br(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),r.addEventListener("mousedown",this.mousedown),r.addEventListener("touchstart",this.touchstart,{passive:!1}),r.addEventListener("touchmove",this.touchmove),r.addEventListener("touchend",this.touchend),r.addEventListener("touchcancel",this.reset)}down(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),c()}move(t,e){const r=this.map,i=this.mouseRotate.mousemoveWindow(t,e),n=i&&i.bearingDelta;if(n&&r.setBearing(r.getBearing()+n),this.mousePitch){const i=this.mousePitch.mousemoveWindow(t,e),n=i&&i.pitchDelta;n&&r.setPitch(r.getPitch()+n)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){u(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(e){this.down(t.Q({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),p(this.element,e)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,p(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=f(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){1!==t.targetTouches.length?this.reset():(this._lastPos=f(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Gs={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Hs={maxWidth:100,unit:"metric"},qs={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Ws={version:t.dw,supported:e,setRTLTextPlugin:t.dy,getRTLTextPluginStatus:t.dz,Map:class extends As{constructor(e){t.df.mark(t.dg.create);const r=e;if(null!=(e=t.Q({},Vs,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(e.antialias&&t.dh(window)&&(e.antialias=!1,t.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new ur(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),e),this._repaint=!!e.repaint,this._interactive=e.interactive,this._minTileCacheSize=e.minTileCacheSize,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=e.crossSourceCollisions,this._collectResourceTiming=e.collectResourceTiming,this._language=this._parseLanguage(e.language),this._worldview=e.worldview,this._renderTaskQueue=new Is,this._domRenderTaskQueue=new Is,this._controls=[],this._markers=[],this._popups=[],this._mapId=t.di(),this._locale=t.Q({},js,e.locale),this._clickTolerance=e.clickTolerance,this._cooperativeGestures=e.cooperativeGestures,this._performanceMetricsCollection=e.performanceMetricsCollection,this._tessellationStep=e.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=e.precompilePrograms,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new zs(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._requestManager=new t.dj(e.transformRequest,e.accessToken,e.testMode),this._silenceAuthErrors=!!e.testMode,this._contextCreateOptions=e.contextCreateOptions?{...e.contextCreateOptions}:{},"string"==typeof e.container){const t=document.getElementById(e.container);if(!t)throw new Error(`Container '${e.container.toString()}' not found.`);this._container=t}else{if(!(e.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(this._container.childNodes.length>0&&t.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),e.maxBounds&&this.setMaxBounds(e.maxBounds),t.br(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Ns),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},(()=>{this._update()})),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");if(this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Ps(this,e),this._localFontFamily=e.localFontFamily,this._localIdeographFontFamily=e.localIdeographFontFamily,(e.style||!e.testMode)&&this.setStyle(e.style||t.db.DEFAULT_STYLE,{config:e.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),e.projection&&this.setProjection(e.projection),e.hash&&(this._hash=new Co("string"==typeof e.hash&&e.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){null==r.center&&null==r.zoom||(this.transform._unmodified=!1),this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch});const i=e.bounds;i&&(this.resize(),this.fitBounds(i,t.Q({},e.fitBoundsOptions,{duration:0})))}this.resize(),e.attributionControl&&this.addControl(new Ms({customAttribution:e.customAttribution})),this._logoControl=new Cs,this.addControl(this._logoControl,e.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()})),this.on("data",(e=>{this._update("style"===e.dataType),this.fire(new t.g(`${e.dataType}data`,e))})),this.on("dataloading",(e=>{this.fire(new t.g(`${e.dataType}dataloading`,e))}))}_getMapId(){return this._mapId}addControl(e,r){if(void 0===r&&(r=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.f(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=e.onAdd(this);this._controls.push(e);const n=this._controlPositions[r];return-1!==r.indexOf("bottom")?n.insertBefore(i,n.firstChild):n.appendChild(i),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.f(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(e);return r>-1&&this._controls.splice(r,1),e.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(e){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new t.g("movestart",e)).fire(new t.g("move",e)),this.fire(new t.g("resize",e)),r&&this.fire(new t.g("moveend",e)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(e){return this.transform.setMaxBounds(t.aj.convert(e)),this._update()}setMinZoom(e){if((e=e??-2)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e?this.setZoom(e):this.fire(new t.g("zoomstart")).fire(new t.g("zoom")).fire(new t.g("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=e??22)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e?this.setZoom(e):this.fire(new t.g("zoomstart")).fire(new t.g("zoom")).fire(new t.g("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=e??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e?this.setPitch(e):this.fire(new t.g("pitchstart")).fire(new t.g("pitch")).fire(new t.g("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if((e=e??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e?this.setPitch(e):this.fire(new t.g("pitchstart")).fire(new t.g("pitch")).fire(new t.g("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(t){return"auto"===t?navigator.language:Array.isArray(t)?0===t.length?void 0:t.map((t=>"auto"===t?navigator.language:t)):t}setLanguage(t){const e=this._parseLanguage(t);if(!this.style||e===this._language)return this;this._language=e,this.style.reloadSources();for(const t of this._controls)t._setLanguage&&t._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(t){return this.style&&t!==this._worldview?(this._worldview=t,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(t){return this._lazyInitEmptyStyle(),t?"string"==typeof t&&(t={name:t}):t=null,this._useExplicitProjection=!!t,this._prioritizeAndUpdateProjection(t,this.style.projection)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const e=this.transform,r=e.projection.name;let i;"globe"===r&&e.zoom>=t.aV?(e.setMercatorFromTransition(),i=!0):"mercator"===r&&e.zoom<t.aV&&(e.setProjection({name:"globe"}),i=!0),i&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(t,e){return this._updateProjection(t||e||{name:"mercator"})}_updateProjection(e){let r;return r="globe"===e.name&&this.transform.zoom>=t.aV?this.transform.setMercatorFromTransition():this.transform.setProjection(e),this.style.applyProjectionUpdate(),r&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(e){return this.transform.locationPoint3D(t.aJ.convert(e))}unproject(e){return this.transform.pointLocation3D(t.P.convert(e))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(t,e,r){if("mouseenter"===t||"mouseover"===t){let i=!1;const n=n=>{const o=e.filter((t=>this.getLayer(t))),s=o.length?this.queryRenderedFeatures(n.point,{layers:o}):[];s.length?i||(i=!0,r.call(this,new No(t,this,n.originalEvent,{features:s}))):i=!1},o=()=>{i=!1};return{layers:new Set(e),listener:r,delegates:{mousemove:n,mouseout:o}}}if("mouseleave"===t||"mouseout"===t){let i=!1;const n=n=>{const o=e.filter((t=>this.getLayer(t)));(o.length?this.queryRenderedFeatures(n.point,{layers:o}):[]).length?i=!0:i&&(i=!1,r.call(this,new No(t,this,n.originalEvent)))},o=e=>{i&&(i=!1,r.call(this,new No(t,this,e.originalEvent)))};return{layers:new Set(e),listener:r,delegates:{mousemove:n,mouseout:o}}}{const i=t=>{const i=e.filter((t=>this.getLayer(t))),n=i.length?this.queryRenderedFeatures(t.point,{layers:i}):[];n.length&&(t.features=n,r.call(this,t),delete t.features)};return{layers:new Set(e),listener:r,delegates:{[t]:i}}}}on(t,e,r){if("function"==typeof e||void 0===r)return super.on(t,e);if(Array.isArray(e)||(e=[e]),e)for(const t of e)if(!this._isValidId(t))return this;const i=this._createDelegatedListener(t,e,r);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(i);for(const t in i.delegates)this.on(t,i.delegates[t]);return this}once(t,e,r){if("function"==typeof e||void 0===r)return super.once(t,e);if(Array.isArray(e)||(e=[e]),e)for(const t of e)if(!this._isValidId(t))return this;const i=this._createDelegatedListener(t,e,r);for(const t in i.delegates)this.once(t,i.delegates[t]);return this}off(t,e,r){if("function"==typeof e||void 0===r)return super.off(t,e);const i=new Set(Array.isArray(e)?e:[e]);for(const t of i)if(!this._isValidId(t))return this;const n=(t,e)=>{if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0},o=this._delegatedListeners?this._delegatedListeners[t]:void 0;return o&&(t=>{for(let e=0;e<t.length;e++){const o=t[e];if(o.listener===r&&n(o.layers,i)){for(const t in o.delegates)this.off(t,o.delegates[t]);return t.splice(e,1),this}}})(o),this}queryRenderedFeatures(e,r){if(!this.style)return[];if(void 0!==r||void 0===e||e instanceof t.P||Array.isArray(e)||(r=e,e=void 0),e=e||[[0,0],[this.transform.width,this.transform.height]],(r=r||{}).layers&&Array.isArray(r.layers))for(const t of r.layers)if(!this._isValidId(t))return[];return this.style.queryRenderedFeatures(e,r,this.transform)}querySourceFeatures(t,e){return this._isValidId(t)?this.style.querySourceFeatures(t,e):[]}isPointOnSurface(e){const{name:r}=this.transform.projection;return"globe"!==r&&"mercator"!==r&&t.w(`${r} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(t.P.convert(e))}setStyle(e,r){return r=t.Q({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r),this.style&&e&&!1!==r.diff&&r.localFontFamily===this._localFontFamily&&r.localIdeographFontFamily===this._localIdeographFontFamily&&!r.config?(this.style._diffStyle(e,((i,n)=>{i?(t.w(`Unable to perform style diff: ${String(i.message||i.error||i)}. Rebuilding the style from scratch.`),this._updateStyle(e,r)):n&&this._update(!0)}),(()=>{this._postStyleLoadEvent()})),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(e,r))}_getUIString(t){const e=this._locale[t];if(null==e)throw new Error(`Missing UI string '${t}'`);return e}_updateStyle(e,r){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),e){const i=t.Q({},r);r&&r.config&&(i.initialConfig=r.config,delete i.config),this.style=new Ao(this,i).load(e),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ao(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(t.w("There is no style added to the map."),!1)}_isValidId(e){return null==e?(this.fire(new t.f(new Error("IDs can't be empty."))),!1):!t.cY(e)||(this.fire(new t.f(new Error(`IDs can't contain special symbols: "${e}".`))),!1)}addSource(t,e){return this._isValidId(t)?(this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)):this}isSourceLoaded(t){return!!this._isValidId(t)&&!!this.style&&this.style._isSourceCacheLoaded(t)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(t,e,r){this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,r)}removeSource(t){return this._isValidId(t)?(this.style.removeSource(t),this._updateTerrain(),this._update(!0)):this}getSource(t){return this._isValidId(t)?this.style.getOwnSource(t):null}addImage(e,r,{pixelRatio:i=1,sdf:n=!1,stretchX:o,stretchY:s,content:a}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap){const{width:l,height:c,data:u}=t.e.getImageData(r);this.style.addImage(e,{data:new t.j({width:l,height:c},u),pixelRatio:i,stretchX:o,stretchY:s,content:a,sdf:n,version:0})}else if(void 0===r.width||void 0===r.height)this.fire(new t.f(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:l,height:c}=r,u=r;this.style.addImage(e,{data:new t.j({width:l,height:c},new Uint8Array(u.data)),pixelRatio:i,stretchX:o,stretchY:s,content:a,sdf:n,version:0,userImage:u}),u.onAdd&&u.onAdd(this,e)}}updateImage(e,r){this._lazyInitEmptyStyle();const i=this.style.getImage(e);if(!i)return void this.fire(new t.f(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const n=r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap?t.e.getImageData(r):r,{width:o,height:s,data:a}=n;if(void 0===o||void 0===s)return void this.fire(new t.f(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(o!==i.data.width||s!==i.data.height)return void this.fire(new t.f(new Error(`The width and height of the updated image (${o}, ${s})\n                must be that same as the previous version of the image\n                (${i.data.width}, ${i.data.height})`)));const l=!(r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap);i.data.replace(a,l),this.style.updateImage(e,i)}hasImage(e){return e?!!this.style&&!!this.style.getImage(e):(this.fire(new t.f(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(e,r){t.i(this._requestManager.transformRequest(e,t.R.Image),((e,i)=>{r(e,i instanceof HTMLImageElement?t.e.getImageData(i):i)}))}listImages(){return this.style.listImages()}addModel(t,e){this._lazyInitEmptyStyle(),this.style.addModel(t,e)}hasModel(e){return e?this.style.hasModel(e):(this.fire(new t.f(new Error("Missing required model id"))),!1)}removeModel(t){this.style.removeModel(t)}listModels(){return this.style.listModels()}addLayer(t,e){return this._isValidId(t.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)):this}getSlot(t){const e=this.getLayer(t);return e&&e.slot||null}setSlot(t,e){return this.style.setSlot(t,e),this.style.mergeLayers(),this._update(!0)}addImport(t,e){return this.style.addImport(t,e),this}updateImport(t,e){return"string"!=typeof e&&e.id!==t?(this.removeImport(t),this.addImport(e)):(this.style.updateImport(t,e),this._update(!0))}removeImport(t){return this.style.removeImport(t),this}moveImport(t,e){return this.style.moveImport(t,e),this._update(!0)}moveLayer(t,e){return this._isValidId(t)?(this.style.moveLayer(t,e),this._update(!0)):this}removeLayer(t){return this._isValidId(t)?(this.style.removeLayer(t),this._update(!0)):this}getLayer(t){if(!this._isValidId(t))return null;const e=this.style.getOwnLayer(t);return e?"custom"===e.type?e.implementation:e.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(t,e,r){return this._isValidId(t)?(this.style.setLayerZoomRange(t,e,r),this._update(!0)):this}setFilter(t,e,r={}){return this._isValidId(t)?(this.style.setFilter(t,e,r),this._update(!0)):this}getFilter(t){return this._isValidId(t)?this.style.getFilter(t):null}setPaintProperty(t,e,r,i={}){return this._isValidId(t)?(this.style.setPaintProperty(t,e,r,i),this._update(!0)):this}getPaintProperty(t,e){return this._isValidId(t)?this.style.getPaintProperty(t,e):null}setLayoutProperty(t,e,r,i={}){return this._isValidId(t)?(this.style.setLayoutProperty(t,e,r,i),this._update(!0)):this}getLayoutProperty(t,e){return this._isValidId(t)?this.style.getLayoutProperty(t,e):null}getSchema(t){return this.style.getSchema(t)}setSchema(t,e){return this.style.setSchema(t,e),this._update(!0)}getConfig(t){return this.style.getConfig(t)}setConfig(t,e){return this.style.setConfig(t,e),this._update(!0)}getConfigProperty(t,e){return this.style.getConfigProperty(t,e)}setConfigProperty(t,e,r){return this.style.setConfigProperty(t,e,r),this._update(!0)}setLights(t){if(this._lazyInitEmptyStyle(),t&&1===t.length&&"flat"===t[0].type){const e=t[0];e.properties?this.style.setFlatLight(e.properties,e.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(t),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const t=this.style.getLights()||[];return 0===t.length&&t.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),t}setLight(t,e={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:t}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(t){return this._lazyInitEmptyStyle(),!t&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(t),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(t){return this._lazyInitEmptyStyle(),this.style.setFog(t),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(t){return this._lazyInitEmptyStyle(),this.style.setColorTheme(t),this._update(!0)}setCamera(t){return this.style.setCamera(t),this._triggerCameraUpdate(t)}_triggerCameraUpdate(t){return this._update(this.transform.setOrthographicProjectionAtLowPitch("orthographic"===t["camera-projection"]))}getCamera(){return this.style.camera}_queryFogOpacity(e){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(t.aJ.convert(e),this.transform):0}setFeatureState(t,e){return this._isValidId(t.source)?(this.style.setFeatureState(t,e),this._update()):this}removeFeatureState(t,e){return this._isValidId(t.source)?(this.style.removeFeatureState(t,e),this._update()):this}getFeatureState(t){return this._isValidId(t.source)?this.style.getFeatureState(t):null}_updateContainerDimensions(){if(!this._container)return;const t=this._container.getBoundingClientRect().width||400,e=this._container.getBoundingClientRect().height||300;let r,i,n,o=this._container;for(;o&&(!i||!n);){const t=window.getComputedStyle(o).transform;t&&"none"!==t&&(r=t.match(/matrix.*\((.+)\)/)[1].split(", "),r[0]&&"0"!==r[0]&&"1"!==r[0]&&(i=r[0]),r[3]&&"0"!==r[3]&&"1"!==r[3]&&(n=r[3])),o=o.parentElement}this._containerWidth=i?Math.abs(t/i):t,this._containerHeight=n?Math.abs(e/n):e}_detectMissingCSS(){"rgb(250, 128, 114)"!==window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=n("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();const e=this._canvasContainer=n("div","mapboxgl-canvas-container",t);this._canvas=n("canvas","mapboxgl-canvas",e),this._interactive&&(e.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const r=this._controlContainer=n("div","mapboxgl-control-container",t),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((t=>{i[t]=n("div",`mapboxgl-ctrl-${t}`,r)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,r){const i=t.e.devicePixelRatio||1;this._canvas.width=i*Math.ceil(e),this._canvas.height=i*Math.ceil(r),this._canvas.style.width=`${e}px`,this._canvas.style.height=`${r}px`}_addMarker(t){this._markers.push(t)}_removeMarker(t){const e=this._markers.indexOf(t);-1!==e&&this._markers.splice(e,1)}_addPopup(t){this._popups.push(t)}_removePopup(t){const e=this._popups.indexOf(t);-1!==e&&this._popups.splice(e,1)}_setupPainter(){const r=t.Q({},e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl2",r);i?(t.dk(i,!0),this.painter=new Sn(i,this._contextCreateOptions,this.transform,this._tp),this.on("data",(t=>{"source"===t.dataType&&this.painter.setTileLoadedFlag(!0)})),t.dl.testSupport(i)):this.fire(new t.f(new Error("Failed to initialize WebGL")))}_contextLost(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.g("webglcontextlost",{originalEvent:e}))}_contextRestored(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.g("webglcontextrestored",{originalEvent:e}))}_onMapScroll(t){if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_requestDomTask(t){!this.loaded()||this.loaded()&&!this.isMoving()?t():this._domRenderTaskQueue.add(t)}_render(e){let r;this.fire(new t.g("renderstart")),++this._frameId;const i=this.painter.context.extTimerQuery,n=t.e.now(),o=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(r=o.createQuery(),o.beginQuery(i.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(e),this._domRenderTaskQueue.run(e),this._removed)return;this._updateProjectionTransition();const s=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const e=this.transform.zoom,r=this.transform.pitch,i=t.e.now(),n=new t.Y(e,{now:i,fadeDuration:s,pitch:r,transition:this.style.transition});this.style.update(n)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let a=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),a=this._updateAverageElevation(n),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):a=this._updateAverageElevation(n);const l=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,s,this._crossSourceCollisions,this.painter.replacementSource);if(l&&(this._placementDirty=l.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new t.g("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,t.df.mark(t.dg.load),this.fire(new t.g("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const e=t.e.now()-n;o.endQuery(i.TIME_ELAPSED_EXT),setTimeout((()=>{const i=o.getQueryParameter(r,o.QUERY_RESULT)/1e6;o.deleteQuery(r),this.fire(new t.g("gpu-timing-frame",{cpuTime:e,gpuTime:i}))}),50)}if(this.listens("gpu-timing-layer")){const e=this.painter.collectGpuTimers();setTimeout((()=>{const r=this.painter.queryGpuTimers(e);this.fire(new t.g("gpu-timing-layer",{layerTimes:r}))}),50)}if(this.listens("gpu-timing-deferred-render")){const e=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const r=this.painter.queryGpuTimeDeferredRender(e);this.fire(new t.g("gpu-timing-deferred-render",{gpuTime:r}))}),50)}const c=this._sourcesDirty||this._styleDirty||this._placementDirty||a;if(c||this._repaint)this.triggerRepaint();else{const e=this.idle();if(e&&(a=this._updateAverageElevation(n,!0)),a)this.triggerRepaint();else if(this._triggerFrame(!1),e&&(this.fire(new t.g("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const e=this._calculateSpeedIndex();this.fire(new t.g("speedindexcompleted",{speedIndex:e})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||c||(this._fullyLoaded=!0,t.df.mark(t.dg.fullLoad),this._performanceMetricsCollection&&t.dm(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(t){for(const e of this._markers)t&&!this.getRenderWorldCopies()&&(e._lngLat=e._lngLat.wrap()),e._update();for(const e of this._popups)!t||this.getRenderWorldCopies()||e._trackPointer||(e._lngLat=e._lngLat.wrap()),e._update()}_updateAverageElevation(t,e=!1){const r=t=>(this.transform.averageElevation=t,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&r(0);const i=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(i||(e||t-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(t)){const e=this.transform.averageElevation;let n=this.transform.sampleAverageElevation();null!=this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(n)?n=0:this._averageElevationLastSampledAt=t;const o=Math.abs(e-n);if(o>1){if(this._isInitialLoad||i)return this._averageElevation.jumpTo(n),r(n);this._averageElevation.easeTo(n,t,300)}else if(o>1e-4)return this._averageElevation.jumpTo(n),r(n)}return!!this._averageElevation.isEasing(t)&&r(this._averageElevation.getValue(t))}_authenticate(){t.dn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(e=>{if(e&&(e.message===t.dp||401===e.status)){const e=this.painter.context.gl;t.dk(e,!1),this._logoControl instanceof Cs&&this._logoControl._updateLogo(),e&&e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT|e.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new t.f(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),t.dq(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_postStyleLoadEvent(){this.style.globalId&&t.dr(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const t=this._isDragging();this.painter.updateTerrain(this.style,t)}_calculateSpeedIndex(){const t=this.painter.canvasCopy(),e=this.painter.getCanvasCopiesAndTimestamps();e.timeStamps.push(performance.now());const r=this.painter.context.gl,i=r.createFramebuffer();function n(t){r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0);const e=new Uint8Array(r.drawingBufferWidth*r.drawingBufferHeight*4);return r.readPixels(0,0,r.drawingBufferWidth,r.drawingBufferHeight,r.RGBA,r.UNSIGNED_BYTE,e),e}return r.bindFramebuffer(r.FRAMEBUFFER,i),this._canvasPixelComparison(n(t),e.canvasCopies.map(n),e.timeStamps)}_canvasPixelComparison(t,e,r){let i=r[1]-r[0];const n=t.length/4;for(let o=0;o<e.length;o++){const s=e[o];let a=0;for(let e=0;e<s.length;e+=4)s[e]===t[e]&&s[e+1]===t[e+1]&&s[e+2]===t[e+2]&&s[e+3]===t[e+3]&&(a+=1);i+=(r[o+2]-r[o+1])*(1-a/n)}return i}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),t.ds(this.painter.context.gl),t.dt.remove(),t.du.remove(),this._removed=!0,this.fire(new t.g("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(e){this._renderNextFrame=this._renderNextFrame||e,this.style&&!this._frame&&(this._frame=t.e.frame((t=>{const e=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,e&&this._render(t)})))}_preloadTiles(e){const r=this.style?this.style.getSourceCaches():[];return t.dv(r,((t,r)=>t._preloadTiles(e,r)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(t){this._trackResize&&this.resize({originalEvent:t})._update()}_onVisibilityChange(){"hidden"===document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(t){this._showParseStatus!==t&&(this._showParseStatus=t,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(t){this._showTerrainWireframe!==t&&(this._showTerrainWireframe=t,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(t){this._showLayers2DWireframe!==t&&(this._showLayers2DWireframe=t,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(t){this._showLayers3DWireframe!==t&&(this._showLayers3DWireframe=t,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(t){this._speedIndexTiming!==t&&(this._speedIndexTiming=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,this._tp.refreshUI(),t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(t){this._showTileAABBs!==t&&(this._showTileAABBs=t,this._tp.refreshUI(),t&&this._update())}_setCacheLimits(e,r){t.dx(e,r)}get version(){return t.dw}},NavigationControl:class{constructor(e={}){this.options=t.Q({},Us,e),this._container=n("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(t.br(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(t=>{this._map&&this._map.zoomIn({},{originalEvent:t})})),n("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(t=>{this._map&&this._map.zoomOut({},{originalEvent:t})})),n("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(t.br(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(t=>{const e=this._map;e&&(this.options.visualizePitch?e.resetNorthPitch({},{originalEvent:t}):e.resetNorth({},{originalEvent:t}))})),this._compassIcon=n("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const t=this._map;if(!t)return;const e=t.getZoom(),r=e===t.getMaxZoom(),i=e===t.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString())}_rotateCompassArrow(){const t=this._map;if(!t)return;const e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(t.transform.pitch*(Math.PI/180)),.5)}) rotateX(${t.transform.pitch}deg) rotateZ(${t.transform.angle*(180/Math.PI)}deg)`:`rotate(${t.transform.angle*(180/Math.PI)}deg)`;t._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=e)}))}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),t.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&t.on("pitch",this._rotateCompassArrow),t.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new $s(t,this._compass,this.options.visualizePitch)),this._container}onRemove(){const t=this._map;t&&(this._container.remove(),this.options.showZoom&&t.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&t.off("pitch",this._rotateCompassArrow),t.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(t,e){const r=n("button",t,this._container);return r.type="button",r.addEventListener("click",e),r}_setButtonTitle(t,e){if(!this._map)return;const r=this._map._getUIString(`NavigationControl.${e}`);t.setAttribute("aria-label",r),t.firstElementChild&&t.firstElementChild.setAttribute("title",r)}},GeolocateControl:class extends t.E{constructor(e={}){super();const r=navigator.geolocation;this.options=t.Q({geolocation:r},Gs,e),t.br(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Mo(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(t){return this._map=t,this._container=n("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(t){const e=(e=!!this.options.geolocation)=>{this._supportsGeolocation=e,t(e)};void 0!==this._supportsGeolocation?t(this._supportsGeolocation):void 0!==navigator.permissions?navigator.permissions.query({name:"geolocation"}).then((t=>e("denied"!==t.state))).catch((()=>e())):e()}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),r=t.coords;return!!e&&(r.longitude<e.getWest()||r.longitude>e.getEast()||r.latitude<e.getSouth()||r.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.g("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new t.g("geolocate",e)),this._finish()}}_updateCamera(e){const r=new t.aJ(e.coords.longitude,e.coords.latitude),i=e.coords.accuracy,n=this._map.getBearing(),o=t.Q({bearing:n},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(i),o,{geolocateSource:!0})}_updateMarker(e){if(e){const r=new t.aJ(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const e=this._map.transform,r=t.ay(1,e._center.lat)*e.worldSize,i=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${i}px`,this._circleElement.style.height=`${i}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new t.g("error",e)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(e){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=n("button","mapboxgl-ctrl-geolocate",this._container),n("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===e){t.w("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n("div","mapboxgl-user-location"),this._dotElement.appendChild(n("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(n("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ds({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=n("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ds({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(e=>{e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new t.g("trackuserlocationend")))}))}}_onDeviceOrientation(t){this._userLocationDotMarker&&(t.webkitCompassHeading?this._heading=t.webkitCompassHeading:!0===t.absolute&&(this._heading=-1*t.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return t.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.g("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.g("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.g("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let t;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(t={maximumAge:6e5,timeout:0},this._noTimeout=!0):(t=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,t),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const t=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};"undefined"!=typeof DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((e=>{"granted"===e&&t()})).catch(console.error):t()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ms,ScaleControl:class{constructor(e={}){this.options=t.Q({},Hs,e),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch(t){return!1}}(),t.br(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const t=this.options.maxWidth||100,e=this._map,r=e._containerHeight/2,i=e._containerWidth/2-t/2,n=e.unproject([i,r]),o=e.unproject([i+t,r]),s=n.distanceTo(o);if("imperial"===this.options.unit){const e=3.2808*s;e>5280?this._setScale(t,e/5280,"mile"):this._setScale(t,e,"foot")}else"nautical"===this.options.unit?this._setScale(t,s/1852,"nautical-mile"):s>=1e3?this._setScale(t,s/1e3,"kilometer"):this._setScale(t,s,"meter")}_setScale(t,e,r){this._map._requestDomTask((()=>{const i=function(t){const e=Math.pow(10,`${Math.floor(t)}`.length-1);let r=t/e;return r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:r>=1?1:function(t){const e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(r),e*r}(e),n=i/e;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==r?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:r}).format(i):`${i}&nbsp;${qs[r]}`,this._container.style.width=t*n+"px"}))}onAdd(t){return this._map=t,this._language=t.getLanguage(),this._container=n("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(t){this._language=t,this._update()}setUnit(t){this.options.unit=t,this._update()}},FullscreenControl:class{constructor(e={}){this._fullscreen=!1,e&&e.container&&(e.container instanceof HTMLElement?this._container=e.container:t.w("Full screen control 'container' must be a DOM element.")),t.br(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=n("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const t=this._fullscreenButton=n("button","mapboxgl-ctrl-fullscreen",this._controlContainer);n("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",t)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends t.E{constructor(e){super(),this.options=t.Q(Object.create(Rs),e),t.br(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(e&&e.className?e.className.trim().split(/\s+/):[])}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&e.on("preclick",this._onClose),this.options.closeOnMove&&e.on("move",this._onClose),e.on("remove",this.remove),this._update(),e._addPopup(this),this._focusFirstElement(),this._trackPointer?(e.on("mousemove",this._onMouseEvent),e.on("mouseup",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")):e.on("move",this._update),this.fire(new t.g("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const e=this._map;return e&&(e.off("move",this._update),e.off("move",this._onClose),e.off("preclick",this._onClose),e.off("click",this._onClose),e.off("remove",this.remove),e.off("mousemove",this._onMouseEvent),e.off("mouseup",this._onMouseEvent),e.off("drag",this._onMouseEvent),e._canvasContainer&&e._canvasContainer.classList.remove("mapboxgl-track-pointer"),e._removePopup(this),this._map=void 0),this.fire(new t.g("close")),this}getLngLat(){return this._lngLat}setLngLat(e){this._lngLat=t.aJ.convert(e),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const t=this._map;return t&&(t.off("move",this._update),t.on("mousemove",this._onMouseEvent),t.on("drag",this._onMouseEvent),t._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(t){return this.setDOMContent(document.createTextNode(t))}setHTML(t){const e=document.createDocumentFragment(),r=document.createElement("body");let i;for(r.innerHTML=t;i=r.firstChild,i;)e.appendChild(i);return this.setDOMContent(e)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){let e=this._content;if(e)for(;e.hasChildNodes();)e.firstChild&&e.removeChild(e.firstChild);else e=this._content=n("div","mapboxgl-popup-content",this._container||void 0);if(e.appendChild(t),this.options.closeButton){const t=this._closeButton=n("button","mapboxgl-popup-close-button",e);t.type="button",t.setAttribute("aria-label","Close popup"),t.setAttribute("aria-hidden","true"),t.innerHTML="&#215;",t.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(t){return this._classList.add(t),this._updateClassList(),this}removeClassName(t){return this._classList.delete(t),this._updateClassList(),this}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){let e;return this._classList.delete(t)?e=!1:(this._classList.add(t),e=!0),this._updateClassList(),e}_onMouseEvent(t){this._update(t.point)}_getAnchor(t){if(this.options.anchor)return this.options.anchor;const e=this._map,r=this._container,i=this._pos;if(!e||!r||!i)return"bottom";const n=r.offsetWidth,o=r.offsetHeight,s=i.x<n/2,a=i.x>e.transform.width-n/2;if(i.y+t<o)return s?"top-left":a?"top-right":"top";if(i.y>e.transform.height-o){if(s)return"bottom-left";if(a)return"bottom-right"}return s?"left":a?"right":"bottom"}_updateClassList(){const t=this._container;if(!t)return;const e=[...this._classList];e.push("mapboxgl-popup"),this._anchor&&e.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&e.push("mapboxgl-popup-track-pointer"),t.className=e.join(" ")}_update(e){const r=this._map,i=this._content;if(!r||!this._lngLat&&!this._trackPointer||!i)return;let o=this._container;if(o||(o=this._container=n("div","mapboxgl-popup",r.getContainer()),this._tip=n("div","mapboxgl-popup-tip",o),o.appendChild(i)),this.options.maxWidth&&o.style.maxWidth!==this.options.maxWidth&&(o.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Os(this._lngLat,this._pos,r.transform)),!this._trackPointer||e){const i=this._pos=this._trackPointer&&e instanceof t.P?e:r.project(this._lngLat),n=Bs(this.options.offset),o=this._anchor=this._getAnchor(n.y),s=Bs(this.options.offset,o),a=i.add(s).round();r._requestDomTask((()=>{this._container&&o&&(this._container.style.transform=`${Ls[o]} translate(${a.x}px,${a.y}px)`)}))}if(!this._marker&&r._showingGlobe()){const e=t.dc(r.transform,this._lngLat)?0:1;this._setOpacity(e)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(Fs);t&&t.focus()}_onClose(){this.remove()}_setOpacity(t){this._container&&(this._container.style.opacity=`${t}`),this._content&&(this._content.style.pointerEvents=t?"auto":"none")}},Marker:Ds,Style:Ao,LngLat:t.aJ,LngLatBounds:t.aj,Point:t.P,MercatorCoordinate:t._,FreeCameraOptions:$e,Evented:t.E,config:t.db,prewarm:t.dA,clearPrewarmedResources:t.dB,get accessToken(){return t.db.ACCESS_TOKEN},set accessToken(e){t.db.ACCESS_TOKEN=e},get baseApiUrl(){return t.db.API_URL},set baseApiUrl(e){t.db.API_URL=e},get workerCount(){return t.dC.workerCount},set workerCount(e){t.dC.workerCount=e},get maxParallelImageRequests(){return t.db.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.db.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage(e){t.dD(e)},get workerUrl(){return t.dE.workerUrl},set workerUrl(e){t.dE.workerUrl=e},get workerClass(){return t.dE.workerClass},set workerClass(e){t.dE.workerClass=e},get workerParams(){return t.dE.workerParams},set workerParams(e){t.dE.workerParams=e},get dracoUrl(){return t.dF()},set dracoUrl(e){t.dG(e)},get meshoptUrl(){return t.dH()},set meshoptUrl(e){t.dI(e)},setNow:t.e.setNow,restoreNow:t.e.restoreNow};return Ws})),r}()},624:function(t,e,r){var i,n,o;o=this,i=[r(4692)],n=function(t){return function(t,e){"use strict";var r,i,n,o="remodal",s=t.REMODAL_GLOBALS&&t.REMODAL_GLOBALS.NAMESPACE||o,a=e.map(["animationstart","webkitAnimationStart","MSAnimationStart","oAnimationStart"],(function(t){return t+"."+s})).join(" "),l=e.map(["animationend","webkitAnimationEnd","MSAnimationEnd","oAnimationEnd"],(function(t){return t+"."+s})).join(" "),c=e.extend({hashTracking:!0,closeOnConfirm:!0,closeOnCancel:!0,closeOnEscape:!0,closeOnOutsideClick:!0,modifier:"",appendTo:null},t.REMODAL_GLOBALS&&t.REMODAL_GLOBALS.DEFAULTS),u={CLOSING:"closing",CLOSED:"closed",OPENING:"opening",OPENED:"opened"},h={CONFIRMATION:"confirmation",CANCELLATION:"cancellation"},d=void 0!==(n=document.createElement("div").style).animationName||void 0!==n.WebkitAnimationName||void 0!==n.MozAnimationName||void 0!==n.msAnimationName||void 0!==n.OAnimationName,p=/iPad|iPhone|iPod/.test(navigator.platform);function f(t){if(d&&"none"===t.css("animation-name")&&"none"===t.css("-webkit-animation-name")&&"none"===t.css("-moz-animation-name")&&"none"===t.css("-o-animation-name")&&"none"===t.css("-ms-animation-name"))return 0;var e,r,i,n,o=t.css("animation-duration")||t.css("-webkit-animation-duration")||t.css("-moz-animation-duration")||t.css("-o-animation-duration")||t.css("-ms-animation-duration")||"0s",s=t.css("animation-delay")||t.css("-webkit-animation-delay")||t.css("-moz-animation-delay")||t.css("-o-animation-delay")||t.css("-ms-animation-delay")||"0s",a=t.css("animation-iteration-count")||t.css("-webkit-animation-iteration-count")||t.css("-moz-animation-iteration-count")||t.css("-o-animation-iteration-count")||t.css("-ms-animation-iteration-count")||"1";for(o=o.split(", "),s=s.split(", "),a=a.split(", "),n=0,r=o.length,e=Number.NEGATIVE_INFINITY;n<r;n++)(i=parseFloat(o[n])*parseInt(a[n],10)+parseFloat(s[n]))>e&&(e=i);return e}function m(){if(e(document).height()<=e(window).height())return 0;var t,r,i=document.createElement("div"),n=document.createElement("div");return i.style.visibility="hidden",i.style.width="100px",document.body.appendChild(i),t=i.offsetWidth,i.style.overflow="scroll",n.style.width="100%",i.appendChild(n),r=n.offsetWidth,i.parentNode.removeChild(i),t-r}function g(){if(!p){var t,r,i=e("html"),n=w("is-locked");i.hasClass(n)||(r=e(document.body),t=parseInt(r.css("padding-right"),10)+m(),r.css("padding-right",t+"px"),i.addClass(n))}}function y(){if(!p){var t,r,i=e("html"),n=w("is-locked");i.hasClass(n)&&(r=e(document.body),t=parseInt(r.css("padding-right"),10)-m(),r.css("padding-right",t+"px"),i.removeClass(n))}}function v(t,e,r,i){var n=w("is",e),o=[w("is",u.CLOSING),w("is",u.OPENING),w("is",u.CLOSED),w("is",u.OPENED)].join(" ");t.$bg.removeClass(o).addClass(n),t.$overlay.removeClass(o).addClass(n),t.$wrapper.removeClass(o).addClass(n),t.$modal.removeClass(o).addClass(n),t.state=e,!r&&t.$modal.trigger({type:e,reason:i},[{reason:i}])}function _(t,r,i){var n=0,o=function(t){t.target===this&&n++},s=function(t){t.target===this&&0==--n&&(e.each(["$bg","$overlay","$wrapper","$modal"],(function(t,e){i[e].off(a+" "+l)})),r())};e.each(["$bg","$overlay","$wrapper","$modal"],(function(t,e){i[e].on(a,o).on(l,s)})),t(),0===f(i.$bg)&&0===f(i.$overlay)&&0===f(i.$wrapper)&&0===f(i.$modal)&&(e.each(["$bg","$overlay","$wrapper","$modal"],(function(t,e){i[e].off(a+" "+l)})),r())}function b(t){t.state!==u.CLOSED&&(e.each(["$bg","$overlay","$wrapper","$modal"],(function(e,r){t[r].off(a+" "+l)})),t.$bg.removeClass(t.settings.modifier),t.$overlay.removeClass(t.settings.modifier).hide(),t.$wrapper.hide(),y(),v(t,u.CLOSED,!0))}function x(t){var e,r,i,n,o={};for(n=0,r=(e=(t=t.replace(/\s*:\s*/g,":").replace(/\s*,\s*/g,",")).split(",")).length;n<r;n++)e[n]=e[n].split(":"),("string"==typeof(i=e[n][1])||i instanceof String)&&(i="true"===i||"false"!==i&&i),("string"==typeof i||i instanceof String)&&(i=isNaN(i)?i:+i),o[e[n][0]]=i;return o}function w(){for(var t=s,e=0;e<arguments.length;++e)t+="-"+arguments[e];return t}function T(){var t,i,n=location.hash.replace("#","");if(n){try{i=e("[data-"+o+'-id="'+n+'"]')}catch(t){}i&&i.length&&(t=e[o].lookup[i.data(o)])&&t.settings.hashTracking&&t.open()}else r&&r.state===u.OPENED&&r.settings.hashTracking&&r.close()}function E(t,r){var i=e(document.body),n=this;n.settings=e.extend({},c,r),n.index=e[o].lookup.push(n)-1,n.state=u.CLOSED,n.$overlay=e("."+w("overlay")),null!==n.settings.appendTo&&n.settings.appendTo.length&&(i=e(n.settings.appendTo)),n.$overlay.length||(n.$overlay=e("<div>").addClass(w("overlay")+" "+w("is",u.CLOSED)).hide(),i.append(n.$overlay)),n.$bg=e("."+w("bg")).addClass(w("is",u.CLOSED)),n.$modal=t.addClass(s+" "+w("is-initialized")+" "+n.settings.modifier+" "+w("is",u.CLOSED)).attr("tabindex","-1"),n.$wrapper=e("<div>").addClass(w("wrapper")+" "+n.settings.modifier+" "+w("is",u.CLOSED)).hide().append(n.$modal),i.append(n.$wrapper),n.$wrapper.on("click."+s,"[data-"+o+'-action="close"]',(function(t){t.preventDefault(),n.close()})),n.$wrapper.on("click."+s,"[data-"+o+'-action="cancel"]',(function(t){t.preventDefault(),n.$modal.trigger(h.CANCELLATION),n.settings.closeOnCancel&&n.close(h.CANCELLATION)})),n.$wrapper.on("click."+s,"[data-"+o+'-action="confirm"]',(function(t){t.preventDefault(),n.$modal.trigger(h.CONFIRMATION),n.settings.closeOnConfirm&&n.close(h.CONFIRMATION)})),n.$wrapper.on("click."+s,(function(t){e(t.target).hasClass(w("wrapper"))&&n.settings.closeOnOutsideClick&&n.close()}))}E.prototype.open=function(){var t,n=this;n.state!==u.OPENING&&n.state!==u.CLOSING&&((t=n.$modal.attr("data-"+o+"-id"))&&n.settings.hashTracking&&(i=e(window).scrollTop(),location.hash=t),r&&r!==n&&b(r),r=n,g(),n.$bg.addClass(n.settings.modifier),n.$overlay.addClass(n.settings.modifier).show(),n.$wrapper.show().scrollTop(0),n.$modal.focus(),_((function(){v(n,u.OPENING)}),(function(){v(n,u.OPENED)}),n))},E.prototype.close=function(t){var r=this;r.state!==u.OPENING&&r.state!==u.CLOSING&&r.state!==u.CLOSED&&(r.settings.hashTracking&&r.$modal.attr("data-"+o+"-id")===location.hash.substr(1)&&(location.hash="",e(window).scrollTop(i)),_((function(){v(r,u.CLOSING,!1,t)}),(function(){r.$bg.removeClass(r.settings.modifier),r.$overlay.removeClass(r.settings.modifier).hide(),r.$wrapper.hide(),y(),v(r,u.CLOSED,!1,t)}),r))},E.prototype.getState=function(){return this.state},E.prototype.destroy=function(){var t=e[o].lookup;b(this),this.$wrapper.remove(),delete t[this.index],0===e.grep(t,(function(t){return!!t})).length&&(this.$overlay.remove(),this.$bg.removeClass(w("is",u.CLOSING)+" "+w("is",u.OPENING)+" "+w("is",u.CLOSED)+" "+w("is",u.OPENED)))},e[o]={lookup:[]},e.fn[o]=function(t){var r,i;return this.each((function(n,s){null==(i=e(s)).data(o)?(r=new E(i,t),i.data(o,r.index),r.settings.hashTracking&&i.attr("data-"+o+"-id")===location.hash.substr(1)&&r.open()):r=e[o].lookup[i.data(o)]})),r},e(document).ready((function(){e(document).on("click","[data-"+o+"-target]",(function(t){t.preventDefault();var r=t.currentTarget.getAttribute("data-"+o+"-target"),i=e("[data-"+o+'-id="'+r+'"]');e[o].lookup[i.data(o)].open()})),e(document).find("."+s).each((function(t,r){var i=e(r),n=i.data(o+"-options");n?("string"==typeof n||n instanceof String)&&(n=x(n)):n={},i[o](n)})),e(document).on("keydown."+s,(function(t){r&&r.settings.closeOnEscape&&r.state===u.OPENED&&27===t.keyCode&&r.close()})),e(window).on("hashchange."+s,T)}))}(o,t)}.apply(e,i),void 0===n||(t.exports=n)},6377:(t,e,r)=>{var i,n;!function(o,s){i=[r(2475)],n=function(t){return function(t,e){"use strict";function r(){}var i=r.prototype=Object.create(e.prototype);i.bindHandles=function(){this._bindHandles(!0)},i.unbindHandles=function(){this._bindHandles(!1)},i._bindHandles=function(e){for(var r=(e=void 0===e||e)?"addEventListener":"removeEventListener",i=e?this._touchActionValue:"",n=0;n<this.handles.length;n++){var o=this.handles[n];this._bindStartEvent(o,e),o[r]("click",this),t.PointerEvent&&(o.style.touchAction=i)}},i._touchActionValue="none",i.pointerDown=function(t,e){this.okayPointerDown(t)&&(this.pointerDownPointer={pageX:e.pageX,pageY:e.pageY},t.preventDefault(),this.pointerDownBlur(),this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e]))};var n={TEXTAREA:!0,INPUT:!0,SELECT:!0,OPTION:!0},o={radio:!0,checkbox:!0,button:!0,submit:!0,image:!0,file:!0};return i.okayPointerDown=function(t){var e=n[t.target.nodeName],r=o[t.target.type],i=!e||r;return i||this._pointerReset(),i},i.pointerDownBlur=function(){var t=document.activeElement;t&&t.blur&&t!=document.body&&t.blur()},i.pointerMove=function(t,e){var r=this._dragPointerMove(t,e);this.emitEvent("pointerMove",[t,e,r]),this._dragMove(t,e,r)},i._dragPointerMove=function(t,e){var r={x:e.pageX-this.pointerDownPointer.pageX,y:e.pageY-this.pointerDownPointer.pageY};return!this.isDragging&&this.hasDragStarted(r)&&this._dragStart(t,e),r},i.hasDragStarted=function(t){return Math.abs(t.x)>3||Math.abs(t.y)>3},i.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e]),this._dragPointerUp(t,e)},i._dragPointerUp=function(t,e){this.isDragging?this._dragEnd(t,e):this._staticClick(t,e)},i._dragStart=function(t,e){this.isDragging=!0,this.isPreventingClicks=!0,this.dragStart(t,e)},i.dragStart=function(t,e){this.emitEvent("dragStart",[t,e])},i._dragMove=function(t,e,r){this.isDragging&&this.dragMove(t,e,r)},i.dragMove=function(t,e,r){t.preventDefault(),this.emitEvent("dragMove",[t,e,r])},i._dragEnd=function(t,e){this.isDragging=!1,setTimeout(function(){delete this.isPreventingClicks}.bind(this)),this.dragEnd(t,e)},i.dragEnd=function(t,e){this.emitEvent("dragEnd",[t,e])},i.onclick=function(t){this.isPreventingClicks&&t.preventDefault()},i._staticClick=function(t,e){this.isIgnoringMouseUp&&"mouseup"==t.type||(this.staticClick(t,e),"mouseup"!=t.type&&(this.isIgnoringMouseUp=!0,setTimeout(function(){delete this.isIgnoringMouseUp}.bind(this),400)))},i.staticClick=function(t,e){this.emitEvent("staticClick",[t,e])},r.getPointerPoint=e.getPointerPoint,r}(o,t)}.apply(e,i),void 0===n||(t.exports=n)}(window)},2475:(t,e,r)=>{var i,n;!function(o,s){i=[r(2137)],n=function(t){return function(t,e){"use strict";function r(){}function i(){}var n=i.prototype=Object.create(e.prototype);n.bindStartEvent=function(t){this._bindStartEvent(t,!0)},n.unbindStartEvent=function(t){this._bindStartEvent(t,!1)},n._bindStartEvent=function(e,r){var i=(r=void 0===r||r)?"addEventListener":"removeEventListener",n="mousedown";"ontouchstart"in t?n="touchstart":t.PointerEvent&&(n="pointerdown"),e[i](n,this)},n.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},n.getTouch=function(t){for(var e=0;e<t.length;e++){var r=t[e];if(r.identifier==this.pointerIdentifier)return r}},n.onmousedown=function(t){var e=t.button;e&&0!==e&&1!==e||this._pointerDown(t,t)},n.ontouchstart=function(t){this._pointerDown(t,t.changedTouches[0])},n.onpointerdown=function(t){this._pointerDown(t,t)},n._pointerDown=function(t,e){t.button||this.isPointerDown||(this.isPointerDown=!0,this.pointerIdentifier=void 0!==e.pointerId?e.pointerId:e.identifier,this.pointerDown(t,e))},n.pointerDown=function(t,e){this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e])};var o={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]};return n._bindPostStartEvents=function(e){if(e){var r=o[e.type];r.forEach((function(e){t.addEventListener(e,this)}),this),this._boundPointerEvents=r}},n._unbindPostStartEvents=function(){this._boundPointerEvents&&(this._boundPointerEvents.forEach((function(e){t.removeEventListener(e,this)}),this),delete this._boundPointerEvents)},n.onmousemove=function(t){this._pointerMove(t,t)},n.onpointermove=function(t){t.pointerId==this.pointerIdentifier&&this._pointerMove(t,t)},n.ontouchmove=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerMove(t,e)},n._pointerMove=function(t,e){this.pointerMove(t,e)},n.pointerMove=function(t,e){this.emitEvent("pointerMove",[t,e])},n.onmouseup=function(t){this._pointerUp(t,t)},n.onpointerup=function(t){t.pointerId==this.pointerIdentifier&&this._pointerUp(t,t)},n.ontouchend=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerUp(t,e)},n._pointerUp=function(t,e){this._pointerDone(),this.pointerUp(t,e)},n.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e])},n._pointerDone=function(){this._pointerReset(),this._unbindPostStartEvents(),this.pointerDone()},n._pointerReset=function(){this.isPointerDown=!1,delete this.pointerIdentifier},n.pointerDone=r,n.onpointercancel=function(t){t.pointerId==this.pointerIdentifier&&this._pointerCancel(t,t)},n.ontouchcancel=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerCancel(t,e)},n._pointerCancel=function(t,e){this._pointerDone(),this.pointerCancel(t,e)},n.pointerCancel=function(t,e){this.emitEvent("pointerCancel",[t,e])},i.getPointerPoint=function(t){return{x:t.pageX,y:t.pageY}},i}(o,t)}.apply(e,i),void 0===n||(t.exports=n)}(window)},2088:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});var i=r(2891),n=r(7237);n.$L&&n.t1.register(...n.$L);let o=!1;class s extends i.xI{constructor(){super(...arguments),this.chart=null}connect(){if(o||(o=!0,this.dispatchEvent("init",{Chart:n.t1})),!(this.element instanceof HTMLCanvasElement))throw new Error("Invalid element");const t=this.viewValue;Array.isArray(t.options)&&0===t.options.length&&(t.options={}),this.dispatchEvent("pre-connect",{options:t.options,config:t});const e=this.element.getContext("2d");if(!e)throw new Error("Could not getContext() from Element");this.chart=new n.t1(e,t),this.dispatchEvent("connect",{chart:this.chart})}viewValueChanged(){if(this.chart){const t={data:this.viewValue.data,options:this.viewValue.options};Array.isArray(t.options)&&0===t.options.length&&(t.options={}),this.dispatchEvent("view-value-change",t),this.chart.data=t.data,this.chart.options=t.options,this.chart.update();const e=this.element.parentElement;if(e&&this.chart.options.responsive){const t=e.style.width;e.style.width=`${e.offsetWidth+1}px`,setTimeout((()=>{e.style.width=t}),0)}}}dispatchEvent(t,e){this.dispatch(t,{detail:e,prefix:"chartjs"})}}s.values={view:Object}},7237:(t,e,r)=>{"use strict";r.d(e,{$L:()=>Zr,Bs:()=>me,E8:()=>Le,FN:()=>Pe,NT:()=>i.d,t1:()=>ae});var i=r(2998);var n=new class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,r,i){const n=e.listeners[i],o=e.duration;n.forEach((i=>i({chart:t,initial:e.initial,numSteps:o,currentStep:Math.min(r-e.start,o)})))}_refresh(){this._request||(this._running=!0,this._request=i.r.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(t=Date.now()){let e=0;this._charts.forEach(((r,i)=>{if(!r.running||!r.items.length)return;const n=r.items;let o,s=n.length-1,a=!1;for(;s>=0;--s)o=n[s],o._active?(o._total>r.duration&&(r.duration=o._total),o.tick(t),a=!0):(n[s]=n[n.length-1],n.pop());a&&(i.draw(),this._notify(i,r,t,"progress")),n.length||(r.running=!1,this._notify(i,r,t,"complete"),r.initial=!1),e+=n.length})),this._lastDate=t,0===e&&(this._running=!1)}_getAnims(t){const e=this._charts;let r=e.get(t);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,r)),r}listen(t,e,r){this._getAnims(t).listeners[e].push(r)}add(t,e){e&&e.length&&this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce(((t,e)=>Math.max(t,e._duration)),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!!(e&&e.running&&e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const r=e.items;let i=r.length-1;for(;i>=0;--i)r[i].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}};const o="transparent",s={boolean:(t,e,r)=>r>.5?e:t,color(t,e,r){const n=(0,i.c)(t||o),s=n.valid&&(0,i.c)(e||o);return s&&s.valid?s.mix(n,r).hexString():e},number:(t,e,r)=>t+(e-t)*r};class a{constructor(t,e,r,n){const o=e[r];n=(0,i.a)([t.to,n,o,t.from]);const a=(0,i.a)([t.from,o,n]);this._active=!0,this._fn=t.fn||s[t.type||typeof a],this._easing=i.e[t.easing]||i.e.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=r,this._from=a,this._to=n,this._promises=void 0}active(){return this._active}update(t,e,r){if(this._active){this._notify(!1);const n=this._target[this._prop],o=r-this._start,s=this._duration-o;this._start=r,this._duration=Math.floor(Math.max(s,t.duration)),this._total+=o,this._loop=!!t.loop,this._to=(0,i.a)([t.to,e,n,t.from]),this._from=(0,i.a)([t.from,n,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,r=this._duration,i=this._prop,n=this._from,o=this._loop,s=this._to;let a;if(this._active=n!==s&&(o||e<r),!this._active)return this._target[i]=s,void this._notify(!0);e<0?this._target[i]=n:(a=e/r%2,a=o&&a>1?2-a:a,a=this._easing(Math.min(1,Math.max(0,a))),this._target[i]=this._fn(n,s,a))}wait(){const t=this._promises||(this._promises=[]);return new Promise(((e,r)=>{t.push({res:e,rej:r})}))}_notify(t){const e=t?"res":"rej",r=this._promises||[];for(let t=0;t<r.length;t++)r[t][e]()}}i.d.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const l=Object.keys(i.d.animation);i.d.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>"onProgress"!==t&&"onComplete"!==t&&"fn"!==t}),i.d.set("animations",{colors:{type:"color",properties:["color","borderColor","backgroundColor"]},numbers:{type:"number",properties:["x","y","borderWidth","radius","tension"]}}),i.d.describe("animations",{_fallback:"animation"}),i.d.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>0|t}}}});class c{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!(0,i.i)(t))return;const e=this._properties;Object.getOwnPropertyNames(t).forEach((r=>{const n=t[r];if(!(0,i.i)(n))return;const o={};for(const t of l)o[t]=n[t];((0,i.b)(n.properties)&&n.properties||[r]).forEach((t=>{t!==r&&e.has(t)||e.set(t,o)}))}))}_animateOptions(t,e){const r=e.options,i=function(t,e){if(!e)return;let r=t.options;if(!r)return void(t.options=e);r.$shared&&(t.options=r=Object.assign({},r,{$shared:!1,$animations:{}}));return r}(t,r);if(!i)return[];const n=this._createAnimations(i,r);return r.$shared&&function(t,e){const r=[],i=Object.keys(e);for(let e=0;e<i.length;e++){const n=t[i[e]];n&&n.active()&&r.push(n.wait())}return Promise.all(r)}(t.options.$animations,r).then((()=>{t.options=r}),(()=>{})),n}_createAnimations(t,e){const r=this._properties,i=[],n=t.$animations||(t.$animations={}),o=Object.keys(e),s=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if("$"===c.charAt(0))continue;if("options"===c){i.push(...this._animateOptions(t,e));continue}const u=e[c];let h=n[c];const d=r.get(c);if(h){if(d&&h.active()){h.update(d,u,s);continue}h.cancel()}d&&d.duration?(n[c]=h=new a(d,t,c,u),i.push(h)):t[c]=u}return i}update(t,e){if(0===this._properties.size)return void Object.assign(t,e);const r=this._createAnimations(t,e);return r.length?(n.add(this._chart,r),!0):void 0}}function u(t,e){const r=t&&t.options||{},i=r.reverse,n=void 0===r.min?e:0,o=void 0===r.max?e:0;return{start:i?o:n,end:i?n:o}}function h(t,e){const r=[],i=t._getSortedDatasetMetas(e);let n,o;for(n=0,o=i.length;n<o;++n)r.push(i[n].index);return r}function d(t,e,r,n={}){const o=t.keys,s="single"===n.mode;let a,l,c,u;if(null!==e){for(a=0,l=o.length;a<l;++a){if(c=+o[a],c===r){if(n.all)continue;break}u=t.values[c],(0,i.g)(u)&&(s||0===e||(0,i.s)(e)===(0,i.s)(u))&&(e+=u)}return e}}function p(t,e){const r=t&&t.options.stacked;return r||void 0===r&&void 0!==e.stack}function f(t,e,r){const i=t[e]||(t[e]={});return i[r]||(i[r]={})}function m(t,e,r,i){for(const n of e.getMatchingVisibleMetas(i).reverse()){const e=t[n.index];if(r&&e>0||!r&&e<0)return n.index}return null}function g(t,e){const{chart:r,_cachedMeta:i}=t,n=r._stacks||(r._stacks={}),{iScale:o,vScale:s,index:a}=i,l=o.axis,c=s.axis,u=function(t,e,r){return`${t.id}.${e.id}.${r.stack||r.type}`}(o,s,i),h=e.length;let d;for(let t=0;t<h;++t){const r=e[t],{[l]:o,[c]:h}=r;d=(r._stacks||(r._stacks={}))[c]=f(n,u,o),d[a]=h,d._top=m(d,s,!0,i.type),d._bottom=m(d,s,!1,i.type)}}function y(t,e){const r=t.scales;return Object.keys(r).filter((t=>r[t].axis===e)).shift()}function v(t,e){const r=t.controller.index,i=t.vScale&&t.vScale.axis;if(i){e=e||t._parsed;for(const t of e){const e=t._stacks;if(!e||void 0===e[i]||void 0===e[i][r])return;delete e[i][r]}}}const _=t=>"reset"===t||"none"===t,b=(t,e)=>e?t:Object.assign({},t);class x{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=p(t.vScale,t),this.addElements()}updateIndex(t){this.index!==t&&v(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,r=this.getDataset(),n=(t,e,r,i)=>"x"===t?e:"r"===t?i:r,o=e.xAxisID=(0,i.v)(r.xAxisID,y(t,"x")),s=e.yAxisID=(0,i.v)(r.yAxisID,y(t,"y")),a=e.rAxisID=(0,i.v)(r.rAxisID,y(t,"r")),l=e.indexAxis,c=e.iAxisID=n(l,o,s,a),u=e.vAxisID=n(l,s,o,a);e.xScale=this.getScaleForId(o),e.yScale=this.getScaleForId(s),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(c),e.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&(0,i.u)(this._data,this),t._stacked&&v(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),r=this._data;if((0,i.i)(e))this._data=function(t){const e=Object.keys(t),r=new Array(e.length);let i,n,o;for(i=0,n=e.length;i<n;++i)o=e[i],r[i]={x:o,y:t[o]};return r}(e);else if(r!==e){if(r){(0,i.u)(r,this);const t=this._cachedMeta;v(t),t._parsed=[]}e&&Object.isExtensible(e)&&(0,i.l)(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,r=this.getDataset();let i=!1;this._dataCheck();const n=e._stacked;e._stacked=p(e.vScale,e),e.stack!==r.stack&&(i=!0,v(e),e.stack=r.stack),this._resyncElements(t),(i||n!==e._stacked)&&g(this,e._parsed)}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),r=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:r,_data:n}=this,{iScale:o,_stacked:s}=r,a=o.axis;let l,c,u,h=0===t&&e===n.length||r._sorted,d=t>0&&r._parsed[t-1];if(!1===this._parsing)r._parsed=n,r._sorted=!0,u=n;else{u=(0,i.b)(n[t])?this.parseArrayData(r,n,t,e):(0,i.i)(n[t])?this.parseObjectData(r,n,t,e):this.parsePrimitiveData(r,n,t,e);const o=()=>null===c[a]||d&&c[a]<d[a];for(l=0;l<e;++l)r._parsed[l+t]=c=u[l],h&&(o()&&(h=!1),d=c);r._sorted=h}s&&g(this,u)}parsePrimitiveData(t,e,r,i){const{iScale:n,vScale:o}=t,s=n.axis,a=o.axis,l=n.getLabels(),c=n===o,u=new Array(i);let h,d,p;for(h=0,d=i;h<d;++h)p=h+r,u[h]={[s]:c||n.parse(l[p],p),[a]:o.parse(e[p],p)};return u}parseArrayData(t,e,r,i){const{xScale:n,yScale:o}=t,s=new Array(i);let a,l,c,u;for(a=0,l=i;a<l;++a)c=a+r,u=e[c],s[a]={x:n.parse(u[0],c),y:o.parse(u[1],c)};return s}parseObjectData(t,e,r,n){const{xScale:o,yScale:s}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(n);let u,h,d,p;for(u=0,h=n;u<h;++u)d=u+r,p=e[d],c[u]={x:o.parse((0,i.f)(p,a),d),y:s.parse((0,i.f)(p,l),d)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,r){const i=this.chart,n=this._cachedMeta,o=e[t.axis];return d({keys:h(i,!0),values:e._stacks[t.axis]},o,n.index,{mode:r})}updateRangeFromParsed(t,e,r,i){const n=r[e.axis];let o=null===n?NaN:n;const s=i&&r._stacks[e.axis];i&&s&&(i.values=s,o=d(i,n,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,e){const r=this._cachedMeta,n=r._parsed,o=r._sorted&&t===r.iScale,s=n.length,a=this._getOtherScale(t),l=((t,e,r)=>t&&!e.hidden&&e._stacked&&{keys:h(r,!0),values:null})(e,r,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:d}=function(t){const{min:e,max:r,minDefined:i,maxDefined:n}=t.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:n?r:Number.POSITIVE_INFINITY}}(a);let p,f;function m(){f=n[p];const e=f[a.axis];return!(0,i.g)(f[t.axis])||u>e||d<e}for(p=0;p<s&&(m()||(this.updateRangeFromParsed(c,t,f,l),!o));++p);if(o)for(p=s-1;p>=0;--p)if(!m()){this.updateRangeFromParsed(c,t,f,l);break}return c}getAllParsedValues(t){const e=this._cachedMeta._parsed,r=[];let n,o,s;for(n=0,o=e.length;n<o;++n)s=e[n][t.axis],(0,i.g)(s)&&r.push(s);return r}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,r=e.iScale,i=e.vScale,n=this.getParsed(t);return{label:r?""+r.getLabelForValue(n[r.axis]):"",value:i?""+i.getLabelForValue(n[i.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=function(t){let e,r,n,o;return(0,i.i)(t)?(e=t.top,r=t.right,n=t.bottom,o=t.left):e=r=n=o=t,{top:e,right:r,bottom:n,left:o,disabled:!1===t}}((0,i.v)(this.options.clip,function(t,e,r){if(!1===r)return!1;const i=u(t,r),n=u(e,r);return{top:n.end,right:i.end,bottom:n.start,left:i.start}}(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,r=this._cachedMeta,i=r.data||[],n=e.chartArea,o=[],s=this._drawStart||0,a=this._drawCount||i.length-s,l=this.options.drawActiveElementsOnTop;let c;for(r.dataset&&r.dataset.draw(t,n,s,a),c=s;c<s+a;++c){const e=i[c];e.hidden||(e.active&&l?o.push(e):e.draw(t,n))}for(c=0;c<o.length;++c)o[c].draw(t,n)}getStyle(t,e){const r=e?"active":"default";return void 0===t&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(t||0,r)}getContext(t,e,r){const n=this.getDataset();let o;if(t>=0&&t<this._cachedMeta.data.length){const e=this._cachedMeta.data[t];o=e.$context||(e.$context=function(t,e,r){return(0,i.h)(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:r,index:e,mode:"default",type:"data"})}(this.getContext(),t,e)),o.parsed=this.getParsed(t),o.raw=n.data[t],o.index=o.dataIndex=t}else o=this.$context||(this.$context=function(t,e){return(0,i.h)(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),o.dataset=n,o.index=o.datasetIndex=this.index;return o.active=!!e,o.mode=r,o}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",r){const n="active"===e,o=this._cachedDataOpts,s=t+"-"+e,a=o[s],l=this.enableOptionSharing&&(0,i.j)(r);if(a)return b(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,t),h=n?[`${t}Hover`,"hover",t,""]:[t,""],d=c.getOptionScopes(this.getDataset(),u),p=Object.keys(i.d.elements[t]),f=c.resolveNamedOptions(d,p,(()=>this.getContext(r,n)),h);return f.$shared&&(f.$shared=l,o[s]=Object.freeze(b(f,l))),f}_resolveAnimations(t,e,r){const i=this.chart,n=this._cachedDataOpts,o=`animation-${e}`,s=n[o];if(s)return s;let a;if(!1!==i.options.animation){const i=this.chart.config,n=i.datasetAnimationScopeKeys(this._type,e),o=i.getOptionScopes(this.getDataset(),n);a=i.createResolver(o,this.getContext(t,r,e))}const l=new c(i,a&&a.animations);return a&&a._cacheable&&(n[o]=Object.freeze(l)),l}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||_(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const r=this.resolveDataElementOptions(t,e),i=this._sharedOptions,n=this.getSharedOptions(r),o=this.includeOptions(e,n)||n!==i;return this.updateSharedOptions(n,e,r),{sharedOptions:n,includeOptions:o}}updateElement(t,e,r,i){_(i)?Object.assign(t,r):this._resolveAnimations(e,i).update(t,r)}updateSharedOptions(t,e,r){t&&!_(e)&&this._resolveAnimations(void 0,e).update(t,r)}_setStyle(t,e,r,i){t.active=i;const n=this.getStyle(e,i);this._resolveAnimations(e,r,i).update(t,{options:!i&&this.getSharedOptions(n)||n})}removeHoverStyle(t,e,r){this._setStyle(t,r,"active",!1)}setHoverStyle(t,e,r){this._setStyle(t,r,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,r=this._cachedMeta.data;for(const[t,e,r]of this._syncList)this[t](e,r);this._syncList=[];const i=r.length,n=e.length,o=Math.min(n,i);o&&this.parse(0,o),n>i?this._insertElements(i,n-i,t):n<i&&this._removeElements(n,i-n)}_insertElements(t,e,r=!0){const i=this._cachedMeta,n=i.data,o=t+e;let s;const a=t=>{for(t.length+=e,s=t.length-1;s>=o;s--)t[s]=t[s-e]};for(a(n),s=t;s<o;++s)n[s]=new this.dataElementType;this._parsing&&a(i._parsed),this.parse(t,e),r&&this.updateElements(n,t,e,"reset")}updateElements(t,e,r,i){}_removeElements(t,e){const r=this._cachedMeta;if(this._parsing){const i=r._parsed.splice(t,e);r._stacked&&v(r,i)}r.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,r,i]=t;this[e](r,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const r=arguments.length-2;r&&this._sync(["_insertElements",t,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function w(t){const e=t.iScale,r=function(t,e){if(!t._cache.$bar){const r=t.getMatchingVisibleMetas(e);let n=[];for(let e=0,i=r.length;e<i;e++)n=n.concat(r[e].controller.getAllParsedValues(t));t._cache.$bar=(0,i._)(n.sort(((t,e)=>t-e)))}return t._cache.$bar}(e,t.type);let n,o,s,a,l=e._length;const c=()=>{32767!==s&&-32768!==s&&((0,i.j)(a)&&(l=Math.min(l,Math.abs(s-a)||l)),a=s)};for(n=0,o=r.length;n<o;++n)s=e.getPixelForValue(r[n]),c();for(a=void 0,n=0,o=e.ticks.length;n<o;++n)s=e.getPixelForTick(n),c();return l}function T(t,e,r,n){return(0,i.b)(t)?function(t,e,r,i){const n=r.parse(t[0],i),o=r.parse(t[1],i),s=Math.min(n,o),a=Math.max(n,o);let l=s,c=a;Math.abs(s)>Math.abs(a)&&(l=a,c=s),e[r.axis]=c,e._custom={barStart:l,barEnd:c,start:n,end:o,min:s,max:a}}(t,e,r,n):e[r.axis]=r.parse(t,n),e}function E(t,e,r,i){const n=t.iScale,o=t.vScale,s=n.getLabels(),a=n===o,l=[];let c,u,h,d;for(c=r,u=r+i;c<u;++c)d=e[c],h={},h[n.axis]=a||n.parse(s[c],c),l.push(T(d,h,o,c));return l}function S(t){return t&&void 0!==t.barStart&&void 0!==t.barEnd}function P(t,e,r,i){let n=e.borderSkipped;const o={};if(!n)return void(t.borderSkipped=o);if(!0===n)return void(t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:s,end:a,reverse:l,top:c,bottom:u}=function(t){let e,r,i,n,o;return t.horizontal?(e=t.base>t.x,r="left",i="right"):(e=t.base<t.y,r="bottom",i="top"),e?(n="end",o="start"):(n="start",o="end"),{start:r,end:i,reverse:e,top:n,bottom:o}}(t);"middle"===n&&r&&(t.enableBorderRadius=!0,(r._top||0)===i?n=c:(r._bottom||0)===i?n=u:(o[k(u,s,a,l)]=!0,n=c)),o[k(n,s,a,l)]=!0,t.borderSkipped=o}function k(t,e,r,i){var n,o,s;return i?(s=r,t=A(t=(n=t)===(o=e)?s:n===s?o:n,r,e)):t=A(t,e,r),t}function A(t,e,r){return"start"===t?e:"end"===t?r:t}function M(t,{inflateAmount:e},r){t.inflateAmount="auto"===e?1===r?.33:0:e}x.defaults={},x.prototype.datasetElementType=null,x.prototype.dataElementType=null;class C extends x{parsePrimitiveData(t,e,r,i){return E(t,e,r,i)}parseArrayData(t,e,r,i){return E(t,e,r,i)}parseObjectData(t,e,r,n){const{iScale:o,vScale:s}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c="x"===o.axis?a:l,u="x"===s.axis?a:l,h=[];let d,p,f,m;for(d=r,p=r+n;d<p;++d)m=e[d],f={},f[o.axis]=o.parse((0,i.f)(m,c),d),h.push(T((0,i.f)(m,u),f,s,d));return h}updateRangeFromParsed(t,e,r,i){super.updateRangeFromParsed(t,e,r,i);const n=r._custom;n&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,n.min),t.max=Math.max(t.max,n.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:r,vScale:i}=e,n=this.getParsed(t),o=n._custom,s=S(o)?"["+o.start+", "+o.end+"]":""+i.getLabelForValue(n[i.axis]);return{label:""+r.getLabelForValue(n[r.axis]),value:s}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,r,n){const o="reset"===n,{index:s,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),u=this._getRuler(),{sharedOptions:h,includeOptions:d}=this._getSharedOptions(e,n);for(let p=e;p<e+r;p++){const e=this.getParsed(p),r=o||(0,i.k)(e[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(p),f=this._calculateBarIndexPixels(p,u),m=(e._stacks||{})[a.axis],g={horizontal:c,base:r.base,enableBorderRadius:!m||S(e._custom)||s===m._top||s===m._bottom,x:c?r.head:f.center,y:c?f.center:r.head,height:c?f.size:Math.abs(r.size),width:c?Math.abs(r.size):f.size};d&&(g.options=h||this.resolveDataElementOptions(p,t[p].active?"active":n));const y=g.options||t[p].options;P(g,y,m,s),M(g,y,u.ratio),this.updateElement(t[p],p,g,n)}}_getStacks(t,e){const{iScale:r}=this._cachedMeta,n=r.getMatchingVisibleMetas(this._type).filter((t=>t.controller.options.grouped)),o=r.options.stacked,s=[],a=t=>{const r=t.controller.getParsed(e),n=r&&r[t.vScale.axis];if((0,i.k)(n)||isNaN(n))return!0};for(const r of n)if((void 0===e||!a(r))&&((!1===o||-1===s.indexOf(r.stack)||void 0===o&&void 0===r.stack)&&s.push(r.stack),r.index===t))break;return s.length||s.push(void 0),s}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,r){const i=this._getStacks(t,r),n=void 0!==e?i.indexOf(e):-1;return-1===n?i.length-1:n}_getRuler(){const t=this.options,e=this._cachedMeta,r=e.iScale,i=[];let n,o;for(n=0,o=e.data.length;n<o;++n)i.push(r.getPixelForValue(this.getParsed(n)[r.axis],n));const s=t.barThickness;return{min:s||w(e),pixels:i,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:t.grouped,ratio:s?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:r},options:{base:n,minBarLength:o}}=this,s=n||0,a=this.getParsed(t),l=a._custom,c=S(l);let u,h,d=a[e.axis],p=0,f=r?this.applyStack(e,a,r):d;f!==d&&(p=f-d,f=d),c&&(d=l.barStart,f=l.barEnd-l.barStart,0!==d&&(0,i.s)(d)!==(0,i.s)(l.barEnd)&&(p=0),p+=d);const m=(0,i.k)(n)||c?p:n;let g=e.getPixelForValue(m);if(u=this.chart.getDataVisibility(t)?e.getPixelForValue(p+f):g,h=u-g,Math.abs(h)<o){h=function(t,e,r){return 0!==t?(0,i.s)(t):(e.isHorizontal()?1:-1)*(e.min>=r?1:-1)}(h,e,s)*o,d===s&&(g-=h/2);const t=e.getPixelForDecimal(0),r=e.getPixelForDecimal(1),n=Math.min(t,r),a=Math.max(t,r);g=Math.max(Math.min(g,a),n),u=g+h}if(g===e.getPixelForValue(s)){const t=(0,i.s)(h)*e.getLineWidthForValue(s)/2;g+=t,h-=t}return{size:h,base:g,head:u,center:u+h/2}}_calculateBarIndexPixels(t,e){const r=e.scale,n=this.options,o=n.skipNull,s=(0,i.v)(n.maxBarThickness,1/0);let a,l;if(e.grouped){const r=o?this._getStackCount(t):e.stackCount,c="flex"===n.barThickness?function(t,e,r,i){const n=e.pixels,o=n[t];let s=t>0?n[t-1]:null,a=t<n.length-1?n[t+1]:null;const l=r.categoryPercentage;null===s&&(s=o-(null===a?e.end-e.start:a-o)),null===a&&(a=o+o-s);const c=o-(o-Math.min(s,a))/2*l;return{chunk:Math.abs(a-s)/2*l/i,ratio:r.barPercentage,start:c}}(t,e,n,r):function(t,e,r,n){const o=r.barThickness;let s,a;return(0,i.k)(o)?(s=e.min*r.categoryPercentage,a=r.barPercentage):(s=o*n,a=1),{chunk:s/n,ratio:a,start:e.pixels[t]-s/2}}(t,e,n,r),u=this._getStackIndex(this.index,this._cachedMeta.stack,o?t:void 0);a=c.start+c.chunk*u+c.chunk/2,l=Math.min(s,c.chunk*c.ratio)}else a=r.getPixelForValue(this.getParsed(t)[r.axis],t),l=Math.min(s,e.min*e.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const t=this._cachedMeta,e=t.vScale,r=t.data,i=r.length;let n=0;for(;n<i;++n)null!==this.getParsed(n)[e.axis]&&r[n].draw(this._ctx)}}C.id="bar",C.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}},C.overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class I extends x{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,r,i){const n=super.parsePrimitiveData(t,e,r,i);for(let t=0;t<n.length;t++)n[t]._custom=this.resolveDataElementOptions(t+r).radius;return n}parseArrayData(t,e,r,n){const o=super.parseArrayData(t,e,r,n);for(let t=0;t<o.length;t++){const n=e[r+t];o[t]._custom=(0,i.v)(n[2],this.resolveDataElementOptions(t+r).radius)}return o}parseObjectData(t,e,r,n){const o=super.parseObjectData(t,e,r,n);for(let t=0;t<o.length;t++){const n=e[r+t];o[t]._custom=(0,i.v)(n&&n.r&&+n.r,this.resolveDataElementOptions(t+r).radius)}return o}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let r=t.length-1;r>=0;--r)e=Math.max(e,t[r].size(this.resolveDataElementOptions(r))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,{xScale:r,yScale:i}=e,n=this.getParsed(t),o=r.getLabelForValue(n.x),s=i.getLabelForValue(n.y),a=n._custom;return{label:e.label,value:"("+o+", "+s+(a?", "+a:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,r,i){const n="reset"===i,{iScale:o,vScale:s}=this._cachedMeta,{sharedOptions:a,includeOptions:l}=this._getSharedOptions(e,i),c=o.axis,u=s.axis;for(let h=e;h<e+r;h++){const e=t[h],r=!n&&this.getParsed(h),d={},p=d[c]=n?o.getPixelForDecimal(.5):o.getPixelForValue(r[c]),f=d[u]=n?s.getBasePixel():s.getPixelForValue(r[u]);d.skip=isNaN(p)||isNaN(f),l&&(d.options=a||this.resolveDataElementOptions(h,e.active?"active":i),n&&(d.options.radius=0)),this.updateElement(e,h,d,i)}}resolveDataElementOptions(t,e){const r=this.getParsed(t);let n=super.resolveDataElementOptions(t,e);n.$shared&&(n=Object.assign({},n,{$shared:!1}));const o=n.radius;return"active"!==e&&(n.radius=0),n.radius+=(0,i.v)(r&&r._custom,o),n}}I.id="bubble",I.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}},I.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title:()=>""}}}};class O extends x{constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const r=this.getDataset().data,n=this._cachedMeta;if(!1===this._parsing)n._parsed=r;else{let o,s,a=t=>+r[t];if((0,i.i)(r[t])){const{key:t="value"}=this._parsing;a=e=>+(0,i.f)(r[e],t)}for(o=t,s=t+e;o<s;++o)n._parsed[o]=a(o)}}_getRotation(){return(0,i.t)(this.options.rotation-90)}_getCircumference(){return(0,i.t)(this.options.circumference)}_getRotationExtents(){let t=i.T,e=-i.T;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)){const i=this.chart.getDatasetMeta(r).controller,n=i._getRotation(),o=i._getCircumference();t=Math.min(t,n),e=Math.max(e,n+o)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:r}=e,n=this._cachedMeta,o=n.data,s=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,a=Math.max((Math.min(r.width,r.height)-s)/2,0),l=Math.min((0,i.m)(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:d,ratioY:p,offsetX:f,offsetY:m}=function(t,e,r){let n=1,o=1,s=0,a=0;if(e<i.T){const l=t,c=l+e,u=Math.cos(l),h=Math.sin(l),d=Math.cos(c),p=Math.sin(c),f=(t,e,n)=>(0,i.p)(t,l,c,!0)?1:Math.max(e,e*r,n,n*r),m=(t,e,n)=>(0,i.p)(t,l,c,!0)?-1:Math.min(e,e*r,n,n*r),g=f(0,u,d),y=f(i.H,h,p),v=m(i.P,u,d),_=m(i.P+i.H,h,p);n=(g-v)/2,o=(y-_)/2,s=-(g+v)/2,a=-(y+_)/2}return{ratioX:n,ratioY:o,offsetX:s,offsetY:a}}(h,u,l),g=(r.width-s)/d,y=(r.height-s)/p,v=Math.max(Math.min(g,y)/2,0),_=(0,i.n)(this.options.radius,v),b=(_-Math.max(_*l,0))/this._getVisibleDatasetWeightTotal();this.offsetX=f*_,this.offsetY=m*_,n.total=this.calculateTotal(),this.outerRadius=_-b*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-b*c,0),this.updateElements(o,0,o.length,t)}_circumference(t,e){const r=this.options,n=this._cachedMeta,o=this._getCircumference();return e&&r.animation.animateRotate||!this.chart.getDataVisibility(t)||null===n._parsed[t]||n.data[t].hidden?0:this.calculateCircumference(n._parsed[t]*o/i.T)}updateElements(t,e,r,i){const n="reset"===i,o=this.chart,s=o.chartArea,a=o.options.animation,l=(s.left+s.right)/2,c=(s.top+s.bottom)/2,u=n&&a.animateScale,h=u?0:this.innerRadius,d=u?0:this.outerRadius,{sharedOptions:p,includeOptions:f}=this._getSharedOptions(e,i);let m,g=this._getRotation();for(m=0;m<e;++m)g+=this._circumference(m,n);for(m=e;m<e+r;++m){const e=this._circumference(m,n),r=t[m],o={x:l+this.offsetX,y:c+this.offsetY,startAngle:g,endAngle:g+e,circumference:e,outerRadius:d,innerRadius:h};f&&(o.options=p||this.resolveDataElementOptions(m,r.active?"active":i)),g+=e,this.updateElement(r,m,o,i)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let r,i=0;for(r=0;r<e.length;r++){const n=t._parsed[r];null===n||isNaN(n)||!this.chart.getDataVisibility(r)||e[r].hidden||(i+=Math.abs(n))}return i}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?i.T*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,r=this.chart,n=r.data.labels||[],o=(0,i.o)(e._parsed[t],r.options.locale);return{label:n[t]||"",value:o}}getMaxBorderWidth(t){let e=0;const r=this.chart;let i,n,o,s,a;if(!t)for(i=0,n=r.data.datasets.length;i<n;++i)if(r.isDatasetVisible(i)){o=r.getDatasetMeta(i),t=o.data,s=o.controller;break}if(!t)return 0;for(i=0,n=t.length;i<n;++i)a=s.resolveDataElementOptions(i),"inner"!==a.borderAlign&&(e=Math.max(e,a.borderWidth||0,a.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let r=0,i=t.length;r<i;++r){const t=this.resolveDataElementOptions(r);e=Math.max(e,t.offset||0,t.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let r=0;r<t;++r)this.chart.isDatasetVisible(r)&&(e+=this._getRingWeight(r));return e}_getRingWeight(t){return Math.max((0,i.v)(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}O.id="doughnut",O.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"},O.descriptors={_scriptable:t=>"spacing"!==t,_indexable:t=>"spacing"!==t},O.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:r}}=t.legend.options;return e.labels.map(((e,i)=>{const n=t.getDatasetMeta(0).controller.getStyle(i);return{text:e,fillStyle:n.backgroundColor,strokeStyle:n.borderColor,lineWidth:n.borderWidth,pointStyle:r,hidden:!t.getDataVisibility(i),index:i}}))}return[]}},onClick(t,e,r){r.chart.toggleDataVisibility(e.index),r.chart.update()}},tooltip:{callbacks:{title:()=>"",label(t){let e=t.label;const r=": "+t.formattedValue;return(0,i.b)(e)?(e=e.slice(),e[0]+=r):e+=r,e}}}}};class L extends x{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:r,data:n=[],_dataset:o}=e,s=this.chart._animationsDisabled;let{start:a,count:l}=(0,i.q)(e,n,s);this._drawStart=a,this._drawCount=l,(0,i.w)(e)&&(a=0,l=n.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!o._decimated,r.points=n;const c=this.resolveDatasetElementOptions(t);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(r,void 0,{animated:!s,options:c},t),this.updateElements(n,a,l,t)}updateElements(t,e,r,n){const o="reset"===n,{iScale:s,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:h}=this._getSharedOptions(e,n),d=s.axis,p=a.axis,{spanGaps:f,segment:m}=this.options,g=(0,i.x)(f)?f:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||o||"none"===n;let v=e>0&&this.getParsed(e-1);for(let f=e;f<e+r;++f){const e=t[f],r=this.getParsed(f),_=y?e:{},b=(0,i.k)(r[p]),x=_[d]=s.getPixelForValue(r[d],f),w=_[p]=o||b?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,r,l):r[p],f);_.skip=isNaN(x)||isNaN(w)||b,_.stop=f>0&&Math.abs(r[d]-v[d])>g,m&&(_.parsed=r,_.raw=c.data[f]),h&&(_.options=u||this.resolveDataElementOptions(f,e.active?"active":n)),y||this.updateElement(e,f,_,n),v=r}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,r=e.options&&e.options.borderWidth||0,i=t.data||[];if(!i.length)return r;const n=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(r,n,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}L.id="line",L.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1},L.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};class D extends x{constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,r=this.chart,n=r.data.labels||[],o=(0,i.o)(e._parsed[t].r,r.options.locale);return{label:n[t]||"",value:o}}parseObjectData(t,e,r,n){return i.y.bind(this)(t,e,r,n)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach(((t,r)=>{const i=this.getParsed(r).r;!isNaN(i)&&this.chart.getDataVisibility(r)&&(i<e.min&&(e.min=i),i>e.max&&(e.max=i))})),e}_updateRadius(){const t=this.chart,e=t.chartArea,r=t.options,i=Math.min(e.right-e.left,e.bottom-e.top),n=Math.max(i/2,0),o=(n-Math.max(r.cutoutPercentage?n/100*r.cutoutPercentage:1,0))/t.getVisibleDatasetCount();this.outerRadius=n-o*this.index,this.innerRadius=this.outerRadius-o}updateElements(t,e,r,n){const o="reset"===n,s=this.chart,a=s.options.animation,l=this._cachedMeta.rScale,c=l.xCenter,u=l.yCenter,h=l.getIndexAngle(0)-.5*i.P;let d,p=h;const f=360/this.countVisibleElements();for(d=0;d<e;++d)p+=this._computeAngle(d,n,f);for(d=e;d<e+r;d++){const e=t[d];let r=p,i=p+this._computeAngle(d,n,f),m=s.getDataVisibility(d)?l.getDistanceFromCenterForValue(this.getParsed(d).r):0;p=i,o&&(a.animateScale&&(m=0),a.animateRotate&&(r=i=h));const g={x:c,y:u,innerRadius:0,outerRadius:m,startAngle:r,endAngle:i,options:this.resolveDataElementOptions(d,e.active?"active":n)};this.updateElement(e,d,g,n)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach(((t,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&e++})),e}_computeAngle(t,e,r){return this.chart.getDataVisibility(t)?(0,i.t)(this.resolveDataElementOptions(t,e).angle||r):0}}D.id="polarArea",D.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0},D.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:r}}=t.legend.options;return e.labels.map(((e,i)=>{const n=t.getDatasetMeta(0).controller.getStyle(i);return{text:e,fillStyle:n.backgroundColor,strokeStyle:n.borderColor,lineWidth:n.borderWidth,pointStyle:r,hidden:!t.getDataVisibility(i),index:i}}))}return[]}},onClick(t,e,r){r.chart.toggleDataVisibility(e.index),r.chart.update()}},tooltip:{callbacks:{title:()=>"",label:t=>t.chart.data.labels[t.dataIndex]+": "+t.formattedValue}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class R extends O{}R.id="pie",R.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class F extends x{getLabelAndValue(t){const e=this._cachedMeta.vScale,r=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(r[e.axis])}}parseObjectData(t,e,r,n){return i.y.bind(this)(t,e,r,n)}update(t){const e=this._cachedMeta,r=e.dataset,i=e.data||[],n=e.iScale.getLabels();if(r.points=i,"resize"!==t){const e=this.resolveDatasetElementOptions(t);this.options.showLine||(e.borderWidth=0);const o={_loop:!0,_fullLoop:n.length===i.length,options:e};this.updateElement(r,void 0,o,t)}this.updateElements(i,0,i.length,t)}updateElements(t,e,r,i){const n=this._cachedMeta.rScale,o="reset"===i;for(let s=e;s<e+r;s++){const e=t[s],r=this.resolveDataElementOptions(s,e.active?"active":i),a=n.getPointPositionForValue(s,this.getParsed(s).r),l=o?n.xCenter:a.x,c=o?n.yCenter:a.y,u={x:l,y:c,angle:a.angle,skip:isNaN(l)||isNaN(c),options:r};this.updateElement(e,s,u,i)}}}F.id="radar",F.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}},F.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class B{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(t){const{x:e,y:r}=this.getProps(["x","y"],t);return{x:e,y:r}}hasValue(){return(0,i.x)(this.x)&&(0,i.x)(this.y)}getProps(t,e){const r=this.$animations;if(!e||!r)return this;const i={};return t.forEach((t=>{i[t]=r[t]&&r[t].active()?r[t]._to:this[t]})),i}}B.defaults={},B.defaultRoutes=void 0;const z={values:t=>(0,i.b)(t)?t:""+t,numeric(t,e,r){if(0===t)return"0";const n=this.chart.options.locale;let o,s=t;if(r.length>1){const e=Math.max(Math.abs(r[0].value),Math.abs(r[r.length-1].value));(e<1e-4||e>1e15)&&(o="scientific"),s=function(t,e){let r=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;Math.abs(r)>=1&&t!==Math.floor(t)&&(r=t-Math.floor(t));return r}(t,r)}const a=(0,i.z)(Math.abs(s)),l=Math.max(Math.min(-1*Math.floor(a),20),0),c={notation:o,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),(0,i.o)(t,n,c)},logarithmic(t,e,r){if(0===t)return"0";const n=t/Math.pow(10,Math.floor((0,i.z)(t)));return 1===n||2===n||5===n?z.numeric.call(this,t,e,r):""}};var j={formatters:z};function N(t,e){const r=t.options.ticks,n=r.maxTicksLimit||function(t){const e=t.options.offset,r=t._tickSize(),i=t._length/r+(e?0:1),n=t._maxLength/r;return Math.floor(Math.min(i,n))}(t),o=r.major.enabled?function(t){const e=[];let r,i;for(r=0,i=t.length;r<i;r++)t[r].major&&e.push(r);return e}(e):[],s=o.length,a=o[0],l=o[s-1],c=[];if(s>n)return function(t,e,r,i){let n,o=0,s=r[0];for(i=Math.ceil(i),n=0;n<t.length;n++)n===s&&(e.push(t[n]),o++,s=r[o*i])}(e,c,o,s/n),c;const u=function(t,e,r){const n=function(t){const e=t.length;let r,i;if(e<2)return!1;for(i=t[0],r=1;r<e;++r)if(t[r]-t[r-1]!==i)return!1;return i}(t),o=e.length/r;if(!n)return Math.max(o,1);const s=(0,i.A)(n);for(let t=0,e=s.length-1;t<e;t++){const e=s[t];if(e>o)return e}return Math.max(o,1)}(o,e,n);if(s>0){let t,r;const n=s>1?Math.round((l-a)/(s-1)):null;for(V(e,c,u,(0,i.k)(n)?0:a-n,a),t=0,r=s-1;t<r;t++)V(e,c,u,o[t],o[t+1]);return V(e,c,u,l,(0,i.k)(n)?e.length:l+n),c}return V(e,c,u),c}function V(t,e,r,n,o){const s=(0,i.v)(n,0),a=Math.min((0,i.v)(o,t.length),t.length);let l,c,u,h=0;for(r=Math.ceil(r),o&&(l=o-n,r=l/Math.floor(l/r)),u=s;u<0;)h++,u=Math.round(s+h*r);for(c=Math.max(s,0);c<a;c++)c===u&&(e.push(t[c]),h++,u=Math.round(s+h*r))}i.d.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:j.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),i.d.route("scale.ticks","color","","color"),i.d.route("scale.grid","color","","borderColor"),i.d.route("scale.grid","borderColor","","borderColor"),i.d.route("scale.title","color","","color"),i.d.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&"callback"!==t&&"parser"!==t,_indexable:t=>"borderDash"!==t&&"tickBorderDash"!==t}),i.d.describe("scales",{_fallback:"scale"}),i.d.describe("scale.ticks",{_scriptable:t=>"backdropPadding"!==t&&"callback"!==t,_indexable:t=>"backdropPadding"!==t});const U=(t,e,r)=>"top"===e||"left"===e?t[e]+r:t[e]-r;function $(t,e){const r=[],i=t.length/e,n=t.length;let o=0;for(;o<n;o+=i)r.push(t[Math.floor(o)]);return r}function G(t,e,r){const i=t.ticks.length,n=Math.min(e,i-1),o=t._startPixel,s=t._endPixel,a=1e-6;let l,c=t.getPixelForTick(n);if(!(r&&(l=1===i?Math.max(c-o,s-c):0===e?(t.getPixelForTick(1)-c)/2:(c-t.getPixelForTick(n-1))/2,c+=n<e?l:-l,c<o-a||c>s+a)))return c}function H(t){return t.drawTicks?t.tickLength:0}function q(t,e){if(!t.display)return 0;const r=(0,i.O)(t.font,e),n=(0,i.K)(t.padding);return((0,i.b)(t.text)?t.text.length:1)*r.lineHeight+n.height}function W(t,e,r){let n=(0,i.R)(t);return(r&&"right"!==e||!r&&"right"===e)&&(n=(t=>"left"===t?"right":"right"===t?"left":t)(n)),n}class Z extends B{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:r,_suggestedMax:n}=this;return t=(0,i.B)(t,Number.POSITIVE_INFINITY),e=(0,i.B)(e,Number.NEGATIVE_INFINITY),r=(0,i.B)(r,Number.POSITIVE_INFINITY),n=(0,i.B)(n,Number.NEGATIVE_INFINITY),{min:(0,i.B)(t,r),max:(0,i.B)(e,n),minDefined:(0,i.g)(t),maxDefined:(0,i.g)(e)}}getMinMax(t){let e,{min:r,max:n,minDefined:o,maxDefined:s}=this.getUserBounds();if(o&&s)return{min:r,max:n};const a=this.getMatchingVisibleMetas();for(let i=0,l=a.length;i<l;++i)e=a[i].controller.getMinMax(this,t),o||(r=Math.min(r,e.min)),s||(n=Math.max(n,e.max));return r=s&&r>n?n:r,n=o&&r>n?r:n,{min:(0,i.B)(r,(0,i.B)(n,r)),max:(0,i.B)(n,(0,i.B)(r,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){(0,i.C)(this.options.beforeUpdate,[this])}update(t,e,r){const{beginAtZero:n,grace:o,ticks:s}=this.options,a=s.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=(0,i.D)(this,o,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?$(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),s.display&&(s.autoSkip||"auto"===s.source)&&(this.ticks=N(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t,e,r=this.options.reverse;this.isHorizontal()?(t=this.left,e=this.right):(t=this.top,e=this.bottom,r=!r),this._startPixel=t,this._endPixel=e,this._reversePixels=r,this._length=e-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){(0,i.C)(this.options.afterUpdate,[this])}beforeSetDimensions(){(0,i.C)(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){(0,i.C)(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),(0,i.C)(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){(0,i.C)(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let r,n,o;for(r=0,n=t.length;r<n;r++)o=t[r],o.label=(0,i.C)(e.callback,[o.value,r,t],this)}afterTickToLabelConversion(){(0,i.C)(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){(0,i.C)(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,r=this.ticks.length,n=e.minRotation||0,o=e.maxRotation;let s,a,l,c=n;if(!this._isVisible()||!e.display||n>=o||r<=1||!this.isHorizontal())return void(this.labelRotation=n);const u=this._getLabelSizes(),h=u.widest.width,d=u.highest.height,p=(0,i.E)(this.chart.width-h,0,this.maxWidth);s=t.offset?this.maxWidth/r:p/(r-1),h+6>s&&(s=p/(r-(t.offset?.5:1)),a=this.maxHeight-H(t.grid)-e.padding-q(t.title,this.chart.options.font),l=Math.sqrt(h*h+d*d),c=(0,i.F)(Math.min(Math.asin((0,i.E)((u.highest.height+6)/s,-1,1)),Math.asin((0,i.E)(a/l,-1,1))-Math.asin((0,i.E)(d/l,-1,1)))),c=Math.max(n,Math.min(o,c))),this.labelRotation=c}afterCalculateLabelRotation(){(0,i.C)(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){(0,i.C)(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:r,title:n,grid:o}}=this,s=this._isVisible(),a=this.isHorizontal();if(s){const s=q(n,e.options.font);if(a?(t.width=this.maxWidth,t.height=H(o)+s):(t.height=this.maxHeight,t.width=H(o)+s),r.display&&this.ticks.length){const{first:e,last:n,widest:o,highest:s}=this._getLabelSizes(),l=2*r.padding,c=(0,i.t)(this.labelRotation),u=Math.cos(c),h=Math.sin(c);if(a){const e=r.mirror?0:h*o.width+u*s.height;t.height=Math.min(this.maxHeight,t.height+e+l)}else{const e=r.mirror?0:u*o.width+h*s.height;t.width=Math.min(this.maxWidth,t.width+e+l)}this._calculatePadding(e,n,h,u)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,r,i){const{ticks:{align:n,padding:o},position:s}=this.options,a=0!==this.labelRotation,l="top"!==s&&"x"===this.axis;if(this.isHorizontal()){const s=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let u=0,h=0;a?l?(u=i*t.width,h=r*e.height):(u=r*t.height,h=i*e.width):"start"===n?h=e.width:"end"===n?u=t.width:"inner"!==n&&(u=t.width/2,h=e.width/2),this.paddingLeft=Math.max((u-s+o)*this.width/(this.width-s),0),this.paddingRight=Math.max((h-c+o)*this.width/(this.width-c),0)}else{let r=e.height/2,i=t.height/2;"start"===n?(r=0,i=t.height):"end"===n&&(r=e.height,i=0),this.paddingTop=r+o,this.paddingBottom=i+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){(0,i.C)(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return"top"===e||"bottom"===e||"x"===t}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){let e,r;for(this.beforeTickToLabelConversion(),this.generateTickLabels(t),e=0,r=t.length;e<r;e++)(0,i.k)(t[e].label)&&(t.splice(e,1),r--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let r=this.ticks;e<r.length&&(r=$(r,e)),this._labelSizes=t=this._computeLabelSizes(r,r.length)}return t}_computeLabelSizes(t,e){const{ctx:r,_longestTextCache:n}=this,o=[],s=[];let a,l,c,u,h,d,p,f,m,g,y,v=0,_=0;for(a=0;a<e;++a){if(u=t[a].label,h=this._resolveTickFontOptions(a),r.font=d=h.string,p=n[d]=n[d]||{data:{},gc:[]},f=h.lineHeight,m=g=0,(0,i.k)(u)||(0,i.b)(u)){if((0,i.b)(u))for(l=0,c=u.length;l<c;++l)y=u[l],(0,i.k)(y)||(0,i.b)(y)||(m=(0,i.G)(r,p.data,p.gc,m,y),g+=f)}else m=(0,i.G)(r,p.data,p.gc,m,u),g=f;o.push(m),s.push(g),v=Math.max(m,v),_=Math.max(g,_)}!function(t,e){(0,i.Q)(t,(t=>{const r=t.gc,i=r.length/2;let n;if(i>e){for(n=0;n<i;++n)delete t.data[r[n]];r.splice(0,i)}}))}(n,e);const b=o.indexOf(v),x=s.indexOf(_),w=t=>({width:o[t]||0,height:s[t]||0});return{first:w(0),last:w(e-1),widest:w(b),highest:w(x),widths:o,heights:s}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return(0,i.I)(this._alignToPixels?(0,i.J)(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const r=e[t];return r.$context||(r.$context=function(t,e,r){return(0,i.h)(t,{tick:r,index:e,type:"tick"})}(this.getContext(),t,r))}return this.$context||(this.$context=function(t,e){return(0,i.h)(t,{scale:e,type:"scale"})}(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=(0,i.t)(this.labelRotation),r=Math.abs(Math.cos(e)),n=Math.abs(Math.sin(e)),o=this._getLabelSizes(),s=t.autoSkipPadding||0,a=o?o.widest.width+s:0,l=o?o.highest.height+s:0;return this.isHorizontal()?l*r>a*n?a/r:l/n:l*n<a*r?l/r:a/n}_isVisible(){const t=this.options.display;return"auto"!==t?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,r=this.chart,n=this.options,{grid:o,position:s}=n,a=o.offset,l=this.isHorizontal(),c=this.ticks.length+(a?1:0),u=H(o),h=[],d=o.setContext(this.getContext()),p=d.drawBorder?d.borderWidth:0,f=p/2,m=function(t){return(0,i.J)(r,t,p)};let g,y,v,_,b,x,w,T,E,S,P,k;if("top"===s)g=m(this.bottom),x=this.bottom-u,T=g-f,S=m(t.top)+f,k=t.bottom;else if("bottom"===s)g=m(this.top),S=t.top,k=m(t.bottom)-f,x=g+f,T=this.top+u;else if("left"===s)g=m(this.right),b=this.right-u,w=g-f,E=m(t.left)+f,P=t.right;else if("right"===s)g=m(this.left),E=t.left,P=m(t.right)-f,b=g+f,w=this.left+u;else if("x"===e){if("center"===s)g=m((t.top+t.bottom)/2+.5);else if((0,i.i)(s)){const t=Object.keys(s)[0],e=s[t];g=m(this.chart.scales[t].getPixelForValue(e))}S=t.top,k=t.bottom,x=g+f,T=x+u}else if("y"===e){if("center"===s)g=m((t.left+t.right)/2);else if((0,i.i)(s)){const t=Object.keys(s)[0],e=s[t];g=m(this.chart.scales[t].getPixelForValue(e))}b=g-f,w=b-u,E=t.left,P=t.right}const A=(0,i.v)(n.ticks.maxTicksLimit,c),M=Math.max(1,Math.ceil(c/A));for(y=0;y<c;y+=M){const t=o.setContext(this.getContext(y)),e=t.lineWidth,n=t.color,s=t.borderDash||[],c=t.borderDashOffset,u=t.tickWidth,d=t.tickColor,p=t.tickBorderDash||[],f=t.tickBorderDashOffset;v=G(this,y,a),void 0!==v&&(_=(0,i.J)(r,v,e),l?b=w=E=P=_:x=T=S=k=_,h.push({tx1:b,ty1:x,tx2:w,ty2:T,x1:E,y1:S,x2:P,y2:k,width:e,color:n,borderDash:s,borderDashOffset:c,tickWidth:u,tickColor:d,tickBorderDash:p,tickBorderDashOffset:f}))}return this._ticksLength=c,this._borderValue=g,h}_computeLabelItems(t){const e=this.axis,r=this.options,{position:n,ticks:o}=r,s=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:h}=o,d=H(r.grid),p=d+u,f=h?-u:p,m=-(0,i.t)(this.labelRotation),g=[];let y,v,_,b,x,w,T,E,S,P,k,A,M="middle";if("top"===n)w=this.bottom-f,T=this._getXAxisLabelAlignment();else if("bottom"===n)w=this.top+f,T=this._getXAxisLabelAlignment();else if("left"===n){const t=this._getYAxisLabelAlignment(d);T=t.textAlign,x=t.x}else if("right"===n){const t=this._getYAxisLabelAlignment(d);T=t.textAlign,x=t.x}else if("x"===e){if("center"===n)w=(t.top+t.bottom)/2+p;else if((0,i.i)(n)){const t=Object.keys(n)[0],e=n[t];w=this.chart.scales[t].getPixelForValue(e)+p}T=this._getXAxisLabelAlignment()}else if("y"===e){if("center"===n)x=(t.left+t.right)/2-p;else if((0,i.i)(n)){const t=Object.keys(n)[0],e=n[t];x=this.chart.scales[t].getPixelForValue(e)}T=this._getYAxisLabelAlignment(d).textAlign}"y"===e&&("start"===l?M="top":"end"===l&&(M="bottom"));const C=this._getLabelSizes();for(y=0,v=a.length;y<v;++y){_=a[y],b=_.label;const t=o.setContext(this.getContext(y));E=this.getPixelForTick(y)+o.labelOffset,S=this._resolveTickFontOptions(y),P=S.lineHeight,k=(0,i.b)(b)?b.length:1;const e=k/2,r=t.color,l=t.textStrokeColor,u=t.textStrokeWidth;let d,p=T;if(s?(x=E,"inner"===T&&(p=y===v-1?this.options.reverse?"left":"right":0===y?this.options.reverse?"right":"left":"center"),A="top"===n?"near"===c||0!==m?-k*P+P/2:"center"===c?-C.highest.height/2-e*P+P:-C.highest.height+P/2:"near"===c||0!==m?P/2:"center"===c?C.highest.height/2-e*P:C.highest.height-k*P,h&&(A*=-1)):(w=E,A=(1-k)*P/2),t.showLabelBackdrop){const e=(0,i.K)(t.backdropPadding),r=C.heights[y],n=C.widths[y];let o=w+A-e.top,s=x-e.left;switch(M){case"middle":o-=r/2;break;case"bottom":o-=r}switch(T){case"center":s-=n/2;break;case"right":s-=n}d={left:s,top:o,width:n+e.width,height:r+e.height,color:t.backdropColor}}g.push({rotation:m,label:b,font:S,color:r,strokeColor:l,strokeWidth:u,textOffset:A,textAlign:p,textBaseline:M,translation:[x,w],backdrop:d})}return g}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-(0,i.t)(this.labelRotation))return"top"===t?"left":"right";let r="center";return"start"===e.align?r="left":"end"===e.align?r="right":"inner"===e.align&&(r="inner"),r}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:r,mirror:i,padding:n}}=this.options,o=t+n,s=this._getLabelSizes().widest.width;let a,l;return"left"===e?i?(l=this.right+n,"near"===r?a="left":"center"===r?(a="center",l+=s/2):(a="right",l+=s)):(l=this.right-o,"near"===r?a="right":"center"===r?(a="center",l-=s/2):(a="left",l=this.left)):"right"===e?i?(l=this.left+n,"near"===r?a="right":"center"===r?(a="center",l-=s/2):(a="left",l-=s)):(l=this.left+o,"near"===r?a="left":"center"===r?(a="center",l+=s/2):(a="right",l=this.right)):a="right",{textAlign:a,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;return"left"===e||"right"===e?{top:0,left:this.left,bottom:t.height,right:this.right}:"top"===e||"bottom"===e?{top:this.top,left:0,bottom:this.bottom,right:t.width}:void 0}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:r,top:i,width:n,height:o}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(r,i,n,o),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const r=this.ticks.findIndex((e=>e.value===t));if(r>=0){return e.setContext(this.getContext(r)).lineWidth}return 0}drawGrid(t){const e=this.options.grid,r=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let n,o;const s=(t,e,i)=>{i.width&&i.color&&(r.save(),r.lineWidth=i.width,r.strokeStyle=i.color,r.setLineDash(i.borderDash||[]),r.lineDashOffset=i.borderDashOffset,r.beginPath(),r.moveTo(t.x,t.y),r.lineTo(e.x,e.y),r.stroke(),r.restore())};if(e.display)for(n=0,o=i.length;n<o;++n){const t=i[n];e.drawOnChartArea&&s({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},t),e.drawTicks&&s({x:t.tx1,y:t.ty1},{x:t.tx2,y:t.ty2},{color:t.tickColor,width:t.tickWidth,borderDash:t.tickBorderDash,borderDashOffset:t.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{grid:r}}=this,n=r.setContext(this.getContext()),o=r.drawBorder?n.borderWidth:0;if(!o)return;const s=r.setContext(this.getContext(0)).lineWidth,a=this._borderValue;let l,c,u,h;this.isHorizontal()?(l=(0,i.J)(t,this.left,o)-o/2,c=(0,i.J)(t,this.right,s)+s/2,u=h=a):(u=(0,i.J)(t,this.top,o)-o/2,h=(0,i.J)(t,this.bottom,s)+s/2,l=c=a),e.save(),e.lineWidth=n.borderWidth,e.strokeStyle=n.borderColor,e.beginPath(),e.moveTo(l,u),e.lineTo(c,h),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const e=this.ctx,r=this._computeLabelArea();r&&(0,i.L)(e,r);const n=this._labelItems||(this._labelItems=this._computeLabelItems(t));let o,s;for(o=0,s=n.length;o<s;++o){const t=n[o],r=t.font,s=t.label;t.backdrop&&(e.fillStyle=t.backdrop.color,e.fillRect(t.backdrop.left,t.backdrop.top,t.backdrop.width,t.backdrop.height));let a=t.textOffset;(0,i.M)(e,s,0,a,r,t)}r&&(0,i.N)(e)}drawTitle(){const{ctx:t,options:{position:e,title:r,reverse:n}}=this;if(!r.display)return;const o=(0,i.O)(r.font),s=(0,i.K)(r.padding),a=r.align;let l=o.lineHeight/2;"bottom"===e||"center"===e||(0,i.i)(e)?(l+=s.bottom,(0,i.b)(r.text)&&(l+=o.lineHeight*(r.text.length-1))):l+=s.top;const{titleX:c,titleY:u,maxWidth:h,rotation:d}=function(t,e,r,n){const{top:o,left:s,bottom:a,right:l,chart:c}=t,{chartArea:u,scales:h}=c;let d,p,f,m=0;const g=a-o,y=l-s;if(t.isHorizontal()){if(p=(0,i.S)(n,s,l),(0,i.i)(r)){const t=Object.keys(r)[0],i=r[t];f=h[t].getPixelForValue(i)+g-e}else f="center"===r?(u.bottom+u.top)/2+g-e:U(t,r,e);d=l-s}else{if((0,i.i)(r)){const t=Object.keys(r)[0],i=r[t];p=h[t].getPixelForValue(i)-y+e}else p="center"===r?(u.left+u.right)/2-y+e:U(t,r,e);f=(0,i.S)(n,a,o),m="left"===r?-i.H:i.H}return{titleX:p,titleY:f,maxWidth:d,rotation:m}}(this,l,e,a);(0,i.M)(t,r.text,0,0,o,{color:r.color,maxWidth:h,rotation:d,textAlign:W(a,e,n),textBaseline:"middle",translation:[c,u]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,r=(0,i.v)(t.grid&&t.grid.z,-1);return this._isVisible()&&this.draw===Z.prototype.draw?[{z:r,draw:t=>{this.drawBackground(),this.drawGrid(t),this.drawTitle()}},{z:r+1,draw:()=>{this.drawBorder()}},{z:e,draw:t=>{this.drawLabels(t)}}]:[{z:e,draw:t=>{this.draw(t)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",i=[];let n,o;for(n=0,o=e.length;n<o;++n){const o=e[n];o[r]!==this.id||t&&o.type!==t||i.push(o)}return i}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return(0,i.O)(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class X{constructor(t,e,r){this.type=t,this.scope=e,this.override=r,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let r;(function(t){return"id"in t&&"defaults"in t})(e)&&(r=this.register(e));const n=this.items,o=t.id,s=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+t);return o in n||(n[o]=t,function(t,e,r){const n=(0,i.V)(Object.create(null),[r?i.d.get(r):{},i.d.get(e),t.defaults]);i.d.set(e,n),t.defaultRoutes&&function(t,e){Object.keys(e).forEach((r=>{const n=r.split("."),o=n.pop(),s=[t].concat(n).join("."),a=e[r].split("."),l=a.pop(),c=a.join(".");i.d.route(s,o,c,l)}))}(e,t.defaultRoutes);t.descriptors&&i.d.describe(e,t.descriptors)}(t,s,r),this.override&&i.d.override(t.id,t.overrides)),s}get(t){return this.items[t]}unregister(t){const e=this.items,r=t.id,n=this.scope;r in e&&delete e[r],n&&r in i.d[n]&&(delete i.d[n][r],this.override&&delete i.U[r])}}var Y=new class{constructor(){this.controllers=new X(x,"datasets",!0),this.elements=new X(B,"elements"),this.plugins=new X(Object,"plugins"),this.scales=new X(Z,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,r){[...e].forEach((e=>{const n=r||this._getRegistryForType(e);r||n.isForType(e)||n===this.plugins&&e.id?this._exec(t,n,e):(0,i.Q)(e,(e=>{const i=r||this._getRegistryForType(e);this._exec(t,i,e)}))}))}_exec(t,e,r){const n=(0,i.W)(t);(0,i.C)(r["before"+n],[],r),e[t](r),(0,i.C)(r["after"+n],[],r)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const r=this._typedRegistries[e];if(r.isForType(t))return r}return this.plugins}_get(t,e,r){const i=e.get(t);if(void 0===i)throw new Error('"'+t+'" is not a registered '+r+".");return i}};class K extends x{update(t){const e=this._cachedMeta,{data:r=[]}=e,n=this.chart._animationsDisabled;let{start:o,count:s}=(0,i.q)(e,r,n);if(this._drawStart=o,this._drawCount=s,(0,i.w)(e)&&(o=0,s=r.length),this.options.showLine){const{dataset:i,_dataset:o}=e;i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!o._decimated,i.points=r;const s=this.resolveDatasetElementOptions(t);s.segment=this.options.segment,this.updateElement(i,void 0,{animated:!n,options:s},t)}this.updateElements(r,o,s,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=Y.getElement("line")),super.addElements()}updateElements(t,e,r,n){const o="reset"===n,{iScale:s,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,u=this.resolveDataElementOptions(e,n),h=this.getSharedOptions(u),d=this.includeOptions(n,h),p=s.axis,f=a.axis,{spanGaps:m,segment:g}=this.options,y=(0,i.x)(m)?m:Number.POSITIVE_INFINITY,v=this.chart._animationsDisabled||o||"none"===n;let _=e>0&&this.getParsed(e-1);for(let u=e;u<e+r;++u){const e=t[u],r=this.getParsed(u),m=v?e:{},b=(0,i.k)(r[f]),x=m[p]=s.getPixelForValue(r[p],u),w=m[f]=o||b?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,r,l):r[f],u);m.skip=isNaN(x)||isNaN(w)||b,m.stop=u>0&&Math.abs(r[p]-_[p])>y,g&&(m.parsed=r,m.raw=c.data[u]),d&&(m.options=h||this.resolveDataElementOptions(u,e.active?"active":n)),v||this.updateElement(e,u,m,n),_=r}this.updateSharedOptions(h,n,u)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let t=0;for(let r=e.length-1;r>=0;--r)t=Math.max(t,e[r].size(this.resolveDataElementOptions(r))/2);return t>0&&t}const r=t.dataset,i=r.options&&r.options.borderWidth||0;if(!e.length)return i;const n=e[0].size(this.resolveDataElementOptions(0)),o=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(i,n,o)/2}}K.id="scatter",K.defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1},K.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title:()=>"",label:t=>"("+t.label+", "+t.formattedValue+")"}}},scales:{x:{type:"linear"},y:{type:"linear"}}};var J=Object.freeze({__proto__:null,BarController:C,BubbleController:I,DoughnutController:O,LineController:L,PolarAreaController:D,PieController:R,RadarController:F,ScatterController:K});function Q(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class tt{constructor(t){this.options=t||{}}init(t){}formats(){return Q()}parse(t,e){return Q()}format(t,e){return Q()}add(t,e,r){return Q()}diff(t,e,r){return Q()}startOf(t,e,r){return Q()}endOf(t,e){return Q()}}tt.override=function(t){Object.assign(tt.prototype,t)};var et={_date:tt};function rt(t,e,r,n){const{controller:o,data:s,_sorted:a}=t,l=o._cachedMeta.iScale;if(l&&e===l.axis&&"r"!==e&&a&&s.length){const t=l._reversePixels?i.Y:i.Z;if(!n)return t(s,e,r);if(o._sharedOptions){const i=s[0],n="function"==typeof i.getRange&&i.getRange(e);if(n){const i=t(s,e,r-n),o=t(s,e,r+n);return{lo:i.lo,hi:o.hi}}}}return{lo:0,hi:s.length-1}}function it(t,e,r,i,n){const o=t.getSortedVisibleDatasetMetas(),s=r[e];for(let t=0,r=o.length;t<r;++t){const{index:r,data:a}=o[t],{lo:l,hi:c}=rt(o[t],e,s,n);for(let t=l;t<=c;++t){const e=a[t];e.skip||i(e,r,t)}}}function nt(t,e,r,n,o){const s=[];if(!o&&!t.isPointInArea(e))return s;return it(t,r,e,(function(r,a,l){(o||(0,i.$)(r,t.chartArea,0))&&r.inRange(e.x,e.y,n)&&s.push({element:r,datasetIndex:a,index:l})}),!0),s}function ot(t,e,r,i,n,o){let s=[];const a=function(t){const e=-1!==t.indexOf("x"),r=-1!==t.indexOf("y");return function(t,i){const n=e?Math.abs(t.x-i.x):0,o=r?Math.abs(t.y-i.y):0;return Math.sqrt(Math.pow(n,2)+Math.pow(o,2))}}(r);let l=Number.POSITIVE_INFINITY;return it(t,r,e,(function(r,c,u){const h=r.inRange(e.x,e.y,n);if(i&&!h)return;const d=r.getCenterPoint(n);if(!(!!o||t.isPointInArea(d))&&!h)return;const p=a(e,d);p<l?(s=[{element:r,datasetIndex:c,index:u}],l=p):p===l&&s.push({element:r,datasetIndex:c,index:u})})),s}function st(t,e,r,n,o,s){return s||t.isPointInArea(e)?"r"!==r||n?ot(t,e,r,n,o,s):function(t,e,r,n){let o=[];return it(t,r,e,(function(t,r,s){const{startAngle:a,endAngle:l}=t.getProps(["startAngle","endAngle"],n),{angle:c}=(0,i.a0)(t,{x:e.x,y:e.y});(0,i.p)(c,a,l)&&o.push({element:t,datasetIndex:r,index:s})})),o}(t,e,r,o):[]}function at(t,e,r,i,n){const o=[],s="x"===r?"inXRange":"inYRange";let a=!1;return it(t,r,e,((t,i,l)=>{t[s](e[r],n)&&(o.push({element:t,datasetIndex:i,index:l}),a=a||t.inRange(e.x,e.y,n))})),i&&!a?[]:o}var lt={evaluateInteractionItems:it,modes:{index(t,e,r,n){const o=(0,i.X)(e,t),s=r.axis||"x",a=r.includeInvisible||!1,l=r.intersect?nt(t,o,s,n,a):st(t,o,s,!1,n,a),c=[];return l.length?(t.getSortedVisibleDatasetMetas().forEach((t=>{const e=l[0].index,r=t.data[e];r&&!r.skip&&c.push({element:r,datasetIndex:t.index,index:e})})),c):[]},dataset(t,e,r,n){const o=(0,i.X)(e,t),s=r.axis||"xy",a=r.includeInvisible||!1;let l=r.intersect?nt(t,o,s,n,a):st(t,o,s,!1,n,a);if(l.length>0){const e=l[0].datasetIndex,r=t.getDatasetMeta(e).data;l=[];for(let t=0;t<r.length;++t)l.push({element:r[t],datasetIndex:e,index:t})}return l},point:(t,e,r,n)=>nt(t,(0,i.X)(e,t),r.axis||"xy",n,r.includeInvisible||!1),nearest(t,e,r,n){const o=(0,i.X)(e,t),s=r.axis||"xy",a=r.includeInvisible||!1;return st(t,o,s,r.intersect,n,a)},x:(t,e,r,n)=>at(t,(0,i.X)(e,t),"x",r.intersect,n),y:(t,e,r,n)=>at(t,(0,i.X)(e,t),"y",r.intersect,n)}};const ct=["left","top","right","bottom"];function ut(t,e){return t.filter((t=>t.pos===e))}function ht(t,e){return t.filter((t=>-1===ct.indexOf(t.pos)&&t.box.axis===e))}function dt(t,e){return t.sort(((t,r)=>{const i=e?r:t,n=e?t:r;return i.weight===n.weight?i.index-n.index:i.weight-n.weight}))}function pt(t,e){const r=function(t){const e={};for(const r of t){const{stack:t,pos:i,stackWeight:n}=r;if(!t||!ct.includes(i))continue;const o=e[t]||(e[t]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=n}return e}(t),{vBoxMaxWidth:i,hBoxMaxHeight:n}=e;let o,s,a;for(o=0,s=t.length;o<s;++o){a=t[o];const{fullSize:s}=a.box,l=r[a.stack],c=l&&a.stackWeight/l.weight;a.horizontal?(a.width=c?c*i:s&&e.availableWidth,a.height=n):(a.width=i,a.height=c?c*n:s&&e.availableHeight)}return r}function ft(t,e,r,i){return Math.max(t[r],e[r])+Math.max(t[i],e[i])}function mt(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function gt(t,e,r,n){const{pos:o,box:s}=r,a=t.maxPadding;if(!(0,i.i)(o)){r.size&&(t[o]-=r.size);const e=n[r.stack]||{size:0,count:1};e.size=Math.max(e.size,r.horizontal?s.height:s.width),r.size=e.size/e.count,t[o]+=r.size}s.getPadding&&mt(a,s.getPadding());const l=Math.max(0,e.outerWidth-ft(a,t,"left","right")),c=Math.max(0,e.outerHeight-ft(a,t,"top","bottom")),u=l!==t.w,h=c!==t.h;return t.w=l,t.h=c,r.horizontal?{same:u,other:h}:{same:h,other:u}}function yt(t,e){const r=e.maxPadding;function i(t){const i={left:0,top:0,right:0,bottom:0};return t.forEach((t=>{i[t]=Math.max(e[t],r[t])})),i}return i(t?["left","right"]:["top","bottom"])}function vt(t,e,r,i){const n=[];let o,s,a,l,c,u;for(o=0,s=t.length,c=0;o<s;++o){a=t[o],l=a.box,l.update(a.width||e.w,a.height||e.h,yt(a.horizontal,e));const{same:s,other:h}=gt(e,r,a,i);c|=s&&n.length,u=u||h,l.fullSize||n.push(a)}return c&&vt(n,e,r,i)||u}function _t(t,e,r,i,n){t.top=r,t.left=e,t.right=e+i,t.bottom=r+n,t.width=i,t.height=n}function bt(t,e,r,n){const o=r.padding;let{x:s,y:a}=e;for(const l of t){const t=l.box,c=n[l.stack]||{count:1,placed:0,weight:1},u=l.stackWeight/c.weight||1;if(l.horizontal){const n=e.w*u,s=c.size||t.height;(0,i.j)(c.start)&&(a=c.start),t.fullSize?_t(t,o.left,a,r.outerWidth-o.right-o.left,s):_t(t,e.left+c.placed,a,n,s),c.start=a,c.placed+=n,a=t.bottom}else{const n=e.h*u,a=c.size||t.width;(0,i.j)(c.start)&&(s=c.start),t.fullSize?_t(t,s,o.top,a,r.outerHeight-o.bottom-o.top):_t(t,s,e.top+c.placed,a,n),c.start=s,c.placed+=n,s=t.right}}e.x=s,e.y=a}i.d.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}});var xt={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},t.boxes.push(e)},removeBox(t,e){const r=t.boxes?t.boxes.indexOf(e):-1;-1!==r&&t.boxes.splice(r,1)},configure(t,e,r){e.fullSize=r.fullSize,e.position=r.position,e.weight=r.weight},update(t,e,r,n){if(!t)return;const o=(0,i.K)(t.options.layout.padding),s=Math.max(e-o.width,0),a=Math.max(r-o.height,0),l=function(t){const e=function(t){const e=[];let r,i,n,o,s,a;for(r=0,i=(t||[]).length;r<i;++r)n=t[r],({position:o,options:{stack:s,stackWeight:a=1}}=n),e.push({index:r,box:n,pos:o,horizontal:n.isHorizontal(),weight:n.weight,stack:s&&o+s,stackWeight:a});return e}(t),r=dt(e.filter((t=>t.box.fullSize)),!0),i=dt(ut(e,"left"),!0),n=dt(ut(e,"right")),o=dt(ut(e,"top"),!0),s=dt(ut(e,"bottom")),a=ht(e,"x"),l=ht(e,"y");return{fullSize:r,leftAndTop:i.concat(o),rightAndBottom:n.concat(l).concat(s).concat(a),chartArea:ut(e,"chartArea"),vertical:i.concat(n).concat(l),horizontal:o.concat(s).concat(a)}}(t.boxes),c=l.vertical,u=l.horizontal;(0,i.Q)(t.boxes,(t=>{"function"==typeof t.beforeLayout&&t.beforeLayout()}));const h=c.reduce(((t,e)=>e.box.options&&!1===e.box.options.display?t:t+1),0)||1,d=Object.freeze({outerWidth:e,outerHeight:r,padding:o,availableWidth:s,availableHeight:a,vBoxMaxWidth:s/2/h,hBoxMaxHeight:a/2}),p=Object.assign({},o);mt(p,(0,i.K)(n));const f=Object.assign({maxPadding:p,w:s,h:a,x:o.left,y:o.top},o),m=pt(c.concat(u),d);vt(l.fullSize,f,d,m),vt(c,f,d,m),vt(u,f,d,m)&&vt(c,f,d,m),function(t){const e=t.maxPadding;function r(r){const i=Math.max(e[r]-t[r],0);return t[r]+=i,i}t.y+=r("top"),t.x+=r("left"),r("right"),r("bottom")}(f),bt(l.leftAndTop,f,d,m),f.x+=f.w,f.y+=f.h,bt(l.rightAndBottom,f,d,m),t.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},(0,i.Q)(l.chartArea,(e=>{const r=e.box;Object.assign(r,t.chartArea),r.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})}))}};class wt{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,r){}removeEventListener(t,e,r){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,r,i){return e=Math.max(0,e||t.width),r=r||t.height,{width:e,height:Math.max(0,i?Math.floor(e/i):r)}}isAttached(t){return!0}updateConfig(t){}}class Tt extends wt{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const Et={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},St=t=>null===t||""===t;const Pt=!!i.a5&&{passive:!0};function kt(t,e,r){t.canvas.removeEventListener(e,r,Pt)}function At(t,e){for(const r of t)if(r===e||r.contains(e))return!0}function Mt(t,e,r){const i=t.canvas,n=new MutationObserver((t=>{let e=!1;for(const r of t)e=e||At(r.addedNodes,i),e=e&&!At(r.removedNodes,i);e&&r()}));return n.observe(document,{childList:!0,subtree:!0}),n}function Ct(t,e,r){const i=t.canvas,n=new MutationObserver((t=>{let e=!1;for(const r of t)e=e||At(r.removedNodes,i),e=e&&!At(r.addedNodes,i);e&&r()}));return n.observe(document,{childList:!0,subtree:!0}),n}const It=new Map;let Ot=0;function Lt(){const t=window.devicePixelRatio;t!==Ot&&(Ot=t,It.forEach(((e,r)=>{r.currentDevicePixelRatio!==t&&e()})))}function Dt(t,e,r){const n=t.canvas,o=n&&(0,i.a2)(n);if(!o)return;const s=(0,i.a4)(((t,e)=>{const i=o.clientWidth;r(t,e),i<o.clientWidth&&r()}),window),a=new ResizeObserver((t=>{const e=t[0],r=e.contentRect.width,i=e.contentRect.height;0===r&&0===i||s(r,i)}));return a.observe(o),function(t,e){It.size||window.addEventListener("resize",Lt),It.set(t,e)}(t,s),a}function Rt(t,e,r){r&&r.disconnect(),"resize"===e&&function(t){It.delete(t),It.size||window.removeEventListener("resize",Lt)}(t)}function Ft(t,e,r){const n=t.canvas,o=(0,i.a4)((e=>{null!==t.ctx&&r(function(t,e){const r=Et[t.type]||t.type,{x:n,y:o}=(0,i.X)(t,e);return{type:r,chart:e,native:t,x:void 0!==n?n:null,y:void 0!==o?o:null}}(e,t))}),t,(t=>{const e=t[0];return[e,e.offsetX,e.offsetY]}));return function(t,e,r){t.addEventListener(e,r,Pt)}(n,e,o),o}class Bt extends wt{acquireContext(t,e){const r=t&&t.getContext&&t.getContext("2d");return r&&r.canvas===t?(function(t,e){const r=t.style,n=t.getAttribute("height"),o=t.getAttribute("width");if(t.$chartjs={initial:{height:n,width:o,style:{display:r.display,height:r.height,width:r.width}}},r.display=r.display||"block",r.boxSizing=r.boxSizing||"border-box",St(o)){const e=(0,i.a3)(t,"width");void 0!==e&&(t.width=e)}if(St(n))if(""===t.style.height)t.height=t.width/(e||2);else{const e=(0,i.a3)(t,"height");void 0!==e&&(t.height=e)}}(t,e),r):null}releaseContext(t){const e=t.canvas;if(!e.$chartjs)return!1;const r=e.$chartjs.initial;["height","width"].forEach((t=>{const n=r[t];(0,i.k)(n)?e.removeAttribute(t):e.setAttribute(t,n)}));const n=r.style||{};return Object.keys(n).forEach((t=>{e.style[t]=n[t]})),e.width=e.width,delete e.$chartjs,!0}addEventListener(t,e,r){this.removeEventListener(t,e);const i=t.$proxies||(t.$proxies={}),n={attach:Mt,detach:Ct,resize:Dt}[e]||Ft;i[e]=n(t,e,r)}removeEventListener(t,e){const r=t.$proxies||(t.$proxies={}),i=r[e];if(!i)return;({attach:Rt,detach:Rt,resize:Rt}[e]||kt)(t,e,i),r[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,r,n){return(0,i.a1)(t,e,r,n)}isAttached(t){const e=(0,i.a2)(t);return!(!e||!e.isConnected)}}class zt{constructor(){this._init=[]}notify(t,e,r,i){"beforeInit"===e&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const n=i?this._descriptors(t).filter(i):this._descriptors(t),o=this._notify(n,t,e,r);return"afterDestroy"===e&&(this._notify(n,t,"stop"),this._notify(this._init,t,"uninstall")),o}_notify(t,e,r,n){n=n||{};for(const o of t){const t=o.plugin,s=t[r],a=[e,n,o.options];if(!1===(0,i.C)(s,a,t)&&n.cancelable)return!1}return!0}invalidate(){(0,i.k)(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const r=t&&t.config,n=(0,i.v)(r.options&&r.options.plugins,{}),o=function(t){const e={},r=[],i=Object.keys(Y.plugins.items);for(let t=0;t<i.length;t++)r.push(Y.getPlugin(i[t]));const n=t.plugins||[];for(let t=0;t<n.length;t++){const i=n[t];-1===r.indexOf(i)&&(r.push(i),e[i.id]=!0)}return{plugins:r,localIds:e}}(r);return!1!==n||e?function(t,{plugins:e,localIds:r},i,n){const o=[],s=t.getContext();for(const a of e){const e=a.id,l=jt(i[e],n);null!==l&&o.push({plugin:a,options:Nt(t.config,{plugin:a,local:r[e]},l,s)})}return o}(t,o,n,e):[]}_notifyStateChanges(t){const e=this._oldCache||[],r=this._cache,i=(t,e)=>t.filter((t=>!e.some((e=>t.plugin.id===e.plugin.id))));this._notify(i(e,r),t,"stop"),this._notify(i(r,e),t,"start")}}function jt(t,e){return e||!1!==t?!0===t?{}:t:null}function Nt(t,{plugin:e,local:r},i,n){const o=t.pluginScopeKeys(e),s=t.getOptionScopes(i,o);return r&&e.defaults&&s.push(e.defaults),t.createResolver(s,n,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Vt(t,e){const r=i.d.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||r.indexAxis||"x"}function Ut(t,e){return"x"===t||"y"===t?t:e.axis||("top"===(r=e.position)||"bottom"===r?"x":"left"===r||"right"===r?"y":void 0)||t.charAt(0).toLowerCase();var r}function $t(t){const e=t.options||(t.options={});e.plugins=(0,i.v)(e.plugins,{}),e.scales=function(t,e){const r=i.U[t.type]||{scales:{}},n=e.scales||{},o=Vt(t.type,e),s=Object.create(null),a=Object.create(null);return Object.keys(n).forEach((t=>{const e=n[t];if(!(0,i.i)(e))return console.error(`Invalid scale configuration for scale: ${t}`);if(e._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${t}`);const l=Ut(t,e),c=function(t,e){return t===e?"_index_":"_value_"}(l,o),u=r.scales||{};s[l]=s[l]||t,a[t]=(0,i.ac)(Object.create(null),[{axis:l},e,u[l],u[c]])})),t.data.datasets.forEach((r=>{const o=r.type||t.type,l=r.indexAxis||Vt(o,e),c=(i.U[o]||{}).scales||{};Object.keys(c).forEach((t=>{const e=function(t,e){let r=t;return"_index_"===t?r=e:"_value_"===t&&(r="x"===e?"y":"x"),r}(t,l),o=r[e+"AxisID"]||s[e]||e;a[o]=a[o]||Object.create(null),(0,i.ac)(a[o],[{axis:e},n[o],c[t]])}))})),Object.keys(a).forEach((t=>{const e=a[t];(0,i.ac)(e,[i.d.scales[e.type],i.d.scale])})),a}(t,e)}function Gt(t){return(t=t||{}).datasets=t.datasets||[],t.labels=t.labels||[],t}const Ht=new Map,qt=new Set;function Wt(t,e){let r=Ht.get(t);return r||(r=e(),Ht.set(t,r),qt.add(r)),r}const Zt=(t,e,r)=>{const n=(0,i.f)(e,r);void 0!==n&&t.add(n)};class Xt{constructor(t){this._config=function(t){return(t=t||{}).data=Gt(t.data),$t(t),t}(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=Gt(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),$t(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Wt(t,(()=>[[`datasets.${t}`,""]]))}datasetAnimationScopeKeys(t,e){return Wt(`${t}.transition.${e}`,(()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]]))}datasetElementScopeKeys(t,e){return Wt(`${t}-${e}`,(()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]]))}pluginScopeKeys(t){const e=t.id;return Wt(`${this.type}-plugin-${e}`,(()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]]))}_cachedScopes(t,e){const r=this._scopeCache;let i=r.get(t);return i&&!e||(i=new Map,r.set(t,i)),i}getOptionScopes(t,e,r){const{options:n,type:o}=this,s=this._cachedScopes(t,r),a=s.get(e);if(a)return a;const l=new Set;e.forEach((e=>{t&&(l.add(t),e.forEach((e=>Zt(l,t,e)))),e.forEach((t=>Zt(l,n,t))),e.forEach((t=>Zt(l,i.U[o]||{},t))),e.forEach((t=>Zt(l,i.d,t))),e.forEach((t=>Zt(l,i.a7,t)))}));const c=Array.from(l);return 0===c.length&&c.push(Object.create(null)),qt.has(e)&&s.set(e,c),c}chartOptionScopes(){const{options:t,type:e}=this;return[t,i.U[e]||{},i.d.datasets[e]||{},{type:e},i.d,i.a7]}resolveNamedOptions(t,e,r,n=[""]){const o={$shared:!0},{resolver:s,subPrefixes:a}=Yt(this._resolverCache,t,n);let l=s;if(function(t,e){const{isScriptable:r,isIndexable:n}=(0,i.ab)(t);for(const o of e){const e=r(o),s=n(o),a=(s||e)&&t[o];if(e&&((0,i.a8)(a)||Kt(a))||s&&(0,i.b)(a))return!0}return!1}(s,e)){o.$shared=!1,r=(0,i.a8)(r)?r():r;const e=this.createResolver(t,r,a);l=(0,i.a9)(s,r,e)}for(const t of e)o[t]=l[t];return o}createResolver(t,e,r=[""],n){const{resolver:o}=Yt(this._resolverCache,t,r);return(0,i.i)(e)?(0,i.a9)(o,e,void 0,n):o}}function Yt(t,e,r){let n=t.get(e);n||(n=new Map,t.set(e,n));const o=r.join();let s=n.get(o);if(!s){s={resolver:(0,i.aa)(e,r),subPrefixes:r.filter((t=>!t.toLowerCase().includes("hover")))},n.set(o,s)}return s}const Kt=t=>(0,i.i)(t)&&Object.getOwnPropertyNames(t).reduce(((e,r)=>e||(0,i.a8)(t[r])),!1);const Jt=["top","bottom","left","right","chartArea"];function Qt(t,e){return"top"===t||"bottom"===t||-1===Jt.indexOf(t)&&"x"===e}function te(t,e){return function(r,i){return r[t]===i[t]?r[e]-i[e]:r[t]-i[t]}}function ee(t){const e=t.chart,r=e.options.animation;e.notifyPlugins("afterRender"),(0,i.C)(r&&r.onComplete,[t],e)}function re(t){const e=t.chart,r=e.options.animation;(0,i.C)(r&&r.onProgress,[t],e)}function ie(t){return(0,i.a6)()&&"string"==typeof t?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const ne={},oe=t=>{const e=ie(t);return Object.values(ne).filter((t=>t.canvas===e)).pop()};function se(t,e,r){const i=Object.keys(t);for(const n of i){const i=+n;if(i>=e){const o=t[n];delete t[n],(r>0||i>e)&&(t[i+r]=o)}}}class ae{constructor(t,e){const r=this.config=new Xt(e),o=ie(t),s=oe(o);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const a=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||function(t){return!(0,i.a6)()||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas?Tt:Bt}(o)),this.platform.updateConfig(r);const l=this.platform.acquireContext(o,a.aspectRatio),c=l&&l.canvas,u=c&&c.height,h=c&&c.width;this.id=(0,i.ad)(),this.ctx=l,this.canvas=c,this.width=h,this.height=u,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new zt,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=(0,i.ae)((t=>this.update(t)),a.resizeDelay||0),this._dataChanges=[],ne[this.id]=this,l&&c?(n.listen(this,"complete",ee),n.listen(this,"progress",re),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:r,height:n,_aspectRatio:o}=this;return(0,i.k)(t)?e&&o?o:n?r/n:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():(0,i.af)(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return(0,i.ag)(this.canvas,this.ctx),this}stop(){return n.stop(this),this}resize(t,e){n.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const r=this.options,n=this.canvas,o=r.maintainAspectRatio&&this.aspectRatio,s=this.platform.getMaximumSize(n,t,e,o),a=r.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=s.width,this.height=s.height,this._aspectRatio=this.aspectRatio,(0,i.af)(this,a,!0)&&(this.notifyPlugins("resize",{size:s}),(0,i.C)(r.onResize,[this,s],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};(0,i.Q)(t,((t,e)=>{t.id=e}))}buildOrUpdateScales(){const t=this.options,e=t.scales,r=this.scales,n=Object.keys(r).reduce(((t,e)=>(t[e]=!1,t)),{});let o=[];e&&(o=o.concat(Object.keys(e).map((t=>{const r=e[t],i=Ut(t,r),n="r"===i,o="x"===i;return{options:r,dposition:n?"chartArea":o?"bottom":"left",dtype:n?"radialLinear":o?"category":"linear"}})))),(0,i.Q)(o,(e=>{const o=e.options,s=o.id,a=Ut(s,o),l=(0,i.v)(o.type,e.dtype);void 0!==o.position&&Qt(o.position,a)===Qt(e.dposition)||(o.position=e.dposition),n[s]=!0;let c=null;if(s in r&&r[s].type===l)c=r[s];else{c=new(Y.getScale(l))({id:s,type:l,ctx:this.ctx,chart:this}),r[c.id]=c}c.init(o,t)})),(0,i.Q)(n,((t,e)=>{t||delete r[e]})),(0,i.Q)(r,(t=>{xt.configure(this,t,t.options),xt.addBox(this,t)}))}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,r=t.length;if(t.sort(((t,e)=>t.index-e.index)),r>e){for(let t=e;t<r;++t)this._destroyDatasetMeta(t);t.splice(e,r-e)}this._sortedMetasets=t.slice(0).sort(te("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach(((t,r)=>{0===e.filter((e=>e===t._dataset)).length&&this._destroyDatasetMeta(r)}))}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let r,n;for(this._removeUnreferencedMetasets(),r=0,n=e.length;r<n;r++){const n=e[r];let o=this.getDatasetMeta(r);const s=n.type||this.config.type;if(o.type&&o.type!==s&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=s,o.indexAxis=n.indexAxis||Vt(s,this.options),o.order=n.order||0,o.index=r,o.label=""+n.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const e=Y.getController(s),{datasetElementType:n,dataElementType:a}=i.d.datasets[s];Object.assign(e.prototype,{dataElementType:Y.getElement(a),datasetElementType:n&&Y.getElement(n)}),o.controller=new e(this,r),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){(0,i.Q)(this.data.datasets,((t,e)=>{this.getDatasetMeta(e).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const r=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),n=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0}))return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let s=0;for(let t=0,e=this.data.datasets.length;t<e;t++){const{controller:e}=this.getDatasetMeta(t),r=!n&&-1===o.indexOf(e);e.buildOrUpdateElements(r),s=Math.max(+e.getMaxOverflow(),s)}s=this._minPadding=r.layout.autoPadding?s:0,this._updateLayout(s),n||(0,i.Q)(o,(t=>{t.reset()})),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(te("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){(0,i.Q)(this.scales,(t=>{xt.removeBox(this,t)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),r=new Set(t.events);(0,i.ah)(e,r)&&!!this._responsiveListeners===t.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:r,start:i,count:n}of e){se(t,i,"_removeElements"===r?-n:n)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,r=e=>new Set(t.filter((t=>t[0]===e)).map(((t,e)=>e+","+t.splice(1).join(",")))),n=r(0);for(let t=1;t<e;t++)if(!(0,i.ah)(n,r(t)))return;return Array.from(n).map((t=>t.split(","))).map((t=>({method:t[1],start:+t[2],count:+t[3]})))}_updateLayout(t){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;xt.update(this,this.width,this.height,t);const e=this.chartArea,r=e.width<=0||e.height<=0;this._layers=[],(0,i.Q)(this.boxes,(t=>{r&&"chartArea"===t.position||(t.configure&&t.configure(),this._layers.push(...t._layers()))}),this),this._layers.forEach(((t,e)=>{t._idx=e})),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})){for(let t=0,e=this.data.datasets.length;t<e;++t)this.getDatasetMeta(t).controller.configure();for(let e=0,r=this.data.datasets.length;e<r;++e)this._updateDataset(e,(0,i.a8)(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const r=this.getDatasetMeta(t),i={meta:r,index:t,mode:e,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",i)&&(r.controller._update(e),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(n.has(this)?this.attached&&!n.running(this)&&n.start(this):(this.draw(),ee({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:t,height:e}=this._resizeBeforeDraw;this._resize(t,e),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,r=[];let i,n;for(i=0,n=e.length;i<n;++i){const n=e[i];t&&!n.visible||r.push(n)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,r=t._clip,n=!r.disabled,o=this.chartArea,s={meta:t,index:t.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",s)&&(n&&(0,i.L)(e,{left:!1===r.left?0:o.left-r.left,right:!1===r.right?this.width:o.right+r.right,top:!1===r.top?0:o.top-r.top,bottom:!1===r.bottom?this.height:o.bottom+r.bottom}),t.controller.draw(),n&&(0,i.N)(e),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(t){return(0,i.$)(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,r,i){const n=lt.modes[e];return"function"==typeof n?n(this,t,r,i):[]}getDatasetMeta(t){const e=this.data.datasets[t],r=this._metasets;let i=r.filter((t=>t&&t._dataset===e)).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},r.push(i)),i}getContext(){return this.$context||(this.$context=(0,i.h)(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const r=this.getDatasetMeta(t);return"boolean"==typeof r.hidden?!r.hidden:!e.hidden}setDatasetVisibility(t,e){this.getDatasetMeta(t).hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,r){const n=r?"show":"hide",o=this.getDatasetMeta(t),s=o.controller._resolveAnimations(void 0,n);(0,i.j)(e)?(o.data[e].hidden=!r,this.update()):(this.setDatasetVisibility(t,r),s.update(o,{visible:r}),this.update((e=>e.datasetIndex===t?n:void 0)))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),n.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),(0,i.ag)(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),this.notifyPlugins("destroy"),delete ne[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,r=(r,i)=>{e.addEventListener(this,r,i),t[r]=i},n=(t,e,r)=>{t.offsetX=e,t.offsetY=r,this._eventHandler(t)};(0,i.Q)(this.options.events,(t=>r(t,n)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,r=(r,i)=>{e.addEventListener(this,r,i),t[r]=i},i=(r,i)=>{t[r]&&(e.removeEventListener(this,r,i),delete t[r])},n=(t,e)=>{this.canvas&&this.resize(t,e)};let o;const s=()=>{i("attach",s),this.attached=!0,this.resize(),r("resize",n),r("detach",o)};o=()=>{this.attached=!1,i("resize",n),this._stop(),this._resize(0,0),r("attach",s)},e.isAttached(this.canvas)?s():o()}unbindEvents(){(0,i.Q)(this._listeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._listeners={},(0,i.Q)(this._responsiveListeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._responsiveListeners=void 0}updateHoverStyle(t,e,r){const i=r?"set":"remove";let n,o,s,a;for("dataset"===e&&(n=this.getDatasetMeta(t[0].datasetIndex),n.controller["_"+i+"DatasetHoverStyle"]()),s=0,a=t.length;s<a;++s){o=t[s];const e=o&&this.getDatasetMeta(o.datasetIndex).controller;e&&e[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],r=t.map((({datasetIndex:t,index:e})=>{const r=this.getDatasetMeta(t);if(!r)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:r.data[e],index:e}}));!(0,i.ai)(r,e)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,e))}notifyPlugins(t,e,r){return this._plugins.notify(this,t,e,r)}_updateHoverStyles(t,e,r){const i=this.options.hover,n=(t,e)=>t.filter((t=>!e.some((e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)))),o=n(e,t),s=r?t:n(t,e);o.length&&this.updateHoverStyle(o,i.mode,!1),s.length&&i.mode&&this.updateHoverStyle(s,i.mode,!0)}_eventHandler(t,e){const r={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},i=e=>(e.options.events||this.options.events).includes(t.native.type);if(!1===this.notifyPlugins("beforeEvent",r,i))return;const n=this._handleEvent(t,e,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,i),(n||r.changed)&&this.render(),this}_handleEvent(t,e,r){const{_active:n=[],options:o}=this,s=e,a=this._getActiveElements(t,n,r,s),l=(0,i.aj)(t),c=function(t,e,r,i){return r&&"mouseout"!==t.type?i?e:t:null}(t,this._lastEvent,r,l);r&&(this._lastEvent=null,(0,i.C)(o.onHover,[t,a,this],this),l&&(0,i.C)(o.onClick,[t,a,this],this));const u=!(0,i.ai)(a,n);return(u||e)&&(this._active=a,this._updateHoverStyles(a,n,e)),this._lastEvent=c,u}_getActiveElements(t,e,r,i){if("mouseout"===t.type)return[];if(!r)return e;const n=this.options.hover;return this.getElementsAtEventForMode(t,n.mode,n,i)}}const le=()=>(0,i.Q)(ae.instances,(t=>t._plugins.invalidate())),ce=!0;function ue(t,e,r){const{startAngle:n,pixelMargin:o,x:s,y:a,outerRadius:l,innerRadius:c}=e;let u=o/l;t.beginPath(),t.arc(s,a,l,n-u,r+u),c>o?(u=o/c,t.arc(s,a,c,r+u,n-u,!0)):t.arc(s,a,o,r+i.H,n-i.H),t.closePath(),t.clip()}function he(t,e,r,n){const o=(s=t.options.borderRadius,(0,i.al)(s,["outerStart","outerEnd","innerStart","innerEnd"]));var s;const a=(r-e)/2,l=Math.min(a,n*e/2),c=t=>{const e=(r-Math.min(a,t))*n/2;return(0,i.E)(t,0,Math.min(a,e))};return{outerStart:c(o.outerStart),outerEnd:c(o.outerEnd),innerStart:(0,i.E)(o.innerStart,0,l),innerEnd:(0,i.E)(o.innerEnd,0,l)}}function de(t,e,r,i){return{x:r+t*Math.cos(e),y:i+t*Math.sin(e)}}function pe(t,e,r,n,o,s){const{x:a,y:l,startAngle:c,pixelMargin:u,innerRadius:h}=e,d=Math.max(e.outerRadius+n+r-u,0),p=h>0?h+n+r+u:0;let f=0;const m=o-c;if(n){const t=((h>0?h-n:0)+(d>0?d-n:0))/2;f=(m-(0!==t?m*t/(t+n):m))/2}const g=(m-Math.max(.001,m*d-r/i.P)/d)/2,y=c+g+f,v=o-g-f,{outerStart:_,outerEnd:b,innerStart:x,innerEnd:w}=he(e,p,d,v-y),T=d-_,E=d-b,S=y+_/T,P=v-b/E,k=p+x,A=p+w,M=y+x/k,C=v-w/A;if(t.beginPath(),s){if(t.arc(a,l,d,S,P),b>0){const e=de(E,P,a,l);t.arc(e.x,e.y,b,P,v+i.H)}const e=de(A,v,a,l);if(t.lineTo(e.x,e.y),w>0){const e=de(A,C,a,l);t.arc(e.x,e.y,w,v+i.H,C+Math.PI)}if(t.arc(a,l,p,v-w/p,y+x/p,!0),x>0){const e=de(k,M,a,l);t.arc(e.x,e.y,x,M+Math.PI,y-i.H)}const r=de(T,y,a,l);if(t.lineTo(r.x,r.y),_>0){const e=de(T,S,a,l);t.arc(e.x,e.y,_,y-i.H,S)}}else{t.moveTo(a,l);const e=Math.cos(S)*d+a,r=Math.sin(S)*d+l;t.lineTo(e,r);const i=Math.cos(P)*d+a,n=Math.sin(P)*d+l;t.lineTo(i,n)}t.closePath()}function fe(t,e,r,n,o,s){const{options:a}=e,{borderWidth:l,borderJoinStyle:c}=a,u="inner"===a.borderAlign;l&&(u?(t.lineWidth=2*l,t.lineJoin=c||"round"):(t.lineWidth=l,t.lineJoin=c||"bevel"),e.fullCircles&&function(t,e,r){const{x:n,y:o,startAngle:s,pixelMargin:a,fullCircles:l}=e,c=Math.max(e.outerRadius-a,0),u=e.innerRadius+a;let h;for(r&&ue(t,e,s+i.T),t.beginPath(),t.arc(n,o,u,s+i.T,s,!0),h=0;h<l;++h)t.stroke();for(t.beginPath(),t.arc(n,o,c,s,s+i.T),h=0;h<l;++h)t.stroke()}(t,e,u),u&&ue(t,e,o),pe(t,e,r,n,o,s),t.stroke())}Object.defineProperties(ae,{defaults:{enumerable:ce,value:i.d},instances:{enumerable:ce,value:ne},overrides:{enumerable:ce,value:i.U},registry:{enumerable:ce,value:Y},version:{enumerable:ce,value:"3.9.1"},getChart:{enumerable:ce,value:oe},register:{enumerable:ce,value:(...t)=>{Y.add(...t),le()}},unregister:{enumerable:ce,value:(...t)=>{Y.remove(...t),le()}}});class me extends B{constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,r){const n=this.getProps(["x","y"],r),{angle:o,distance:s}=(0,i.a0)(n,{x:t,y:e}),{startAngle:a,endAngle:l,innerRadius:c,outerRadius:u,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),d=this.options.spacing/2,p=(0,i.v)(h,l-a)>=i.T||(0,i.p)(o,a,l),f=(0,i.ak)(s,c+d,u+d);return p&&f}getCenterPoint(t){const{x:e,y:r,startAngle:i,endAngle:n,innerRadius:o,outerRadius:s}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],t),{offset:a,spacing:l}=this.options,c=(i+n)/2,u=(o+s+l+a)/2;return{x:e+Math.cos(c)*u,y:r+Math.sin(c)*u}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:e,circumference:r}=this,n=(e.offset||0)/2,o=(e.spacing||0)/2,s=e.circular;if(this.pixelMargin="inner"===e.borderAlign?.33:0,this.fullCircles=r>i.T?Math.floor(r/i.T):0,0===r||this.innerRadius<0||this.outerRadius<0)return;t.save();let a=0;if(n){a=n/2;const e=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(e)*a,Math.sin(e)*a),this.circumference>=i.P&&(a=n)}t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor;const l=function(t,e,r,n,o){const{fullCircles:s,startAngle:a,circumference:l}=e;let c=e.endAngle;if(s){pe(t,e,r,n,a+i.T,o);for(let e=0;e<s;++e)t.fill();isNaN(l)||(c=a+l%i.T,l%i.T==0&&(c+=i.T))}return pe(t,e,r,n,c,o),t.fill(),c}(t,this,a,o,s);fe(t,this,a,o,l,s),t.restore()}}function ge(t,e,r=e){t.lineCap=(0,i.v)(r.borderCapStyle,e.borderCapStyle),t.setLineDash((0,i.v)(r.borderDash,e.borderDash)),t.lineDashOffset=(0,i.v)(r.borderDashOffset,e.borderDashOffset),t.lineJoin=(0,i.v)(r.borderJoinStyle,e.borderJoinStyle),t.lineWidth=(0,i.v)(r.borderWidth,e.borderWidth),t.strokeStyle=(0,i.v)(r.borderColor,e.borderColor)}function ye(t,e,r){t.lineTo(r.x,r.y)}function ve(t,e,r={}){const i=t.length,{start:n=0,end:o=i-1}=r,{start:s,end:a}=e,l=Math.max(n,s),c=Math.min(o,a),u=n<s&&o<s||n>a&&o>a;return{count:i,start:l,loop:e.loop,ilen:c<l&&!u?i+c-l:c-l}}function _e(t,e,r,n){const{points:o,options:s}=e,{count:a,start:l,loop:c,ilen:u}=ve(o,r,n),h=function(t){return t.stepped?i.as:t.tension||"monotone"===t.cubicInterpolationMode?i.at:ye}(s);let d,p,f,{move:m=!0,reverse:g}=n||{};for(d=0;d<=u;++d)p=o[(l+(g?u-d:d))%a],p.skip||(m?(t.moveTo(p.x,p.y),m=!1):h(t,f,p,g,s.stepped),f=p);return c&&(p=o[(l+(g?u:0))%a],h(t,f,p,g,s.stepped)),!!c}function be(t,e,r,i){const n=e.points,{count:o,start:s,ilen:a}=ve(n,r,i),{move:l=!0,reverse:c}=i||{};let u,h,d,p,f,m,g=0,y=0;const v=t=>(s+(c?a-t:t))%o,_=()=>{p!==f&&(t.lineTo(g,f),t.lineTo(g,p),t.lineTo(g,m))};for(l&&(h=n[v(0)],t.moveTo(h.x,h.y)),u=0;u<=a;++u){if(h=n[v(u)],h.skip)continue;const e=h.x,r=h.y,i=0|e;i===d?(r<p?p=r:r>f&&(f=r),g=(y*g+e)/++y):(_(),t.lineTo(e,r),d=i,y=0,p=f=r),m=r}_()}function xe(t){const e=t.options,r=e.borderDash&&e.borderDash.length;return!(t._decimated||t._loop||e.tension||"monotone"===e.cubicInterpolationMode||e.stepped||r)?be:_e}me.id="arc",me.defaults={borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0},me.defaultRoutes={backgroundColor:"backgroundColor"};const we="function"==typeof Path2D;function Te(t,e,r,i){we&&!e.options.segment?function(t,e,r,i){let n=e._path;n||(n=e._path=new Path2D,e.path(n,r,i)&&n.closePath()),ge(t,e.options),t.stroke(n)}(t,e,r,i):function(t,e,r,i){const{segments:n,options:o}=e,s=xe(e);for(const a of n)ge(t,o,a.style),t.beginPath(),s(t,e,a,{start:r,end:r+i-1})&&t.closePath(),t.stroke()}(t,e,r,i)}class Ee extends B{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const r=this.options;if((r.tension||"monotone"===r.cubicInterpolationMode)&&!r.stepped&&!this._pointsUpdated){const n=r.spanGaps?this._loop:this._fullLoop;(0,i.am)(this._points,r,t,n,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=(0,i.an)(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,r=t.length;return r&&e[t[r-1].end]}interpolate(t,e){const r=this.options,n=t[e],o=this.points,s=(0,i.ao)(this,{property:e,start:n,end:n});if(!s.length)return;const a=[],l=function(t){return t.stepped?i.ap:t.tension||"monotone"===t.cubicInterpolationMode?i.aq:i.ar}(r);let c,u;for(c=0,u=s.length;c<u;++c){const{start:i,end:u}=s[c],h=o[i],d=o[u];if(h===d){a.push(h);continue}const p=l(h,d,Math.abs((n-h[e])/(d[e]-h[e])),r.stepped);p[e]=t[e],a.push(p)}return 1===a.length?a[0]:a}pathSegment(t,e,r){return xe(this)(t,this,e,r)}path(t,e,r){const i=this.segments,n=xe(this);let o=this._loop;e=e||0,r=r||this.points.length-e;for(const s of i)o&=n(t,this,s,{start:e,end:e+r-1});return!!o}draw(t,e,r,i){const n=this.options||{};(this.points||[]).length&&n.borderWidth&&(t.save(),Te(t,this,r,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function Se(t,e,r,i){const n=t.options,{[r]:o}=t.getProps([r],i);return Math.abs(e-o)<n.radius+n.hitRadius}Ee.id="line",Ee.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0},Ee.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"},Ee.descriptors={_scriptable:!0,_indexable:t=>"borderDash"!==t&&"fill"!==t};class Pe extends B{constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,r){const i=this.options,{x:n,y:o}=this.getProps(["x","y"],r);return Math.pow(t-n,2)+Math.pow(e-o,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(t,e){return Se(this,t,"x",e)}inYRange(t,e){return Se(this,t,"y",e)}getCenterPoint(t){const{x:e,y:r}=this.getProps(["x","y"],t);return{x:e,y:r}}size(t){let e=(t=t||this.options||{}).radius||0;e=Math.max(e,e&&t.hoverRadius||0);return 2*(e+(e&&t.borderWidth||0))}draw(t,e){const r=this.options;this.skip||r.radius<.1||!(0,i.$)(this,e,this.size(r)/2)||(t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.fillStyle=r.backgroundColor,(0,i.au)(t,r,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function ke(t,e){const{x:r,y:i,base:n,width:o,height:s}=t.getProps(["x","y","base","width","height"],e);let a,l,c,u,h;return t.horizontal?(h=s/2,a=Math.min(r,n),l=Math.max(r,n),c=i-h,u=i+h):(h=o/2,a=r-h,l=r+h,c=Math.min(i,n),u=Math.max(i,n)),{left:a,top:c,right:l,bottom:u}}function Ae(t,e,r,n){return t?0:(0,i.E)(e,r,n)}function Me(t){const e=ke(t),r=e.right-e.left,n=e.bottom-e.top,o=function(t,e,r){const n=t.options.borderWidth,o=t.borderSkipped,s=(0,i.aw)(n);return{t:Ae(o.top,s.top,0,r),r:Ae(o.right,s.right,0,e),b:Ae(o.bottom,s.bottom,0,r),l:Ae(o.left,s.left,0,e)}}(t,r/2,n/2),s=function(t,e,r){const{enableBorderRadius:n}=t.getProps(["enableBorderRadius"]),o=t.options.borderRadius,s=(0,i.ax)(o),a=Math.min(e,r),l=t.borderSkipped,c=n||(0,i.i)(o);return{topLeft:Ae(!c||l.top||l.left,s.topLeft,0,a),topRight:Ae(!c||l.top||l.right,s.topRight,0,a),bottomLeft:Ae(!c||l.bottom||l.left,s.bottomLeft,0,a),bottomRight:Ae(!c||l.bottom||l.right,s.bottomRight,0,a)}}(t,r/2,n/2);return{outer:{x:e.left,y:e.top,w:r,h:n,radius:s},inner:{x:e.left+o.l,y:e.top+o.t,w:r-o.l-o.r,h:n-o.t-o.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(o.t,o.l)),topRight:Math.max(0,s.topRight-Math.max(o.t,o.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(o.b,o.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(o.b,o.r))}}}}function Ce(t,e,r,n){const o=null===e,s=null===r,a=t&&!(o&&s)&&ke(t,n);return a&&(o||(0,i.ak)(e,a.left,a.right))&&(s||(0,i.ak)(r,a.top,a.bottom))}function Ie(t,e){t.rect(e.x,e.y,e.w,e.h)}function Oe(t,e,r={}){const i=t.x!==r.x?-e:0,n=t.y!==r.y?-e:0,o=(t.x+t.w!==r.x+r.w?e:0)-i,s=(t.y+t.h!==r.y+r.h?e:0)-n;return{x:t.x+i,y:t.y+n,w:t.w+o,h:t.h+s,radius:t.radius}}Pe.id="point",Pe.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0},Pe.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};class Le extends B{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:r,backgroundColor:n}}=this,{inner:o,outer:s}=Me(this),a=(l=s.radius).topLeft||l.topRight||l.bottomLeft||l.bottomRight?i.av:Ie;var l;t.save(),s.w===o.w&&s.h===o.h||(t.beginPath(),a(t,Oe(s,e,o)),t.clip(),a(t,Oe(o,-e,s)),t.fillStyle=r,t.fill("evenodd")),t.beginPath(),a(t,Oe(o,e)),t.fillStyle=n,t.fill(),t.restore()}inRange(t,e,r){return Ce(this,t,e,r)}inXRange(t,e){return Ce(this,t,null,e)}inYRange(t,e){return Ce(this,null,t,e)}getCenterPoint(t){const{x:e,y:r,base:i,horizontal:n}=this.getProps(["x","y","base","horizontal"],t);return{x:n?(e+i)/2:e,y:n?r:(r+i)/2}}getRange(t){return"x"===t?this.width/2:this.height/2}}Le.id="bar",Le.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0},Le.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};var De=Object.freeze({__proto__:null,ArcElement:me,LineElement:Ee,PointElement:Pe,BarElement:Le});function Re(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{value:e})}}function Fe(t){t.data.datasets.forEach((t=>{Re(t)}))}var Be={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,r)=>{if(!r.enabled)return void Fe(t);const n=t.width;t.data.datasets.forEach(((e,o)=>{const{_data:s,indexAxis:a}=e,l=t.getDatasetMeta(o),c=s||e.data;if("y"===(0,i.a)([a,t.options.indexAxis]))return;if(!l.controller.supportsDecimation)return;const u=t.scales[l.xAxisID];if("linear"!==u.type&&"time"!==u.type)return;if(t.options.parsing)return;let{start:h,count:d}=function(t,e){const r=e.length;let n,o=0;const{iScale:s}=t,{min:a,max:l,minDefined:c,maxDefined:u}=s.getUserBounds();return c&&(o=(0,i.E)((0,i.Z)(e,s.axis,a).lo,0,r-1)),n=u?(0,i.E)((0,i.Z)(e,s.axis,l).hi+1,o,r)-o:r-o,{start:o,count:n}}(l,c);if(d<=(r.threshold||4*n))return void Re(e);let p;switch((0,i.k)(s)&&(e._data=c,delete e.data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(t){this._data=t}})),r.algorithm){case"lttb":p=function(t,e,r,i,n){const o=n.samples||i;if(o>=r)return t.slice(e,e+r);const s=[],a=(r-2)/(o-2);let l=0;const c=e+r-1;let u,h,d,p,f,m=e;for(s[l++]=t[m],u=0;u<o-2;u++){let i,n=0,o=0;const c=Math.floor((u+1)*a)+1+e,g=Math.min(Math.floor((u+2)*a)+1,r)+e,y=g-c;for(i=c;i<g;i++)n+=t[i].x,o+=t[i].y;n/=y,o/=y;const v=Math.floor(u*a)+1+e,_=Math.min(Math.floor((u+1)*a)+1,r)+e,{x:b,y:x}=t[m];for(d=p=-1,i=v;i<_;i++)p=.5*Math.abs((b-n)*(t[i].y-x)-(b-t[i].x)*(o-x)),p>d&&(d=p,h=t[i],f=i);s[l++]=h,m=f}return s[l++]=t[c],s}(c,h,d,n,r);break;case"min-max":p=function(t,e,r,n){let o,s,a,l,c,u,h,d,p,f,m=0,g=0;const y=[],v=e+r-1,_=t[e].x,b=t[v].x-_;for(o=e;o<e+r;++o){s=t[o],a=(s.x-_)/b*n,l=s.y;const e=0|a;if(e===c)l<p?(p=l,u=o):l>f&&(f=l,h=o),m=(g*m+s.x)/++g;else{const r=o-1;if(!(0,i.k)(u)&&!(0,i.k)(h)){const e=Math.min(u,h),i=Math.max(u,h);e!==d&&e!==r&&y.push({...t[e],x:m}),i!==d&&i!==r&&y.push({...t[i],x:m})}o>0&&r!==d&&y.push(t[r]),y.push(s),c=e,g=0,p=f=l,u=h=d=o}}return y}(c,h,d,n);break;default:throw new Error(`Unsupported decimation algorithm '${r.algorithm}'`)}e._decimated=p}))},destroy(t){Fe(t)}};function ze(t,e,r,n){if(n)return;let o=e[t],s=r[t];return"angle"===t&&(o=(0,i.az)(o),s=(0,i.az)(s)),{property:t,start:o,end:s}}function je(t,e,r){for(;e>t;e--){const t=r[e];if(!isNaN(t.x)&&!isNaN(t.y))break}return e}function Ne(t,e,r,i){return t&&e?i(t[r],e[r]):t?t[r]:e?e[r]:0}function Ve(t,e){let r=[],n=!1;return(0,i.b)(t)?(n=!0,r=t):r=function(t,e){const{x:r=null,y:i=null}=t||{},n=e.points,o=[];return e.segments.forEach((({start:t,end:e})=>{e=je(t,e,n);const s=n[t],a=n[e];null!==i?(o.push({x:s.x,y:i}),o.push({x:a.x,y:i})):null!==r&&(o.push({x:r,y:s.y}),o.push({x:r,y:a.y}))})),o}(t,e),r.length?new Ee({points:r,options:{tension:0},_loop:n,_fullLoop:n}):null}function Ue(t){return t&&!1!==t.fill}function $e(t,e,r){let n=t[e].fill;const o=[e];let s;if(!r)return n;for(;!1!==n&&-1===o.indexOf(n);){if(!(0,i.g)(n))return n;if(s=t[n],!s)return!1;if(s.visible)return n;o.push(n),n=s.fill}return!1}function Ge(t,e,r){const n=function(t){const e=t.options,r=e.fill;let n=(0,i.v)(r&&r.target,r);void 0===n&&(n=!!e.backgroundColor);if(!1===n||null===n)return!1;if(!0===n)return"origin";return n}(t);if((0,i.i)(n))return!isNaN(n.value)&&n;let o=parseFloat(n);return(0,i.g)(o)&&Math.floor(o)===o?function(t,e,r,i){"-"!==t&&"+"!==t||(r=e+r);if(r===e||r<0||r>=i)return!1;return r}(n[0],e,o,r):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function He(t,e,r){const i=[];for(let n=0;n<r.length;n++){const o=r[n],{first:s,last:a,point:l}=qe(o,e,"x");if(!(!l||s&&a))if(s)i.unshift(l);else if(t.push(l),!a)break}t.push(...i)}function qe(t,e,r){const n=t.interpolate(e,r);if(!n)return{};const o=n[r],s=t.segments,a=t.points;let l=!1,c=!1;for(let t=0;t<s.length;t++){const e=s[t],n=a[e.start][r],u=a[e.end][r];if((0,i.ak)(o,n,u)){l=o===n,c=o===u;break}}return{first:l,last:c,point:n}}class We{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,r){const{x:n,y:o,radius:s}=this;return e=e||{start:0,end:i.T},t.arc(n,o,s,e.end,e.start,!0),!r.bounds}interpolate(t){const{x:e,y:r,radius:i}=this,n=t.angle;return{x:e+Math.cos(n)*i,y:r+Math.sin(n)*i,angle:n}}}function Ze(t){const{chart:e,fill:r,line:n}=t;if((0,i.g)(r))return function(t,e){const r=t.getDatasetMeta(e);return r&&t.isDatasetVisible(e)?r.dataset:null}(e,r);if("stack"===r)return function(t){const{scale:e,index:r,line:i}=t,n=[],o=i.segments,s=i.points,a=function(t,e){const r=[],i=t.getMatchingVisibleMetas("line");for(let t=0;t<i.length;t++){const n=i[t];if(n.index===e)break;n.hidden||r.unshift(n.dataset)}return r}(e,r);a.push(Ve({x:null,y:e.bottom},i));for(let t=0;t<o.length;t++){const e=o[t];for(let t=e.start;t<=e.end;t++)He(n,s[t],a)}return new Ee({points:n,options:{}})}(t);if("shape"===r)return!0;const o=function(t){if((t.scale||{}).getPointPositionForValue)return function(t){const{scale:e,fill:r}=t,n=e.options,o=e.getLabels().length,s=n.reverse?e.max:e.min,a=function(t,e,r){let n;return n="start"===t?r:"end"===t?e.options.reverse?e.min:e.max:(0,i.i)(t)?t.value:e.getBaseValue(),n}(r,e,s),l=[];if(n.grid.circular){const t=e.getPointPositionForValue(0,s);return new We({x:t.x,y:t.y,radius:e.getDistanceFromCenterForValue(a)})}for(let t=0;t<o;++t)l.push(e.getPointPositionForValue(t,a));return l}(t);return function(t){const{scale:e={},fill:r}=t,n=function(t,e){let r=null;return"start"===t?r=e.bottom:"end"===t?r=e.top:(0,i.i)(t)?r=e.getPixelForValue(t.value):e.getBasePixel&&(r=e.getBasePixel()),r}(r,e);if((0,i.g)(n)){const t=e.isHorizontal();return{x:t?n:null,y:t?null:n}}return null}(t)}(t);return o instanceof We?o:Ve(o,n)}function Xe(t,e,r){const n=Ze(e),{line:o,scale:s,axis:a}=e,l=o.options,c=l.fill,u=l.backgroundColor,{above:h=u,below:d=u}=c||{};n&&o.points.length&&((0,i.L)(t,r),function(t,e){const{line:r,target:i,above:n,below:o,area:s,scale:a}=e,l=r._loop?"angle":e.axis;t.save(),"x"===l&&o!==n&&(Ye(t,i,s.top),Ke(t,{line:r,target:i,color:n,scale:a,property:l}),t.restore(),t.save(),Ye(t,i,s.bottom));Ke(t,{line:r,target:i,color:o,scale:a,property:l}),t.restore()}(t,{line:o,target:n,above:h,below:d,area:r,scale:s,axis:a}),(0,i.N)(t))}function Ye(t,e,r){const{segments:i,points:n}=e;let o=!0,s=!1;t.beginPath();for(const a of i){const{start:i,end:l}=a,c=n[i],u=n[je(i,l,n)];o?(t.moveTo(c.x,c.y),o=!1):(t.lineTo(c.x,r),t.lineTo(c.x,c.y)),s=!!e.pathSegment(t,a,{move:s}),s?t.closePath():t.lineTo(u.x,r)}t.lineTo(e.first().x,r),t.closePath(),t.clip()}function Ke(t,e){const{line:r,target:n,property:o,color:s,scale:a}=e,l=function(t,e,r){const n=t.segments,o=t.points,s=e.points,a=[];for(const t of n){let{start:n,end:l}=t;l=je(n,l,o);const c=ze(r,o[n],o[l],t.loop);if(!e.segments){a.push({source:t,target:c,start:o[n],end:o[l]});continue}const u=(0,i.ao)(e,c);for(const e of u){const n=ze(r,s[e.start],s[e.end],e.loop),l=(0,i.ay)(t,o,n);for(const t of l)a.push({source:t,target:e,start:{[r]:Ne(c,n,"start",Math.max)},end:{[r]:Ne(c,n,"end",Math.min)}})}}return a}(r,n,o);for(const{source:e,target:i,start:c,end:u}of l){const{style:{backgroundColor:l=s}={}}=e,h=!0!==n;t.save(),t.fillStyle=l,Je(t,a,h&&ze(o,c,u)),t.beginPath();const d=!!r.pathSegment(t,e);let p;if(h){d?t.closePath():Qe(t,n,u,o);const e=!!n.pathSegment(t,i,{move:d,reverse:!0});p=d&&e,p||Qe(t,n,c,o)}t.closePath(),t.fill(p?"evenodd":"nonzero"),t.restore()}}function Je(t,e,r){const{top:i,bottom:n}=e.chart.chartArea,{property:o,start:s,end:a}=r||{};"x"===o&&(t.beginPath(),t.rect(s,i,a-s,n-i),t.clip())}function Qe(t,e,r,i){const n=e.interpolate(r,i);n&&t.lineTo(n.x,n.y)}var tr={id:"filler",afterDatasetsUpdate(t,e,r){const i=(t.data.datasets||[]).length,n=[];let o,s,a,l;for(s=0;s<i;++s)o=t.getDatasetMeta(s),a=o.dataset,l=null,a&&a.options&&a instanceof Ee&&(l={visible:t.isDatasetVisible(s),index:s,fill:Ge(a,s,i),chart:t,axis:o.controller.options.indexAxis,scale:o.vScale,line:a}),o.$filler=l,n.push(l);for(s=0;s<i;++s)l=n[s],l&&!1!==l.fill&&(l.fill=$e(n,s,r.propagate))},beforeDraw(t,e,r){const i="beforeDraw"===r.drawTime,n=t.getSortedVisibleDatasetMetas(),o=t.chartArea;for(let e=n.length-1;e>=0;--e){const r=n[e].$filler;r&&(r.line.updateControlPoints(o,r.axis),i&&r.fill&&Xe(t.ctx,r,o))}},beforeDatasetsDraw(t,e,r){if("beforeDatasetsDraw"!==r.drawTime)return;const i=t.getSortedVisibleDatasetMetas();for(let e=i.length-1;e>=0;--e){const r=i[e].$filler;Ue(r)&&Xe(t.ctx,r,t.chartArea)}},beforeDatasetDraw(t,e,r){const i=e.meta.$filler;Ue(i)&&"beforeDatasetDraw"===r.drawTime&&Xe(t.ctx,i,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const er=(t,e)=>{let{boxHeight:r=e,boxWidth:i=e}=t;return t.usePointStyle&&(r=Math.min(r,e),i=t.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:r,itemHeight:Math.max(e,r)}};class rr extends B{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,r){this.maxWidth=t,this.maxHeight=e,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=(0,i.C)(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter((e=>t.filter(e,this.chart.data)))),t.sort&&(e=e.sort(((e,r)=>t.sort(e,r,this.chart.data)))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display)return void(this.width=this.height=0);const r=t.labels,n=(0,i.O)(r.font),o=n.size,s=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=er(r,o);let c,u;e.font=n.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(s,o,a,l)+10):(u=this.maxHeight,c=this._fitCols(s,o,a,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(u,t.maxHeight||this.maxHeight)}_fitRows(t,e,r,i){const{ctx:n,maxWidth:o,options:{labels:{padding:s}}}=this,a=this.legendHitBoxes=[],l=this.lineWidths=[0],c=i+s;let u=t;n.textAlign="left",n.textBaseline="middle";let h=-1,d=-c;return this.legendItems.forEach(((t,p)=>{const f=r+e/2+n.measureText(t.text).width;(0===p||l[l.length-1]+f+2*s>o)&&(u+=c,l[l.length-(p>0?0:1)]=0,d+=c,h++),a[p]={left:0,top:d,row:h,width:f,height:i},l[l.length-1]+=f+s})),u}_fitCols(t,e,r,i){const{ctx:n,maxHeight:o,options:{labels:{padding:s}}}=this,a=this.legendHitBoxes=[],l=this.columnSizes=[],c=o-t;let u=s,h=0,d=0,p=0,f=0;return this.legendItems.forEach(((t,o)=>{const m=r+e/2+n.measureText(t.text).width;o>0&&d+i+2*s>c&&(u+=h+s,l.push({width:h,height:d}),p+=h+s,f++,h=d=0),a[o]={left:p,top:d,col:f,width:m,height:i},h=Math.max(h,m),d+=i+s})),u+=h,l.push({width:h,height:d}),u}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:r,labels:{padding:n},rtl:o}}=this,s=(0,i.aA)(o,this.left,this.width);if(this.isHorizontal()){let o=0,a=(0,i.S)(r,this.left+n,this.right-this.lineWidths[o]);for(const l of e)o!==l.row&&(o=l.row,a=(0,i.S)(r,this.left+n,this.right-this.lineWidths[o])),l.top+=this.top+t+n,l.left=s.leftForLtr(s.x(a),l.width),a+=l.width+n}else{let o=0,a=(0,i.S)(r,this.top+t+n,this.bottom-this.columnSizes[o].height);for(const l of e)l.col!==o&&(o=l.col,a=(0,i.S)(r,this.top+t+n,this.bottom-this.columnSizes[o].height)),l.top=a,l.left+=this.left+n,l.left=s.leftForLtr(s.x(l.left),l.width),a+=l.height+n}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const t=this.ctx;(0,i.L)(t,this),this._draw(),(0,i.N)(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:r,ctx:n}=this,{align:o,labels:s}=t,a=i.d.color,l=(0,i.aA)(t.rtl,this.left,this.width),c=(0,i.O)(s.font),{color:u,padding:h}=s,d=c.size,p=d/2;let f;this.drawTitle(),n.textAlign=l.textAlign("left"),n.textBaseline="middle",n.lineWidth=.5,n.font=c.string;const{boxWidth:m,boxHeight:g,itemHeight:y}=er(s,d),v=this.isHorizontal(),_=this._computeTitleHeight();f=v?{x:(0,i.S)(o,this.left+h,this.right-r[0]),y:this.top+h+_,line:0}:{x:this.left+h,y:(0,i.S)(o,this.top+_+h,this.bottom-e[0].height),line:0},(0,i.aB)(this.ctx,t.textDirection);const b=y+h;this.legendItems.forEach(((x,w)=>{n.strokeStyle=x.fontColor||u,n.fillStyle=x.fontColor||u;const T=n.measureText(x.text).width,E=l.textAlign(x.textAlign||(x.textAlign=s.textAlign)),S=m+p+T;let P=f.x,k=f.y;l.setWidth(this.width),v?w>0&&P+S+h>this.right&&(k=f.y+=b,f.line++,P=f.x=(0,i.S)(o,this.left+h,this.right-r[f.line])):w>0&&k+b>this.bottom&&(P=f.x=P+e[f.line].width+h,f.line++,k=f.y=(0,i.S)(o,this.top+_+h,this.bottom-e[f.line].height));!function(t,e,r){if(isNaN(m)||m<=0||isNaN(g)||g<0)return;n.save();const o=(0,i.v)(r.lineWidth,1);if(n.fillStyle=(0,i.v)(r.fillStyle,a),n.lineCap=(0,i.v)(r.lineCap,"butt"),n.lineDashOffset=(0,i.v)(r.lineDashOffset,0),n.lineJoin=(0,i.v)(r.lineJoin,"miter"),n.lineWidth=o,n.strokeStyle=(0,i.v)(r.strokeStyle,a),n.setLineDash((0,i.v)(r.lineDash,[])),s.usePointStyle){const a={radius:g*Math.SQRT2/2,pointStyle:r.pointStyle,rotation:r.rotation,borderWidth:o},c=l.xPlus(t,m/2),u=e+p;(0,i.aE)(n,a,c,u,s.pointStyleWidth&&m)}else{const s=e+Math.max((d-g)/2,0),a=l.leftForLtr(t,m),c=(0,i.ax)(r.borderRadius);n.beginPath(),Object.values(c).some((t=>0!==t))?(0,i.av)(n,{x:a,y:s,w:m,h:g,radius:c}):n.rect(a,s,m,g),n.fill(),0!==o&&n.stroke()}n.restore()}(l.x(P),k,x),P=(0,i.aC)(E,P+m+p,v?P+S:this.right,t.rtl),function(t,e,r){(0,i.M)(n,r.text,t,e+y/2,c,{strikethrough:r.hidden,textAlign:l.textAlign(r.textAlign)})}(l.x(P),k,x),v?f.x+=S+h:f.y+=b})),(0,i.aD)(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,r=(0,i.O)(e.font),n=(0,i.K)(e.padding);if(!e.display)return;const o=(0,i.aA)(t.rtl,this.left,this.width),s=this.ctx,a=e.position,l=r.size/2,c=n.top+l;let u,h=this.left,d=this.width;if(this.isHorizontal())d=Math.max(...this.lineWidths),u=this.top+c,h=(0,i.S)(t.align,h,this.right-d);else{const e=this.columnSizes.reduce(((t,e)=>Math.max(t,e.height)),0);u=c+(0,i.S)(t.align,this.top,this.bottom-e-t.labels.padding-this._computeTitleHeight())}const p=(0,i.S)(a,h,h+d);s.textAlign=o.textAlign((0,i.R)(a)),s.textBaseline="middle",s.strokeStyle=e.color,s.fillStyle=e.color,s.font=r.string,(0,i.M)(s,e.text,p,u,r)}_computeTitleHeight(){const t=this.options.title,e=(0,i.O)(t.font),r=(0,i.K)(t.padding);return t.display?e.lineHeight+r.height:0}_getLegendItemAt(t,e){let r,n,o;if((0,i.ak)(t,this.left,this.right)&&(0,i.ak)(e,this.top,this.bottom))for(o=this.legendHitBoxes,r=0;r<o.length;++r)if(n=o[r],(0,i.ak)(t,n.left,n.left+n.width)&&(0,i.ak)(e,n.top,n.top+n.height))return this.legendItems[r];return null}handleEvent(t){const e=this.options;if(!function(t,e){if(("mousemove"===t||"mouseout"===t)&&(e.onHover||e.onLeave))return!0;if(e.onClick&&("click"===t||"mouseup"===t))return!0;return!1}(t.type,e))return;const r=this._getLegendItemAt(t.x,t.y);if("mousemove"===t.type||"mouseout"===t.type){const s=this._hoveredItem,a=(o=r,null!==(n=s)&&null!==o&&n.datasetIndex===o.datasetIndex&&n.index===o.index);s&&!a&&(0,i.C)(e.onLeave,[t,s,this],this),this._hoveredItem=r,r&&!a&&(0,i.C)(e.onHover,[t,r,this],this)}else r&&(0,i.C)(e.onClick,[t,r,this],this);var n,o}}var ir={id:"legend",_element:rr,start(t,e,r){const i=t.legend=new rr({ctx:t.ctx,options:r,chart:t});xt.configure(t,i,r),xt.addBox(t,i)},stop(t){xt.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,r){const i=t.legend;xt.configure(t,i,r),i.options=r},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,r){const i=e.datasetIndex,n=r.chart;n.isDatasetVisible(i)?(n.hide(i),e.hidden=!0):(n.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:r,pointStyle:n,textAlign:o,color:s}}=t.legend.options;return t._getSortedDatasetMetas().map((t=>{const a=t.controller.getStyle(r?0:void 0),l=(0,i.K)(a.borderWidth);return{text:e[t.index].label,fillStyle:a.backgroundColor,fontColor:s,hidden:!t.visible,lineCap:a.borderCapStyle,lineDash:a.borderDash,lineDashOffset:a.borderDashOffset,lineJoin:a.borderJoinStyle,lineWidth:(l.width+l.height)/4,strokeStyle:a.borderColor,pointStyle:n||a.pointStyle,rotation:a.rotation,textAlign:o||a.textAlign,borderRadius:0,datasetIndex:t.index}}),this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class nr extends B{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const r=this.options;if(this.left=0,this.top=0,!r.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=t,this.height=this.bottom=e;const n=(0,i.b)(r.text)?r.text.length:1;this._padding=(0,i.K)(r.padding);const o=n*(0,i.O)(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=o:this.width=o}isHorizontal(){const t=this.options.position;return"top"===t||"bottom"===t}_drawArgs(t){const{top:e,left:r,bottom:n,right:o,options:s}=this,a=s.align;let l,c,u,h=0;return this.isHorizontal()?(c=(0,i.S)(a,r,o),u=e+t,l=o-r):("left"===s.position?(c=r+t,u=(0,i.S)(a,n,e),h=-.5*i.P):(c=o-t,u=(0,i.S)(a,e,n),h=.5*i.P),l=n-e),{titleX:c,titleY:u,maxWidth:l,rotation:h}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const r=(0,i.O)(e.font),n=r.lineHeight/2+this._padding.top,{titleX:o,titleY:s,maxWidth:a,rotation:l}=this._drawArgs(n);(0,i.M)(t,e.text,0,0,r,{color:e.color,maxWidth:a,rotation:l,textAlign:(0,i.R)(e.align),textBaseline:"middle",translation:[o,s]})}}var or={id:"title",_element:nr,start(t,e,r){!function(t,e){const r=new nr({ctx:t.ctx,options:e,chart:t});xt.configure(t,r,e),xt.addBox(t,r),t.titleBlock=r}(t,r)},stop(t){const e=t.titleBlock;xt.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,r){const i=t.titleBlock;xt.configure(t,i,r),i.options=r},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const sr=new WeakMap;var ar={id:"subtitle",start(t,e,r){const i=new nr({ctx:t.ctx,options:r,chart:t});xt.configure(t,i,r),xt.addBox(t,i),sr.set(t,i)},stop(t){xt.removeBox(t,sr.get(t)),sr.delete(t)},beforeUpdate(t,e,r){const i=sr.get(t);xt.configure(t,i,r),i.options=r},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const lr={average(t){if(!t.length)return!1;let e,r,i=0,n=0,o=0;for(e=0,r=t.length;e<r;++e){const r=t[e].element;if(r&&r.hasValue()){const t=r.tooltipPosition();i+=t.x,n+=t.y,++o}}return{x:i/o,y:n/o}},nearest(t,e){if(!t.length)return!1;let r,n,o,s=e.x,a=e.y,l=Number.POSITIVE_INFINITY;for(r=0,n=t.length;r<n;++r){const n=t[r].element;if(n&&n.hasValue()){const t=n.getCenterPoint(),r=(0,i.aG)(e,t);r<l&&(l=r,o=n)}}if(o){const t=o.tooltipPosition();s=t.x,a=t.y}return{x:s,y:a}}};function cr(t,e){return e&&((0,i.b)(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function ur(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function hr(t,e){const{element:r,datasetIndex:i,index:n}=e,o=t.getDatasetMeta(i).controller,{label:s,value:a}=o.getLabelAndValue(n);return{chart:t,label:s,parsed:o.getParsed(n),raw:t.data.datasets[i].data[n],formattedValue:a,dataset:o.getDataset(),dataIndex:n,datasetIndex:i,element:r}}function dr(t,e){const r=t.chart.ctx,{body:n,footer:o,title:s}=t,{boxWidth:a,boxHeight:l}=e,c=(0,i.O)(e.bodyFont),u=(0,i.O)(e.titleFont),h=(0,i.O)(e.footerFont),d=s.length,p=o.length,f=n.length,m=(0,i.K)(e.padding);let g=m.height,y=0,v=n.reduce(((t,e)=>t+e.before.length+e.lines.length+e.after.length),0);if(v+=t.beforeBody.length+t.afterBody.length,d&&(g+=d*u.lineHeight+(d-1)*e.titleSpacing+e.titleMarginBottom),v){g+=f*(e.displayColors?Math.max(l,c.lineHeight):c.lineHeight)+(v-f)*c.lineHeight+(v-1)*e.bodySpacing}p&&(g+=e.footerMarginTop+p*h.lineHeight+(p-1)*e.footerSpacing);let _=0;const b=function(t){y=Math.max(y,r.measureText(t).width+_)};return r.save(),r.font=u.string,(0,i.Q)(t.title,b),r.font=c.string,(0,i.Q)(t.beforeBody.concat(t.afterBody),b),_=e.displayColors?a+2+e.boxPadding:0,(0,i.Q)(n,(t=>{(0,i.Q)(t.before,b),(0,i.Q)(t.lines,b),(0,i.Q)(t.after,b)})),_=0,r.font=h.string,(0,i.Q)(t.footer,b),r.restore(),y+=m.width,{width:y,height:g}}function pr(t,e,r,i){const{x:n,width:o}=r,{width:s,chartArea:{left:a,right:l}}=t;let c="center";return"center"===i?c=n<=(a+l)/2?"left":"right":n<=o/2?c="left":n>=s-o/2&&(c="right"),function(t,e,r,i){const{x:n,width:o}=i,s=r.caretSize+r.caretPadding;return"left"===t&&n+o+s>e.width||"right"===t&&n-o-s<0||void 0}(c,t,e,r)&&(c="center"),c}function fr(t,e,r){const i=r.yAlign||e.yAlign||function(t,e){const{y:r,height:i}=e;return r<i/2?"top":r>t.height-i/2?"bottom":"center"}(t,r);return{xAlign:r.xAlign||e.xAlign||pr(t,e,r,i),yAlign:i}}function mr(t,e,r,n){const{caretSize:o,caretPadding:s,cornerRadius:a}=t,{xAlign:l,yAlign:c}=r,u=o+s,{topLeft:h,topRight:d,bottomLeft:p,bottomRight:f}=(0,i.ax)(a);let m=function(t,e){let{x:r,width:i}=t;return"right"===e?r-=i:"center"===e&&(r-=i/2),r}(e,l);const g=function(t,e,r){let{y:i,height:n}=t;return"top"===e?i+=r:i-="bottom"===e?n+r:n/2,i}(e,c,u);return"center"===c?"left"===l?m+=u:"right"===l&&(m-=u):"left"===l?m-=Math.max(h,p)+o:"right"===l&&(m+=Math.max(d,f)+o),{x:(0,i.E)(m,0,n.width-e.width),y:(0,i.E)(g,0,n.height-e.height)}}function gr(t,e,r){const n=(0,i.K)(r.padding);return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-n.right:t.x+n.left}function yr(t){return cr([],ur(t))}function vr(t,e){const r=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return r?t.override(r):t}class _r extends B{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart||t._chart,this._chart=this.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,r=this.options.setContext(this.getContext()),i=r.enabled&&e.options.animation&&r.animations,n=new c(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(n)),n}getContext(){return this.$context||(this.$context=function(t,e,r){return(0,i.h)(t,{tooltip:e,tooltipItems:r,type:"tooltip"})}(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:r}=e,i=r.beforeTitle.apply(this,[t]),n=r.title.apply(this,[t]),o=r.afterTitle.apply(this,[t]);let s=[];return s=cr(s,ur(i)),s=cr(s,ur(n)),s=cr(s,ur(o)),s}getBeforeBody(t,e){return yr(e.callbacks.beforeBody.apply(this,[t]))}getBody(t,e){const{callbacks:r}=e,n=[];return(0,i.Q)(t,(t=>{const e={before:[],lines:[],after:[]},i=vr(r,t);cr(e.before,ur(i.beforeLabel.call(this,t))),cr(e.lines,i.label.call(this,t)),cr(e.after,ur(i.afterLabel.call(this,t))),n.push(e)})),n}getAfterBody(t,e){return yr(e.callbacks.afterBody.apply(this,[t]))}getFooter(t,e){const{callbacks:r}=e,i=r.beforeFooter.apply(this,[t]),n=r.footer.apply(this,[t]),o=r.afterFooter.apply(this,[t]);let s=[];return s=cr(s,ur(i)),s=cr(s,ur(n)),s=cr(s,ur(o)),s}_createItems(t){const e=this._active,r=this.chart.data,n=[],o=[],s=[];let a,l,c=[];for(a=0,l=e.length;a<l;++a)c.push(hr(this.chart,e[a]));return t.filter&&(c=c.filter(((e,i,n)=>t.filter(e,i,n,r)))),t.itemSort&&(c=c.sort(((e,i)=>t.itemSort(e,i,r)))),(0,i.Q)(c,(e=>{const r=vr(t.callbacks,e);n.push(r.labelColor.call(this,e)),o.push(r.labelPointStyle.call(this,e)),s.push(r.labelTextColor.call(this,e))})),this.labelColors=n,this.labelPointStyles=o,this.labelTextColors=s,this.dataPoints=c,c}update(t,e){const r=this.options.setContext(this.getContext()),i=this._active;let n,o=[];if(i.length){const t=lr[r.position].call(this,i,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);const e=this._size=dr(this,r),s=Object.assign({},t,e),a=fr(this.chart,r,s),l=mr(r,s,a,this.chart);this.xAlign=a.xAlign,this.yAlign=a.yAlign,n={opacity:1,x:l.x,y:l.y,width:e.width,height:e.height,caretX:t.x,caretY:t.y}}else 0!==this.opacity&&(n={opacity:0});this._tooltipItems=o,this.$context=void 0,n&&this._resolveAnimations().update(this,n),t&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,r,i){const n=this.getCaretPosition(t,r,i);e.lineTo(n.x1,n.y1),e.lineTo(n.x2,n.y2),e.lineTo(n.x3,n.y3)}getCaretPosition(t,e,r){const{xAlign:n,yAlign:o}=this,{caretSize:s,cornerRadius:a}=r,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:h}=(0,i.ax)(a),{x:d,y:p}=t,{width:f,height:m}=e;let g,y,v,_,b,x;return"center"===o?(b=p+m/2,"left"===n?(g=d,y=g-s,_=b+s,x=b-s):(g=d+f,y=g+s,_=b-s,x=b+s),v=g):(y="left"===n?d+Math.max(l,u)+s:"right"===n?d+f-Math.max(c,h)-s:this.caretX,"top"===o?(_=p,b=_-s,g=y-s,v=y+s):(_=p+m,b=_+s,g=y+s,v=y-s),x=_),{x1:g,x2:y,x3:v,y1:_,y2:b,y3:x}}drawTitle(t,e,r){const n=this.title,o=n.length;let s,a,l;if(o){const c=(0,i.aA)(r.rtl,this.x,this.width);for(t.x=gr(this,r.titleAlign,r),e.textAlign=c.textAlign(r.titleAlign),e.textBaseline="middle",s=(0,i.O)(r.titleFont),a=r.titleSpacing,e.fillStyle=r.titleColor,e.font=s.string,l=0;l<o;++l)e.fillText(n[l],c.x(t.x),t.y+s.lineHeight/2),t.y+=s.lineHeight+a,l+1===o&&(t.y+=r.titleMarginBottom-a)}}_drawColorBox(t,e,r,n,o){const s=this.labelColors[r],a=this.labelPointStyles[r],{boxHeight:l,boxWidth:c,boxPadding:u}=o,h=(0,i.O)(o.bodyFont),d=gr(this,"left",o),p=n.x(d),f=l<h.lineHeight?(h.lineHeight-l)/2:0,m=e.y+f;if(o.usePointStyle){const e={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},r=n.leftForLtr(p,c)+c/2,u=m+l/2;t.strokeStyle=o.multiKeyBackground,t.fillStyle=o.multiKeyBackground,(0,i.au)(t,e,r,u),t.strokeStyle=s.borderColor,t.fillStyle=s.backgroundColor,(0,i.au)(t,e,r,u)}else{t.lineWidth=(0,i.i)(s.borderWidth)?Math.max(...Object.values(s.borderWidth)):s.borderWidth||1,t.strokeStyle=s.borderColor,t.setLineDash(s.borderDash||[]),t.lineDashOffset=s.borderDashOffset||0;const e=n.leftForLtr(p,c-u),r=n.leftForLtr(n.xPlus(p,1),c-u-2),a=(0,i.ax)(s.borderRadius);Object.values(a).some((t=>0!==t))?(t.beginPath(),t.fillStyle=o.multiKeyBackground,(0,i.av)(t,{x:e,y:m,w:c,h:l,radius:a}),t.fill(),t.stroke(),t.fillStyle=s.backgroundColor,t.beginPath(),(0,i.av)(t,{x:r,y:m+1,w:c-2,h:l-2,radius:a}),t.fill()):(t.fillStyle=o.multiKeyBackground,t.fillRect(e,m,c,l),t.strokeRect(e,m,c,l),t.fillStyle=s.backgroundColor,t.fillRect(r,m+1,c-2,l-2))}t.fillStyle=this.labelTextColors[r]}drawBody(t,e,r){const{body:n}=this,{bodySpacing:o,bodyAlign:s,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=r,h=(0,i.O)(r.bodyFont);let d=h.lineHeight,p=0;const f=(0,i.aA)(r.rtl,this.x,this.width),m=function(r){e.fillText(r,f.x(t.x+p),t.y+d/2),t.y+=d+o},g=f.textAlign(s);let y,v,_,b,x,w,T;for(e.textAlign=s,e.textBaseline="middle",e.font=h.string,t.x=gr(this,g,r),e.fillStyle=r.bodyColor,(0,i.Q)(this.beforeBody,m),p=a&&"right"!==g?"center"===s?c/2+u:c+2+u:0,b=0,w=n.length;b<w;++b){for(y=n[b],v=this.labelTextColors[b],e.fillStyle=v,(0,i.Q)(y.before,m),_=y.lines,a&&_.length&&(this._drawColorBox(e,t,b,f,r),d=Math.max(h.lineHeight,l)),x=0,T=_.length;x<T;++x)m(_[x]),d=h.lineHeight;(0,i.Q)(y.after,m)}p=0,d=h.lineHeight,(0,i.Q)(this.afterBody,m),t.y-=o}drawFooter(t,e,r){const n=this.footer,o=n.length;let s,a;if(o){const l=(0,i.aA)(r.rtl,this.x,this.width);for(t.x=gr(this,r.footerAlign,r),t.y+=r.footerMarginTop,e.textAlign=l.textAlign(r.footerAlign),e.textBaseline="middle",s=(0,i.O)(r.footerFont),e.fillStyle=r.footerColor,e.font=s.string,a=0;a<o;++a)e.fillText(n[a],l.x(t.x),t.y+s.lineHeight/2),t.y+=s.lineHeight+r.footerSpacing}}drawBackground(t,e,r,n){const{xAlign:o,yAlign:s}=this,{x:a,y:l}=t,{width:c,height:u}=r,{topLeft:h,topRight:d,bottomLeft:p,bottomRight:f}=(0,i.ax)(n.cornerRadius);e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.beginPath(),e.moveTo(a+h,l),"top"===s&&this.drawCaret(t,e,r,n),e.lineTo(a+c-d,l),e.quadraticCurveTo(a+c,l,a+c,l+d),"center"===s&&"right"===o&&this.drawCaret(t,e,r,n),e.lineTo(a+c,l+u-f),e.quadraticCurveTo(a+c,l+u,a+c-f,l+u),"bottom"===s&&this.drawCaret(t,e,r,n),e.lineTo(a+p,l+u),e.quadraticCurveTo(a,l+u,a,l+u-p),"center"===s&&"left"===o&&this.drawCaret(t,e,r,n),e.lineTo(a,l+h),e.quadraticCurveTo(a,l,a+h,l),e.closePath(),e.fill(),n.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,r=this.$animations,i=r&&r.x,n=r&&r.y;if(i||n){const r=lr[t.position].call(this,this._active,this._eventPosition);if(!r)return;const o=this._size=dr(this,t),s=Object.assign({},r,this._size),a=fr(e,t,s),l=mr(t,s,a,e);i._to===l.x&&n._to===l.y||(this.xAlign=a.xAlign,this.yAlign=a.yAlign,this.width=o.width,this.height=o.height,this.caretX=r.x,this.caretY=r.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(e);const n={width:this.width,height:this.height},o={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const s=(0,i.K)(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=r,this.drawBackground(o,t,n,e),(0,i.aB)(t,e.textDirection),o.y+=s.top,this.drawTitle(o,t,e),this.drawBody(o,t,e),this.drawFooter(o,t,e),(0,i.aD)(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const r=this._active,n=t.map((({datasetIndex:t,index:e})=>{const r=this.chart.getDatasetMeta(t);if(!r)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:r.data[e],index:e}})),o=!(0,i.ai)(r,n),s=this._positionChanged(n,e);(o||s)&&(this._active=n,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,r=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const n=this.options,o=this._active||[],s=this._getActiveElements(t,o,e,r),a=this._positionChanged(s,t),l=e||!(0,i.ai)(s,o)||a;return l&&(this._active=s,(n.enabled||n.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),l}_getActiveElements(t,e,r,i){const n=this.options;if("mouseout"===t.type)return[];if(!i)return e;const o=this.chart.getElementsAtEventForMode(t,n.mode,n,r);return n.reverse&&o.reverse(),o}_positionChanged(t,e){const{caretX:r,caretY:i,options:n}=this,o=lr[n.position].call(this,t,e);return!1!==o&&(r!==o.x||i!==o.y)}}_r.positioners=lr;var br={id:"tooltip",_element:_r,positioners:lr,afterInit(t,e,r){r&&(t.tooltip=new _r({chart:t,options:r}))},beforeUpdate(t,e,r){t.tooltip&&t.tooltip.initialize(r)},reset(t,e,r){t.tooltip&&t.tooltip.initialize(r)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const r={tooltip:e};if(!1===t.notifyPlugins("beforeTooltipDraw",r))return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",r)}},afterEvent(t,e){if(t.tooltip){const r=e.replay;t.tooltip.handleEvent(e.event,r,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:i.aF,title(t){if(t.length>0){const e=t[0],r=e.chart.data.labels,i=r?r.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return r[e.dataIndex]}return""},afterTitle:i.aF,beforeBody:i.aF,beforeLabel:i.aF,label(t){if(this&&this.options&&"dataset"===this.options.mode)return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const r=t.formattedValue;return(0,i.k)(r)||(e+=r),e},labelColor(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:i.aF,afterBody:i.aF,beforeFooter:i.aF,footer:i.aF,afterFooter:i.aF}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>"filter"!==t&&"itemSort"!==t&&"external"!==t,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},xr=Object.freeze({__proto__:null,Decimation:Be,Filler:tr,Legend:ir,SubTitle:ar,Title:or,Tooltip:br});function wr(t,e,r,i){const n=t.indexOf(e);if(-1===n)return((t,e,r,i)=>("string"==typeof e?(r=t.push(e)-1,i.unshift({index:r,label:e})):isNaN(e)&&(r=null),r))(t,e,r,i);return n!==t.lastIndexOf(e)?r:n}class Tr extends Z{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const t=this.getLabels();for(const{index:r,label:i}of e)t[r]===i&&t.splice(r,1);this._addedLabels=[]}super.init(t)}parse(t,e){if((0,i.k)(t))return null;const r=this.getLabels();return((t,e)=>null===t?null:(0,i.E)(Math.round(t),0,e))(e=isFinite(e)&&r[e]===t?e:wr(r,t,(0,i.v)(e,t),this._addedLabels),r.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:r,max:i}=this.getMinMax(!0);"ticks"===this.options.bounds&&(t||(r=0),e||(i=this.getLabels().length-1)),this.min=r,this.max=i}buildTicks(){const t=this.min,e=this.max,r=this.options.offset,i=[];let n=this.getLabels();n=0===t&&e===n.length-1?n:n.slice(t,e+1),this._valueRange=Math.max(n.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let r=t;r<=e;r++)i.push({value:r});return i}getLabelForValue(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return"number"!=typeof t&&(t=this.parse(t)),null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function Er(t,e,{horizontal:r,minRotation:n}){const o=(0,i.t)(n),s=(r?Math.sin(o):Math.cos(o))||.001,a=.75*e*(""+t).length;return Math.min(e/s,a)}Tr.id="category",Tr.defaults={ticks:{callback:Tr.prototype.getLabelForValue}};class Sr extends Z{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return(0,i.k)(t)||("number"==typeof t||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:r}=this.getUserBounds();let{min:n,max:o}=this;const s=t=>n=e?n:t,a=t=>o=r?o:t;if(t){const t=(0,i.s)(n),e=(0,i.s)(o);t<0&&e<0?a(0):t>0&&e>0&&s(0)}if(n===o){let e=1;(o>=Number.MAX_SAFE_INTEGER||n<=Number.MIN_SAFE_INTEGER)&&(e=Math.abs(.05*o)),a(o+e),t||s(n-e)}this.min=n,this.max=o}getTickLimit(){const t=this.options.ticks;let e,{maxTicksLimit:r,stepSize:i}=t;return i?(e=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,e>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${e} ticks. Limiting to 1000.`),e=1e3)):(e=this.computeTickLimit(),r=r||11),r&&(e=Math.min(r,e)),e}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let r=this.getTickLimit();r=Math.max(2,r);const n=function(t,e){const r=[],{bounds:n,step:o,min:s,max:a,precision:l,count:c,maxTicks:u,maxDigits:h,includeBounds:d}=t,p=o||1,f=u-1,{min:m,max:g}=e,y=!(0,i.k)(s),v=!(0,i.k)(a),_=!(0,i.k)(c),b=(g-m)/(h+1);let x,w,T,E,S=(0,i.aI)((g-m)/f/p)*p;if(S<1e-14&&!y&&!v)return[{value:m},{value:g}];E=Math.ceil(g/S)-Math.floor(m/S),E>f&&(S=(0,i.aI)(E*S/f/p)*p),(0,i.k)(l)||(x=Math.pow(10,l),S=Math.ceil(S*x)/x),"ticks"===n?(w=Math.floor(m/S)*S,T=Math.ceil(g/S)*S):(w=m,T=g),y&&v&&o&&(0,i.aJ)((a-s)/o,S/1e3)?(E=Math.round(Math.min((a-s)/S,u)),S=(a-s)/E,w=s,T=a):_?(w=y?s:w,T=v?a:T,E=c-1,S=(T-w)/E):(E=(T-w)/S,E=(0,i.aK)(E,Math.round(E),S/1e3)?Math.round(E):Math.ceil(E));const P=Math.max((0,i.aL)(S),(0,i.aL)(w));x=Math.pow(10,(0,i.k)(l)?P:l),w=Math.round(w*x)/x,T=Math.round(T*x)/x;let k=0;for(y&&(d&&w!==s?(r.push({value:s}),w<s&&k++,(0,i.aK)(Math.round((w+k*S)*x)/x,s,Er(s,b,t))&&k++):w<s&&k++);k<E;++k)r.push({value:Math.round((w+k*S)*x)/x});return v&&d&&T!==a?r.length&&(0,i.aK)(r[r.length-1].value,a,Er(a,b,t))?r[r.length-1].value=a:r.push({value:a}):v&&T!==a||r.push({value:T}),r}({maxTicks:r,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:!1!==e.includeBounds},this._range||this);return"ticks"===t.bounds&&(0,i.aH)(n,this,"value"),t.reverse?(n.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),n}configure(){const t=this.ticks;let e=this.min,r=this.max;if(super.configure(),this.options.offset&&t.length){const i=(r-e)/Math.max(t.length-1,1)/2;e-=i,r+=i}this._startValue=e,this._endValue=r,this._valueRange=r-e}getLabelForValue(t){return(0,i.o)(t,this.chart.options.locale,this.options.ticks.format)}}class Pr extends Sr{determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=(0,i.g)(t)?t:0,this.max=(0,i.g)(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,r=(0,i.t)(this.options.ticks.minRotation),n=(t?Math.sin(r):Math.cos(r))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,o.lineHeight/n))}getPixelForValue(t){return null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}function kr(t){return 1===t/Math.pow(10,Math.floor((0,i.z)(t)))}Pr.id="linear",Pr.defaults={ticks:{callback:j.formatters.numeric}};class Ar extends Z{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const r=Sr.prototype.parse.apply(this,[t,e]);if(0!==r)return(0,i.g)(r)&&r>0?r:null;this._zero=!0}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=(0,i.g)(t)?Math.max(0,t):null,this.max=(0,i.g)(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let r=this.min,n=this.max;const o=e=>r=t?r:e,s=t=>n=e?n:t,a=(t,e)=>Math.pow(10,Math.floor((0,i.z)(t))+e);r===n&&(r<=0?(o(1),s(10)):(o(a(r,-1)),s(a(n,1)))),r<=0&&o(a(n,-1)),n<=0&&s(a(r,1)),this._zero&&this.min!==this._suggestedMin&&r===a(this.min,0)&&o(a(r,-1)),this.min=r,this.max=n}buildTicks(){const t=this.options,e=function(t,e){const r=Math.floor((0,i.z)(e.max)),n=Math.ceil(e.max/Math.pow(10,r)),o=[];let s=(0,i.B)(t.min,Math.pow(10,Math.floor((0,i.z)(e.min)))),a=Math.floor((0,i.z)(s)),l=Math.floor(s/Math.pow(10,a)),c=a<0?Math.pow(10,Math.abs(a)):1;do{o.push({value:s,major:kr(s)}),++l,10===l&&(l=1,++a,c=a>=0?1:c),s=Math.round(l*Math.pow(10,a)*c)/c}while(a<r||a===r&&l<n);const u=(0,i.B)(t.max,s);return o.push({value:u,major:kr(s)}),o}({min:this._userMin,max:this._userMax},this);return"ticks"===t.bounds&&(0,i.aH)(e,this,"value"),t.reverse?(e.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),e}getLabelForValue(t){return void 0===t?"0":(0,i.o)(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=(0,i.z)(t),this._valueRange=(0,i.z)(this.max)-(0,i.z)(t)}getPixelForValue(t){return void 0!==t&&0!==t||(t=this.min),null===t||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:((0,i.z)(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}function Mr(t){const e=t.ticks;if(e.display&&t.display){const t=(0,i.K)(e.backdropPadding);return(0,i.v)(e.font&&e.font.size,i.d.font.size)+t.height}return 0}function Cr(t,e,r,i,n){return t===i||t===n?{start:e-r/2,end:e+r/2}:t<i||t>n?{start:e-r,end:e}:{start:e,end:e+r}}function Ir(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},r=Object.assign({},e),n=[],o=[],s=t._pointLabels.length,a=t.options.pointLabels,l=a.centerPointLabels?i.P/s:0;for(let d=0;d<s;d++){const s=a.setContext(t.getPointLabelContext(d));o[d]=s.padding;const p=t.getPointPosition(d,t.drawingArea+o[d],l),f=(0,i.O)(s.font),m=(c=t.ctx,u=f,h=t._pointLabels[d],h=(0,i.b)(h)?h:[h],{w:(0,i.aM)(c,u.string,h),h:h.length*u.lineHeight});n[d]=m;const g=(0,i.az)(t.getIndexAngle(d)+l),y=Math.round((0,i.F)(g));Or(r,e,g,Cr(y,p.x,m.w,0,180),Cr(y,p.y,m.h,90,270))}var c,u,h;t.setCenterPoint(e.l-r.l,r.r-e.r,e.t-r.t,r.b-e.b),t._pointLabelItems=function(t,e,r){const n=[],o=t._pointLabels.length,s=t.options,a=Mr(s)/2,l=t.drawingArea,c=s.pointLabels.centerPointLabels?i.P/o:0;for(let s=0;s<o;s++){const o=t.getPointPosition(s,l+a+r[s],c),u=Math.round((0,i.F)((0,i.az)(o.angle+i.H))),h=e[s],d=Rr(o.y,h.h,u),p=Lr(u),f=Dr(o.x,h.w,p);n.push({x:o.x,y:d,textAlign:p,left:f,top:d,right:f+h.w,bottom:d+h.h})}return n}(t,n,o)}function Or(t,e,r,i,n){const o=Math.abs(Math.sin(r)),s=Math.abs(Math.cos(r));let a=0,l=0;i.start<e.l?(a=(e.l-i.start)/o,t.l=Math.min(t.l,e.l-a)):i.end>e.r&&(a=(i.end-e.r)/o,t.r=Math.max(t.r,e.r+a)),n.start<e.t?(l=(e.t-n.start)/s,t.t=Math.min(t.t,e.t-l)):n.end>e.b&&(l=(n.end-e.b)/s,t.b=Math.max(t.b,e.b+l))}function Lr(t){return 0===t||180===t?"center":t<180?"left":"right"}function Dr(t,e,r){return"right"===r?t-=e:"center"===r&&(t-=e/2),t}function Rr(t,e,r){return 90===r||270===r?t-=e/2:(r>270||r<90)&&(t-=e),t}function Fr(t,e,r,n){const{ctx:o}=t;if(r)o.arc(t.xCenter,t.yCenter,e,0,i.T);else{let r=t.getPointPosition(0,e);o.moveTo(r.x,r.y);for(let i=1;i<n;i++)r=t.getPointPosition(i,e),o.lineTo(r.x,r.y)}}Ar.id="logarithmic",Ar.defaults={ticks:{callback:j.formatters.logarithmic,major:{enabled:!0}}};class Br extends Sr{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=(0,i.K)(Mr(this.options)/2),e=this.width=this.maxWidth-t.width,r=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+r/2+t.top),this.drawingArea=Math.floor(Math.min(e,r)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=(0,i.g)(t)&&!isNaN(t)?t:0,this.max=(0,i.g)(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Mr(this.options))}generateTickLabels(t){Sr.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map(((t,e)=>{const r=(0,i.C)(this.options.pointLabels.callback,[t,e],this);return r||0===r?r:""})).filter(((t,e)=>this.chart.getDataVisibility(e)))}fit(){const t=this.options;t.display&&t.pointLabels.display?Ir(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,r,i){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((r-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,r,i))}getIndexAngle(t){const e=i.T/(this._pointLabels.length||1),r=this.options.startAngle||0;return(0,i.az)(t*e+(0,i.t)(r))}getDistanceFromCenterForValue(t){if((0,i.k)(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if((0,i.k)(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const r=e[t];return function(t,e,r){return(0,i.h)(t,{label:r,index:e,type:"pointLabel"})}(this.getContext(),t,r)}}getPointPosition(t,e,r=0){const n=this.getIndexAngle(t)-i.H+r;return{x:Math.cos(n)*e+this.xCenter,y:Math.sin(n)*e+this.yCenter,angle:n}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:r,right:i,bottom:n}=this._pointLabelItems[t];return{left:e,top:r,right:i,bottom:n}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const r=this.ctx;r.save(),r.beginPath(),Fr(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),r.closePath(),r.fillStyle=t,r.fill(),r.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:r,grid:n}=e,o=this._pointLabels.length;let s,a,l;if(e.pointLabels.display&&function(t,e){const{ctx:r,options:{pointLabels:n}}=t;for(let o=e-1;o>=0;o--){const e=n.setContext(t.getPointLabelContext(o)),s=(0,i.O)(e.font),{x:a,y:l,textAlign:c,left:u,top:h,right:d,bottom:p}=t._pointLabelItems[o],{backdropColor:f}=e;if(!(0,i.k)(f)){const t=(0,i.ax)(e.borderRadius),n=(0,i.K)(e.backdropPadding);r.fillStyle=f;const o=u-n.left,s=h-n.top,a=d-u+n.width,l=p-h+n.height;Object.values(t).some((t=>0!==t))?(r.beginPath(),(0,i.av)(r,{x:o,y:s,w:a,h:l,radius:t}),r.fill()):r.fillRect(o,s,a,l)}(0,i.M)(r,t._pointLabels[o],a,l+s.lineHeight/2,s,{color:e.color,textAlign:c,textBaseline:"middle"})}}(this,o),n.display&&this.ticks.forEach(((t,e)=>{if(0!==e){a=this.getDistanceFromCenterForValue(t.value);!function(t,e,r,i){const n=t.ctx,o=e.circular,{color:s,lineWidth:a}=e;!o&&!i||!s||!a||r<0||(n.save(),n.strokeStyle=s,n.lineWidth=a,n.setLineDash(e.borderDash),n.lineDashOffset=e.borderDashOffset,n.beginPath(),Fr(t,r,o,i),n.closePath(),n.stroke(),n.restore())}(this,n.setContext(this.getContext(e-1)),a,o)}})),r.display){for(t.save(),s=o-1;s>=0;s--){const i=r.setContext(this.getPointLabelContext(s)),{color:n,lineWidth:o}=i;o&&n&&(t.lineWidth=o,t.strokeStyle=n,t.setLineDash(i.borderDash),t.lineDashOffset=i.borderDashOffset,a=this.getDistanceFromCenterForValue(e.ticks.reverse?this.min:this.max),l=this.getPointPosition(s,a),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(l.x,l.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,r=e.ticks;if(!r.display)return;const n=this.getIndexAngle(0);let o,s;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(n),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach(((n,a)=>{if(0===a&&!e.reverse)return;const l=r.setContext(this.getContext(a)),c=(0,i.O)(l.font);if(o=this.getDistanceFromCenterForValue(this.ticks[a].value),l.showLabelBackdrop){t.font=c.string,s=t.measureText(n.label).width,t.fillStyle=l.backdropColor;const e=(0,i.K)(l.backdropPadding);t.fillRect(-s/2-e.left,-o-c.size/2-e.top,s+e.width,c.size+e.height)}(0,i.M)(t,n.label,0,-o,c,{color:l.color})})),t.restore()}drawTitle(){}}Br.id="radialLinear",Br.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:j.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:t=>t,padding:5,centerPointLabels:!1}},Br.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"},Br.descriptors={angleLines:{_fallback:"grid"}};const zr={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},jr=Object.keys(zr);function Nr(t,e){return t-e}function Vr(t,e){if((0,i.k)(e))return null;const r=t._adapter,{parser:n,round:o,isoWeekday:s}=t._parseOpts;let a=e;return"function"==typeof n&&(a=n(a)),(0,i.g)(a)||(a="string"==typeof n?r.parse(a,n):r.parse(a)),null===a?null:(o&&(a="week"!==o||!(0,i.x)(s)&&!0!==s?r.startOf(a,o):r.startOf(a,"isoWeek",s)),+a)}function Ur(t,e,r,i){const n=jr.length;for(let o=jr.indexOf(t);o<n-1;++o){const t=zr[jr[o]],n=t.steps?t.steps:Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((r-e)/(n*t.size))<=i)return jr[o]}return jr[n-1]}function $r(t,e,r){if(r){if(r.length){const{lo:n,hi:o}=(0,i.aO)(r,e);t[r[n]>=e?r[n]:r[o]]=!0}}else t[e]=!0}function Gr(t,e,r){const i=[],n={},o=e.length;let s,a;for(s=0;s<o;++s)a=e[s],n[a]=s,i.push({value:a,major:!1});return 0!==o&&r?function(t,e,r,i){const n=t._adapter,o=+n.startOf(e[0].value,i),s=e[e.length-1].value;let a,l;for(a=o;a<=s;a=+n.add(a,1,i))l=r[a],l>=0&&(e[l].major=!0);return e}(t,i,n,r):i}class Hr extends Z{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e){const r=t.time||(t.time={}),n=this._adapter=new et._date(t.adapters.date);n.init(e),(0,i.ac)(r.displayFormats,n.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return void 0===t?null:Vr(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,r=t.time.unit||"day";let{min:n,max:o,minDefined:s,maxDefined:a}=this.getUserBounds();function l(t){s||isNaN(t.min)||(n=Math.min(n,t.min)),a||isNaN(t.max)||(o=Math.max(o,t.max))}s&&a||(l(this._getLabelBounds()),"ticks"===t.bounds&&"labels"===t.ticks.source||l(this.getMinMax(!1))),n=(0,i.g)(n)&&!isNaN(n)?n:+e.startOf(Date.now(),r),o=(0,i.g)(o)&&!isNaN(o)?o:+e.endOf(Date.now(),r)+1,this.min=Math.min(n,o-1),this.max=Math.max(n+1,o)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],r=t[t.length-1]),{min:e,max:r}}buildTicks(){const t=this.options,e=t.time,r=t.ticks,n="labels"===r.source?this.getLabelTimestamps():this._generate();"ticks"===t.bounds&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]);const o=this.min,s=this.max,a=(0,i.aN)(n,o,s);return this._unit=e.unit||(r.autoSkip?Ur(e.minUnit,this.min,this.max,this._getLabelCapacity(o)):function(t,e,r,i,n){for(let o=jr.length-1;o>=jr.indexOf(r);o--){const r=jr[o];if(zr[r].common&&t._adapter.diff(n,i,r)>=e-1)return r}return jr[r?jr.indexOf(r):0]}(this,a.length,e.minUnit,this.min,this.max)),this._majorUnit=r.major.enabled&&"year"!==this._unit?function(t){for(let e=jr.indexOf(t)+1,r=jr.length;e<r;++e)if(zr[jr[e]].common)return jr[e]}(this._unit):void 0,this.initOffsets(n),t.reverse&&a.reverse(),Gr(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((t=>+t.value)))}initOffsets(t){let e,r,n=0,o=0;this.options.offset&&t.length&&(e=this.getDecimalForValue(t[0]),n=1===t.length?1-e:(this.getDecimalForValue(t[1])-e)/2,r=this.getDecimalForValue(t[t.length-1]),o=1===t.length?r:(r-this.getDecimalForValue(t[t.length-2]))/2);const s=t.length<3?.5:.25;n=(0,i.E)(n,0,s),o=(0,i.E)(o,0,s),this._offsets={start:n,end:o,factor:1/(n+1+o)}}_generate(){const t=this._adapter,e=this.min,r=this.max,n=this.options,o=n.time,s=o.unit||Ur(o.minUnit,e,r,this._getLabelCapacity(e)),a=(0,i.v)(o.stepSize,1),l="week"===s&&o.isoWeekday,c=(0,i.x)(l)||!0===l,u={};let h,d,p=e;if(c&&(p=+t.startOf(p,"isoWeek",l)),p=+t.startOf(p,c?"day":s),t.diff(r,e,s)>1e5*a)throw new Error(e+" and "+r+" are too far apart with stepSize of "+a+" "+s);const f="data"===n.ticks.source&&this.getDataTimestamps();for(h=p,d=0;h<r;h=+t.add(h,a,s),d++)$r(u,h,f);return h!==r&&"ticks"!==n.bounds&&1!==d||$r(u,h,f),Object.keys(u).sort(((t,e)=>t-e)).map((t=>+t))}getLabelForValue(t){const e=this._adapter,r=this.options.time;return r.tooltipFormat?e.format(t,r.tooltipFormat):e.format(t,r.displayFormats.datetime)}_tickFormatFunction(t,e,r,n){const o=this.options,s=o.time.displayFormats,a=this._unit,l=this._majorUnit,c=a&&s[a],u=l&&s[l],h=r[e],d=l&&u&&h&&h.major,p=this._adapter.format(t,n||(d?u:c)),f=o.ticks.callback;return f?(0,i.C)(f,[p,e,r],this):p}generateTickLabels(t){let e,r,i;for(e=0,r=t.length;e<r;++e)i=t[e],i.label=this._tickFormatFunction(i.value,e,t)}getDecimalForValue(t){return null===t?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,r=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+r)*e.factor)}getValueForPixel(t){const e=this._offsets,r=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+r*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,r=this.ctx.measureText(t).width,n=(0,i.t)(this.isHorizontal()?e.maxRotation:e.minRotation),o=Math.cos(n),s=Math.sin(n),a=this._resolveTickFontOptions(0).size;return{w:r*o+a*s,h:r*s+a*o}}_getLabelCapacity(t){const e=this.options.time,r=e.displayFormats,i=r[e.unit]||r.millisecond,n=this._tickFormatFunction(t,0,Gr(this,[t],this._majorUnit),i),o=this._getLabelSize(n),s=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return s>0?s:1}getDataTimestamps(){let t,e,r=this._cache.data||[];if(r.length)return r;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,e=i.length;t<e;++t)r=r.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(r)}getLabelTimestamps(){const t=this._cache.labels||[];let e,r;if(t.length)return t;const i=this.getLabels();for(e=0,r=i.length;e<r;++e)t.push(Vr(this,i[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return(0,i._)(t.sort(Nr))}}function qr(t,e,r){let n,o,s,a,l=0,c=t.length-1;r?(e>=t[l].pos&&e<=t[c].pos&&({lo:l,hi:c}=(0,i.Z)(t,"pos",e)),({pos:n,time:s}=t[l]),({pos:o,time:a}=t[c])):(e>=t[l].time&&e<=t[c].time&&({lo:l,hi:c}=(0,i.Z)(t,"time",e)),({time:n,pos:s}=t[l]),({time:o,pos:a}=t[c]));const u=o-n;return u?s+(a-s)*(e-n)/u:s}Hr.id="time",Hr.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};class Wr extends Hr{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=qr(e,this.min),this._tableRange=qr(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:r}=this,i=[],n=[];let o,s,a,l,c;for(o=0,s=t.length;o<s;++o)l=t[o],l>=e&&l<=r&&i.push(l);if(i.length<2)return[{time:e,pos:0},{time:r,pos:1}];for(o=0,s=i.length;o<s;++o)c=i[o+1],a=i[o-1],l=i[o],Math.round((c+a)/2)!==l&&n.push({time:l,pos:o/(s-1)});return n}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),r=this.getLabelTimestamps();return t=e.length&&r.length?this.normalize(e.concat(r)):e.length?e:r,t=this._cache.all=t,t}getDecimalForValue(t){return(qr(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,r=this.getDecimalForPixel(t)/e.factor-e.end;return qr(this._table,r*this._tableRange+this._minPos,!0)}}Wr.id="timeseries",Wr.defaults=Hr.defaults;const Zr=[J,De,xr,Object.freeze({__proto__:null,CategoryScale:Tr,LinearScale:Pr,LogarithmicScale:Ar,RadialLinearScale:Br,TimeScale:Hr,TimeSeriesScale:Wr})]},2998:(t,e,r)=>{"use strict";function i(){}r.d(e,{$:()=>ge,A:()=>N,B:()=>c,C:()=>p,D:()=>Le,E:()=>Q,F:()=>q,G:()=>ue,H:()=>D,I:()=>tt,J:()=>de,K:()=>Ce,L:()=>ye,M:()=>xe,N:()=>ve,O:()=>Ie,P:()=>M,Q:()=>f,R:()=>pt,S:()=>ft,T:()=>C,U:()=>oe,V:()=>_,W:()=>E,X:()=>lr,Y:()=>nt,Z:()=>it,_:()=>ct,a:()=>Oe,a0:()=>Z,a1:()=>ur,a2:()=>ir,a3:()=>pr,a4:()=>ht,a5:()=>dr,a6:()=>rr,a7:()=>se,a8:()=>P,a9:()=>Fe,aA:()=>_r,aB:()=>br,aC:()=>mt,aD:()=>xr,aE:()=>me,aF:()=>i,aG:()=>X,aH:()=>G,aI:()=>j,aJ:()=>$,aK:()=>U,aL:()=>W,aM:()=>he,aN:()=>ot,aO:()=>rt,aa:()=>Re,ab:()=>Be,ac:()=>b,ad:()=>n,ae:()=>dt,af:()=>hr,ag:()=>pe,ah:()=>k,ai:()=>m,aj:()=>A,ak:()=>et,al:()=>ke,am:()=>er,an:()=>Pr,ao:()=>Sr,ap:()=>mr,aq:()=>gr,ar:()=>fr,as:()=>_e,at:()=>be,au:()=>fe,av:()=>Te,aw:()=>Ae,ax:()=>Me,ay:()=>Er,az:()=>K,b:()=>s,c:()=>ie,d:()=>ce,e:()=>xt,f:()=>T,g:()=>l,h:()=>De,i:()=>a,j:()=>S,k:()=>o,l:()=>at,m:()=>h,n:()=>d,o:()=>vr,p:()=>J,q:()=>gt,r:()=>ut,s:()=>z,t:()=>H,u:()=>lt,v:()=>u,w:()=>yt,x:()=>V,y:()=>Ze,z:()=>B});const n=function(){let t=0;return function(){return t++}}();function o(t){return null==t}function s(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return"[object"===e.slice(0,7)&&"Array]"===e.slice(-6)}function a(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}const l=t=>("number"==typeof t||t instanceof Number)&&isFinite(+t);function c(t,e){return l(t)?t:e}function u(t,e){return void 0===t?e:t}const h=(t,e)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100:t/e,d=(t,e)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100*e:+t;function p(t,e,r){if(t&&"function"==typeof t.call)return t.apply(r,e)}function f(t,e,r,i){let n,o,l;if(s(t))if(o=t.length,i)for(n=o-1;n>=0;n--)e.call(r,t[n],n);else for(n=0;n<o;n++)e.call(r,t[n],n);else if(a(t))for(l=Object.keys(t),o=l.length,n=0;n<o;n++)e.call(r,t[l[n]],l[n])}function m(t,e){let r,i,n,o;if(!t||!e||t.length!==e.length)return!1;for(r=0,i=t.length;r<i;++r)if(n=t[r],o=e[r],n.datasetIndex!==o.datasetIndex||n.index!==o.index)return!1;return!0}function g(t){if(s(t))return t.map(g);if(a(t)){const e=Object.create(null),r=Object.keys(t),i=r.length;let n=0;for(;n<i;++n)e[r[n]]=g(t[r[n]]);return e}return t}function y(t){return-1===["__proto__","prototype","constructor"].indexOf(t)}function v(t,e,r,i){if(!y(t))return;const n=e[t],o=r[t];a(n)&&a(o)?_(n,o,i):e[t]=g(o)}function _(t,e,r){const i=s(e)?e:[e],n=i.length;if(!a(t))return t;const o=(r=r||{}).merger||v;for(let s=0;s<n;++s){if(!a(e=i[s]))continue;const n=Object.keys(e);for(let i=0,s=n.length;i<s;++i)o(n[i],t,e,r)}return t}function b(t,e){return _(t,e,{merger:x})}function x(t,e,r){if(!y(t))return;const i=e[t],n=r[t];a(i)&&a(n)?b(i,n):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=g(n))}const w={"":t=>t,x:t=>t.x,y:t=>t.y};function T(t,e){const r=w[e]||(w[e]=function(t){const e=function(t){const e=t.split("."),r=[];let i="";for(const t of e)i+=t,i.endsWith("\\")?i=i.slice(0,-1)+".":(r.push(i),i="");return r}(t);return t=>{for(const r of e){if(""===r)break;t=t&&t[r]}return t}}(e));return r(t)}function E(t){return t.charAt(0).toUpperCase()+t.slice(1)}const S=t=>void 0!==t,P=t=>"function"==typeof t,k=(t,e)=>{if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0};function A(t){return"mouseup"===t.type||"click"===t.type||"contextmenu"===t.type}const M=Math.PI,C=2*M,I=C+M,O=Number.POSITIVE_INFINITY,L=M/180,D=M/2,R=M/4,F=2*M/3,B=Math.log10,z=Math.sign;function j(t){const e=Math.round(t);t=U(t,e,t/1e3)?e:t;const r=Math.pow(10,Math.floor(B(t))),i=t/r;return(i<=1?1:i<=2?2:i<=5?5:10)*r}function N(t){const e=[],r=Math.sqrt(t);let i;for(i=1;i<r;i++)t%i==0&&(e.push(i),e.push(t/i));return r===(0|r)&&e.push(r),e.sort(((t,e)=>t-e)).pop(),e}function V(t){return!isNaN(parseFloat(t))&&isFinite(t)}function U(t,e,r){return Math.abs(t-e)<r}function $(t,e){const r=Math.round(t);return r-e<=t&&r+e>=t}function G(t,e,r){let i,n,o;for(i=0,n=t.length;i<n;i++)o=t[i][r],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function H(t){return t*(M/180)}function q(t){return t*(180/M)}function W(t){if(!l(t))return;let e=1,r=0;for(;Math.round(t*e)/e!==t;)e*=10,r++;return r}function Z(t,e){const r=e.x-t.x,i=e.y-t.y,n=Math.sqrt(r*r+i*i);let o=Math.atan2(i,r);return o<-.5*M&&(o+=C),{angle:o,distance:n}}function X(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Y(t,e){return(t-e+I)%C-M}function K(t){return(t%C+C)%C}function J(t,e,r,i){const n=K(t),o=K(e),s=K(r),a=K(o-n),l=K(s-n),c=K(n-o),u=K(n-s);return n===o||n===s||i&&o===s||a>l&&c<u}function Q(t,e,r){return Math.max(e,Math.min(r,t))}function tt(t){return Q(t,-32768,32767)}function et(t,e,r,i=1e-6){return t>=Math.min(e,r)-i&&t<=Math.max(e,r)+i}function rt(t,e,r){r=r||(r=>t[r]<e);let i,n=t.length-1,o=0;for(;n-o>1;)i=o+n>>1,r(i)?o=i:n=i;return{lo:o,hi:n}}const it=(t,e,r,i)=>rt(t,r,i?i=>t[i][e]<=r:i=>t[i][e]<r),nt=(t,e,r)=>rt(t,r,(i=>t[i][e]>=r));function ot(t,e,r){let i=0,n=t.length;for(;i<n&&t[i]<e;)i++;for(;n>i&&t[n-1]>r;)n--;return i>0||n<t.length?t.slice(i,n):t}const st=["push","pop","shift","splice","unshift"];function at(t,e){t._chartjs?t._chartjs.listeners.push(e):(Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),st.forEach((e=>{const r="_onData"+E(e),i=t[e];Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value(...e){const n=i.apply(this,e);return t._chartjs.listeners.forEach((t=>{"function"==typeof t[r]&&t[r](...e)})),n}})})))}function lt(t,e){const r=t._chartjs;if(!r)return;const i=r.listeners,n=i.indexOf(e);-1!==n&&i.splice(n,1),i.length>0||(st.forEach((e=>{delete t[e]})),delete t._chartjs)}function ct(t){const e=new Set;let r,i;for(r=0,i=t.length;r<i;++r)e.add(t[r]);return e.size===i?t:Array.from(e)}const ut="undefined"==typeof window?function(t){return t()}:window.requestAnimationFrame;function ht(t,e,r){const i=r||(t=>Array.prototype.slice.call(t));let n=!1,o=[];return function(...r){o=i(r),n||(n=!0,ut.call(window,(()=>{n=!1,t.apply(e,o)})))}}function dt(t,e){let r;return function(...i){return e?(clearTimeout(r),r=setTimeout(t,e,i)):t.apply(this,i),e}}const pt=t=>"start"===t?"left":"end"===t?"right":"center",ft=(t,e,r)=>"start"===t?e:"end"===t?r:(e+r)/2,mt=(t,e,r,i)=>t===(i?"left":"right")?r:"center"===t?(e+r)/2:e;function gt(t,e,r){const i=e.length;let n=0,o=i;if(t._sorted){const{iScale:s,_parsed:a}=t,l=s.axis,{min:c,max:u,minDefined:h,maxDefined:d}=s.getUserBounds();h&&(n=Q(Math.min(it(a,s.axis,c).lo,r?i:it(e,l,s.getPixelForValue(c)).lo),0,i-1)),o=d?Q(Math.max(it(a,s.axis,u,!0).hi+1,r?0:it(e,l,s.getPixelForValue(u),!0).hi+1),n,i)-n:i-n}return{start:n,count:o}}function yt(t){const{xScale:e,yScale:r,_scaleRanges:i}=t,n={xmin:e.min,xmax:e.max,ymin:r.min,ymax:r.max};if(!i)return t._scaleRanges=n,!0;const o=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==r.min||i.ymax!==r.max;return Object.assign(i,n),o}const vt=t=>0===t||1===t,_t=(t,e,r)=>-Math.pow(2,10*(t-=1))*Math.sin((t-e)*C/r),bt=(t,e,r)=>Math.pow(2,-10*t)*Math.sin((t-e)*C/r)+1,xt={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>1-Math.cos(t*D),easeOutSine:t=>Math.sin(t*D),easeInOutSine:t=>-.5*(Math.cos(M*t)-1),easeInExpo:t=>0===t?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>vt(t)?t:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(2-Math.pow(2,-10*(2*t-1))),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>vt(t)?t:_t(t,.075,.3),easeOutElastic:t=>vt(t)?t:bt(t,.075,.3),easeInOutElastic(t){const e=.1125;return vt(t)?t:t<.5?.5*_t(2*t,e,.45):.5+.5*bt(2*t-1,e,.45)},easeInBack(t){const e=1.70158;return t*t*((e+1)*t-e)},easeOutBack(t){const e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:t=>1-xt.easeOutBounce(1-t),easeOutBounce(t){const e=7.5625,r=2.75;return t<1/r?e*t*t:t<2/r?e*(t-=1.5/r)*t+.75:t<2.5/r?e*(t-=2.25/r)*t+.9375:e*(t-=2.625/r)*t+.984375},easeInOutBounce:t=>t<.5?.5*xt.easeInBounce(2*t):.5*xt.easeOutBounce(2*t-1)+.5};function wt(t){return t+.5|0}const Tt=(t,e,r)=>Math.max(Math.min(t,r),e);function Et(t){return Tt(wt(2.55*t),0,255)}function St(t){return Tt(wt(255*t),0,255)}function Pt(t){return Tt(wt(t/2.55)/100,0,1)}function kt(t){return Tt(wt(100*t),0,100)}const At={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Mt=[..."0123456789ABCDEF"],Ct=t=>Mt[15&t],It=t=>Mt[(240&t)>>4]+Mt[15&t],Ot=t=>(240&t)>>4==(15&t);function Lt(t){var e=(t=>Ot(t.r)&&Ot(t.g)&&Ot(t.b)&&Ot(t.a))(t)?Ct:It;return t?"#"+e(t.r)+e(t.g)+e(t.b)+((t,e)=>t<255?e(t):"")(t.a,e):void 0}const Dt=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Rt(t,e,r){const i=e*Math.min(r,1-r),n=(e,n=(e+t/30)%12)=>r-i*Math.max(Math.min(n-3,9-n,1),-1);return[n(0),n(8),n(4)]}function Ft(t,e,r){const i=(i,n=(i+t/60)%6)=>r-r*e*Math.max(Math.min(n,4-n,1),0);return[i(5),i(3),i(1)]}function Bt(t,e,r){const i=Rt(t,1,.5);let n;for(e+r>1&&(n=1/(e+r),e*=n,r*=n),n=0;n<3;n++)i[n]*=1-e-r,i[n]+=e;return i}function zt(t){const e=t.r/255,r=t.g/255,i=t.b/255,n=Math.max(e,r,i),o=Math.min(e,r,i),s=(n+o)/2;let a,l,c;return n!==o&&(c=n-o,l=s>.5?c/(2-n-o):c/(n+o),a=function(t,e,r,i,n){return t===n?(e-r)/i+(e<r?6:0):e===n?(r-t)/i+2:(t-e)/i+4}(e,r,i,c,n),a=60*a+.5),[0|a,l||0,s]}function jt(t,e,r,i){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,r,i)).map(St)}function Nt(t,e,r){return jt(Rt,t,e,r)}function Vt(t){return(t%360+360)%360}function Ut(t){const e=Dt.exec(t);let r,i=255;if(!e)return;e[5]!==r&&(i=e[6]?Et(+e[5]):St(+e[5]));const n=Vt(+e[2]),o=+e[3]/100,s=+e[4]/100;return r="hwb"===e[1]?function(t,e,r){return jt(Bt,t,e,r)}(n,o,s):"hsv"===e[1]?function(t,e,r){return jt(Ft,t,e,r)}(n,o,s):Nt(n,o,s),{r:r[0],g:r[1],b:r[2],a:i}}const $t={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Gt={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Ht;function qt(t){Ht||(Ht=function(){const t={},e=Object.keys(Gt),r=Object.keys($t);let i,n,o,s,a;for(i=0;i<e.length;i++){for(s=a=e[i],n=0;n<r.length;n++)o=r[n],a=a.replace(o,$t[o]);o=parseInt(Gt[s],16),t[a]=[o>>16&255,o>>8&255,255&o]}return t}(),Ht.transparent=[0,0,0,0]);const e=Ht[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:4===e.length?e[3]:255}}const Wt=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const Zt=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,Xt=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function Yt(t,e,r){if(t){let i=zt(t);i[e]=Math.max(0,Math.min(i[e]+i[e]*r,0===e?360:1)),i=Nt(i),t.r=i[0],t.g=i[1],t.b=i[2]}}function Kt(t,e){return t?Object.assign(e||{},t):t}function Jt(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=St(t[3]))):(e=Kt(t,{r:0,g:0,b:0,a:1})).a=St(e.a),e}function Qt(t){return"r"===t.charAt(0)?function(t){const e=Wt.exec(t);let r,i,n,o=255;if(e){if(e[7]!==r){const t=+e[7];o=e[8]?Et(t):Tt(255*t,0,255)}return r=+e[1],i=+e[3],n=+e[5],r=255&(e[2]?Et(r):Tt(r,0,255)),i=255&(e[4]?Et(i):Tt(i,0,255)),n=255&(e[6]?Et(n):Tt(n,0,255)),{r,g:i,b:n,a:o}}}(t):Ut(t)}class te{constructor(t){if(t instanceof te)return t;const e=typeof t;let r;var i,n,o;"object"===e?r=Jt(t):"string"===e&&(o=(i=t).length,"#"===i[0]&&(4===o||5===o?n={r:255&17*At[i[1]],g:255&17*At[i[2]],b:255&17*At[i[3]],a:5===o?17*At[i[4]]:255}:7!==o&&9!==o||(n={r:At[i[1]]<<4|At[i[2]],g:At[i[3]]<<4|At[i[4]],b:At[i[5]]<<4|At[i[6]],a:9===o?At[i[7]]<<4|At[i[8]]:255})),r=n||qt(t)||Qt(t)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var t=Kt(this._rgb);return t&&(t.a=Pt(t.a)),t}set rgb(t){this._rgb=Jt(t)}rgbString(){return this._valid?(t=this._rgb)&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Pt(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`):void 0;var t}hexString(){return this._valid?Lt(this._rgb):void 0}hslString(){return this._valid?function(t){if(!t)return;const e=zt(t),r=e[0],i=kt(e[1]),n=kt(e[2]);return t.a<255?`hsla(${r}, ${i}%, ${n}%, ${Pt(t.a)})`:`hsl(${r}, ${i}%, ${n}%)`}(this._rgb):void 0}mix(t,e){if(t){const r=this.rgb,i=t.rgb;let n;const o=e===n?.5:e,s=2*o-1,a=r.a-i.a,l=((s*a==-1?s:(s+a)/(1+s*a))+1)/2;n=1-l,r.r=255&l*r.r+n*i.r+.5,r.g=255&l*r.g+n*i.g+.5,r.b=255&l*r.b+n*i.b+.5,r.a=o*r.a+(1-o)*i.a,this.rgb=r}return this}interpolate(t,e){return t&&(this._rgb=function(t,e,r){const i=Xt(Pt(t.r)),n=Xt(Pt(t.g)),o=Xt(Pt(t.b));return{r:St(Zt(i+r*(Xt(Pt(e.r))-i))),g:St(Zt(n+r*(Xt(Pt(e.g))-n))),b:St(Zt(o+r*(Xt(Pt(e.b))-o))),a:t.a+r*(e.a-t.a)}}(this._rgb,t._rgb,e)),this}clone(){return new te(this.rgb)}alpha(t){return this._rgb.a=St(t),this}clearer(t){return this._rgb.a*=1-t,this}greyscale(){const t=this._rgb,e=wt(.3*t.r+.59*t.g+.11*t.b);return t.r=t.g=t.b=e,this}opaquer(t){return this._rgb.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Yt(this._rgb,2,t),this}darken(t){return Yt(this._rgb,2,-t),this}saturate(t){return Yt(this._rgb,1,t),this}desaturate(t){return Yt(this._rgb,1,-t),this}rotate(t){return function(t,e){var r=zt(t);r[0]=Vt(r[0]+e),r=Nt(r),t.r=r[0],t.g=r[1],t.b=r[2]}(this._rgb,t),this}}function ee(t){return new te(t)}function re(t){if(t&&"object"==typeof t){const e=t.toString();return"[object CanvasPattern]"===e||"[object CanvasGradient]"===e}return!1}function ie(t){return re(t)?t:ee(t)}function ne(t){return re(t)?t:ee(t).saturate(.5).darken(.1).hexString()}const oe=Object.create(null),se=Object.create(null);function ae(t,e){if(!e)return t;const r=e.split(".");for(let e=0,i=r.length;e<i;++e){const i=r[e];t=t[i]||(t[i]=Object.create(null))}return t}function le(t,e,r){return"string"==typeof e?_(ae(t,e),r):_(ae(t,""),e)}var ce=new class{constructor(t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,e)=>ne(e.backgroundColor),this.hoverBorderColor=(t,e)=>ne(e.borderColor),this.hoverColor=(t,e)=>ne(e.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t)}set(t,e){return le(this,t,e)}get(t){return ae(this,t)}describe(t,e){return le(se,t,e)}override(t,e){return le(oe,t,e)}route(t,e,r,i){const n=ae(this,t),o=ae(this,r),s="_"+e;Object.defineProperties(n,{[s]:{value:n[e],writable:!0},[e]:{enumerable:!0,get(){const t=this[s],e=o[i];return a(t)?Object.assign({},e,t):u(t,e)},set(t){this[s]=t}}})}}({_scriptable:t=>!t.startsWith("on"),_indexable:t=>"events"!==t,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});function ue(t,e,r,i,n){let o=e[n];return o||(o=e[n]=t.measureText(n).width,r.push(n)),o>i&&(i=o),i}function he(t,e,r,i){let n=(i=i||{}).data=i.data||{},o=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(n=i.data={},o=i.garbageCollect=[],i.font=e),t.save(),t.font=e;let a=0;const l=r.length;let c,u,h,d,p;for(c=0;c<l;c++)if(d=r[c],null!=d&&!0!==s(d))a=ue(t,n,o,a,d);else if(s(d))for(u=0,h=d.length;u<h;u++)p=d[u],null==p||s(p)||(a=ue(t,n,o,a,p));t.restore();const f=o.length/2;if(f>r.length){for(c=0;c<f;c++)delete n[o[c]];o.splice(0,f)}return a}function de(t,e,r){const i=t.currentDevicePixelRatio,n=0!==r?Math.max(r/2,.5):0;return Math.round((e-n)*i)/i+n}function pe(t,e){(e=e||t.getContext("2d")).save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore()}function fe(t,e,r,i){me(t,e,r,i,null)}function me(t,e,r,i,n){let o,s,a,l,c,u;const h=e.pointStyle,d=e.rotation,p=e.radius;let f=(d||0)*L;if(h&&"object"==typeof h&&(o=h.toString(),"[object HTMLImageElement]"===o||"[object HTMLCanvasElement]"===o))return t.save(),t.translate(r,i),t.rotate(f),t.drawImage(h,-h.width/2,-h.height/2,h.width,h.height),void t.restore();if(!(isNaN(p)||p<=0)){switch(t.beginPath(),h){default:n?t.ellipse(r,i,n/2,p,0,0,C):t.arc(r,i,p,0,C),t.closePath();break;case"triangle":t.moveTo(r+Math.sin(f)*p,i-Math.cos(f)*p),f+=F,t.lineTo(r+Math.sin(f)*p,i-Math.cos(f)*p),f+=F,t.lineTo(r+Math.sin(f)*p,i-Math.cos(f)*p),t.closePath();break;case"rectRounded":c=.516*p,l=p-c,s=Math.cos(f+R)*l,a=Math.sin(f+R)*l,t.arc(r-s,i-a,c,f-M,f-D),t.arc(r+a,i-s,c,f-D,f),t.arc(r+s,i+a,c,f,f+D),t.arc(r-a,i+s,c,f+D,f+M),t.closePath();break;case"rect":if(!d){l=Math.SQRT1_2*p,u=n?n/2:l,t.rect(r-u,i-l,2*u,2*l);break}f+=R;case"rectRot":s=Math.cos(f)*p,a=Math.sin(f)*p,t.moveTo(r-s,i-a),t.lineTo(r+a,i-s),t.lineTo(r+s,i+a),t.lineTo(r-a,i+s),t.closePath();break;case"crossRot":f+=R;case"cross":s=Math.cos(f)*p,a=Math.sin(f)*p,t.moveTo(r-s,i-a),t.lineTo(r+s,i+a),t.moveTo(r+a,i-s),t.lineTo(r-a,i+s);break;case"star":s=Math.cos(f)*p,a=Math.sin(f)*p,t.moveTo(r-s,i-a),t.lineTo(r+s,i+a),t.moveTo(r+a,i-s),t.lineTo(r-a,i+s),f+=R,s=Math.cos(f)*p,a=Math.sin(f)*p,t.moveTo(r-s,i-a),t.lineTo(r+s,i+a),t.moveTo(r+a,i-s),t.lineTo(r-a,i+s);break;case"line":s=n?n/2:Math.cos(f)*p,a=Math.sin(f)*p,t.moveTo(r-s,i-a),t.lineTo(r+s,i+a);break;case"dash":t.moveTo(r,i),t.lineTo(r+Math.cos(f)*p,i+Math.sin(f)*p)}t.fill(),e.borderWidth>0&&t.stroke()}}function ge(t,e,r){return r=r||.5,!e||t&&t.x>e.left-r&&t.x<e.right+r&&t.y>e.top-r&&t.y<e.bottom+r}function ye(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function ve(t){t.restore()}function _e(t,e,r,i,n){if(!e)return t.lineTo(r.x,r.y);if("middle"===n){const i=(e.x+r.x)/2;t.lineTo(i,e.y),t.lineTo(i,r.y)}else"after"===n!=!!i?t.lineTo(e.x,r.y):t.lineTo(r.x,e.y);t.lineTo(r.x,r.y)}function be(t,e,r,i){if(!e)return t.lineTo(r.x,r.y);t.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?r.cp2x:r.cp1x,i?r.cp2y:r.cp1y,r.x,r.y)}function xe(t,e,r,i,n,a={}){const l=s(e)?e:[e],c=a.strokeWidth>0&&""!==a.strokeColor;let u,h;for(t.save(),t.font=n.string,function(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]);o(e.rotation)||t.rotate(e.rotation);e.color&&(t.fillStyle=e.color);e.textAlign&&(t.textAlign=e.textAlign);e.textBaseline&&(t.textBaseline=e.textBaseline)}(t,a),u=0;u<l.length;++u)h=l[u],c&&(a.strokeColor&&(t.strokeStyle=a.strokeColor),o(a.strokeWidth)||(t.lineWidth=a.strokeWidth),t.strokeText(h,r,i,a.maxWidth)),t.fillText(h,r,i,a.maxWidth),we(t,r,i,h,a),i+=n.lineHeight;t.restore()}function we(t,e,r,i,n){if(n.strikethrough||n.underline){const o=t.measureText(i),s=e-o.actualBoundingBoxLeft,a=e+o.actualBoundingBoxRight,l=r-o.actualBoundingBoxAscent,c=r+o.actualBoundingBoxDescent,u=n.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=n.decorationWidth||2,t.moveTo(s,u),t.lineTo(a,u),t.stroke()}}function Te(t,e){const{x:r,y:i,w:n,h:o,radius:s}=e;t.arc(r+s.topLeft,i+s.topLeft,s.topLeft,-D,M,!0),t.lineTo(r,i+o-s.bottomLeft),t.arc(r+s.bottomLeft,i+o-s.bottomLeft,s.bottomLeft,M,D,!0),t.lineTo(r+n-s.bottomRight,i+o),t.arc(r+n-s.bottomRight,i+o-s.bottomRight,s.bottomRight,D,0,!0),t.lineTo(r+n,i+s.topRight),t.arc(r+n-s.topRight,i+s.topRight,s.topRight,0,-D,!0),t.lineTo(r+s.topLeft,i)}const Ee=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),Se=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function Pe(t,e){const r=(""+t).match(Ee);if(!r||"normal"===r[1])return 1.2*e;switch(t=+r[2],r[3]){case"px":return t;case"%":t/=100}return e*t}function ke(t,e){const r={},i=a(e),n=i?Object.keys(e):e,o=a(t)?i?r=>u(t[r],t[e[r]]):e=>t[e]:()=>t;for(const t of n)r[t]=+o(t)||0;return r}function Ae(t){return ke(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Me(t){return ke(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Ce(t){const e=Ae(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Ie(t,e){t=t||{},e=e||ce.font;let r=u(t.size,e.size);"string"==typeof r&&(r=parseInt(r,10));let i=u(t.style,e.style);i&&!(""+i).match(Se)&&(console.warn('Invalid font style specified: "'+i+'"'),i="");const n={family:u(t.family,e.family),lineHeight:Pe(u(t.lineHeight,e.lineHeight),r),size:r,style:i,weight:u(t.weight,e.weight),string:""};return n.string=function(t){return!t||o(t.size)||o(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}(n),n}function Oe(t,e,r,i){let n,o,a,l=!0;for(n=0,o=t.length;n<o;++n)if(a=t[n],void 0!==a&&(void 0!==e&&"function"==typeof a&&(a=a(e),l=!1),void 0!==r&&s(a)&&(a=a[r%a.length],l=!1),void 0!==a))return i&&!l&&(i.cacheable=!1),a}function Le(t,e,r){const{min:i,max:n}=t,o=d(e,(n-i)/2),s=(t,e)=>r&&0===t?0:t+e;return{min:s(i,-Math.abs(o)),max:s(n,o)}}function De(t,e){return Object.assign(Object.create(t),e)}function Re(t,e=[""],r=t,i,n=(()=>t[0])){S(i)||(i=qe("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:r,_fallback:i,_getTarget:n,override:n=>Re([n,...t],e,r,i)};return new Proxy(o,{deleteProperty:(e,r)=>(delete e[r],delete e._keys,delete t[0][r],!0),get:(r,i)=>Ne(r,i,(()=>function(t,e,r,i){let n;for(const o of e)if(n=qe(ze(o,t),r),S(n))return je(t,n)?Ge(r,i,t,n):n}(i,e,t,r))),getOwnPropertyDescriptor:(t,e)=>Reflect.getOwnPropertyDescriptor(t._scopes[0],e),getPrototypeOf:()=>Reflect.getPrototypeOf(t[0]),has:(t,e)=>We(t).includes(e),ownKeys:t=>We(t),set(t,e,r){const i=t._storage||(t._storage=n());return t[e]=i[e]=r,delete t._keys,!0}})}function Fe(t,e,r,i){const n={_cacheable:!1,_proxy:t,_context:e,_subProxy:r,_stack:new Set,_descriptors:Be(t,i),setContext:e=>Fe(t,e,r,i),override:n=>Fe(t.override(n),e,r,i)};return new Proxy(n,{deleteProperty:(e,r)=>(delete e[r],delete t[r],!0),get:(t,e,r)=>Ne(t,e,(()=>function(t,e,r){const{_proxy:i,_context:n,_subProxy:o,_descriptors:l}=t;let c=i[e];P(c)&&l.isScriptable(e)&&(c=function(t,e,r,i){const{_proxy:n,_context:o,_subProxy:s,_stack:a}=r;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t),e=e(o,s||i),a.delete(t),je(t,e)&&(e=Ge(n._scopes,n,t,e));return e}(e,c,t,r));s(c)&&c.length&&(c=function(t,e,r,i){const{_proxy:n,_context:o,_subProxy:s,_descriptors:l}=r;if(S(o.index)&&i(t))e=e[o.index%e.length];else if(a(e[0])){const r=e,i=n._scopes.filter((t=>t!==r));e=[];for(const a of r){const r=Ge(i,n,t,a);e.push(Fe(r,o,s&&s[t],l))}}return e}(e,c,t,l.isIndexable));je(e,c)&&(c=Fe(c,n,o&&o[e],l));return c}(t,e,r))),getOwnPropertyDescriptor:(e,r)=>e._descriptors.allKeys?Reflect.has(t,r)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,r),getPrototypeOf:()=>Reflect.getPrototypeOf(t),has:(e,r)=>Reflect.has(t,r),ownKeys:()=>Reflect.ownKeys(t),set:(e,r,i)=>(t[r]=i,delete e[r],!0)})}function Be(t,e={scriptable:!0,indexable:!0}){const{_scriptable:r=e.scriptable,_indexable:i=e.indexable,_allKeys:n=e.allKeys}=t;return{allKeys:n,scriptable:r,indexable:i,isScriptable:P(r)?r:()=>r,isIndexable:P(i)?i:()=>i}}const ze=(t,e)=>t?t+E(e):e,je=(t,e)=>a(e)&&"adapters"!==t&&(null===Object.getPrototypeOf(e)||e.constructor===Object);function Ne(t,e,r){if(Object.prototype.hasOwnProperty.call(t,e))return t[e];const i=r();return t[e]=i,i}function Ve(t,e,r){return P(t)?t(e,r):t}const Ue=(t,e)=>!0===t?e:"string"==typeof t?T(e,t):void 0;function $e(t,e,r,i,n){for(const o of e){const e=Ue(r,o);if(e){t.add(e);const o=Ve(e._fallback,r,n);if(S(o)&&o!==r&&o!==i)return o}else if(!1===e&&S(i)&&r!==i)return null}return!1}function Ge(t,e,r,i){const n=e._rootScopes,o=Ve(e._fallback,r,i),l=[...t,...n],c=new Set;c.add(i);let u=He(c,l,r,o||r,i);return null!==u&&((!S(o)||o===r||(u=He(c,l,o,u,i),null!==u))&&Re(Array.from(c),[""],n,o,(()=>function(t,e,r){const i=t._getTarget();e in i||(i[e]={});const n=i[e];if(s(n)&&a(r))return r;return n}(e,r,i))))}function He(t,e,r,i,n){for(;r;)r=$e(t,e,r,i,n);return r}function qe(t,e){for(const r of e){if(!r)continue;const e=r[t];if(S(e))return e}}function We(t){let e=t._keys;return e||(e=t._keys=function(t){const e=new Set;for(const r of t)for(const t of Object.keys(r).filter((t=>!t.startsWith("_"))))e.add(t);return Array.from(e)}(t._scopes)),e}function Ze(t,e,r,i){const{iScale:n}=t,{key:o="r"}=this._parsing,s=new Array(i);let a,l,c,u;for(a=0,l=i;a<l;++a)c=a+r,u=e[c],s[a]={r:n.parse(T(u,o),c)};return s}const Xe=Number.EPSILON||1e-14,Ye=(t,e)=>e<t.length&&!t[e].skip&&t[e],Ke=t=>"x"===t?"y":"x";function Je(t,e,r,i){const n=t.skip?e:t,o=e,s=r.skip?e:r,a=X(o,n),l=X(s,o);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const h=i*c,d=i*u;return{previous:{x:o.x-h*(s.x-n.x),y:o.y-h*(s.y-n.y)},next:{x:o.x+d*(s.x-n.x),y:o.y+d*(s.y-n.y)}}}function Qe(t,e="x"){const r=Ke(e),i=t.length,n=Array(i).fill(0),o=Array(i);let s,a,l,c=Ye(t,0);for(s=0;s<i;++s)if(a=l,l=c,c=Ye(t,s+1),l){if(c){const t=c[e]-l[e];n[s]=0!==t?(c[r]-l[r])/t:0}o[s]=a?c?z(n[s-1])!==z(n[s])?0:(n[s-1]+n[s])/2:n[s-1]:n[s]}!function(t,e,r){const i=t.length;let n,o,s,a,l,c=Ye(t,0);for(let u=0;u<i-1;++u)l=c,c=Ye(t,u+1),l&&c&&(U(e[u],0,Xe)?r[u]=r[u+1]=0:(n=r[u]/e[u],o=r[u+1]/e[u],a=Math.pow(n,2)+Math.pow(o,2),a<=9||(s=3/Math.sqrt(a),r[u]=n*s*e[u],r[u+1]=o*s*e[u])))}(t,n,o),function(t,e,r="x"){const i=Ke(r),n=t.length;let o,s,a,l=Ye(t,0);for(let c=0;c<n;++c){if(s=a,a=l,l=Ye(t,c+1),!a)continue;const n=a[r],u=a[i];s&&(o=(n-s[r])/3,a[`cp1${r}`]=n-o,a[`cp1${i}`]=u-o*e[c]),l&&(o=(l[r]-n)/3,a[`cp2${r}`]=n+o,a[`cp2${i}`]=u+o*e[c])}}(t,o,e)}function tr(t,e,r){return Math.max(Math.min(t,r),e)}function er(t,e,r,i,n){let o,s,a,l;if(e.spanGaps&&(t=t.filter((t=>!t.skip))),"monotone"===e.cubicInterpolationMode)Qe(t,n);else{let r=i?t[t.length-1]:t[0];for(o=0,s=t.length;o<s;++o)a=t[o],l=Je(r,a,t[Math.min(o+1,s-(i?0:1))%s],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,r=a}e.capBezierPoints&&function(t,e){let r,i,n,o,s,a=ge(t[0],e);for(r=0,i=t.length;r<i;++r)s=o,o=a,a=r<i-1&&ge(t[r+1],e),o&&(n=t[r],s&&(n.cp1x=tr(n.cp1x,e.left,e.right),n.cp1y=tr(n.cp1y,e.top,e.bottom)),a&&(n.cp2x=tr(n.cp2x,e.left,e.right),n.cp2y=tr(n.cp2y,e.top,e.bottom)))}(t,r)}function rr(){return"undefined"!=typeof window&&"undefined"!=typeof document}function ir(t){let e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e}function nr(t,e,r){let i;return"string"==typeof t?(i=parseInt(t,10),-1!==t.indexOf("%")&&(i=i/100*e.parentNode[r])):i=t,i}const or=t=>window.getComputedStyle(t,null);const sr=["top","right","bottom","left"];function ar(t,e,r){const i={};r=r?"-"+r:"";for(let n=0;n<4;n++){const o=sr[n];i[o]=parseFloat(t[e+"-"+o+r])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}function lr(t,e){if("native"in t)return t;const{canvas:r,currentDevicePixelRatio:i}=e,n=or(r),o="border-box"===n.boxSizing,s=ar(n,"padding"),a=ar(n,"border","width"),{x:l,y:c,box:u}=function(t,e){const r=t.touches,i=r&&r.length?r[0]:t,{offsetX:n,offsetY:o}=i;let s,a,l=!1;if(((t,e,r)=>(t>0||e>0)&&(!r||!r.shadowRoot))(n,o,t.target))s=n,a=o;else{const t=e.getBoundingClientRect();s=i.clientX-t.left,a=i.clientY-t.top,l=!0}return{x:s,y:a,box:l}}(t,r),h=s.left+(u&&a.left),d=s.top+(u&&a.top);let{width:p,height:f}=e;return o&&(p-=s.width+a.width,f-=s.height+a.height),{x:Math.round((l-h)/p*r.width/i),y:Math.round((c-d)/f*r.height/i)}}const cr=t=>Math.round(10*t)/10;function ur(t,e,r,i){const n=or(t),o=ar(n,"margin"),s=nr(n.maxWidth,t,"clientWidth")||O,a=nr(n.maxHeight,t,"clientHeight")||O,l=function(t,e,r){let i,n;if(void 0===e||void 0===r){const o=ir(t);if(o){const t=o.getBoundingClientRect(),s=or(o),a=ar(s,"border","width"),l=ar(s,"padding");e=t.width-l.width-a.width,r=t.height-l.height-a.height,i=nr(s.maxWidth,o,"clientWidth"),n=nr(s.maxHeight,o,"clientHeight")}else e=t.clientWidth,r=t.clientHeight}return{width:e,height:r,maxWidth:i||O,maxHeight:n||O}}(t,e,r);let{width:c,height:u}=l;if("content-box"===n.boxSizing){const t=ar(n,"border","width"),e=ar(n,"padding");c-=e.width+t.width,u-=e.height+t.height}return c=Math.max(0,c-o.width),u=Math.max(0,i?Math.floor(c/i):u-o.height),c=cr(Math.min(c,s,l.maxWidth)),u=cr(Math.min(u,a,l.maxHeight)),c&&!u&&(u=cr(c/2)),{width:c,height:u}}function hr(t,e,r){const i=e||1,n=Math.floor(t.height*i),o=Math.floor(t.width*i);t.height=n/i,t.width=o/i;const s=t.canvas;return s.style&&(r||!s.style.height&&!s.style.width)&&(s.style.height=`${t.height}px`,s.style.width=`${t.width}px`),(t.currentDevicePixelRatio!==i||s.height!==n||s.width!==o)&&(t.currentDevicePixelRatio=i,s.height=n,s.width=o,t.ctx.setTransform(i,0,0,i,0,0),!0)}const dr=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(t){}return t}();function pr(t,e){const r=function(t,e){return or(t).getPropertyValue(e)}(t,e),i=r&&r.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function fr(t,e,r,i){return{x:t.x+r*(e.x-t.x),y:t.y+r*(e.y-t.y)}}function mr(t,e,r,i){return{x:t.x+r*(e.x-t.x),y:"middle"===i?r<.5?t.y:e.y:"after"===i?r<1?t.y:e.y:r>0?e.y:t.y}}function gr(t,e,r,i){const n={x:t.cp2x,y:t.cp2y},o={x:e.cp1x,y:e.cp1y},s=fr(t,n,r),a=fr(n,o,r),l=fr(o,e,r),c=fr(s,a,r),u=fr(a,l,r);return fr(c,u,r)}const yr=new Map;function vr(t,e,r){return function(t,e){e=e||{};const r=t+JSON.stringify(e);let i=yr.get(r);return i||(i=new Intl.NumberFormat(t,e),yr.set(r,i)),i}(e,r).format(t)}function _r(t,e,r){return t?function(t,e){return{x:r=>t+t+e-r,setWidth(t){e=t},textAlign:t=>"center"===t?t:"right"===t?"left":"right",xPlus:(t,e)=>t-e,leftForLtr:(t,e)=>t-e}}(e,r):{x:t=>t,setWidth(t){},textAlign:t=>t,xPlus:(t,e)=>t+e,leftForLtr:(t,e)=>t}}function br(t,e){let r,i;"ltr"!==e&&"rtl"!==e||(r=t.canvas.style,i=[r.getPropertyValue("direction"),r.getPropertyPriority("direction")],r.setProperty("direction",e,"important"),t.prevTextDirection=i)}function xr(t,e){void 0!==e&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function wr(t){return"angle"===t?{between:J,compare:Y,normalize:K}:{between:et,compare:(t,e)=>t-e,normalize:t=>t}}function Tr({start:t,end:e,count:r,loop:i,style:n}){return{start:t%r,end:e%r,loop:i&&(e-t+1)%r==0,style:n}}function Er(t,e,r){if(!r)return[t];const{property:i,start:n,end:o}=r,s=e.length,{compare:a,between:l,normalize:c}=wr(i),{start:u,end:h,loop:d,style:p}=function(t,e,r){const{property:i,start:n,end:o}=r,{between:s,normalize:a}=wr(i),l=e.length;let c,u,{start:h,end:d,loop:p}=t;if(p){for(h+=l,d+=l,c=0,u=l;c<u&&s(a(e[h%l][i]),n,o);++c)h--,d--;h%=l,d%=l}return d<h&&(d+=l),{start:h,end:d,loop:p,style:t.style}}(t,e,r),f=[];let m,g,y,v=!1,_=null;const b=()=>v||l(n,y,m)&&0!==a(n,y),x=()=>!v||0===a(o,m)||l(o,y,m);for(let t=u,r=u;t<=h;++t)g=e[t%s],g.skip||(m=c(g[i]),m!==y&&(v=l(m,n,o),null===_&&b()&&(_=0===a(m,n)?t:r),null!==_&&x()&&(f.push(Tr({start:_,end:t,loop:d,count:s,style:p})),_=null),r=t,y=m));return null!==_&&f.push(Tr({start:_,end:h,loop:d,count:s,style:p})),f}function Sr(t,e){const r=[],i=t.segments;for(let n=0;n<i.length;n++){const o=Er(i[n],t.points,e);o.length&&r.push(...o)}return r}function Pr(t,e){const r=t.points,i=t.options.spanGaps,n=r.length;if(!n)return[];const o=!!t._loop,{start:s,end:a}=function(t,e,r,i){let n=0,o=e-1;if(r&&!i)for(;n<e&&!t[n].skip;)n++;for(;n<e&&t[n].skip;)n++;for(n%=e,r&&(o+=n);o>n&&t[o%e].skip;)o--;return o%=e,{start:n,end:o}}(r,n,o,i);if(!0===i)return kr(t,[{start:s,end:a,loop:o}],r,e);return kr(t,function(t,e,r,i){const n=t.length,o=[];let s,a=e,l=t[e];for(s=e+1;s<=r;++s){const r=t[s%n];r.skip||r.stop?l.skip||(i=!1,o.push({start:e%n,end:(s-1)%n,loop:i}),e=a=r.stop?s:null):(a=s,l.skip&&(e=s)),l=r}return null!==a&&o.push({start:e%n,end:a%n,loop:i}),o}(r,s,a<s?a+n:a,!!t._fullLoop&&0===s&&a===n-1),r,e)}function kr(t,e,r,i){return i&&i.setContext&&r?function(t,e,r,i){const n=t._chart.getContext(),o=Ar(t.options),{_datasetIndex:s,options:{spanGaps:a}}=t,l=r.length,c=[];let u=o,h=e[0].start,d=h;function p(t,e,i,n){const o=a?-1:1;if(t!==e){for(t+=l;r[t%l].skip;)t-=o;for(;r[e%l].skip;)e+=o;t%l!=e%l&&(c.push({start:t%l,end:e%l,loop:i,style:n}),u=n,h=e%l)}}for(const t of e){h=a?h:t.start;let e,o=r[h%l];for(d=h+1;d<=t.end;d++){const a=r[d%l];e=Ar(i.setContext(De(n,{type:"segment",p0:o,p1:a,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:s}))),Mr(e,u)&&p(h,d-1,t.loop,u),o=a,u=e}h<d-1&&p(h,d-1,t.loop,u)}return c}(t,e,r,i):e}function Ar(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function Mr(t,e){return e&&JSON.stringify(t)!==JSON.stringify(e)}}},t=>{var e;e=9101,t(t.s=e)}]);